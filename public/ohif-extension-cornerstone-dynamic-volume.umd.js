/*! For license information please see ohif-extension-cornerstone-dynamic-volume.umd.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@cornerstonejs/core"),require("@cornerstonejs/streaming-image-volume-loader"),require("@cornerstonejs/tools"),require("@ohif/core"),require("@ohif/ui")):"function"==typeof define&&define.amd?define(["@cornerstonejs/core","@cornerstonejs/streaming-image-volume-loader","@cornerstonejs/tools","@ohif/core","@ohif/ui"],t):"object"==typeof exports?exports["ohif-extension-cornerstone"]=t(require("@cornerstonejs/core"),require("@cornerstonejs/streaming-image-volume-loader"),require("@cornerstonejs/tools"),require("@ohif/core"),require("@ohif/ui")):e["ohif-extension-cornerstone"]=t(e["@cornerstonejs/core"],e["@cornerstonejs/streaming-image-volume-loader"],e["@cornerstonejs/tools"],e["@ohif/core"],e["@ohif/ui"])}(globalThis,((e,t,n,r,o)=>(()=>{var i={854:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,o){for(var i,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var u in i=Object(arguments[c]))n.call(i,u)&&(s[u]=i[u]);if(t){a=t(i);for(var l=0;l<a.length;l++)r.call(i,a[l])&&(s[a[l]]=i[a[l]])}}return s}},216:(e,t,n)=>{"use strict";var r=n(151);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},374:(e,t,n)=>{e.exports=n(216)()},151:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},377:(e,t,n)=>{"use strict";var r=n(854),o=60103,i=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var a=60109,s=60110,c=60112;t.Suspense=60113;var u=60115,l=60116;if("function"==typeof Symbol&&Symbol.for){var p=Symbol.for;o=p("react.element"),i=p("react.portal"),t.Fragment=p("react.fragment"),t.StrictMode=p("react.strict_mode"),t.Profiler=p("react.profiler"),a=p("react.provider"),s=p("react.context"),c=p("react.forward_ref"),t.Suspense=p("react.suspense"),u=p("react.memo"),l=p("react.lazy")}var m="function"==typeof Symbol&&Symbol.iterator;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y={};function g(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||f}function v(){}function h(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||f}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(d(85));this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var S=h.prototype=new v;S.constructor=h,r(S,g.prototype),S.isPureReactComponent=!0;var b={current:null},D=Object.prototype.hasOwnProperty,I={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,n){var r,i={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)D.call(t,r)&&!I.hasOwnProperty(r)&&(i[r]=t[r]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===i[r]&&(i[r]=c[r]);return{$$typeof:o,type:e,key:a,ref:s,props:i,_owner:b.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var C=/\/+/g;function x(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function O(e,t,n,r,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case o:case i:c=!0}}if(c)return a=a(c=e),e=""===r?"."+x(c,0):r,Array.isArray(a)?(n="",null!=e&&(n=e.replace(C,"$&/")+"/"),O(a,t,n,"",(function(e){return e}))):null!=a&&(E(a)&&(a=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+e)),t.push(a)),1;if(c=0,r=""===r?".":r+":",Array.isArray(e))for(var u=0;u<e.length;u++){var l=r+x(s=e[u],u);c+=O(s,t,n,l,a)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),u=0;!(s=e.next()).done;)c+=O(s=s.value,t,n,l=r+x(s,u++),a);else if("object"===s)throw t=""+e,Error(d(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function T(e,t,n){if(null==e)return e;var r=[],o=0;return O(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function P(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var M={current:null};function N(){var e=M.current;if(null===e)throw Error(d(321));return e}var R={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error(d(143));return e}},t.Component=g,t.PureComponent=h,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.cloneElement=function(e,t,n){if(null==e)throw Error(d(267,e));var i=r({},e.props),a=e.key,s=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,c=b.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)D.call(t,l)&&!I.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){u=Array(l);for(var p=0;p<l;p++)u[p]=arguments[p+2];i.children=u}return{$$typeof:o,type:e.type,key:a,ref:s,props:i,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=w,t.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return N().useCallback(e,t)},t.useContext=function(e,t){return N().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return N().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return N().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return N().useLayoutEffect(e,t)},t.useMemo=function(e,t){return N().useMemo(e,t)},t.useReducer=function(e,t,n){return N().useReducer(e,t,n)},t.useRef=function(e){return N().useRef(e)},t.useState=function(e){return N().useState(e)},t.version="17.0.2"},766:(e,t,n)=>{"use strict";e.exports=n(377)},501:e=>{e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},557:t=>{"use strict";t.exports=e},121:e=>{"use strict";e.exports=t},713:e=>{"use strict";e.exports=n},2:e=>{"use strict";e.exports=r},307:e=>{"use strict";e.exports=o}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return i[e](n,n.exports,s),n.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{"use strict";s.r(c),s.d(c,{default:()=>oe});var e={};s.r(e),s.d(e,{updateSegmentationsChartDisplaySet:()=>f});const t=JSON.parse('{"UU":"@ohif/extension-cornerstone-dynamic-volume"}').UU;var n=s(2),r=s(557),o=s(713);const i="CHT",a=n.utils.guid(),u="1.9.451.13215.7.3.2.7.6.1",{utilities:l}=o;function p(e,t){const r=e.imageIds.reduce(((e,r)=>{const o=n.DicomMetadataStore.getInstanceByImageId(r)[t];return void 0!==o&&e.add(o),e}),new Set);return Array.from(r).sort(((e,t)=>e-t))}function m(e,t,i){let a;const s=i.getActiveDisplaySets().find((e=>{const t=e.instances?.[0];return!!t&&(void 0!==t.FrameReferenceTime||void 0!==t.NumberOfTimeSlices)})).displaySetInstanceUID;for(const[e]of r.cache._volumeCache)if(e.includes(s)){a=e;break}let c;a&&(c=r.cache.getVolume(a));const{StudyInstanceUID:u,StudyDescription:m}=n.DicomMetadataStore.getInstanceByImageId(c.imageIds[0]),[d,f]=l.dynamicVolume.getDataInTime(c,{maskVolumeId:e.id}),y=d.length;if(0===y)return[];const g=o.segmentation.state.getSegmentationIdRepresentations(e.id)[0].segmentationRepresentationUID,v=o.segmentation.state.getToolGroupIdFromSegmentationRepresentationUID(g),h=o.segmentation.config.color.getColorForSegmentIndex(v,g,1),S=r.utilities.color.rgbToHex(...h);let b=t.get(c);b||(b=function(e){const t={FrameReferenceTime:{unit:"ms"}},n=Object.keys(t);let r,o;for(let i=0;i<n.length;i++){const a=n[i],s=p(e,a);if(s.length){r=s,o=t[a].unit;break}}if(!r.length){const e=n.join(", ");throw new Error(`Could not extract time points data for the following tags: ${e}`)}const i=function(e,t){const n=["ms","s","m","h"],r=[1e3,60,60],o=n.indexOf(t);let i=1;if(-1!==o){for(let a=o;a<n.length-1;a++){const o=i*r[a];if(e.filter((e=>e>o)).length<=e.length/2)break;i=o,t=n[a+1]}i>1&&(e=e.map((e=>e/i)))}return{timePoints:e,timePointsUnit:t}}(r,o);return r=i.timePoints,o=i.timePointsUnit,{timePoints:r,timePointsUnit:o}}(c),t.set(c,b));const{timePoints:D,timePointsUnit:I}=b;if(D.length!==d[0].length)throw new Error("Invalid number of time points returned");const w=D.length,E=new Array(w);for(let e=0;e<w;e++){const t=d.reduce(((t,n)=>t+n[e]/y),0);E[e]=[D[e],t]}return{StudyInstanceUID:u,StudyDescription:m,chartData:{series:{label:e.label,points:E,color:S},axis:{x:{label:`Time (${I})`},y:{label:"Vl (Bq/ml)"}}}}}function d(e,t){if(!e.length)return;const r=new WeakMap,o=e.map((e=>m(e,r,t))),{date:s,time:c}=function(){const e=new Date;return{date:e.getFullYear()+("0"+e.getUTCMonth()).slice(-2)+("0"+e.getUTCDate()).slice(-2),time:("0"+e.getUTCHours()).slice(-2)+("0"+e.getUTCMinutes()).slice(-2)+("0"+e.getUTCSeconds()).slice(-2)}}(),l=o.reduce(((e,t)=>[...e,t.chartData.series]),[]),p={SOPClassUID:u,Modality:i,SOPInstanceUID:n.utils.guid(),SeriesDate:s,SeriesTime:c,SeriesInstanceUID:a,StudyInstanceUID:o[0].StudyInstanceUID,StudyDescription:o[0].StudyDescription,SeriesNumber:100,SeriesDescription:"Segmentation chart series data",chartData:{series:l,axis:{...o[0].chartData.axis}}};return{seriesMetadata:{StudyInstanceUID:p.StudyInstanceUID,StudyDescription:p.StudyDescription,SeriesInstanceUID:p.SeriesInstanceUID,SeriesDescription:p.SeriesDescription,SeriesNumber:p.SeriesNumber,SeriesTime:p.SeriesTime,SOPClassUID:p.SOPClassUID,Modality:p.Modality},instance:p}}function f({servicesManager:e}){const{segmentationService:t,displaySetService:r}=e.services,o=t.getSegmentations(),{seriesMetadata:i,instance:a}=d(o,r)??{};i&&a&&(n.DicomMetadataStore.addSeriesMetadata([i],!0),n.DicomMetadataStore.addInstances([a],!0))}const y=o.Enums.SegmentationRepresentations.Labelmap,g=({commandsManager:t,servicesManager:n})=>{const i=n.services,{displaySetService:a,viewportGridService:s,segmentationService:c}=i,u={...e,getDynamic4DDisplaySet:()=>a.getActiveDisplaySets().find((e=>{const t=e.instances?.[0];return!!t&&(void 0!==t.FrameReferenceTime||void 0!==t.NumberOfTimeSlices||void 0!==t.TemporalPositionIdentifier)})),getComputedDisplaySets:()=>[...a.getDisplaySetCache().values()].filter((e=>e.isDerived)),exportTimeReportCSV:({segmentations:e,config:t,options:n,summaryStats:i})=>{const a=u.getDynamic4DDisplaySet(),s=a?.displaySetInstanceUID;let c,l;for(const[e]of r.cache._volumeCache)if(e.includes(s)){c=e;break}c&&(l=r.cache.getVolume(c));const p=a.instances[0],m=[];function d(e){const t=e.length,n=e.reduce(((e,t)=>e+t),0)/t,r=e.map((e=>(e-n)**2)).reduce(((e,t)=>e+t),0)/t;return Math.sqrt(r)}m.push(`Patient ID,${p.PatientID},`),m.push(`Study Date,${p.StudyDate},`),m.push(`StudyInstanceUID,${p.StudyInstanceUID},`),m.push(`StudyDescription,${p.StudyDescription},`),m.push(`SeriesInstanceUID,${p.SeriesInstanceUID},`),m.push(""),m.push(""),e.forEach(((e,t)=>{const[n,r]=o.utilities.dynamicVolume.getDataInTime(l,{maskVolumeId:e.id});if(i){let t="Operation,Segmentation Label ID";const o=l.numTimePoints;for(let e=0;e<o;e++)t+=`,Time Point ${e}`;m.push(t);const i=[],a=[],s=[],c=[],u=[],p=[],f=n.length;for(let e=0;e<o;e++){const t=[];for(let r=0;r<f;r++)t.push(n[r][e]);i.push(t.reduce(((e,t)=>e+t),0)/f);const o=Math.min(...t);a.push(o),s.push(r[t.indexOf(o)]);const l=Math.max(...t);c.push(l),u.push(r[t.indexOf(l)]),p.push(d(t))}let y=`Mean,${e.label}`;for(let e=0;e<o;e++)y+=`,${i[e]}`;m.push(y),y=`Standard Deviation,${e.label}`;for(let e=0;e<o;e++)y+=`,${p[e]}`;m.push(y),y=`Min,${e.label}`;for(let e=0;e<o;e++)y+=`,${a[e]}`;m.push(y),y=`Max,${e.label}`;for(let e=0;e<o;e++)y+=`,${c[e]}`;m.push(y)}else{let t="Pixel Identifier (IJK),Segmentation Label ID";const o=l.numTimePoints;for(let e=0;e<o;e++)t+=`,Time Point ${e}`;m.push(t);for(let t=0;t<n.length;t++){let o=`${r[t][0]}_${r[t][1]}_${r[t][2]},${e.label}`;for(let e=0;e<n[t].length;e++)o+=`,${n[t][e]}`;m.push(o)}}}));const f=m.join("\n"),y=`${p.PatientID}.csv`,g=new Blob([f],{type:"text/csv;charset=utf-8;"}),v=document.createElement("a"),h=URL.createObjectURL(g);v.setAttribute("href",h),v.setAttribute("download",y),v.style.visibility="hidden",document.body.appendChild(v),v.click(),document.body.removeChild(v)},swapDynamicWithComputedDisplaySet:({displaySet:e})=>{const t=e,n=a.getDisplaySetCache(),r=[n.keys()],{displaySetInstanceUID:o}=t;r.includes(o)||n.set(o,t);const{viewports:i}=s.getState(),c=u.getDynamic4DDisplaySet(),l=[];for(const[e,t]of i){const e=t,n=e.viewportOptions,{displaySetInstanceUIDs:r}=e,i=r.indexOf(c.displaySetInstanceUID);if(-1!==i){const t={viewportId:e.viewportId,displaySetInstanceUIDs:[...r.slice(0,i),o,...r.slice(i+1)],viewportOptions:{initialImageOptions:n.initialImageOptions,viewportType:"volume",orientation:n.orientation,background:n.background}};l.push(t)}}s.setDisplaySetsForViewports(l)},swapComputedWithDynamicDisplaySet:()=>{const e=u.getDynamic4DDisplaySet(),t=a.getDisplaySetCache(),n=[...t.keys()],{displaySetInstanceUID:r}=e;n.includes(r)||t.set(r,e);const{viewports:o}=s.getState(),i=u.getComputedDisplaySets()[0],c=[];for(const[e,t]of o){const e=t,n=e.viewportOptions,{displaySetInstanceUIDs:o}=e,a=o.indexOf(i.displaySetInstanceUID);if(-1!==a){const t={viewportId:e.viewportId,displaySetInstanceUIDs:[...o.slice(0,a),r,...o.slice(a+1)],viewportOptions:{initialImageOptions:n.initialImageOptions,viewportType:"volume",orientation:n.orientation,background:n.background}};c.push(t)}}s.setDisplaySetsForViewports(c)},createNewLabelMapForDynamicVolume:async({label:e})=>{const{viewports:t,activeViewportId:n}=s.getState(),r=u.getDynamic4DDisplaySet(),o=r.displaySetInstanceUID;let i;if(t.get(n).displaySetInstanceUIDs.includes(o)&&(i=r),!i){const e=a.getDisplaySetCache();for(const[t,n]of e)if(n.referenceDisplaySetUID===o){i=n;break}}if(!i)throw new Error("No reference display set found based on the dynamic data");const l=await c.createSegmentationForDisplaySet(i.displaySetInstanceUID,{label:e}),p=Array.from(t.values(),(e=>e.viewportOptions.toolGroupId)),m=y;for(const e of p){const t=!0;await c.addSegmentationRepresentationToToolGroup(e,l,t,m),c.setActiveSegmentationForToolGroup(l,e)}return l}},l={updateSegmentationsChartDisplaySet:{commandFn:u.updateSegmentationsChartDisplaySet,storeContexts:[],options:{}},exportTimeReportCSV:{commandFn:u.exportTimeReportCSV,storeContexts:[],options:{}},swapDynamicWithComputedDisplaySet:{commandFn:u.swapDynamicWithComputedDisplaySet,storeContexts:[],options:{}},createNewLabelMapForDynamicVolume:{commandFn:u.createNewLabelMapForDynamicVolume,storeContexts:[],options:{}},swapComputedWithDynamicDisplaySet:{commandFn:u.swapComputedWithDynamicDisplaySet,storeContexts:[],options:{}}};return{actions:u,definitions:l,defaultContext:"DYNAMIC-VOLUME:CORNERSTONE"}};var v=s(766),h=s(374),S=s.n(h),b=s(307),D=s(121);function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I.apply(this,arguments)}const w={sizeClassName:"w-[58px] h-[28px]",arrowsDirection:"horizontal",labelPosition:"bottom"},E=({title:e,tooltip:t})=>v.createElement("div",{className:"flex items-center space-x-1"},v.createElement(b.Tooltip,{content:v.createElement("div",{className:"text-white"},t),position:"bottom-left",tight:!0,tooltipBoxClassName:"max-w-xs p-2"},v.createElement(b.Icon,{name:"info-link",className:"text-primary-active h-[14px] w-[14px]"})),v.createElement("span",{className:"text-aqua-pale text-[11px] uppercase"},e)),C=({isPlaying:e,onPlayPauseChange:t,fps:n,onFpsChange:o,minFps:i,maxFps:a,currentFrameIndex:s,onFrameChange:c,framesLength:u,onGenerate:l,onDoubleRangeChange:p,onDynamicClick:m})=>{const[d,f]=(0,v.useState)(!1),[y,g]=(0,v.useState)(r.Enums.DynamicOperatorType.SUM),[h,S]=(0,v.useState)([u/4,u/2]);return(0,v.useEffect)((()=>{S([u/4,u/2])}),[u]),v.createElement("div",{className:"flex select-none flex-col"},v.createElement(b.PanelSection,{title:"Controls",childrenClassName:"space-y-4 pb-5 px-5"},v.createElement("div",{className:"mt-2"},v.createElement(E,{title:"View",tooltip:"Select the view mode, 4D to view the dynamic volume or Computed to view the computed volume"}),v.createElement(b.ButtonGroup,{className:"mt-2 w-full"},v.createElement("button",{className:"w-1/2",onClick:()=>{f(!1),m?.()}},"4D"),v.createElement("button",{className:"w-1/2",onClick:()=>{f(!0)}},"Computed"))),v.createElement("div",null,v.createElement(x,{onPlayPauseChange:t,isPlaying:e,computedView:d,fps:n,onFpsChange:o,minFps:i,maxFps:a,framesLength:u,onFrameChange:c,currentFrameIndex:s})),v.createElement("div",{className:"mt-6 flex flex-col "+(d?"":"ohif-disabled")},v.createElement(E,{title:"Computed Operation",tooltip:v.createElement("div",null,"Operation Buttons (SUM, AVERAGE, SUBTRACT): Select the mathematical operation to be applied to the data set.",v.createElement("br",null)," Range Slider: Choose the numeric range within which the operation will be performed.",v.createElement("br",null),"Generate Button: Execute the chosen operation on the specified range of data."," ")}),v.createElement(b.ButtonGroup,{className:"mt-2 w-full ",separated:!0},v.createElement("button",{className:"w-1/2",onClick:()=>g(r.Enums.DynamicOperatorType.SUM)},r.Enums.DynamicOperatorType.SUM.toString().toUpperCase()),v.createElement("button",{className:"w-1/2",onClick:()=>g(r.Enums.DynamicOperatorType.AVERAGE)},r.Enums.DynamicOperatorType.AVERAGE.toString().toUpperCase()),v.createElement("button",{className:"w-1/2",onClick:()=>g(r.Enums.DynamicOperatorType.SUBTRACT)},r.Enums.DynamicOperatorType.SUBTRACT.toString().toUpperCase())),v.createElement("div",{className:"w-ful mt-2"},v.createElement(b.InputDoubleRange,{values:h,onChange:e=>{p(e),e[0]===h[0]&&e[1]===h[1]||S(e)},minValue:0,showLabel:!0,allowNumberEdit:!0,maxValue:u,step:1})),v.createElement(b.Button,{className:"mt-2 !h-[26px] !w-[115px] self-start !p-0",onClick:()=>{l(y)}},"Generate"))))};function x({isPlaying:e,onPlayPauseChange:t,fps:n,minFps:r,maxFps:o,onFpsChange:i,framesLength:a,onFrameChange:s,currentFrameIndex:c,computedView:u}){return v.createElement("div",{className:u&&"ohif-disabled"},v.createElement(E,{title:"4D Controls",tooltip:v.createElement("div",null,"Play/Pause Button: Begin or pause the animation of the 4D visualization. ",v.createElement("br",null)," Frame Selector: Navigate through individual frames of the 4D data. ",v.createElement("br",null)," FPS (Frames Per Second) Selector: Adjust the playback speed of the animation.")}),v.createElement("div",{className:"mt-3 flex justify-between"},v.createElement(b.IconButton,{className:"bg-customblue-30 h-[26px] w-[58px] rounded-[4px]",onClick:()=>t(!e)},v.createElement(b.Icon,{name:e?"icon-pause":"icon-play",className:" active:text-primary-light hover:bg-customblue-300 h-[24px] w-[24px] cursor-pointer text-white"})),v.createElement(b.InputNumber,I({value:c,onChange:s,minValue:0,maxValue:a,label:"Frame"},w)),v.createElement(b.InputNumber,I({value:n,onChange:i,minValue:r,maxValue:o},w,{label:"FPS"}))))}function O({servicesManager:e,commandsManager:t}){const{cornerstoneViewportService:n,viewportGridService:i,displaySetService:a}=e.services,[{isCineEnabled:s},c]=(0,b.useCine)(),[{activeViewportId:u}]=(0,b.useViewportGrid)(),[l,p]=(0,v.useState)([]),[m,d]=(0,v.useState)([]),[f,y]=(0,v.useState)(null),[g,h]=(0,v.useState)(null),[S,I]=(0,v.useState)(20),[w,E]=(0,v.useState)(s),[x,O]=(0,v.useState)(null),[T,P]=(0,v.useState)(!1),M=(0,v.useRef)(r.utilities.uuidv4()),N=(0,v.useRef)(null),R=`cornerstoneStreamingImageVolume:${M.current}`;function U(e){t.runCommand("swapDynamicWithComputedDisplaySet",{displaySet:e}),P(!0)}(0,v.useEffect)((()=>{const e=n.EVENTS.VIEWPORT_DATA_CHANGED,{unsubscribe:t}=n.subscribe(e,(e=>{e.viewportData.data.forEach((e=>{e.volume.isDynamicVolume()&&(h(e.volume),N.current=e.displaySetInstanceUID,p([1,e.volume.numTimePoints]))}))}));return()=>{t()}}),[n]),(0,v.useEffect)((()=>{const{unsubscribe:t}=e.services.cineService.subscribe(e.services.cineService.EVENTS.CINE_STATE_CHANGED,(e=>{E(e.isPlaying)}));return()=>{t()}}),[c]),(0,v.useEffect)((()=>{const e=i.getDisplaySetsUIDsForViewport(u);if(!e||0===e.length)return;const t=e.map((e=>a.getDisplaySetByUID(e))).find((e=>e.isDynamicVolume));if(!t)return;const n=r.cache.getVolumes().find((e=>e.volumeId.includes(t.displaySetInstanceUID)));n&&(h(n),N.current=t.displaySetInstanceUID,p([1,n.numTimePoints]))}),[u,n]),(0,v.useEffect)((()=>{const e=D.Enums.Events.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED,t=e=>{O(e.detail.timePointIndex)};return r.eventTarget.addEventListener(e,t),()=>{r.eventTarget.removeEventListener(e,t)}}),[n]);const j=()=>{E(!0);const e=n.getViewportInfo(u);if(!e)return;const{element:t}=e;c.playClip(t,{framesPerSecond:S,viewportId:u})},k=()=>{E(!1);const{element:e}=n.getViewportInfo(u);c.stopClip(e)};return g&&0!==l.length?v.createElement(C,{fps:S,isPlaying:w,onPlayPauseChange:e=>{e?j():k()},minFps:1,maxFps:50,currentFrameIndex:x,onFpsChange:e=>{I(e),k(),j()},framesLength:l[1],onFrameChange:e=>{g.timePointIndex=e},onGenerate:async function(e){const i=g.volumeId;if(!i)return;let a=r.cache.getVolume(R);a||(await async function(e,t){if(!r.cache.getVolume(t))return await r.volumeLoader.createAndCacheDerivedVolume(e,{volumeId:t})}(i,R),a=r.cache.getVolume(R));const s=m,c=Array.from({length:s[1]-s[0]+1},((e,t)=>t+s[0])),u=o.utilities.dynamicVolume.generateImageFromTimeData(g,e,"SUBTRACT"===e?s:c);if(a.loadStatus={},a.loadStatus.loaded=!0,a.getScalarData().set(u),f)t.runCommand("updateVolumeData",{volume:a}),n.getRenderingEngine().render(),U(f);else{const e={volumeLoaderSchema:a.volumeId.split(":")[0],displaySetInstanceUID:M.current,SOPClassHandlerId:"@ohif/extension-default.sopClassHandlerModule.stack",Modality:g.metadata.Modality,isMultiFrame:!1,numImageFrames:1,uid:M.current,referenceDisplaySetUID:g.volumeId.split(":")[1],madeInClient:!0,FrameOfReferenceUID:g.metadata.FrameOfReferenceUID,isDerived:!0};y(e),U(e)}},onDynamicClick:T?()=>{t.runCommand("swapComputedWithDynamicDisplaySet")}:null,onDoubleRangeChange:function(e){e[0]===m[0]&&e[1]===m[1]||d(e)}}):null}O.propTypes={servicesManager:S().shape({services:S().shape({measurementService:S().shape({getMeasurements:S().func.isRequired,subscribe:S().func.isRequired,EVENTS:S().object.isRequired,VALUE_TYPES:S().object.isRequired}).isRequired}).isRequired}).isRequired};const T=function({servicesManager:e,commandsManager:t}){return v.createElement("div",{className:"flex flex-col text-white","data-cy":"dynamic-volume-panel"},v.createElement(O,{commandsManager:t,servicesManager:e}))};function P(){if(console&&console.warn){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];"string"==typeof n[0]&&(n[0]="react-i18next:: ".concat(n[0])),(e=console).warn.apply(e,n)}}s(501),Object.create(null);var M={};function N(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];"string"==typeof t[0]&&M[t[0]]||("string"==typeof t[0]&&(M[t[0]]=new Date),P.apply(void 0,t))}var R=function(e,t){return function(){e.isInitialized?t():e.on("initialized",(function n(){setTimeout((function(){e.off("initialized",n)}),0),t()}))}};function U(e,t,n){e.loadNamespaces(t,R(e,n))}function j(e,t,n,r){"string"==typeof n&&(n=[n]),n.forEach((function(t){e.options.ns.indexOf(t)<0&&e.options.ns.push(t)})),e.loadLanguages(t,R(e,r))}function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function _(e){var t=function(e,t){if("object"!=k(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==k(t)?t:t+""}function F(e,t,n){return(t=_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,A={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},L=function(e){return A[e]},$={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:function(e){return e.replace(V,L)}};function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_(r.key),r)}}var G=(0,v.createContext)(),W=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.usedNamespaces={}}var t,n;return t=e,(n=[{key:"addUsedNamespaces",value:function(e){var t=this;e.forEach((function(e){t.usedNamespaces[e]||(t.usedNamespaces[e]=!0)}))}},{key:"getUsedNamespaces",value:function(){return Object.keys(this.usedNamespaces)}}])&&q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.i18n,r=(0,v.useContext)(G)||{},o=r.i18n,i=r.defaultNS,a=n||o||undefined;if(a&&!a.reportNamespaces&&(a.reportNamespaces=new W),!a){N("You will need to pass in an i18next instance by using initReactI18next");var s=function(e,t){return"string"==typeof t?t:t&&"object"===k(t)&&"string"==typeof t.defaultValue?t.defaultValue:Array.isArray(e)?e[e.length-1]:e},c=[s,{},!1];return c.t=s,c.i18n={},c.ready=!1,c}a.options.react&&void 0!==a.options.react.wait&&N("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");var u=z(z(z({},$),a.options.react),t),l=u.useSuspense,p=u.keyPrefix,m=e||i||a.options&&a.options.defaultNS;m="string"==typeof m?[m]:m||["translation"],a.reportNamespaces.addUsedNamespaces&&a.reportNamespaces.addUsedNamespaces(m);var d=(a.isInitialized||a.initializedStoreOnce)&&m.every((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.languages&&t.languages.length?void 0!==t.options.ignoreJSONStructure?t.hasLoadedNamespace(e,{lng:n.lng,precheck:function(t,r){if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!r(t.isLanguageChangingTo,e))return!1}}):function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.languages[0],o=!!t.options&&t.options.fallbackLng,i=t.languages[t.languages.length-1];if("cimode"===r.toLowerCase())return!0;var a=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};return!(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!a(t.isLanguageChangingTo,e)||!t.hasResourceBundle(r,e)&&t.services.backendConnector.backend&&(!t.options.resources||t.options.partialBundledLanguages)&&(!a(r,e)||o&&!a(i,e)))}(e,t,n):(N("i18n.languages were undefined or empty",t.languages),!0)}(e,a,u)}));function f(){return a.getFixedT(t.lng||null,"fallback"===u.nsMode?m:m[0],p)}var y=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,v.useState)(f),2),g=y[0],h=y[1],S=m.join();t.lng&&(S="".concat(t.lng).concat(S));var b=function(e,t){var n=(0,v.useRef)();return(0,v.useEffect)((function(){n.current=t?n.current:e}),[e,t]),n.current}(S),D=(0,v.useRef)(!0);(0,v.useEffect)((function(){var e=u.bindI18n,n=u.bindI18nStore;function r(){D.current&&h(f)}return D.current=!0,d||l||(t.lng?j(a,t.lng,m,(function(){D.current&&h(f)})):U(a,m,(function(){D.current&&h(f)}))),d&&b&&b!==S&&D.current&&h(f),e&&a&&a.on(e,r),n&&a&&a.store.on(n,r),function(){D.current=!1,e&&a&&e.split(" ").forEach((function(e){return a.off(e,r)})),n&&a&&n.split(" ").forEach((function(e){return a.store.off(e,r)}))}}),[a,S]);var I=(0,v.useRef)(!0);(0,v.useEffect)((function(){D.current&&!I.current&&h(f),I.current=!1}),[a,p]);var w=[g,a,d];if(w.t=g,w.i18n=a,w.ready=d,d)return w;if(!d&&!l)return w;throw new Promise((function(e){t.lng?j(a,t.lng,m,(function(){return e()})):U(a,m,(function(){return e()}))}))}const Z=function({commandsManager:e,servicesManager:t,extensionManager:n}){const{segmentationService:r}=t.services,{t:o}=Y("dynamicExport"),[i,a]=(0,v.useState)((()=>r.getSegmentations())),s=[{label:"Export Time Data",onClick:()=>{e.runCommand("exportTimeReportCSV",{segmentations:i,options:{filename:"TimeData.csv"}})},disabled:!i?.length},{label:"Export ROI Stats",onClick:()=>{e.runCommand("exportTimeReportCSV",{segmentations:i,summaryStats:!0,options:{filename:"ROIStats.csv"}})},disabled:!i?.length}];return(0,v.useEffect)((()=>{const e=r.EVENTS.SEGMENTATION_ADDED,t=r.EVENTS.SEGMENTATION_UPDATED,n=r.EVENTS.SEGMENTATION_REMOVED,o=[];return[e,t,n].forEach((e=>{const{unsubscribe:t}=r.subscribe(e,(()=>{const e=r.getSegmentations();a(e)}));o.push(t)})),()=>{o.forEach((e=>{e()}))}}),[]),v.createElement("div",null,v.createElement("div",{className:"mt-3 flex justify-center px-2"},v.createElement(b.ActionButtons,{actions:s,t:o})))},J="2hot",K="dynamic4D-pt",Q="dynamic4D-fusion",X="dynamic4D-ct";function ee({colormap:e,voiInverted:t}={}){return{blendMode:"MIP",colormap:e,voi:{windowWidth:5,windowCenter:2.5},voiInverted:t}}function te(){const e={colormap:{name:J,opacity:[{value:0,opacity:0},{value:.1,opacity:1},{value:1,opacity:1}]},voiInverted:!1};return[{viewportOptions:{viewportId:"ptAxial",viewportType:"volume",orientation:"axial",toolGroupId:K,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"axialSync",source:!0,target:!0},{type:"voi",id:"ptWLSync",source:!0,target:!0}]},displaySets:[{id:"ptDisplaySet",options:{...ee(e)}}]},{viewportOptions:{viewportId:"ptSagittal",viewportType:"volume",orientation:"sagittal",toolGroupId:K,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"sagittalSync",source:!0,target:!0},{type:"voi",id:"ptWLSync",source:!0,target:!0}]},displaySets:[{id:"ptDisplaySet",options:{...ee(e)}}]},{viewportOptions:{viewportId:"ptCoronal",viewportType:"volume",orientation:"coronal",toolGroupId:K,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"coronalSync",source:!0,target:!0},{type:"voi",id:"ptWLSync",source:!0,target:!0}]},displaySets:[{id:"ptDisplaySet",options:{...ee(e)}}]}]}function ne(){const e={colormap:{name:J,opacity:[{value:0,opacity:0},{value:.1,opacity:.3},{value:1,opacity:.3}]}};return[{viewportOptions:{viewportId:"fusionAxial",viewportType:"volume",orientation:"axial",toolGroupId:Q,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"axialSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!1,target:!0},{type:"voi",id:"fusionWLSync",source:!0,target:!0},{type:"voi",id:"ptFusionWLSync",source:!1,target:!0,options:{syncInvertState:!1}}]},displaySets:[{id:"ctDisplaySet"},{options:{...ee(e)},id:"ptDisplaySet"}]},{viewportOptions:{viewportId:"fusionSagittal",viewportType:"volume",orientation:"sagittal",toolGroupId:Q,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"sagittalSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!1,target:!0},{type:"voi",id:"fusionWLSync",source:!0,target:!0},{type:"voi",id:"ptFusionWLSync",source:!1,target:!0,options:{syncInvertState:!1}}]},displaySets:[{id:"ctDisplaySet"},{options:{...ee(e)},id:"ptDisplaySet"}]},{viewportOptions:{viewportId:"fusionCoronal",viewportType:"volume",orientation:"coronal",toolGroupId:Q,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"coronalSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!1,target:!0},{type:"voi",id:"fusionWLSync",source:!0,target:!0},{type:"voi",id:"ptFusionWLSync",source:!1,target:!0,options:{syncInvertState:!1}}]},displaySets:[{id:"ctDisplaySet"},{options:{...ee(e)},id:"ptDisplaySet"}]}]}const re={id:"default4D",locked:!0,hasUpdatedPriorsInformation:!1,name:"Default",createdDate:"2023-01-01T00:00:00.000Z",modifiedDate:"2023-01-01T00:00:00.000Z",availableTo:{},editableBy:{},imageLoadStrategy:"default",protocolMatchingRules:[{attribute:"ModalitiesInStudy",constraint:{contains:["CT","PT"]}}],numberOfPriorsReferenced:-1,displaySetSelectors:{defaultDisplaySetId:{imageMatchingRules:[],seriesMatchingRules:[{attribute:"numImageFrames",constraint:{greaterThan:{value:0}}}]},ctDisplaySet:{imageMatchingRules:[],seriesMatchingRules:[{attribute:"Modality",constraint:{equals:{value:"CT"}},required:!0},{attribute:"isReconstructable",constraint:{equals:{value:!0}},required:!0}]},ptDisplaySet:{imageMatchingRules:[],seriesMatchingRules:[{attribute:"Modality",constraint:{equals:"PT"},required:!0},{attribute:"isReconstructable",constraint:{equals:{value:!0}},required:!0},{attribute:"SeriesDescription",constraint:{contains:"Corrected"}},{weight:2,attribute:"SeriesDescription",constraint:{doesNotContain:{value:"Uncorrected"}}}]},chartDisplaySet:{imageMatchingRules:[],seriesMatchingRules:[{attribute:"Modality",constraint:{equals:{value:"CHT"}},required:!0}]}},stages:[{id:"dataPreparation",name:"Data Preparation",viewportStructure:{layoutType:"grid",properties:{rows:1,columns:3}},viewports:[...te()],createdDate:"2023-01-01T00:00:00.000Z"},{id:"registration",name:"Registration",viewportStructure:{layoutType:"grid",properties:{rows:3,columns:3}},viewports:[...ne(),{viewportOptions:{viewportId:"ctAxial",viewportType:"volume",orientation:"axial",toolGroupId:X,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"axialSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!0,target:!0}]},displaySets:[{id:"ctDisplaySet"}]},{viewportOptions:{viewportId:"ctSagittal",viewportType:"volume",orientation:"sagittal",toolGroupId:X,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"sagittalSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!0,target:!0}]},displaySets:[{id:"ctDisplaySet"}]},{viewportOptions:{viewportId:"ctCoronal",viewportType:"volume",orientation:"coronal",toolGroupId:X,initialImageOptions:{preset:"middle"},syncGroups:[{type:"cameraPosition",id:"coronalSync",source:!0,target:!0},{type:"voi",id:"ctWLSync",source:!0,target:!0}]},displaySets:[{id:"ctDisplaySet"}]},...te()],createdDate:"2023-01-01T00:00:00.000Z"},{id:"roiQuantification",name:"ROI Quantification",viewportStructure:{layoutType:"grid",properties:{rows:1,columns:3}},viewports:[...ne()],createdDate:"2023-01-01T00:00:00.000Z"},{id:"kineticAnalysis",name:"Kinetic Analysis",viewportStructure:{layoutType:"grid",properties:{rows:2,columns:3,layoutOptions:[{x:0,y:0,width:1/3,height:.5},{x:1/3,y:0,width:1/3,height:.5},{x:2/3,y:0,width:1/3,height:.5},{x:0,y:.5,width:1,height:.5}]}},viewports:[...ne(),{viewportOptions:{viewportId:"seriesChart"},displaySets:[{id:"chartDisplaySet",options:{skipLoading:!0}}]}],createdDate:"2023-01-01T00:00:00.000Z"}]},oe={id:t,preRegistration:({servicesManager:e,commandsManager:t,configuration:n={}})=>{r.cache.setMaxCacheSize(5368709120)},getPanelModule:function({commandsManager:e,extensionManager:t,servicesManager:n}){return[{name:"dynamic-volume",iconName:"tab-4d",iconLabel:"4D Workflow",label:"4D Workflow",component:()=>v.createElement(T,{commandsManager:e,servicesManager:n,extensionManager:t})},{name:"dynamic-toolbox",iconName:"tab-4d",iconLabel:"4D Workflow",label:"Dynamic Toolbox",component:()=>v.createElement(v.Fragment,null,v.createElement(b.Toolbox,{commandsManager:e,servicesManager:n,extensionManager:t,buttonSectionId:"dynamic-toolbox",title:"Threshold Tools"}))},{name:"dynamic-export",iconName:"tab-4d",iconLabel:"4D Workflow",label:"4D Workflow",component:()=>v.createElement(v.Fragment,null,v.createElement(Z,{commandsManager:e,servicesManager:n,extensionManager:t}))}]},getHangingProtocolModule:function(){return[{name:re.id,protocol:re}]},getCommandsModule:({servicesManager:e,commandsManager:t,extensionManager:n})=>g({servicesManager:e,commandsManager:t,extensionManager:n})}})(),c})()));