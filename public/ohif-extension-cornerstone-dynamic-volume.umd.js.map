{"version":3,"file":"dist/ohif-extension-cornerstone-dynamic-volume.umd.js","mappings":"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","sources":["webpack://ohif-extension-cornerstone/webpack/universalModuleDefinition","webpack://ohif-extension-cornerstone/../../../node_modules/object-assign/index.js","webpack://ohif-extension-cornerstone/../../../node_modules/prop-types/factoryWithThrowingShims.js","webpack://ohif-extension-cornerstone/../../../node_modules/prop-types/index.js","webpack://ohif-extension-cornerstone/../../../node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://ohif-extension-cornerstone/../../../node_modules/react/cjs/react.production.min.js","webpack://ohif-extension-cornerstone/../../../node_modules/react/index.js","webpack://ohif-extension-cornerstone/../../../node_modules/void-elements/index.js","webpack://ohif-extension-cornerstone/external umd \"@cornerstonejs/core\"","webpack://ohif-extension-cornerstone/external umd \"@cornerstonejs/streaming-image-volume-loader\"","webpack://ohif-extension-cornerstone/external umd \"@cornerstonejs/tools\"","webpack://ohif-extension-cornerstone/external umd \"@ohif/core\"","webpack://ohif-extension-cornerstone/external umd \"@ohif/ui\"","webpack://ohif-extension-cornerstone/webpack/bootstrap","webpack://ohif-extension-cornerstone/webpack/runtime/compat get default export","webpack://ohif-extension-cornerstone/webpack/runtime/define property getters","webpack://ohif-extension-cornerstone/webpack/runtime/hasOwnProperty shorthand","webpack://ohif-extension-cornerstone/webpack/runtime/make namespace object","webpack://ohif-extension-cornerstone/./id.js","webpack://ohif-extension-cornerstone/./actions/updateSegmentationsChartDisplaySet.ts","webpack://ohif-extension-cornerstone/./commandsModule.ts","webpack://ohif-extension-cornerstone/./panels/DynamicVolumeControls.tsx","webpack://ohif-extension-cornerstone/./panels/PanelGenerateImage.tsx","webpack://ohif-extension-cornerstone/./panels/DynamicDataPanel.tsx","webpack://ohif-extension-cornerstone/../../../node_modules/html-parse-stringify/src/parse.js","webpack://ohif-extension-cornerstone/../../../node_modules/react-i18next/dist/es/utils.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://ohif-extension-cornerstone/../../../node_modules/react-i18next/dist/es/unescape.js","webpack://ohif-extension-cornerstone/../../../node_modules/react-i18next/dist/es/defaults.js","webpack://ohif-extension-cornerstone/../../../node_modules/react-i18next/dist/es/TransWithoutContext.js","webpack://ohif-extension-cornerstone/../../../node_modules/react-i18next/dist/es/i18nInstance.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://ohif-extension-cornerstone/../../../node_modules/react-i18next/dist/es/context.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://ohif-extension-cornerstone/../../../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://ohif-extension-cornerstone/../../../node_modules/react-i18next/dist/es/useTranslation.js","webpack://ohif-extension-cornerstone/./panels/DynamicExport.tsx","webpack://ohif-extension-cornerstone/./getPanelModule.tsx","webpack://ohif-extension-cornerstone/./getHangingProtocolModule.ts","webpack://ohif-extension-cornerstone/./index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@cornerstonejs/core\"), require(\"@cornerstonejs/streaming-image-volume-loader\"), require(\"@cornerstonejs/tools\"), require(\"@ohif/core\"), require(\"@ohif/ui\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@cornerstonejs/core\", \"@cornerstonejs/streaming-image-volume-loader\", \"@cornerstonejs/tools\", \"@ohif/core\", \"@ohif/ui\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ohif-extension-cornerstone\"] = factory(require(\"@cornerstonejs/core\"), require(\"@cornerstonejs/streaming-image-volume-loader\"), require(\"@cornerstonejs/tools\"), require(\"@ohif/core\"), require(\"@ohif/ui\"));\n\telse\n\t\troot[\"ohif-extension-cornerstone\"] = factory(root[\"@cornerstonejs/core\"], root[\"@cornerstonejs/streaming-image-volume-loader\"], root[\"@cornerstonejs/tools\"], root[\"@ohif/core\"], root[\"@ohif/ui\"]);\n})(globalThis, (__WEBPACK_EXTERNAL_MODULE__557__, __WEBPACK_EXTERNAL_MODULE__121__, __WEBPACK_EXTERNAL_MODULE__713__, __WEBPACK_EXTERNAL_MODULE__2__, __WEBPACK_EXTERNAL_MODULE__307__) => {\nreturn ","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","/** @license React v17.0.2\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=require(\"object-assign\"),n=60103,p=60106;exports.Fragment=60107;exports.StrictMode=60108;exports.Profiler=60114;var q=60109,r=60110,t=60112;exports.Suspense=60113;var u=60115,v=60116;\nif(\"function\"===typeof Symbol&&Symbol.for){var w=Symbol.for;n=w(\"react.element\");p=w(\"react.portal\");exports.Fragment=w(\"react.fragment\");exports.StrictMode=w(\"react.strict_mode\");exports.Profiler=w(\"react.profiler\");q=w(\"react.provider\");r=w(\"react.context\");t=w(\"react.forward_ref\");exports.Suspense=w(\"react.suspense\");u=w(\"react.memo\");v=w(\"react.lazy\")}var x=\"function\"===typeof Symbol&&Symbol.iterator;\nfunction y(a){if(null===a||\"object\"!==typeof a)return null;a=x&&a[x]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}function z(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}\nvar A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B={};function C(a,b,c){this.props=a;this.context=b;this.refs=B;this.updater=c||A}C.prototype.isReactComponent={};C.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(z(85));this.updater.enqueueSetState(this,a,b,\"setState\")};C.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};\nfunction D(){}D.prototype=C.prototype;function E(a,b,c){this.props=a;this.context=b;this.refs=B;this.updater=c||A}var F=E.prototype=new D;F.constructor=E;l(F,C.prototype);F.isPureReactComponent=!0;var G={current:null},H=Object.prototype.hasOwnProperty,I={key:!0,ref:!0,__self:!0,__source:!0};\nfunction J(a,b,c){var e,d={},k=null,h=null;if(null!=b)for(e in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)H.call(b,e)&&!I.hasOwnProperty(e)&&(d[e]=b[e]);var g=arguments.length-2;if(1===g)d.children=c;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];d.children=f}if(a&&a.defaultProps)for(e in g=a.defaultProps,g)void 0===d[e]&&(d[e]=g[e]);return{$$typeof:n,type:a,key:k,ref:h,props:d,_owner:G.current}}\nfunction K(a,b){return{$$typeof:n,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function L(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===n}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var M=/\\/+/g;function N(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction O(a,b,c,e,d){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case n:case p:h=!0}}if(h)return h=a,d=d(h),a=\"\"===e?\".\"+N(h,0):e,Array.isArray(d)?(c=\"\",null!=a&&(c=a.replace(M,\"$&/\")+\"/\"),O(d,b,c,\"\",function(a){return a})):null!=d&&(L(d)&&(d=K(d,c+(!d.key||h&&h.key===d.key?\"\":(\"\"+d.key).replace(M,\"$&/\")+\"/\")+a)),b.push(d)),1;h=0;e=\"\"===e?\".\":e+\":\";if(Array.isArray(a))for(var g=\n0;g<a.length;g++){k=a[g];var f=e+N(k,g);h+=O(k,b,c,f,d)}else if(f=y(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=e+N(k,g++),h+=O(k,b,c,f,d);else if(\"object\"===k)throw b=\"\"+a,Error(z(31,\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b));return h}function P(a,b,c){if(null==a)return a;var e=[],d=0;O(a,e,\"\",\"\",function(a){return b.call(c,a,d++)});return e}\nfunction Q(a){if(-1===a._status){var b=a._result;b=b();a._status=0;a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}if(1===a._status)return a._result;throw a._result;}var R={current:null};function S(){var a=R.current;if(null===a)throw Error(z(321));return a}var T={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:G,IsSomeRendererActing:{current:!1},assign:l};\nexports.Children={map:P,forEach:function(a,b,c){P(a,function(){b.apply(this,arguments)},c)},count:function(a){var b=0;P(a,function(){b++});return b},toArray:function(a){return P(a,function(a){return a})||[]},only:function(a){if(!L(a))throw Error(z(143));return a}};exports.Component=C;exports.PureComponent=E;exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T;\nexports.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(z(267,a));var e=l({},a.props),d=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=G.current);void 0!==b.key&&(d=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)H.call(b,f)&&!I.hasOwnProperty(f)&&(e[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)e.children=c;else if(1<f){g=Array(f);for(var m=0;m<f;m++)g[m]=arguments[m+2];e.children=g}return{$$typeof:n,type:a.type,\nkey:d,ref:k,props:e,_owner:h}};exports.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:r,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:q,_context:a};return a.Consumer=a};exports.createElement=J;exports.createFactory=function(a){var b=J.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};exports.forwardRef=function(a){return{$$typeof:t,render:a}};exports.isValidElement=L;\nexports.lazy=function(a){return{$$typeof:v,_payload:{_status:-1,_result:a},_init:Q}};exports.memo=function(a,b){return{$$typeof:u,type:a,compare:void 0===b?null:b}};exports.useCallback=function(a,b){return S().useCallback(a,b)};exports.useContext=function(a,b){return S().useContext(a,b)};exports.useDebugValue=function(){};exports.useEffect=function(a,b){return S().useEffect(a,b)};exports.useImperativeHandle=function(a,b,c){return S().useImperativeHandle(a,b,c)};\nexports.useLayoutEffect=function(a,b){return S().useLayoutEffect(a,b)};exports.useMemo=function(a,b){return S().useMemo(a,b)};exports.useReducer=function(a,b,c){return S().useReducer(a,b,c)};exports.useRef=function(a){return S().useRef(a)};exports.useState=function(a){return S().useState(a)};exports.version=\"17.0.2\";\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","/**\n * This file automatically generated from `pre-publish.js`.\n * Do not manually edit.\n */\n\nmodule.exports = {\n  \"area\": true,\n  \"base\": true,\n  \"br\": true,\n  \"col\": true,\n  \"embed\": true,\n  \"hr\": true,\n  \"img\": true,\n  \"input\": true,\n  \"link\": true,\n  \"meta\": true,\n  \"param\": true,\n  \"source\": true,\n  \"track\": true,\n  \"wbr\": true\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__557__;","module.exports = __WEBPACK_EXTERNAL_MODULE__121__;","module.exports = __WEBPACK_EXTERNAL_MODULE__713__;","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","module.exports = __WEBPACK_EXTERNAL_MODULE__307__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import packageJson from '../package.json';\n\nconst id = packageJson.name;\nconst SOPClassHandlerName = 'dynamic-volume';\n\nexport { id, SOPClassHandlerName };\n","import { DicomMetadataStore, utils } from '@ohif/core';\n\nimport * as cs from '@cornerstonejs/core';\nimport * as csTools from '@cornerstonejs/tools';\n\nconst CHART_MODALITY = 'CHT';\nconst SEG_CHART_INSTANCE_UID = utils.guid();\n\n// Private SOPClassUid for chart data\nconst ChartDataSOPClassUid = '1.9.451.13215.7.3.2.7.6.1';\n\nconst { utilities: csToolsUtils } = csTools;\n\nfunction _getDateTimeStr() {\n  const now = new Date();\n  const date =\n    now.getFullYear() + ('0' + now.getUTCMonth()).slice(-2) + ('0' + now.getUTCDate()).slice(-2);\n  const time =\n    ('0' + now.getUTCHours()).slice(-2) +\n    ('0' + now.getUTCMinutes()).slice(-2) +\n    ('0' + now.getUTCSeconds()).slice(-2);\n\n  return { date, time };\n}\n\nfunction _getTimePointsDataByTagName(volume, timePointsTag) {\n  const uniqueTimePoints = volume.imageIds.reduce((timePoints, imageId) => {\n    const instance = DicomMetadataStore.getInstanceByImageId(imageId);\n    const timePointValue = instance[timePointsTag];\n\n    if (timePointValue !== undefined) {\n      timePoints.add(timePointValue);\n    }\n\n    return timePoints;\n  }, new Set());\n\n  return Array.from(uniqueTimePoints).sort((a: number, b: number) => a - b);\n}\n\nfunction _convertTimePointsUnit(timePoints, timePointsUnit) {\n  const validUnits = ['ms', 's', 'm', 'h'];\n  const divisors = [1000, 60, 60];\n  const currentUnitIndex = validUnits.indexOf(timePointsUnit);\n  let divisor = 1;\n\n  if (currentUnitIndex !== -1) {\n    for (let i = currentUnitIndex; i < validUnits.length - 1; i++) {\n      const newDivisor = divisor * divisors[i];\n      const greaterThanDivisorCount = timePoints.filter(timePoint => timePoint > newDivisor).length;\n\n      // Change the scale only if more than 50% of the time points are\n      // greater than the new divisor.\n      if (greaterThanDivisorCount <= timePoints.length / 2) {\n        break;\n      }\n\n      divisor = newDivisor;\n      timePointsUnit = validUnits[i + 1];\n    }\n\n    if (divisor > 1) {\n      timePoints = timePoints.map(timePoint => timePoint / divisor);\n    }\n  }\n\n  return { timePoints, timePointsUnit };\n}\n\n// It currently supports only one tag but a few other will be added soon\n// Supported 4D Tags\n//   (0018,1060) Trigger Time                   [NOK]\n//   (0018,0081) Echo Time                      [NOK]\n//   (0018,0086) Echo Number                    [NOK]\n//   (0020,0100) Temporal Position Identifier   [NOK]\n//   (0054,1300) FrameReferenceTime             [OK]\nfunction _getTimePointsData(volume) {\n  const timePointsTags = {\n    FrameReferenceTime: {\n      unit: 'ms',\n    },\n  };\n\n  const timePointsTagNames = Object.keys(timePointsTags);\n  let timePoints;\n  let timePointsUnit;\n\n  for (let i = 0; i < timePointsTagNames.length; i++) {\n    const tagName = timePointsTagNames[i];\n    const curTimePoints = _getTimePointsDataByTagName(volume, tagName);\n\n    if (curTimePoints.length) {\n      timePoints = curTimePoints;\n      timePointsUnit = timePointsTags[tagName].unit;\n      break;\n    }\n  }\n\n  if (!timePoints.length) {\n    const concatTagNames = timePointsTagNames.join(', ');\n\n    throw new Error(`Could not extract time points data for the following tags: ${concatTagNames}`);\n  }\n\n  const convertedTimePoints = _convertTimePointsUnit(timePoints, timePointsUnit);\n\n  timePoints = convertedTimePoints.timePoints;\n  timePointsUnit = convertedTimePoints.timePointsUnit;\n\n  return { timePoints, timePointsUnit };\n}\n\nfunction _getSegmentationData(segmentation, volumesTimePointsCache, displaySetService) {\n  const displaySets = displaySetService.getActiveDisplaySets();\n\n  const dynamic4DDisplaySet = displaySets.find(displaySet => {\n    const anInstance = displaySet.instances?.[0];\n\n    if (anInstance) {\n      return (\n        anInstance.FrameReferenceTime !== undefined || anInstance.NumberOfTimeSlices !== undefined\n      );\n    }\n\n    return false;\n  });\n\n  // const referencedDynamicVolume = cs.cache.getVolume(dynamic4DDisplaySet.displaySetInstanceUID);\n  let volumeCacheKey: string | undefined;\n  const volumeId = dynamic4DDisplaySet.displaySetInstanceUID;\n\n  for (const [key] of cs.cache._volumeCache) {\n    if (key.includes(volumeId)) {\n      volumeCacheKey = key;\n      break;\n    }\n  }\n\n  let referencedDynamicVolume;\n  if (volumeCacheKey) {\n    referencedDynamicVolume = cs.cache.getVolume(volumeCacheKey);\n  }\n\n  const { StudyInstanceUID, StudyDescription } = DicomMetadataStore.getInstanceByImageId(\n    referencedDynamicVolume.imageIds[0]\n  );\n\n  const [timeData, _] = csToolsUtils.dynamicVolume.getDataInTime(referencedDynamicVolume, {\n    maskVolumeId: segmentation.id,\n  }) as number[][];\n\n  const pixelCount = timeData.length;\n\n  if (pixelCount === 0) {\n    return [];\n  }\n\n  // since we only use one segmentation representation per segmentationId\n  // it is fine to pick the first one\n  const segmentationRepresentations = csTools.segmentation.state.getSegmentationIdRepresentations(\n    segmentation.id\n  );\n\n  const segmentationRepresentationUID =\n    segmentationRepresentations[0].segmentationRepresentationUID;\n\n  const toolGroupId = csTools.segmentation.state.getToolGroupIdFromSegmentationRepresentationUID(\n    segmentationRepresentationUID\n  );\n\n  // Todo: this is useless we should be able to grab color with just segRepUID and segmentIndex\n  const color = csTools.segmentation.config.color.getColorForSegmentIndex(\n    toolGroupId,\n    segmentationRepresentationUID,\n    1 // segmentIndex\n  );\n\n  const hexColor = cs.utilities.color.rgbToHex(...color);\n  let timePointsData = volumesTimePointsCache.get(referencedDynamicVolume);\n\n  if (!timePointsData) {\n    timePointsData = _getTimePointsData(referencedDynamicVolume);\n    volumesTimePointsCache.set(referencedDynamicVolume, timePointsData);\n  }\n\n  const { timePoints, timePointsUnit } = timePointsData;\n\n  if (timePoints.length !== timeData[0].length) {\n    throw new Error('Invalid number of time points returned');\n  }\n\n  const timepointsCount = timePoints.length;\n  const chartSeriesData = new Array(timepointsCount);\n\n  for (let i = 0; i < timepointsCount; i++) {\n    const average = timeData.reduce((acc, cur) => acc + cur[i] / pixelCount, 0);\n\n    chartSeriesData[i] = [timePoints[i], average];\n  }\n\n  return {\n    StudyInstanceUID,\n    StudyDescription,\n    chartData: {\n      series: {\n        label: segmentation.label,\n        points: chartSeriesData,\n        color: hexColor,\n      },\n      axis: {\n        x: {\n          label: `Time (${timePointsUnit})`,\n        },\n        y: {\n          label: `Vl (Bq/ml)`,\n        },\n      },\n    },\n  };\n}\n\nfunction _getInstanceFromSegmentations(segmentations, displaySetService) {\n  if (!segmentations.length) {\n    return;\n  }\n\n  const volumesTimePointsCache = new WeakMap();\n  const segmentationsData = segmentations.map(segmentation =>\n    _getSegmentationData(segmentation, volumesTimePointsCache, displaySetService)\n  );\n\n  const { date: seriesDate, time: seriesTime } = _getDateTimeStr();\n  const series = segmentationsData.reduce((allSeries, curSegData) => {\n    return [...allSeries, curSegData.chartData.series];\n  }, []);\n\n  const instance = {\n    SOPClassUID: ChartDataSOPClassUid,\n    Modality: CHART_MODALITY,\n    SOPInstanceUID: utils.guid(),\n    SeriesDate: seriesDate,\n    SeriesTime: seriesTime,\n    SeriesInstanceUID: SEG_CHART_INSTANCE_UID,\n    StudyInstanceUID: segmentationsData[0].StudyInstanceUID,\n    StudyDescription: segmentationsData[0].StudyDescription,\n    SeriesNumber: 100,\n    SeriesDescription: 'Segmentation chart series data',\n    chartData: {\n      series,\n      axis: { ...segmentationsData[0].chartData.axis },\n    },\n  };\n\n  const seriesMetadata = {\n    StudyInstanceUID: instance.StudyInstanceUID,\n    StudyDescription: instance.StudyDescription,\n    SeriesInstanceUID: instance.SeriesInstanceUID,\n    SeriesDescription: instance.SeriesDescription,\n    SeriesNumber: instance.SeriesNumber,\n    SeriesTime: instance.SeriesTime,\n    SOPClassUID: instance.SOPClassUID,\n    Modality: instance.Modality,\n  };\n\n  return { seriesMetadata, instance };\n}\n\nfunction updateSegmentationsChartDisplaySet({ servicesManager }): void {\n  const { segmentationService, displaySetService } = servicesManager.services;\n  const segmentations = segmentationService.getSegmentations();\n  const { seriesMetadata, instance } =\n    _getInstanceFromSegmentations(segmentations, displaySetService) ?? {};\n\n  if (seriesMetadata && instance) {\n    // An event is triggered after adding the instance and the displaySet is created\n    DicomMetadataStore.addSeriesMetadata([seriesMetadata], true);\n    DicomMetadataStore.addInstances([instance], true);\n  }\n}\n\nexport { updateSegmentationsChartDisplaySet as default };\n","import * as importedActions from './actions';\nimport { utilities, Enums } from '@cornerstonejs/tools';\nimport { cache } from '@cornerstonejs/core';\n\nconst LABELMAP = Enums.SegmentationRepresentations.Labelmap;\n\nconst commandsModule = ({ commandsManager, servicesManager }) => {\n  const services = servicesManager.services;\n  const { displaySetService, viewportGridService, segmentationService } = services;\n\n  const actions = {\n    ...importedActions,\n    getDynamic4DDisplaySet: () => {\n      const displaySets = displaySetService.getActiveDisplaySets();\n\n      const dynamic4DDisplaySet = displaySets.find(displaySet => {\n        const anInstance = displaySet.instances?.[0];\n\n        if (anInstance) {\n          return (\n            anInstance.FrameReferenceTime !== undefined ||\n            anInstance.NumberOfTimeSlices !== undefined ||\n            anInstance.TemporalPositionIdentifier !== undefined\n          );\n        }\n\n        return false;\n      });\n\n      return dynamic4DDisplaySet;\n    },\n    getComputedDisplaySets: () => {\n      const displaySetCache = displaySetService.getDisplaySetCache();\n      const cachedDisplaySets = [...displaySetCache.values()];\n      const computedDisplaySets = cachedDisplaySets.filter(displaySet => {\n        return displaySet.isDerived;\n      });\n      return computedDisplaySets;\n    },\n    exportTimeReportCSV: ({ segmentations, config, options, summaryStats }) => {\n      const dynamic4DDisplaySet = actions.getDynamic4DDisplaySet();\n\n      const volumeId = dynamic4DDisplaySet?.displaySetInstanceUID;\n\n      // cache._volumeCache is a map that has a key that includes the volumeId\n      // it is not exactly the volumeId, but it is the key that includes the volumeId\n      // so we can't do cache._volumeCache.get(volumeId) we should iterate\n      // over the keys and find the one that includes the volumeId\n      let volumeCacheKey: string | undefined;\n\n      for (const [key] of cache._volumeCache) {\n        if (key.includes(volumeId)) {\n          volumeCacheKey = key;\n          break;\n        }\n      }\n\n      let dynamicVolume;\n      if (volumeCacheKey) {\n        dynamicVolume = cache.getVolume(volumeCacheKey);\n      }\n\n      const instance = dynamic4DDisplaySet.instances[0];\n\n      const csv = [];\n\n      // CSV header information with placeholder empty values for the metadata lines\n      csv.push(`Patient ID,${instance.PatientID},`);\n      csv.push(`Study Date,${instance.StudyDate},`);\n      csv.push(`StudyInstanceUID,${instance.StudyInstanceUID},`);\n      csv.push(`StudyDescription,${instance.StudyDescription},`);\n      csv.push(`SeriesInstanceUID,${instance.SeriesInstanceUID},`);\n\n      // empty line\n      csv.push('');\n      csv.push('');\n\n      // Helper function to calculate standard deviation\n      function calculateStandardDeviation(data) {\n        const n = data.length;\n        const mean = data.reduce((acc, value) => acc + value, 0) / n;\n        const squaredDifferences = data.map(value => (value - mean) ** 2);\n        const variance = squaredDifferences.reduce((acc, value) => acc + value, 0) / n;\n        const stdDeviation = Math.sqrt(variance);\n        return stdDeviation;\n      }\n\n      // Iterate through each segmentation to get the timeData and ijkCoords\n      segmentations.forEach((segmentation, segmentationIndex) => {\n        const [timeData, ijkCoords] = utilities.dynamicVolume.getDataInTime(dynamicVolume, {\n          maskVolumeId: segmentation.id,\n        }) as number[][];\n\n        if (summaryStats) {\n          // Adding column headers for pixel identifier and segmentation label ids\n          let headers = 'Operation,Segmentation Label ID';\n          const maxLength = dynamicVolume.numTimePoints;\n          for (let t = 0; t < maxLength; t++) {\n            headers += `,Time Point ${t}`;\n          }\n          csv.push(headers);\n          // // perform summary statistics on the timeData including for each time point, mean, median, min, max, and standard deviation for\n          // // all the voxels in the ROI\n          const mean = [];\n          const min = [];\n          const minIJK = [];\n          const max = [];\n          const maxIJK = [];\n          const std = [];\n\n          const numVoxels = timeData.length;\n          // Helper function to calculate standard deviation\n          for (let timeIndex = 0; timeIndex < maxLength; timeIndex++) {\n            // for each voxel in the ROI, get the value at the current time point\n            const voxelValues = [];\n            for (let voxelIndex = 0; voxelIndex < numVoxels; voxelIndex++) {\n              voxelValues.push(timeData[voxelIndex][timeIndex]);\n            }\n\n            mean.push(voxelValues.reduce((acc, value) => acc + value, 0) / numVoxels);\n            const minimum = Math.min(...voxelValues);\n            min.push(minimum);\n            minIJK.push(ijkCoords[voxelValues.indexOf(minimum)]);\n            const maximum = Math.max(...voxelValues);\n            max.push(maximum);\n            maxIJK.push(ijkCoords[voxelValues.indexOf(maximum)]);\n            std.push(calculateStandardDeviation(voxelValues));\n          }\n\n          let row = `Mean,${segmentation.label}`;\n          // Generate separate rows for each statistic\n          for (let t = 0; t < maxLength; t++) {\n            row += `,${mean[t]}`;\n          }\n\n          csv.push(row);\n\n          row = `Standard Deviation,${segmentation.label}`;\n          for (let t = 0; t < maxLength; t++) {\n            row += `,${std[t]}`;\n          }\n\n          csv.push(row);\n\n          row = `Min,${segmentation.label}`;\n          for (let t = 0; t < maxLength; t++) {\n            row += `,${min[t]}`;\n          }\n\n          csv.push(row);\n\n          row = `Max,${segmentation.label}`;\n          for (let t = 0; t < maxLength; t++) {\n            row += `,${max[t]}`;\n          }\n\n          csv.push(row);\n        } else {\n          // Adding column headers for pixel identifier and segmentation label ids\n          let headers = 'Pixel Identifier (IJK),Segmentation Label ID';\n          const maxLength = dynamicVolume.numTimePoints;\n          for (let t = 0; t < maxLength; t++) {\n            headers += `,Time Point ${t}`;\n          }\n          csv.push(headers);\n          // Assuming timeData and ijkCoords are of the same length\n          for (let i = 0; i < timeData.length; i++) {\n            // Generate the pixel identifier\n            const pixelIdentifier = `${ijkCoords[i][0]}_${ijkCoords[i][1]}_${ijkCoords[i][2]}`;\n\n            // Start a new row for the current pixel\n            let row = `${pixelIdentifier},${segmentation.label}`;\n\n            // Add time data points for this pixel\n            for (let t = 0; t < timeData[i].length; t++) {\n              row += `,${timeData[i][t]}`;\n            }\n\n            // Append the row to the CSV array\n            csv.push(row);\n          }\n        }\n      });\n\n      // Convert to CSV string\n      const csvContent = csv.join('\\n');\n\n      // Generate filename and trigger download\n      const filename = `${instance.PatientID}.csv`;\n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n      const link = document.createElement('a');\n      const url = URL.createObjectURL(blob);\n      link.setAttribute('href', url);\n      link.setAttribute('download', filename);\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    },\n    swapDynamicWithComputedDisplaySet: ({ displaySet }) => {\n      const computedDisplaySet = displaySet;\n\n      const displaySetCache = displaySetService.getDisplaySetCache();\n      const cachedDisplaySetKeys = [displaySetCache.keys()];\n      const { displaySetInstanceUID } = computedDisplaySet;\n      // Check to see if computed display set is already in cache\n      if (!cachedDisplaySetKeys.includes(displaySetInstanceUID)) {\n        displaySetCache.set(displaySetInstanceUID, computedDisplaySet);\n      }\n\n      // Get all viewports and their corresponding indices\n      const { viewports } = viewportGridService.getState();\n\n      // get the viewports in the grid\n      // iterate over them and find the ones that are showing a dynamic\n      // volume (displaySet), and replace that exact displaySet with the\n      // computed displaySet\n\n      const dynamic4DDisplaySet = actions.getDynamic4DDisplaySet();\n\n      const viewportsToUpdate = [];\n\n      for (const [key, value] of viewports) {\n        const viewport = value;\n        const viewportOptions = viewport.viewportOptions;\n        const { displaySetInstanceUIDs } = viewport;\n        const displaySetInstanceUIDIndex = displaySetInstanceUIDs.indexOf(\n          dynamic4DDisplaySet.displaySetInstanceUID\n        );\n        if (displaySetInstanceUIDIndex !== -1) {\n          const newViewport = {\n            viewportId: viewport.viewportId,\n            // merge the other displaySetInstanceUIDs with the new one\n            displaySetInstanceUIDs: [\n              ...displaySetInstanceUIDs.slice(0, displaySetInstanceUIDIndex),\n              displaySetInstanceUID,\n              ...displaySetInstanceUIDs.slice(displaySetInstanceUIDIndex + 1),\n            ],\n            viewportOptions: {\n              initialImageOptions: viewportOptions.initialImageOptions,\n              viewportType: 'volume',\n              orientation: viewportOptions.orientation,\n              background: viewportOptions.background,\n            },\n          };\n          viewportsToUpdate.push(newViewport);\n        }\n      }\n\n      viewportGridService.setDisplaySetsForViewports(viewportsToUpdate);\n    },\n    swapComputedWithDynamicDisplaySet: () => {\n      // Todo: this assumes there is only one dynamic display set in the viewer\n      const dynamicDisplaySet = actions.getDynamic4DDisplaySet();\n\n      const displaySetCache = displaySetService.getDisplaySetCache();\n      const cachedDisplaySetKeys = [...displaySetCache.keys()]; // Fix: Spread to get the array\n      const { displaySetInstanceUID } = dynamicDisplaySet;\n\n      // Check to see if dynamic display set is already in cache\n      if (!cachedDisplaySetKeys.includes(displaySetInstanceUID)) {\n        displaySetCache.set(displaySetInstanceUID, dynamicDisplaySet);\n      }\n\n      // Get all viewports and their corresponding indices\n      const { viewports } = viewportGridService.getState();\n\n      // Get the computed 4D display set\n      const computed4DDisplaySet = actions.getComputedDisplaySets()[0];\n\n      const viewportsToUpdate = [];\n\n      for (const [key, value] of viewports) {\n        const viewport = value;\n        const viewportOptions = viewport.viewportOptions;\n        const { displaySetInstanceUIDs } = viewport;\n        const displaySetInstanceUIDIndex = displaySetInstanceUIDs.indexOf(\n          computed4DDisplaySet.displaySetInstanceUID\n        );\n        if (displaySetInstanceUIDIndex !== -1) {\n          const newViewport = {\n            viewportId: viewport.viewportId,\n            // merge the other displaySetInstanceUIDs with the new one\n            displaySetInstanceUIDs: [\n              ...displaySetInstanceUIDs.slice(0, displaySetInstanceUIDIndex),\n              displaySetInstanceUID,\n              ...displaySetInstanceUIDs.slice(displaySetInstanceUIDIndex + 1),\n            ],\n            viewportOptions: {\n              initialImageOptions: viewportOptions.initialImageOptions,\n              viewportType: 'volume',\n              orientation: viewportOptions.orientation,\n              background: viewportOptions.background,\n            },\n          };\n          viewportsToUpdate.push(newViewport);\n        }\n      }\n\n      viewportGridService.setDisplaySetsForViewports(viewportsToUpdate);\n    },\n    createNewLabelMapForDynamicVolume: async ({ label }) => {\n      const { viewports, activeViewportId } = viewportGridService.getState();\n\n      // get the dynamic 4D display set\n      const dynamic4DDisplaySet = actions.getDynamic4DDisplaySet();\n      const dynamic4DDisplaySetInstanceUID = dynamic4DDisplaySet.displaySetInstanceUID;\n\n      // check if the dynamic 4D display set is in the display, if not we might have\n      // the computed volumes and we should choose them for the segmentation\n      // creation\n\n      let referenceDisplaySet;\n\n      const activeViewport = viewports.get(activeViewportId);\n      const activeDisplaySetInstanceUIDs = activeViewport.displaySetInstanceUIDs;\n      const dynamicIsInActiveViewport = activeDisplaySetInstanceUIDs.includes(\n        dynamic4DDisplaySetInstanceUID\n      );\n\n      if (dynamicIsInActiveViewport) {\n        referenceDisplaySet = dynamic4DDisplaySet;\n      }\n\n      if (!referenceDisplaySet) {\n        // try to see if there is any derived displaySet in the active viewport\n        // which is referencing the dynamic 4D display set\n\n        // Todo: this is wrong but I don't have time to fix it now\n        const cachedDisplaySets = displaySetService.getDisplaySetCache();\n        for (const [key, displaySet] of cachedDisplaySets) {\n          if (displaySet.referenceDisplaySetUID === dynamic4DDisplaySetInstanceUID) {\n            referenceDisplaySet = displaySet;\n            break;\n          }\n        }\n      }\n\n      if (!referenceDisplaySet) {\n        throw new Error('No reference display set found based on the dynamic data');\n      }\n\n      const segmentationId = await segmentationService.createSegmentationForDisplaySet(\n        referenceDisplaySet.displaySetInstanceUID,\n        { label }\n      );\n\n      // Add Segmentation to all toolGroupIds in the viewer\n      const toolGroupIds = Array.from(\n        viewports.values(),\n        viewport => viewport.viewportOptions.toolGroupId\n      );\n\n      const representationType = LABELMAP;\n\n      for (const toolGroupId of toolGroupIds) {\n        const hydrateSegmentation = true;\n        await segmentationService.addSegmentationRepresentationToToolGroup(\n          toolGroupId,\n          segmentationId,\n          hydrateSegmentation,\n          representationType\n        );\n\n        segmentationService.setActiveSegmentationForToolGroup(segmentationId, toolGroupId);\n      }\n\n      return segmentationId;\n    },\n  };\n\n  const definitions = {\n    updateSegmentationsChartDisplaySet: {\n      commandFn: actions.updateSegmentationsChartDisplaySet,\n      storeContexts: [],\n      options: {},\n    },\n    exportTimeReportCSV: {\n      commandFn: actions.exportTimeReportCSV,\n      storeContexts: [],\n      options: {},\n    },\n    swapDynamicWithComputedDisplaySet: {\n      commandFn: actions.swapDynamicWithComputedDisplaySet,\n      storeContexts: [],\n      options: {},\n    },\n    createNewLabelMapForDynamicVolume: {\n      commandFn: actions.createNewLabelMapForDynamicVolume,\n      storeContexts: [],\n      options: {},\n    },\n    swapComputedWithDynamicDisplaySet: {\n      commandFn: actions.swapComputedWithDynamicDisplaySet,\n      storeContexts: [],\n      options: {},\n    },\n  };\n\n  return {\n    actions,\n    definitions,\n    defaultContext: 'DYNAMIC-VOLUME:CORNERSTONE',\n  };\n};\n\nexport default commandsModule;\n","import React, { useEffect, useState } from 'react';\nimport {\n  InputDoubleRange,\n  Button,\n  PanelSection,\n  ButtonGroup,\n  IconButton,\n  InputNumber,\n  Icon,\n  Tooltip,\n} from '@ohif/ui';\n\nimport { Enums } from '@cornerstonejs/core';\n\nconst controlClassNames = {\n  sizeClassName: 'w-[58px] h-[28px]',\n  arrowsDirection: 'horizontal',\n  labelPosition: 'bottom',\n};\n\nconst Header = ({ title, tooltip }) => (\n  <div className=\"flex items-center space-x-1\">\n    <Tooltip\n      content={<div className=\"text-white\">{tooltip}</div>}\n      position=\"bottom-left\"\n      tight={true}\n      tooltipBoxClassName=\"max-w-xs p-2\"\n    >\n      <Icon\n        name=\"info-link\"\n        className=\"text-primary-active h-[14px] w-[14px]\"\n      />\n    </Tooltip>\n    <span className=\"text-aqua-pale text-[11px] uppercase\">{title}</span>\n  </div>\n);\n\nconst DynamicVolumeControls = ({\n  isPlaying,\n  onPlayPauseChange,\n  // fps\n  fps,\n  onFpsChange,\n  minFps,\n  maxFps,\n  // Frames\n  currentFrameIndex,\n  onFrameChange,\n  framesLength,\n  onGenerate,\n  onDoubleRangeChange,\n  onDynamicClick,\n}) => {\n  const [computedView, setComputedView] = useState(false);\n\n  const [computeViewMode, setComputeViewMode] = useState(Enums.DynamicOperatorType.SUM);\n\n  const [sliderRangeValues, setSliderRangeValues] = useState([framesLength / 4, framesLength / 2]);\n\n  useEffect(() => {\n    setSliderRangeValues([framesLength / 4, framesLength / 2]);\n  }, [framesLength]);\n\n  const handleSliderChange = newValues => {\n    onDoubleRangeChange(newValues);\n\n    if (newValues[0] === sliderRangeValues[0] && newValues[1] === sliderRangeValues[1]) {\n      return;\n    }\n    setSliderRangeValues(newValues);\n  };\n\n  return (\n    <div className=\"flex select-none flex-col\">\n      <PanelSection\n        title=\"Controls\"\n        childrenClassName=\"space-y-4 pb-5 px-5\"\n      >\n        <div className=\"mt-2\">\n          <Header\n            title=\"View\"\n            tooltip={\n              'Select the view mode, 4D to view the dynamic volume or Computed to view the computed volume'\n            }\n          />\n          <ButtonGroup className=\"mt-2 w-full\">\n            <button\n              className=\"w-1/2\"\n              onClick={() => {\n                setComputedView(false);\n                onDynamicClick?.();\n              }}\n            >\n              4D\n            </button>\n            <button\n              className=\"w-1/2\"\n              onClick={() => {\n                setComputedView(true);\n              }}\n            >\n              Computed\n            </button>\n          </ButtonGroup>\n        </div>\n        <div>\n          <FrameControls\n            onPlayPauseChange={onPlayPauseChange}\n            isPlaying={isPlaying}\n            computedView={computedView}\n            // fps\n            fps={fps}\n            onFpsChange={onFpsChange}\n            minFps={minFps}\n            maxFps={maxFps}\n            //\n            framesLength={framesLength}\n            onFrameChange={onFrameChange}\n            currentFrameIndex={currentFrameIndex}\n          />\n        </div>\n        <div className={`mt-6 flex flex-col ${computedView ? '' : 'ohif-disabled'}`}>\n          <Header\n            title=\"Computed Operation\"\n            tooltip={\n              <div>\n                Operation Buttons (SUM, AVERAGE, SUBTRACT): Select the mathematical operation to be\n                applied to the data set.\n                <br></br> Range Slider: Choose the numeric range within which the operation will be\n                performed.\n                <br></br>Generate Button: Execute the chosen operation on the specified range of\n                data.{' '}\n              </div>\n            }\n          />\n          <ButtonGroup\n            className={`mt-2 w-full `}\n            separated={true}\n          >\n            <button\n              className=\"w-1/2\"\n              onClick={() => setComputeViewMode(Enums.DynamicOperatorType.SUM)}\n            >\n              {Enums.DynamicOperatorType.SUM.toString().toUpperCase()}\n            </button>\n            <button\n              className=\"w-1/2\"\n              onClick={() => setComputeViewMode(Enums.DynamicOperatorType.AVERAGE)}\n            >\n              {Enums.DynamicOperatorType.AVERAGE.toString().toUpperCase()}\n            </button>\n            <button\n              className=\"w-1/2\"\n              onClick={() => setComputeViewMode(Enums.DynamicOperatorType.SUBTRACT)}\n            >\n              {Enums.DynamicOperatorType.SUBTRACT.toString().toUpperCase()}\n            </button>\n          </ButtonGroup>\n          <div className=\"w-ful mt-2\">\n            <InputDoubleRange\n              values={sliderRangeValues}\n              onChange={handleSliderChange}\n              minValue={0}\n              showLabel={true}\n              allowNumberEdit={true}\n              maxValue={framesLength}\n              step={1}\n            />\n          </div>\n          <Button\n            className=\"mt-2 !h-[26px] !w-[115px] self-start !p-0\"\n            onClick={() => {\n              onGenerate(computeViewMode);\n            }}\n          >\n            Generate\n          </Button>\n        </div>\n      </PanelSection>\n    </div>\n  );\n};\n\nexport default DynamicVolumeControls;\n\nfunction FrameControls({\n  isPlaying,\n  onPlayPauseChange,\n  fps,\n  minFps,\n  maxFps,\n  onFpsChange,\n  framesLength,\n  onFrameChange,\n  currentFrameIndex,\n  computedView,\n}) {\n  const getPlayPauseIconName = () => (isPlaying ? 'icon-pause' : 'icon-play');\n\n  return (\n    <div className={computedView && 'ohif-disabled'}>\n      <Header\n        title=\"4D Controls\"\n        tooltip={\n          <div>\n            Play/Pause Button: Begin or pause the animation of the 4D visualization. <br></br> Frame\n            Selector: Navigate through individual frames of the 4D data. <br></br> FPS (Frames Per\n            Second) Selector: Adjust the playback speed of the animation.\n          </div>\n        }\n      />\n      <div className=\"mt-3 flex justify-between\">\n        <IconButton\n          className=\"bg-customblue-30 h-[26px] w-[58px] rounded-[4px]\"\n          onClick={() => onPlayPauseChange(!isPlaying)}\n        >\n          <Icon\n            name={getPlayPauseIconName()}\n            className=\" active:text-primary-light hover:bg-customblue-300 h-[24px] w-[24px] cursor-pointer text-white\"\n          />\n        </IconButton>\n        <InputNumber\n          value={currentFrameIndex}\n          onChange={onFrameChange}\n          minValue={0}\n          maxValue={framesLength}\n          label=\"Frame\"\n          {...controlClassNames}\n        />\n        <InputNumber\n          value={fps}\n          onChange={onFpsChange}\n          minValue={minFps}\n          maxValue={maxFps}\n          {...controlClassNames}\n          label=\"FPS\"\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { useCine, useViewportGrid } from '@ohif/ui';\nimport { cache, utilities as csUtils, volumeLoader, eventTarget } from '@cornerstonejs/core';\nimport { Enums } from '@cornerstonejs/streaming-image-volume-loader';\nimport { utilities as cstUtils } from '@cornerstonejs/tools';\nimport DynamicVolumeControls from './DynamicVolumeControls';\n\nconst SOPClassHandlerId = '@ohif/extension-default.sopClassHandlerModule.stack';\n\nexport default function PanelGenerateImage({ servicesManager, commandsManager }) {\n  const { cornerstoneViewportService, viewportGridService, displaySetService } =\n    servicesManager.services;\n\n  const [{ isCineEnabled }, cineService] = useCine();\n  const [{ activeViewportId }] = useViewportGrid();\n\n  //\n  const [timePointsRange, setTimePointsRange] = useState([]);\n  const [timePointsRangeToUseForGenerate, setTimePointsRangeToUseForGenerate] = useState([]);\n  const [computedDisplaySet, setComputedDisplaySet] = useState(null);\n  const [dynamicVolume, setDynamicVolume] = useState(null);\n  const [frameRate, setFrameRate] = useState(20);\n  const [isPlaying, setIsPlaying] = useState(isCineEnabled);\n  const [timePointRendered, setTimePointRendered] = useState(null);\n  const [displayingComputed, setDisplayingComputed] = useState(false);\n\n  //\n  const uuidComputedVolume = useRef(csUtils.uuidv4());\n  const uuidDynamicVolume = useRef(null);\n  const computedVolumeId = `cornerstoneStreamingImageVolume:${uuidComputedVolume.current}`;\n\n  useEffect(() => {\n    const evt = cornerstoneViewportService.EVENTS.VIEWPORT_DATA_CHANGED;\n\n    const { unsubscribe } = cornerstoneViewportService.subscribe(evt, evtDetails => {\n      evtDetails.viewportData.data.forEach(volumeData => {\n        if (volumeData.volume.isDynamicVolume()) {\n          setDynamicVolume(volumeData.volume);\n          uuidDynamicVolume.current = volumeData.displaySetInstanceUID;\n          setTimePointsRange([1, volumeData.volume.numTimePoints]);\n        }\n      });\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, [cornerstoneViewportService]);\n\n  useEffect(() => {\n    const { unsubscribe } = servicesManager.services.cineService.subscribe(\n      servicesManager.services.cineService.EVENTS.CINE_STATE_CHANGED,\n      evt => {\n        setIsPlaying(evt.isPlaying);\n      }\n    );\n\n    return () => {\n      unsubscribe();\n    };\n  }, [cineService]);\n\n  useEffect(() => {\n    const displaySetUIDs = viewportGridService.getDisplaySetsUIDsForViewport(activeViewportId);\n\n    if (!displaySetUIDs || displaySetUIDs.length === 0) {\n      return;\n    }\n\n    const displaySets = displaySetUIDs.map(displaySetUID =>\n      displaySetService.getDisplaySetByUID(displaySetUID)\n    );\n\n    const dynamicVolumeDisplaySet = displaySets.find(displaySet => displaySet.isDynamicVolume);\n\n    if (!dynamicVolumeDisplaySet) {\n      return;\n    }\n\n    const dynamicVolume = cache\n      .getVolumes()\n      .find(volume => volume.volumeId.includes(dynamicVolumeDisplaySet.displaySetInstanceUID));\n\n    if (!dynamicVolume) {\n      return;\n    }\n\n    setDynamicVolume(dynamicVolume);\n    uuidDynamicVolume.current = dynamicVolumeDisplaySet.displaySetInstanceUID;\n    setTimePointsRange([1, dynamicVolume.numTimePoints]);\n  }, [activeViewportId, cornerstoneViewportService]);\n\n  useEffect(() => {\n    // ~~ Subscription\n    const evt = Enums.Events.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED;\n\n    const callback = evt => {\n      setTimePointRendered(evt.detail.timePointIndex);\n    };\n\n    eventTarget.addEventListener(evt, callback);\n\n    return () => {\n      eventTarget.removeEventListener(evt, callback);\n    };\n  }, [cornerstoneViewportService]);\n\n  function renderGeneratedImage(displaySet) {\n    commandsManager.runCommand('swapDynamicWithComputedDisplaySet', {\n      displaySet,\n    });\n\n    setDisplayingComputed(true);\n  }\n\n  function renderDynamicImage(displaySet) {\n    commandsManager.runCommand('swapComputedWithDynamicDisplaySet');\n  }\n\n  // Get computed volume from cache, calculate the data across the time frames,\n  // set the scalar data to the computedVolume, and create displaySet\n  async function onGenerateImage(operationName) {\n    const dynamicVolumeId = dynamicVolume.volumeId;\n\n    if (!dynamicVolumeId) {\n      return;\n    }\n\n    let computedVolume = cache.getVolume(computedVolumeId);\n\n    if (!computedVolume) {\n      await createComputedVolume(dynamicVolumeId, computedVolumeId);\n      computedVolume = cache.getVolume(computedVolumeId);\n    }\n\n    const vals = timePointsRangeToUseForGenerate;\n\n    const targets = Array.from({ length: vals[1] - vals[0] + 1 }, (_, i) => i + vals[0]);\n\n    const dataInTime = cstUtils.dynamicVolume.generateImageFromTimeData(\n      dynamicVolume,\n      operationName,\n      operationName === 'SUBTRACT' ? vals : targets\n    );\n\n    // Add loadStatus.loaded to computed volume and set to true\n    computedVolume.loadStatus = {};\n    computedVolume.loadStatus.loaded = true;\n    // Set computed scalar data to volume\n    const scalarData = computedVolume.getScalarData();\n    scalarData.set(dataInTime);\n\n    // If computed display set does not exist, create an object to be used as\n    // the displaySet. If it does exist, update the image data and vtkTexture\n    if (!computedDisplaySet) {\n      const displaySet = {\n        volumeLoaderSchema: computedVolume.volumeId.split(':')[0],\n        displaySetInstanceUID: uuidComputedVolume.current,\n        SOPClassHandlerId: SOPClassHandlerId,\n        Modality: dynamicVolume.metadata.Modality,\n        isMultiFrame: false,\n        numImageFrames: 1,\n        uid: uuidComputedVolume.current,\n        referenceDisplaySetUID: dynamicVolume.volumeId.split(':')[1],\n        madeInClient: true,\n        FrameOfReferenceUID: dynamicVolume.metadata.FrameOfReferenceUID,\n        isDerived: true,\n      };\n      setComputedDisplaySet(displaySet);\n      renderGeneratedImage(displaySet);\n    } else {\n      commandsManager.runCommand('updateVolumeData', {\n        volume: computedVolume,\n      });\n      // Check if viewport is currently displaying the computed volume, if so,\n      // call render on the viewports to update the image, if not, call\n      // renderGeneratedImage\n      // if (!cache.getVolume(dynamicVolumeId)) {\n      //   for (const viewportId of viewports.keys()) {\n      //     const viewportForRendering =\n      //       cornerstoneViewportService.getCornerstoneViewport(viewportId);\n      //     viewportForRendering.render();\n      //   }\n      // } else {\n      cornerstoneViewportService.getRenderingEngine().render();\n      renderGeneratedImage(computedDisplaySet);\n      // }\n    }\n  }\n\n  const onPlayPauseChange = isPlaying => {\n    isPlaying ? handlePlay() : handleStop();\n  };\n\n  const handlePlay = () => {\n    setIsPlaying(true);\n    const viewportInfo = cornerstoneViewportService.getViewportInfo(activeViewportId);\n\n    if (!viewportInfo) {\n      return;\n    }\n\n    const { element } = viewportInfo;\n    cineService.playClip(element, { framesPerSecond: frameRate, viewportId: activeViewportId });\n  };\n\n  const handleStop = () => {\n    setIsPlaying(false);\n    const { element } = cornerstoneViewportService.getViewportInfo(activeViewportId);\n    cineService.stopClip(element);\n  };\n\n  const handleSetFrameRate = newFrameRate => {\n    setFrameRate(newFrameRate);\n    handleStop();\n    handlePlay();\n  };\n\n  function handleSliderChange(newValues) {\n    if (\n      newValues[0] === timePointsRangeToUseForGenerate[0] &&\n      newValues[1] === timePointsRangeToUseForGenerate[1]\n    ) {\n      return;\n    }\n\n    setTimePointsRangeToUseForGenerate(newValues);\n  }\n\n  if (!dynamicVolume || timePointsRange.length === 0) {\n    return null;\n  }\n\n  return (\n    <DynamicVolumeControls\n      fps={frameRate}\n      isPlaying={isPlaying}\n      onPlayPauseChange={onPlayPauseChange}\n      minFps={1}\n      maxFps={50}\n      currentFrameIndex={timePointRendered}\n      onFpsChange={handleSetFrameRate}\n      framesLength={timePointsRange[1]}\n      onFrameChange={timePointIndex => {\n        dynamicVolume.timePointIndex = timePointIndex;\n      }}\n      onGenerate={onGenerateImage}\n      onDynamicClick={displayingComputed ? () => renderDynamicImage(computedDisplaySet) : null}\n      onDoubleRangeChange={handleSliderChange}\n    />\n  );\n}\n\nasync function createComputedVolume(dynamicVolumeId, computedVolumeId) {\n  if (!cache.getVolume(computedVolumeId)) {\n    const computedVolume = await volumeLoader.createAndCacheDerivedVolume(dynamicVolumeId, {\n      volumeId: computedVolumeId,\n    });\n    return computedVolume;\n  }\n}\n\nPanelGenerateImage.propTypes = {\n  servicesManager: PropTypes.shape({\n    services: PropTypes.shape({\n      measurementService: PropTypes.shape({\n        getMeasurements: PropTypes.func.isRequired,\n        subscribe: PropTypes.func.isRequired,\n        EVENTS: PropTypes.object.isRequired,\n        VALUE_TYPES: PropTypes.object.isRequired,\n      }).isRequired,\n    }).isRequired,\n  }).isRequired,\n};\n","import React from 'react';\nimport PanelGenerateImage from './PanelGenerateImage';\n\nfunction DynamicDataPanel({ servicesManager, commandsManager }) {\n  return (\n    <div\n      className=\"flex flex-col text-white\"\n      data-cy={'dynamic-volume-panel'}\n    >\n      <PanelGenerateImage\n        commandsManager={commandsManager}\n        servicesManager={servicesManager}\n      ></PanelGenerateImage>\n    </div>\n  );\n}\n\nexport default DynamicDataPanel;\n","import parseTag from './parse-tag'\n\nconst tagRE = /<[a-zA-Z0-9\\-\\!\\/](?:\"[^\"]*\"|'[^']*'|[^'\">])*>/g\nconst whitespaceRE = /^\\s*$/\n\n// re-used obj for quick lookups of components\nconst empty = Object.create(null)\n\nexport default function parse(html, options) {\n  options || (options = {})\n  options.components || (options.components = empty)\n  const result = []\n  const arr = []\n  let current\n  let level = -1\n  let inComponent = false\n\n  // handle text at top level\n  if (html.indexOf('<') !== 0) {\n    var end = html.indexOf('<')\n    result.push({\n      type: 'text',\n      content: end === -1 ? html : html.substring(0, end),\n    })\n  }\n\n  html.replace(tagRE, function (tag, index) {\n    if (inComponent) {\n      if (tag !== '</' + current.name + '>') {\n        return\n      } else {\n        inComponent = false\n      }\n    }\n    const isOpen = tag.charAt(1) !== '/'\n    const isComment = tag.startsWith('<!--')\n    const start = index + tag.length\n    const nextChar = html.charAt(start)\n    let parent\n\n    if (isComment) {\n      const comment = parseTag(tag)\n\n      // if we're at root, push new base node\n      if (level < 0) {\n        result.push(comment)\n        return result\n      }\n      parent = arr[level]\n      parent.children.push(comment)\n      return result\n    }\n\n    if (isOpen) {\n      level++\n\n      current = parseTag(tag)\n      if (current.type === 'tag' && options.components[current.name]) {\n        current.type = 'component'\n        inComponent = true\n      }\n\n      if (\n        !current.voidElement &&\n        !inComponent &&\n        nextChar &&\n        nextChar !== '<'\n      ) {\n        current.children.push({\n          type: 'text',\n          content: html.slice(start, html.indexOf('<', start)),\n        })\n      }\n\n      // if we're at root, push new base node\n      if (level === 0) {\n        result.push(current)\n      }\n\n      parent = arr[level - 1]\n\n      if (parent) {\n        parent.children.push(current)\n      }\n\n      arr[level] = current\n    }\n\n    if (!isOpen || current.voidElement) {\n      if (\n        level > -1 &&\n        (current.voidElement || current.name === tag.slice(2, -1))\n      ) {\n        level--\n        // move current up a level to match the end tag\n        current = level === -1 ? result : arr[level]\n      }\n      if (!inComponent && nextChar !== '<' && nextChar) {\n        // trailing text node\n        // if we're at the root, push a base text node. otherwise add as\n        // a child to the current node.\n        parent = level === -1 ? result : arr[level].children\n\n        // calculate correct end of the content slice in case there's\n        // no tag after the text node.\n        const end = html.indexOf('<', start)\n        let content = html.slice(start, end === -1 ? undefined : end)\n        // if a node is nothing but whitespace, collapse it as the spec states:\n        // https://www.w3.org/TR/html4/struct/text.html#h-9.1\n        if (whitespaceRE.test(content)) {\n          content = ' '\n        }\n        // don't add whitespace-only text nodes if they would be trailing text nodes\n        // or if they would be leading whitespace-only text nodes:\n        //  * end > -1 indicates this is not a trailing text node\n        //  * leading node is when level is -1 and parent has length 0\n        if ((end > -1 && level + parent.length >= 0) || content !== ' ') {\n          parent.push({\n            type: 'text',\n            content: content,\n          })\n        }\n      }\n    }\n  })\n\n  return result\n}\n","export function warn() {\n  if (console && console.warn) {\n    var _console;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (typeof args[0] === 'string') args[0] = \"react-i18next:: \".concat(args[0]);\n\n    (_console = console).warn.apply(_console, args);\n  }\n}\nvar alreadyWarned = {};\nexport function warnOnce() {\n  for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    args[_key2] = arguments[_key2];\n  }\n\n  if (typeof args[0] === 'string' && alreadyWarned[args[0]]) return;\n  if (typeof args[0] === 'string') alreadyWarned[args[0]] = new Date();\n  warn.apply(void 0, args);\n}\n\nvar loadedClb = function loadedClb(i18n, cb) {\n  return function () {\n    if (i18n.isInitialized) {\n      cb();\n    } else {\n      var initialized = function initialized() {\n        setTimeout(function () {\n          i18n.off('initialized', initialized);\n        }, 0);\n        cb();\n      };\n\n      i18n.on('initialized', initialized);\n    }\n  };\n};\n\nexport function loadNamespaces(i18n, ns, cb) {\n  i18n.loadNamespaces(ns, loadedClb(i18n, cb));\n}\nexport function loadLanguages(i18n, lng, ns, cb) {\n  if (typeof ns === 'string') ns = [ns];\n  ns.forEach(function (n) {\n    if (i18n.options.ns.indexOf(n) < 0) i18n.options.ns.push(n);\n  });\n  i18n.loadLanguages(lng, loadedClb(i18n, cb));\n}\n\nfunction oldI18nextHasLoadedNamespace(ns, i18n) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var lng = i18n.languages[0];\n  var fallbackLng = i18n.options ? i18n.options.fallbackLng : false;\n  var lastLng = i18n.languages[i18n.languages.length - 1];\n  if (lng.toLowerCase() === 'cimode') return true;\n\n  var loadNotPending = function loadNotPending(l, n) {\n    var loadState = i18n.services.backendConnector.state[\"\".concat(l, \"|\").concat(n)];\n    return loadState === -1 || loadState === 2;\n  };\n\n  if (options.bindI18n && options.bindI18n.indexOf('languageChanging') > -1 && i18n.services.backendConnector.backend && i18n.isLanguageChangingTo && !loadNotPending(i18n.isLanguageChangingTo, ns)) return false;\n  if (i18n.hasResourceBundle(lng, ns)) return true;\n  if (!i18n.services.backendConnector.backend || i18n.options.resources && !i18n.options.partialBundledLanguages) return true;\n  if (loadNotPending(lng, ns) && (!fallbackLng || loadNotPending(lastLng, ns))) return true;\n  return false;\n}\n\nexport function hasLoadedNamespace(ns, i18n) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (!i18n.languages || !i18n.languages.length) {\n    warnOnce('i18n.languages were undefined or empty', i18n.languages);\n    return true;\n  }\n\n  var isNewerI18next = i18n.options.ignoreJSONStructure !== undefined;\n\n  if (!isNewerI18next) {\n    return oldI18nextHasLoadedNamespace(ns, i18n, options);\n  }\n\n  return i18n.hasLoadedNamespace(ns, {\n    lng: options.lng,\n    precheck: function precheck(i18nInstance, loadNotPending) {\n      if (options.bindI18n && options.bindI18n.indexOf('languageChanging') > -1 && i18nInstance.services.backendConnector.backend && i18nInstance.isLanguageChangingTo && !loadNotPending(i18nInstance.isLanguageChangingTo, ns)) return false;\n    }\n  });\n}\nexport function getDisplayName(Component) {\n  return Component.displayName || Component.name || (typeof Component === 'string' && Component.length > 0 ? Component : 'Unknown');\n}","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","var matchHtmlEntity = /&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g;\nvar htmlEntities = {\n  '&amp;': '&',\n  '&#38;': '&',\n  '&lt;': '<',\n  '&#60;': '<',\n  '&gt;': '>',\n  '&#62;': '>',\n  '&apos;': \"'\",\n  '&#39;': \"'\",\n  '&quot;': '\"',\n  '&#34;': '\"',\n  '&nbsp;': ' ',\n  '&#160;': ' ',\n  '&copy;': '',\n  '&#169;': '',\n  '&reg;': '',\n  '&#174;': '',\n  '&hellip;': '',\n  '&#8230;': '',\n  '&#x2F;': '/',\n  '&#47;': '/'\n};\n\nvar unescapeHtmlEntity = function unescapeHtmlEntity(m) {\n  return htmlEntities[m];\n};\n\nexport var unescape = function unescape(text) {\n  return text.replace(matchHtmlEntity, unescapeHtmlEntity);\n};","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { unescape } from './unescape.js';\nvar defaultOptions = {\n  bindI18n: 'languageChanged',\n  bindI18nStore: '',\n  transEmptyNodeValue: '',\n  transSupportBasicHtmlNodes: true,\n  transWrapTextNodes: '',\n  transKeepBasicHtmlNodesFor: ['br', 'strong', 'i', 'p'],\n  useSuspense: true,\n  unescape: unescape\n};\nexport function setDefaults() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  defaultOptions = _objectSpread(_objectSpread({}, defaultOptions), options);\n}\nexport function getDefaults() {\n  return defaultOptions;\n}","import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _excluded = [\"format\"],\n    _excluded2 = [\"children\", \"count\", \"parent\", \"i18nKey\", \"context\", \"tOptions\", \"values\", \"defaults\", \"components\", \"ns\", \"i18n\", \"t\", \"shouldUnescape\"];\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { isValidElement, cloneElement, createElement } from 'react';\nimport HTML from 'html-parse-stringify';\nimport { warn, warnOnce } from './utils.js';\nimport { getDefaults } from './defaults.js';\nimport { getI18n } from './i18nInstance.js';\n\nfunction hasChildren(node, checkLength) {\n  if (!node) return false;\n  var base = node.props ? node.props.children : node.children;\n  if (checkLength) return base.length > 0;\n  return !!base;\n}\n\nfunction getChildren(node) {\n  if (!node) return [];\n  return node.props ? node.props.children : node.children;\n}\n\nfunction hasValidReactChildren(children) {\n  if (Object.prototype.toString.call(children) !== '[object Array]') return false;\n  return children.every(function (child) {\n    return isValidElement(child);\n  });\n}\n\nfunction getAsArray(data) {\n  return Array.isArray(data) ? data : [data];\n}\n\nfunction mergeProps(source, target) {\n  var newTarget = _objectSpread({}, target);\n\n  newTarget.props = Object.assign(source.props, target.props);\n  return newTarget;\n}\n\nexport function nodesToString(children, i18nOptions) {\n  if (!children) return '';\n  var stringNode = '';\n  var childrenArray = getAsArray(children);\n  var keepArray = i18nOptions.transSupportBasicHtmlNodes && i18nOptions.transKeepBasicHtmlNodesFor ? i18nOptions.transKeepBasicHtmlNodesFor : [];\n  childrenArray.forEach(function (child, childIndex) {\n    if (typeof child === 'string') {\n      stringNode += \"\".concat(child);\n    } else if (isValidElement(child)) {\n      var childPropsCount = Object.keys(child.props).length;\n      var shouldKeepChild = keepArray.indexOf(child.type) > -1;\n      var childChildren = child.props.children;\n\n      if (!childChildren && shouldKeepChild && childPropsCount === 0) {\n        stringNode += \"<\".concat(child.type, \"/>\");\n      } else if (!childChildren && (!shouldKeepChild || childPropsCount !== 0)) {\n        stringNode += \"<\".concat(childIndex, \"></\").concat(childIndex, \">\");\n      } else if (child.props.i18nIsDynamicList) {\n        stringNode += \"<\".concat(childIndex, \"></\").concat(childIndex, \">\");\n      } else if (shouldKeepChild && childPropsCount === 1 && typeof childChildren === 'string') {\n        stringNode += \"<\".concat(child.type, \">\").concat(childChildren, \"</\").concat(child.type, \">\");\n      } else {\n        var content = nodesToString(childChildren, i18nOptions);\n        stringNode += \"<\".concat(childIndex, \">\").concat(content, \"</\").concat(childIndex, \">\");\n      }\n    } else if (child === null) {\n      warn(\"Trans: the passed in value is invalid - seems you passed in a null child.\");\n    } else if (_typeof(child) === 'object') {\n      var format = child.format,\n          clone = _objectWithoutProperties(child, _excluded);\n\n      var keys = Object.keys(clone);\n\n      if (keys.length === 1) {\n        var value = format ? \"\".concat(keys[0], \", \").concat(format) : keys[0];\n        stringNode += \"{{\".concat(value, \"}}\");\n      } else {\n        warn(\"react-i18next: the passed in object contained more than one variable - the object should look like {{ value, format }} where format is optional.\", child);\n      }\n    } else {\n      warn(\"Trans: the passed in value is invalid - seems you passed in a variable like {number} - please pass in variables for interpolation as full objects like {{number}}.\", child);\n    }\n  });\n  return stringNode;\n}\n\nfunction renderNodes(children, targetString, i18n, i18nOptions, combinedTOpts, shouldUnescape) {\n  if (targetString === '') return [];\n  var keepArray = i18nOptions.transKeepBasicHtmlNodesFor || [];\n  var emptyChildrenButNeedsHandling = targetString && new RegExp(keepArray.join('|')).test(targetString);\n  if (!children && !emptyChildrenButNeedsHandling) return [targetString];\n  var data = {};\n\n  function getData(childs) {\n    var childrenArray = getAsArray(childs);\n    childrenArray.forEach(function (child) {\n      if (typeof child === 'string') return;\n      if (hasChildren(child)) getData(getChildren(child));else if (_typeof(child) === 'object' && !isValidElement(child)) Object.assign(data, child);\n    });\n  }\n\n  getData(children);\n  var ast = HTML.parse(\"<0>\".concat(targetString, \"</0>\"));\n\n  var opts = _objectSpread(_objectSpread({}, data), combinedTOpts);\n\n  function renderInner(child, node, rootReactNode) {\n    var childs = getChildren(child);\n    var mappedChildren = mapAST(childs, node.children, rootReactNode);\n    return hasValidReactChildren(childs) && mappedChildren.length === 0 ? childs : mappedChildren;\n  }\n\n  function pushTranslatedJSX(child, inner, mem, i, isVoid) {\n    if (child.dummy) child.children = inner;\n    mem.push(cloneElement(child, _objectSpread(_objectSpread({}, child.props), {}, {\n      key: i\n    }), isVoid ? undefined : inner));\n  }\n\n  function mapAST(reactNode, astNode, rootReactNode) {\n    var reactNodes = getAsArray(reactNode);\n    var astNodes = getAsArray(astNode);\n    return astNodes.reduce(function (mem, node, i) {\n      var translationContent = node.children && node.children[0] && node.children[0].content && i18n.services.interpolator.interpolate(node.children[0].content, opts, i18n.language);\n\n      if (node.type === 'tag') {\n        var tmp = reactNodes[parseInt(node.name, 10)];\n        if (!tmp && rootReactNode.length === 1 && rootReactNode[0][node.name]) tmp = rootReactNode[0][node.name];\n        if (!tmp) tmp = {};\n        var child = Object.keys(node.attrs).length !== 0 ? mergeProps({\n          props: node.attrs\n        }, tmp) : tmp;\n        var isElement = isValidElement(child);\n        var isValidTranslationWithChildren = isElement && hasChildren(node, true) && !node.voidElement;\n        var isEmptyTransWithHTML = emptyChildrenButNeedsHandling && _typeof(child) === 'object' && child.dummy && !isElement;\n        var isKnownComponent = _typeof(children) === 'object' && children !== null && Object.hasOwnProperty.call(children, node.name);\n\n        if (typeof child === 'string') {\n          var value = i18n.services.interpolator.interpolate(child, opts, i18n.language);\n          mem.push(value);\n        } else if (hasChildren(child) || isValidTranslationWithChildren) {\n            var inner = renderInner(child, node, rootReactNode);\n            pushTranslatedJSX(child, inner, mem, i);\n          } else if (isEmptyTransWithHTML) {\n          var _inner = mapAST(reactNodes, node.children, rootReactNode);\n\n          mem.push(cloneElement(child, _objectSpread(_objectSpread({}, child.props), {}, {\n            key: i\n          }), _inner));\n        } else if (Number.isNaN(parseFloat(node.name))) {\n          if (isKnownComponent) {\n            var _inner2 = renderInner(child, node, rootReactNode);\n\n            pushTranslatedJSX(child, _inner2, mem, i, node.voidElement);\n          } else if (i18nOptions.transSupportBasicHtmlNodes && keepArray.indexOf(node.name) > -1) {\n            if (node.voidElement) {\n              mem.push(createElement(node.name, {\n                key: \"\".concat(node.name, \"-\").concat(i)\n              }));\n            } else {\n              var _inner3 = mapAST(reactNodes, node.children, rootReactNode);\n\n              mem.push(createElement(node.name, {\n                key: \"\".concat(node.name, \"-\").concat(i)\n              }, _inner3));\n            }\n          } else if (node.voidElement) {\n            mem.push(\"<\".concat(node.name, \" />\"));\n          } else {\n            var _inner4 = mapAST(reactNodes, node.children, rootReactNode);\n\n            mem.push(\"<\".concat(node.name, \">\").concat(_inner4, \"</\").concat(node.name, \">\"));\n          }\n        } else if (_typeof(child) === 'object' && !isElement) {\n          var content = node.children[0] ? translationContent : null;\n          if (content) mem.push(content);\n        } else if (node.children.length === 1 && translationContent) {\n          mem.push(cloneElement(child, _objectSpread(_objectSpread({}, child.props), {}, {\n            key: i\n          }), translationContent));\n        } else {\n          mem.push(cloneElement(child, _objectSpread(_objectSpread({}, child.props), {}, {\n            key: i\n          })));\n        }\n      } else if (node.type === 'text') {\n        var wrapTextNodes = i18nOptions.transWrapTextNodes;\n\n        var _content = shouldUnescape ? i18nOptions.unescape(i18n.services.interpolator.interpolate(node.content, opts, i18n.language)) : i18n.services.interpolator.interpolate(node.content, opts, i18n.language);\n\n        if (wrapTextNodes) {\n          mem.push(createElement(wrapTextNodes, {\n            key: \"\".concat(node.name, \"-\").concat(i)\n          }, _content));\n        } else {\n          mem.push(_content);\n        }\n      }\n\n      return mem;\n    }, []);\n  }\n\n  var result = mapAST([{\n    dummy: true,\n    children: children || []\n  }], ast, getAsArray(children || []));\n  return getChildren(result[0]);\n}\n\nexport function Trans(_ref) {\n  var children = _ref.children,\n      count = _ref.count,\n      parent = _ref.parent,\n      i18nKey = _ref.i18nKey,\n      context = _ref.context,\n      _ref$tOptions = _ref.tOptions,\n      tOptions = _ref$tOptions === void 0 ? {} : _ref$tOptions,\n      values = _ref.values,\n      defaults = _ref.defaults,\n      components = _ref.components,\n      ns = _ref.ns,\n      i18nFromProps = _ref.i18n,\n      tFromProps = _ref.t,\n      shouldUnescape = _ref.shouldUnescape,\n      additionalProps = _objectWithoutProperties(_ref, _excluded2);\n\n  var i18n = i18nFromProps || getI18n();\n\n  if (!i18n) {\n    warnOnce('You will need to pass in an i18next instance by using i18nextReactModule');\n    return children;\n  }\n\n  var t = tFromProps || i18n.t.bind(i18n) || function (k) {\n    return k;\n  };\n\n  if (context) tOptions.context = context;\n\n  var reactI18nextOptions = _objectSpread(_objectSpread({}, getDefaults()), i18n.options && i18n.options.react);\n\n  var namespaces = ns || t.ns || i18n.options && i18n.options.defaultNS;\n  namespaces = typeof namespaces === 'string' ? [namespaces] : namespaces || ['translation'];\n  var defaultValue = defaults || nodesToString(children, reactI18nextOptions) || reactI18nextOptions.transEmptyNodeValue || i18nKey;\n  var hashTransKey = reactI18nextOptions.hashTransKey;\n  var key = i18nKey || (hashTransKey ? hashTransKey(defaultValue) : defaultValue);\n  var interpolationOverride = values ? tOptions.interpolation : {\n    interpolation: _objectSpread(_objectSpread({}, tOptions.interpolation), {}, {\n      prefix: '#$?',\n      suffix: '?$#'\n    })\n  };\n\n  var combinedTOpts = _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, tOptions), {}, {\n    count: count\n  }, values), interpolationOverride), {}, {\n    defaultValue: defaultValue,\n    ns: namespaces\n  });\n\n  var translation = key ? t(key, combinedTOpts) : defaultValue;\n  var content = renderNodes(components || children, translation, i18n, reactI18nextOptions, combinedTOpts, shouldUnescape);\n  var useAsParent = parent !== undefined ? parent : reactI18nextOptions.defaultTransParent;\n  return useAsParent ? createElement(useAsParent, additionalProps, content) : content;\n}","var i18nInstance;\nexport function setI18n(instance) {\n  i18nInstance = instance;\n}\nexport function getI18n() {\n  return i18nInstance;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { createContext } from 'react';\nimport { getDefaults, setDefaults } from './defaults.js';\nimport { getI18n, setI18n } from './i18nInstance.js';\nimport { initReactI18next } from './initReactI18next.js';\nexport { getDefaults, setDefaults, getI18n, setI18n, initReactI18next };\nexport var I18nContext = createContext();\nexport var ReportNamespaces = function () {\n  function ReportNamespaces() {\n    _classCallCheck(this, ReportNamespaces);\n\n    this.usedNamespaces = {};\n  }\n\n  _createClass(ReportNamespaces, [{\n    key: \"addUsedNamespaces\",\n    value: function addUsedNamespaces(namespaces) {\n      var _this = this;\n\n      namespaces.forEach(function (ns) {\n        if (!_this.usedNamespaces[ns]) _this.usedNamespaces[ns] = true;\n      });\n    }\n  }, {\n    key: \"getUsedNamespaces\",\n    value: function getUsedNamespaces() {\n      return Object.keys(this.usedNamespaces);\n    }\n  }]);\n\n  return ReportNamespaces;\n}();\nexport function composeInitialProps(ForComponent) {\n  return function (ctx) {\n    return new Promise(function (resolve) {\n      var i18nInitialProps = getInitialProps();\n\n      if (ForComponent.getInitialProps) {\n        ForComponent.getInitialProps(ctx).then(function (componentsInitialProps) {\n          resolve(_objectSpread(_objectSpread({}, componentsInitialProps), i18nInitialProps));\n        });\n      } else {\n        resolve(i18nInitialProps);\n      }\n    });\n  };\n}\nexport function getInitialProps() {\n  var i18n = getI18n();\n  var namespaces = i18n.reportNamespaces ? i18n.reportNamespaces.getUsedNamespaces() : [];\n  var ret = {};\n  var initialI18nStore = {};\n  i18n.languages.forEach(function (l) {\n    initialI18nStore[l] = {};\n    namespaces.forEach(function (ns) {\n      initialI18nStore[l][ns] = i18n.getResourceBundle(l, ns) || {};\n    });\n  });\n  ret.initialI18nStore = initialI18nStore;\n  ret.initialLanguage = i18n.language;\n  return ret;\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect, useContext, useRef } from 'react';\nimport { getI18n, getDefaults, ReportNamespaces, I18nContext } from './context.js';\nimport { warnOnce, loadNamespaces, loadLanguages, hasLoadedNamespace } from './utils.js';\n\nvar usePrevious = function usePrevious(value, ignore) {\n  var ref = useRef();\n  useEffect(function () {\n    ref.current = ignore ? ref.current : value;\n  }, [value, ignore]);\n  return ref.current;\n};\n\nexport function useTranslation(ns) {\n  var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var i18nFromProps = props.i18n;\n\n  var _ref = useContext(I18nContext) || {},\n      i18nFromContext = _ref.i18n,\n      defaultNSFromContext = _ref.defaultNS;\n\n  var i18n = i18nFromProps || i18nFromContext || getI18n();\n  if (i18n && !i18n.reportNamespaces) i18n.reportNamespaces = new ReportNamespaces();\n\n  if (!i18n) {\n    warnOnce('You will need to pass in an i18next instance by using initReactI18next');\n\n    var notReadyT = function notReadyT(k, optsOrDefaultValue) {\n      if (typeof optsOrDefaultValue === 'string') return optsOrDefaultValue;\n      if (optsOrDefaultValue && _typeof(optsOrDefaultValue) === 'object' && typeof optsOrDefaultValue.defaultValue === 'string') return optsOrDefaultValue.defaultValue;\n      return Array.isArray(k) ? k[k.length - 1] : k;\n    };\n\n    var retNotReady = [notReadyT, {}, false];\n    retNotReady.t = notReadyT;\n    retNotReady.i18n = {};\n    retNotReady.ready = false;\n    return retNotReady;\n  }\n\n  if (i18n.options.react && i18n.options.react.wait !== undefined) warnOnce('It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.');\n\n  var i18nOptions = _objectSpread(_objectSpread(_objectSpread({}, getDefaults()), i18n.options.react), props);\n\n  var useSuspense = i18nOptions.useSuspense,\n      keyPrefix = i18nOptions.keyPrefix;\n  var namespaces = ns || defaultNSFromContext || i18n.options && i18n.options.defaultNS;\n  namespaces = typeof namespaces === 'string' ? [namespaces] : namespaces || ['translation'];\n  if (i18n.reportNamespaces.addUsedNamespaces) i18n.reportNamespaces.addUsedNamespaces(namespaces);\n  var ready = (i18n.isInitialized || i18n.initializedStoreOnce) && namespaces.every(function (n) {\n    return hasLoadedNamespace(n, i18n, i18nOptions);\n  });\n\n  function getT() {\n    return i18n.getFixedT(props.lng || null, i18nOptions.nsMode === 'fallback' ? namespaces : namespaces[0], keyPrefix);\n  }\n\n  var _useState = useState(getT),\n      _useState2 = _slicedToArray(_useState, 2),\n      t = _useState2[0],\n      setT = _useState2[1];\n\n  var joinedNS = namespaces.join();\n  if (props.lng) joinedNS = \"\".concat(props.lng).concat(joinedNS);\n  var previousJoinedNS = usePrevious(joinedNS);\n  var isMounted = useRef(true);\n  useEffect(function () {\n    var bindI18n = i18nOptions.bindI18n,\n        bindI18nStore = i18nOptions.bindI18nStore;\n    isMounted.current = true;\n\n    if (!ready && !useSuspense) {\n      if (props.lng) {\n        loadLanguages(i18n, props.lng, namespaces, function () {\n          if (isMounted.current) setT(getT);\n        });\n      } else {\n        loadNamespaces(i18n, namespaces, function () {\n          if (isMounted.current) setT(getT);\n        });\n      }\n    }\n\n    if (ready && previousJoinedNS && previousJoinedNS !== joinedNS && isMounted.current) {\n      setT(getT);\n    }\n\n    function boundReset() {\n      if (isMounted.current) setT(getT);\n    }\n\n    if (bindI18n && i18n) i18n.on(bindI18n, boundReset);\n    if (bindI18nStore && i18n) i18n.store.on(bindI18nStore, boundReset);\n    return function () {\n      isMounted.current = false;\n      if (bindI18n && i18n) bindI18n.split(' ').forEach(function (e) {\n        return i18n.off(e, boundReset);\n      });\n      if (bindI18nStore && i18n) bindI18nStore.split(' ').forEach(function (e) {\n        return i18n.store.off(e, boundReset);\n      });\n    };\n  }, [i18n, joinedNS]);\n  var isInitial = useRef(true);\n  useEffect(function () {\n    if (isMounted.current && !isInitial.current) {\n      setT(getT);\n    }\n\n    isInitial.current = false;\n  }, [i18n, keyPrefix]);\n  var ret = [t, i18n, ready];\n  ret.t = t;\n  ret.i18n = i18n;\n  ret.ready = ready;\n  if (ready) return ret;\n  if (!ready && !useSuspense) return ret;\n  throw new Promise(function (resolve) {\n    if (props.lng) {\n      loadLanguages(i18n, props.lng, namespaces, function () {\n        return resolve();\n      });\n    } else {\n      loadNamespaces(i18n, namespaces, function () {\n        return resolve();\n      });\n    }\n  });\n}","import React, { useState, useEffect } from 'react';\nimport { ActionButtons } from '@ohif/ui';\nimport { useTranslation } from 'react-i18next';\n\nfunction DynamicExport({ commandsManager, servicesManager, extensionManager }) {\n  const { segmentationService } = servicesManager.services;\n  const { t } = useTranslation('dynamicExport');\n\n  const [segmentations, setSegmentations] = useState(() => segmentationService.getSegmentations());\n\n  const actions = [\n    {\n      label: 'Export Time Data',\n      onClick: () => {\n        commandsManager.runCommand('exportTimeReportCSV', {\n          segmentations,\n          options: {\n            filename: 'TimeData.csv',\n          },\n        });\n      },\n      disabled: !segmentations?.length,\n    },\n    {\n      label: 'Export ROI Stats',\n      onClick: () => {\n        commandsManager.runCommand('exportTimeReportCSV', {\n          segmentations,\n          summaryStats: true,\n          options: {\n            filename: 'ROIStats.csv',\n          },\n        });\n      },\n      disabled: !segmentations?.length,\n    },\n  ];\n\n  /**\n   * Update UI based on segmentation changes (added, removed, updated)\n   */\n  useEffect(() => {\n    // ~~ Subscription\n    const added = segmentationService.EVENTS.SEGMENTATION_ADDED;\n    const updated = segmentationService.EVENTS.SEGMENTATION_UPDATED;\n    const removed = segmentationService.EVENTS.SEGMENTATION_REMOVED;\n    const subscriptions = [];\n\n    [added, updated, removed].forEach(evt => {\n      const { unsubscribe } = segmentationService.subscribe(evt, () => {\n        const segmentations = segmentationService.getSegmentations();\n        setSegmentations(segmentations);\n      });\n      subscriptions.push(unsubscribe);\n    });\n\n    return () => {\n      subscriptions.forEach(unsub => {\n        unsub();\n      });\n    };\n  }, []);\n\n  return (\n    <div>\n      <div className=\"mt-3 flex justify-center px-2\">\n        <ActionButtons\n          actions={actions}\n          t={t}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default DynamicExport;\n","import React from 'react';\nimport { DynamicDataPanel } from './panels';\nimport { Toolbox } from '@ohif/ui';\nimport DynamicExport from './panels/DynamicExport';\n\nfunction getPanelModule({ commandsManager, extensionManager, servicesManager }) {\n  const wrappedDynamicDataPanel = () => {\n    return (\n      <DynamicDataPanel\n        commandsManager={commandsManager}\n        servicesManager={servicesManager}\n        extensionManager={extensionManager}\n      />\n    );\n  };\n\n  const wrappedDynamicToolbox = () => {\n    return (\n      <>\n        <Toolbox\n          commandsManager={commandsManager}\n          servicesManager={servicesManager}\n          extensionManager={extensionManager}\n          buttonSectionId=\"dynamic-toolbox\"\n          title=\"Threshold Tools\"\n        />\n      </>\n    );\n  };\n\n  const wrappedDynamicExport = () => {\n    return (\n      <>\n        <DynamicExport\n          commandsManager={commandsManager}\n          servicesManager={servicesManager}\n          extensionManager={extensionManager}\n        />\n      </>\n    );\n  };\n\n  return [\n    {\n      name: 'dynamic-volume',\n      iconName: 'tab-4d',\n      iconLabel: '4D Workflow',\n      label: '4D Workflow',\n      component: wrappedDynamicDataPanel,\n    },\n    {\n      name: 'dynamic-toolbox',\n      iconName: 'tab-4d',\n      iconLabel: '4D Workflow',\n      label: 'Dynamic Toolbox',\n      component: wrappedDynamicToolbox,\n    },\n    {\n      name: 'dynamic-export',\n      iconName: 'tab-4d',\n      iconLabel: '4D Workflow',\n      label: '4D Workflow',\n      component: wrappedDynamicExport,\n    },\n  ];\n}\n\nexport default getPanelModule;\n","const DEFAULT_COLORMAP = '2hot';\nconst toolGroupIds = {\n  pt: 'dynamic4D-pt',\n  fusion: 'dynamic4D-fusion',\n  ct: 'dynamic4D-ct',\n};\n\nfunction getPTOptions({\n  colormap,\n  voiInverted,\n}: {\n  colormap?: {\n    name: string;\n    opacity:\n      | number\n      | {\n          value: number;\n          opacity: number;\n        }[];\n  };\n  voiInverted?: boolean;\n} = {}) {\n  return {\n    blendMode: 'MIP',\n    colormap,\n    voi: {\n      windowWidth: 5,\n      windowCenter: 2.5,\n    },\n    voiInverted,\n  };\n}\n\nfunction getPTViewports() {\n  const ptOptionsParams = {\n    colormap: {\n      name: DEFAULT_COLORMAP,\n      opacity: [\n        { value: 0, opacity: 0 },\n        { value: 0.1, opacity: 1 },\n        { value: 1, opacity: 1 },\n      ],\n    },\n    voiInverted: false,\n  };\n\n  return [\n    {\n      viewportOptions: {\n        viewportId: 'ptAxial',\n        viewportType: 'volume',\n        orientation: 'axial',\n        toolGroupId: toolGroupIds.pt,\n        initialImageOptions: {\n          preset: 'middle', // 'first', 'last', 'middle'\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'axialSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ptWLSync',\n            source: true,\n            target: true,\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ptDisplaySet',\n          options: { ...getPTOptions(ptOptionsParams) },\n        },\n      ],\n    },\n    {\n      viewportOptions: {\n        viewportId: 'ptSagittal',\n        viewportType: 'volume',\n        orientation: 'sagittal',\n        toolGroupId: toolGroupIds.pt,\n        initialImageOptions: {\n          preset: 'middle', // 'first', 'last', 'middle'\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'sagittalSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ptWLSync',\n            source: true,\n            target: true,\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ptDisplaySet',\n          options: { ...getPTOptions(ptOptionsParams) },\n        },\n      ],\n    },\n    {\n      viewportOptions: {\n        viewportId: 'ptCoronal',\n        viewportType: 'volume',\n        orientation: 'coronal',\n        toolGroupId: toolGroupIds.pt,\n        initialImageOptions: {\n          preset: 'middle', // 'first', 'last', 'middle'\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'coronalSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ptWLSync',\n            source: true,\n            target: true,\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ptDisplaySet',\n          options: { ...getPTOptions(ptOptionsParams) },\n        },\n      ],\n    },\n  ];\n}\n\nfunction getFusionViewports() {\n  const ptOptionsParams = {\n    colormap: {\n      name: DEFAULT_COLORMAP,\n      opacity: [\n        { value: 0, opacity: 0 },\n        { value: 0.1, opacity: 0.3 },\n        { value: 1, opacity: 0.3 },\n      ],\n    },\n  };\n\n  return [\n    {\n      viewportOptions: {\n        viewportId: 'fusionAxial',\n        viewportType: 'volume',\n        orientation: 'axial',\n        toolGroupId: toolGroupIds.fusion,\n        initialImageOptions: {\n          preset: 'middle', // 'first', 'last', 'middle'\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'axialSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ctWLSync',\n            source: false,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'fusionWLSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ptFusionWLSync',\n            source: false,\n            target: true,\n            options: {\n              syncInvertState: false,\n            },\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ctDisplaySet',\n        },\n        {\n          options: { ...getPTOptions(ptOptionsParams) },\n          id: 'ptDisplaySet',\n        },\n      ],\n    },\n    {\n      viewportOptions: {\n        viewportId: 'fusionSagittal',\n        viewportType: 'volume',\n        orientation: 'sagittal',\n        toolGroupId: toolGroupIds.fusion,\n        initialImageOptions: {\n          preset: 'middle', // 'first', 'last', 'middle'\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'sagittalSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ctWLSync',\n            source: false,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'fusionWLSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ptFusionWLSync',\n            source: false,\n            target: true,\n            options: {\n              syncInvertState: false,\n            },\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ctDisplaySet',\n        },\n        {\n          options: { ...getPTOptions(ptOptionsParams) },\n          id: 'ptDisplaySet',\n        },\n      ],\n    },\n    {\n      viewportOptions: {\n        viewportId: 'fusionCoronal',\n        viewportType: 'volume',\n        orientation: 'coronal',\n        toolGroupId: toolGroupIds.fusion,\n        initialImageOptions: {\n          preset: 'middle', // 'first', 'last', 'middle'\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'coronalSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ctWLSync',\n            source: false,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'fusionWLSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ptFusionWLSync',\n            source: false,\n            target: true,\n            options: {\n              syncInvertState: false,\n            },\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ctDisplaySet',\n        },\n        {\n          options: { ...getPTOptions(ptOptionsParams) },\n          id: 'ptDisplaySet',\n        },\n      ],\n    },\n  ];\n}\n\nfunction getSeriesChartViewport() {\n  return {\n    viewportOptions: {\n      viewportId: 'seriesChart',\n    },\n    displaySets: [\n      {\n        id: 'chartDisplaySet',\n        options: {\n          // This dataset does not require the download of any instance since it is pre-computed locally,\n          // but interleaveTopToBottom.ts was not loading any series because it consider that all viewports\n          // are a Cornerstone viewport which is not true in this case and it waits for all viewports to\n          // have called interleaveTopToBottom(...).\n          skipLoading: true,\n        },\n      },\n    ],\n  };\n}\n\nfunction getCTViewports() {\n  return [\n    {\n      viewportOptions: {\n        viewportId: 'ctAxial',\n        viewportType: 'volume',\n        orientation: 'axial',\n        toolGroupId: toolGroupIds.ct,\n        initialImageOptions: {\n          preset: 'middle', // 'first', 'last', 'middle'\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'axialSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ctWLSync',\n            source: true,\n            target: true,\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ctDisplaySet',\n        },\n      ],\n    },\n    {\n      viewportOptions: {\n        viewportId: 'ctSagittal',\n        viewportType: 'volume',\n        orientation: 'sagittal',\n        toolGroupId: toolGroupIds.ct,\n        initialImageOptions: {\n          preset: 'middle',\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'sagittalSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ctWLSync',\n            source: true,\n            target: true,\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ctDisplaySet',\n        },\n      ],\n    },\n    {\n      viewportOptions: {\n        viewportId: 'ctCoronal',\n        viewportType: 'volume',\n        orientation: 'coronal',\n        toolGroupId: toolGroupIds.ct,\n        initialImageOptions: {\n          preset: 'middle',\n        },\n        syncGroups: [\n          {\n            type: 'cameraPosition',\n            id: 'coronalSync',\n            source: true,\n            target: true,\n          },\n          {\n            type: 'voi',\n            id: 'ctWLSync',\n            source: true,\n            target: true,\n          },\n        ],\n      },\n      displaySets: [\n        {\n          id: 'ctDisplaySet',\n        },\n      ],\n    },\n  ];\n}\n\nconst defaultProtocol = {\n  id: 'default4D',\n  locked: true,\n  // Don't store this hanging protocol as it applies to the currently active\n  // display set by default\n  // cacheId: null,\n  hasUpdatedPriorsInformation: false,\n  name: 'Default',\n  createdDate: '2023-01-01T00:00:00.000Z',\n  modifiedDate: '2023-01-01T00:00:00.000Z',\n  availableTo: {},\n  editableBy: {},\n  imageLoadStrategy: 'default', // \"default\" , \"interleaveTopToBottom\",  \"interleaveCenter\"\n  protocolMatchingRules: [\n    {\n      attribute: 'ModalitiesInStudy',\n      constraint: {\n        contains: ['CT', 'PT'],\n      },\n    },\n  ],\n  // -1 would be used to indicate active only, whereas other values are\n  // the number of required priors referenced - so 0 means active with\n  // 0 or more priors.\n  numberOfPriorsReferenced: -1,\n  displaySetSelectors: {\n    defaultDisplaySetId: {\n      // Unused currently\n      imageMatchingRules: [],\n      // Matches displaysets, NOT series\n      seriesMatchingRules: [\n        // Try to match series with images by default, to prevent weird display\n        // on SEG/SR containing studies\n        {\n          attribute: 'numImageFrames',\n          constraint: {\n            greaterThan: { value: 0 },\n          },\n        },\n      ],\n      // Can be used to select matching studies\n      // studyMatchingRules: [],\n    },\n    ctDisplaySet: {\n      // Unused currently\n      imageMatchingRules: [],\n      // Matches displaysets, NOT series\n      seriesMatchingRules: [\n        {\n          attribute: 'Modality',\n          constraint: {\n            equals: {\n              value: 'CT',\n            },\n          },\n          required: true,\n        },\n        {\n          attribute: 'isReconstructable',\n          constraint: {\n            equals: {\n              value: true,\n            },\n          },\n          required: true,\n        },\n      ],\n      // Can be used to select matching studies\n      // studyMatchingRules: [],\n    },\n    ptDisplaySet: {\n      // Unused currently\n      imageMatchingRules: [],\n      // Matches displaysets, NOT series\n      seriesMatchingRules: [\n        {\n          attribute: 'Modality',\n          constraint: {\n            equals: 'PT',\n          },\n          required: true,\n        },\n        {\n          attribute: 'isReconstructable',\n          constraint: {\n            equals: {\n              value: true,\n            },\n          },\n          required: true,\n        },\n        {\n          attribute: 'SeriesDescription',\n          constraint: {\n            contains: 'Corrected',\n          },\n        },\n        {\n          weight: 2,\n          attribute: 'SeriesDescription',\n          constraint: {\n            doesNotContain: {\n              value: 'Uncorrected',\n            },\n          },\n        },\n\n        // Should we check if CorrectedImage contains ATTN?\n        // (0028,0051) (CorrectedImage): NORM\\DTIM\\ATTN\\SCAT\\RADL\\DECY\n      ],\n      // Can be used to select matching studies\n      // studyMatchingRules: [],\n    },\n    chartDisplaySet: {\n      // Unused currently\n      imageMatchingRules: [],\n      // Matches displaysets, NOT series\n      seriesMatchingRules: [\n        {\n          attribute: 'Modality',\n          constraint: {\n            equals: {\n              value: 'CHT',\n            },\n          },\n          required: true,\n        },\n      ],\n    },\n  },\n  stages: [\n    {\n      id: 'dataPreparation',\n      name: 'Data Preparation',\n      viewportStructure: {\n        layoutType: 'grid',\n        properties: {\n          rows: 1,\n          columns: 3,\n        },\n      },\n      viewports: [...getPTViewports()],\n      createdDate: '2023-01-01T00:00:00.000Z',\n    },\n\n    {\n      id: 'registration',\n      name: 'Registration',\n      viewportStructure: {\n        layoutType: 'grid',\n        properties: {\n          rows: 3,\n          columns: 3,\n        },\n      },\n      viewports: [...getFusionViewports(), ...getCTViewports(), ...getPTViewports()],\n      createdDate: '2023-01-01T00:00:00.000Z',\n    },\n\n    {\n      id: 'roiQuantification',\n      name: 'ROI Quantification',\n      viewportStructure: {\n        layoutType: 'grid',\n        properties: {\n          rows: 1,\n          columns: 3,\n        },\n      },\n      viewports: [...getFusionViewports()],\n      createdDate: '2023-01-01T00:00:00.000Z',\n    },\n\n    {\n      id: 'kineticAnalysis',\n      name: 'Kinetic Analysis',\n      viewportStructure: {\n        layoutType: 'grid',\n        properties: {\n          rows: 2,\n          columns: 3,\n          layoutOptions: [\n            {\n              x: 0,\n              y: 0,\n              width: 1 / 3,\n              height: 1 / 2,\n            },\n            {\n              x: 1 / 3,\n              y: 0,\n              width: 1 / 3,\n              height: 1 / 2,\n            },\n            {\n              x: 2 / 3,\n              y: 0,\n              width: 1 / 3,\n              height: 1 / 2,\n            },\n            {\n              x: 0,\n              y: 1 / 2,\n              width: 1,\n              height: 1 / 2,\n            },\n          ],\n        },\n      },\n      viewports: [...getFusionViewports(), getSeriesChartViewport()],\n      createdDate: '2023-01-01T00:00:00.000Z',\n    },\n  ],\n};\n\n/**\n * HangingProtocolModule should provide a list of hanging protocols that will be\n * available in OHIF for Modes to use to decide on the structure of the viewports\n * and also the series that hung in the viewports. Each hanging protocol is defined by\n * { name, protocols}. Examples include the default hanging protocol provided by\n * the default extension that shows 2x2 viewports.\n */\n\nfunction getHangingProtocolModule() {\n  return [\n    {\n      name: defaultProtocol.id,\n      protocol: defaultProtocol,\n    },\n  ];\n}\n\nexport default getHangingProtocolModule;\n","import { id } from './id';\nimport commandsModule from './commandsModule';\nimport getPanelModule from './getPanelModule';\nimport getHangingProtocolModule from './getHangingProtocolModule';\nimport { cache } from '@cornerstonejs/core';\n\n/**\n * You can remove any of the following modules if you don't need them.\n */\nconst dynamicVolumeExtension = {\n  /**\n   * Only required property. Should be a unique value across all extensions.\n   * You ID can be anything you want, but it should be unique.\n   */\n  id,\n\n  /**\n   * Perform any pre-registration tasks here. This is called before the extension\n   * is registered. Usually we run tasks such as: configuring the libraries\n   * (e.g. cornerstone, cornerstoneTools, ...) or registering any services that\n   * this extension is providing.\n   */\n  preRegistration: ({ servicesManager, commandsManager, configuration = {} }) => {\n    // TODO: look for the right fix\n    cache.setMaxCacheSize(5 * 1024 * 1024 * 1024);\n  },\n  /**\n   * PanelModule should provide a list of panels that will be available in OHIF\n   * for Modes to consume and render. Each panel is defined by a {name,\n   * iconName, iconLabel, label, component} object. Example of a panel module\n   * is the StudyBrowserPanel that is provided by the default extension in OHIF.\n   */\n  getPanelModule,\n  /**\n   * ViewportModule should provide a list of viewports that will be available in OHIF\n   * for Modes to consume and use in the viewports. Each viewport is defined by\n   * {name, component} object. Example of a viewport module is the CornerstoneViewport\n   * that is provided by the Cornerstone extension in OHIF.\n   */\n  getHangingProtocolModule,\n  /**\n   * CommandsModule should provide a list of commands that will be available in OHIF\n   * for Modes to consume and use in the viewports. Each command is defined by\n   * an object of { actions, definitions, defaultContext } where actions is an\n   * object of functions, definitions is an object of available commands, their\n   * options, and defaultContext is the default context for the command to run against.\n   */\n  getCommandsModule: ({ servicesManager, commandsManager, extensionManager }) => {\n    return commandsModule({\n      servicesManager,\n      commandsManager,\n      extensionManager,\n    });\n  },\n};\n\nexport { dynamicVolumeExtension as default };\n"],"names":["root","factory","exports","module","require","define","amd","globalThis","__WEBPACK_EXTERNAL_MODULE__557__","__WEBPACK_EXTERNAL_MODULE__121__","__WEBPACK_EXTERNAL_MODULE__713__","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__307__","getOwnPropertySymbols","Object","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","assign","test1","String","getOwnPropertyNames","test2","i","fromCharCode","map","n","join","test3","split","forEach","letter","keys","err","shouldUseNative","target","source","from","symbols","to","val","TypeError","toObject","s","arguments","length","key","call","ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","shim","props","propName","componentName","location","propFullName","secret","Error","name","getShim","isRequired","ReactPropTypes","array","bigint","bool","func","number","object","string","symbol","any","arrayOf","element","elementType","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","l","p","Fragment","StrictMode","Profiler","q","r","t","Suspense","u","v","Symbol","for","w","x","iterator","z","a","b","c","encodeURIComponent","A","isMounted","enqueueForceUpdate","enqueueReplaceState","enqueueSetState","B","C","this","context","refs","updater","D","E","isReactComponent","setState","forceUpdate","F","constructor","isPureReactComponent","G","current","H","I","ref","__self","__source","J","e","d","k","h","g","children","f","Array","m","defaultProps","$$typeof","type","_owner","L","M","N","replace","escape","toString","O","isArray","K","push","y","next","done","value","P","Q","_status","_result","then","default","R","S","T","ReactCurrentDispatcher","ReactCurrentBatchConfig","transition","ReactCurrentOwner","IsSomeRendererActing","Children","apply","count","toArray","only","Component","PureComponent","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","cloneElement","createContext","_calculateChangedBits","_currentValue","_currentValue2","_threadCount","Provider","Consumer","_context","createElement","createFactory","bind","createRef","forwardRef","render","isValidElement","lazy","_payload","_init","memo","compare","useCallback","useContext","useDebugValue","useEffect","useImperativeHandle","useLayoutEffect","useMemo","useReducer","useRef","useState","version","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","o","defineProperty","enumerable","get","obj","prop","toStringTag","id","packageJson","CHART_MODALITY","SEG_CHART_INSTANCE_UID","utils","guid","ChartDataSOPClassUid","utilities","csToolsUtils","csTools","_getTimePointsDataByTagName","volume","timePointsTag","uniqueTimePoints","imageIds","reduce","timePoints","imageId","timePointValue","DicomMetadataStore","getInstanceByImageId","add","Set","sort","_getSegmentationData","segmentation","volumesTimePointsCache","displaySetService","volumeCacheKey","volumeId","getActiveDisplaySets","find","displaySet","anInstance","instances","FrameReferenceTime","NumberOfTimeSlices","displaySetInstanceUID","cs","_volumeCache","includes","referencedDynamicVolume","getVolume","StudyInstanceUID","StudyDescription","timeData","_","dynamicVolume","getDataInTime","maskVolumeId","pixelCount","segmentationRepresentationUID","state","getSegmentationIdRepresentations","toolGroupId","getToolGroupIdFromSegmentationRepresentationUID","color","config","getColorForSegmentIndex","hexColor","rgbToHex","timePointsData","timePointsTags","unit","timePointsTagNames","timePointsUnit","tagName","curTimePoints","concatTagNames","convertedTimePoints","validUnits","divisors","currentUnitIndex","indexOf","divisor","newDivisor","filter","timePoint","_convertTimePointsUnit","_getTimePointsData","set","timepointsCount","chartSeriesData","average","acc","cur","chartData","series","label","points","axis","_getInstanceFromSegmentations","segmentations","WeakMap","segmentationsData","date","seriesDate","time","seriesTime","now","Date","getFullYear","getUTCMonth","slice","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","_getDateTimeStr","allSeries","curSegData","instance","SOPClassUID","Modality","SOPInstanceUID","SeriesDate","SeriesTime","SeriesInstanceUID","SeriesNumber","SeriesDescription","seriesMetadata","updateSegmentationsChartDisplaySet","servicesManager","segmentationService","services","getSegmentations","addSeriesMetadata","addInstances","LABELMAP","Enums","SegmentationRepresentations","Labelmap","commandsModule","commandsManager","viewportGridService","actions","importedActions","getDynamic4DDisplaySet","TemporalPositionIdentifier","getComputedDisplaySets","getDisplaySetCache","values","isDerived","exportTimeReportCSV","options","summaryStats","dynamic4DDisplaySet","cache","csv","calculateStandardDeviation","data","mean","variance","Math","sqrt","PatientID","StudyDate","segmentationIndex","ijkCoords","headers","maxLength","numTimePoints","min","minIJK","max","maxIJK","std","numVoxels","timeIndex","voxelValues","voxelIndex","minimum","maximum","row","csvContent","filename","blob","Blob","link","document","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild","swapDynamicWithComputedDisplaySet","computedDisplaySet","displaySetCache","cachedDisplaySetKeys","viewports","getState","viewportsToUpdate","viewport","viewportOptions","displaySetInstanceUIDs","displaySetInstanceUIDIndex","newViewport","viewportId","initialImageOptions","viewportType","orientation","background","setDisplaySetsForViewports","swapComputedWithDynamicDisplaySet","dynamicDisplaySet","computed4DDisplaySet","createNewLabelMapForDynamicVolume","async","activeViewportId","dynamic4DDisplaySetInstanceUID","referenceDisplaySet","cachedDisplaySets","referenceDisplaySetUID","segmentationId","createSegmentationForDisplaySet","toolGroupIds","representationType","hydrateSegmentation","addSegmentationRepresentationToToolGroup","setActiveSegmentationForToolGroup","definitions","commandFn","storeContexts","defaultContext","controlClassNames","sizeClassName","arrowsDirection","labelPosition","Header","title","tooltip","React","className","Tooltip","content","position","tight","tooltipBoxClassName","Icon","DynamicVolumeControls","isPlaying","onPlayPauseChange","fps","onFpsChange","minFps","maxFps","currentFrameIndex","onFrameChange","framesLength","onGenerate","onDoubleRangeChange","onDynamicClick","computedView","setComputedView","computeViewMode","setComputeViewMode","DynamicOperatorType","SUM","sliderRangeValues","setSliderRangeValues","PanelSection","childrenClassName","ButtonGroup","onClick","FrameControls","separated","toUpperCase","AVERAGE","SUBTRACT","InputDoubleRange","onChange","newValues","minValue","showLabel","allowNumberEdit","maxValue","step","Button","IconButton","InputNumber","_extends","SOPClassHandlerId","PanelGenerateImage","cornerstoneViewportService","isCineEnabled","cineService","useCine","useViewportGrid","timePointsRange","setTimePointsRange","timePointsRangeToUseForGenerate","setTimePointsRangeToUseForGenerate","setComputedDisplaySet","setDynamicVolume","frameRate","setFrameRate","setIsPlaying","timePointRendered","setTimePointRendered","displayingComputed","setDisplayingComputed","uuidComputedVolume","csUtils","uuidv4","uuidDynamicVolume","computedVolumeId","renderGeneratedImage","runCommand","evt","EVENTS","VIEWPORT_DATA_CHANGED","unsubscribe","subscribe","evtDetails","viewportData","volumeData","isDynamicVolume","CINE_STATE_CHANGED","displaySetUIDs","getDisplaySetsUIDsForViewport","dynamicVolumeDisplaySet","displaySetUID","getDisplaySetByUID","getVolumes","Events","DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED","callback","detail","timePointIndex","eventTarget","addEventListener","removeEventListener","handlePlay","viewportInfo","getViewportInfo","playClip","framesPerSecond","handleStop","stopClip","newFrameRate","operationName","dynamicVolumeId","computedVolume","volumeLoader","createAndCacheDerivedVolume","createComputedVolume","vals","targets","dataInTime","cstUtils","generateImageFromTimeData","loadStatus","loaded","getScalarData","getRenderingEngine","volumeLoaderSchema","metadata","isMultiFrame","numImageFrames","uid","madeInClient","FrameOfReferenceUID","propTypes","measurementService","getMeasurements","VALUE_TYPES","create","console","warn","_console","_len","args","_key","concat","alreadyWarned","_len2","_key2","loadedClb","i18n","cb","isInitialized","on","initialized","setTimeout","off","loadNamespaces","ns","loadLanguages","lng","toPropertyKey","toPrimitive","Number","configurable","writable","matchHtmlEntity","htmlEntities","unescapeHtmlEntity","defaultOptions","bindI18n","bindI18nStore","transEmptyNodeValue","transSupportBasicHtmlNodes","transWrapTextNodes","transKeepBasicHtmlNodesFor","useSuspense","unescape","text","i18nInstance","_defineProperties","descriptor","ReportNamespaces","Constructor","_classCallCheck","usedNamespaces","protoProps","staticProps","namespaces","_this","_arrayLikeToArray","arr","len","arr2","minLen","test","enumerableOnly","sym","getOwnPropertyDescriptor","getOwnPropertyDescriptors","defineProperties","usePrevious","ignore","i18nFromProps","_ref","i18nFromContext","defaultNSFromContext","defaultNS","reportNamespaces","notReadyT","optsOrDefaultValue","defaultValue","retNotReady","ready","react","wait","i18nOptions","keyPrefix","addUsedNamespaces","initializedStoreOnce","every","languages","ignoreJSONStructure","hasLoadedNamespace","precheck","loadNotPending","backendConnector","backend","isLanguageChangingTo","fallbackLng","lastLng","toLowerCase","loadState","hasResourceBundle","resources","partialBundledLanguages","oldI18nextHasLoadedNamespace","getT","getFixedT","nsMode","_useState2","setT","joinedNS","previousJoinedNS","boundReset","store","isInitial","ret","Promise","resolve","extensionManager","useTranslation","setSegmentations","disabled","added","SEGMENTATION_ADDED","updated","SEGMENTATION_UPDATED","removed","SEGMENTATION_REMOVED","subscriptions","unsub","ActionButtons","iconName","iconLabel","component","wrappedDynamicDataPanel","DynamicDataPanel","wrappedDynamicToolbox","Toolbox","buttonSectionId","wrappedDynamicExport","DynamicExport","DEFAULT_COLORMAP","getPTOptions","colormap","voiInverted","blendMode","voi","windowWidth","windowCenter","getPTViewports","ptOptionsParams","opacity","preset","syncGroups","displaySets","getFusionViewports","syncInvertState","defaultProtocol","locked","hasUpdatedPriorsInformation","createdDate","modifiedDate","availableTo","editableBy","imageLoadStrategy","protocolMatchingRules","attribute","constraint","contains","numberOfPriorsReferenced","displaySetSelectors","defaultDisplaySetId","imageMatchingRules","seriesMatchingRules","greaterThan","ctDisplaySet","equals","required","ptDisplaySet","weight","doesNotContain","chartDisplaySet","stages","viewportStructure","layoutType","properties","rows","columns","layoutOptions","width","height","skipLoading","dynamicVolumeExtension","preRegistration","configuration","setMaxCacheSize","getPanelModule","getHangingProtocolModule","protocol","getCommandsModule"],"sourceRoot":""}