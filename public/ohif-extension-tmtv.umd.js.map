{"version":3,"file":"dist/ohif-extension-tmtv.umd.js","mappings":"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","sources":["webpack://ohif-extension-tmtv/webpack/universalModuleDefinition","webpack://ohif-extension-tmtv/../../../node_modules/object-assign/index.js","webpack://ohif-extension-tmtv/../../../node_modules/prop-types/factoryWithThrowingShims.js","webpack://ohif-extension-tmtv/../../../node_modules/prop-types/index.js","webpack://ohif-extension-tmtv/../../../node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://ohif-extension-tmtv/../../../node_modules/react/cjs/react.production.min.js","webpack://ohif-extension-tmtv/../../../node_modules/react/index.js","webpack://ohif-extension-tmtv/../../../node_modules/void-elements/index.js","webpack://ohif-extension-tmtv/external umd \"@cornerstonejs/adapters\"","webpack://ohif-extension-tmtv/external umd \"@cornerstonejs/core\"","webpack://ohif-extension-tmtv/external umd \"@cornerstonejs/tools\"","webpack://ohif-extension-tmtv/external umd \"@ohif/core\"","webpack://ohif-extension-tmtv/external umd \"@ohif/ui\"","webpack://ohif-extension-tmtv/external umd \"dcmjs\"","webpack://ohif-extension-tmtv/external umd \"gl-matrix\"","webpack://ohif-extension-tmtv/webpack/bootstrap","webpack://ohif-extension-tmtv/webpack/runtime/compat get default export","webpack://ohif-extension-tmtv/webpack/runtime/define property getters","webpack://ohif-extension-tmtv/webpack/runtime/get javascript chunk filename","webpack://ohif-extension-tmtv/webpack/runtime/hasOwnProperty shorthand","webpack://ohif-extension-tmtv/webpack/runtime/make namespace object","webpack://ohif-extension-tmtv/webpack/runtime/publicPath","webpack://ohif-extension-tmtv/webpack/runtime/jsonp chunk loading","webpack://ohif-extension-tmtv/./id.js","webpack://ohif-extension-tmtv/./utils/hpViewports.ts","webpack://ohif-extension-tmtv/./getHangingProtocolModule.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://ohif-extension-tmtv/../../../node_modules/html-parse-stringify/src/parse.js","webpack://ohif-extension-tmtv/../../../node_modules/react-i18next/dist/es/utils.js","webpack://ohif-extension-tmtv/../../../node_modules/react-i18next/dist/es/unescape.js","webpack://ohif-extension-tmtv/../../../node_modules/react-i18next/dist/es/defaults.js","webpack://ohif-extension-tmtv/../../../node_modules/react-i18next/dist/es/i18nInstance.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://ohif-extension-tmtv/../../../node_modules/react-i18next/dist/es/context.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://ohif-extension-tmtv/../../../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://ohif-extension-tmtv/../../../node_modules/react-i18next/dist/es/useTranslation.js","webpack://ohif-extension-tmtv/./Panels/PanelPetSUV.tsx","webpack://ohif-extension-tmtv/./Panels/PanelROIThresholdSegmentation/PanelROIThresholdExport.tsx","webpack://ohif-extension-tmtv/./utils/handleROIThresholding.ts","webpack://ohif-extension-tmtv/./Panels/PanelROIThresholdSegmentation/index.ts","webpack://ohif-extension-tmtv/./getPanelModule.tsx","webpack://ohif-extension-tmtv/./utils/measurementServiceMappings/constants/supportedTools.js","webpack://ohif-extension-tmtv/./utils/measurementServiceMappings/utils/getSOPInstanceAttributes.js","webpack://ohif-extension-tmtv/./utils/measurementServiceMappings/RectangleROIStartEndThreshold.js","webpack://ohif-extension-tmtv/./utils/measurementServiceMappings/measurementServiceMappingsFactory.js","webpack://ohif-extension-tmtv/./utils/getThresholdValue.ts","webpack://ohif-extension-tmtv/./utils/calculateTMTV.ts","webpack://ohif-extension-tmtv/./utils/dicomRTAnnotationExport/RTStructureSet/dicomRTAnnotationExport.js","webpack://ohif-extension-tmtv/./utils/dicomRTAnnotationExport/RTStructureSet/index.js","webpack://ohif-extension-tmtv/./commandsModule.js","webpack://ohif-extension-tmtv/./utils/createAndDownloadTMTVReport.js","webpack://ohif-extension-tmtv/./Panels/PanelROIThresholdSegmentation/ROIThresholdConfiguration.tsx","webpack://ohif-extension-tmtv/./Panels/RectangleROIOptions.tsx","webpack://ohif-extension-tmtv/./index.tsx","webpack://ohif-extension-tmtv/./init.js","webpack://ohif-extension-tmtv/./getToolbarModule.tsx"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@cornerstonejs/adapters\"), require(\"@cornerstonejs/core\"), require(\"@cornerstonejs/tools\"), require(\"@ohif/core\"), require(\"@ohif/ui\"), require(\"dcmjs\"), require(\"gl-matrix\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@cornerstonejs/adapters\", \"@cornerstonejs/core\", \"@cornerstonejs/tools\", \"@ohif/core\", \"@ohif/ui\", \"dcmjs\", \"gl-matrix\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ohif-extension-tmtv\"] = factory(require(\"@cornerstonejs/adapters\"), require(\"@cornerstonejs/core\"), require(\"@cornerstonejs/tools\"), require(\"@ohif/core\"), require(\"@ohif/ui\"), require(\"dcmjs\"), require(\"gl-matrix\"));\n\telse\n\t\troot[\"ohif-extension-tmtv\"] = factory(root[\"@cornerstonejs/adapters\"], root[\"@cornerstonejs/core\"], root[\"@cornerstonejs/tools\"], root[\"@ohif/core\"], root[\"@ohif/ui\"], root[\"dcmjs\"], root[\"gl-matrix\"]);\n})(globalThis, (__WEBPACK_EXTERNAL_MODULE__142__, __WEBPACK_EXTERNAL_MODULE__557__, __WEBPACK_EXTERNAL_MODULE__713__, __WEBPACK_EXTERNAL_MODULE__2__, __WEBPACK_EXTERNAL_MODULE__307__, __WEBPACK_EXTERNAL_MODULE__111__, __WEBPACK_EXTERNAL_MODULE__155__) => {\nreturn ","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bigint: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","/** @license React v17.0.2\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=require(\"object-assign\"),n=60103,p=60106;exports.Fragment=60107;exports.StrictMode=60108;exports.Profiler=60114;var q=60109,r=60110,t=60112;exports.Suspense=60113;var u=60115,v=60116;\nif(\"function\"===typeof Symbol&&Symbol.for){var w=Symbol.for;n=w(\"react.element\");p=w(\"react.portal\");exports.Fragment=w(\"react.fragment\");exports.StrictMode=w(\"react.strict_mode\");exports.Profiler=w(\"react.profiler\");q=w(\"react.provider\");r=w(\"react.context\");t=w(\"react.forward_ref\");exports.Suspense=w(\"react.suspense\");u=w(\"react.memo\");v=w(\"react.lazy\")}var x=\"function\"===typeof Symbol&&Symbol.iterator;\nfunction y(a){if(null===a||\"object\"!==typeof a)return null;a=x&&a[x]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}function z(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}\nvar A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B={};function C(a,b,c){this.props=a;this.context=b;this.refs=B;this.updater=c||A}C.prototype.isReactComponent={};C.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(z(85));this.updater.enqueueSetState(this,a,b,\"setState\")};C.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};\nfunction D(){}D.prototype=C.prototype;function E(a,b,c){this.props=a;this.context=b;this.refs=B;this.updater=c||A}var F=E.prototype=new D;F.constructor=E;l(F,C.prototype);F.isPureReactComponent=!0;var G={current:null},H=Object.prototype.hasOwnProperty,I={key:!0,ref:!0,__self:!0,__source:!0};\nfunction J(a,b,c){var e,d={},k=null,h=null;if(null!=b)for(e in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)H.call(b,e)&&!I.hasOwnProperty(e)&&(d[e]=b[e]);var g=arguments.length-2;if(1===g)d.children=c;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];d.children=f}if(a&&a.defaultProps)for(e in g=a.defaultProps,g)void 0===d[e]&&(d[e]=g[e]);return{$$typeof:n,type:a,key:k,ref:h,props:d,_owner:G.current}}\nfunction K(a,b){return{$$typeof:n,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function L(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===n}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var M=/\\/+/g;function N(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction O(a,b,c,e,d){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case n:case p:h=!0}}if(h)return h=a,d=d(h),a=\"\"===e?\".\"+N(h,0):e,Array.isArray(d)?(c=\"\",null!=a&&(c=a.replace(M,\"$&/\")+\"/\"),O(d,b,c,\"\",function(a){return a})):null!=d&&(L(d)&&(d=K(d,c+(!d.key||h&&h.key===d.key?\"\":(\"\"+d.key).replace(M,\"$&/\")+\"/\")+a)),b.push(d)),1;h=0;e=\"\"===e?\".\":e+\":\";if(Array.isArray(a))for(var g=\n0;g<a.length;g++){k=a[g];var f=e+N(k,g);h+=O(k,b,c,f,d)}else if(f=y(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=e+N(k,g++),h+=O(k,b,c,f,d);else if(\"object\"===k)throw b=\"\"+a,Error(z(31,\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b));return h}function P(a,b,c){if(null==a)return a;var e=[],d=0;O(a,e,\"\",\"\",function(a){return b.call(c,a,d++)});return e}\nfunction Q(a){if(-1===a._status){var b=a._result;b=b();a._status=0;a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}if(1===a._status)return a._result;throw a._result;}var R={current:null};function S(){var a=R.current;if(null===a)throw Error(z(321));return a}var T={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:G,IsSomeRendererActing:{current:!1},assign:l};\nexports.Children={map:P,forEach:function(a,b,c){P(a,function(){b.apply(this,arguments)},c)},count:function(a){var b=0;P(a,function(){b++});return b},toArray:function(a){return P(a,function(a){return a})||[]},only:function(a){if(!L(a))throw Error(z(143));return a}};exports.Component=C;exports.PureComponent=E;exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T;\nexports.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(z(267,a));var e=l({},a.props),d=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=G.current);void 0!==b.key&&(d=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)H.call(b,f)&&!I.hasOwnProperty(f)&&(e[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)e.children=c;else if(1<f){g=Array(f);for(var m=0;m<f;m++)g[m]=arguments[m+2];e.children=g}return{$$typeof:n,type:a.type,\nkey:d,ref:k,props:e,_owner:h}};exports.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:r,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:q,_context:a};return a.Consumer=a};exports.createElement=J;exports.createFactory=function(a){var b=J.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};exports.forwardRef=function(a){return{$$typeof:t,render:a}};exports.isValidElement=L;\nexports.lazy=function(a){return{$$typeof:v,_payload:{_status:-1,_result:a},_init:Q}};exports.memo=function(a,b){return{$$typeof:u,type:a,compare:void 0===b?null:b}};exports.useCallback=function(a,b){return S().useCallback(a,b)};exports.useContext=function(a,b){return S().useContext(a,b)};exports.useDebugValue=function(){};exports.useEffect=function(a,b){return S().useEffect(a,b)};exports.useImperativeHandle=function(a,b,c){return S().useImperativeHandle(a,b,c)};\nexports.useLayoutEffect=function(a,b){return S().useLayoutEffect(a,b)};exports.useMemo=function(a,b){return S().useMemo(a,b)};exports.useReducer=function(a,b,c){return S().useReducer(a,b,c)};exports.useRef=function(a){return S().useRef(a)};exports.useState=function(a){return S().useState(a)};exports.version=\"17.0.2\";\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","/**\n * This file automatically generated from `pre-publish.js`.\n * Do not manually edit.\n */\n\nmodule.exports = {\n  \"area\": true,\n  \"base\": true,\n  \"br\": true,\n  \"col\": true,\n  \"embed\": true,\n  \"hr\": true,\n  \"img\": true,\n  \"input\": true,\n  \"link\": true,\n  \"meta\": true,\n  \"param\": true,\n  \"source\": true,\n  \"track\": true,\n  \"wbr\": true\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__142__;","module.exports = __WEBPACK_EXTERNAL_MODULE__557__;","module.exports = __WEBPACK_EXTERNAL_MODULE__713__;","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","module.exports = __WEBPACK_EXTERNAL_MODULE__307__;","module.exports = __WEBPACK_EXTERNAL_MODULE__111__;","module.exports = __WEBPACK_EXTERNAL_MODULE__155__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"dist/\" + chunkId + \".ohif-extension-tmtv.umd.js\";\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","import packageJson from '../package.json';\n\nconst id = packageJson.name;\n\nexport { id };\n","const ctAXIAL = {\n  viewportOptions: {\n    viewportId: 'ctAXIAL',\n    viewportType: 'volume',\n    orientation: 'axial',\n    toolGroupId: 'ctToolGroup',\n    initialImageOptions: {\n      // index: 5,\n      preset: 'first', // 'first', 'last', 'middle'\n    },\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'axialSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ctWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      id: 'ctDisplaySet',\n    },\n  ],\n};\n\nconst ctSAGITTAL = {\n  viewportOptions: {\n    viewportId: 'ctSAGITTAL',\n    viewportType: 'volume',\n    orientation: 'sagittal',\n    toolGroupId: 'ctToolGroup',\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'sagittalSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ctWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      id: 'ctDisplaySet',\n    },\n  ],\n};\nconst ctCORONAL = {\n  viewportOptions: {\n    viewportId: 'ctCORONAL',\n    viewportType: 'volume',\n    orientation: 'coronal',\n    toolGroupId: 'ctToolGroup',\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'coronalSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ctWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      id: 'ctDisplaySet',\n    },\n  ],\n};\n\nconst ptAXIAL = {\n  viewportOptions: {\n    viewportId: 'ptAXIAL',\n    viewportType: 'volume',\n    background: [1, 1, 1],\n    orientation: 'axial',\n    toolGroupId: 'ptToolGroup',\n    initialImageOptions: {\n      // index: 5,\n      preset: 'first', // 'first', 'last', 'middle'\n    },\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'axialSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ptWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n      {\n        type: 'voi',\n        id: 'ptFusionWLSync',\n        source: true,\n        target: false,\n        options: {\n          syncInvertState: false,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      options: {\n        voi: {\n          custom: 'getPTVOIRange',\n        },\n        voiInverted: true,\n      },\n      id: 'ptDisplaySet',\n    },\n  ],\n};\n\nconst ptSAGITTAL = {\n  viewportOptions: {\n    viewportId: 'ptSAGITTAL',\n    viewportType: 'volume',\n    orientation: 'sagittal',\n    background: [1, 1, 1],\n    toolGroupId: 'ptToolGroup',\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'sagittalSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ptWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n      {\n        type: 'voi',\n        id: 'ptFusionWLSync',\n        source: true,\n        target: false,\n        options: {\n          syncInvertState: false,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      options: {\n        voi: {\n          custom: 'getPTVOIRange',\n        },\n        voiInverted: true,\n      },\n      id: 'ptDisplaySet',\n    },\n  ],\n};\n\nconst ptCORONAL = {\n  viewportOptions: {\n    viewportId: 'ptCORONAL',\n    viewportType: 'volume',\n    orientation: 'coronal',\n    background: [1, 1, 1],\n    toolGroupId: 'ptToolGroup',\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'coronalSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ptWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n      {\n        type: 'voi',\n        id: 'ptFusionWLSync',\n        source: true,\n        target: false,\n        options: {\n          syncInvertState: false,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      options: {\n        voi: {\n          custom: 'getPTVOIRange',\n        },\n        voiInverted: true,\n      },\n      id: 'ptDisplaySet',\n    },\n  ],\n};\n\nconst fusionAXIAL = {\n  viewportOptions: {\n    viewportId: 'fusionAXIAL',\n    viewportType: 'volume',\n    orientation: 'axial',\n    toolGroupId: 'fusionToolGroup',\n    initialImageOptions: {\n      // index: 5,\n      preset: 'first', // 'first', 'last', 'middle'\n    },\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'axialSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ctWLSync',\n        source: false,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'fusionWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n      {\n        type: 'voi',\n        id: 'ptFusionWLSync',\n        source: false,\n        target: true,\n        options: {\n          syncInvertState: false,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      id: 'ctDisplaySet',\n    },\n    {\n      id: 'ptDisplaySet',\n      options: {\n        colormap: {\n          name: 'hsv',\n          opacity: [\n            { value: 0, opacity: 0 },\n            { value: 0.1, opacity: 0.9 },\n            { value: 1, opacity: 0.95 },\n          ],\n        },\n        voi: {\n          custom: 'getPTVOIRange',\n        },\n      },\n    },\n  ],\n};\n\nconst fusionSAGITTAL = {\n  viewportOptions: {\n    viewportId: 'fusionSAGITTAL',\n    viewportType: 'volume',\n    orientation: 'sagittal',\n    toolGroupId: 'fusionToolGroup',\n    // initialImageOptions: {\n    //   index: 180,\n    //   preset: 'middle', // 'first', 'last', 'middle'\n    // },\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'sagittalSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ctWLSync',\n        source: false,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'fusionWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n      {\n        type: 'voi',\n        id: 'ptFusionWLSync',\n        source: false,\n        target: true,\n        options: {\n          syncInvertState: false,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      id: 'ctDisplaySet',\n    },\n    {\n      id: 'ptDisplaySet',\n      options: {\n        colormap: {\n          name: 'hsv',\n          opacity: [\n            { value: 0, opacity: 0 },\n            { value: 0.1, opacity: 0.9 },\n            { value: 1, opacity: 0.95 },\n          ],\n        },\n        voi: {\n          custom: 'getPTVOIRange',\n        },\n      },\n    },\n  ],\n};\n\nconst fusionCORONAL = {\n  viewportOptions: {\n    viewportId: 'fusionCoronal',\n    viewportType: 'volume',\n    orientation: 'coronal',\n    toolGroupId: 'fusionToolGroup',\n    // initialImageOptions: {\n    //   index: 180,\n    //   preset: 'middle', // 'first', 'last', 'middle'\n    // },\n    syncGroups: [\n      {\n        type: 'cameraPosition',\n        id: 'coronalSync',\n        source: true,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'ctWLSync',\n        source: false,\n        target: true,\n      },\n      {\n        type: 'voi',\n        id: 'fusionWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n      {\n        type: 'voi',\n        id: 'ptFusionWLSync',\n        source: false,\n        target: true,\n        options: {\n          syncInvertState: false,\n        },\n      },\n    ],\n  },\n  displaySets: [\n    {\n      id: 'ctDisplaySet',\n    },\n    {\n      id: 'ptDisplaySet',\n      options: {\n        colormap: {\n          name: 'hsv',\n          opacity: [\n            { value: 0, opacity: 0 },\n            { value: 0.1, opacity: 0.9 },\n            { value: 1, opacity: 0.95 },\n          ],\n        },\n        voi: {\n          custom: 'getPTVOIRange',\n        },\n      },\n    },\n  ],\n};\n\nconst mipSAGITTAL = {\n  viewportOptions: {\n    viewportId: 'mipSagittal',\n    viewportType: 'volume',\n    orientation: 'sagittal',\n    background: [1, 1, 1],\n    toolGroupId: 'mipToolGroup',\n    syncGroups: [\n      {\n        type: 'voi',\n        id: 'ptWLSync',\n        source: true,\n        target: true,\n        options: {\n          syncColormap: true,\n        },\n      },\n      {\n        type: 'voi',\n        id: 'ptFusionWLSync',\n        source: true,\n        target: false,\n        options: {\n          syncInvertState: false,\n        },\n      },\n    ],\n\n    // Custom props can be used to set custom properties which extensions\n    // can react on.\n    customViewportProps: {\n      // We use viewportDisplay to filter the viewports which are displayed\n      // in mip and we set the scrollbar according to their rotation index\n      // in the cornerstone extension.\n      hideOverlays: true,\n    },\n  },\n  displaySets: [\n    {\n      options: {\n        blendMode: 'MIP',\n        slabThickness: 'fullVolume',\n        voi: {\n          custom: 'getPTVOIRange',\n        },\n        voiInverted: true,\n      },\n      id: 'ptDisplaySet',\n    },\n  ],\n};\n\nexport {\n  ctAXIAL,\n  ctSAGITTAL,\n  ctCORONAL,\n  ptAXIAL,\n  ptSAGITTAL,\n  ptCORONAL,\n  fusionAXIAL,\n  fusionSAGITTAL,\n  fusionCORONAL,\n  mipSAGITTAL,\n};\n","import {\n  ctAXIAL,\n  ctCORONAL,\n  ctSAGITTAL,\n  fusionAXIAL,\n  fusionCORONAL,\n  fusionSAGITTAL,\n  mipSAGITTAL,\n  ptAXIAL,\n  ptCORONAL,\n  ptSAGITTAL,\n} from './utils/hpViewports';\n\n/**\n * represents a 3x4 viewport layout configuration. The layout displays CT axial, sagittal, and coronal\n * images in the first row, PT axial, sagittal, and coronal images in the second row, and fusion axial,\n * sagittal, and coronal images in the third row. The fourth column is fully spanned by a MIP sagittal\n * image, covering all three rows. It has synchronizers for windowLevel for all CT and PT images, and\n * also camera synchronizer for each orientation\n */\nconst stage1 = {\n  name: 'default',\n  viewportStructure: {\n    layoutType: 'grid',\n    properties: {\n      rows: 3,\n      columns: 4,\n      layoutOptions: [\n        {\n          x: 0,\n          y: 0,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 1 / 4,\n          y: 0,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 2 / 4,\n          y: 0,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 0,\n          y: 1 / 3,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 1 / 4,\n          y: 1 / 3,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 2 / 4,\n          y: 1 / 3,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 0,\n          y: 2 / 3,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 1 / 4,\n          y: 2 / 3,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 2 / 4,\n          y: 2 / 3,\n          width: 1 / 4,\n          height: 1 / 3,\n        },\n        {\n          x: 3 / 4,\n          y: 0,\n          width: 1 / 4,\n          height: 1,\n        },\n      ],\n    },\n  },\n  viewports: [\n    ctAXIAL,\n    ctSAGITTAL,\n    ctCORONAL,\n    ptAXIAL,\n    ptSAGITTAL,\n    ptCORONAL,\n    fusionAXIAL,\n    fusionSAGITTAL,\n    fusionCORONAL,\n    mipSAGITTAL,\n  ],\n  createdDate: '2021-02-23T18:32:42.850Z',\n};\n\n/**\n * The layout displays CT axial image in the top-left viewport, fusion axial image\n * in the top-right viewport, PT axial image in the bottom-left viewport, and MIP\n * sagittal image in the bottom-right viewport. The layout follows a simple grid\n * pattern with 2 rows and 2 columns. It includes synchronizers as well.\n */\nconst stage2 = {\n  name: 'Fusion 2x2',\n  viewportStructure: {\n    layoutType: 'grid',\n    properties: {\n      rows: 2,\n      columns: 2,\n    },\n  },\n  viewports: [ctAXIAL, fusionAXIAL, ptAXIAL, mipSAGITTAL],\n};\n\n/**\n * The top row displays CT images in axial, sagittal, and coronal orientations from\n * left to right, respectively. The bottom row displays PT images in axial, sagittal,\n * and coronal orientations from left to right, respectively.\n * The layout follows a simple grid pattern with 2 rows and 3 columns.\n * It includes synchronizers as well.\n */\nconst stage3 = {\n  name: '2x3-layout',\n  viewportStructure: {\n    layoutType: 'grid',\n    properties: {\n      rows: 2,\n      columns: 3,\n    },\n  },\n  viewports: [ctAXIAL, ctSAGITTAL, ctCORONAL, ptAXIAL, ptSAGITTAL, ptCORONAL],\n};\n\n/**\n * In this layout, the top row displays PT images in coronal, sagittal, and axial\n * orientations from left to right, respectively, followed by a MIP sagittal image\n * that spans both rows on the rightmost side. The bottom row displays fusion images\n * in coronal, sagittal, and axial orientations from left to right, respectively.\n * There is no viewport in the bottom row's rightmost position, as the MIP sagittal viewport\n * from the top row spans the full height of both rows.\n * It includes synchronizers as well.\n */\nconst stage4 = {\n  name: '2x4-layout',\n  viewportStructure: {\n    layoutType: 'grid',\n    properties: {\n      rows: 2,\n      columns: 4,\n      layoutOptions: [\n        {\n          x: 0,\n          y: 0,\n          width: 1 / 4,\n          height: 1 / 2,\n        },\n        {\n          x: 1 / 4,\n          y: 0,\n          width: 1 / 4,\n          height: 1 / 2,\n        },\n        {\n          x: 2 / 4,\n          y: 0,\n          width: 1 / 4,\n          height: 1 / 2,\n        },\n        {\n          x: 3 / 4,\n          y: 0,\n          width: 1 / 4,\n          height: 1,\n        },\n        {\n          x: 0,\n          y: 1 / 2,\n          width: 1 / 4,\n          height: 1 / 2,\n        },\n        {\n          x: 1 / 4,\n          y: 1 / 2,\n          width: 1 / 4,\n          height: 1 / 2,\n        },\n        {\n          x: 2 / 4,\n          y: 1 / 2,\n          width: 1 / 4,\n          height: 1 / 2,\n        },\n      ],\n    },\n  },\n  viewports: [\n    ptCORONAL,\n    ptSAGITTAL,\n    ptAXIAL,\n    mipSAGITTAL,\n    fusionCORONAL,\n    fusionSAGITTAL,\n    fusionAXIAL,\n  ],\n};\n\nconst ptCT = {\n  id: '@ohif/extension-tmtv.hangingProtocolModule.ptCT',\n  locked: true,\n  name: 'Default',\n  createdDate: '2021-02-23T19:22:08.894Z',\n  modifiedDate: '2022-10-04T19:22:08.894Z',\n  availableTo: {},\n  editableBy: {},\n  imageLoadStrategy: 'interleaveTopToBottom', // \"default\" , \"interleaveTopToBottom\",  \"interleaveCenter\"\n  protocolMatchingRules: [\n    {\n      attribute: 'ModalitiesInStudy',\n      constraint: {\n        contains: ['CT', 'PT'],\n      },\n    },\n    {\n      attribute: 'StudyDescription',\n      constraint: {\n        contains: 'PETCT',\n      },\n    },\n    {\n      attribute: 'StudyDescription',\n      constraint: {\n        contains: 'PET/CT',\n      },\n    },\n  ],\n  displaySetSelectors: {\n    ctDisplaySet: {\n      seriesMatchingRules: [\n        {\n          attribute: 'Modality',\n          constraint: {\n            equals: {\n              value: 'CT',\n            },\n          },\n          required: true,\n        },\n        {\n          attribute: 'isReconstructable',\n          constraint: {\n            equals: {\n              value: true,\n            },\n          },\n          required: true,\n        },\n        {\n          attribute: 'SeriesDescription',\n          constraint: {\n            contains: 'CT',\n          },\n        },\n        {\n          attribute: 'SeriesDescription',\n          constraint: {\n            contains: 'CT WB',\n          },\n        },\n      ],\n    },\n    ptDisplaySet: {\n      seriesMatchingRules: [\n        {\n          attribute: 'Modality',\n          constraint: {\n            equals: 'PT',\n          },\n          required: true,\n        },\n        {\n          attribute: 'isReconstructable',\n          constraint: {\n            equals: {\n              value: true,\n            },\n          },\n          required: true,\n        },\n        {\n          attribute: 'SeriesDescription',\n          constraint: {\n            contains: 'Corrected',\n          },\n        },\n        {\n          weight: 2,\n          attribute: 'SeriesDescription',\n          constraint: {\n            doesNotContain: {\n              value: 'Uncorrected',\n            },\n          },\n        },\n      ],\n    },\n  },\n\n  stages: [stage1, stage2, stage3, stage4],\n  numberOfPriorsReferenced: -1,\n};\n\nfunction getHangingProtocolModule() {\n  return [\n    {\n      name: ptCT.id,\n      protocol: ptCT,\n    },\n  ];\n}\n\nexport default getHangingProtocolModule;\n","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import parseTag from './parse-tag'\n\nconst tagRE = /<[a-zA-Z0-9\\-\\!\\/](?:\"[^\"]*\"|'[^']*'|[^'\">])*>/g\nconst whitespaceRE = /^\\s*$/\n\n// re-used obj for quick lookups of components\nconst empty = Object.create(null)\n\nexport default function parse(html, options) {\n  options || (options = {})\n  options.components || (options.components = empty)\n  const result = []\n  const arr = []\n  let current\n  let level = -1\n  let inComponent = false\n\n  // handle text at top level\n  if (html.indexOf('<') !== 0) {\n    var end = html.indexOf('<')\n    result.push({\n      type: 'text',\n      content: end === -1 ? html : html.substring(0, end),\n    })\n  }\n\n  html.replace(tagRE, function (tag, index) {\n    if (inComponent) {\n      if (tag !== '</' + current.name + '>') {\n        return\n      } else {\n        inComponent = false\n      }\n    }\n    const isOpen = tag.charAt(1) !== '/'\n    const isComment = tag.startsWith('<!--')\n    const start = index + tag.length\n    const nextChar = html.charAt(start)\n    let parent\n\n    if (isComment) {\n      const comment = parseTag(tag)\n\n      // if we're at root, push new base node\n      if (level < 0) {\n        result.push(comment)\n        return result\n      }\n      parent = arr[level]\n      parent.children.push(comment)\n      return result\n    }\n\n    if (isOpen) {\n      level++\n\n      current = parseTag(tag)\n      if (current.type === 'tag' && options.components[current.name]) {\n        current.type = 'component'\n        inComponent = true\n      }\n\n      if (\n        !current.voidElement &&\n        !inComponent &&\n        nextChar &&\n        nextChar !== '<'\n      ) {\n        current.children.push({\n          type: 'text',\n          content: html.slice(start, html.indexOf('<', start)),\n        })\n      }\n\n      // if we're at root, push new base node\n      if (level === 0) {\n        result.push(current)\n      }\n\n      parent = arr[level - 1]\n\n      if (parent) {\n        parent.children.push(current)\n      }\n\n      arr[level] = current\n    }\n\n    if (!isOpen || current.voidElement) {\n      if (\n        level > -1 &&\n        (current.voidElement || current.name === tag.slice(2, -1))\n      ) {\n        level--\n        // move current up a level to match the end tag\n        current = level === -1 ? result : arr[level]\n      }\n      if (!inComponent && nextChar !== '<' && nextChar) {\n        // trailing text node\n        // if we're at the root, push a base text node. otherwise add as\n        // a child to the current node.\n        parent = level === -1 ? result : arr[level].children\n\n        // calculate correct end of the content slice in case there's\n        // no tag after the text node.\n        const end = html.indexOf('<', start)\n        let content = html.slice(start, end === -1 ? undefined : end)\n        // if a node is nothing but whitespace, collapse it as the spec states:\n        // https://www.w3.org/TR/html4/struct/text.html#h-9.1\n        if (whitespaceRE.test(content)) {\n          content = ' '\n        }\n        // don't add whitespace-only text nodes if they would be trailing text nodes\n        // or if they would be leading whitespace-only text nodes:\n        //  * end > -1 indicates this is not a trailing text node\n        //  * leading node is when level is -1 and parent has length 0\n        if ((end > -1 && level + parent.length >= 0) || content !== ' ') {\n          parent.push({\n            type: 'text',\n            content: content,\n          })\n        }\n      }\n    }\n  })\n\n  return result\n}\n","export function warn() {\n  if (console && console.warn) {\n    var _console;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (typeof args[0] === 'string') args[0] = \"react-i18next:: \".concat(args[0]);\n\n    (_console = console).warn.apply(_console, args);\n  }\n}\nvar alreadyWarned = {};\nexport function warnOnce() {\n  for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    args[_key2] = arguments[_key2];\n  }\n\n  if (typeof args[0] === 'string' && alreadyWarned[args[0]]) return;\n  if (typeof args[0] === 'string') alreadyWarned[args[0]] = new Date();\n  warn.apply(void 0, args);\n}\n\nvar loadedClb = function loadedClb(i18n, cb) {\n  return function () {\n    if (i18n.isInitialized) {\n      cb();\n    } else {\n      var initialized = function initialized() {\n        setTimeout(function () {\n          i18n.off('initialized', initialized);\n        }, 0);\n        cb();\n      };\n\n      i18n.on('initialized', initialized);\n    }\n  };\n};\n\nexport function loadNamespaces(i18n, ns, cb) {\n  i18n.loadNamespaces(ns, loadedClb(i18n, cb));\n}\nexport function loadLanguages(i18n, lng, ns, cb) {\n  if (typeof ns === 'string') ns = [ns];\n  ns.forEach(function (n) {\n    if (i18n.options.ns.indexOf(n) < 0) i18n.options.ns.push(n);\n  });\n  i18n.loadLanguages(lng, loadedClb(i18n, cb));\n}\n\nfunction oldI18nextHasLoadedNamespace(ns, i18n) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var lng = i18n.languages[0];\n  var fallbackLng = i18n.options ? i18n.options.fallbackLng : false;\n  var lastLng = i18n.languages[i18n.languages.length - 1];\n  if (lng.toLowerCase() === 'cimode') return true;\n\n  var loadNotPending = function loadNotPending(l, n) {\n    var loadState = i18n.services.backendConnector.state[\"\".concat(l, \"|\").concat(n)];\n    return loadState === -1 || loadState === 2;\n  };\n\n  if (options.bindI18n && options.bindI18n.indexOf('languageChanging') > -1 && i18n.services.backendConnector.backend && i18n.isLanguageChangingTo && !loadNotPending(i18n.isLanguageChangingTo, ns)) return false;\n  if (i18n.hasResourceBundle(lng, ns)) return true;\n  if (!i18n.services.backendConnector.backend || i18n.options.resources && !i18n.options.partialBundledLanguages) return true;\n  if (loadNotPending(lng, ns) && (!fallbackLng || loadNotPending(lastLng, ns))) return true;\n  return false;\n}\n\nexport function hasLoadedNamespace(ns, i18n) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (!i18n.languages || !i18n.languages.length) {\n    warnOnce('i18n.languages were undefined or empty', i18n.languages);\n    return true;\n  }\n\n  var isNewerI18next = i18n.options.ignoreJSONStructure !== undefined;\n\n  if (!isNewerI18next) {\n    return oldI18nextHasLoadedNamespace(ns, i18n, options);\n  }\n\n  return i18n.hasLoadedNamespace(ns, {\n    lng: options.lng,\n    precheck: function precheck(i18nInstance, loadNotPending) {\n      if (options.bindI18n && options.bindI18n.indexOf('languageChanging') > -1 && i18nInstance.services.backendConnector.backend && i18nInstance.isLanguageChangingTo && !loadNotPending(i18nInstance.isLanguageChangingTo, ns)) return false;\n    }\n  });\n}\nexport function getDisplayName(Component) {\n  return Component.displayName || Component.name || (typeof Component === 'string' && Component.length > 0 ? Component : 'Unknown');\n}","var matchHtmlEntity = /&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g;\nvar htmlEntities = {\n  '&amp;': '&',\n  '&#38;': '&',\n  '&lt;': '<',\n  '&#60;': '<',\n  '&gt;': '>',\n  '&#62;': '>',\n  '&apos;': \"'\",\n  '&#39;': \"'\",\n  '&quot;': '\"',\n  '&#34;': '\"',\n  '&nbsp;': ' ',\n  '&#160;': ' ',\n  '&copy;': '',\n  '&#169;': '',\n  '&reg;': '',\n  '&#174;': '',\n  '&hellip;': '',\n  '&#8230;': '',\n  '&#x2F;': '/',\n  '&#47;': '/'\n};\n\nvar unescapeHtmlEntity = function unescapeHtmlEntity(m) {\n  return htmlEntities[m];\n};\n\nexport var unescape = function unescape(text) {\n  return text.replace(matchHtmlEntity, unescapeHtmlEntity);\n};","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { unescape } from './unescape.js';\nvar defaultOptions = {\n  bindI18n: 'languageChanged',\n  bindI18nStore: '',\n  transEmptyNodeValue: '',\n  transSupportBasicHtmlNodes: true,\n  transWrapTextNodes: '',\n  transKeepBasicHtmlNodesFor: ['br', 'strong', 'i', 'p'],\n  useSuspense: true,\n  unescape: unescape\n};\nexport function setDefaults() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  defaultOptions = _objectSpread(_objectSpread({}, defaultOptions), options);\n}\nexport function getDefaults() {\n  return defaultOptions;\n}","var i18nInstance;\nexport function setI18n(instance) {\n  i18nInstance = instance;\n}\nexport function getI18n() {\n  return i18nInstance;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { createContext } from 'react';\nimport { getDefaults, setDefaults } from './defaults.js';\nimport { getI18n, setI18n } from './i18nInstance.js';\nimport { initReactI18next } from './initReactI18next.js';\nexport { getDefaults, setDefaults, getI18n, setI18n, initReactI18next };\nexport var I18nContext = createContext();\nexport var ReportNamespaces = function () {\n  function ReportNamespaces() {\n    _classCallCheck(this, ReportNamespaces);\n\n    this.usedNamespaces = {};\n  }\n\n  _createClass(ReportNamespaces, [{\n    key: \"addUsedNamespaces\",\n    value: function addUsedNamespaces(namespaces) {\n      var _this = this;\n\n      namespaces.forEach(function (ns) {\n        if (!_this.usedNamespaces[ns]) _this.usedNamespaces[ns] = true;\n      });\n    }\n  }, {\n    key: \"getUsedNamespaces\",\n    value: function getUsedNamespaces() {\n      return Object.keys(this.usedNamespaces);\n    }\n  }]);\n\n  return ReportNamespaces;\n}();\nexport function composeInitialProps(ForComponent) {\n  return function (ctx) {\n    return new Promise(function (resolve) {\n      var i18nInitialProps = getInitialProps();\n\n      if (ForComponent.getInitialProps) {\n        ForComponent.getInitialProps(ctx).then(function (componentsInitialProps) {\n          resolve(_objectSpread(_objectSpread({}, componentsInitialProps), i18nInitialProps));\n        });\n      } else {\n        resolve(i18nInitialProps);\n      }\n    });\n  };\n}\nexport function getInitialProps() {\n  var i18n = getI18n();\n  var namespaces = i18n.reportNamespaces ? i18n.reportNamespaces.getUsedNamespaces() : [];\n  var ret = {};\n  var initialI18nStore = {};\n  i18n.languages.forEach(function (l) {\n    initialI18nStore[l] = {};\n    namespaces.forEach(function (ns) {\n      initialI18nStore[l][ns] = i18n.getResourceBundle(l, ns) || {};\n    });\n  });\n  ret.initialI18nStore = initialI18nStore;\n  ret.initialLanguage = i18n.language;\n  return ret;\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _typeof from \"@babel/runtime/helpers/typeof\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect, useContext, useRef } from 'react';\nimport { getI18n, getDefaults, ReportNamespaces, I18nContext } from './context.js';\nimport { warnOnce, loadNamespaces, loadLanguages, hasLoadedNamespace } from './utils.js';\n\nvar usePrevious = function usePrevious(value, ignore) {\n  var ref = useRef();\n  useEffect(function () {\n    ref.current = ignore ? ref.current : value;\n  }, [value, ignore]);\n  return ref.current;\n};\n\nexport function useTranslation(ns) {\n  var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var i18nFromProps = props.i18n;\n\n  var _ref = useContext(I18nContext) || {},\n      i18nFromContext = _ref.i18n,\n      defaultNSFromContext = _ref.defaultNS;\n\n  var i18n = i18nFromProps || i18nFromContext || getI18n();\n  if (i18n && !i18n.reportNamespaces) i18n.reportNamespaces = new ReportNamespaces();\n\n  if (!i18n) {\n    warnOnce('You will need to pass in an i18next instance by using initReactI18next');\n\n    var notReadyT = function notReadyT(k, optsOrDefaultValue) {\n      if (typeof optsOrDefaultValue === 'string') return optsOrDefaultValue;\n      if (optsOrDefaultValue && _typeof(optsOrDefaultValue) === 'object' && typeof optsOrDefaultValue.defaultValue === 'string') return optsOrDefaultValue.defaultValue;\n      return Array.isArray(k) ? k[k.length - 1] : k;\n    };\n\n    var retNotReady = [notReadyT, {}, false];\n    retNotReady.t = notReadyT;\n    retNotReady.i18n = {};\n    retNotReady.ready = false;\n    return retNotReady;\n  }\n\n  if (i18n.options.react && i18n.options.react.wait !== undefined) warnOnce('It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.');\n\n  var i18nOptions = _objectSpread(_objectSpread(_objectSpread({}, getDefaults()), i18n.options.react), props);\n\n  var useSuspense = i18nOptions.useSuspense,\n      keyPrefix = i18nOptions.keyPrefix;\n  var namespaces = ns || defaultNSFromContext || i18n.options && i18n.options.defaultNS;\n  namespaces = typeof namespaces === 'string' ? [namespaces] : namespaces || ['translation'];\n  if (i18n.reportNamespaces.addUsedNamespaces) i18n.reportNamespaces.addUsedNamespaces(namespaces);\n  var ready = (i18n.isInitialized || i18n.initializedStoreOnce) && namespaces.every(function (n) {\n    return hasLoadedNamespace(n, i18n, i18nOptions);\n  });\n\n  function getT() {\n    return i18n.getFixedT(props.lng || null, i18nOptions.nsMode === 'fallback' ? namespaces : namespaces[0], keyPrefix);\n  }\n\n  var _useState = useState(getT),\n      _useState2 = _slicedToArray(_useState, 2),\n      t = _useState2[0],\n      setT = _useState2[1];\n\n  var joinedNS = namespaces.join();\n  if (props.lng) joinedNS = \"\".concat(props.lng).concat(joinedNS);\n  var previousJoinedNS = usePrevious(joinedNS);\n  var isMounted = useRef(true);\n  useEffect(function () {\n    var bindI18n = i18nOptions.bindI18n,\n        bindI18nStore = i18nOptions.bindI18nStore;\n    isMounted.current = true;\n\n    if (!ready && !useSuspense) {\n      if (props.lng) {\n        loadLanguages(i18n, props.lng, namespaces, function () {\n          if (isMounted.current) setT(getT);\n        });\n      } else {\n        loadNamespaces(i18n, namespaces, function () {\n          if (isMounted.current) setT(getT);\n        });\n      }\n    }\n\n    if (ready && previousJoinedNS && previousJoinedNS !== joinedNS && isMounted.current) {\n      setT(getT);\n    }\n\n    function boundReset() {\n      if (isMounted.current) setT(getT);\n    }\n\n    if (bindI18n && i18n) i18n.on(bindI18n, boundReset);\n    if (bindI18nStore && i18n) i18n.store.on(bindI18nStore, boundReset);\n    return function () {\n      isMounted.current = false;\n      if (bindI18n && i18n) bindI18n.split(' ').forEach(function (e) {\n        return i18n.off(e, boundReset);\n      });\n      if (bindI18nStore && i18n) bindI18nStore.split(' ').forEach(function (e) {\n        return i18n.store.off(e, boundReset);\n      });\n    };\n  }, [i18n, joinedNS]);\n  var isInitial = useRef(true);\n  useEffect(function () {\n    if (isMounted.current && !isInitial.current) {\n      setT(getT);\n    }\n\n    isInitial.current = false;\n  }, [i18n, keyPrefix]);\n  var ret = [t, i18n, ready];\n  ret.t = t;\n  ret.i18n = i18n;\n  ret.ready = ready;\n  if (ready) return ret;\n  if (!ready && !useSuspense) return ret;\n  throw new Promise(function (resolve) {\n    if (props.lng) {\n      loadLanguages(i18n, props.lng, namespaces, function () {\n        return resolve();\n      });\n    } else {\n      loadNamespaces(i18n, namespaces, function () {\n        return resolve();\n      });\n    }\n  });\n}","import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { PanelSection, Input, Button } from '@ohif/ui';\nimport { DicomMetadataStore, ServicesManager } from '@ohif/core';\nimport { useTranslation } from 'react-i18next';\n\nconst DEFAULT_MEATADATA = {\n  PatientWeight: null,\n  PatientSex: null,\n  SeriesTime: null,\n  RadiopharmaceuticalInformationSequence: {\n    RadionuclideTotalDose: null,\n    RadionuclideHalfLife: null,\n    RadiopharmaceuticalStartTime: null,\n  },\n};\n\n/*\n * PETSUV panel enables the user to modify the patient related information, such as\n * patient sex, patientWeight. This is allowed since\n * sometimes these metadata are missing or wrong. By changing them\n * @param param0\n * @returns\n */\nexport default function PanelPetSUV({ servicesManager, commandsManager }) {\n  const { t } = useTranslation('PanelSUV');\n  const { displaySetService, toolGroupService, toolbarService, hangingProtocolService } = (\n    servicesManager as ServicesManager\n  ).services;\n  const [metadata, setMetadata] = useState(DEFAULT_MEATADATA);\n  const [ptDisplaySet, setPtDisplaySet] = useState(null);\n\n  const handleMetadataChange = metadata => {\n    setMetadata(prevState => {\n      const newState = { ...prevState };\n      Object.keys(metadata).forEach(key => {\n        if (typeof metadata[key] === 'object') {\n          newState[key] = {\n            ...prevState[key],\n            ...metadata[key],\n          };\n        } else {\n          newState[key] = metadata[key];\n        }\n      });\n      return newState;\n    });\n  };\n\n  const getMatchingPTDisplaySet = viewportMatchDetails => {\n    const ptDisplaySet = commandsManager.runCommand('getMatchingPTDisplaySet', {\n      viewportMatchDetails,\n    });\n\n    if (!ptDisplaySet) {\n      return;\n    }\n\n    const metadata = commandsManager.runCommand('getPTMetadata', {\n      ptDisplaySet,\n    });\n\n    return {\n      ptDisplaySet,\n      metadata,\n    };\n  };\n\n  useEffect(() => {\n    const displaySets = displaySetService.getActiveDisplaySets();\n    const { viewportMatchDetails } = hangingProtocolService.getMatchDetails();\n    if (!displaySets.length) {\n      return;\n    }\n\n    const displaySetInfo = getMatchingPTDisplaySet(viewportMatchDetails);\n\n    if (!displaySetInfo) {\n      return;\n    }\n\n    const { ptDisplaySet, metadata } = displaySetInfo;\n    setPtDisplaySet(ptDisplaySet);\n    setMetadata(metadata);\n  }, []);\n\n  // get the patientMetadata from the StudyInstanceUIDs and update the state\n  useEffect(() => {\n    const { unsubscribe } = hangingProtocolService.subscribe(\n      hangingProtocolService.EVENTS.PROTOCOL_CHANGED,\n      ({ viewportMatchDetails }) => {\n        const displaySetInfo = getMatchingPTDisplaySet(viewportMatchDetails);\n\n        if (!displaySetInfo) {\n          return;\n        }\n        const { ptDisplaySet, metadata } = displaySetInfo;\n        setPtDisplaySet(ptDisplaySet);\n        setMetadata(metadata);\n      }\n    );\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n\n  function updateMetadata() {\n    if (!ptDisplaySet) {\n      throw new Error('No ptDisplaySet found');\n    }\n\n    // metadata should be dcmjs naturalized\n    DicomMetadataStore.updateMetadataForSeries(\n      ptDisplaySet.StudyInstanceUID,\n      ptDisplaySet.SeriesInstanceUID,\n      metadata\n    );\n\n    // update the displaySets\n    displaySetService.setDisplaySetMetadataInvalidated(ptDisplaySet.displaySetInstanceUID);\n\n    // Crosshair position depends on the metadata values such as the positioning interaction\n    // between series, so when the metadata is updated, the crosshairs need to be reset.\n    setTimeout(() => {\n      commandsManager.runCommand('resetCrosshairs');\n    }, 0);\n  }\n  return (\n    <div className=\"ohif-scrollbar flex min-h-0 flex-auto select-none flex-col justify-between overflow-auto\">\n      <div className=\"flex min-h-0 flex-1 flex-col bg-black text-[13px] font-[300]\">\n        <PanelSection title={t('Patient Information')}>\n          <div className=\"flex flex-col\">\n            <div className=\"bg-primary-dark flex flex-col gap-4 p-2\">\n              <Input\n                containerClassName={'!flex-row !justify-between items-center'}\n                label={t('Patient Sex')}\n                labelClassName=\"text-[13px] font-inter text-white\"\n                className=\"!m-0 !h-[26px] !w-[117px]\"\n                value={metadata.PatientSex || ''}\n                onChange={e => {\n                  handleMetadataChange({\n                    PatientSex: e.target.value,\n                  });\n                }}\n              />\n              <Input\n                containerClassName={'!flex-row !justify-between items-center'}\n                label={t('Weight')}\n                labelChildren={<span className=\"text-aqua-pale\"> kg</span>}\n                labelClassName=\"text-[13px] font-inter text-white\"\n                className=\"!m-0 !h-[26px] !w-[117px]\"\n                value={metadata.PatientWeight || ''}\n                onChange={e => {\n                  handleMetadataChange({\n                    PatientWeight: e.target.value,\n                  });\n                }}\n              />\n              <Input\n                containerClassName={'!flex-row !justify-between items-center'}\n                label={t('Total Dose')}\n                labelChildren={<span className=\"text-aqua-pale\"> bq</span>}\n                labelClassName=\"text-[13px] font-inter text-white\"\n                className=\"!m-0 !h-[26px] !w-[117px]\"\n                value={metadata.RadiopharmaceuticalInformationSequence.RadionuclideTotalDose || ''}\n                onChange={e => {\n                  handleMetadataChange({\n                    RadiopharmaceuticalInformationSequence: {\n                      RadionuclideTotalDose: e.target.value,\n                    },\n                  });\n                }}\n              />\n              <Input\n                containerClassName={'!flex-row !justify-between items-center'}\n                label={t('Half Life')}\n                labelChildren={<span className=\"text-aqua-pale\"> s</span>}\n                labelClassName=\"text-[13px] font-inter text-white\"\n                className=\"!m-0 !h-[26px] !w-[117px]\"\n                value={metadata.RadiopharmaceuticalInformationSequence.RadionuclideHalfLife || ''}\n                onChange={e => {\n                  handleMetadataChange({\n                    RadiopharmaceuticalInformationSequence: {\n                      RadionuclideHalfLife: e.target.value,\n                    },\n                  });\n                }}\n              />\n              <Input\n                containerClassName={'!flex-row !justify-between items-center'}\n                label={t('Injection Time')}\n                labelChildren={<span className=\"text-aqua-pale\"> s</span>}\n                labelClassName=\"text-[13px] font-inter text-white\"\n                className=\"!m-0 !h-[26px] !w-[117px]\"\n                value={\n                  metadata.RadiopharmaceuticalInformationSequence.RadiopharmaceuticalStartTime || ''\n                }\n                onChange={e => {\n                  handleMetadataChange({\n                    RadiopharmaceuticalInformationSequence: {\n                      RadiopharmaceuticalStartTime: e.target.value,\n                    },\n                  });\n                }}\n              />\n              <Input\n                containerClassName={'!flex-row !justify-between items-center'}\n                label={t('Acquisition Time')}\n                labelChildren={<span className=\"text-aqua-pale\"> s</span>}\n                labelClassName=\"text-[13px] font-inter text-white\"\n                className=\"!m-0 !h-[26px] !w-[117px]\"\n                value={metadata.SeriesTime || ''}\n                onChange={() => {}}\n              />\n              <Button\n                className=\"!h-[26px] !w-[115px] self-end !p-0\"\n                onClick={updateMetadata}\n              >\n                Reload Data\n              </Button>\n            </div>\n          </div>\n        </PanelSection>\n      </div>\n    </div>\n  );\n}\n\nPanelPetSUV.propTypes = {\n  servicesManager: PropTypes.shape({\n    services: PropTypes.shape({\n      measurementService: PropTypes.shape({\n        getMeasurements: PropTypes.func.isRequired,\n        subscribe: PropTypes.func.isRequired,\n        EVENTS: PropTypes.object.isRequired,\n        VALUE_TYPES: PropTypes.object.isRequired,\n      }).isRequired,\n    }).isRequired,\n  }).isRequired,\n};\n","import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Icon, ActionButtons } from '@ohif/ui';\nimport { useTranslation } from 'react-i18next';\nimport { eventTarget } from '@cornerstonejs/core';\nimport { Enums } from '@cornerstonejs/tools';\nimport { handleROIThresholding } from '../../utils/handleROIThresholding';\n\nexport default function PanelRoiThresholdSegmentation({ servicesManager, commandsManager }) {\n  const { segmentationService, uiNotificationService } = servicesManager.services;\n  const { t } = useTranslation('PanelSUVExport');\n\n  const [segmentations, setSegmentations] = useState(() => segmentationService.getSegmentations());\n  const [activeSegmentation, setActiveSegmentation] = useState(null);\n\n  /**\n   * Update UI based on segmentation changes (added, removed, updated)\n   */\n  useEffect(() => {\n    // ~~ Subscription\n    const added = segmentationService.EVENTS.SEGMENTATION_ADDED;\n    const updated = segmentationService.EVENTS.SEGMENTATION_UPDATED;\n    const removed = segmentationService.EVENTS.SEGMENTATION_REMOVED;\n    const subscriptions = [];\n\n    [added, updated, removed].forEach(evt => {\n      const { unsubscribe } = segmentationService.subscribe(evt, () => {\n        const segmentations = segmentationService.getSegmentations();\n        setSegmentations(segmentations);\n\n        const activeSegmentation = segmentations.filter(seg => seg.isActive);\n        setActiveSegmentation(activeSegmentation[0]);\n      });\n\n      subscriptions.push(unsubscribe);\n    });\n\n    return () => {\n      subscriptions.forEach(unsub => {\n        unsub();\n      });\n    };\n  }, []);\n\n  useEffect(() => {\n    const callback = async evt => {\n      const { detail } = evt;\n      const { segmentationId } = detail;\n\n      if (!segmentationId) {\n        return;\n      }\n\n      await handleROIThresholding({\n        segmentationId,\n        commandsManager,\n        segmentationService,\n      });\n\n      const segmentation = segmentationService.getSegmentation(segmentationId);\n\n      const { cachedStats } = segmentation;\n      if (!cachedStats) {\n        return;\n      }\n\n      // segment 1\n      const suvPeak = cachedStats?.['1']?.suvPeak?.suvPeak;\n\n      if (Number.isNaN(suvPeak)) {\n        uiNotificationService.show({\n          title: 'SUV Peak',\n          message: 'Segmented volume does not allow SUV Peak calculation',\n          type: 'warning',\n        });\n      }\n    };\n\n    eventTarget.addEventListenerDebounced(Enums.Events.SEGMENTATION_DATA_MODIFIED, callback, 250);\n\n    return () => {\n      eventTarget.removeEventListenerDebounced(Enums.Events.SEGMENTATION_DATA_MODIFIED, callback);\n    };\n  }, []);\n\n  if (!activeSegmentation) {\n    return null;\n  }\n\n  const tmtvValue = activeSegmentation.cachedStats?.tmtv?.value || null;\n  const config = activeSegmentation.cachedStats?.tmtv?.config || {};\n\n  const actions = [\n    {\n      label: 'Export CSV',\n      onClick: () => {\n        commandsManager.runCommand('exportTMTVReportCSV', {\n          segmentations,\n          tmtv: tmtvValue,\n          config,\n        });\n      },\n      disabled: tmtvValue === null,\n    },\n    {\n      label: 'Export RT Report',\n      onClick: () => {\n        commandsManager.runCommand('createTMTVRTReport');\n      },\n      disabled: tmtvValue === null,\n    },\n  ];\n\n  return (\n    <>\n      <div className=\"mt-2 mb-10 flex flex-col\">\n        <div className=\"invisible-scrollbar overflow-y-auto overflow-x-hidden\">\n          {tmtvValue !== null ? (\n            <div className=\"bg-secondary-dark flex items-baseline justify-between px-2 py-1\">\n              <span className=\"text-base font-bold uppercase tracking-widest text-white\">\n                {'TMTV:'}\n              </span>\n              <div className=\"text-white\">{`${tmtvValue} mL`}</div>\n            </div>\n          ) : null}\n          <div className=\"mt-2 flex justify-center\">\n            <ActionButtons\n              actions={actions}\n              t={t}\n            />\n          </div>\n        </div>\n      </div>\n      <div\n        className=\"absolute bottom-1 left-[50px] flex cursor-pointer items-center justify-center text-blue-400 opacity-50 hover:opacity-80\"\n        onClick={() => {\n          // navigate to a url in a new tab\n          window.open('https://github.com/OHIF/Viewers/blob/master/modes/tmtv/README.md', '_blank');\n        }}\n      >\n        <Icon\n          width=\"15px\"\n          height=\"15px\"\n          name={'info'}\n          className={'text-primary-active ml-4 mr-3'}\n        />\n        <span>{'User Guide'}</span>\n      </div>\n    </>\n  );\n}\n\nPanelRoiThresholdSegmentation.propTypes = {\n  commandsManager: PropTypes.shape({\n    runCommand: PropTypes.func.isRequired,\n  }),\n  servicesManager: PropTypes.shape({\n    services: PropTypes.shape({\n      segmentationService: PropTypes.shape({\n        getSegmentation: PropTypes.func.isRequired,\n        getSegmentations: PropTypes.func.isRequired,\n        toggleSegmentationVisibility: PropTypes.func.isRequired,\n        subscribe: PropTypes.func.isRequired,\n        EVENTS: PropTypes.object.isRequired,\n      }).isRequired,\n    }).isRequired,\n  }).isRequired,\n};\n","import { cache } from '@cornerstonejs/core';\n\nexport const handleROIThresholding = async ({\n  segmentationId,\n  commandsManager,\n  segmentationService,\n  config = {},\n}) => {\n  const segmentation = segmentationService.getSegmentation(segmentationId);\n\n  // re-calculating the cached stats for the active segmentation\n  const updatedPerSegmentCachedStats = {};\n  segmentation.segments = await Promise.all(\n    segmentation.segments.map(async segment => {\n      if (!segment || !segment.segmentIndex) {\n        return segment;\n      }\n\n      const labelmap = cache.getVolume(segmentationId);\n\n      const segmentIndex = segment.segmentIndex;\n\n      const lesionStats = commandsManager.run('getLesionStats', { labelmap, segmentIndex });\n      const suvPeak = await commandsManager.run('calculateSuvPeak', { labelmap, segmentIndex });\n      const lesionGlyoclysisStats = lesionStats.volume * lesionStats.meanValue;\n\n      // update segDetails with the suv peak for the active segmentation\n      const cachedStats = {\n        lesionStats,\n        suvPeak,\n        lesionGlyoclysisStats,\n      };\n\n      segment.cachedStats = cachedStats;\n      segment.displayText = [\n        `SUV Peak: ${suvPeak.suvPeak.toFixed(2)}`,\n        `Volume: ${lesionStats.volume.toFixed(2)} mm3`,\n      ];\n      updatedPerSegmentCachedStats[segmentIndex] = cachedStats;\n\n      return segment;\n    })\n  );\n\n  const notYetUpdatedAtSource = true;\n\n  const segmentations = segmentationService.getSegmentations();\n  const tmtv = commandsManager.run('calculateTMTV', { segmentations });\n\n  segmentation.cachedStats = Object.assign(segmentation.cachedStats, updatedPerSegmentCachedStats, {\n    tmtv: {\n      value: tmtv.toFixed(3),\n      config: { ...config },\n    },\n  });\n\n  segmentationService.addOrUpdateSegmentation(\n    {\n      ...segmentation,\n    },\n    false, // don't suppress events\n    notYetUpdatedAtSource\n  );\n};\n","import PanelROIThresholdExport from './PanelROIThresholdExport';\n\nexport default PanelROIThresholdExport;\n","import React from 'react';\nimport { PanelPetSUV, PanelROIThresholdExport } from './Panels';\nimport { Toolbox } from '@ohif/ui';\n\n// TODO:\n// - No loading UI exists yet\n// - cancel promises when component is destroyed\n// - show errors in UI for thumbnails if promise fails\n\nfunction getPanelModule({ commandsManager, extensionManager, servicesManager }) {\n  const wrappedPanelPetSuv = () => {\n    return (\n      <PanelPetSUV\n        commandsManager={commandsManager}\n        servicesManager={servicesManager}\n      />\n    );\n  };\n\n  const wrappedROIThresholdToolbox = () => {\n    return (\n      <>\n        <Toolbox\n          commandsManager={commandsManager}\n          servicesManager={servicesManager}\n          extensionManager={extensionManager}\n          buttonSectionId=\"ROIThresholdToolbox\"\n          title=\"Threshold Tools\"\n        />\n      </>\n    );\n  };\n\n  const wrappedROIThresholdExport = () => {\n    return (\n      <>\n        <PanelROIThresholdExport\n          commandsManager={commandsManager}\n          servicesManager={servicesManager}\n        />\n      </>\n    );\n  };\n\n  return [\n    {\n      name: 'petSUV',\n      iconName: 'tab-patient-info',\n      iconLabel: 'Patient Info',\n      label: 'Patient Info',\n      component: wrappedPanelPetSuv,\n    },\n    {\n      name: 'tmtvBox',\n      iconName: 'tab-segmentation',\n      iconLabel: 'Segmentation',\n      label: 'Segmentation Toolbox',\n      component: wrappedROIThresholdToolbox,\n    },\n    {\n      name: 'tmtvExport',\n      iconName: 'tab-segmentation',\n      iconLabel: 'Segmentation',\n      label: 'Segmentation Export',\n      component: wrappedROIThresholdExport,\n    },\n  ];\n}\n\nexport default getPanelModule;\n","export default ['RectangleROIStartEndThreshold'];\n","import { metaData } from '@cornerstonejs/core';\n\nexport default function getSOPInstanceAttributes(imageId) {\n  if (imageId) {\n    return _getUIDFromImageID(imageId);\n  }\n}\n\nfunction _getUIDFromImageID(imageId) {\n  const instance = metaData.get('instance', imageId);\n\n  return {\n    SOPInstanceUID: instance.SOPInstanceUID,\n    SeriesInstanceUID: instance.SeriesInstanceUID,\n    StudyInstanceUID: instance.StudyInstanceUID,\n    frameNumber: instance.frameNumber || 1,\n  };\n}\n","import SUPPORTED_TOOLS from './constants/supportedTools';\nimport getSOPInstanceAttributes from './utils/getSOPInstanceAttributes';\n\nconst RectangleROIStartEndThreshold = {\n  toAnnotation: (measurement, definition) => {},\n\n  /**\n   * Maps cornerstone annotation event data to measurement service format.\n   *\n   * @param {Object} cornerstone Cornerstone event data\n   * @return {Measurement} Measurement instance\n   */\n  toMeasurement: (csToolsEventDetail, displaySetService, cornerstoneViewportService) => {\n    const { annotation, viewportId } = csToolsEventDetail;\n    const { metadata, data, annotationUID } = annotation;\n\n    if (!metadata || !data) {\n      console.warn('Length tool: Missing metadata or data');\n      return null;\n    }\n\n    const { toolName, referencedImageId, FrameOfReferenceUID } = metadata;\n    const validToolType = SUPPORTED_TOOLS.includes(toolName);\n\n    if (!validToolType) {\n      throw new Error('Tool not supported');\n    }\n\n    const { SOPInstanceUID, SeriesInstanceUID, StudyInstanceUID } = getSOPInstanceAttributes(\n      referencedImageId,\n      cornerstoneViewportService,\n      viewportId\n    );\n\n    let displaySet;\n\n    if (SOPInstanceUID) {\n      displaySet = displaySetService.getDisplaySetForSOPInstanceUID(\n        SOPInstanceUID,\n        SeriesInstanceUID\n      );\n    } else {\n      displaySet = displaySetService.getDisplaySetsForSeries(SeriesInstanceUID);\n    }\n\n    return {\n      uid: annotationUID,\n      SOPInstanceUID,\n      FrameOfReferenceUID,\n      // points,\n      metadata,\n      referenceSeriesUID: SeriesInstanceUID,\n      referenceStudyUID: StudyInstanceUID,\n      toolName: metadata.toolName,\n      displaySetInstanceUID: displaySet.displaySetInstanceUID,\n      label: metadata.label,\n      data: data.cachedStats,\n      type: 'RectangleROIStartEndThreshold',\n    };\n  },\n};\n\nexport default RectangleROIStartEndThreshold;\n","import RectangleROIStartEndThreshold from './RectangleROIStartEndThreshold';\n\nconst measurementServiceMappingsFactory = (\n  measurementService,\n  displaySetService,\n  cornerstoneViewportService\n) => {\n  return {\n    RectangleROIStartEndThreshold: {\n      toAnnotation: RectangleROIStartEndThreshold.toAnnotation,\n      toMeasurement: csToolsAnnotation =>\n        RectangleROIStartEndThreshold.toMeasurement(\n          csToolsAnnotation,\n          displaySetService,\n          cornerstoneViewportService\n        ),\n      matchingCriteria: [\n        {\n          valueType: measurementService.VALUE_TYPES.ROI_THRESHOLD_MANUAL,\n        },\n      ],\n    },\n  };\n};\n\nexport default measurementServiceMappingsFactory;\n","import * as csTools from '@cornerstonejs/tools';\n\nfunction getRoiStats(referencedVolume, annotations) {\n  // roiStats\n  const { imageData } = referencedVolume;\n  const values = imageData.getPointData().getScalars().getData();\n\n  // Todo: add support for other strategies\n  const { fn, baseValue } = _getStrategyFn('max');\n  let value = baseValue;\n\n  const boundsIJK = csTools.utilities.rectangleROITool.getBoundsIJKFromRectangleAnnotations(\n    annotations,\n    referencedVolume\n  );\n\n  const [[iMin, iMax], [jMin, jMax], [kMin, kMax]] = boundsIJK;\n\n  for (let i = iMin; i <= iMax; i++) {\n    for (let j = jMin; j <= jMax; j++) {\n      for (let k = kMin; k <= kMax; k++) {\n        const offset = imageData.computeOffsetIndex([i, j, k]);\n        value = fn(values[offset], value);\n      }\n    }\n  }\n  return value;\n}\n\nfunction getThresholdValues(\n  annotationUIDs,\n  referencedVolumes,\n  config\n): { ptLower: number; ptUpper: number; ctLower: number; ctUpper: number } {\n  if (config.strategy === 'range') {\n    return {\n      ptLower: Number(config.ptLower),\n      ptUpper: Number(config.ptUpper),\n      ctLower: Number(config.ctLower),\n      ctUpper: Number(config.ctUpper),\n    };\n  }\n\n  const { weight } = config;\n  const annotations = annotationUIDs.map(annotationUID =>\n    csTools.annotation.state.getAnnotation(annotationUID)\n  );\n\n  const ptValue = getRoiStats(referencedVolumes[0], annotations);\n\n  return {\n    ctLower: -Infinity,\n    ctUpper: +Infinity,\n    ptLower: weight * ptValue,\n    ptUpper: +Infinity,\n  };\n}\n\nfunction _getStrategyFn(statistic): {\n  fn: (a: number, b: number) => number;\n  baseValue: number;\n} {\n  const baseValue = -Infinity;\n  const fn = (number, maxValue) => {\n    if (number > maxValue) {\n      maxValue = number;\n    }\n    return maxValue;\n  };\n  return { fn, baseValue };\n}\n\nexport default getThresholdValues;\n","import { Types } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/tools';\n\n/**\n * Given a list of labelmaps (with the possibility of overlapping regions),\n * and a referenceVolume, it calculates the total metabolic tumor volume (TMTV)\n * by flattening and rasterizing each segment into a single labelmap and summing\n * the total number of volume voxels. It should be noted that for this calculation\n * we do not double count voxels that are part of multiple labelmaps.\n * @param {} labelmaps\n * @param {number} segmentIndex\n * @returns {number} TMTV in ml\n */\nfunction calculateTMTV(labelmaps: Array<Types.IImageVolume>, segmentIndex = 1): number {\n  const volumeId = 'mergedLabelmap';\n\n  const mergedLabelmap = utilities.segmentation.createMergedLabelmapForIndex(\n    labelmaps,\n    segmentIndex,\n    volumeId\n  );\n\n  const { imageData, spacing } = mergedLabelmap;\n  const values = imageData.getPointData().getScalars().getData();\n\n  // count non-zero values inside the outputData, this would\n  // consider the overlapping regions to be only counted once\n  const numVoxels = values.reduce((acc, curr) => {\n    if (curr > 0) {\n      return acc + 1;\n    }\n    return acc;\n  }, 0);\n\n  return 1e-3 * numVoxels * spacing[0] * spacing[1] * spacing[2];\n}\n\nexport default calculateTMTV;\n","import dcmjs from 'dcmjs';\nimport { classes, DicomMetadataStore } from '@ohif/core';\nimport { adaptersRT } from '@cornerstonejs/adapters';\n\nconst { datasetToBlob } = dcmjs.data;\nconst metadataProvider = classes.MetadataProvider;\n\nexport default function dicomRTAnnotationExport(annotations) {\n  const dataset = adaptersRT.Cornerstone3D.RTSS.generateRTSSFromAnnotations(\n    annotations,\n    metadataProvider,\n    DicomMetadataStore\n  );\n  const reportBlob = datasetToBlob(dataset);\n\n  //Create a URL for the binary.\n  var objectUrl = URL.createObjectURL(reportBlob);\n  window.location.assign(objectUrl);\n}\n","import dicomRTAnnotationExport from './dicomRTAnnotationExport';\n\nexport default dicomRTAnnotationExport;\n","import { vec3 } from 'gl-matrix';\nimport OHIF from '@ohif/core';\nimport * as cs from '@cornerstonejs/core';\nimport * as csTools from '@cornerstonejs/tools';\nimport { classes } from '@ohif/core';\nimport getThresholdValues from './utils/getThresholdValue';\nimport calculateTMTV from './utils/calculateTMTV';\nimport createAndDownloadTMTVReport from './utils/createAndDownloadTMTVReport';\n\nimport dicomRTAnnotationExport from './utils/dicomRTAnnotationExport/RTStructureSet';\n\nimport { getWebWorkerManager } from '@cornerstonejs/core';\n\nconst metadataProvider = classes.MetadataProvider;\nconst RECTANGLE_ROI_THRESHOLD_MANUAL_TOOL_IDS = [\n  'RectangleROIStartEndThreshold',\n  'RectangleROIThreshold',\n];\nconst LABELMAP = csTools.Enums.SegmentationRepresentations.Labelmap;\n\nconst workerManager = getWebWorkerManager();\n\nconst options = {\n  maxWorkerInstances: 1,\n  autoTerminateOnIdle: {\n    enabled: true,\n    idleTimeThreshold: 3000,\n  },\n};\n\n// Register the task\nconst workerFn = () => {\n  return new Worker(new URL('./utils/calculateSUVPeakWorker.js', import.meta.url), {\n    name: 'suv-peak-worker', // name used by the browser to name the worker\n  });\n};\n\nconst commandsModule = ({ servicesManager, commandsManager, extensionManager }) => {\n  const {\n    viewportGridService,\n    uiNotificationService,\n    displaySetService,\n    hangingProtocolService,\n    toolGroupService,\n    cornerstoneViewportService,\n    segmentationService,\n  } = servicesManager.services;\n\n  const utilityModule = extensionManager.getModuleEntry(\n    '@ohif/extension-cornerstone.utilityModule.common'\n  );\n\n  const { getEnabledElement } = utilityModule.exports;\n\n  function _getActiveViewportsEnabledElement() {\n    const { activeViewportId } = viewportGridService.getState();\n    const { element } = getEnabledElement(activeViewportId) || {};\n    const enabledElement = cs.getEnabledElement(element);\n    return enabledElement;\n  }\n\n  function _getMatchedViewportsToolGroupIds() {\n    const { viewportMatchDetails } = hangingProtocolService.getMatchDetails();\n    const toolGroupIds = [];\n    viewportMatchDetails.forEach(viewport => {\n      const { viewportOptions } = viewport;\n      const { toolGroupId } = viewportOptions;\n      if (toolGroupIds.indexOf(toolGroupId) === -1) {\n        toolGroupIds.push(toolGroupId);\n      }\n    });\n\n    return toolGroupIds;\n  }\n\n  function _getAnnotationsSelectedByToolNames(toolNames) {\n    return toolNames.reduce((allAnnotationUIDs, toolName) => {\n      const annotationUIDs =\n        csTools.annotation.selection.getAnnotationsSelectedByToolName(toolName);\n\n      return allAnnotationUIDs.concat(annotationUIDs);\n    }, []);\n  }\n\n  const actions = {\n    getMatchingPTDisplaySet: ({ viewportMatchDetails }) => {\n      // Todo: this is assuming that the hanging protocol has successfully matched\n      // the correct PT. For future, we should have a way to filter out the PTs\n      // that are in the viewer layout (but then we have the problem of the attenuation\n      // corrected PT vs the non-attenuation correct PT)\n\n      let ptDisplaySet = null;\n      for (const [viewportId, viewportDetails] of viewportMatchDetails) {\n        const { displaySetsInfo } = viewportDetails;\n        const displaySets = displaySetsInfo.map(({ displaySetInstanceUID }) =>\n          displaySetService.getDisplaySetByUID(displaySetInstanceUID)\n        );\n\n        if (!displaySets || displaySets.length === 0) {\n          continue;\n        }\n\n        ptDisplaySet = displaySets.find(displaySet => displaySet.Modality === 'PT');\n\n        if (ptDisplaySet) {\n          break;\n        }\n      }\n\n      return ptDisplaySet;\n    },\n    getPTMetadata: ({ ptDisplaySet }) => {\n      const dataSource = extensionManager.getDataSources()[0];\n      const imageIds = dataSource.getImageIdsForDisplaySet(ptDisplaySet);\n\n      const firstImageId = imageIds[0];\n      const instance = metadataProvider.get('instance', firstImageId);\n      if (instance.Modality !== 'PT') {\n        return;\n      }\n\n      const metadata = {\n        SeriesTime: instance.SeriesTime,\n        Modality: instance.Modality,\n        PatientSex: instance.PatientSex,\n        PatientWeight: instance.PatientWeight,\n        RadiopharmaceuticalInformationSequence: {\n          RadionuclideTotalDose:\n            instance.RadiopharmaceuticalInformationSequence[0].RadionuclideTotalDose,\n          RadionuclideHalfLife:\n            instance.RadiopharmaceuticalInformationSequence[0].RadionuclideHalfLife,\n          RadiopharmaceuticalStartTime:\n            instance.RadiopharmaceuticalInformationSequence[0].RadiopharmaceuticalStartTime,\n          RadiopharmaceuticalStartDateTime:\n            instance.RadiopharmaceuticalInformationSequence[0].RadiopharmaceuticalStartDateTime,\n        },\n      };\n\n      return metadata;\n    },\n    createNewLabelmapFromPT: async ({ label }) => {\n      // Create a segmentation of the same resolution as the source data\n      // using volumeLoader.createAndCacheDerivedVolume.\n      const { viewportMatchDetails } = hangingProtocolService.getMatchDetails();\n\n      const ptDisplaySet = actions.getMatchingPTDisplaySet({\n        viewportMatchDetails,\n      });\n\n      if (!ptDisplaySet) {\n        uiNotificationService.error('No matching PT display set found');\n        return;\n      }\n\n      const currentSegmentations = segmentationService.getSegmentations();\n\n      const segmentationId = await segmentationService.createSegmentationForDisplaySet(\n        ptDisplaySet.displaySetInstanceUID,\n        { label: `Segmentation ${currentSegmentations.length + 1}` }\n      );\n\n      // Add Segmentation to all toolGroupIds in the viewer\n      const toolGroupIds = _getMatchedViewportsToolGroupIds();\n      const representationType = LABELMAP;\n\n      for (const toolGroupId of toolGroupIds) {\n        const hydrateSegmentation = true;\n        await segmentationService.addSegmentationRepresentationToToolGroup(\n          toolGroupId,\n          segmentationId,\n          hydrateSegmentation,\n          representationType\n        );\n\n        segmentationService.setActiveSegmentationForToolGroup(segmentationId, toolGroupId);\n      }\n\n      segmentationService.addSegment(segmentationId, {\n        segmentIndex: 1,\n        properties: {\n          label: 'Segment 1',\n        },\n      });\n      return segmentationId;\n    },\n    setSegmentationActiveForToolGroups: ({ segmentationId }) => {\n      const toolGroupIds = _getMatchedViewportsToolGroupIds();\n\n      toolGroupIds.forEach(toolGroupId => {\n        segmentationService.setActiveSegmentationForToolGroup(segmentationId, toolGroupId);\n      });\n    },\n    thresholdSegmentationByRectangleROITool: ({ segmentationId, config, segmentIndex }) => {\n      const segmentation = csTools.segmentation.state.getSegmentation(segmentationId);\n\n      const { representationData } = segmentation;\n      const { displaySetMatchDetails: matchDetails } = hangingProtocolService.getMatchDetails();\n      const volumeLoaderScheme = 'cornerstoneStreamingImageVolume'; // Loader id which defines which volume loader to use\n\n      const ctDisplaySet = matchDetails.get('ctDisplaySet');\n      const ctVolumeId = `${volumeLoaderScheme}:${ctDisplaySet.displaySetInstanceUID}`; // VolumeId with loader id + volume id\n\n      const { volumeId: segVolumeId } = representationData[LABELMAP];\n      const { referencedVolumeId } = cs.cache.getVolume(segVolumeId);\n\n      const annotationUIDs = _getAnnotationsSelectedByToolNames(\n        RECTANGLE_ROI_THRESHOLD_MANUAL_TOOL_IDS\n      );\n\n      if (annotationUIDs.length === 0) {\n        uiNotificationService.show({\n          title: 'Commands Module',\n          message: 'No ROIThreshold Tool is Selected',\n          type: 'error',\n        });\n        return;\n      }\n\n      const labelmapVolume = cs.cache.getVolume(segmentationId);\n      let referencedVolume = cs.cache.getVolume(referencedVolumeId);\n      const ctReferencedVolume = cs.cache.getVolume(ctVolumeId);\n\n      // check if viewport is\n\n      if (!referencedVolume) {\n        throw new Error('No Reference volume found');\n      }\n\n      if (!labelmapVolume) {\n        throw new Error('No Reference labelmap found');\n      }\n\n      const annotation = csTools.annotation.state.getAnnotation(annotationUIDs[0]);\n\n      const {\n        metadata: {\n          enabledElement: { viewport },\n        },\n      } = annotation;\n\n      const showingReferenceVolume = viewport.hasVolumeId(referencedVolumeId);\n\n      if (!showingReferenceVolume) {\n        // if the reference volume is not being displayed, we can't\n        // rely on it for thresholding, we have couple of options here\n        // 1. We choose whatever volume is being displayed\n        // 2. We check if it is a fusion viewport, we pick the volume\n        // that matches the size and dimensions of the labelmap. This might\n        // happen if the 4D PT is converted to a computed volume and displayed\n        // and wants to threshold the labelmap\n        // 3. We throw an error\n        const displaySetInstanceUIDs = viewportGridService.getDisplaySetsUIDsForViewport(\n          viewport.id\n        );\n\n        displaySetInstanceUIDs.forEach(displaySetInstanceUID => {\n          const volume = cs.cache\n            .getVolumes()\n            .find(volume => volume.volumeId.includes(displaySetInstanceUID));\n\n          if (\n            cs.utilities.isEqual(volume.dimensions, labelmapVolume.dimensions) &&\n            cs.utilities.isEqual(volume.spacing, labelmapVolume.spacing)\n          ) {\n            referencedVolume = volume;\n          }\n        });\n      }\n\n      const { ptLower, ptUpper, ctLower, ctUpper } = getThresholdValues(\n        annotationUIDs,\n        [referencedVolume, ctReferencedVolume],\n        config\n      );\n\n      return csTools.utilities.segmentation.rectangleROIThresholdVolumeByRange(\n        annotationUIDs,\n        labelmapVolume,\n        [\n          { volume: referencedVolume, lower: ptLower, upper: ptUpper },\n          { volume: ctReferencedVolume, lower: ctLower, upper: ctUpper },\n        ],\n        { overwrite: true, segmentIndex }\n      );\n    },\n    calculateSuvPeak: async ({ labelmap, segmentIndex }) => {\n      // if we put it in the top, it will appear in other modes\n      workerManager.registerWorker('suv-peak-worker', workerFn, options);\n\n      const { referencedVolumeId } = labelmap;\n      const referencedVolume = cs.cache.getVolume(referencedVolumeId);\n\n      const annotationUIDs = _getAnnotationsSelectedByToolNames(\n        RECTANGLE_ROI_THRESHOLD_MANUAL_TOOL_IDS\n      );\n\n      const annotations = annotationUIDs.map(annotationUID =>\n        csTools.annotation.state.getAnnotation(annotationUID)\n      );\n\n      const labelmapProps = {\n        dimensions: labelmap.dimensions,\n        origin: labelmap.origin,\n        direction: labelmap.direction,\n        spacing: labelmap.spacing,\n        scalarData: labelmap.scalarData,\n        metadata: labelmap.metadata,\n      };\n\n      const referenceVolumeProps = {\n        dimensions: referencedVolume.dimensions,\n        origin: referencedVolume.origin,\n        direction: referencedVolume.direction,\n        spacing: referencedVolume.spacing,\n        scalarData: referencedVolume.scalarData,\n        metadata: referencedVolume.metadata,\n      };\n\n      // metadata in annotations has enabledElement which is not serializable\n      // we need to remove it\n      // Todo: we should probably have a sanitization function for this\n      const annotationsToSend = annotations.map(annotation => {\n        return {\n          ...annotation,\n          metadata: {\n            ...annotation.metadata,\n            enabledElement: {\n              ...annotation.metadata.enabledElement,\n              viewport: null,\n              renderingEngine: null,\n              element: null,\n            },\n          },\n        };\n      });\n\n      const suvPeak = await workerManager.executeTask('suv-peak-worker', 'calculateSuvPeak', {\n        labelmapProps,\n        referenceVolumeProps,\n        annotations: annotationsToSend,\n        segmentIndex,\n      });\n\n      return {\n        suvPeak: suvPeak.mean,\n        suvMax: suvPeak.max,\n        suvMaxIJK: suvPeak.maxIJK,\n        suvMaxLPS: suvPeak.maxLPS,\n      };\n    },\n    getLesionStats: ({ labelmap, segmentIndex = 1 }) => {\n      const { scalarData, spacing } = labelmap;\n      const referencedScalarData = cs.cache.getVolume(labelmap.referencedVolumeId).getScalarData();\n\n      let segmentationMax = -Infinity;\n      let segmentationMin = Infinity;\n      let segmentationValues = [];\n\n      let voxelCount = 0;\n      for (let i = 0; i < scalarData.length; i++) {\n        if (scalarData[i] === segmentIndex) {\n          const value = referencedScalarData[i];\n          segmentationValues.push(value);\n          if (value > segmentationMax) {\n            segmentationMax = value;\n          }\n          if (value < segmentationMin) {\n            segmentationMin = value;\n          }\n          voxelCount++;\n        }\n      }\n\n      const stats = {\n        minValue: segmentationMin,\n        maxValue: segmentationMax,\n        meanValue: segmentationValues.reduce((a, b) => a + b, 0) / voxelCount,\n        stdValue: Math.sqrt(\n          segmentationValues.reduce((a, b) => a + b * b, 0) / voxelCount -\n            segmentationValues.reduce((a, b) => a + b, 0) / voxelCount ** 2\n        ),\n        volume: voxelCount * spacing[0] * spacing[1] * spacing[2] * 1e-3,\n      };\n\n      return stats;\n    },\n    calculateLesionGlycolysis: ({ lesionStats }) => {\n      const { meanValue, volume } = lesionStats;\n\n      return {\n        lesionGlyoclysisStats: volume * meanValue,\n      };\n    },\n    calculateTMTV: ({ segmentations }) => {\n      const labelmaps = segmentations.map(s => segmentationService.getLabelmapVolume(s.id));\n\n      if (!labelmaps.length) {\n        return;\n      }\n\n      return calculateTMTV(labelmaps);\n    },\n    exportTMTVReportCSV: ({ segmentations, tmtv, config, options }) => {\n      const segReport = commandsManager.runCommand('getSegmentationCSVReport', {\n        segmentations,\n      });\n\n      const tlg = actions.getTotalLesionGlycolysis({ segmentations });\n      const additionalReportRows = [\n        { key: 'Total Lesion Glycolysis', value: { tlg: tlg.toFixed(4) } },\n        { key: 'Threshold Configuration', value: { ...config } },\n      ];\n\n      if (tmtv !== undefined) {\n        additionalReportRows.unshift({\n          key: 'Total Metabolic Tumor Volume',\n          value: { tmtv },\n        });\n      }\n\n      createAndDownloadTMTVReport(segReport, additionalReportRows, options);\n    },\n    getTotalLesionGlycolysis: ({ segmentations }) => {\n      const labelmapVolumes = segmentations.map(s => segmentationService.getLabelmapVolume(s.id));\n\n      let mergedLabelmap;\n      // merge labelmap will through an error if labels maps are not the same size\n      // or same direction or ....\n      try {\n        mergedLabelmap =\n          csTools.utilities.segmentation.createMergedLabelmapForIndex(labelmapVolumes);\n      } catch (e) {\n        console.error('commandsModule::getTotalLesionGlycolysis', e);\n        return;\n      }\n\n      // grabbing the first labelmap referenceVolume since it will be the same for all\n      const { referencedVolumeId, spacing } = labelmapVolumes[0];\n\n      if (!referencedVolumeId) {\n        console.error('commandsModule::getTotalLesionGlycolysis:No referencedVolumeId found');\n      }\n\n      const ptVolume = cs.cache.getVolume(referencedVolumeId);\n      const mergedLabelData = mergedLabelmap.getScalarData();\n\n      if (mergedLabelData.length !== ptVolume.getScalarData().length) {\n        console.error(\n          'commandsModule::getTotalLesionGlycolysis:Labelmap and ptVolume are not the same size'\n        );\n      }\n\n      let suv = 0;\n      let totalLesionVoxelCount = 0;\n      for (let i = 0; i < mergedLabelData.length; i++) {\n        // if not background\n        if (mergedLabelData[i] !== 0) {\n          suv += ptVolume.getScalarData()[i];\n          totalLesionVoxelCount += 1;\n        }\n      }\n\n      // Average SUV for the merged labelmap\n      const averageSuv = suv / totalLesionVoxelCount;\n\n      // total Lesion Glycolysis [suv * ml]\n      return averageSuv * totalLesionVoxelCount * spacing[0] * spacing[1] * spacing[2] * 1e-3;\n    },\n    setStartSliceForROIThresholdTool: () => {\n      const { viewport } = _getActiveViewportsEnabledElement();\n      const { focalPoint, viewPlaneNormal } = viewport.getCamera();\n\n      const selectedAnnotationUIDs = _getAnnotationsSelectedByToolNames(\n        RECTANGLE_ROI_THRESHOLD_MANUAL_TOOL_IDS\n      );\n\n      const annotationUID = selectedAnnotationUIDs[0];\n\n      const annotation = csTools.annotation.state.getAnnotation(annotationUID);\n\n      const { handles } = annotation.data;\n      const { points } = handles;\n\n      // get the current slice Index\n      const sliceIndex = viewport.getCurrentImageIdIndex();\n      annotation.data.startSlice = sliceIndex;\n\n      // distance between camera focal point and each point on the rectangle\n      const newPoints = points.map(point => {\n        const distance = vec3.create();\n        vec3.subtract(distance, focalPoint, point);\n        // distance in the direction of the viewPlaneNormal\n        const distanceInViewPlane = vec3.dot(distance, viewPlaneNormal);\n        // new point is current point minus distanceInViewPlane\n        const newPoint = vec3.create();\n        vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, distanceInViewPlane);\n\n        return newPoint;\n        //\n      });\n\n      handles.points = newPoints;\n      // IMPORTANT: invalidate the toolData for the cached stat to get updated\n      // and re-calculate the projection points\n      annotation.invalidated = true;\n      viewport.render();\n    },\n    setEndSliceForROIThresholdTool: () => {\n      const { viewport } = _getActiveViewportsEnabledElement();\n\n      const selectedAnnotationUIDs = _getAnnotationsSelectedByToolNames(\n        RECTANGLE_ROI_THRESHOLD_MANUAL_TOOL_IDS\n      );\n\n      const annotationUID = selectedAnnotationUIDs[0];\n\n      const annotation = csTools.annotation.state.getAnnotation(annotationUID);\n\n      // get the current slice Index\n      const sliceIndex = viewport.getCurrentImageIdIndex();\n      annotation.data.endSlice = sliceIndex;\n\n      // IMPORTANT: invalidate the toolData for the cached stat to get updated\n      // and re-calculate the projection points\n      annotation.invalidated = true;\n\n      viewport.render();\n    },\n    createTMTVRTReport: () => {\n      // get all Rectangle ROI annotation\n      const stateManager = csTools.annotation.state.getAnnotationManager();\n\n      const annotations = [];\n\n      Object.keys(stateManager.annotations).forEach(frameOfReferenceUID => {\n        const forAnnotations = stateManager.annotations[frameOfReferenceUID];\n        const ROIAnnotations = RECTANGLE_ROI_THRESHOLD_MANUAL_TOOL_IDS.reduce(\n          (annotations, toolName) => [...annotations, ...(forAnnotations[toolName] ?? [])],\n          []\n        );\n\n        annotations.push(...ROIAnnotations);\n      });\n\n      commandsManager.runCommand('exportRTReportForAnnotations', {\n        annotations,\n      });\n    },\n    getSegmentationCSVReport: ({ segmentations }) => {\n      if (!segmentations || !segmentations.length) {\n        segmentations = segmentationService.getSegmentations();\n      }\n\n      let report = {};\n\n      for (const segmentation of segmentations) {\n        const { id, label, cachedStats: data } = segmentation;\n\n        const segReport = { id, label };\n\n        if (!data) {\n          report[id] = segReport;\n          continue;\n        }\n\n        Object.keys(data).forEach(key => {\n          if (typeof data[key] !== 'object') {\n            segReport[key] = data[key];\n          } else {\n            Object.keys(data[key]).forEach(subKey => {\n              const newKey = `${key}_${subKey}`;\n              segReport[newKey] = data[key][subKey];\n            });\n          }\n        });\n\n        const labelmapVolume = segmentationService.getLabelmapVolume(id);\n\n        if (!labelmapVolume) {\n          report[id] = segReport;\n          continue;\n        }\n\n        const referencedVolumeId = labelmapVolume.referencedVolumeId;\n        segReport.referencedVolumeId = referencedVolumeId;\n\n        const referencedVolume = segmentationService.getLabelmapVolume(referencedVolumeId);\n\n        if (!referencedVolume) {\n          report[id] = segReport;\n          continue;\n        }\n\n        if (!referencedVolume.imageIds || !referencedVolume.imageIds.length) {\n          report[id] = segReport;\n          continue;\n        }\n\n        const firstImageId = referencedVolume.imageIds[0];\n        const instance = OHIF.classes.MetadataProvider.get('instance', firstImageId);\n\n        if (!instance) {\n          report[id] = segReport;\n          continue;\n        }\n\n        report[id] = {\n          ...segReport,\n          PatientID: instance.PatientID ?? '000000',\n          PatientName: instance.PatientName.Alphabetic,\n          StudyInstanceUID: instance.StudyInstanceUID,\n          SeriesInstanceUID: instance.SeriesInstanceUID,\n          StudyDate: instance.StudyDate,\n        };\n      }\n\n      return report;\n    },\n    exportRTReportForAnnotations: ({ annotations }) => {\n      dicomRTAnnotationExport(annotations);\n    },\n    setFusionPTColormap: ({ toolGroupId, colormap }) => {\n      const toolGroup = toolGroupService.getToolGroup(toolGroupId);\n      const { viewportMatchDetails } = hangingProtocolService.getMatchDetails();\n\n      const ptDisplaySet = actions.getMatchingPTDisplaySet({\n        viewportMatchDetails,\n      });\n\n      if (!ptDisplaySet) {\n        return;\n      }\n\n      const fusionViewportIds = toolGroup.getViewportIds();\n\n      let viewports = [];\n      fusionViewportIds.forEach(viewportId => {\n        commandsManager.runCommand('setViewportColormap', {\n          viewportId,\n          displaySetInstanceUID: ptDisplaySet.displaySetInstanceUID,\n          colormap: {\n            name: colormap,\n          },\n        });\n\n        viewports.push(cornerstoneViewportService.getCornerstoneViewport(viewportId));\n      });\n\n      viewports.forEach(viewport => {\n        viewport.render();\n      });\n    },\n  };\n\n  const definitions = {\n    setEndSliceForROIThresholdTool: {\n      commandFn: actions.setEndSliceForROIThresholdTool,\n    },\n    setStartSliceForROIThresholdTool: {\n      commandFn: actions.setStartSliceForROIThresholdTool,\n    },\n    getMatchingPTDisplaySet: {\n      commandFn: actions.getMatchingPTDisplaySet,\n    },\n    getPTMetadata: {\n      commandFn: actions.getPTMetadata,\n    },\n    createNewLabelmapFromPT: {\n      commandFn: actions.createNewLabelmapFromPT,\n    },\n    setSegmentationActiveForToolGroups: {\n      commandFn: actions.setSegmentationActiveForToolGroups,\n    },\n    thresholdSegmentationByRectangleROITool: {\n      commandFn: actions.thresholdSegmentationByRectangleROITool,\n    },\n    getTotalLesionGlycolysis: {\n      commandFn: actions.getTotalLesionGlycolysis,\n    },\n    calculateSuvPeak: {\n      commandFn: actions.calculateSuvPeak,\n    },\n    getLesionStats: {\n      commandFn: actions.getLesionStats,\n    },\n    calculateTMTV: {\n      commandFn: actions.calculateTMTV,\n    },\n    exportTMTVReportCSV: {\n      commandFn: actions.exportTMTVReportCSV,\n    },\n    createTMTVRTReport: {\n      commandFn: actions.createTMTVRTReport,\n    },\n    getSegmentationCSVReport: {\n      commandFn: actions.getSegmentationCSVReport,\n    },\n    exportRTReportForAnnotations: {\n      commandFn: actions.exportRTReportForAnnotations,\n    },\n    setFusionPTColormap: {\n      commandFn: actions.setFusionPTColormap,\n    },\n  };\n\n  return {\n    actions,\n    definitions,\n    defaultContext: 'TMTV:CORNERSTONE',\n  };\n};\n\nexport default commandsModule;\n","export default function createAndDownloadTMTVReport(segReport, additionalReportRows, options = {}) {\n  const firstReport = segReport[Object.keys(segReport)[0]];\n  const columns = Object.keys(firstReport);\n  const csv = [columns.join(',')];\n\n  Object.values(segReport).forEach(segmentation => {\n    const row = [];\n    columns.forEach(column => {\n      // if it is array then we need to replace , with space to avoid csv parsing error\n      row.push(\n        Array.isArray(segmentation[column]) ? segmentation[column].join(' ') : segmentation[column]\n      );\n    });\n    csv.push(row.join(','));\n  });\n\n  csv.push('');\n  csv.push('');\n  csv.push('');\n\n  csv.push(`Patient ID,${firstReport.PatientID}`);\n  csv.push(`Study Date,${firstReport.StudyDate}`);\n  csv.push('');\n  additionalReportRows.forEach(({ key, value: values }) => {\n    const temp = [];\n    temp.push(`${key}`);\n    Object.keys(values).forEach(k => {\n      temp.push(`${k}`);\n      temp.push(`${values[k]}`);\n    });\n\n    csv.push(temp.join(','));\n  });\n\n  const blob = new Blob([csv.join('\\n')], {\n    type: 'text/csv;charset=utf-8',\n  });\n\n  const url = URL.createObjectURL(blob);\n\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = options.filename ?? `${firstReport.PatientID}_tmtv.csv`;\n  a.click();\n}\n","import React from 'react';\nimport { Input, Label, Select, LegacyButton, LegacyButtonGroup } from '@ohif/ui';\nimport { useTranslation } from 'react-i18next';\n\nexport const ROI_STAT = 'roi_stat';\nconst RANGE = 'range';\n\nconst options = [\n  { value: ROI_STAT, label: 'Max', placeHolder: 'Max' },\n  { value: RANGE, label: 'Range', placeHolder: 'Range' },\n];\n\nfunction ROIThresholdConfiguration({ config, dispatch, runCommand }) {\n  const { t } = useTranslation('ROIThresholdConfiguration');\n\n  return (\n    <div className=\"bg-primary-dark flex flex-col space-y-4\">\n      <div className=\"flex items-end space-x-2\">\n        <div className=\"flex w-1/2 flex-col\">\n          <Select\n            label={t('Strategy')}\n            closeMenuOnSelect={true}\n            className=\"border-primary-main mr-2 bg-black text-white \"\n            options={options}\n            placeholder={options.find(option => option.value === config.strategy).placeHolder}\n            value={config.strategy}\n            onChange={({ value }) => {\n              dispatch({\n                type: 'setStrategy',\n                payload: {\n                  strategy: value,\n                },\n              });\n            }}\n          />\n        </div>\n        <div className=\"w-1/2\">\n          {/* TODO Revisit design of LegacyButtonGroup later - for now use LegacyButton for its children.*/}\n          <LegacyButtonGroup>\n            <LegacyButton\n              size=\"initial\"\n              className=\"px-2 py-2 text-base text-white\"\n              color=\"primaryLight\"\n              variant=\"outlined\"\n              onClick={() => runCommand('setStartSliceForROIThresholdTool')}\n            >\n              {t('Start')}\n            </LegacyButton>\n            <LegacyButton\n              size=\"initial\"\n              color=\"primaryLight\"\n              variant=\"outlined\"\n              className=\"px-2 py-2 text-base text-white\"\n              onClick={() => runCommand('setEndSliceForROIThresholdTool')}\n            >\n              {t('End')}\n            </LegacyButton>\n          </LegacyButtonGroup>\n        </div>\n      </div>\n\n      {config.strategy === ROI_STAT && (\n        <Input\n          label={t('Percentage of Max SUV')}\n          labelClassName=\"text-[13px] font-inter text-white\"\n          className=\"border-primary-main bg-black\"\n          type=\"text\"\n          containerClassName=\"mr-2\"\n          value={config.weight}\n          onChange={e => {\n            dispatch({\n              type: 'setWeight',\n              payload: {\n                weight: e.target.value,\n              },\n            });\n          }}\n        />\n      )}\n      {config.strategy !== ROI_STAT && (\n        <div className=\"mr-2 text-sm\">\n          <table>\n            <tbody>\n              <tr className=\"mt-2\">\n                <td\n                  className=\"pr-4\"\n                  colSpan=\"3\"\n                >\n                  <Label\n                    className=\"font-inter text-[13px] text-white\"\n                    text=\"Lower & Upper Ranges\"\n                  ></Label>\n                </td>\n              </tr>\n              <tr className=\"mt-2\">\n                <td className=\"pr-4 pt-2 text-center\">\n                  <Label\n                    className=\"text-white\"\n                    text=\"CT\"\n                  ></Label>\n                </td>\n                <td>\n                  <div className=\"flex justify-between\">\n                    <Input\n                      label={t('')}\n                      labelClassName=\"text-white\"\n                      className=\"border-primary-main mt-2 bg-black\"\n                      type=\"text\"\n                      containerClassName=\"mr-2\"\n                      value={config.ctLower}\n                      onChange={e => {\n                        dispatch({\n                          type: 'setThreshold',\n                          payload: {\n                            ctLower: e.target.value,\n                          },\n                        });\n                      }}\n                    />\n                    <Input\n                      label={t('')}\n                      labelClassName=\"text-white\"\n                      className=\"border-primary-main mt-2 bg-black\"\n                      type=\"text\"\n                      containerClassName=\"mr-2\"\n                      value={config.ctUpper}\n                      onChange={e => {\n                        dispatch({\n                          type: 'setThreshold',\n                          payload: {\n                            ctUpper: e.target.value,\n                          },\n                        });\n                      }}\n                    />\n                  </div>\n                </td>\n              </tr>\n              <tr>\n                <td className=\"pr-4 pt-2 text-center\">\n                  <Label\n                    className=\"text-white\"\n                    text=\"PT\"\n                  ></Label>\n                </td>\n                <td>\n                  <div className=\"flex justify-between\">\n                    <Input\n                      label={t('')}\n                      labelClassName=\"text-white\"\n                      className=\"border-primary-main mt-2 bg-black\"\n                      type=\"text\"\n                      containerClassName=\"mr-2\"\n                      value={config.ptLower}\n                      onChange={e => {\n                        dispatch({\n                          type: 'setThreshold',\n                          payload: {\n                            ptLower: e.target.value,\n                          },\n                        });\n                      }}\n                    />\n                    <Input\n                      label={t('')}\n                      labelClassName=\"text-white\"\n                      className=\"border-primary-main mt-2 bg-black\"\n                      type=\"text\"\n                      containerClassName=\"mr-2\"\n                      value={config.ptUpper}\n                      onChange={e => {\n                        dispatch({\n                          type: 'setThreshold',\n                          payload: {\n                            ptUpper: e.target.value,\n                          },\n                        });\n                      }}\n                    />\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default ROIThresholdConfiguration;\n","import React, { useState, useCallback, useReducer, useEffect } from 'react';\nimport { Button } from '@ohif/ui';\nimport ROIThresholdConfiguration, {\n  ROI_STAT,\n} from './PanelROIThresholdSegmentation/ROIThresholdConfiguration';\nimport * as cs3dTools from '@cornerstonejs/tools';\n\nconst LOWER_CT_THRESHOLD_DEFAULT = -1024;\nconst UPPER_CT_THRESHOLD_DEFAULT = 1024;\nconst LOWER_PT_THRESHOLD_DEFAULT = 2.5;\nconst UPPER_PT_THRESHOLD_DEFAULT = 100;\nconst WEIGHT_DEFAULT = 0.41; // a default weight for suv max often used in the literature\nconst DEFAULT_STRATEGY = ROI_STAT;\n\nfunction reducer(state, action) {\n  const { payload } = action;\n  const { strategy, ctLower, ctUpper, ptLower, ptUpper, weight } = payload;\n\n  switch (action.type) {\n    case 'setStrategy':\n      return {\n        ...state,\n        strategy,\n      };\n    case 'setThreshold':\n      return {\n        ...state,\n        ctLower: ctLower ? ctLower : state.ctLower,\n        ctUpper: ctUpper ? ctUpper : state.ctUpper,\n        ptLower: ptLower ? ptLower : state.ptLower,\n        ptUpper: ptUpper ? ptUpper : state.ptUpper,\n      };\n    case 'setWeight':\n      return {\n        ...state,\n        weight,\n      };\n    default:\n      return state;\n  }\n}\n\nfunction RectangleROIOptions({ servicesManager, commandsManager }) {\n  const { segmentationService } = servicesManager.services;\n  const [selectedSegmentationId, setSelectedSegmentationId] = useState(null);\n\n  const runCommand = useCallback(\n    (commandName, commandOptions = {}) => {\n      return commandsManager.runCommand(commandName, commandOptions);\n    },\n    [commandsManager]\n  );\n\n  const [config, dispatch] = useReducer(reducer, {\n    strategy: DEFAULT_STRATEGY,\n    ctLower: LOWER_CT_THRESHOLD_DEFAULT,\n    ctUpper: UPPER_CT_THRESHOLD_DEFAULT,\n    ptLower: LOWER_PT_THRESHOLD_DEFAULT,\n    ptUpper: UPPER_PT_THRESHOLD_DEFAULT,\n    weight: WEIGHT_DEFAULT,\n  });\n\n  const handleROIThresholding = useCallback(() => {\n    const segmentationId = selectedSegmentationId;\n    const activeSegmentIndex =\n      cs3dTools.segmentation.segmentIndex.getActiveSegmentIndex(segmentationId);\n\n    // run the threshold based on the active segment index\n    // Todo: later find a way to associate each rectangle with a segment (e.g., maybe with color?)\n    runCommand('thresholdSegmentationByRectangleROITool', {\n      segmentationId,\n      config,\n      segmentIndex: activeSegmentIndex,\n    });\n  }, [selectedSegmentationId, config]);\n\n  useEffect(() => {\n    const segmentations = segmentationService.getSegmentations();\n\n    if (!segmentations.length) {\n      return;\n    }\n\n    const isActive = segmentations.find(seg => seg.isActive);\n    setSelectedSegmentationId(isActive.id);\n  }, []);\n\n  /**\n   * Update UI based on segmentation changes (added, removed, updated)\n   */\n  useEffect(() => {\n    // ~~ Subscription\n    const added = segmentationService.EVENTS.SEGMENTATION_ADDED;\n    const updated = segmentationService.EVENTS.SEGMENTATION_UPDATED;\n    const subscriptions = [];\n\n    [added, updated].forEach(evt => {\n      const { unsubscribe } = segmentationService.subscribe(evt, () => {\n        const segmentations = segmentationService.getSegmentations();\n\n        if (!segmentations.length) {\n          return;\n        }\n\n        const isActive = segmentations.find(seg => seg.isActive);\n        setSelectedSegmentationId(isActive.id);\n      });\n      subscriptions.push(unsubscribe);\n    });\n\n    return () => {\n      subscriptions.forEach(unsub => {\n        unsub();\n      });\n    };\n  }, []);\n\n  return (\n    <div className=\"invisible-scrollbar mb-2 flex flex-col overflow-y-auto overflow-x-hidden\">\n      <ROIThresholdConfiguration\n        config={config}\n        dispatch={dispatch}\n        runCommand={runCommand}\n      />\n      {selectedSegmentationId !== null && (\n        <Button\n          className=\"mt-2 !h-[26px] !w-[75px]\"\n          onClick={handleROIThresholding}\n        >\n          Run\n        </Button>\n      )}\n    </div>\n  );\n}\n\nexport default RectangleROIOptions;\n","import { id } from './id';\nimport getHangingProtocolModule from './getHangingProtocolModule';\nimport getPanelModule from './getPanelModule';\nimport init from './init';\nimport commandsModule from './commandsModule';\nimport getToolbarModule from './getToolbarModule';\n\n/**\n *\n */\nconst tmtvExtension = {\n  /**\n   * Only required property. Should be a unique value across all extensions.\n   */\n  id,\n  preRegistration({ servicesManager, commandsManager, extensionManager, configuration = {} }) {\n    init({ servicesManager, commandsManager, extensionManager, configuration });\n  },\n  getToolbarModule,\n  getPanelModule,\n  getHangingProtocolModule,\n  getCommandsModule({ servicesManager, commandsManager, extensionManager }) {\n    return commandsModule({\n      servicesManager,\n      commandsManager,\n      extensionManager,\n    });\n  },\n};\n\nexport default tmtvExtension;\n","import { addTool, RectangleROIStartEndThresholdTool } from '@cornerstonejs/tools';\n\nimport measurementServiceMappingsFactory from './utils/measurementServiceMappings/measurementServiceMappingsFactory';\n\nconst CORNERSTONE_3D_TOOLS_SOURCE_NAME = 'Cornerstone3DTools';\nconst CORNERSTONE_3D_TOOLS_SOURCE_VERSION = '0.1';\n/**\n *\n * @param {Object} servicesManager\n * @param {Object} configuration\n * @param {Object|Array} configuration.csToolsConfig\n */\nexport default function init({ servicesManager }) {\n  const { measurementService, displaySetService, cornerstoneViewportService } =\n    servicesManager.services;\n\n  addTool(RectangleROIStartEndThresholdTool);\n\n  const { RectangleROIStartEndThreshold } = measurementServiceMappingsFactory(\n    measurementService,\n    displaySetService,\n    cornerstoneViewportService\n  );\n\n  const csTools3DVer1MeasurementSource = measurementService.getSource(\n    CORNERSTONE_3D_TOOLS_SOURCE_NAME,\n    CORNERSTONE_3D_TOOLS_SOURCE_VERSION\n  );\n\n  measurementService.addMapping(\n    csTools3DVer1MeasurementSource,\n    'RectangleROIStartEndThreshold',\n    RectangleROIStartEndThreshold.matchingCriteria,\n    RectangleROIStartEndThreshold.toAnnotation,\n    RectangleROIStartEndThreshold.toMeasurement\n  );\n}\n","import RectangleROIOptions from './Panels/RectangleROIOptions';\n\nexport default function getToolbarModule({ commandsManager, servicesManager }) {\n  return [\n    {\n      name: 'tmtv.RectangleROIThresholdOptions',\n      defaultComponent: () => RectangleROIOptions({ commandsManager, servicesManager }),\n    },\n  ];\n}\n"],"names":["root","factory","exports","module","require","define","amd","globalThis","__WEBPACK_EXTERNAL_MODULE__142__","__WEBPACK_EXTERNAL_MODULE__557__","__WEBPACK_EXTERNAL_MODULE__713__","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__307__","__WEBPACK_EXTERNAL_MODULE__111__","__WEBPACK_EXTERNAL_MODULE__155__","getOwnPropertySymbols","Object","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","assign","test1","String","getOwnPropertyNames","test2","i","fromCharCode","map","n","join","test3","split","forEach","letter","keys","err","shouldUseNative","target","source","from","symbols","to","val","TypeError","toObject","s","arguments","length","key","call","ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","shim","props","propName","componentName","location","propFullName","secret","Error","name","getShim","isRequired","ReactPropTypes","array","bigint","bool","func","number","object","string","symbol","any","arrayOf","element","elementType","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","l","p","Fragment","StrictMode","Profiler","q","r","t","Suspense","u","v","Symbol","for","w","x","iterator","z","a","b","c","encodeURIComponent","A","isMounted","enqueueForceUpdate","enqueueReplaceState","enqueueSetState","B","C","this","context","refs","updater","D","E","isReactComponent","setState","forceUpdate","F","constructor","isPureReactComponent","G","current","H","I","ref","__self","__source","J","e","d","k","h","g","children","f","Array","m","defaultProps","$$typeof","type","_owner","L","M","N","replace","escape","toString","O","isArray","K","push","y","next","done","value","P","Q","_status","_result","then","default","R","S","T","ReactCurrentDispatcher","ReactCurrentBatchConfig","transition","ReactCurrentOwner","IsSomeRendererActing","Children","apply","count","toArray","only","Component","PureComponent","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","cloneElement","createContext","_calculateChangedBits","_currentValue","_currentValue2","_threadCount","Provider","Consumer","_context","createElement","createFactory","bind","createRef","forwardRef","render","isValidElement","lazy","_payload","_init","memo","compare","useCallback","useContext","useDebugValue","useEffect","useImperativeHandle","useLayoutEffect","useMemo","useReducer","useRef","useState","version","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","o","defineProperty","enumerable","get","chunkId","obj","prop","toStringTag","document","baseURI","self","href","id","packageJson","ctAXIAL","viewportOptions","viewportId","viewportType","orientation","toolGroupId","initialImageOptions","preset","syncGroups","options","syncColormap","displaySets","ctSAGITTAL","ctCORONAL","ptAXIAL","background","syncInvertState","voi","custom","voiInverted","ptSAGITTAL","ptCORONAL","fusionAXIAL","colormap","opacity","fusionSAGITTAL","fusionCORONAL","mipSAGITTAL","customViewportProps","hideOverlays","blendMode","slabThickness","ptCT","locked","createdDate","modifiedDate","availableTo","editableBy","imageLoadStrategy","protocolMatchingRules","attribute","constraint","contains","displaySetSelectors","ctDisplaySet","seriesMatchingRules","equals","required","ptDisplaySet","weight","doesNotContain","stages","viewportStructure","layoutType","properties","rows","columns","layoutOptions","width","height","viewports","numberOfPriorsReferenced","protocol","toPropertyKey","toPrimitive","Number","configurable","writable","create","console","warn","_console","_len","args","_key","concat","alreadyWarned","_len2","_key2","Date","loadedClb","i18n","cb","isInitialized","on","initialized","setTimeout","off","loadNamespaces","ns","loadLanguages","lng","indexOf","matchHtmlEntity","htmlEntities","unescapeHtmlEntity","i18nInstance","defaultOptions","bindI18n","bindI18nStore","transEmptyNodeValue","transSupportBasicHtmlNodes","transWrapTextNodes","transKeepBasicHtmlNodesFor","useSuspense","unescape","text","_defineProperties","descriptor","ReportNamespaces","instance","Constructor","_classCallCheck","usedNamespaces","protoProps","staticProps","namespaces","_this","_arrayLikeToArray","arr","len","arr2","minLen","slice","test","enumerableOnly","filter","sym","getOwnPropertyDescriptor","getOwnPropertyDescriptors","defineProperties","usePrevious","ignore","i18nFromProps","_ref","i18nFromContext","defaultNSFromContext","defaultNS","reportNamespaces","notReadyT","optsOrDefaultValue","defaultValue","retNotReady","ready","react","wait","i18nOptions","keyPrefix","addUsedNamespaces","initializedStoreOnce","every","languages","ignoreJSONStructure","hasLoadedNamespace","precheck","loadNotPending","services","backendConnector","backend","isLanguageChangingTo","fallbackLng","lastLng","toLowerCase","loadState","state","hasResourceBundle","resources","partialBundledLanguages","oldI18nextHasLoadedNamespace","getT","getFixedT","nsMode","_useState2","setT","joinedNS","previousJoinedNS","boundReset","store","isInitial","ret","Promise","resolve","DEFAULT_MEATADATA","PatientWeight","PatientSex","SeriesTime","RadiopharmaceuticalInformationSequence","RadionuclideTotalDose","RadionuclideHalfLife","RadiopharmaceuticalStartTime","PanelPetSUV","servicesManager","commandsManager","useTranslation","displaySetService","toolGroupService","toolbarService","hangingProtocolService","metadata","setMetadata","setPtDisplaySet","handleMetadataChange","prevState","newState","getMatchingPTDisplaySet","viewportMatchDetails","runCommand","getActiveDisplaySets","getMatchDetails","displaySetInfo","unsubscribe","subscribe","EVENTS","PROTOCOL_CHANGED","React","className","PanelSection","title","Input","containerClassName","label","labelClassName","onChange","labelChildren","Button","onClick","DicomMetadataStore","updateMetadataForSeries","StudyInstanceUID","SeriesInstanceUID","setDisplaySetMetadataInvalidated","displaySetInstanceUID","propTypes","measurementService","getMeasurements","VALUE_TYPES","PanelRoiThresholdSegmentation","segmentationService","uiNotificationService","segmentations","setSegmentations","getSegmentations","activeSegmentation","setActiveSegmentation","added","SEGMENTATION_ADDED","updated","SEGMENTATION_UPDATED","removed","SEGMENTATION_REMOVED","subscriptions","evt","seg","isActive","unsub","callback","async","detail","segmentationId","config","segmentation","getSegmentation","updatedPerSegmentCachedStats","segments","all","segment","segmentIndex","labelmap","cache","getVolume","lesionStats","run","suvPeak","cachedStats","lesionGlyoclysisStats","volume","meanValue","displayText","toFixed","tmtv","addOrUpdateSegmentation","handleROIThresholding","isNaN","show","message","eventTarget","addEventListenerDebounced","Enums","Events","SEGMENTATION_DATA_MODIFIED","removeEventListenerDebounced","tmtvValue","actions","disabled","ActionButtons","window","open","Icon","toggleSegmentationVisibility","extensionManager","iconName","iconLabel","component","wrappedPanelPetSuv","wrappedROIThresholdToolbox","Toolbox","buttonSectionId","wrappedROIThresholdExport","PanelROIThresholdExport","getSOPInstanceAttributes","imageId","metaData","SOPInstanceUID","frameNumber","_getUIDFromImageID","toAnnotation","measurement","toMeasurement","csToolsEventDetail","cornerstoneViewportService","annotation","data","annotationUID","toolName","referencedImageId","FrameOfReferenceUID","SUPPORTED_TOOLS","includes","displaySet","getDisplaySetForSOPInstanceUID","getDisplaySetsForSeries","uid","referenceSeriesUID","referenceStudyUID","measurementServiceMappingsFactory","RectangleROIStartEndThreshold","csToolsAnnotation","matchingCriteria","valueType","ROI_THRESHOLD_MANUAL","getRoiStats","referencedVolume","annotations","imageData","values","getPointData","getScalars","getData","fn","baseValue","statistic","Infinity","maxValue","_getStrategyFn","boundsIJK","csTools","rectangleROITool","getBoundsIJKFromRectangleAnnotations","iMin","iMax","jMin","jMax","kMin","kMax","j","computeOffsetIndex","annotationUIDs","referencedVolumes","strategy","ptLower","ptUpper","ctLower","ctUpper","getAnnotation","labelmaps","mergedLabelmap","utilities","createMergedLabelmapForIndex","spacing","reduce","acc","curr","datasetToBlob","dcmjs","metadataProvider","classes","MetadataProvider","dataset","adaptersRT","Cornerstone3D","RTSS","generateRTSSFromAnnotations","reportBlob","objectUrl","URL","createObjectURL","RECTANGLE_ROI_THRESHOLD_MANUAL_TOOL_IDS","LABELMAP","SegmentationRepresentations","Labelmap","workerManager","getWebWorkerManager","maxWorkerInstances","autoTerminateOnIdle","enabled","idleTimeThreshold","workerFn","Worker","commandsModule","viewportGridService","utilityModule","getModuleEntry","getEnabledElement","_getActiveViewportsEnabledElement","activeViewportId","getState","cs","_getMatchedViewportsToolGroupIds","toolGroupIds","viewport","_getAnnotationsSelectedByToolNames","toolNames","allAnnotationUIDs","selection","getAnnotationsSelectedByToolName","viewportDetails","displaySetsInfo","getDisplaySetByUID","find","Modality","getPTMetadata","firstImageId","getDataSources","getImageIdsForDisplaySet","RadiopharmaceuticalStartDateTime","createNewLabelmapFromPT","error","currentSegmentations","createSegmentationForDisplaySet","representationType","hydrateSegmentation","addSegmentationRepresentationToToolGroup","setActiveSegmentationForToolGroup","addSegment","setSegmentationActiveForToolGroups","thresholdSegmentationByRectangleROITool","representationData","displaySetMatchDetails","matchDetails","ctVolumeId","volumeId","segVolumeId","referencedVolumeId","labelmapVolume","ctReferencedVolume","enabledElement","hasVolumeId","getDisplaySetsUIDsForViewport","getVolumes","isEqual","dimensions","getThresholdValues","rectangleROIThresholdVolumeByRange","lower","upper","overwrite","calculateSuvPeak","registerWorker","labelmapProps","origin","direction","scalarData","referenceVolumeProps","annotationsToSend","renderingEngine","executeTask","mean","suvMax","max","suvMaxIJK","maxIJK","suvMaxLPS","maxLPS","getLesionStats","referencedScalarData","getScalarData","segmentationMax","segmentationMin","segmentationValues","voxelCount","stats","minValue","stdValue","Math","sqrt","calculateLesionGlycolysis","calculateTMTV","getLabelmapVolume","exportTMTVReportCSV","segReport","additionalReportRows","tlg","getTotalLesionGlycolysis","unshift","firstReport","csv","row","column","PatientID","StudyDate","temp","blob","Blob","url","download","filename","click","createAndDownloadTMTVReport","labelmapVolumes","ptVolume","mergedLabelData","suv","totalLesionVoxelCount","setStartSliceForROIThresholdTool","focalPoint","viewPlaneNormal","getCamera","handles","points","sliceIndex","getCurrentImageIdIndex","startSlice","newPoints","point","distance","vec3","subtract","distanceInViewPlane","dot","newPoint","scaleAndAdd","invalidated","setEndSliceForROIThresholdTool","endSlice","createTMTVRTReport","stateManager","getAnnotationManager","frameOfReferenceUID","forAnnotations","ROIAnnotations","getSegmentationCSVReport","report","subKey","imageIds","OHIF","PatientName","Alphabetic","exportRTReportForAnnotations","dicomRTAnnotationExport","setFusionPTColormap","toolGroup","getToolGroup","fusionViewportIds","getViewportIds","getCornerstoneViewport","definitions","commandFn","defaultContext","ROI_STAT","placeHolder","dispatch","Select","closeMenuOnSelect","placeholder","option","payload","LegacyButtonGroup","LegacyButton","size","color","variant","colSpan","Label","DEFAULT_STRATEGY","reducer","action","selectedSegmentationId","setSelectedSegmentationId","commandName","commandOptions","activeSegmentIndex","cs3dTools","getActiveSegmentIndex","ROIThresholdConfiguration","tmtvExtension","preRegistration","configuration","addTool","RectangleROIStartEndThresholdTool","csTools3DVer1MeasurementSource","getSource","addMapping","init","getToolbarModule","defaultComponent","RectangleROIOptions","getPanelModule","getHangingProtocolModule","getCommandsModule"],"sourceRoot":""}