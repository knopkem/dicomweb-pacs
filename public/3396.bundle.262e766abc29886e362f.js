/*! For license information please see 3396.bundle.262e766abc29886e362f.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[3396],{46347:(e,t,n)=>{"use strict";n.d(t,{A:()=>N});var r=n(33739),i=n(660),o=n(99341),a=n(3823),s=n(49038),l=n(19325),c=n(71851),u=n(41864),d=n(10364),p=n(26896),f=n(69372),h=n(13859),m=n(50134),g=n(40256),v=n(38669),y=n(85745),b=n(61640),x=n(90740),A=n(10056),C=n(17232),T=n(61375),S=n(98039),w=n(80500),_=n(70210),I=n(74638),E=n(96833),D=n(39537),O=n(80221),P=n(74876);class R extends A.A{constructor(e){if(super(e),this.useCPURendering=!1,this.perVolumeIdDefaultProperties=new Map,this.viewportProperties={},this.volumeIds=new Set,this.setRotation=e=>{const t=this.getPan(this.fitToCanvasCamera),n=this.getPan(),r=this.getCamera(),i=a.Zc.sub([0,0],t,n);this.setPan(i,!1);const{flipVertical:o}=this.getCamera(),s=o?a.eR.negate([0,0,0],this.initialViewUp):this.initialViewUp;this.setCameraNoEvent({viewUp:s}),this.rotateCamera(e);const l=this.getPan(),u=this.getPan(this.fitToCanvasCamera),d=a.Zc.sub([0,0],l,u),p=a.Zc.add([0,0],t,d);if(this.setPan(p,!1),this._suppressCameraModifiedEvents)return;const h={previousCamera:r,camera:this.getCamera(),element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};(0,f.A)(this.element,c.Events.CAMERA_MODIFIED,h)},this.getDefaultProperties=e=>{let t;return void 0!==e&&(t=this.perVolumeIdDefaultProperties.get(e)),void 0!==t?t:{...this.globalDefaultProperties}},this.getProperties=e=>{if(!this._getApplicableVolumeActor(e))return;const{colormap:t,VOILUTFunction:n,interpolationType:r,invert:i,slabThickness:o,preset:a}=this.viewportProperties;e||=this.getVolumeId();if(!s.Ay.getVolume(e))return null;const l=this.getActors().find((t=>t.referencedId===e));if(!l)return;const c=l.actor.getProperty().getRGBTransferFunction(0),[u,d]="SIGMOID"===this.viewportProperties?.VOILUTFunction?(0,_.A)(c):c.getRange(),p={lower:u,upper:d},f=this.getColormap(e);return{colormap:e&&f?f:t,voiRange:p,VOILUTFunction:n,interpolationType:r,invert:i,slabThickness:o,preset:a}},this.getColormap=e=>{const t=this._getApplicableVolumeActor(e);if(!t)return;const{volumeActor:n}=t,r=this._getOrCreateColorTransferFunction(e),{nodes:i}=r.getState(),o=i.reduce(((e,t)=>(e.push(t.x,t.r,t.g,t.b),e)),[]);return(0,h.findMatchingColormap)(o,n)},this.getRotation=()=>{const{viewUp:e,viewPlaneNormal:t,flipVertical:n}=this.getCameraNoRotation(),r=n?a.eR.negate([0,0,0],this.initialViewUp):this.initialViewUp;if(!r)return 0;const i=180*a.eR.angle(r,e)/Math.PI,o=a.eR.cross([0,0,0],r,e);return a.eR.dot(o,t)>=0?i:(360-i)%360},this.getFrameOfReferenceUID=()=>this._FrameOfReferenceUID,this.canvasToWorld=e=>{const t=this.getVtkActiveCamera();t.setIsPerformingCoordinateTransformation?.(!0);const n=this.getRenderer(),r=this.getVtkDisplayCoords(e),i=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow().displayToWorld(r[0],r[1],r[2],n);return t.setIsPerformingCoordinateTransformation?.(!1),[i[0],i[1],i[2]]},this.getVtkDisplayCoords=e=>{const t=window.devicePixelRatio||1,n=[e[0]*t,e[1]*t],r=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow().getSize(),i=[n[0]+this.sx,n[1]+this.sy];return i[1]=r[1]-i[1],[i[0],i[1],0]},this.worldToCanvas=e=>{const t=this.getVtkActiveCamera();t.setIsPerformingCoordinateTransformation?.(!0);const n=this.getRenderer(),r=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),i=r.getSize(),o=r.worldToDisplay(...e,n);o[1]=i[1]-o[1];const a=[o[0]-this.sx,o[1]-this.sy],s=window.devicePixelRatio||1,l=[a[0]/s,a[1]/s];return t.setIsPerformingCoordinateTransformation(!1),l},this.hasImageURI=e=>this.getActors().filter((e=>(0,S.N)(e,"vtkVolume"))).some((({uid:t,referencedId:n})=>{const r=s.Ay.getVolume(n||t);if(!r?.imageIds)return!1;return r.imageIds.map(D.A).includes(e)})),this.getImageIds=e=>{const t=this._getApplicableVolumeActor(e);if(!t)throw new Error(`No actor found for the given volumeId: ${e}`);const n=t.volumeId,r=s.Ay.getVolume(n);if(!r)throw new Error(`imageVolume with id: ${n} does not exist in cache`);return r.imageIds},this.useCPURendering=(0,p.LH)(),this.useCPURendering)throw new Error("VolumeViewports cannot be used whilst CPU Fallback Rendering is enabled.");const t=this.getRenderer(),n=C.Ay.newInstance();switch(t.setActiveCamera(n),this.type){case u.A.ORTHOGRAPHIC:case u.A.VOLUME_3D:n.setParallelProjection(!0);break;case u.A.PERSPECTIVE:n.setParallelProjection(!1);break;default:throw new Error(`Unrecognized viewport type: ${this.type}`)}this.initializeVolumeNewImageEventDispatcher()}static get useCustomRenderingPipeline(){return!1}getSliceViewInfo(){throw new Error("Method not implemented.")}applyViewOrientation(e,t=!0){const{viewPlaneNormal:n,viewUp:r}=this._getOrientationVectors(e),i=this.getVtkActiveCamera();if(i.setDirectionOfProjection(-n[0],-n[1],-n[2]),i.setViewUpFrom(r),this.initialViewUp=r,t){this.resetCamera({resetOrientation:!1,resetRotation:!1})}}initializeVolumeNewImageEventDispatcher(){const e=function(e){const{viewportId:t}=e.detail;if(t!==this.id||this.isDisabled)return;if(!this.getImageData())return;(0,x.A)(e)}.bind(this),t=function(n){const{viewportId:r}=n.detail;if(r!==this.id)return;this.element.removeEventListener(c.Events.CAMERA_MODIFIED,e),d.A.removeEventListener(c.Events.ELEMENT_DISABLED,t),(0,x.g)(r)}.bind(this);this.element.removeEventListener(c.Events.CAMERA_MODIFIED,e),this.element.addEventListener(c.Events.CAMERA_MODIFIED,e),d.A.addEventListener(c.Events.ELEMENT_DISABLED,t)}setVOILUTFunction(e,t,n){Object.values(c.VOILUTFunctionType).includes(e)||(e=c.VOILUTFunctionType.LINEAR);const{voiRange:r}=this.getProperties();this.setVOI(r,t,n),this.viewportProperties.VOILUTFunction=e}setColormap(e,t,n){const o=this._getApplicableVolumeActor(t);if(!o)return;const{volumeActor:a}=o,s=r.Ay.newInstance();let l=h.getColormap(e.name);const{name:u}=e;if(l||(l=i.A.getPresetByName(u)),!l)throw new Error(`Colormap ${e} not found`);const d=a.getProperty().getRGBTransferFunction(0).getRange();if(s.applyColorMap(l),s.setMappingRange(d[0],d[1]),a.getProperty().setRGBTransferFunction(0,s),this.viewportProperties.colormap=e,!n){const n={viewportId:this.id,colormap:e,volumeId:t};(0,f.A)(this.element,c.Events.VOI_MODIFIED,n),(0,f.A)(this.element,c.Events.COLORMAP_MODIFIED,n)}}setOpacity(e,t){const n=this._getApplicableVolumeActor(t);if(!n)return;const{volumeActor:r}=n,i=o.Ay.newInstance();if("number"==typeof e.opacity){const t=r.getProperty().getRGBTransferFunction(0).getRange();i.addPoint(t[0],e.opacity),i.addPoint(t[1],e.opacity)}else e.opacity.forEach((({opacity:e,value:t})=>{i.addPoint(t,e)}));r.getProperty().setScalarOpacity(0,i),this.viewportProperties.colormap||(this.viewportProperties.colormap={}),this.viewportProperties.colormap.opacity=e.opacity}setInvert(e,t,n){const r=this._getApplicableVolumeActor(t);if(!r)return;const i=r.volumeId,o=this._getOrCreateColorTransferFunction(i);if((0,m.A)(o),this.viewportProperties.invert=e,!n){const e={...this.getVOIModifiedEventDetail(i),invertStateChanged:!0};(0,f.A)(this.element,c.Events.VOI_MODIFIED,e)}}getVOIModifiedEventDetail(e){const t=this._getApplicableVolumeActor(e);if(!t)throw new Error(`No actor found for the given volumeId: ${e}`);const n=t.volumeActor.getProperty().getRGBTransferFunction(0).getMappingRange(),r=this.getColormap(e),{VOILUTFunction:i,invert:o}=this.getProperties(e);return{viewportId:this.id,range:{lower:n[0],upper:n[1]},volumeId:t.volumeId,VOILUTFunction:i,colormap:r,invert:o}}_getOrCreateColorTransferFunction(e){const t=this._getApplicableVolumeActor(e);if(!t)return null;const{volumeActor:n}=t,i=n.getProperty().getRGBTransferFunction(0);if(i)return i;const o=r.Ay.newInstance();return n.getProperty().setRGBTransferFunction(0,o),o}setInterpolationType(e,t){const n=this._getApplicableVolumeActor(t);if(!n)return;const{volumeActor:r}=n;r.getProperty().setInterpolationType(e),this.viewportProperties.interpolationType=e}setVOI(e,t,n=!1){const r=this._getApplicableVolumeActor(t);if(!r)return;const{volumeActor:i}=r,o=r.volumeId,a=e;if(void 0===a)throw new Error("voiRangeToUse is undefined, need to implement this in the new volume model");const{VOILUTFunction:s}=this.getProperties(o);if(s===c.VOILUTFunctionType.SAMPLED_SIGMOID){const e=(0,g.A)(a);i.getProperty().setRGBTransferFunction(0,e)}else{const{lower:e,upper:t}=a;i.getProperty().getRGBTransferFunction(0).setRange(e,t)}if(!n){const e={...this.getVOIModifiedEventDetail(o)};(0,f.A)(this.element,c.Events.VOI_MODIFIED,e)}this.viewportProperties.voiRange=a}rotateCamera(e){const t=e-this.getRotation();this.getVtkActiveCamera().roll(-t)}setDefaultProperties(e,t){null==t?this.globalDefaultProperties=e:this.perVolumeIdDefaultProperties.set(t,e)}clearDefaultProperties(e){null==e?(this.globalDefaultProperties={},this.resetProperties()):(this.perVolumeIdDefaultProperties.delete(e),this.resetToDefaultProperties(e))}getViewReference(e={}){const t=super.getViewReference(e),n=this.getVolumeId(e);if(!1!==e?.forFrameOfReference&&(t.volumeId=n),"number"!=typeof e?.sliceIndex)return t;const{viewPlaneNormal:r}=t,i=e?.sliceIndex-this.getSliceIndex(),{sliceRangeInfo:o}=(0,T.A)(this,n,!0),{sliceRange:a,spacingInNormalDirection:s,camera:l}=o,{focalPoint:c,position:u}=l,{newFocalPoint:d}=(0,w.A)(c,u,a,r,s,i);return t.cameraFocalPoint=d,t}isReferenceViewable(e,t){if(!e.FrameOfReferenceUID)return!1;if(!super.isReferenceViewable(e,t))return!1;if(t?.withNavigation)return!0;const n=this.getSliceIndex(),{sliceIndex:r}=e;return Array.isArray(r)?r[0]<=n&&n<=r[1]:void 0===r||r===n}scroll(e=1){const t=this.getVolumeId(),{sliceRangeInfo:n}=(0,T.A)(this,t,!0);if(!n)return;const{sliceRange:r,spacingInNormalDirection:i,camera:o}=n,{focalPoint:a,viewPlaneNormal:s,position:l}=o,{newFocalPoint:c,newPosition:u}=(0,w.A)(a,l,r,s,i,e);this.setCamera({focalPoint:c,position:u}),this.render()}setViewReference(e){if(!e)return;const t=this.getVolumeId(),{viewPlaneNormal:n,FrameOfReferenceUID:r,cameraFocalPoint:i,referencedImageId:o,viewUp:s}=e;let{sliceIndex:l}=e;const{focalPoint:u,viewPlaneNormal:d,position:p}=this.getCamera(),f=(0,I.WC)(d,n),h=(0,I.Ay)(d,n);if("number"==typeof l&&e.volumeId===t&&(f||h)){const{currentStepIndex:e,sliceRangeInfo:n,numScrollSteps:r}=(0,T.A)(this,t,!0),{sliceRange:i,spacingInNormalDirection:o}=n;f&&(l=r-l-1);const a=l-e,{newFocalPoint:s,newPosition:c}=(0,w.A)(u,p,i,d,o,a);this.setCamera({focalPoint:s,position:c})}else{if(r!==this.getFrameOfReferenceUID())throw new Error(`Incompatible view refs: ${r}!==${this.getFrameOfReferenceUID()}`);if(n&&!f&&!h)return this.setOrientation({viewPlaneNormal:n,viewUp:s}),void this.setViewReference(e);if(i){const e=a.eR.subtract([0,0,0],i,u),t=n??d,r=a.eR.dot(e,t);(0,I.Ay)(r,0)||a.eR.scale(e,t,r);const o=a.eR.add([0,0,0],u,e),s=a.eR.add([0,0,0],p,e);this.setCamera({focalPoint:o,position:s})}if(o&&this.isInAcquisitionPlane()){const e=P.get(c.MetadataModules.IMAGE_PLANE,o),{imagePositionPatient:t}=e,{focalPoint:n}=this.getCamera(),r=a.eR.subtract(a.eR.create(),n,t),i=a.eR.dot(r,d),s=a.eR.scaleAndAdd(a.eR.create(),n,[-d[0],-d[1],-d[2]],i);this.setCamera({focalPoint:s}),this.render()}}}setProperties({voiRange:e,VOILUTFunction:t,invert:n,colormap:r,preset:i,interpolationType:o,slabThickness:a}={},s,l=!1){null==this.globalDefaultProperties&&this.setDefaultProperties({voiRange:e,VOILUTFunction:t,invert:n,colormap:r,preset:i,slabThickness:a}),void 0!==n&&this.viewportProperties.invert!==n&&this.setInvert(n,s,l),r?.name&&this.setColormap(r,s,l),null!=r?.opacity&&this.setOpacity(r,s),void 0!==e&&this.setVOI(e,s,l),void 0!==o&&this.setInterpolationType(o),void 0!==t&&this.setVOILUTFunction(t,s,l),void 0!==i&&this.setPreset(i,s,l),void 0!==a&&this.setSlabThickness(a)}resetToDefaultProperties(e){const t=this.globalDefaultProperties;t.colormap?.name&&this.setColormap(t.colormap,e),null!=t.colormap?.opacity&&this.setOpacity(t.colormap,e),void 0!==t.voiRange&&this.setVOI(t.voiRange,e),void 0!==t.VOILUTFunction&&this.setVOILUTFunction(t.VOILUTFunction,e),void 0!==t.invert&&this.setInvert(t.invert,e),void 0!==t.slabThickness&&(this.setSlabThickness(t.slabThickness),this.viewportProperties.slabThickness=t.slabThickness),void 0!==t.preset&&this.setPreset(t.preset,e,!1),void 0!==t.preset&&this.setPreset(t.preset,e,!1),this.render()}setPreset(e,t,n){const r=this._getApplicableVolumeActor(t);if(!r)return;const{volumeActor:i}=r;let o=e;"string"==typeof o&&(o=l.VIEWPORT_PRESETS.find((t=>t.name===e))),o&&((0,E.A)(i,o),this.viewportProperties.preset=o,this.render(),n||(0,f.A)(this.element,c.Events.PRESET_MODIFIED,{viewportId:this.id,volumeId:r.volumeId,actor:i,presetName:o.name}))}async setVolumes(e,t=!1,n=!1){const r=s.Ay.getVolume(e[0].volumeId);if(!r)throw new Error(`imageVolume with id: ${r.volumeId} does not exist, you need to create/allocate the volume first`);const i=r.metadata.FrameOfReferenceUID;this._isValidVolumeInputArray(e,i),this._FrameOfReferenceUID=i,e.forEach((e=>{this._addVolumeId(e.volumeId)}));const o=[];for(let t=0;t<e.length;t++){const{volumeId:r,actorUID:i,slabThickness:a,...s}=e[t],l=await(0,b.A)(e[t],this.element,this.id,n),c=i||(0,O.A)();o.push({uid:c,actor:l,slabThickness:a,referencedId:r,...s})}this._setVolumeActors(o),this.viewportStatus=c.ViewportStatus.PRE_RENDER,this.initializeColorTransferFunction(e),(0,f.A)(this.element,c.Events.VOLUME_VIEWPORT_NEW_VOLUME,{viewportId:this.id,volumeActors:o}),t&&this.render()}async addVolumes(e,t=!1,n=!1){const r=s.Ay.getVolume(e[0].volumeId);if(!r)throw new Error(`imageVolume with id: ${r.volumeId} does not exist`);const i=[];this._isValidVolumeInputArray(e,this._FrameOfReferenceUID),e.forEach((e=>{this._addVolumeId(e.volumeId)}));for(let t=0;t<e.length;t++){const{volumeId:r,visibility:o,actorUID:a,slabThickness:s,...l}=e[t],c=await(0,b.A)(e[t],this.element,this.id,n);o||c.setVisibility(!1);const u=a||(0,O.A)();i.push({uid:u,actor:c,slabThickness:s,referencedId:r,...l})}this.addActors(i),this.initializeColorTransferFunction(e),t&&this.render()}removeVolumeActors(e,t=!1){this.removeActors(e),t&&this.render()}setOrientation(e,t=!0){console.warn('Method "setOrientation" needs implementation')}initializeColorTransferFunction(e){const t=e[0].volumeId,n=this._getOrCreateColorTransferFunction(t);!this.initialTransferFunctionNodes&&n&&(this.initialTransferFunctionNodes=(0,y.getTransferFunctionNodes)(n))}_getApplicableVolumeActor(e){const t=this.getActors();if(!t?.length)return;if(e){const n=t.find((t=>t.referencedId===e));if(!n)return;return{volumeActor:n.actor,volumeId:e,actorUID:n.uid}}const n=t[0];return{volumeActor:n.actor,volumeId:n.referencedId,actorUID:n.uid}}async _isValidVolumeInputArray(e,t){const n=e.length;for(let r=1;r<n;r++){if(t!==s.Ay.getVolume(e[r].volumeId).metadata.FrameOfReferenceUID)throw new Error(`Volumes being added to viewport ${this.id} do not share the same FrameOfReferenceUID. This is not yet supported`)}return!0}getBounds(){return this.getRenderer().computeVisiblePropBounds()}flip(e){super.flip(e)}hasVolumeId(e){return this.volumeIds.has(e)}hasVolumeURI(e){for(const t of this.volumeIds)if(t.includes(e))return!0;return!1}getImageData(e){if(!this.getDefaultActor())return;e||=this.getVolumeId();const t=this.getActors()?.find((t=>t.referencedId===e));if(!(0,S.N)(t,"vtkVolume"))return;const n=t.actor,r=s.Ay.getVolume(e),i=n.getMapper().getInputData();return{dimensions:i.getDimensions(),spacing:i.getSpacing(),origin:i.getOrigin(),direction:i.getDirection(),imageData:n.getMapper().getInputData(),metadata:{Modality:r?.metadata?.Modality,FrameOfReferenceUID:r?.metadata?.FrameOfReferenceUID},get scalarData(){return r?.voxelManager?.getScalarData()},scaling:r?.scaling,hasPixelSpacing:!0,voxelManager:r?.voxelManager}}setCameraClippingRange(){throw new Error("Method not implemented.")}getSliceIndex(){throw new Error("Method not implemented.")}setCamera(e,t){super.setCamera(e,t),this.setCameraClippingRange()}_setVolumeActors(e){for(let t=0;t<e.length;t++)this.viewportProperties.invert=!1;this.setActors(e)}_getOrientationVectors(e){if("object"==typeof e){if(e.viewPlaneNormal&&e.viewUp)return e;throw new Error("Invalid orientation object. It must contain viewPlaneNormal and viewUp")}if("string"==typeof e&&l.MPR_CAMERA_VALUES[e])return this.viewportProperties.orientation=e,l.MPR_CAMERA_VALUES[e];throw new Error(`Invalid orientation: ${e}. Valid orientations are: ${Object.keys(l.MPR_CAMERA_VALUES).join(", ")}`)}getSlabThickness(){const e=this.getActors();let t=l.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS;return e.forEach((e=>{e.slabThickness>t&&(t=e.slabThickness)})),t}getIntensityFromWorld(e){const t=this.getDefaultActor();if(!(0,S.N)(t,"vtkVolume"))return;const{actor:n}=t,r=n.getMapper().getInputData(),i=s.Ay.getVolume(this.getVolumeId()),o=(0,v.A)(r,e);return i.voxelManager.getAtIJKPoint(o)}getVolumeId(e){const t=this.getActors();if(!t)return;if(!e?.volumeId){const e=t.find((e=>"vtkVolume"===e.actor.getClassName()));return e?.referencedId||e?.uid}const n=t.find((t=>"vtkVolume"===t.actor.getClassName()&&t.referencedId===e?.volumeId));return n?.referencedId||n?.uid}getViewReferenceId(e={}){let{volumeId:t,sliceIndex:n}=e;if(!t){const e=this.getActors();if(!e)return;t=e.find((e=>"vtkVolume"===e.actor.getClassName()))?.referencedId}const r=this.getSliceIndex();n??=r;const{viewPlaneNormal:i,focalPoint:o}=this.getCamera(),a=t.includes("?")?"&":"?";return`volumeId:${t}${a}sliceIndex=${n}&viewPlaneNormal=${i.join(",")}`}_addVolumeId(e){this.volumeIds.add(e)}getAllVolumeIds(){return Array.from(this.volumeIds)}}const N=R},58165:(e,t,n)=>{"use strict";n.d(t,{A:()=>Te});var r=n(42008),i=n(58498),o=n(26719),a=n(33739),s=n(660),l=n(94520),c=n(28906),u=n(68076),d=n(16632);const p={slice:0,customDisplayExtent:[0,0,0,0,0,0],useCustomExtents:!1,backgroundColor:[0,0,0,1]};var f={extend:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,p,n),u.A.extend(e,t,n),c.m.setGet(e,t,["slice","useCustomExtents"]),c.m.setGetArray(e,t,["customDisplayExtent"],6),c.m.setGetArray(e,t,["backgroundColor"],4),function(e,t){t.classHierarchy.push("vtkAbstractImageMapper"),e.getIsOpaque=()=>!0,e.getCurrentImage=()=>null,e.getBoundsForSlice=()=>(c.m.vtkErrorMacro("vtkAbstractImageMapper.getBoundsForSlice - NOT IMPLEMENTED"),(0,d.H)())}(e,t)}},h=n(3823),m=n(75127);function g(e,t,n){const r=n.getCurrentImage(),i=r.getExtent(),o=[i[0],i[2],i[4]],{ijkMode:a}=n.getClosestIJKAxis();let s=n.isA("vtkImageArrayMapper")?n.getSubSlice():n.getSlice();a!==n.getSlicingMode()&&(s=n.getSliceAtPosition(s)),o[a]+=s;const l=[0,0,0];r.indexToWorld(o,l),o[a]+=1;const c=[0,0,0];r.indexToWorld(o,c),c[0]-=l[0],c[1]-=l[1],c[2]-=l[2],h.eR.normalize(c,c);const u=m.Ay.intersectWithLine(e,t,l,c);if(u.intersection){const e=u.x,t=[0,0,0];return r.worldToIndex(e,t),{t:u.t,absoluteIJK:t}}return null}var v=n(57285);const{staticOffsetAPI:y,otherStaticMethods:b}=v.Ay,{SlicingMode:x}=l.A;function A(e,t){function n(){let n;switch(t.slicingMode){case x.X:n=0;break;case x.Y:n=1;break;case x.Z:n=2;break;default:return void(t.closestIJKAxis={ijkMode:t.slicingMode,flip:!1})}const r=e.getCurrentImage().getDirection(),i=(0,d.T)(r);let o=0;for(;o<3&&0===i[n+3*o];++o);const a=i[n+3*o]<0;t.closestIJKAxis={ijkMode:o,flip:a}}t.classHierarchy.push("vtkImageMapper"),e.getSliceAtPosition=n=>{const r=e.getCurrentImage();let i;if(3===n.length)i=n;else if(Number.isFinite(n)){const e=r.getBounds();switch(t.slicingMode){case x.X:i=[n,(e[3]+e[2])/2,(e[5]+e[4])/2];break;case x.Y:i=[(e[1]+e[0])/2,n,(e[5]+e[4])/2];break;case x.Z:i=[(e[1]+e[0])/2,(e[3]+e[2])/2,n]}}const o=[0,0,0];r.worldToIndex(i,o);const a=r.getExtent(),{ijkMode:s}=e.getClosestIJKAxis();let l=0;switch(s){case x.I:l=(0,d.E)(o[0],a[0],a[1]);break;case x.J:l=(0,d.E)(o[1],a[2],a[3]);break;case x.K:l=(0,d.E)(o[2],a[4],a[5]);break;default:return 0}return l},e.setSliceFromCamera=n=>{const r=n.getFocalPoint();switch(t.slicingMode){case x.I:case x.J:case x.K:{const t=e.getSliceAtPosition(r);e.setSlice(t)}break;case x.X:e.setSlice(r[0]);break;case x.Y:e.setSlice(r[1]);break;case x.Z:e.setSlice(r[2])}},e.setXSlice=t=>{e.setSlicingMode(x.X),e.setSlice(t)},e.setYSlice=t=>{e.setSlicingMode(x.Y),e.setSlice(t)},e.setZSlice=t=>{e.setSlicingMode(x.Z),e.setSlice(t)},e.setISlice=t=>{e.setSlicingMode(x.I),e.setSlice(t)},e.setJSlice=t=>{e.setSlicingMode(x.J),e.setSlice(t)},e.setKSlice=t=>{e.setSlicingMode(x.K),e.setSlice(t)},e.getSlicingModeNormal=()=>{const n=[0,0,0],r=e.getCurrentImage().getDirection();switch(t.slicingMode){case x.X:n[0]=1;break;case x.Y:n[1]=1;break;case x.Z:n[2]=1;break;case x.I:(0,d.S)(r,[1,0,0],n);break;case x.J:(0,d.S)(r,[0,1,0],n);break;case x.K:(0,d.S)(r,[0,0,1],n)}return n},e.setSlicingMode=r=>{t.slicingMode!==r&&(t.slicingMode=r,e.getCurrentImage()&&n(),e.modified())},e.getClosestIJKAxis=()=>(void 0!==t.closestIJKAxis&&t.closestIJKAxis.ijkMode!==x.NONE||!e.getCurrentImage()||n(),t.closestIJKAxis),e.getBounds=()=>{const n=e.getCurrentImage();if(!n)return(0,d.H)();if(!t.useCustomExtents)return n.getBounds();const r=t.customDisplayExtent.slice(),{ijkMode:i}=e.getClosestIJKAxis();let o=t.slice;switch(i!==t.slicingMode&&(o=e.getSliceAtPosition(t.slice)),i){case x.I:r[0]=o,r[1]=o;break;case x.J:r[2]=o,r[3]=o;break;case x.K:r[4]=o,r[5]=o}return n.extentToBounds(r)},e.getBoundsForSlice=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.slice,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=e.getCurrentImage();if(!i)return(0,d.H)();const o=i.getSpatialExtent(),{ijkMode:a}=e.getClosestIJKAxis();let s=n;switch(a!==t.slicingMode&&(s=e.getSliceAtPosition(n)),a){case x.I:o[0]=s-r,o[1]=s+r;break;case x.J:o[2]=s-r,o[3]=s+r;break;case x.K:o[4]=s-r,o[5]=s+r}return i.extentToBounds(o)},e.intersectWithLineForPointPicking=(t,n)=>function(e,t,n){const r=g(e,t,n);if(r){const e=n.getCurrentImage().getExtent(),t=[Math.round(r.absoluteIJK[0]),Math.round(r.absoluteIJK[1]),Math.round(r.absoluteIJK[2])];return t[0]<e[0]||t[0]>e[1]||t[1]<e[2]||t[1]>e[3]||t[2]<e[4]||t[2]>e[5]?null:{t:r.t,ijk:t}}return null}(t,n,e),e.intersectWithLineForCellPicking=(t,n)=>function(e,t,n){const r=g(e,t,n);if(r){const e=n.getCurrentImage().getExtent(),t=r.absoluteIJK,i=[Math.floor(t[0]),Math.floor(t[1]),Math.floor(t[2])];if(i[0]<e[0]||i[0]>e[1]-1||i[1]<e[2]||i[1]>e[3]-1||i[2]<e[4]||i[2]>(e[5]?e[5]-1:e[5]))return null;const o=[t[0]-i[0],t[1]-i[1],t[2]-i[2]];return{t:r.t,ijk:i,pCoords:o}}return null}(t,n,e),e.getCurrentImage=()=>e.getInputData()}const C={slicingMode:x.NONE,closestIJKAxis:{ijkMode:x.NONE,flip:!1},renderToRectangle:!1,sliceAtFocalPoint:!1,preferSizeOverAccuracy:!1};function T(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,C,n),f.extend(e,t,n),c.m.get(e,t,["slicingMode"]),c.m.setGet(e,t,["closestIJKAxis","renderToRectangle","sliceAtFocalPoint","preferSizeOverAccuracy"]),v.Ay.implementCoincidentTopologyMethods(e,t),A(e,t)}var S={newInstance:c.m.newInstance(T,"vtkImageMapper"),extend:T,...y,...b,...l.A},w=n(21734),_=n(62502),I=n(91732);const{InterpolationType:E}=I.A,{vtkErrorMacro:D}=c.m,O=4;const P={independentComponents:!1,interpolationType:E.LINEAR,colorWindow:255,colorLevel:127.5,ambient:1,diffuse:0,opacity:1,useLookupTableScalarRange:!1,useLabelOutline:!1,labelOutlineThickness:[1],labelOutlineOpacity:1};function R(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Object.assign(t,P,n),c.m.obj(e,t),!t.componentData){t.componentData=[];for(let e=0;e<O;e++)t.componentData.push({rGBTransferFunction:null,piecewiseFunction:null,componentWeight:1})}c.m.setGet(e,t,["independentComponents","interpolationType","colorWindow","colorLevel","ambient","diffuse","opacity","useLookupTableScalarRange","useLabelOutline","labelOutlineOpacity"]),c.m.setGetArray(e,t,["labelOutlineThickness"]),function(e,t){t.classHierarchy.push("vtkImageProperty"),e.getMTime=()=>{let e,n=t.mtime;for(let r=0;r<O;r++)t.componentData[r].rGBTransferFunction&&(e=t.componentData[r].rGBTransferFunction.getMTime(),n=n>e?n:e),t.componentData[r].piecewiseFunction&&(e=t.componentData[r].piecewiseFunction.getMTime(),n=n>e?n:e);return n},e.setRGBTransferFunction=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Number.isInteger(n)||(i=n,r=0),t.componentData[r].rGBTransferFunction!==i&&(t.componentData[r].rGBTransferFunction=i,e.modified(),!0)},e.getRGBTransferFunction=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.componentData[e].rGBTransferFunction},e.setPiecewiseFunction=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Number.isInteger(n)||(i=n,r=0),t.componentData[r].piecewiseFunction!==i&&(t.componentData[r].piecewiseFunction=i,e.modified(),!0)},e.getPiecewiseFunction=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.componentData[e].piecewiseFunction},e.setScalarOpacity=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Number.isInteger(t)||(r=t,n=0),e.setPiecewiseFunction(n,r)},e.getScalarOpacity=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e.getPiecewiseFunction(t)},e.setComponentWeight=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(n<0||n>=O)return D("Invalid index"),!1;const i=Math.min(1,Math.max(0,r));return t.componentData[n].componentWeight!==i&&(t.componentData[n].componentWeight=i,e.modified(),!0)},e.getComponentWeight=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e<0||e>=O?(D("Invalid index"),0):t.componentData[e].componentWeight},e.setInterpolationTypeToNearest=()=>e.setInterpolationType(E.NEAREST),e.setInterpolationTypeToLinear=()=>e.setInterpolationType(E.LINEAR),e.getInterpolationTypeAsString=()=>c.m.enumToString(E,t.interpolationType)}(e,t)}var N={newInstance:c.m.newInstance(R,"vtkImageProperty"),extend:R};const{vtkDebugMacro:M}=c.m;const L={mapper:null,property:null,forceOpaque:!1,forceTranslucent:!1,bounds:[...w.Ay.INIT_BOUNDS]};function F(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,L,n),_.Ay.extend(e,t,n),t.boundsMTime={},c.m.obj(t.boundsMTime),c.m.set(e,t,["property"]),c.m.setGet(e,t,["mapper","forceOpaque","forceTranslucent"]),c.m.getArray(e,t,["bounds"],6),function(e,t){t.classHierarchy.push("vtkImageSlice"),e.getActors=()=>e,e.getImages=()=>e,e.getIsOpaque=()=>{if(t.forceOpaque)return!0;if(t.forceTranslucent)return!1;t.property||e.getProperty();let n=t.property.getOpacity()>=1;return n=n&&(!t.mapper||t.mapper.getIsOpaque()),n},e.hasTranslucentPolygonalGeometry=()=>!1,e.makeProperty=N.newInstance,e.getProperty=()=>(null===t.property&&(t.property=e.makeProperty()),t.property),e.getBounds=()=>{if(null===t.mapper)return t.bounds;const n=t.mapper.getBounds();if(!n||6!==n.length)return n;if(n[0]>n[1])return t.mapperBounds=n.concat(),t.bounds=[1,-1,1,-1,1,-1],t.boundsMTime.modified(),n;if(!t.mapperBounds||!(r=[n,t.mapperBounds],r[0].map(((e,t)=>r.map((e=>e[t]))))).reduce(((e,t)=>e&&t[0]===t[1]),!0)||e.getMTime()>t.boundsMTime.getMTime()){M("Recomputing bounds..."),t.mapperBounds=n.map((e=>e)),e.computeMatrix();const r=new Float64Array(16);h.pB.transpose(r,t.matrix),w.Ay.transformBounds(n,r,t.bounds),t.boundsMTime.modified()}var r;return t.bounds},e.getBoundsForSlice=(n,r)=>{const i=t.mapper.getBoundsForSlice(n,r);if(!w.Ay.isValid(i))return i;e.computeMatrix();const o=new Float64Array(16);return h.pB.transpose(o,t.matrix),w.Ay.transformBounds(i,o)},e.getMinXBound=()=>e.getBounds()[0],e.getMaxXBound=()=>e.getBounds()[1],e.getMinYBound=()=>e.getBounds()[2],e.getMaxYBound=()=>e.getBounds()[3],e.getMinZBound=()=>e.getBounds()[4],e.getMaxZBound=()=>e.getBounds()[5],e.getMTime=()=>{let e=t.mtime;if(null!==t.property){const n=t.property.getMTime();e=n>e?n:e}return e},e.getRedrawMTime=()=>{let e=t.mtime;if(null!==t.mapper){let n=t.mapper.getMTime();e=n>e?n:e,null!==t.mapper.getInput()&&(t.mapper.getInputAlgorithm().update(),n=t.mapper.getInput().getMTime(),e=n>e?n:e)}if(null!==t.property){let n=t.property.getMTime();e=n>e?n:e,null!==t.property.getRGBTransferFunction()&&(n=t.property.getRGBTransferFunction().getMTime(),e=n>e?n:e)}return e},e.getSupportsSelection=()=>!!t.mapper&&t.mapper.getSupportsSelection()}(e,t)}var B={newInstance:c.m.newInstance(F,"vtkImageSlice"),extend:F},V=n(10364),k=n(74876),U=n(53932),G=n(7608),z=n(98039),W=n(13859),j=n(85745),H=n(68136),K=n(74657),q=n(40256),$=n(45278),X=n(69372),Y=n(74638),J=n(50134),Z=n(17791),Q=n(39537),ee=n(10056),te=n(5057),ne=n(89131),re=n(71851),ie=n(80068),oe=n(51159),ae=n(7808);function se(e){return(0,ae.A)(e)}function le(e,t){const n=se(e);return n.invert(),n.transformPoint(t)}var ce=n(36931);function ue(e,t){return se(e).transformPoint(t)}var de=n(57162);var pe=n(62596);function fe(e,t=!1){const n=e.canvas.width,r=e.canvas.height;!function(e){const{canvas:t}=e,{clientWidth:n,clientHeight:r}=t;t.width===n&&t.height===r||(t.width=n,t.height=r)}(e),void 0!==e.image&&(t||function(e,t,n){const r=e.viewport.scale,i=(0,pe.A)(e.image,e.viewport.rotation),o=Math.round(i.width*r),a=Math.round(i.height*r),s=e.viewport.translation.x,l=e.viewport.translation.y;return o===t&&a<=n||o<=t&&a===n&&0===s&&0===l}(e,n,r)?function(e){const{image:t}=e;e.viewport.scale=(0,de.A)(e.canvas,t,e.viewport.rotation).scaleFactor,e.viewport.translation.x=0,e.viewport.translation.y=0}(e):function(e,t,n){const r=e.viewport.scale,i=e.canvas.width/t,o=e.canvas.height/n,a=Math.sqrt(i*o);e.viewport.scale=a*r}(e,n,r))}var he=n(49038),me=n(26896),ge=n(36822);var ve=n(45354),ye=n(80221),be=n(85008),xe=n(88619);const Ae=G.coreLog.getLogger("RenderingEngine","StackViewport");class Ce extends ee.A{constructor(e){super(e),this.imageIds=[],this.imageKeyToIndexMap=new Map,this.currentImageIdIndex=0,this.targetImageIdIndex=0,this.imagesLoader=this,this.globalDefaultProperties={},this.perImageIdDefaultProperties=new Map,this.voiUpdatedWithSetProperties=!1,this.invert=!1,this.initialInvert=!1,this.initialTransferFunctionNodes=null,this.stackInvalidated=!1,this._publishCalibratedEvent=!1,this.updateRenderingPipeline=()=>{this._configureRenderingPipeline()},this.resize=()=>{this.useCPURendering&&this._resizeCPU()},this._resizeCPU=()=>{this._cpuFallbackEnabledElement.viewport&&fe(this._cpuFallbackEnabledElement)},this.getFrameOfReferenceUID=e=>this.getImagePlaneReferenceData(e)?.FrameOfReferenceUID,this.getCornerstoneImage=()=>this.csImage,this.createActorMapper=e=>{const t=S.newInstance();t.setInputData(e);const n=B.newInstance();n.setMapper(t);const{preferSizeOverAccuracy:r}=(0,me.D0)().rendering;return r&&t.setPreferSizeOverAccuracy(!0),e.getPointData().getScalars().getNumberOfComponents()>1&&n.getProperty().setIndependentComponents(!1),n},this.getNumberOfSlices=()=>this.imageIds.length,this.getDefaultProperties=e=>{let t;return void 0!==e&&(t=this.perImageIdDefaultProperties.get(e)),void 0!==t?t:{...this.globalDefaultProperties}},this.getProperties=()=>{const{colormap:e,voiRange:t,VOILUTFunction:n,interpolationType:r,invert:i,voiUpdatedWithSetProperties:o}=this;return{colormap:e,voiRange:t,VOILUTFunction:n,interpolationType:r,invert:i,isComputedVOI:!o}},this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,suppressEvents:!0}),this.getRotationCPU=()=>{const{viewport:e}=this._cpuFallbackEnabledElement;return e.rotation},this.getRotationGPU=()=>{const{viewUp:e,viewPlaneNormal:t,flipVertical:n}=this.getCameraNoRotation(),r=n?h.eR.negate(h.eR.create(),this.initialViewUp):this.initialViewUp,i=180*h.eR.angle(r,e)/Math.PI,o=h.eR.cross(h.eR.create(),r,e);return h.eR.dot(o,t)>=0?i:(360-i)%360},this.setRotation=e=>{const t=this.getCamera();if(this.useCPURendering?this.setRotationCPU(e):this.setRotationGPU(e),this._suppressCameraModifiedEvents)return;const n={previousCamera:t,camera:this.getCamera(),element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};(0,X.A)(this.element,re.Events.CAMERA_MODIFIED,n)},this.renderImageObject=e=>{this._setCSImage(e);(this.useCPURendering?this._updateToDisplayImageCPU:this._updateActorToDisplayImageId).call(this,e)},this._setCSImage=e=>{e.isPreScaled=e.preScale?.scaled,this.csImage=e},this.canvasToWorldCPU=(e,t=[0,0,0])=>{if(!this._cpuFallbackEnabledElement.image)return;const[n,r]=le(this._cpuFallbackEnabledElement,e),{origin:i,spacing:o,direction:a}=this.getImageData(),s=a.slice(0,3),l=a.slice(3,6);return h.eR.scaleAndAdd(t,i,s,n*o[0]),h.eR.scaleAndAdd(t,t,l,r*o[1]),t},this.worldToCanvasCPU=e=>{const{spacing:t,direction:n,origin:r}=this.getImageData(),i=n.slice(0,3),o=n.slice(3,6),a=h.eR.subtract(h.eR.create(),e,r),s=[h.eR.dot(a,i)/t[0],h.eR.dot(a,o)/t[1]];return ue(this._cpuFallbackEnabledElement,s)},this.canvasToWorldGPU=e=>{const t=this.getRenderer(),n=this.getVtkActiveCamera(),r=n.getClippingRange(),i=n.getDistance();n.setClippingRange(i,i+.1);const o=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),a=o.getSize(),s=window.devicePixelRatio||1,l=[e[0]*s,e[1]*s],c=[l[0]+this.sx,l[1]+this.sy];c[1]=a[1]-c[1];const u=o.displayToWorld(c[0],c[1],0,t);return n.setClippingRange(r[0],r[1]),[u[0],u[1],u[2]]},this.worldToCanvasGPU=e=>{const t=this.getRenderer(),n=this.getVtkActiveCamera(),r=n.getClippingRange(),i=n.getDistance();n.setClippingRange(i,i+.1);const o=this.getRenderingEngine().offscreenMultiRenderWindow.getOpenGLRenderWindow(),a=o.getSize(),s=o.worldToDisplay(...e,t);s[1]=a[1]-s[1];const l=[s[0]-this.sx,s[1]-this.sy];n.setClippingRange(r[0],r[1]);const c=window.devicePixelRatio||1;return[l[0]/c,l[1]/c]},this.getCurrentImageIdIndex=()=>this.currentImageIdIndex,this.getSliceIndex=()=>this.currentImageIdIndex,this.getTargetImageIdIndex=()=>this.targetImageIdIndex,this.getImageIds=()=>this.imageIds,this.getCurrentImageId=(e=this.getCurrentImageIdIndex())=>this.imageIds[e],this.hasImageId=e=>this.imageKeyToIndexMap.has(e),this.hasImageURI=e=>this.imageKeyToIndexMap.has(e),this.customRenderViewportToCanvas=()=>{if(!this.useCPURendering)throw new Error("Custom cpu rendering pipeline should only be hit in CPU rendering mode");return this._cpuFallbackEnabledElement.image?((0,te.A)(this._cpuFallbackEnabledElement,this.cpuRenderingInvalidated),this.cpuRenderingInvalidated=!1):this.fillWithBackgroundColor(),{canvas:this.canvas,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId,viewportStatus:this.viewportStatus}},this.renderingPipelineFunctions={getImageData:{cpu:this.getImageDataCPU,gpu:this.getImageDataGPU},setColormap:{cpu:this.setColormapCPU,gpu:this.setColormapGPU},getCamera:{cpu:this.getCameraCPU,gpu:super.getCamera},setCamera:{cpu:this.setCameraCPU,gpu:super.setCamera},getPan:{cpu:this.getPanCPU,gpu:super.getPan},setPan:{cpu:this.setPanCPU,gpu:super.setPan},getZoom:{cpu:this.getZoomCPU,gpu:super.getZoom},setZoom:{cpu:this.setZoomCPU,gpu:super.setZoom},setVOI:{cpu:this.setVOICPU,gpu:this.setVOIGPU},getRotation:{cpu:this.getRotationCPU,gpu:this.getRotationGPU},setInterpolationType:{cpu:this.setInterpolationTypeCPU,gpu:this.setInterpolationTypeGPU},setInvertColor:{cpu:this.setInvertColorCPU,gpu:this.setInvertColorGPU},resetCamera:{cpu:(e={})=>{const{resetPan:t=!0,resetZoom:n=!0}=e;return this.resetCameraCPU({resetPan:t,resetZoom:n}),!0},gpu:(e={})=>{const{resetPan:t=!0,resetZoom:n=!0}=e;return this.resetCameraGPU({resetPan:t,resetZoom:n}),!0}},canvasToWorld:{cpu:this.canvasToWorldCPU,gpu:this.canvasToWorldGPU},worldToCanvas:{cpu:this.worldToCanvasCPU,gpu:this.worldToCanvasGPU},getRenderer:{cpu:()=>this.getCPUFallbackError("getRenderer"),gpu:super.getRenderer},getDefaultActor:{cpu:()=>this.getCPUFallbackError("getDefaultActor"),gpu:super.getDefaultActor},getActors:{cpu:()=>this.getCPUFallbackError("getActors"),gpu:super.getActors},getActor:{cpu:()=>this.getCPUFallbackError("getActor"),gpu:super.getActor},setActors:{cpu:()=>this.getCPUFallbackError("setActors"),gpu:super.setActors},addActors:{cpu:()=>this.getCPUFallbackError("addActors"),gpu:super.addActors},addActor:{cpu:()=>this.getCPUFallbackError("addActor"),gpu:super.addActor},removeAllActors:{cpu:()=>this.getCPUFallbackError("removeAllActors"),gpu:super.removeAllActors},unsetColormap:{cpu:this.unsetColormapCPU,gpu:this.unsetColormapGPU}},this.scaling={},this.modality=null,this.useCPURendering=(0,me.LH)(),this._configureRenderingPipeline();this.useCPURendering?this._resetCPUFallbackElement():this._resetGPUViewport();this.currentImageIdIndex=0,this.targetImageIdIndex=0,this.resetCamera(),this.initializeElementDisabledHandler()}setUseCPURendering(e){this.useCPURendering=e,this._configureRenderingPipeline(e)}static get useCustomRenderingPipeline(){return(0,me.LH)()}_configureRenderingPipeline(e){this.useCPURendering=e??(0,me.LH)();for(const e in this.renderingPipelineFunctions)if(Object.prototype.hasOwnProperty.call(this.renderingPipelineFunctions,e)){const t=this.renderingPipelineFunctions[e];this[e]=this.useCPURendering?t.cpu:t.gpu}this.useCPURendering?this._resetCPUFallbackElement():this._resetGPUViewport()}_resetCPUFallbackElement(){this._cpuFallbackEnabledElement={canvas:this.canvas,renderingTools:{},transform:new ve.d,viewport:{rotation:0}}}_resetGPUViewport(){const e=this.getRenderer(),t=o.Ay.newInstance();e.setActiveCamera(t);const n=[0,0,-1];this.initialViewUp=[0,-1,0],t.setDirectionOfProjection(-n[0],-n[1],-n[2]),t.setViewUp(...this.initialViewUp),t.setParallelProjection(!0),t.setThicknessFromFocalPoint(.1),t.setFreezeFocalPoint(!0)}initializeElementDisabledHandler(){V.A.addEventListener(re.Events.ELEMENT_DISABLED,(function e(){clearTimeout(this.debouncedTimeout),V.A.removeEventListener(re.Events.ELEMENT_DISABLED,e)}))}getImageDataGPU(){const e=this.getDefaultActor();if(!e)return;if(!(0,z.e)(e))return;const{actor:t}=e,n=t.getMapper().getInputData(),r=this.csImage;return{dimensions:n.getDimensions(),spacing:n.getSpacing(),origin:n.getOrigin(),direction:n.getDirection(),get scalarData(){return r?.voxelManager.getScalarData()},imageData:t.getMapper().getInputData(),metadata:{Modality:this.modality,FrameOfReferenceUID:this.getFrameOfReferenceUID()},scaling:this.scaling,hasPixelSpacing:this.hasPixelSpacing,calibration:{...r?.calibration,...this.calibration},preScale:{...r?.preScale},voxelManager:r?.voxelManager}}getImageDataCPU(){const{metadata:e}=this._cpuFallbackEnabledElement;if(!e)return;const t=e.spacing,n=this.csImage;return{dimensions:e.dimensions,spacing:t,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:this.getFrameOfReferenceUID()},scaling:this.scaling,imageData:{getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getScalarData:()=>this.cpuImagePixelData,getSpacing:()=>t,worldToIndex:e=>{const t=this.worldToCanvasCPU(e),n=le(this._cpuFallbackEnabledElement,t);return[n[0],n[1],0]},indexToWorld:(e,t)=>{const n=ue(this._cpuFallbackEnabledElement,[e[0],e[1]]);return this.canvasToWorldCPU(n,t)}},scalarData:this.cpuImagePixelData,hasPixelSpacing:this.hasPixelSpacing,calibration:{...n?.calibration,...this.calibration},preScale:{...n?.preScale},voxelManager:n?.voxelManager}}calibrateIfNecessary(e,t){const n=k.get("calibratedPixelSpacing",e),r=this.calibration!==n,{scale:i}=n||{};return this.hasPixelSpacing=i>0||t.rowPixelSpacing>0,t.calibration=n,r?(this.calibration=n,this._publishCalibratedEvent=!0,this._calibrationEvent={scale:i,calibration:n},t):t}setDefaultProperties(e,t){null==t?this.globalDefaultProperties=e:(this.perImageIdDefaultProperties.set(t,e),this.getCurrentImageId()===t&&this.setProperties(e))}clearDefaultProperties(e){null==e?(this.globalDefaultProperties={},this.resetProperties()):(this.perImageIdDefaultProperties.delete(e),this.resetToDefaultProperties())}setProperties({colormap:e,voiRange:t,VOILUTFunction:n,invert:r,interpolationType:i}={},o=!1){if(this.viewportStatus=this.csImage?re.ViewportStatus.PRE_RENDER:re.ViewportStatus.LOADING,this.globalDefaultProperties={colormap:this.globalDefaultProperties.colormap??e,voiRange:this.globalDefaultProperties.voiRange??t,VOILUTFunction:this.globalDefaultProperties.VOILUTFunction??n,invert:this.globalDefaultProperties.invert??r,interpolationType:this.globalDefaultProperties.interpolationType??i},void 0!==e&&this.setColormap(e),void 0!==t){const e=!0;this.setVOI(t,{suppressEvents:o,voiUpdatedWithSetProperties:e})}void 0!==n&&this.setVOILUTFunction(n,o),void 0!==r&&this.setInvertColor(r),void 0!==i&&this.setInterpolationType(i)}resetProperties(){this.cpuRenderingInvalidated=!0,this.voiUpdatedWithSetProperties=!1,this.viewportStatus=re.ViewportStatus.PRE_RENDER,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={}),this._resetProperties(),this.render()}_resetProperties(){let e;if(e=this._isCurrentImagePTPrescaled()?this._getDefaultPTPrescaledVOIRange():this._getVOIRangeForCurrentImage(),this.setVOI(e),this.setInvertColor(this.initialInvert),this.setInterpolationType(re.InterpolationType.LINEAR),!this.useCPURendering){const e=this.getTransferFunction();(0,j.setTransferFunctionNodes)(e,this.initialTransferFunctionNodes);const t=(0,j.getTransferFunctionNodes)(e).reduce(((e,t)=>(e.push(t[0],t[1],t[2],t[3]),e)),[]),n=this.getDefaultActor(),r=W.findMatchingColormap(t,n.actor);this.setColormap(r)}}resetToDefaultProperties(){this.cpuRenderingInvalidated=!0,this.viewportStatus=re.ViewportStatus.PRE_RENDER,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={});const e=this.getCurrentImageId(),t=this.perImageIdDefaultProperties.get(e)||this.globalDefaultProperties;let n;t.colormap?.name&&this.setColormap(t.colormap),n=null==t.voiRange?this._getVOIRangeForCurrentImage():t.voiRange,this.setVOI(n),this.setInterpolationType(re.InterpolationType.LINEAR),this.setInvertColor(!1),this.render()}_getVOIFromCache(){let e;return e=this.voiUpdatedWithSetProperties?this.voiRange:this._isCurrentImagePTPrescaled()?this._getDefaultPTPrescaledVOIRange():this._getVOIRangeForCurrentImage()??this.voiRange,e}_setPropertiesFromCache(){const e=this._getVOIFromCache(),{interpolationType:t,invert:n}=this;this.setVOI(e),this.setInterpolationType(t),this.setInvertColor(n)}getCameraCPU(){const{metadata:e,viewport:t}=this._cpuFallbackEnabledElement;if(!e)return{};const{direction:n}=e,r=n.slice(6,9).map((e=>-e));let i=n.slice(3,6).map((e=>-e));if(t.rotation){const e=h.pB.fromRotation(h.pB.create(),t.rotation*Math.PI/180,r);i=h.eR.transformMat4(h.eR.create(),i,e)}const o=[this.element.clientWidth/2,this.element.clientHeight/2],a=this.canvasToWorld(o),s=this.canvasToWorld([0,0]),l=this.canvasToWorld([0,this.element.clientHeight]);return{parallelProjection:!0,focalPoint:a,position:[0,0,0],parallelScale:h.eR.distance(s,l)/2,scale:t.scale,viewPlaneNormal:[r[0],r[1],r[2]],viewUp:[i[0],i[1],i[2]],flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}}setCameraCPU(e){const{viewport:t,image:n}=this._cpuFallbackEnabledElement,r=this.getCameraCPU(),{focalPoint:i,parallelScale:o,scale:a,flipHorizontal:s,flipVertical:l}=e,{clientHeight:c}=this.element;if(i){const e=this.worldToCanvasCPU(i),n=le(this._cpuFallbackEnabledElement,e),o=this.worldToCanvasCPU(r.focalPoint),a=le(this._cpuFallbackEnabledElement,o),s=h.Zc.create();h.Zc.subtract(s,h.Zc.fromValues(n[0],n[1]),h.Zc.fromValues(a[0],a[1]));const l=function(e,t){const{hflip:n,vflip:r,rotation:i}=t;if(e.x*=n?-1:1,e.y*=r?-1:1,0!==i){const t=i*Math.PI/180,n=Math.cos(t),r=Math.sin(t),o=e.x*n-e.y*r,a=e.x*r+e.y*n;e.x=o,e.y=a}return e}({x:s[0],y:s[1]},t);t.translation.x-=l.x,t.translation.y-=l.y}if(o){const{rowPixelSpacing:e}=n,r=c*e*.5/o;t.scale=r,t.parallelScale=o}if(a){const{rowPixelSpacing:e}=n;t.scale=a,t.parallelScale=c*e*.5/a}void 0===s&&void 0===l||this.setFlipCPU({flipHorizontal:s,flipVertical:l}),this._cpuFallbackEnabledElement.transform=(0,ae.A)(this._cpuFallbackEnabledElement);const u={previousCamera:r,camera:this.getCamera(),element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};(0,X.A)(this.element,re.Events.CAMERA_MODIFIED,u)}getPanCPU(){const{viewport:e}=this._cpuFallbackEnabledElement;return[e.translation.x,e.translation.y]}setPanCPU(e){const t=this.getCameraCPU();this.setCameraCPU({...t,focalPoint:[...e.map((e=>-e)),0]})}getZoomCPU(){const{viewport:e}=this._cpuFallbackEnabledElement;return e.scale}setZoomCPU(e){const t=this.getCameraCPU();this.setCameraCPU({...t,scale:e})}setFlipCPU({flipHorizontal:e,flipVertical:t}){const{viewport:n}=this._cpuFallbackEnabledElement;void 0!==e&&(n.hflip=e,this.flipHorizontal=n.hflip),void 0!==t&&(n.vflip=t,this.flipVertical=n.vflip)}setVOILUTFunction(e,t){if(this.useCPURendering)throw new Error("VOI LUT function is not supported in CPU rendering");const n=this._getValidVOILUTFunction(e);let r=!1;this.VOILUTFunction!==n&&(r=!0),this.VOILUTFunction=n;const{voiRange:i}=this.getProperties();this.setVOI(i,{suppressEvents:t,forceRecreateLUTFunction:r})}setRotationCPU(e){const{viewport:t}=this._cpuFallbackEnabledElement;t.rotation=e}setRotationGPU(e){const t=this.getPan(this.fitToCanvasCamera),n=this.getPan(),r=h.Zc.sub([0,0],t,n);this.setPan(r,!1);const{flipVertical:i}=this.getCamera(),o=i?h.eR.negate(h.eR.create(),this.initialViewUp):this.initialViewUp;this.setCameraNoEvent({viewUp:o}),this.getVtkActiveCamera().roll(-e);const a=this.getPan(),s=this.getPan(this.fitToCanvasCamera),l=h.Zc.sub([0,0],a,s),c=h.Zc.add([0,0],t,l);this.setPan(c,!1)}setInterpolationTypeGPU(e){const t=this.getDefaultActor();if(!t)return;if(!(0,z.e)(t))return;const{actor:n}=t;n.getProperty().setInterpolationType(e),this.interpolationType=e}setInterpolationTypeCPU(e){const{viewport:t}=this._cpuFallbackEnabledElement;t.pixelReplication=e!==re.InterpolationType.LINEAR,this.interpolationType=e}setInvertColorCPU(e){const{viewport:t}=this._cpuFallbackEnabledElement;t&&(t.invert=e,this.invert=e)}setInvertColorGPU(e){const t=this.getDefaultActor();if(t&&(0,z.e)(t))if((0,z.N)(t,"vtkVolume")){const n=t.actor.getProperty().getRGBTransferFunction(0);(!this.invert&&e||this.invert&&!e)&&(0,J.A)(n),this.invert=e}else if((0,z.N)(t,"vtkImageSlice")){const n=t.actor.getProperty().getRGBTransferFunction(0);(!this.invert&&e||this.invert&&!e)&&(0,J.A)(n),this.invert=e}}setVOICPU(e,t={}){const{suppressEvents:n=!1}=t,{viewport:r,image:i}=this._cpuFallbackEnabledElement;if(!r||!i)return;if(void 0===e){const{windowWidth:t,windowCenter:n}=i,o=Array.isArray(t)?t[0]:t,a=Array.isArray(n)?n[0]:n;r.voi={windowWidth:o,windowCenter:a,voiLUTFunction:i.voiLUTFunction};const{lower:s,upper:l}=H.toLowHighRange(o,a,i.voiLUTFunction);e={lower:s,upper:l}}else{const{lower:t,upper:n}=e,{windowCenter:o,windowWidth:a}=H.toWindowLevel(t,n);r.voi||(r.voi={windowWidth:0,windowCenter:0,voiLUTFunction:i.voiLUTFunction}),r.voi.windowWidth=a,r.voi.windowCenter=o}this.voiRange=e;const o={viewportId:this.id,range:e};n||(0,X.A)(this.element,re.Events.VOI_MODIFIED,o)}getTransferFunction(){const e=this.getDefaultActor();if(!e)return;if(!(0,z.e)(e))return;return e.actor.getProperty().getRGBTransferFunction(0)}setVOIGPU(e,t={}){const{suppressEvents:n=!1,forceRecreateLUTFunction:r=!1,voiUpdatedWithSetProperties:i=!1}=t;if(e&&this.voiRange&&this.voiRange.lower===e.lower&&this.voiRange.upper===e.upper&&!r&&!this.stackInvalidated)return;const o=this.getDefaultActor();if(!o)return;if(!(0,z.e)(o))return;const a=o.actor;let s=e;if(void 0===s){const e=a.getMapper().getInputData().getPointData().getScalars().getRange();s={lower:e[0],upper:e[1]}}a.getProperty().setUseLookupTableScalarRange(!0);let l=a.getProperty().getRGBTransferFunction(0);const c=this.VOILUTFunction===re.VOILUTFunctionType.SAMPLED_SIGMOID;if(c||!l||r){l=(c?q.A:K.A)(s),this.invert&&(0,J.A)(l),a.getProperty().setRGBTransferFunction(0,l),this.initialTransferFunctionNodes=(0,j.getTransferFunctionNodes)(l)}if(c||l.setRange(s.lower,s.upper),this.voiRange=s,this.voiUpdatedWithSetProperties||(this.voiUpdatedWithSetProperties=i),n)return;const u={viewportId:this.id,range:s,VOILUTFunction:this.VOILUTFunction};(0,X.A)(this.element,re.Events.VOI_MODIFIED,u)}_addScalingToViewport(e){if(this.scaling.PT)return;const{suvbw:t,suvlbm:n,suvbsa:r}=e,i={};n&&(i.suvbwToSuvlbm=n/t),r&&(i.suvbwToSuvbsa=r/t),this.scaling.PT=i}getImageDataMetadata(e){const t=e.imageId,n=(0,U.T)(e),{numberOfComponents:r,origin:i,direction:o,dimensions:a,spacing:s,numVoxels:l,imagePixelModule:c,voiLUTFunction:u,modality:d,scalingFactor:p,calibration:f}=n;"PT"===d&&p&&this._addScalingToViewport(p),this.modality=d;const h=this._getValidVOILUTFunction(u);this.VOILUTFunction=h,this.calibration=f;let m=this._getImagePlaneModule(t);return this.useCPURendering||(m=this.calibrateIfNecessary(t,m)),{bitsAllocated:c.bitsAllocated,numberOfComponents:r,origin:i,direction:o,dimensions:a,spacing:s,numVoxels:l,imagePlaneModule:m,imagePixelModule:c}}matchImagesForOverlay(e,t){return(e=>{const n=k.get(re.MetadataModules.IMAGE_PLANE,t),r=k.get(re.MetadataModules.IMAGE_PLANE,e),i=n.imageOrientationPatient,o=r.imageOrientationPatient;if(i&&o){if((0,Y.n4)(n.imageOrientationPatient,r.imageOrientationPatient)){const t=n.imagePositionPatient,i=r.imagePositionPatient;if(t&&i){if((0,Y.n4)(t,i)){const t=n.rows,i=n.columns,o=r.rows,a=r.columns;if(t===o&&i===a)return e}}}}else{const t=n.rows,i=n.columns,o=r.rows,a=r.columns;if(t===o&&i===a)return e}})(e)}getImagePlaneReferenceData(e=this.getCurrentImageIdIndex()){const t=this.imageIds[e];if(!t)return;const n=k.get(re.MetadataModules.IMAGE_PLANE,t);if(!n)return;const{imagePositionPatient:r,frameOfReferenceUID:i}=n;let{rowCosines:o,columnCosines:a}=n;o||=[1,0,0],a||=[0,1,0];return{FrameOfReferenceUID:i,viewPlaneNormal:h.eR.cross([0,0,0],a,o),cameraFocalPoint:r,referencedImageId:t,sliceIndex:e}}_getCameraOrientation(e){const t=e.slice(6,9).map((e=>-e)),n=e.slice(3,6).map((e=>-e));return{viewPlaneNormal:[t[0],t[1],t[2]],viewUp:[n[0],n[1],n[2]]}}createVTKImageData({origin:e,direction:t,dimensions:n,spacing:o,numberOfComponents:a,pixelArray:s}){const l=new s.constructor(s.length),c=r.Ay.newInstance({name:"Pixels",numberOfComponents:a,values:l}),u=i.Ay.newInstance();return u.setDimensions(n),u.setSpacing(o),u.setDirection(t),u.setOrigin(e),u.getPointData().setScalars(c),u}_createVTKImageData({origin:e,direction:t,dimensions:n,spacing:r,numberOfComponents:i,pixelArray:o}){try{this._imageData=this.createVTKImageData({origin:e,direction:t,dimensions:n,spacing:r,numberOfComponents:i,pixelArray:o})}catch(e){Ae.error(e)}}async setStack(e,t=0){if(this._throwIfDestroyed(),this.imageIds=e,t>e.length)throw new Error("Current image index is greater than the number of images in the stack");this.imageKeyToIndexMap.clear(),e.forEach(((e,t)=>{this.imageKeyToIndexMap.set(e,t),this.imageKeyToIndexMap.set((0,Q.A)(e),t)})),this.currentImageIdIndex=t,this.targetImageIdIndex=t;const n=k.get(Z.A.IMAGE_RETRIEVE_CONFIGURATION,e[t],"stack");this.imagesLoader=n?(n.create||ge.Ke)(n):this,this.stackInvalidated=!0,this.flipVertical=!1,this.flipHorizontal=!1,this.voiRange=null,this.interpolationType=re.InterpolationType.LINEAR,this.invert=!1,this.viewportStatus=re.ViewportStatus.LOADING,this.fillWithBackgroundColor(),this.useCPURendering&&(this._cpuFallbackEnabledElement.renderingTools={},delete this._cpuFallbackEnabledElement.viewport.colormap);const r=await this._setImageIdIndex(t),i={imageIds:e,viewportId:this.id,element:this.element,currentImageIdIndex:t};return(0,X.A)(this.element,re.Events.VIEWPORT_NEW_IMAGE_SET,i),r}_throwIfDestroyed(){if(this.isDisabled)throw new Error("The stack viewport has been destroyed and is no longer usable. Renderings will not be performed. If you are using the same viewportId and have re-enabled the viewport, you need to grab the new viewport instance using renderingEngine.getViewport(viewportId), instead of using your lexical scoped reference to the viewport instance.")}_checkVTKImageDataMatchesCornerstoneImage(e,t){if(!t)return!1;const[n,r]=t.getSpacing(),[i,o]=t.getDimensions(),a=this._getImagePlaneModule(e.imageId),s=t.getDirection(),l=s.slice(0,3),c=s.slice(3,6),u=t.getPointData().getScalars().getDataType(),d=(0,Y.n4)(n,e.columnPixelSpacing),p=(0,Y.n4)(r,e.rowPixelSpacing),f=d||null===e.columnPixelSpacing&&1===n,h=p||null===e.rowPixelSpacing&&1===r,m=i===e.columns,g=o===e.rows,v=(0,Y.n4)(a.rowCosines,l),y=(0,Y.n4)(a.columnCosines,c),b=u===e.voxelManager.getScalarData().constructor.name;return f&&h&&m&&g&&v&&y&&b}_updateVTKImageDataFromCornerstoneImage(e){let t=this._getImagePlaneModule(e.imageId).imagePositionPatient;null==t&&(t=[0,0,0]),this._imageData.setOrigin(t),(0,$.J)(this._imageData,e)}_loadAndDisplayImage(e,t){return this.useCPURendering?this._loadAndDisplayImageCPU(e,t):this._loadAndDisplayImageGPU(e,t)}_loadAndDisplayImageCPU(e,t){return new Promise(((n,r)=>{function i(e,t,r){if(this.currentImageIdIndex!==t)return;const i=e.voxelManager.getScalarData(),o=e.preScale,a=o?.scalingParameters;if(i instanceof Float32Array&&(o?.scaled&&a?.rescaleIntercept%1!=0||a?.rescaleSlope%1!=0)){const t={min:e.minPixelValue,max:e.maxPixelValue},n=Math.abs(t.max-t.min)/65535,r=t.min,o=i.length,a=new Uint16Array(o);let s=65535,l=0;for(let e=0;e<o;e++){const t=Math.floor((i[e]-r)/n);a[e]=t,s=Math.min(s,t),l=Math.max(l,t)}e.minPixelValue=s,e.maxPixelValue=l,e.slope=n,e.intercept=r,e.voxelManager?e.voxelManager.getScalarData=()=>a:e.getPixelData=()=>a,e.preScale={...e.preScale,scaled:!1}}this._setCSImage(e),this.viewportStatus=re.ViewportStatus.PRE_RENDER;const s={image:e,imageId:r,imageIdIndex:t,viewportId:this.id,renderingEngineId:this.renderingEngineId};(0,X.A)(this.element,re.Events.STACK_NEW_IMAGE,s),this._updateToDisplayImageCPU(e),this.render(),this.currentImageIdIndex=t,n(r)}function o(e,t,n){const i={error:e,imageIdIndex:t,imageId:n};this.suppressEvents||(0,X.A)(V.A,re.Events.IMAGE_LOAD_ERROR,i),r(e)}const a=re.RequestType.Interaction,s={imageId:e,imageIdIndex:t},l={useRGBA:!0,requestType:a},c={imageId:e,imageIdIndex:t,viewportId:this.id,renderingEngineId:this.renderingEngineId};(0,X.A)(this.element,re.Events.PRE_STACK_NEW_IMAGE,c),oe.A.addRequest(function(e,t,n){return(0,ie.loadAndCacheImage)(e,n).then((n=>{i.call(this,n,t,e)}),(n=>{o.call(this,n,t,e)}))}.bind(this,e,t,l),a,s,-5)}))}successCallback(e,t){const n=this.imageIds.indexOf(e);if(this.currentImageIdIndex!==n)return;const r=this.csImage?.imageFrame,i=t?.imageFrame;(r?.photometricInterpretation||this.csImage?.photometricInterpretation)!==(i?.photometricInterpretation||t?.photometricInterpretation)&&(this.stackInvalidated=!0),this._setCSImage(t);const o={image:t,imageId:e,imageIdIndex:n,viewportId:this.id,renderingEngineId:this.renderingEngineId};this._updateActorToDisplayImageId(t),(0,X.A)(this.element,re.Events.STACK_NEW_IMAGE,o),this.render(),this.currentImageIdIndex=n}errorCallback(e,t,n){if(!t)return;const r={error:n,imageIdIndex:this.imageIds.indexOf(e),imageId:e};(0,X.A)(V.A,re.Events.IMAGE_LOAD_ERROR,r)}getLoaderImageOptions(e){const t=this.imageIds.indexOf(e),{transferSyntaxUID:n}=k.get("transferSyntax",e)||{};return{useRGBA:!1,transferSyntaxUID:n,priority:5,requestType:re.RequestType.Interaction,additionalDetails:{imageId:e,imageIdIndex:t}}}async loadImages(e,t){const n=await Promise.allSettled(e.map((e=>{const n=this.getLoaderImageOptions(e);return(0,ie.loadAndCacheImage)(e,n).then((n=>(t.successCallback(e,n),e)),(n=>(t.errorCallback(e,!0,n),e)))}))),r=n.filter((e=>"rejected"===e.status));if(r&&r.length){const e=new CustomEvent(re.Events.IMAGE_LOAD_ERROR,{detail:r,cancelable:!0});V.A.dispatchEvent(e)}return n}_loadAndDisplayImageGPU(e,t){if(!e)return void console.warn("No image id set yet to load");const n={imageId:e,imageIdIndex:t,viewportId:this.id,renderingEngineId:this.renderingEngineId};return(0,X.A)(this.element,re.Events.PRE_STACK_NEW_IMAGE,n),this.imagesLoader.loadImages([e],this).then((t=>e))}_updateToDisplayImageCPU(e){const t=this.getImageDataMetadata(e),n=(0,ce.A)(this.canvas,e,this.modality,this._cpuFallbackEnabledElement.viewport.colormap),{windowCenter:r,windowWidth:i,voiLUTFunction:o}=n.voi;this.voiRange=H.toLowHighRange(i,r,o),this._cpuFallbackEnabledElement.image=e,this._cpuFallbackEnabledElement.metadata={...t},this.cpuImagePixelData=e.voxelManager.getScalarData();const a=Object.assign({},n,this._cpuFallbackEnabledElement.viewport);this._cpuFallbackEnabledElement.viewport=this.stackInvalidated?n:a,this.stackInvalidated=!1,this.cpuRenderingInvalidated=!0,this._cpuFallbackEnabledElement.transform=(0,ae.A)(this._cpuFallbackEnabledElement)}getSliceViewInfo(){throw new Error("Method not implemented.")}addImages(e){const t=[];e.forEach((e=>{const{imageId:n,...r}=e,i=he.Ay.getImage(n),{origin:o,dimensions:a,direction:s,spacing:l,numberOfComponents:c}=this.getImageDataMetadata(i),u=this.createVTKImageData({origin:o,dimensions:a,direction:s,spacing:l,numberOfComponents:c,pixelArray:i.voxelManager.getScalarData()}),d=this.createActorMapper(u);d&&(t.push({uid:e.actorUID??(0,ye.A)(),actor:d,referencedId:n,...r}),e.callback&&e.callback({imageActor:d,imageId:e.imageId}))})),this.addActors(t)}_updateActorToDisplayImageId(e){const t=this._checkVTKImageDataMatchesCornerstoneImage(e,this._imageData),n=this.getViewPresentation();if(t&&!this.stackInvalidated)return this._updateVTKImageDataFromCornerstoneImage(e),this.resetCameraNoEvent(),this.setViewPresentation(n),this._setPropertiesFromCache(),void(this.stackActorReInitialized=!1);const{origin:r,direction:i,dimensions:o,spacing:a,numberOfComponents:s,imagePixelModule:l}=this.getImageDataMetadata(e),c=e.voxelManager.getScalarData();this._createVTKImageData({origin:r,direction:i,dimensions:o,spacing:a,numberOfComponents:s,pixelArray:c}),this._updateVTKImageDataFromCornerstoneImage(e);const u=this.createActorMapper(this._imageData),d=this.getActors();d.length&&d[0].uid===this.id?d[0].actor=u:d.unshift({uid:this.id,actor:u}),this.setActors(d);const{viewPlaneNormal:p,viewUp:f}=this._getCameraOrientation(i),h=this.getCamera();this.setCameraNoEvent({viewUp:f,viewPlaneNormal:p}),this.initialViewUp=f,this.resetCameraNoEvent(),this.setViewPresentation(n),this.triggerCameraEvent(this.getCamera(),h);const m="MONOCHROME1"===l.photometricInterpretation;this.stackInvalidated=!0;const g=this._getInitialVOIRange(e);this.setVOI(g,{forceRecreateLUTFunction:!!m}),this.initialInvert=!!m,this.setInvertColor(this.invert||this.initialInvert),this.stackInvalidated=!1,this.stackActorReInitialized=!0,this._publishCalibratedEvent&&this.triggerCalibrationEvent()}_getInitialVOIRange(e){if(this.voiRange&&this.voiUpdatedWithSetProperties)return this.voiRange;const{windowCenter:t,windowWidth:n,voiLUTFunction:r}=e;let i=this._getVOIRangeFromWindowLevel(n,t,r);return i=this._getPTPreScaledRange()||i,i}_getPTPreScaledRange(){if(this._isCurrentImagePTPrescaled())return this._getDefaultPTPrescaledVOIRange()}_isCurrentImagePTPrescaled(){return!("PT"!==this.modality||!this.csImage.isPreScaled)&&!!this.csImage.preScale?.scalingParameters.suvbw}_getDefaultPTPrescaledVOIRange(){return{lower:0,upper:5}}_getVOIRangeFromWindowLevel(e,t,n=re.VOILUTFunctionType.LINEAR){let r,i;if("number"==typeof t&&"number"==typeof e?(r=t,i=e):Array.isArray(t)&&Array.isArray(e)&&(r=t[0],i=e[0]),void 0!==r&&void 0!==i)return H.toLowHighRange(i,r,n)}async _setImageIdIndex(e){if(e>=this.imageIds.length)throw new Error(`ImageIdIndex provided ${e} is invalid, the stack only has ${this.imageIds.length} elements`);this.currentImageIdIndex=e,this.hasPixelSpacing=!0,this.viewportStatus=re.ViewportStatus.PRE_RENDER;const t=await this._loadAndDisplayImage(this.imageIds[e],e);if(this.perImageIdDefaultProperties.size>=1){const e=this.perImageIdDefaultProperties.get(t);void 0!==e?this.setProperties(e):void 0!==this.globalDefaultProperties&&this.setProperties(this.globalDefaultProperties)}return t}resetCameraCPU({resetPan:e=!0,resetZoom:t=!0}){const{image:n}=this._cpuFallbackEnabledElement;if(!n)return;!function(e,t=!0,n=!0){const{canvas:r,image:i,viewport:o}=e,a=(0,de.A)(r,i,0).scaleFactor;o.vflip=!1,o.hflip=!1,t&&(o.translation.x=0,o.translation.y=0),n&&(o.displayedArea.tlhc.x=1,o.displayedArea.tlhc.y=1,o.displayedArea.brhc.x=i.columns,o.displayedArea.brhc.y=i.rows,o.scale=a)}(this._cpuFallbackEnabledElement,e,t);const{scale:r}=this._cpuFallbackEnabledElement.viewport,{clientWidth:i,clientHeight:o}=this.element,a=[i/2,o/2],s=this.canvasToWorldCPU(a);this.setCameraCPU({focalPoint:s,scale:r})}resetCameraGPU({resetPan:e,resetZoom:t}){this.setCamera({flipHorizontal:!1,flipVertical:!1,viewUp:this.initialViewUp});return super.resetCamera({resetPan:e,resetZoom:t,resetToCenter:!0})}scroll(e,t=!0,n=!1){const r=this.imageIds;if(isNaN(this.targetImageIdIndex))return;const i=this.targetImageIdIndex,o=r.length;let a=i+e;a=n?(a+o)%o:Math.max(0,Math.min(o-1,a)),this.targetImageIdIndex=a;const s=r[a];he.Ay.isLoaded(s)||!t?this.setImageIdIndex(a):(clearTimeout(this.debouncedTimeout),this.debouncedTimeout=window.setTimeout((()=>{this.setImageIdIndex(a)}),40));const l={newImageIdIndex:a,imageId:s,direction:e};a!==i&&(0,X.A)(this.element,re.Events.STACK_VIEWPORT_SCROLL,l)}setImageIdIndex(e){if(this._throwIfDestroyed(),this.currentImageIdIndex===e)return Promise.resolve(this.getCurrentImageId());return this._setImageIdIndex(e)}calibrateSpacing(e){const t=this.getImageIds().indexOf(e);this.stackInvalidated=!0,this._loadAndDisplayImage(e,t)}triggerCameraEvent(e,t){const n={previousCamera:t,camera:e,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};this.suppressEvents||(0,X.A)(this.element,re.Events.CAMERA_MODIFIED,n)}triggerCalibrationEvent(){const{imageData:e}=this.getImageData(),t={element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId,imageId:this.getCurrentImageId(),imageData:e,worldToIndex:e.getWorldToIndex(),...this._calibrationEvent};this.suppressEvents||(0,X.A)(this.element,re.Events.IMAGE_SPACING_CALIBRATED,t),this._publishCalibratedEvent=!1}jumpToWorld(e){const t=this.getImageIds(),n=this.getImageData(),{direction:r,spacing:i}=n,o=(0,xe.A)({direction:r,spacing:i,imageIds:t},e,this.getCamera().viewPlaneNormal,{ignoreSpacing:!0}),a=t.indexOf(o);return-1!==a&&(this.setImageIdIndex(a),this.render(),!0)}_getVOIRangeForCurrentImage(){const{windowCenter:e,windowWidth:t,voiLUTFunction:n}=this.csImage;return this._getVOIRangeFromWindowLevel(t,e,n)}_getValidVOILUTFunction(e){return Object.values(re.VOILUTFunctionType).includes(e)?e:re.VOILUTFunctionType.LINEAR}getSliceInfo(){const e=this.getSliceIndex(),{dimensions:t}=this.getImageData();return{width:t[0],height:t[1],sliceIndex:e,slicePlane:2}}isReferenceViewable(e,t={}){const n=this.getCurrentImageIdIndex(),r=this.imageIds[n];if(!r||!e)return!1;const{referencedImageId:i,multiSliceReference:o}=e;if(i){if(i===r)return!0;e.referencedImageURI||=(0,Q.A)(i);const{referencedImageURI:a}=e,s=this.imageKeyToIndexMap.get(a);if(t.asOverlay){if(this.matchImagesForOverlay(r,i))return!0}if(void 0===s)return!1;if(t.withNavigation)return!0;return n<=(o&&this.imageKeyToIndexMap.get(o.referencedImageId))&&n>=s}if(!super.isReferenceViewable(e,t))return!1;if(e.volumeId)return t.asVolume;const{cameraFocalPoint:a}=e;if(t.asNearbyProjection&&a){const{spacing:e,direction:t,origin:n}=this.getImageData(),r=t.slice(6,9),i=(0,be.A)({direction:t,spacing:e},r),o=h.eR.subtract(h.eR.create(),a,n),s=h.eR.dot(o,r),l=i/2;if(Math.abs(s)<=l)return!0}return!1}getViewReference(e={}){const{sliceIndex:t=this.getCurrentImageIdIndex()}=e,n=super.getViewReference(e),r=this.getCurrentImageId(t);if(r){if(n.referencedImageId=r,this.getCurrentImageIdIndex()!==t){const e=this.getImagePlaneReferenceData(t);if(!e)return;Object.assign(n,e)}return n}}setViewReference(e){if(!e?.referencedImageId)return void(void 0!==e?.sliceIndex&&this.scroll(e.sliceIndex-this.targetImageIdIndex));const{referencedImageId:t}=e;e.referencedImageURI||=(0,Q.A)(t);const{referencedImageURI:n}=e,r=this.imageKeyToIndexMap.get(n);void 0!==r?this.scroll(r-this.targetImageIdIndex):Ae.error(`No image URI found for ${n}`)}getViewReferenceId(e={}){const{sliceIndex:t=this.currentImageIdIndex}=e;return`imageId:${this.imageIds[t]}`}getSliceIndexForImage(e){if(e)return"string"==typeof e?this.imageKeyToIndexMap.get(e):e.referencedImageId?this.imageKeyToIndexMap.get(e.referencedImageId):void 0}getCPUFallbackError(e){return new Error(`method ${e} cannot be used during CPU Fallback mode`)}fillWithBackgroundColor(){const e=this.getRenderingEngine();e&&e.fillCanvasWithBackgroundColor(this.canvas,this.options.background)}unsetColormapCPU(){delete this._cpuFallbackEnabledElement.viewport.colormap,this._cpuFallbackEnabledElement.renderingTools={},this.cpuRenderingInvalidated=!0,this.fillWithBackgroundColor(),this.render()}setColormapCPU(e){this.colormap=e;const t=W.getColormap(e.name);this._cpuFallbackEnabledElement.viewport.colormap=t,this._cpuFallbackEnabledElement.renderingTools={},this.fillWithBackgroundColor(),this.cpuRenderingInvalidated=!0,this.render();const n={viewportId:this.id,colormap:e};(0,X.A)(this.element,re.Events.COLORMAP_MODIFIED,n)}setColormapGPU(e){const t=this.getDefaultActor().actor.getProperty(),n=t.getRGBTransferFunction(),r=W.getColormap(e.name)||s.A.getPresetByName(e.name);if(n)n.applyColorMap(r),n.setMappingRange(this.voiRange.lower,this.voiRange.upper),t.setRGBTransferFunction(0,n);else{const e=a.Ay.newInstance();e.applyColorMap(r),e.setMappingRange(this.voiRange.lower,this.voiRange.upper),t.setRGBTransferFunction(0,e)}this.colormap=e,this.render();const i={viewportId:this.id,colormap:e};(0,X.A)(this.element,re.Events.COLORMAP_MODIFIED,i)}unsetColormapGPU(){throw new Error("unsetColormapGPU not implemented.")}_getImagePlaneModule(e){const t=(0,ne.SJ)(e);return this.hasPixelSpacing=!t.usingDefaultValues||this.calibration?.scale>0||this.calibration?.rowPixelSpacing>0,this.calibration||=t.calibration,t}isInAcquisitionPlane(){return!0}}const Te=Ce},32501:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var r=n(3823),i=n(71851),o=n(74876),a=n(45354),s=n(69372),l=n(10056),c=n(40661);class u{constructor(e){this.opacity=.4,this.outlineOpacity=.4,this.transferFunction=[],this.actor=e}setRGBTransferFunction(e,t){this.transferFunction[e]=t}setScalarOpacity(e){}setInterpolationTypeToNearest(){}setUseLabelOutline(){}setLabelOutlineOpacity(e){this.outlineOpacity=e}setLabelOutlineThickness(){}getColor(e){const t=this.transferFunction[0];return[t.getRedValue(e),t.getGreenValue(e),t.getBlueValue(e),this.opacity]}}class d{constructor(e){this.actor=e}getInputData(){return this.actor.getImage()}}class p{constructor(e,t){this.canvasProperties=new u(this),this.visibility=!1,this.mapper=new d(this),this.className="CanvasActor",this.derivedImage=t,this.viewport=e}renderRLE(e,t,n){const{width:r,height:i}=this.image;let{canvas:o}=this;o&&o.width===r&&o.height===i||(this.canvas=o=new window.OffscreenCanvas(r,i));const a=o.getContext("2d"),s=a.createImageData(r,i),{data:l}=s;l.fill(0);const{map:c}=n;let u=1/0,d=1/0,p=-1/0,f=-1/0;for(let e=0;e<i;e++){const t=c.getRun(e,0);if(!t)continue;d=Math.min(d,e),f=Math.max(f,e);const n=e*r<<2;let i;for(const e of t){const{start:r,end:o,value:a}=e;if(0===a){i||=[],i.push(t.indexOf(e));continue}u=Math.min(u,r),p=Math.max(p,o);const s=this.canvasProperties.getColor(a).map((e=>255*e));let c=n+(r<<2);for(let e=r;e<o;e++)l[c++]=s[0],l[c++]=s[1],l[c++]=s[2],l[c++]=s[3]}}if(u>r)return;const h=p-u,m=f-d;a.putImageData(s,0,0,u-1,d-1,h+2,m+2),t.drawImage(o,u,d,h,m,u,d,h,m)}setMapper(e){this.mapper=e}render(e,t){if(!this.visibility)return;const n=this.image||this.getImage(),{width:r,height:i}=n,o=n.getScalarData();if(!o)return;const{voxelManager:a}=n;if(a&&a.map.getRun)return void this.renderRLE(e,t,a);let{canvas:s}=this;s&&s.width===r&&s.height===i||(this.canvas=s=new window.OffscreenCanvas(r,i));const l=s.getContext("2d"),c=l.createImageData(r,i),{data:u}=c;let d=0,p=0,f=1/0,h=1/0,m=-1/0,g=-1/0;for(let e=0;e<i;e++)for(let t=0;t<r;t++){const n=o[d++];if(n){f=Math.min(t,f),h=Math.min(e,h),m=Math.max(t,m),g=Math.max(e,g);const r=this.canvasProperties.getColor(n);u[p]=255*r[0],u[p+1]=255*r[1],u[p+2]=255*r[2],u[p+3]=127}p+=4}if(f>r)return;const v=m-f+1,y=g-h+1;l.putImageData(c,0,0,f,h,v,y),t.drawImage(s,f,h,v,y,f,h,v,y)}getClassName(){return this.className}getProperty(){return this.canvasProperties}setVisibility(e){this.visibility=e}getMapper(){return this.mapper}isA(e){return e===this.className}getImage(){if(this.image)return this.image;this.image={...this.derivedImage};const e=this.viewport.getImageData();return Object.assign(this.image,{worldToIndex:t=>e.imageData.worldToIndex(t),indexToWorld:(t,n)=>e.imageData.indexToWorld(t,n),getDimensions:()=>e.dimensions,getScalarData:()=>this.derivedImage?.getPixelData(),getDirection:()=>e.direction,getSpacing:()=>e.spacing,setOrigin:()=>null,setDerivedImage:e=>{this.derivedImage=e,this.image=null},modified:()=>null}),this.image}}var f=n(49038),h=n(80221),m=n(56750),g=n(56577);class v extends l.A{static{this.frameRangeExtractor=/(\/frames\/|[&?]frameNumber=)([^/&?]*)/i}constructor(e){super({...e,canvas:e.canvas||(0,c.oI)(e.element)}),this.videoWidth=0,this.videoHeight=0,this.loop=!0,this.mute=!0,this.isPlaying=!1,this.scrollSpeed=1,this.playbackRate=1,this.frameRange=[0,0],this.fps=30,this.videoCamera={panWorld:[0,0],parallelScale:1},this.voiRange={lower:0,upper:255},this.getProperties=()=>({loop:this.videoElement.loop,muted:this.videoElement.muted,playbackRate:this.playbackRate,scrollSpeed:this.scrollSpeed,voiRange:{...this.voiRange}}),this.getMiddleSliceData=()=>{throw new Error("Method not implemented.")},this.useCustomRenderingPipeline=!0,this.resetCamera=()=>(this.refreshRenderValues(),this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.isPlaying||this.renderFrame(),!0),this.getNumberOfSlices=()=>{const e=Math.round(this.videoElement.duration*this.fps/this.scrollSpeed);return isNaN(e)?this.numberOfFrames:e},this.getFrameOfReferenceUID=()=>this.videoElement.src,this.resize=()=>{const e=this.canvas,{clientWidth:t,clientHeight:n}=e;e.width===t&&e.height===n||(e.width=t,e.height=n),this.refreshRenderValues(),this.isPlaying||this.renderFrame()},this.canvasToWorld=(e,t=[0,0,0])=>{const n=this.videoCamera.panWorld,r=this.getWorldToCanvasRatio(),i=[n[0]*r,n[1]*r],o=[e[0]-i[0],e[1]-i[1]];return t.splice(0,2,o[0]/r,o[1]/r),t},this.worldToCanvas=e=>{const t=this.videoCamera.panWorld,n=this.getWorldToCanvasRatio();return[(e[0]+t[0])*n,(e[1]+t[1])*n]},this.getRotation=()=>0,this.canvasToIndex=e=>{const t=this.getTransform();return t.invert(),t.transformPoint(e.map((e=>e*devicePixelRatio)))},this.indexToCanvas=e=>this.getTransform().transformPoint(e).map((e=>e/devicePixelRatio)),this.customRenderViewportToCanvas=()=>{this.renderFrame()},this.renderFrame=()=>{const e=window.devicePixelRatio||1,t=this.getTransform().getMatrix(),n=this.canvasContext;n.resetTransform(),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.transform(t[0]/e,t[1]/e,t[2]/e,t[3]/e,t[4]/e,t[5]/e),n.drawImage(this.videoElement,0,0,this.videoWidth,this.videoHeight);for(const e of this.getActors())e.actor.render(this,this.canvasContext);this.canvasContext.resetTransform(),(0,s.A)(this.element,i.Events.STACK_NEW_IMAGE,{element:this.element,viewportId:this.id,viewport:this,renderingEngineId:this.renderingEngineId,time:this.videoElement.currentTime,duration:this.videoElement.duration}),(0,s.A)(this.element,i.Events.IMAGE_RENDERED,{element:this.element,viewportId:this.id,viewport:this,imageIndex:this.getCurrentImageIdIndex(),numberOfSlices:this.numberOfFrames,renderingEngineId:this.renderingEngineId,time:this.videoElement.currentTime,duration:this.videoElement.duration}),this.initialRender?.();const r=this.getFrameNumber();this.isPlaying&&(r<this.frameRange[0]?this.setFrameNumber(this.frameRange[0]):r>this.frameRange[1]&&(this.loop?this.setFrameNumber(this.frameRange[0]):this.pause()))},this.renderWhilstPlaying=()=>{this.renderFrame(),this.isPlaying&&requestAnimationFrame(this.renderWhilstPlaying)},this.canvasContext=this.canvas.getContext("2d"),this.renderingEngineId=e.renderingEngineId,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.videoElement=document.createElement("video"),this.videoElement.muted=this.mute,this.videoElement.loop=this.loop,this.videoElement.autoplay=!0,this.videoElement.crossOrigin="anonymous",this.addEventListeners(),this.resize()}static get useCustomRenderingPipeline(){return!0}addEventListeners(){this.canvas.addEventListener(i.Events.ELEMENT_DISABLED,this.elementDisabledHandler)}removeEventListeners(){this.canvas.removeEventListener(i.Events.ELEMENT_DISABLED,this.elementDisabledHandler)}elementDisabledHandler(){this.removeEventListeners(),this.videoElement.remove()}getImageDataMetadata(e){const t="string"==typeof e?e:e.imageId,n=o.get(i.MetadataModules.IMAGE_PLANE,t);let a=n.rowCosines,s=n.columnCosines;(n.usingDefaultValues||null==a||null==s)&&(a=[1,0,0],s=[0,1,0]);const l=r.eR.fromValues(a[0],a[1],a[2]),c=r.eR.fromValues(s[0],s[1],s[2]),{rows:u,columns:d}=n,p=r.eR.create();r.eR.cross(p,l,c);let f=n.imagePositionPatient;null==f&&(f=[0,0,0]);const h=n.columnPixelSpacing||1,m=n.rowPixelSpacing||1,g=n.columns,v=n.rows;return this.hasPixelSpacing=!!n.columnPixelSpacing,{bitsAllocated:8,numberOfComponents:3,origin:f,rows:u,columns:d,direction:[...l,...c,...p],dimensions:[g,v,1],spacing:[h,m,1],hasPixelSpacing:this.hasPixelSpacing,numVoxels:g*v*1,imagePlaneModule:n}}setDataIds(e,t){this.setVideo(e[0],(t.viewReference?.sliceIndex||0)+1)}setVideo(e,t){this.imageId=Array.isArray(e)?e[0]:e;const n=o.get(i.MetadataModules.IMAGE_URL,e);if(!n?.rendered)throw new Error(`Video Image ID ${e} does not have a rendered video view`);const{rendered:r}=n,a=o.get(i.MetadataModules.GENERAL_SERIES,e);this.modality=a?.Modality,this.metadata=this.getImageDataMetadata(e);let{cineRate:s,numberOfFrames:l}=o.get(i.MetadataModules.CINE,e);return this.numberOfFrames=l,this.setVideoURL(r).then((()=>(l&&1!==l||(l=Math.round(this.videoElement.duration*(s||30))),s||(s=Math.round(l/this.videoElement.duration)),this.fps=s,this.numberOfFrames=l,this.setFrameRange([1,l]),this.initialRender=()=>{this.initialRender=null,this.pause(),this.setFrameNumber(t||1)},new Promise((e=>{window.setTimeout((()=>{this.setFrameNumber(t||1),e(this)}),25)})))))}async setVideoURL(e){return new Promise((t=>{this.videoElement.src=e,this.videoElement.preload="auto";const n=()=>{this.videoWidth=this.videoElement.videoWidth,this.videoHeight=this.videoElement.videoHeight,this.videoElement.removeEventListener("loadedmetadata",n),this.refreshRenderValues(),t(!0)};this.videoElement.addEventListener("loadedmetadata",n)}))}getImageIds(){const e=new Array(this.numberOfFrames),t=this.imageId.replace(/[0-9]+$/,"");for(let n=0;n<this.numberOfFrames;n++)e[n]=`${t}${n+1}`;return e}togglePlayPause(){return this.isPlaying?(this.pause(),!1):(this.play(),!0)}async play(){try{this.isPlaying||(this.isPlaying=!0,await this.videoElement.play(),this.renderWhilstPlaying())}catch(e){}}pause(){try{this.isPlaying=!1,this.videoElement.pause()}catch(e){}}async scroll(e=1){await this.pause();const t=this.videoElement,n=this.renderFrame,r=t.currentTime+e*this.scrollSpeed/this.fps;t.currentTime=r;const i=e=>{n(),t.removeEventListener("seeked",i)};t.addEventListener("seeked",i)}async start(){const e=this.videoElement,t=this.renderFrame;if(e.currentTime=0,e.paused){const n=r=>{t(),e.removeEventListener("seeked",n)};e.addEventListener("seeked",n)}}async end(){const e=this.videoElement,t=this.renderFrame;if(e.currentTime=e.duration,e.paused){const n=r=>{t(),e.removeEventListener("seeked",n)};e.addEventListener("seeked",n)}}async setTime(e){const t=this.videoElement,n=this.renderFrame;if(t.currentTime=e,t.paused){const e=r=>{n(),t.removeEventListener("seeked",e)};t.addEventListener("seeked",e)}}getSliceViewInfo(){throw new Error("Method not implemented.")}async setFrameNumber(e){this.setTime((e-1)/this.fps)}setFrameRange(e){e?2===e.length&&e[0]!==e[1]&&(this.frameRange=[e[0],e[1]]):this.frameRange=[1,this.numberOfFrames]}getSliceIndexForImage(e){if(e)return"string"==typeof e?m.A.imageIdToFrameStart(e):e.referencedImageId?m.A.imageIdToFrameStart(e.referencedImageId):void 0}getFrameRange(){return this.frameRange}setProperties(e){void 0!==e.loop&&(this.videoElement.loop=e.loop),void 0!==e.muted&&(this.videoElement.muted=e.muted),void 0!==e.playbackRate&&this.setPlaybackRate(e.playbackRate),void 0!==e.scrollSpeed&&this.setScrollSpeed(e.scrollSpeed),e.voiRange&&this.setVOI(e.voiRange)}setPlaybackRate(e=1){this.playbackRate=e,e<.0625?this.pause():this.videoElement&&(this.videoElement.playbackRate=e,this.play())}setScrollSpeed(e=1,t=i.VideoEnums.SpeedUnit.FRAME){this.scrollSpeed=t===i.VideoEnums.SpeedUnit.SECOND?e*this.fps:e}resetProperties(){this.setProperties({loop:!1,muted:!0})}getScalarData(){if(this.scalarData?.frameNumber===this.getFrameNumber())return this.scalarData;if(!this.videoElement||!this.videoElement.videoWidth||!this.videoElement.videoHeight){console.debug("Video not ready yet, returning empty scalar data");const e=new Uint8ClampedArray;return e.getRange=()=>[0,255],e.frameNumber=-1,e}const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const t=e.getContext("2d");t.drawImage(this.videoElement,0,0);const n=t.getImageData(0,0,e.width,e.height).data;return n.getRange=()=>[0,255],n.frameNumber=this.getFrameNumber(),this.scalarData=n,n}getImageData(){const{metadata:e}=this,t=e.spacing,n={getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getRange:()=>[0,255],getScalarData:()=>this.getScalarData(),getSpacing:()=>e.spacing,worldToIndex:e=>{const t=this.worldToCanvas(e),n=this.canvasToIndex(t);return[n[0],n[1],0]},indexToWorld:(e,t)=>{const n=this.indexToCanvas([e[0],e[1]]);return this.canvasToWorld(n,t)}},r={dimensions:e.dimensions,spacing:t,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:e.FrameOfReferenceUID},getScalarData:()=>this.getScalarData(),scalarData:this.getScalarData(),imageData:n,voxelManager:{forEach:(e,t)=>(0,g.ii)(t.imageData,{pointInShapeFn:t.isInObject??(()=>!0),callback:e,boundsIJK:t.boundsIJK,returnPoints:t.returnPoints??!1})},hasPixelSpacing:this.hasPixelSpacing,calibration:this.calibration,preScale:{scaled:!1}};return Object.defineProperty(n,"scalarData",{get:()=>this.getScalarData(),enumerable:!0}),r}hasImageURI(e){const t=e.match(v.frameRangeExtractor),n=t?e.substring(0,t.index):e;return this.imageId.includes(n)}setVOI(e){this.voiRange=e,this.setColorTransform()}setWindowLevel(e=256,t=128){const n=t-e/2,r=t+e/2-1;this.setVOI({lower:n,upper:r}),this.setColorTransform()}setAverageWhite(e){this.averageWhite=e,this.setColorTransform()}setColorTransform(){if(!this.voiRange&&!this.averageWhite)return void(this.feFilter=null);const e=this.averageWhite||[255,255,255],t=Math.max(...e),n=e.map((e=>t/e)),{lower:r=0,upper:i=255}=this.voiRange||{},o=(i-r+1)/255,a=r/255;this.feFilter=`url('data:image/svg+xml,      <svg xmlns="http://www.w3.org/2000/svg">        <filter id="colour" color-interpolation-filters="linearRGB">        <feColorMatrix type="matrix"         values="          ${n[0]*o} 0 0 0 ${a}           0 ${n[1]*o} 0 0 ${a}           0 0 ${n[2]*o} 0 ${a}           0 0 0 1 0" />        </filter>      </svg>#colour')`,this.canvas.style.filter=this.feFilter}setCamera(e){const{parallelScale:t,focalPoint:n}=e;if(t&&(this.videoCamera.parallelScale=this.element.clientHeight/2/t),void 0!==n){const e=this.worldToCanvas(n),t=[this.element.clientWidth/2,this.element.clientHeight/2],r=[(e[0]-t[0])/this.videoCamera.parallelScale,(e[1]-t[1])/this.videoCamera.parallelScale];this.videoCamera.panWorld=[this.videoCamera.panWorld[0]-r[0],this.videoCamera.panWorld[1]-r[1]]}this.canvasContext.fillStyle="rgba(0,0,0,1)",this.canvasContext.fillRect(0,0,this.canvas.width,this.canvas.height),this.isPlaying||this.renderFrame()}getCurrentImageId(e=this.getCurrentImageIdIndex()){return this.imageId.replace("/frames/1",`/frames/${e+1}`)}getViewReferenceId(e={}){const{sliceIndex:t}=e;if(void 0===t)return`videoId:${this.getCurrentImageId()}`;if(Array.isArray(t))return`videoId:${this.imageId.substring(0,this.imageId.length-1)}${t[0]+1}-${t[1]+1}`;return`videoId:${this.imageId.replace("/frames/1",`/frames/${1+t}`)}`}isReferenceViewable(e,t={}){let{imageURI:n}=t;const{referencedImageId:r,sliceIndex:i,multiSliceReference:o}=e;if(!super.isReferenceViewable(e))return!1;const a=this.getCurrentImageId();if(!n){const e=a.indexOf(":");n=a.substring(e+1,a.length-1)}if(t.withNavigation)return!0;const s=this.getSliceIndex();if(o){const e=m.A.imageIdToFrameEnd(o.referencedImageId);return s>=i&&s<=e}if(void 0!==i)return s===i;if(!r)return!1;const l=r.match(v.frameRangeExtractor);if(!l)return!0;if(!l[2])return!0;const c=l[2].split("-").map((e=>Number(e))),u=s+1;return c[0]<=u&&u<=(c[1]??c[0])}setViewReference(e){"number"==typeof e.sliceIndex?this.setFrameNumber(e.sliceIndex+1):Array.isArray(e.sliceIndex)&&this.setFrameRange(e.sliceIndex)}getViewReference(e){const t=e?.sliceIndex??(this.isPlaying?this.frameRange[0]:this.getCurrentImageIdIndex()),n=e?.rangeEndSliceIndex??(this.isPlaying?this.frameRange[1]-1:void 0),r=n>t?{sliceIndex:n,referencedImageId:this.getCurrentImageId(n)}:void 0;return{...super.getViewReference(e),referencedImageId:this.getViewReferenceId(e),sliceIndex:t,multiSliceReference:r}}getFrameNumber(){return 1+this.getCurrentImageIdIndex()}getCurrentImageIdIndex(){return Math.round(this.videoElement.currentTime*this.fps)}getSliceIndex(){return this.getCurrentImageIdIndex()/this.scrollSpeed}getCamera(){const{parallelScale:e}=this.videoCamera,t=[this.element.clientWidth/2,this.element.clientHeight/2];return{parallelProjection:!0,focalPoint:this.canvasToWorld(t),position:[0,0,0],viewUp:[0,-1,0],parallelScale:this.element.clientHeight/2/e,viewPlaneNormal:[0,0,1]}}getFrameRate(){return this.fps}getPan(){const e=this.videoCamera.panWorld;return[e[0],e[1]]}refreshRenderValues(){let e=this.canvas.offsetWidth/this.videoWidth;this.videoHeight*e>this.canvas.height&&(e=this.canvas.offsetHeight/this.videoHeight);const t=Math.floor(this.videoWidth*e),n=Math.floor(this.videoHeight*e),r=(this.canvas.offsetWidth-t)/2/e,i=(this.canvas.offsetHeight-n)/2/e;this.videoCamera.panWorld=[r,i],this.videoCamera.parallelScale=e}getWorldToCanvasRatio(){return this.videoCamera.parallelScale}getCanvasToWorldRatio(){return 1/this.videoCamera.parallelScale}getTransform(){const e=this.videoCamera.panWorld,t=window.devicePixelRatio||1,n=this.getWorldToCanvasRatio(),r=this.getCanvasToWorldRatio(),i=[this.canvas.offsetWidth/2,this.canvas.offsetHeight/2],o=[i[0]*r,i[1]*r],s=new a.d;return s.scale(t,t),s.translate(i[0],i[1]),s.scale(n,n),s.translate(e[0],e[1]),s.translate(-o[0],-o[1]),s}updateCameraClippingPlanesAndRange(){}addImages(e){const t=this.getActors();e.forEach((e=>{const{imageId:n,...r}=e,i=f.Ay.getImage(n),o=this.createActorMapper(i),a=e.actorUID??(0,h.A)();o&&(t.push({uid:a,actor:o,referencedId:n,...r}),e.callback&&e.callback({imageActor:o,imageId:n}))})),this.setActors(t)}createActorMapper(e){return new p(this,e)}}const y=v},10056:(e,t,n)=>{"use strict";n.d(t,{A:()=>x});var r=n(89265),i=n(84607),o=n(75127),a=n(3823),s=n(32643),l=n(1814),c=n(41864),u=n(5862),d=n(98039),p=n(69372),f=n(52268),h=n(74638),m=n(38883),g=n(19325),v=n(71851),y=n(99949);class b{static{this.CameraViewPresentation={rotation:!0,pan:!0,zoom:!0,displayArea:!0}}static{this.TransferViewPresentation={windowLevel:!0,paletteLut:!0}}constructor(e){this.insetImageMultiplier=1.1,this.flipHorizontal=!1,this.flipVertical=!1,this.viewportStatus=l.A.NO_DATA,this._suppressCameraModifiedEvents=!1,this.hasPixelSpacing=!0,this.getProperties=()=>({}),this.setRotation=e=>{},this.viewportWidgets=new Map,this.addWidget=(e,t)=>{this.viewportWidgets.set(e,t)},this.getWidget=e=>this.viewportWidgets.get(e),this.getWidgets=()=>Array.from(this.viewportWidgets.values()),this.removeWidgets=()=>{this.getWidgets().forEach((e=>{if(e.getEnabled()&&e.setEnabled(!1),e.getActor&&e.getRenderer){const t=e.getActor(),n=e.getRenderer();n&&t&&n.removeActor(t)}}))},this.id=e.id,this.renderingEngineId=e.renderingEngineId,this.type=e.type,this.element=e.element,this.canvas=e.canvas,this.sx=e.sx,this.sy=e.sy,this.sWidth=e.sWidth,this.sHeight=e.sHeight,this._actors=new Map,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.defaultOptions=(0,y.G)(e.defaultOptions),this.suppressEvents=!!e.defaultOptions.suppressEvents&&e.defaultOptions.suppressEvents,this.options=(0,y.G)(e.defaultOptions),this.isDisabled=!1}static get useCustomRenderingPipeline(){return!1}setRendered(){this.viewportStatus!==l.A.NO_DATA&&this.viewportStatus!==l.A.LOADING&&(this.viewportStatus=l.A.RENDERED)}getRenderingEngine(){return u.A.get(this.renderingEngineId)}getRenderer(){const e=this.getRenderingEngine();if(!e||e.hasBeenDestroyed)throw new Error("Rendering engine has been destroyed");return e.offscreenMultiRenderWindow?.getRenderer(this.id)}render(){this.getRenderingEngine().renderViewport(this.id)}setOptions(e,t=!1){this.options=structuredClone(e),this.options?.displayArea&&this.setDisplayArea(this.options?.displayArea),t&&this.render()}reset(e=!1){this.options=structuredClone(this.defaultOptions),e&&this.render()}getSliceViewInfo(){throw new Error("Method not implemented.")}flip({flipHorizontal:e,flipVertical:t}){const n=this.getDefaultImageData();if(!n)return;const r=this.getCamera(),{viewPlaneNormal:i,viewUp:o,focalPoint:s,position:l}=r,c=a.eR.cross(a.eR.create(),i,o);let u=a.eR.copy(a.eR.create(),o);const d=a.eR.negate(a.eR.create(),i),p=a.eR.distance(l,s),f=n.getDimensions().map((e=>Math.floor(e/2))),h=[f[0],f[1],f[2]],m=n.indexToWorld(h,a.eR.create()),g=this._getFocalPointForResetCamera(m,r,{resetPan:!0,resetToCenter:!1}),v=a.eR.subtract(a.eR.create(),s,g),y=a.eR.length(v),b=e=>{const t=a.eR.scale(a.eR.create(),e,2*a.eR.dot(v,e));return a.eR.subtract(t,t,v),a.eR.normalize(t,t),t};if(e){const e=b(u),t=a.eR.scaleAndAdd(a.eR.create(),g,e,y),n=a.eR.scaleAndAdd(a.eR.create(),t,d,p);this.setCamera({viewPlaneNormal:d,position:n,focalPoint:t}),this.flipHorizontal=!this.flipHorizontal}if(t){u=a.eR.negate(u,o);const e=b(c),t=a.eR.scaleAndAdd(a.eR.create(),g,e,y),n=a.eR.scaleAndAdd(a.eR.create(),t,d,p);this.setCamera({focalPoint:t,viewPlaneNormal:d,viewUp:u,position:n}),this.flipVertical=!this.flipVertical}this.render()}getDefaultImageData(){const e=this.getDefaultActor();if(e&&(0,d.e)(e))return e.actor.getMapper().getInputData()}getDefaultActor(){return this.getActors()[0]}getActors(){return Array.from(this._actors.values())}getActorUIDs(){return Array.from(this._actors.keys())}getActor(e){return this._actors.get(e)}getImageActor(e){const t=this.getActors();let n=t[0];if(e&&(n=t.find((t=>t.referencedId===e))),!n||!(0,d.e)(n))return null;return n.actor}getActorUIDByIndex(e){const t=this.getActors()[e];if(t)return t.uid}getActorByIndex(e){return this.getActors()[e]}setActors(e){this.removeAllActors(),this.addActors(e,{resetCamera:!0})}_removeActor(e){const t=this.getActor(e);if(!t)return void console.warn(`Actor ${e} does not exist for this viewport`);this.getRenderer().removeViewProp(t.actor),this._actors.delete(e)}removeActors(e){e.forEach((e=>{this._removeActor(e)}))}addActors(e,t={}){const{resetCamera:n=!1}=t,r=this.getRenderingEngine();if(!r||r.hasBeenDestroyed)return void console.warn("Viewport::addActors::Rendering engine has not been initialized or has been destroyed");e.forEach((e=>{this.addActor(e)}));const i=this.getViewPresentation(),o=this.getViewReference();this.resetCamera(),n||(this.setViewReference(o),this.setViewPresentation(i))}addActor(e){const{uid:t,actor:n}=e,r=this.getRenderingEngine();if(!r||r.hasBeenDestroyed)return void console.warn(`Cannot add actor UID of ${t} Rendering Engine has been destroyed`);if(!t||!n)throw new Error("Actors should have uid and vtk Actor properties");if(this.getActor(t))return void console.warn(`Actor ${t} already exists for this viewport`);const i=this.getRenderer();i?.addActor(n),this._actors.set(t,Object.assign({},e)),this.updateCameraClippingPlanesAndRange()}removeAllActors(){this.getRenderer()?.removeAllViewProps(),this._actors=new Map}resetCameraNoEvent(){this._suppressCameraModifiedEvents=!0,this.resetCamera(),this._suppressCameraModifiedEvents=!1}setCameraNoEvent(e){this._suppressCameraModifiedEvents=!0,this.setCamera(e),this._suppressCameraModifiedEvents=!1}_getViewImageDataIntersections(e,t,n){const r=n[0],i=n[1],o=n[2],a=r*t[0]+i*t[1]+o*t[2],s=e.getBounds(),l=this._getEdges(s),c=[];for(const e of l){const[[t,n,l],[u,d,p]]=e;if(r*(u-t)+i*(d-n)+o*(p-l)==0)continue;const h=f.linePlaneIntersection([t,n,l],[u,d,p],[r,i,o,a]);this._isInBounds(h,s)&&c.push(h)}return c}setInterpolationType(e,t){}setDisplayArea(e,t=!1){if(!e)return;const{storeAsInitialCamera:n,type:r}=e;n&&(this.options.displayArea=e);const{_suppressCameraModifiedEvents:i}=this;if(this._suppressCameraModifiedEvents=!0,this.setCamera(this.fitToCanvasCamera),"SCALE"===r?this.setDisplayAreaScale(e):(this.setInterpolationType(this.getProperties()?.interpolationType??v.InterpolationType.LINEAR),this.setDisplayAreaFit(e)),n&&(this.initialCamera=this.getCamera()),this._suppressCameraModifiedEvents=i,!t&&!i){const t={viewportId:this.id,displayArea:e,storeAsInitialCamera:n};(0,p.A)(this.element,s.A.DISPLAY_AREA_MODIFIED,t),this.setCamera(this.getCamera())}}setDisplayAreaScale(e){const{scale:t=1}=e,n=this.canvas,r=n.height,i=n.width;if(r<8||i<8)return;const o=this.getDefaultImageData().getSpacing()[1];this.setInterpolationType(v.InterpolationType.NEAREST),this.setCamera({parallelScale:r*o/(2*t)}),delete e.imageArea,this.setDisplayAreaFit(e);const{focalPoint:s,position:l,viewUp:c,viewPlaneNormal:u}=this.getCamera(),d=a.eR.create();if(n.height%2&&a.eR.scaleAndAdd(d,d,c,.5*t*o),n.width%2){const e=a.eR.cross(a.eR.create(),c,u);a.eR.scaleAndAdd(d,d,e,.5*t*o)}(d[0]||d[1]||d[2])&&this.setCamera({focalPoint:a.eR.add(a.eR.create(),s,d),position:a.eR.add(a.eR.create(),l,d)})}setDisplayAreaFit(e){const{imageArea:t,imageCanvasPoint:n}=e,r=window?.devicePixelRatio||1,i=this.getDefaultImageData();if(!i)return;const o=this.sWidth/r,s=this.sHeight/r,l=i.getDimensions(),c=this.worldToCanvas(i.indexToWorld([0,0,0])),u=this.worldToCanvas(i.indexToWorld([l[0],l[1],l[2]])),d=[Math.abs(u[0]-c[0]),Math.abs(u[1]-c[1])],[p,f]=d;let h=this.getZoom()/this.insetImageMultiplier;if(t){const[e,n]=t,r=Math.max(Math.abs(p/o),Math.abs(f/s)),i=Math.abs(e*p/o),a=Math.abs(n*f/s);h=(i>a?r/i:r/a)*this.getZoom()/this.getZoom(this.fitToCanvasCamera),this.setZoom(this.insetImageMultiplier*h,!1)}if(n){const{imagePoint:e,canvasPoint:t=e||[.5,.5]}=n,[r,i]=t,l=o*(r-.5),c=s*(i-.5),[u,d]=e||t,m=h,g=[this.insetImageMultiplier*m*p*(.5-u)+l,this.insetImageMultiplier*m*f*(.5-d)+c];a.Zc.add(g,g,this.getPan()),this.setPan(g,!1)}}getDisplayArea(){return this.options?.displayArea}resetCamera(e){const{resetPan:t=!0,resetZoom:n=!0,resetToCenter:r=!0,storeAsInitialCamera:o=!0}=e||{},a=this.getRenderer();this.setCameraNoEvent({flipHorizontal:!1,flipVertical:!1});const s=this.getCamera(),l=a.computeVisiblePropBounds(),u=[0,0,0],d=this.getDefaultImageData();if(d){const e=d.getSpacing();l[0]=l[0]+e[0]/2,l[1]=l[1]-e[0]/2,l[2]=l[2]+e[1]/2,l[3]=l[3]-e[1]/2,l[4]=l[4]+e[2]/2,l[5]=l[5]-e[2]/2}const p=this.getVtkActiveCamera(),f=p.getViewPlaneNormal(),h=p.getViewUp();if(u[0]=(l[0]+l[1])/2,u[1]=(l[2]+l[3])/2,u[2]=(l[4]+l[5])/2,d){const e=d.getDimensions().map((e=>Math.floor(e/2))),t=[e[0],e[1],e[2]];d.indexToWorld(t,u)}const{widthWorld:m,heightWorld:v}=this._getWorldDistanceViewUpAndViewRight(l,h,f),y=[this.sWidth,this.sHeight],x=m/v/(y[0]/y[1]),A=x<1?this.insetImageMultiplier*v/2:this.insetImageMultiplier*v*x/2,C=b.boundsRadius(l)*(this.type===c.A.VOLUME_3D?10:1),T=this.insetImageMultiplier*C,S=Math.abs(i.Ay.dot(h,f))>.999?[-h[2],h[0],h[1]]:h,w=this._getFocalPointForResetCamera(u,s,{resetPan:t,resetToCenter:r}),_=[w[0]+T*f[0],w[1]+T*f[1],w[2]+T*f[2]];a.resetCameraClippingRange(l);const I=[-g.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE,g.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE];p.setPhysicalScale(C),p.setPhysicalTranslation(-w[0],-w[1],-w[2]),this.setCamera({parallelScale:n?A:s.parallelScale,focalPoint:w,position:_,viewAngle:90,viewUp:S,clippingRange:I});const E=this.getCamera();this.setFitToCanvasCamera(this.getCamera()),o&&this.setInitialCamera(E),n&&this.setZoom(1,o);const D={type:"ResetCameraEvent",renderer:a};return a.invokeEvent(D),this.triggerCameraModifiedEventIfNecessary(s,E),d&&this.options.displayArea&&n&&t&&r&&this.setDisplayArea(this.options.displayArea),!0}setInitialCamera(e){this.initialCamera=e}setFitToCanvasCamera(e){this.fitToCanvasCamera=e}getPan(e=this.initialCamera){if(!e)return[0,0];const t=this.getVtkActiveCamera().getFocalPoint(),n=this.canvasToWorld([0,0]),r=this.worldToCanvas(a.eR.subtract([0,0,0],e.focalPoint,n)),i=this.worldToCanvas(a.eR.subtract([0,0,0],t,n));return a.Zc.subtract([0,0],r,i)}getCurrentImageIdIndex(){throw new Error("Not implemented")}getSliceIndex(){throw new Error("Not implemented")}getImageData(){throw new Error("Not implemented")}getViewReferenceId(e){return null}setPan(e,t=!1){const n=this.getCamera(),{focalPoint:r,position:i}=n,o=this.canvasToWorld([0,0]),s=a.Zc.subtract([0,0],e,this.getPan());if(Math.abs(s[0])<1&&Math.abs(s[1])<1&&!t)return;const l=a.eR.subtract(a.eR.create(),this.canvasToWorld(s),o),c=a.eR.subtract(a.eR.create(),r,l),u=a.eR.subtract(a.eR.create(),i,l);this.setCamera({...n,focalPoint:c,position:u},t)}getZoom(e=this.initialCamera){if(!e)return 1;const t=this.getVtkActiveCamera(),{parallelScale:n}=e;return n/t.getParallelScale()}setZoom(e,t=!1){const n=this.getCamera(),{parallelScale:r}=this.initialCamera,i=r/e;(n.parallelScale!==i||t)&&this.setCamera({...n,parallelScale:i},t)}_getFocalPointForViewPlaneReset(e){const{focalPoint:t,viewPlaneNormal:n}=this.getCamera(),r=this._getViewImageDataIntersections(e,t,n);let i=0,o=0,a=0;r.forEach((([e,t,n])=>{i+=e,o+=t,a+=n}));return[i/r.length,o/r.length,a/r.length]}getCanvas(){return this.canvas}getVtkActiveCamera(){const e=this.getRenderer();return e?e.getActiveCamera():(console.warn("No renderer found for the viewport"),null)}getCameraNoRotation(){const e=this.getVtkActiveCamera(),t=(e,t)=>e.some((e=>isNaN(e)))?t:e;return{viewUp:t([...e.getViewUp()],[0,1,0]),viewPlaneNormal:t([...e.getViewPlaneNormal()],[0,0,-1]),position:t([...e.getPosition()],[0,0,1]),focalPoint:t([...e.getFocalPoint()],[0,0,0]),parallelProjection:e.getParallelProjection(),parallelScale:e.getParallelScale(),viewAngle:e.getViewAngle(),flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical}}getCamera(){return{...this.getCameraNoRotation(),rotation:this.getRotation()}}setCamera(e,t=!1){const n=this.getVtkActiveCamera(),r=this.getCamera(),o=Object.assign({},r,e),{viewUp:a,viewPlaneNormal:s,position:l,focalPoint:u,parallelScale:p,viewAngle:f,flipHorizontal:m,flipVertical:g,clippingRange:v}=e;if(void 0!==m){const e=m&&!this.flipHorizontal||!m&&this.flipHorizontal;e&&this.flip({flipHorizontal:e})}if(void 0!==g){const e=g&&!this.flipVertical||!g&&this.flipVertical;e&&this.flip({flipVertical:e})}void 0!==a&&n.setViewUp(a),void 0!==s&&n.setDirectionOfProjection(-s[0],-s[1],-s[2]),void 0!==l&&n.setPosition(...l),void 0!==u&&n.setFocalPoint(...u),void 0!==p&&n.setParallelScale(p),void 0!==f&&n.setViewAngle(f),void 0!==v&&n.setClippingRange(v);const y=r.focalPoint,b=r.viewUp;if(y&&u||b&&a){const e=n.getViewPlaneNormal(),t=n.getViewUp();let r=!1,s=!1;if(u){const t=[u[0]-y[0],u[1]-y[1],u[2]-y[2]];r=Math.abs(i.Ay.dot(t,e))>0}if(a&&(s=!(0,h.Ay)(t,b)),r||s){const e=this.getDefaultActor();if(!e?.actor)return;if((0,d.N)(e,"vtkActor")||this.updateClippingPlanesForActors(o),(0,d.N)(e,"vtkImageSlice")||this.type===c.A.VOLUME_3D){this.getRenderer().resetCameraClippingRange()}}}t&&this.setInitialCamera(o),this.triggerCameraModifiedEventIfNecessary(r,this.getCamera())}triggerCameraModifiedEventIfNecessary(e,t){if(!this._suppressCameraModifiedEvents&&!this.suppressEvents){const n={previousCamera:e,camera:t,element:this.element,viewportId:this.id,renderingEngineId:this.renderingEngineId};(0,p.A)(this.element,s.A.CAMERA_MODIFIED,n)}}updateCameraClippingPlanesAndRange(){const e=this.getCamera();this.updateClippingPlanesForActors(e),this.getRenderer().resetCameraClippingRange()}async updateClippingPlanesForActors(e){this.getActors().map((t=>{if(!t.actor)return;const n=t.actor.getMapper();let r=t?.clippingFilter?t?.clippingFilter.getClippingPlanes():n.getClippingPlanes();0===r.length&&t?.clippingFilter&&(r=[o.Ay.newInstance(),o.Ay.newInstance()]);let i=g.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS;t.slabThickness&&(i=t.slabThickness);const{viewPlaneNormal:a,focalPoint:l}=e;this.setOrientationOfClippingPlanes(r,i,a,l),(0,p.A)(this.element,s.A.CLIPPING_PLANES_UPDATED,{actorEntry:t,focalPoint:l,vtkPlanes:r,viewport:this})}))}setOrientationOfClippingPlanes(e,t,n,r){if(e.length<2)return;const o=[n[0],n[1],n[2]];i.Ay.multiplyScalar(o,t),e[0].setNormal(n);const a=[0,0,0];i.Ay.subtract(r,o,a),e[0].setOrigin(a),e[1].setNormal(-n[0],-n[1],-n[2]);const s=[0,0,0];i.Ay.add(r,o,s),e[1].setOrigin(s)}getClippingPlanesForActor(e){if(e||(e=this.getDefaultActor()),!e.actor)throw new Error("Invalid actor entry: Actor is undefined");const t=e.actor.getMapper();let n=e?.clippingFilter?e?.clippingFilter.getClippingPlanes():t.getClippingPlanes();return 0===n.length&&e?.clippingFilter&&(n=[o.Ay.newInstance(),o.Ay.newInstance()]),n}_getWorldDistanceViewUpAndViewRight(e,t,n){const i=this._getCorners(e),o=this._getCorners(e),s=a.eR.cross(a.eR.create(),t,n);let l=r.A.buildFromDegree().identity().rotateFromDirections(t,[1,0,0]);i.forEach((e=>l.apply(e)));let c=1/0,u=-1/0;for(let e=0;e<8;e++){const t=i[e][0];t>u&&(u=t),t<c&&(c=t)}l=r.A.buildFromDegree().identity().rotateFromDirections([s[0],s[1],s[2]],[1,0,0]),o.forEach((e=>l.apply(e)));let d=1/0,p=-1/0;for(let e=0;e<8;e++){const t=o[e][0];t>p&&(p=t),t<d&&(d=t)}return{widthWorld:p-d,heightWorld:u-c}}getViewReference(e){const{focalPoint:t,viewPlaneNormal:n,viewUp:r}=this.getCamera();return{FrameOfReferenceUID:this.getFrameOfReferenceUID(),cameraFocalPoint:t,viewPlaneNormal:n,viewUp:r,sliceIndex:e?.sliceIndex??this.getSliceIndex()}}isReferenceViewable(e,t){if(e.FrameOfReferenceUID&&e.FrameOfReferenceUID!==this.getFrameOfReferenceUID())return!1;const{viewPlaneNormal:n}=e,r=this.getCamera();return!(n&&!(0,h.Ay)(n,r.viewPlaneNormal)&&!(0,h.Ay)(a.eR.negate(r.viewPlaneNormal,r.viewPlaneNormal),n))||t?.withOrientation}getViewPresentation(e={rotation:!0,displayArea:!0,zoom:!0,pan:!0,flipHorizontal:!0,flipVertical:!0}){const t={},{rotation:n,displayArea:r,zoom:i,pan:o,flipHorizontal:s,flipVertical:l}=e;n&&(t.rotation=this.getRotation()),r&&(t.displayArea=this.getDisplayArea());const c=this.getZoom();return i&&(t.zoom=c),o&&(t.pan=this.getPan(),a.Zc.scale(t.pan,t.pan,1/c)),s&&(t.flipHorizontal=this.flipHorizontal),l&&(t.flipVertical=this.flipVertical),t}setViewReference(e){}setViewPresentation(e){if(!e)return;const{displayArea:t,zoom:n=this.getZoom(),pan:r,rotation:i,flipHorizontal:o=this.flipHorizontal,flipVertical:s=this.flipVertical}=e;t!==this.getDisplayArea()&&this.setDisplayArea(t),this.setZoom(n),r&&this.setPan(a.Zc.scale([0,0],r,n)),i>=0&&this.setRotation(i),void 0!==o&&o!==this.flipHorizontal&&this.flip({flipHorizontal:o}),void 0!==s&&s!==this.flipVertical&&this.flip({flipVertical:s})}_getCorners(e){return[[e[0],e[2],e[4]],[e[0],e[2],e[5]],[e[0],e[3],e[4]],[e[0],e[3],e[5]],[e[1],e[2],e[4]],[e[1],e[2],e[5]],[e[1],e[3],e[4]],[e[1],e[3],e[5]]]}_getFocalPointForResetCamera(e,t,{resetPan:n=!0,resetToCenter:r=!0}){if(r&&n)return e;if(r&&!n)return(0,m.A)(t.focalPoint)?e:t.focalPoint;if(!r&&n){const n=t,r=n.focalPoint,i=n.viewPlaneNormal,o=a.eR.subtract(a.eR.create(),e,r),s=a.eR.dot(o,i),l=a.eR.scaleAndAdd(a.eR.create(),e,i,-1*s);return[l[0],l[1],l[2]]}return n||r?void 0:(0,m.A)(t.focalPoint)?e:t.focalPoint}_isInBounds(e,t){const[n,r,i,o,a,s]=t,[l,c,u]=e;return!(l<n||l>r||c<i||c>o||u<a||u>s)}_getEdges(e){const[t,n,r,i,o,a,s,l]=this._getCorners(e);return[[t,n],[t,o],[t,r],[n,i],[n,a],[r,i],[r,s],[i,l],[o,s],[o,a],[a,l],[s,l]]}static boundsRadius(e){const t=(e[1]-e[0])**2,n=(e[3]-e[2])**2,r=(e[5]-e[4])**2;return.5*Math.sqrt(t+n+r||1)}setDataIds(e,t){throw new Error("Unsupported operatoin setDataIds")}}const x=b},94155:(e,t,n)=>{"use strict";n.d(t,{A:()=>C});var r=n(3823),i=n(75127),o=n(49038),a=n(19325),s=n(71851),l=n(98039),c=n(88619),u=n(20537),d=n(85008),p=n(80500),f=n(69372),h=n(46347),m=n(89821),g=n(85745),v=n(47476),y=n(51919),b=n(94741);var x=n(61375);class A extends h.A{constructor(e){super(e),this._useAcquisitionPlaneForViewPlane=!1,this.getNumberOfSlices=()=>{const{numberOfSlices:e}=(0,v.A)(this)||{};return e},this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,resetRotation:!1,suppressEvents:!0}),this.getCurrentImageIdIndex=(e,t=!0)=>{const{currentStepIndex:n}=(0,x.A)(this,e||this.getVolumeId(),t);return n},this.getSliceIndex=()=>{const{imageIndex:e}=(0,v.A)(this)||{};return e},this.getCurrentImageId=()=>{const e=this.getDefaultActor();if(!e||!(0,l.N)(e,"vtkVolume"))return;const t=o.Ay.getVolume(this.getVolumeId());if(!t)return;const{viewPlaneNormal:n,focalPoint:r}=this.getCamera();return(0,c.A)(t,r,n)},this.getSlicePlaneCoordinates=()=>{const e=this.getDefaultActor();if(!e?.actor)return console.warn("No image data found for calculating vtkPlanes."),[];const t=this.getVolumeId(),n=o.Ay.getVolume(t),r=this.getCamera(),{focalPoint:i,position:a,viewPlaneNormal:s}=r,l=(0,d.A)(n,s),c=(0,u.A)(e.actor,s,i),f=Math.round((c.current-c.min)/l),h=Math.round((c.max-c.current)/l),m=this.getSliceIndex(),g=[];for(let e=-f;e<=h;e++){const{newFocalPoint:t}=(0,p.A)(i,a,c,s,l,e);g.push({sliceIndex:m+e,point:t})}return g};const{orientation:t}=this.options;t&&t!==s.OrientationAxis.ACQUISITION?this.applyViewOrientation(t):this._useAcquisitionPlaneForViewPlane=!0}async setVolumes(e,t=!1,n=!1){const r=o.Ay.getVolume(e[0].volumeId);if(!r)throw new Error(`imageVolume with id: ${r.volumeId} does not exist`);return this._useAcquisitionPlaneForViewPlane&&(this._setViewPlaneToAcquisitionPlane(r),this._useAcquisitionPlaneForViewPlane=!1),super.setVolumes(e,t,n)}async addVolumes(e,t=!1,n=!1){const r=o.Ay.getVolume(e[0].volumeId);if(!r)throw new Error(`imageVolume with id: ${r.volumeId} does not exist`);return this._useAcquisitionPlaneForViewPlane&&(this._setViewPlaneToAcquisitionPlane(r),this._useAcquisitionPlaneForViewPlane=!1),super.addVolumes(e,t,n)}jumpToWorld(e){const{focalPoint:t}=this.getCamera(),n=[0,0,0];r.eR.sub(n,e,t);const i=this.getCamera(),o=i.viewPlaneNormal,a=r.eR.dot(n,o),s=r.eR.fromValues(o[0],o[1],o[2]);if(r.eR.scale(s,s,a),Math.abs(s[0])>.001||Math.abs(s[1])>.001||Math.abs(s[2])>.001){const e=[0,0,0],t=[0,0,0];r.eR.add(e,i.focalPoint,s),r.eR.add(t,i.position,s),this.setCamera({focalPoint:e,position:t}),this.render()}return!0}setOrientation(e,t=!0){let n,r;if("string"==typeof e){if(a.MPR_CAMERA_VALUES[e])({viewPlaneNormal:n,viewUp:r}=a.MPR_CAMERA_VALUES[e]);else{if("acquisition"!==e)throw new Error(`Invalid orientation: ${e}. Use Enums.OrientationAxis instead.`);({viewPlaneNormal:n,viewUp:r}=this._getAcquisitionPlaneOrientation())}this.setCamera({viewPlaneNormal:n,viewUp:r}),this.viewportProperties.orientation=e,this.resetCamera()}else({viewPlaneNormal:n,viewUp:r}=e),this.applyViewOrientation(e);t&&this.render()}setCameraClippingRange(){const e=this.getVtkActiveCamera();e?e.getParallelProjection()?e.setClippingRange(-a.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE,a.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE):e.setClippingRange(a.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS,a.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE):console.warn("No active camera found")}_getAcquisitionPlaneOrientation(){if(!this.getDefaultActor())return;const e=this.getVolumeId(),t=o.Ay.getVolume(e);if(!t)throw new Error(`imageVolume with id: ${e} does not exist in cache`);const{direction:n}=t;return{viewPlaneNormal:n.slice(6,9).map((e=>-e)),viewUp:n.slice(3,6).map((e=>-e))}}_setViewPlaneToAcquisitionPlane(e){let t,n;if(e){const{direction:r}=e;t=r.slice(6,9).map((e=>-e)),n=r.slice(3,6).map((e=>-e))}else({viewPlaneNormal:t,viewUp:n}=this._getAcquisitionPlaneOrientation());this.setCamera({viewPlaneNormal:t,viewUp:n}),this.initialViewUp=n,this.resetCamera()}getBlendMode(e){const t=this.getActors(),n=e?.length>0?t.find((t=>e.includes(t.uid))):t[0];return n?.blendMode||n?.actor.getMapper().getBlendMode()}setBlendMode(e,t=[],n=!1){let r=this.getActors();t?.length>0&&(r=r.filter((e=>t.includes(e.uid)))),r.forEach((t=>{const{actor:n}=t,r=n.getMapper();r.setBlendMode?.(e),t.blendMode=e})),n&&this.render()}resetCamera(e){const{resetPan:t=!0,resetZoom:n=!0,resetRotation:r=!0,resetToCenter:o=!0,suppressEvents:l=!1,resetOrientation:c=!0}=e||{},{orientation:u}=this.viewportProperties;u&&c&&this.applyViewOrientation(u,!1),super.resetCamera({resetPan:t,resetZoom:n,resetToCenter:o});const d=this.getVtkActiveCamera(),p=d.getViewPlaneNormal(),h=d.getFocalPoint();if(this.getActors().forEach((e=>{if(!e.actor)return;const t=e.actor.getMapper();if(0===t.getClippingPlanes().length&&!e?.clippingFilter){const n=i.Ay.newInstance(),r=i.Ay.newInstance(),o=[n,r];let s=a.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS;e.slabThickness&&(s=e.slabThickness),this.setOrientationOfClippingPlanes(o,s,p,h),t.addClippingPlane(n),t.addClippingPlane(r)}})),r&&void 0!==a.MPR_CAMERA_VALUES[this.viewportProperties.orientation]){const e=a.MPR_CAMERA_VALUES[this.viewportProperties.orientation];this.setCameraNoEvent({viewUp:e.viewUp,viewPlaneNormal:e.viewPlaneNormal})}if(!l){const e={viewportId:this.id,camera:this.getCamera(),renderingEngineId:this.renderingEngineId,element:this.element};(0,f.A)(this.element,s.Events.CAMERA_RESET,e)}return!0}setSlabThickness(e,t=[]){e<.1&&(e=.1);let n=this.getActors();t?.length>0&&(n=n.filter((e=>t.includes(e.uid)))),n.forEach((t=>{(0,l.N)(t,"vtkVolume")&&(t.slabThickness=e)}));const r=this.getCamera();this.updateClippingPlanesForActors(r),this.triggerCameraModifiedEventIfNecessary(r,r),this.viewportProperties.slabThickness=e}resetSlabThickness(){this.getActors().forEach((e=>{(0,l.N)(e,"vtkVolume")&&(e.slabThickness=a.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS)}));const e=this.getCamera();this.updateClippingPlanesForActors(e),this.triggerCameraModifiedEventIfNecessary(e,e),this.viewportProperties.slabThickness=void 0}isInAcquisitionPlane(){const e=this.getImageData();if(!e)return!1;const{direction:t}=e,{viewPlaneNormal:n}=this.getCamera(),i=[t[6],t[7],t[8]];return Math.abs(r.eR.dot(n,i))>.99}getSliceViewInfo(){const{width:e,height:t}=this.getCanvas(),n=(0,y.e)(this,[0,0]),i=(0,y.e)(this,[e-1,0]),o=(0,y.e)(this,[0,t-1]),s=r.eR.sub(r.eR.create(),i,n),l=r.eR.sub(r.eR.create(),o,n),c=r.eR.cross(r.eR.create(),s,l);r.eR.normalize(s,s),r.eR.normalize(l,l),r.eR.normalize(c,c);const{dimensions:u}=this.getImageData(),[d,p,f]=u,h=[[0,0,0],[d-1,0,0],[0,p-1,0],[d-1,p-1,0],[0,0,f-1],[d-1,0,f-1],[0,p-1,f-1],[d-1,p-1,f-1]].map((e=>function(e,t){const{imageData:n}=e.getImageData(),r=(0,b.A)(n,t);return e.worldToCanvas(r)}(this,e))).reduce(((e,t)=>(e.minX=Math.min(e.minX,t[0]),e.minY=Math.min(e.minY,t[1]),e.maxX=Math.max(e.maxX,t[0]),e.maxY=Math.max(e.maxY,t[1]),e)),{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),m=(0,y.e)(this,[h.minX,h.minY]),g=r.pB.fromValues(s[0],s[1],s[2],0,l[0],l[1],l[2],0,c[0],c[1],c[2],0,m[0],m[1],m[2],1),v=(0,y.e)(this,[h.maxX,h.maxY]),x=r.eR.sub(r.eR.create(),v,m),A=r.pB.invert(r.pB.create(),g),{viewPlaneNormal:C}=this.getCamera();if(C.filter((e=>Math.abs(e)>a.EPSILON)).length>1)throw new Error("getSliceInfo is not supported for oblique views");const T=C.findIndex((e=>Math.abs(e)>1-a.EPSILON));if(-1===T)throw new Error("Unable to determine slice axis");const S=r.eR.dot(s,x)+1,w=r.eR.dot(l,x)+1;return{sliceIndex:this.getSliceIndex(),width:S,height:w,slicePlane:T,sliceToIndexMatrix:g,indexToSliceMatrix:A}}getCurrentSlicePixelData(){const{voxelManager:e}=this.getImageData();return e.getSliceData(this.getSliceViewInfo())}getViewReference(e={}){const t=super.getViewReference(e);if(!t?.volumeId)return;const n=o.Ay.getVolume(t.volumeId);return t.referencedImageId=(0,c.A)(n,t.cameraFocalPoint,t.viewPlaneNormal),t}resetProperties(e){this._resetProperties(e)}_resetProperties(e){const t=e?this.getActor(e):this.getDefaultActor();if(!t)throw new Error(`No actor found for the given volumeId: ${e}`);t.slabThickness&&(t.slabThickness=a.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS,this.viewportProperties.slabThickness=void 0,this.updateClippingPlanesForActors(this.getCamera())),e||=this.getVolumeId();const n=o.Ay.getVolume(e);if(!n)throw new Error(`imageVolume with id: ${e} does not exist in cache`);if((0,m.A)(t.actor,n),(0,l.e)(t)){const e=t.actor.getProperty().getRGBTransferFunction(0);(0,g.setTransferFunctionNodes)(e,this.initialTransferFunctionNodes)}const r={...super.getVOIModifiedEventDetail(e)};this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0,resetCameraRotation:!0}),(0,f.A)(this.element,s.Events.VOI_MODIFIED,r)}getSlicesClippingPlanes(){const e=this.getSlicePlaneCoordinates(),{viewPlaneNormal:t}=this.getCamera(),n=a.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS;return e.map((({point:e,sliceIndex:r})=>{const o=[i.Ay.newInstance(),i.Ay.newInstance()];return this.setOrientationOfClippingPlanes(o,n,t,e),{sliceIndex:r,planes:o.map((e=>({normal:e.getNormal(),origin:e.getOrigin()})))}}))}}const C=A},40893:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(19325),i=n(71851),o=n(49038),a=n(89821),s=n(69372),l=n(98039),c=n(85745),u=n(46347);class d extends u.A{constructor(e){super(e),this.getNumberOfSlices=()=>1,this.getRotation=()=>0,this.getCurrentImageIdIndex=()=>0,this.getCurrentImageId=()=>null,this.resetCameraForResize=()=>this.resetCamera({resetPan:!0,resetZoom:!0,resetToCenter:!0});const{parallelProjection:t,orientation:n}=this.options,r=this.getVtkActiveCamera();null!=t&&r.setParallelProjection(t),n&&n!==i.OrientationAxis.ACQUISITION&&this.applyViewOrientation(n)}isInAcquisitionPlane(){return!1}resetCamera({resetPan:e=!0,resetZoom:t=!0,resetToCenter:n=!0}={}){super.resetCamera({resetPan:e,resetZoom:t,resetToCenter:n});const i=this.getVtkActiveCamera();i.getParallelProjection()?i.setClippingRange(-r.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE,r.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE):i.setClippingRange(r.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS,r.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE);return this.getRenderer().resetCameraClippingRange(),!0}setSlabThickness(e,t){return null}setBlendMode(e,t,n){return null}resetProperties(e){const t=e?this.getActor(e):this.getDefaultActor();if(!t)throw new Error(`No actor found for the given volumeId: ${e}`);t.slabThickness&&(t.slabThickness=r.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS,this.viewportProperties.slabThickness=void 0,this.updateClippingPlanesForActors(this.getCamera())),e||=this.getVolumeId();const n=o.Ay.getVolume(e);if(!n)throw new Error(`imageVolume with id: ${e} does not exist in cache`);if((0,a.A)(t.actor,n),(0,l.e)(t)){const e=t.actor.getProperty().getRGBTransferFunction(0);(0,c.setTransferFunctionNodes)(e,this.initialTransferFunctionNodes)}this.setCamera(this.initialCamera),(0,s.A)(this.element,i.Events.VOI_MODIFIED,super.getVOIModifiedEventDetail(e))}getSliceIndex(){return null}setCamera(e){super.setCamera(e),this.getRenderer().resetCameraClippingRange(),this.render()}setCameraClippingRange(){const e=this.getVtkActiveCamera();e.getParallelProjection()?e.setClippingRange(-r.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE,r.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE):e.setClippingRange(r.RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS,r.RENDERING_DEFAULTS.MAXIMUM_RAY_DISTANCE)}resetSlabThickness(){return null}}const p=d},81466:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var r=n(3823),i=n(71851),o=n(80221),a=n(74876),s=n(45354),l=n(10056),c=n(40661),u=n(19325),d=n(69372),p=n(26896),f=n(56577);const h=Symbol.for("map");class m extends l.A{constructor(e){super({...e,canvas:e.canvas||(0,c.oI)(e.element)}),this.internalCamera={rotation:0,centerIndex:[0,0],extent:[0,-2,1,-1],xSpacing:1,ySpacing:1,resolution:1,zoom:1},this.voiRange={lower:0,upper:255},this.getProperties=()=>({}),this.resetCamera=()=>!0,this.getNumberOfSlices=()=>1,this.getFrameOfReferenceUID=()=>this.frameOfReferenceUID,this.resize=()=>{const e=this.canvas,{clientWidth:t,clientHeight:n}=e;e.width===t&&e.height===n||(e.width=t,e.height=n),this.refreshRenderValues()},this.canvasToWorld=e=>{if(!this.metadata)return;const[t,n]=this.canvasToIndex(e),{origin:i,spacing:o,direction:a}=this.getImageData(),s=r.eR.fromValues(0,0,0),l=a.slice(0,3),c=a.slice(3,6);return r.eR.scaleAndAdd(s,i,l,t*o[0]),r.eR.scaleAndAdd(s,s,c,n*o[1]),[s[0],s[1],s[2]]},this.worldToCanvas=e=>{if(!this.metadata)return;const{spacing:t,direction:n,origin:i}=this.metadata,o=n.slice(0,3),a=n.slice(3,6),s=r.eR.subtract([0,0,0],e,i),l=[r.eR.dot(s,o)/t[0],r.eR.dot(s,a)/t[1]];return this.indexToCanvas(l)},this.postrender=()=>{this.refreshRenderValues(),(0,d.A)(this.element,i.Events.IMAGE_RENDERED,{element:this.element,viewportId:this.id,viewport:this,renderingEngineId:this.renderingEngineId})},this.getRotation=()=>0,this.canvasToIndex=e=>{const t=this.getTransform();return t.invert(),t.transformPoint(e.map((e=>e*devicePixelRatio)))},this.indexToCanvas=e=>this.getTransform().transformPoint(e).map((e=>e/devicePixelRatio)),this.customRenderViewportToCanvas=()=>{},this.getImageIds=()=>[this.imageIds[0]],this.renderingEngineId=e.renderingEngineId,this.element.setAttribute("data-viewport-uid",this.id),this.element.setAttribute("data-rendering-engine-uid",this.renderingEngineId),this.element.style.position="relative",this.microscopyElement=document.createElement("div"),this.microscopyElement.setAttribute("class","DicomMicroscopyViewer"),this.microscopyElement.id=(0,o.A)(),this.microscopyElement.innerText="Initial",this.microscopyElement.style.background="grey",this.microscopyElement.style.width="100%",this.microscopyElement.style.height="100%",this.microscopyElement.style.position="absolute",this.microscopyElement.style.left="0",this.microscopyElement.style.top="0";const t=this.element.firstElementChild;t.insertBefore(this.microscopyElement,t.childNodes[1]),this.addEventListeners(),this.addWidget("DicomMicroscopyViewer",{getEnabled:()=>!!this.viewer,setEnabled:()=>{this.elementDisabledHandler()}}),this.resize()}static get useCustomRenderingPipeline(){return!0}addEventListeners(){this.canvas.addEventListener(i.Events.ELEMENT_DISABLED,this.elementDisabledHandler)}removeEventListeners(){this.canvas.removeEventListener(i.Events.ELEMENT_DISABLED,this.elementDisabledHandler)}elementDisabledHandler(){this.removeEventListeners(),this.viewer?.cleanup(),this.viewer=null;this.element.firstElementChild.removeChild(this.microscopyElement),this.microscopyElement=null}getImageDataMetadata(e=0){const t=this.metadataDicomweb.reduce(((e,t)=>e?.NumberOfFrames<t.NumberOfFrames?t:e)),{TotalPixelMatrixColumns:n,TotalPixelMatrixRows:o,ImageOrientationSlide:s,ImagedVolumeWidth:l,ImagedVolumeHeight:c,ImagedVolumeDepth:u}=t,d=a.get(i.MetadataModules.IMAGE_PLANE,this.imageIds[e]);let p=s.slice(0,3),f=s.slice(3,6);null!=p&&null!=f||(p=[1,0,0],f=[0,1,0]);const h=r.eR.fromValues(p[0],p[1],p[2]),m=r.eR.fromValues(f[0],f[1],f[2]),g=r.eR.create();r.eR.cross(g,h,m);const{XOffsetInSlideCoordinateSystem:v=0,YOffsetInSlideCoordinateSystem:y=0,ZOffsetInSlideCoordinateSystem:b=0}=t.TotalPixelMatrixOriginSequence?.[0]||{},x=[v,y,b],A=l/n,C=c/o,T=n,S=o,w=u;return this.hasPixelSpacing=!(!l||!c),{bitsAllocated:8,numberOfComponents:3,origin:x,direction:[...h,...m,...g],dimensions:[T,S,1],spacing:[A,C,w],hasPixelSpacing:this.hasPixelSpacing,numVoxels:T*S*1,imagePlaneModule:d}}async setFrameNumber(e){}setProperties(e){}resetProperties(){this.setProperties({})}getScalarData(){return null}getImageData(){const{metadata:e}=this;if(!e)return null;const{spacing:t}=e,n={getDirection:()=>e.direction,getDimensions:()=>e.dimensions,getRange:()=>[0,255],getScalarData:()=>this.getScalarData(),getSpacing:()=>e.spacing,worldToIndex:e=>{const t=this.worldToCanvas(e),n=this.canvasToIndex(t);return[n[0],n[1],0]},indexToWorld:e=>{const t=this.indexToCanvas([e[0],e[1]]);return this.canvasToWorld(t)}};return{dimensions:e.dimensions,spacing:t,numberOfComponents:3,origin:e.origin,direction:e.direction,metadata:{Modality:this.modality,FrameOfReferenceUID:this.frameOfReferenceUID},hasPixelSpacing:this.hasPixelSpacing,calibration:this.calibration,preScale:{scaled:!1},scalarData:this.getScalarData(),imageData:n,voxelManager:{forEach:(e,t)=>(0,f.ii)(t.imageData,{pointInShapeFn:t.isInObject??(()=>!0),callback:e,boundsIJK:t.boundsIJK,returnPoints:t.returnPoints??!1})}}}hasImageURI(e){return!0}setCamera(e){const t=this.getCamera(),{parallelScale:n,focalPoint:r}=e,i=this.getView(),{xSpacing:o}=this.internalCamera;if(n){const e=1/o/(this.element.clientHeight/n);i.setResolution(e)}if(r){const e=this.worldToCanvas(r),t=this.canvasToIndex(e);i.setCenter(t)}const a=this.getCamera();this.triggerCameraModifiedEventIfNecessary(t,a)}getCurrentImageId(){return this.imageIds[0]}getFrameNumber(){return 1}getCamera(){this.refreshRenderValues();const{resolution:e,xSpacing:t}=this.internalCamera,n=e*t,r=[this.element.clientWidth/2,this.element.clientHeight/2],i=this.canvasToWorld(r);return{parallelProjection:!0,focalPoint:i,position:i,viewUp:[0,-1,0],parallelScale:this.element.clientHeight*n,viewPlaneNormal:[0,0,1]}}static{this.getDicomMicroscopyViewer=async()=>(0,p.a)("dicom-microscopy-viewer")}setDataIds(e,t){!1!==t?.miniNavigationOverlay&&m.addMiniNavigationOverlayCss();const n=t?.webClient||a.get(i.MetadataModules.WADO_WEB_CLIENT,e[0]);if(!n)throw new Error(`To use setDataIds on WSI data, you must provide metaData.webClient for ${e[0]}`);return this.setWSI(e,n)}async setWSI(e,t){this.microscopyElement.style.background="black",this.microscopyElement.innerText="Loading",this.imageIds=e;const n=await m.getDicomMicroscopyViewer();this.frameOfReferenceUID=null;const r=this.imageIds.map((e=>{const n=t.getDICOMwebMetadata(e);Object.defineProperty(n,"isMultiframe",{value:n.isMultiframe,enumerable:!1}),Object.defineProperty(n,"frameNumber",{value:void 0,enumerable:!1});const r=n["00080008"]?.Value;1===r?.length&&(n["00080008"].Value=r[0].split("\\"));const i=n["00200052"]?.Value?.[0];return this.frameOfReferenceUID?i!==this.frameOfReferenceUID&&(n["00200052"].Value=[this.frameOfReferenceUID]):this.frameOfReferenceUID=i,n})),i=[];r.forEach((e=>{const t=new n.metadata.VLWholeSlideMicroscopyImage({metadata:e}),r=t.ImageType[2];"VOLUME"===r||"THUMBNAIL"===r?i.push(t):console.log("Unknown image type",t.ImageType)})),this.metadataDicomweb=i;const o=new n.viewer.VolumeImageViewer({client:t,metadata:i,controls:["overview","position"],retrieveRendered:!1,bindings:{}});o.render({container:this.microscopyElement}),this.metadata=this.getImageDataMetadata(),o.deactivateDragPanInteraction(),this.viewer=o,this.map=o[h],this.map.on("postrender",this.postrender),this.resize(),this.microscopyElement.innerText="",Object.assign(this.microscopyElement.style,{"--ol-partial-background-color":"rgba(127, 127, 127, 0.7)","--ol-foreground-color":"#000000","--ol-subtle-foreground-color":"#000","--ol-subtle-background-color":"rgba(78, 78, 78, 0.5)",background:"none"})}scroll(e){const t=this.getCamera();this.setCamera({parallelScale:t.parallelScale*(1+.1*e)})}getSliceIndex(){return 0}getView(){if(!this.viewer)return;const e=this.viewer[h],t=window;return t.map=e,t.viewer=this.viewer,t.view=e?.getView(),t.wsi=this,e?.getView()}refreshRenderValues(){const e=this.getView();if(!e)return;const t=e.getResolution();if(!t||t<u.EPSILON)return;const n=e.getCenter(),r=e.getProjection().getExtent(),i=e.getRotation(),o=e.getZoom(),{metadata:{spacing:[a,s]}}=this,l=1/t/a;Object.assign(this.internalCamera,{extent:r,centerIndex:n,worldToCanvasRatio:l,xSpacing:a,ySpacing:s,resolution:t,rotation:i,zoom:o})}getZoom(){return this.getView()?.getZoom()}setZoom(e){this.getView()?.setZoom(e)}getTransform(){this.refreshRenderValues();const{centerIndex:e,resolution:t,rotation:n}=this.internalCamera,r=[this.canvas.width/2,this.canvas.height/2],i=new s.d;return i.translate(r[0],r[1]),i.rotate(n),i.scale(1/t,-1/t),i.translate(-e[0],-e[1]),i}getViewReferenceId(){return`imageId:${this.getCurrentImageId()}`}getCurrentImageIdIndex(){return 0}static{this.overlayCssId="overlayCss"}static addMiniNavigationOverlayCss(){if(document.getElementById(this.overlayCssId))return;const e=document.createElement("style");e.innerText="\n.DicomMicroscopyViewer {\n  --ol-partial-background-color: rgba(127, 127, 127, 0.7);\n  --ol-foreground-color: #000000;\n  --ol-subtle-foreground-color: #000;\n  --ol-subtle-background-color: rgba(78, 78, 78, 0.5);\n}\n\n.DicomMicroscopyViewer .ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.DicomMicroscopyViewer .ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.DicomMicroscopyViewer .ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.DicomMicroscopyViewer .ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.DicomMicroscopyViewer .ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.DicomMicroscopyViewer .ol-scale-bar-inner {\n  display: flex;\n}\n\n.DicomMicroscopyViewer .ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.DicomMicroscopyViewer .ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow:\n    -1.5px 0 var(--ol-partial-background-color),\n    0 1.5px var(--ol-partial-background-color),\n    1.5px 0 var(--ol-partial-background-color),\n    0 -1.5px var(--ol-partial-background-color);\n}\n\n.DicomMicroscopyViewer .ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow:\n    -1.5px 0 var(--ol-partial-background-color),\n    0 1.5px var(--ol-partial-background-color),\n    1.5px 0 var(--ol-partial-background-color),\n    0 -1.5px var(--ol-partial-background-color);\n}\n\n.DicomMicroscopyViewer .ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.DicomMicroscopyViewer .ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.DicomMicroscopyViewer .ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.DicomMicroscopyViewer .ol-unsupported {\n  display: none;\n}\n\n.DicomMicroscopyViewer .ol-viewport,\n.DicomMicroscopyViewer .ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.DicomMicroscopyViewer .ol-viewport canvas {\n  all: unset;\n}\n\n.DicomMicroscopyViewer .ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.DicomMicroscopyViewer .ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.DicomMicroscopyViewer .ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.DicomMicroscopyViewer .ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.DicomMicroscopyViewer .ol-zoom {\n  top: 0.5em;\n  left: 0.5em;\n}\n\n.DicomMicroscopyViewer .ol-rotate {\n  top: 0.5em;\n  right: 0.5em;\n  transition:\n    opacity 0.25s linear,\n    visibility 0s linear;\n}\n\n.DicomMicroscopyViewer .ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition:\n    opacity 0.25s linear,\n    visibility 0s linear 0.25s;\n}\n\n.DicomMicroscopyViewer .ol-zoom-extent {\n  top: 4.643em;\n  left: 0.5em;\n}\n\n.DicomMicroscopyViewer .ol-full-screen {\n  right: 0.5em;\n  top: 0.5em;\n}\n\n.DicomMicroscopyViewer .ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: 0.4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.DicomMicroscopyViewer .ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.DicomMicroscopyViewer .ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.DicomMicroscopyViewer .ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.DicomMicroscopyViewer .ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.DicomMicroscopyViewer .ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.DicomMicroscopyViewer .ol-control button:hover,\n.DicomMicroscopyViewer .ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.DicomMicroscopyViewer .ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.DicomMicroscopyViewer .ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.DicomMicroscopyViewer .ol-attribution {\n  text-align: right;\n  bottom: 0.5em;\n  right: 0.5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.DicomMicroscopyViewer .ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.DicomMicroscopyViewer .ol-attribution ul {\n  margin: 0;\n  padding: 1px 0.5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.DicomMicroscopyViewer .ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.DicomMicroscopyViewer .ol-attribution li:not(:last-child):after {\n  content: ' ';\n}\n\n.DicomMicroscopyViewer .ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.DicomMicroscopyViewer .ol-attribution button {\n  flex-shrink: 0;\n}\n\n.DicomMicroscopyViewer .ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.DicomMicroscopyViewer .ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible img {\n  margin-top: -0.2em;\n  max-height: 1.6em;\n}\n\n.DicomMicroscopyViewer .ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.DicomMicroscopyViewer .ol-zoomslider {\n  top: 4.5em;\n  left: 0.5em;\n  height: 200px;\n}\n\n.DicomMicroscopyViewer .ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.DicomMicroscopyViewer .ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.DicomMicroscopyViewer .ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.DicomMicroscopyViewer .ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-map,\n.DicomMicroscopyViewer .ol-overviewmap button {\n  display: block;\n}\n\n.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.DicomMicroscopyViewer .ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.DicomMicroscopyViewer .ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.DicomMicroscopyViewer .ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.DicomMicroscopyViewer .ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.DicomMicroscopyViewer .ol-overviewmap-box {\n  border: 0.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.DicomMicroscopyViewer .ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n\n@layout-header-background: #007ea3;\n@primary-color: #007ea3;\n@processing-color: #8cb8c6;\n@success-color: #3f9c35;\n@warning-color: #eeaf30;\n@error-color: #96172e;\n@font-size-base: 14px;\n\n.DicomMicroscopyViewer .ol-tooltip {\n  font-size: 16px !important;\n}\n",e.setAttribute("id",this.overlayCssId),document.getElementsByTagName("head")[0].append(e)}}const g=m},39536:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a,lD:()=>i,qO:()=>o});var r=n(5862);function i(e){return r.A.get(e)}function o(){return r.A.getAll()}const a=i},12132:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const r={viewport:{}};var i=n(71851);function o(){const e={tlhc:{x:1,y:1},brhc:{x:1,y:1},rowPixelSpacing:1,columnPixelSpacing:1,presentationSizeMode:"NONE"},t={scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0,voiLUTFunction:i.VOILUTFunctionType.LINEAR},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:e};return Object.assign({},t,r.viewport)}},23681:(e,t,n)=>{"use strict";function r(e,t){const n=e.renderingTools.lastRenderedImageId,r=e.renderingTools.lastRenderedViewport;return t.imageId!==n||!r||r.windowCenter!==e.viewport.voi.windowCenter||r.windowWidth!==e.viewport.voi.windowWidth||r.invert!==e.viewport.invert||r.rotation!==e.viewport.rotation||r.hflip!==e.viewport.hflip||r.vflip!==e.viewport.vflip||r.modalityLUT!==e.viewport.modalityLUT||r.voiLUT!==e.viewport.voiLUT||r.colormap!==e.viewport.colormap}n.d(t,{A:()=>r})},57162:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(15528),i=n(62596);function o(e,t,n=null){(0,r.C)(e,"getImageScale: parameter canvas must not be undefined"),(0,r.C)(t,"getImageScale: parameter image must not be undefined");const o=(0,i.A)(t,n),a=t.rowPixelSpacing||1,s=t.columnPixelSpacing||1;let l=1,c=1;a<s?c=s/a:l=a/s;const u=e.height/o.height/l,d=e.width/o.width/c;return{verticalScale:u,horizontalScale:d,scaleFactor:Math.min(d,u)}}},62596:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(15528);function i(e,t=null){return(0,r.C)(e,"getImageSize: parameter image must not be undefined"),(0,r.C)(e.width,"getImageSize: parameter image must have width"),(0,r.C)(e.height,"getImageSize: parameter image must have height"),function(e){return!(null==e||0===e||180===e)}(t)?{height:e.width,width:e.height}:{width:e.width,height:e.height}}},19704:(e,t,n)=>{"use strict";function r(e,t){if(function(e){const t=e.voiLUT&&e.voiLUT.lut&&e.voiLUT.lut.length>0;return t||void 0!==e.voi.windowWidth&&void 0!==e.voi.windowCenter}(e))return;const n=t.maxPixelValue*t.slope+t.intercept,r=t.minPixelValue*t.slope+t.intercept,i=n-r,o=(n+r)/2;void 0===e.voi?e.voi={windowWidth:i,windowCenter:o,voiLUTFunction:t.voiLUTFunction}:(e.voi.windowWidth=i,e.voi.windowCenter=o)}function i(e,t){return!e&&!t||!(!e||!t)&&e.id===t.id}n.d(t,{A:()=>a});var o=n(44333);function a(e,t,n){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&i(e.cachedLut.modalityLUT,t.modalityLUT)&&i(e.cachedLut.voiLUT,t.voiLUT)&&e.cachedLut.invert===t.invert&&!n||(r(t,e),function(e,t,n,r,i,a){const s=e.maxPixelValue,l=e.minPixelValue,c=Math.min(l,0);if(void 0===e.cachedLut){const t=s-c+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(t)}const u=e.cachedLut.lutArray,d=function(e,t,n){return n?function(e){const t=e.lut[0],n=e.lut[e.lut.length-1],r=e.firstValueMapped+e.lut.length;return i=>i<e.firstValueMapped?t:i>=r?n:e.lut[i]}(n):function(e,t){return n=>n*e+t}(e,t)}(e.slope,e.intercept,i),p=(0,o.A)(t,n,a);if(e.isPreScaled)if(r)for(let e=l;e<=s;e++)u[e+-c]=255-p(e);else for(let e=l;e<=s;e++)u[e+-c]=p(e);else if(r)for(let e=l;e<=s;e++)u[e+-c]=255-p(d(e));else for(let e=l;e<=s;e++)u[e+-c]=p(d(e))}(e,t.voi.windowWidth,t.voi.windowCenter,t.invert,t.modalityLUT,t.voiLUT),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert,e.cachedLut.voiLUT=t.voiLUT,e.cachedLut.modalityLUT=t.modalityLUT),e.cachedLut.lutArray}},44333:(e,t,n)=>{"use strict";function r(e,t,n){return n?function(e){const t=Math.max(...e.lut).toString(2).length-8,n=e.lut[0]>>t,r=e.lut[e.lut.length-1]>>t,i=e.firstValueMapped+e.lut.length-1;return function(o){return o<e.firstValueMapped?n:o>=i?r:e.lut[o-e.firstValueMapped]>>t}}(n):function(e,t){return function(n){const r=255*((n-(t-.5))/(e-1)+.5);return Math.min(Math.max(r,0),255)}}(e,t)}n.d(t,{A:()=>r})},27810:(e,t,n)=>{"use strict";function r(e,t){const n=e.renderingTools.renderCanvas;n.width=t.width,n.height=t.height;const r=n.getContext("2d");r.fillStyle="white",r.fillRect(0,0,n.width,n.height);const i=r.getImageData(0,0,t.width,t.height);e.renderingTools.renderCanvasContext=r,e.renderingTools.renderCanvasData=i}n.d(t,{A:()=>r})},53586:(e,t,n)=>{"use strict";function r(){return window.performance?performance.now():Date.now()}n.d(t,{A:()=>r})},48080:(e,t,n)=>{"use strict";n.d(t,{f:()=>p});var r=n(53586),i=n(44333);var o=n(79280),a=n(23681),s=n(27810),l=n(81064),c=n(30135);function u(e,t){return void 0!==e.cachedLut&&e.cachedLut.windowCenter===t.voi.windowCenter&&e.cachedLut.windowWidth===t.voi.windowWidth&&e.cachedLut.invert===t.invert||(function(e,t,n,r,o){const a=e.maxPixelValue,s=e.minPixelValue,l=Math.min(s,0);if(void 0===e.cachedLut){const t=a-l+1;e.cachedLut={},e.cachedLut.lutArray=new Uint8ClampedArray(t)}const c=e.cachedLut.lutArray,u=(0,i.A)(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n,o);if(r)for(let e=s;e<=a;e++)c[e+-l]=255-u(e);else for(let e=s;e<=a;e++)c[e+-l]=u(e)}(e,t.voi.windowWidth,t.voi.windowCenter,t.invert),e.cachedLut.windowWidth=t.voi.windowWidth,e.cachedLut.windowCenter=t.voi.windowCenter,e.cachedLut.invert=t.invert),e.cachedLut.lutArray}function d(e,t,n){const i=e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&i||(e.renderingTools.renderCanvas=(0,c.Nw)(null,t.width,t.height));const o=e.renderingTools.renderCanvas,{windowWidth:l,windowCenter:d}=e.viewport.voi;if((256===l||255===l)&&(128===d||127===d)&&!e.viewport.invert&&t.getCanvas&&t.getCanvas())return t.getCanvas();if(!(0,a.A)(e,t)&&!n)return o;e.renderingTools.renderCanvasContext&&o.width===t.width&&o.height===t.height||(0,s.A)(e,t);let p=(0,r.A)();const f=u(t,e.viewport);t.stats=t.stats||{},t.stats.lastLutGenerateTime=(0,r.A)()-p;const h=e.renderingTools.renderCanvasData,m=e.renderingTools.renderCanvasContext;return t.rgba?function(e,t,n){let i=(0,r.A)();const o=e.getPixelData();e.stats.lastGetPixelDataTime=(0,r.A)()-i;const a=e.minPixelValue;let s=0,l=0;const c=o.length;if(i=(0,r.A)(),a<0)for(;l<c;)n[s++]=t[o[l++]+-a],n[s++]=t[o[l++]+-a],n[s++]=t[o[l++]+-a],n[s++]=o[l++];else for(;l<c;)n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=o[l++];e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,r.A)()-i}(t,f,h.data):function(e,t,n){let i=(0,r.A)();const o=e.voxelManager.getScalarData();e.stats.lastGetPixelDataTime=(0,r.A)()-i;const a=e.minPixelValue;let s=0,l=0;const c=o.length;if(i=(0,r.A)(),a<0)for(;l<c;)n[s++]=t[o[l++]+-a],n[s++]=t[o[l++]+-a],n[s++]=t[o[l++]+-a],n[s++]=255;else for(;l<c;)n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=t[o[l++]],n[s++]=255;e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,r.A)()-i}(t,f,h.data),p=(0,r.A)(),m.putImageData(h,0,0),t.stats.lastPutImageDataTime=(0,r.A)()-p,o}function p(e,t){if(void 0===e)throw new Error("renderColorImage: enabledElement parameter must not be undefined");const n=e.image;if(void 0===n)throw new Error("renderColorImage: image must be loaded before it can be drawn");const r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,(0,o.A)(e,r);const i=d(e,n,t),a=e.viewport.displayedArea.tlhc.x-1,s=e.viewport.displayedArea.tlhc.y-1,c=e.viewport.displayedArea.brhc.x-a,u=e.viewport.displayedArea.brhc.y-s;r.drawImage(i,a,s,c,u,0,0,c,u),e.renderingTools=(0,l.A)(e)}},92885:(e,t,n)=>{"use strict";n.d(t,{j:()=>d});var r=n(53586);var i=n(79280),o=n(19704),a=n(23681),s=n(27810),l=n(81064),c=n(30135);function u(e,t,n,i=!0){const l=e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&!l||(e.renderingTools.renderCanvas=(0,c.Nw)(null,t.width,t.height),(0,s.A)(e,t));const u=e.renderingTools.renderCanvas;if(!(0,a.A)(e,t)&&!n)return u;u.width===t.width&&u.height===t.height||(0,s.A)(e,t),t.stats=t.stats||{};const d=e.renderingTools.renderCanvasData,p=e.renderingTools.renderCanvasContext;let f=(0,r.A)();t.stats.lastLutGenerateTime=(0,r.A)()-f;const{viewport:h}=e;if("PT"===h.modality&&t.isPreScaled){const{windowWidth:e,windowCenter:n}=h.voi,i=n-e/2,o=255/(n+e/2-i);let a;a=h.invert?e=>255-(e-i)*o:e=>(e-i)*o,function(e,t,n){let i=(0,r.A)();const o=e.voxelManager.getScalarData();e.stats.lastGetPixelDataTime=(0,r.A)()-i;const a=o.length;let s=3,l=0;for(i=(0,r.A)();l<a;)n[s]=t(o[l++]),s+=4;e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,r.A)()-i}(t,a,d.data)}else{const e=(0,o.A)(t,h,n);i?function(e,t,n){let i=(0,r.A)();const o=e.voxelManager.getScalarData();e.stats.lastGetPixelDataTime=(0,r.A)()-i;const a=o.length,s=e.minPixelValue;let l=3,c=0;if(i=(0,r.A)(),o instanceof Int16Array)if(s<0)for(;c<a;)n[l]=t[o[c++]+-s],l+=4;else for(;c<a;)n[l]=t[o[c++]],l+=4;else if(o instanceof Uint16Array)for(;c<a;)n[l]=t[o[c++]],l+=4;else if(s<0)for(;c<a;)n[l]=t[o[c++]+-s],l+=4;else for(;c<a;)n[l]=t[o[c++]],l+=4;e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,r.A)()-i}(t,e,d.data):function(e,t,n){let i=(0,r.A)();const o=e.voxelManager.getScalarData();e.stats.lastGetPixelDataTime=(0,r.A)()-i;const a=o.length,s=e.minPixelValue;let l,c=0,u=0;if(i=(0,r.A)(),o instanceof Int16Array)if(s<0)for(;u<a;)l=t[o[u++]+-s],n[c++]=l,n[c++]=l,n[c++]=l,n[c++]=255;else for(;u<a;)l=t[o[u++]],n[c++]=l,n[c++]=l,n[c++]=l,n[c++]=255;else if(o instanceof Uint16Array)for(;u<a;)l=t[o[u++]],n[c++]=l,n[c++]=l,n[c++]=l,n[c++]=255;else if(s<0)for(;u<a;)l=t[o[u++]+-s],n[c++]=l,n[c++]=l,n[c++]=l,n[c++]=255;else for(;u<a;)l=t[o[u++]],n[c++]=l,n[c++]=l,n[c++]=l,n[c++]=255;e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,r.A)()-i}(t,e,d.data)}return f=(0,r.A)(),p.putImageData(d,0,0),t.stats.lastPutImageDataTime=(0,r.A)()-f,u}function d(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");const n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");const r=e.canvas.getContext("2d");r.setTransform(1,0,0,1,0,0),r.fillStyle="black",r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,(0,i.A)(e,r);const o=u(e,n,t),a=e.viewport.displayedArea.tlhc.x-1,s=e.viewport.displayedArea.tlhc.y-1,c=e.viewport.displayedArea.brhc.x-a,d=e.viewport.displayedArea.brhc.y-s;r.drawImage(o,a,s,c,d,0,0,c,d),e.renderingTools=(0,l.A)(e)}},71209:(e,t,n)=>{"use strict";n.d(t,{l:()=>x});var r=n(79280),i=n(53586),o=n(27810),a=n(19704),s=n(81064),l=n(23681);function c(e,t,n){if(e>1)throw new Error("HSVToRGB expects hue < 1");const r=[];if(0===t)return r[0]=n,r[1]=n,r[2]=n,r;const i=Math.floor(6*e),o=6*e-i,a=n*(1-t),s=n*(1-t*o),l=n*(1-t*(1-o));switch(i){case 0:case 6:r[0]=n,r[1]=l,r[2]=a;break;case 1:r[0]=s,r[1]=n,r[2]=a;break;case 2:r[0]=a,r[1]=n,r[2]=l;break;case 3:r[0]=a,r[1]=s,r[2]=n;break;case 4:r[0]=l,r[1]=a,r[2]=n;break;case 5:r[0]=n,r[1]=a,r[2]=s}return r}const u=class{constructor(){this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}setNumberOfTableValues(e){this.NumberOfColors=e}setRamp(e){this.Ramp=e}setTableRange(e,t){this.TableRange[0]=e,this.TableRange[1]=t}setHueRange(e,t){this.HueRange[0]=e,this.HueRange[1]=t}setSaturationRange(e,t){this.SaturationRange[0]=e,this.SaturationRange[1]=t}setValueRange(e,t){this.ValueRange[0]=e,this.ValueRange[1]=t}setRange(e,t){this.InputRange[0]=e,this.InputRange[1]=t}setAlphaRange(e,t){this.AlphaRange[0]=e,this.AlphaRange[1]=t}getColor(e){return this.mapValue(e)}build(e){if(this.Table.length>1&&!e)return;this.Table=[];const t=this.NumberOfColors-1;let n,r,i,o;t?(n=(this.HueRange[1]-this.HueRange[0])/t,r=(this.SaturationRange[1]-this.SaturationRange[0])/t,i=(this.ValueRange[1]-this.ValueRange[0])/t,o=(this.AlphaRange[1]-this.AlphaRange[0])/t):n=r=i=o=0;for(let e=0;e<=t;e++){const t=this.HueRange[0]+e*n,a=this.SaturationRange[0]+e*r,s=this.ValueRange[0]+e*i,l=this.AlphaRange[0]+e*o,u=c(t,a,s),d=[0,0,0,0];switch(this.Ramp){case"scurve":d[0]=Math.floor(127.5*(1+Math.cos((1-u[0])*Math.PI))),d[1]=Math.floor(127.5*(1+Math.cos((1-u[1])*Math.PI))),d[2]=Math.floor(127.5*(1+Math.cos((1-u[2])*Math.PI))),d[3]=Math.floor(255*l);break;case"linear":d[0]=Math.floor(255*u[0]+.5),d[1]=Math.floor(255*u[1]+.5),d[2]=Math.floor(255*u[2]+.5),d[3]=Math.floor(255*l+.5);break;case"sqrt":d[0]=Math.floor(255*Math.sqrt(u[0])+.5),d[1]=Math.floor(255*Math.sqrt(u[1])+.5),d[2]=Math.floor(255*Math.sqrt(u[2])+.5),d[3]=Math.floor(255*Math.sqrt(l)+.5);break;default:throw new Error(`Invalid Ramp value (${this.Ramp})`)}this.Table.push(d)}this.buildSpecialColors()}buildSpecialColors(){const e=this.NumberOfColors,t=e+0,n=e+1,r=e+2;this.UseBelowRangeColor||0===e?this.Table[t]=this.BelowRangeColor:this.Table[t]=this.Table[0],this.UseAboveRangeColor||0===e?this.Table[n]=this.AboveRangeColor:this.Table[n]=this.Table[e-1],this.Table[r]=this.NaNColor}mapValue(e){const t=this.getIndex(e);if(t<0)return this.NaNColor;if(0===t){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(t===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[t]}getIndex(e){const t={Range:[],MaxIndex:this.NumberOfColors-1,Shift:-this.TableRange[0],Scale:1};if(this.TableRange[1]<=this.TableRange[0]?t.Scale=Number.MAX_VALUE:t.Scale=t.MaxIndex/(this.TableRange[1]-this.TableRange[0]),t.Range[0]=this.TableRange[0],t.Range[1]=this.TableRange[1],isNaN(e))return-1;let n=function(e,t){let n;return n=e<t.Range[0]?t.MaxIndex+0+1.5:e>t.Range[1]?t.MaxIndex+1+1.5:(e+t.Shift)*t.Scale,Math.floor(n)}(e,t);return n===this.NumberOfColors+0?n=0:n===this.NumberOfColors+1&&(n=this.NumberOfColors-1),n}setTableValue(e,t,n,r,i){let o;if("number"==typeof t&&void 0!==n&&void 0!==r&&void 0!==i)o=[t,n,r,i];else{if(!Array.isArray(t))throw new Error("Invalid arguments for setTableValue");o=t}if(e<0)throw new Error(`Can't set the table value for negative index (${e})`);if(e>=this.NumberOfColors)throw new Error(`Index ${e} is greater than the number of colors ${this.NumberOfColors}`);this.Table[e]=o,0!==e&&e!==this.NumberOfColors-1||this.buildSpecialColors()}};var d=n(21093);const p=[0,0,0,0];function f(e,t){let n=0,r=e.length-1;for(;n<=r;){const i=n+Math.floor((r-n)/2),o=e[i];if(o===t)return i;t<o?r=i-1:n=i+1}return n}function h(e,t,n){let r;const i=[],o=[],a=[],s=[];for(n=null===n?1:n,r=0;r<t.length;r++){const n=t[r];i.push((e-1)*n[0]),o.push(n[1]),a.push(n[1])}const l=function(e,t,n){const r=(t-e)/((n=null===n?100:n)-1),i=[];for(;n-- >0;)i.push(e),e+=r;return i[i.length-1]=t,i}(0,1,e);for(r=0;r<e;r++)l[r]=(e-1)*Math.pow(l[r],n);const c=function(e,t){let n;const r=[],i=t.length;for(e.sort((function(e,t){return e-t})),n=0;n<i;n++)r[n]=f(e,t[n]);return r}(i,l);for(r=1;r<e-1;r++){const e=c[r],t=(l[r]-i[e-1])/(i[e]-i[e-1]),n=o[e]-a[e-1];s[r]=t*n+a[e-1]}return s[0]=a[0],s[e-1]=o[t.length-1],s}function m(e,t){let n=d.A[e];n||(n=d.A[e]=t||{name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=function(e,t,n){let r;const i=[];n=null===n?1:n;const o=h(t=null===t?256:t,e.red,n),a=h(t,e.green,n),s=h(t,e.blue,n);for(r=0;r<t;r++){const e=[Math.round(255*o[r]),Math.round(255*a[r]),Math.round(255*s[r]),255];i.push(e)}return i}(n.segmentedData,n.numColors,n.gamma));return{getId:()=>e,getColorSchemeName:()=>n.name,setColorSchemeName(e){n.name=e},getNumberOfColors:()=>n.colors.length,setNumberOfColors(e){for(;n.colors.length<e;)n.colors.push(p);n.colors.length=e},getColor(e){return this.isValidIndex(e)?n.colors[e]:p},getColorRepeating(e){const t=n.colors.length;return e=t?e%t:0,this.getColor(e)},setColor(e,t){this.isValidIndex(e)&&(n.colors[e]=t)},addColor(e){n.colors.push(e)},insertColor(e,t){this.isValidIndex(e)&&n.colors.splice(e,1,t)},removeColor(e){this.isValidIndex(e)&&n.colors.splice(e,1)},clearColors(){n.colors=[]},buildLookupTable(e){if(!e)return;const t=n.colors.length;e.setNumberOfTableValues(t);for(let r=0;r<t;r++)e.setTableValue(r,n.colors[r])},createLookupTable(){const e=new u;return this.buildLookupTable(e),e},isValidIndex:e=>e>=0&&e<n.colors.length}}const g=function(e,t,n,r){let o=(0,i.A)();const a=e.voxelManager.getScalarData();e.stats.lastGetPixelDataTime=(0,i.A)()-o;const s=a.length,l=e.minPixelValue;let c,d,p,f=0,h=0;if(o=(0,i.A)(),p=n instanceof u?n.Table:n,l<0)for(;h<s;)c=t[a[h++]+-l],d=p[c],r[f++]=d[0],r[f++]=d[1],r[f++]=d[2],r[f++]=d[3];else for(;h<s;)c=t[a[h++]],d=p[c],r[f++]=d[0],r[f++]=d[1],r[f++]=d[2],r[f++]=d[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,i.A)()-o};const v=function(e,t,n,r){let o=(0,i.A)();const a=e.voxelManager.getScalarData();e.stats.lastGetPixelDataTime=(0,i.A)()-o;const s=a.length,l=e.minPixelValue;let c,d,p,f=0,h=0;if(o=(0,i.A)(),p=n instanceof u?n.Table:n,l<0)for(;h<s;)c=t(a[h++]+-l),d=p[c],r[f++]=d[0],r[f++]=d[1],r[f++]=d[2],r[f++]=d[3];else for(;h<s;)c=t(a[h++]),d=p[c],r[f++]=d[0],r[f++]=d[1],r[f++]=d[2],r[f++]=d[3];e.stats.lastStoredPixelDataToCanvasImageDataTime=(0,i.A)()-o};var y=n(84061),b=n(30135);function x(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");const n=e.image;if(void 0===n)throw new Error("drawImage: image must be loaded before it can be drawn");const c=e.canvas.getContext("2d");c.setTransform(1,0,0,1,0,0),c.fillStyle="black",c.fillRect(0,0,e.canvas.width,e.canvas.height),c.imageSmoothingEnabled=!e.viewport.pixelReplication,(0,r.A)(e,c);const u=function(e,t,n){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=(0,b.Nw)(null,t.width,t.height));const r=e.renderingTools.renderCanvas;let s=e.viewport.colormap||e.options.colormap;if(e.options&&e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),s&&"string"==typeof s&&(s=m(s)),!s)throw new Error("renderPseudoColorImage: colormap not found.");const c=s.getId();if(!(0,l.A)(e,t)&&!n&&e.renderingTools.colormapId===c)return r;e.renderingTools.renderCanvasContext&&r.width===t.width&&r.height===t.height||(0,o.A)(e,t);let u=(0,i.A)();e.renderingTools.colorLUT&&!n&&e.renderingTools.colormapId===c||(s.setNumberOfColors(256),e.renderingTools.colorLUT=s.createLookupTable(),e.renderingTools.colormapId=c);const d=e.renderingTools.renderCanvasData,p=e.renderingTools.renderCanvasContext,{viewport:f}=e,h=e.renderingTools.colorLUT;if("PT"===f.modality){const{windowWidth:e,windowCenter:n}=f.voi,r=n-e/2,i=255/(n+e/2-r);let o;o=f.invert?e=>(0,y.q)(Math.floor(255-(e-r)*i),0,255):e=>(0,y.q)(Math.floor((e-r)*i),0,255),v(t,o,h,d.data)}else{const r=(0,a.A)(t,e.viewport,n);t.stats=t.stats||{},t.stats.lastLutGenerateTime=(0,i.A)()-u,g(t,r,h,d.data)}return u=(0,i.A)(),p.putImageData(d,0,0),t.stats.lastPutImageDataTime=(0,i.A)()-u,r}(e,n,t),d=e.viewport.displayedArea.tlhc.x-1,p=e.viewport.displayedArea.tlhc.y-1,f=e.viewport.displayedArea.brhc.x-d,h=e.viewport.displayedArea.brhc.y-p;c.drawImage(u,d,p,f,h,0,0,f,h),e.renderingTools=(0,s.A)(e)}},81064:(e,t,n)=>{"use strict";function r(e){const t=e.image.imageId,n=e.viewport,r=e.image.color;return e.renderingTools.lastRenderedImageId=t,e.renderingTools.lastRenderedIsColor=r,e.renderingTools.lastRenderedViewport={windowCenter:n.voi.windowCenter,windowWidth:n.voi.windowWidth,invert:n.invert,rotation:n.rotation,hflip:n.hflip,vflip:n.vflip,modalityLUT:n.modalityLUT,voiLUT:n.voiLUT,colormap:n.colormap},e.renderingTools}n.d(t,{A:()=>r})},79280:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(7808);function i(e,t,n){if(void 0===e)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===t)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");const i=(0,r.A)(e,n).getMatrix();t.setTransform(i[0],i[1],i[2],i[3],i[4],i[5])}},45354:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});class r{constructor(){this.reset()}getMatrix(){return this.m}reset(){this.m=[1,0,0,1,0,0]}clone(){const e=new r;return e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5],e}multiply(e){const t=this.m[0]*e[0]+this.m[2]*e[1],n=this.m[1]*e[0]+this.m[3]*e[1],r=this.m[0]*e[2]+this.m[2]*e[3],i=this.m[1]*e[2]+this.m[3]*e[3],o=this.m[0]*e[4]+this.m[2]*e[5]+this.m[4],a=this.m[1]*e[4]+this.m[3]*e[5]+this.m[5];this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=i,this.m[4]=o,this.m[5]=a}invert(){const e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,r=-this.m[2]*e,i=this.m[0]*e,o=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=i,this.m[4]=o,this.m[5]=a}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.m[0]*t+this.m[2]*n,i=this.m[1]*t+this.m[3]*n,o=this.m[0]*-n+this.m[2]*t,a=this.m[1]*-n+this.m[3]*t;this.m[0]=r,this.m[1]=i,this.m[2]=o,this.m[3]=a}translate(e,t){this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t}scale(e,t){this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t}transformPoint(e){const t=e[0],n=e[1];return[t*this.m[0]+n*this.m[2]+this.m[4],t*this.m[1]+n*this.m[3]+this.m[5]]}}},15528:(e,t,n)=>{"use strict";function r(e,t){if(null==e)throw new Error(t)}n.d(t,{C:()=>r})},61640:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var r=n(3823),i=n(28906),o=n(21734),a=n(62502),s=n(33739),l=n(99341),c=n(20433);const{InterpolationType:u,OpacityMode:d}=c.Ay,{vtkErrorMacro:p}=i.m,f=4;const h={colorMixPreset:null,independentComponents:!0,interpolationType:u.FAST_LINEAR,shade:!1,ambient:.1,diffuse:.7,specular:.2,specularPower:10,useLabelOutline:!1,labelOutlineThickness:[1],labelOutlineOpacity:1};function m(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Object.assign(t,h,n),i.m.obj(e,t),!t.componentData){t.componentData=[];for(let e=0;e<f;++e)t.componentData.push({colorChannels:1,grayTransferFunction:null,rGBTransferFunction:null,scalarOpacity:null,scalarOpacityUnitDistance:1,opacityMode:d.FRACTIONAL,gradientOpacityMinimumValue:0,gradientOpacityMinimumOpacity:0,gradientOpacityMaximumValue:1,gradientOpacityMaximumOpacity:1,useGradientOpacity:!1,componentWeight:1,forceNearestInterpolation:!1})}i.m.setGet(e,t,["colorMixPreset","independentComponents","interpolationType","shade","ambient","diffuse","specular","specularPower","useLabelOutline","labelOutlineOpacity"]),i.m.setGetArray(e,t,["labelOutlineThickness"]),function(e,t){t.classHierarchy.push("vtkVolumeProperty"),e.getMTime=()=>{let e,n=t.mtime;for(let r=0;r<f;r++)1===t.componentData[r].colorChannels?t.componentData[r].grayTransferFunction&&(e=t.componentData[r].grayTransferFunction.getMTime(),n=n>e?n:e):3===t.componentData[r].colorChannels&&t.componentData[r].rGBTransferFunction&&(e=t.componentData[r].rGBTransferFunction.getMTime(),n=n>e?n:e),t.componentData[r].scalarOpacity&&(e=t.componentData[r].scalarOpacity.getMTime(),n=n>e?n:e),t.componentData[r].gradientOpacity&&(t.componentData[r].disableGradientOpacity||(e=t.componentData[r].gradientOpacity.getMTime(),n=n>e?n:e));return n},e.getColorChannels=e=>e<0||e>3?(p("Bad index - must be between 0 and 3"),0):t.componentData[e].colorChannels,e.setGrayTransferFunction=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!1;return t.componentData[n].grayTransferFunction!==r&&(t.componentData[n].grayTransferFunction=r,i=!0),1!==t.componentData[n].colorChannels&&(t.componentData[n].colorChannels=1,i=!0),i&&e.modified(),i},e.getGrayTransferFunction=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null===t.componentData[n].grayTransferFunction&&(t.componentData[n].grayTransferFunction=l.Ay.newInstance(),t.componentData[n].grayTransferFunction.addPoint(0,0),t.componentData[n].grayTransferFunction.addPoint(1024,1),1!==t.componentData[n].colorChannels&&(t.componentData[n].colorChannels=1),e.modified()),t.componentData[n].grayTransferFunction},e.setRGBTransferFunction=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!1;return t.componentData[n].rGBTransferFunction!==r&&(t.componentData[n].rGBTransferFunction=r,i=!0),3!==t.componentData[n].colorChannels&&(t.componentData[n].colorChannels=3,i=!0),i&&e.modified(),i},e.getRGBTransferFunction=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null===t.componentData[n].rGBTransferFunction&&(t.componentData[n].rGBTransferFunction=s.Ay.newInstance(),t.componentData[n].rGBTransferFunction.addRGBPoint(0,0,0,0),t.componentData[n].rGBTransferFunction.addRGBPoint(1024,1,1,1),3!==t.componentData[n].colorChannels&&(t.componentData[n].colorChannels=3),e.modified()),t.componentData[n].rGBTransferFunction},e.setScalarOpacity=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.componentData[n].scalarOpacity!==r&&(t.componentData[n].scalarOpacity=r,e.modified(),!0)},e.getScalarOpacity=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null===t.componentData[n].scalarOpacity&&(t.componentData[n].scalarOpacity=l.Ay.newInstance(),t.componentData[n].scalarOpacity.addPoint(0,1),t.componentData[n].scalarOpacity.addPoint(1024,1),e.modified()),t.componentData[n].scalarOpacity},e.setComponentWeight=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(n<0||n>=f)return p("Invalid index"),!1;const i=Math.min(1,Math.max(0,r));return t.componentData[n].componentWeight!==i&&(t.componentData[n].componentWeight=i,e.modified(),!0)},e.getComponentWeight=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e<0||e>=f?(p("Invalid index"),0):t.componentData[e].componentWeight},e.setInterpolationTypeToNearest=()=>e.setInterpolationType(u.NEAREST),e.setInterpolationTypeToLinear=()=>e.setInterpolationType(u.LINEAR),e.setInterpolationTypeToFastLinear=()=>e.setInterpolationType(u.FAST_LINEAR),e.getInterpolationTypeAsString=()=>i.m.enumToString(u,t.interpolationType),["useGradientOpacity","scalarOpacityUnitDistance","gradientOpacityMinimumValue","gradientOpacityMinimumOpacity","gradientOpacityMaximumValue","gradientOpacityMaximumOpacity","opacityMode","forceNearestInterpolation"].forEach((n=>{const r=i.m.capitalize(n);e[`set${r}`]=(r,i)=>t.componentData[r][`${n}`]!==i&&(t.componentData[r][`${n}`]=i,e.modified(),!0)})),["useGradientOpacity","scalarOpacityUnitDistance","gradientOpacityMinimumValue","gradientOpacityMinimumOpacity","gradientOpacityMaximumValue","gradientOpacityMaximumOpacity","opacityMode","forceNearestInterpolation"].forEach((n=>{const r=i.m.capitalize(n);e[`get${r}`]=e=>t.componentData[e][`${n}`]}))}(e,t)}var g={newInstance:i.m.newInstance(m,"vtkVolumeProperty"),extend:m,...c.Ay};const{vtkDebugMacro:v}=i.m;const y={mapper:null,property:null,bounds:[1,-1,1,-1,1,-1]};function b(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,y,n),a.Ay.extend(e,t,n),t.boundsMTime={},i.m.obj(t.boundsMTime),i.m.set(e,t,["property"]),i.m.setGet(e,t,["mapper"]),i.m.getArray(e,t,["bounds"],6),function(e,t){t.classHierarchy.push("vtkVolume"),e.getVolumes=()=>e,e.makeProperty=g.newInstance,e.getProperty=()=>(null===t.property&&(t.property=e.makeProperty()),t.property),e.getBounds=()=>{if(null===t.mapper)return t.bounds;const n=t.mapper.getBounds();if(!n||6!==n.length)return n;if(n[0]>n[1])return t.mapperBounds=n.concat(),t.bounds=[1,-1,1,-1,1,-1],t.boundsMTime.modified(),n;if(!t.mapperBounds||!(i=[n,t.mapperBounds],i[0].map(((e,t)=>i.map((e=>e[t]))))).reduce(((e,t)=>e&&t[0]===t[1]),!0)||e.getMTime()>t.boundsMTime.getMTime()){v("Recomputing bounds..."),t.mapperBounds=n.map((e=>e));const i=[];o.Ay.getCorners(n,i),e.computeMatrix();const a=new Float64Array(16);r.pB.transpose(a,t.matrix),i.forEach((e=>r.eR.transformMat4(e,e,a))),t.bounds[0]=t.bounds[2]=t.bounds[4]=Number.MAX_VALUE,t.bounds[1]=t.bounds[3]=t.bounds[5]=-Number.MAX_VALUE,t.bounds=t.bounds.map(((e,t)=>t%2==0?i.reduce(((e,n)=>e>n[t/2]?n[t/2]:e),e):i.reduce(((e,n)=>e<n[(t-1)/2]?n[(t-1)/2]:e),e))),t.boundsMTime.modified()}var i;return t.bounds},e.getMTime=()=>{let e=t.mtime;if(null!==t.property){const n=t.property.getMTime();e=n>e?n:e}return e},e.getRedrawMTime=()=>{let e=t.mtime;if(null!==t.mapper){let n=t.mapper.getMTime();e=n>e?n:e,null!==t.mapper.getInput()&&(t.mapper.getInputAlgorithm().update(),n=t.mapper.getInput().getMTime(),e=n>e?n:e)}return e}}(e,t)}var x={newInstance:i.m.newInstance(b,"vtkVolume"),extend:b},A=n(87142),C=n(92099),T=n(69372),S=n(71851),w=n(89821);const _=async function(e,t,n,r=!1){const{volumeId:i,callback:o,blendMode:a}=e,s=await(0,A.loadVolume)(i);if(!s)throw new Error(`imageVolume with id: ${s.volumeId} does not exist`);const{imageData:l,vtkOpenGLTexture:c}=s,u=(0,C.A)(l,c);a&&u.setBlendMode(a);const d=x.newInstance();d.setMapper(u);const{numberOfComponents:p}=l.get("numberOfComponents");return d.getProperty().set({viewportId:n}),3===p&&d.getProperty().setIndependentComponents(!1),await(0,w.A)(d,s),o&&o({volumeActor:d,volumeId:i}),r||function(e,t,n,r){const i=n.getProperty().getRGBTransferFunction(0).getRange(),o={viewportId:t,range:{lower:i[0],upper:i[1]},volumeId:r};(0,T.A)(e,S.Events.VOI_MODIFIED,o)}(t,n,d,i),d}},92099:(e,t,n)=>{"use strict";n.d(t,{A:()=>s,h:()=>l});var r=n(42295),i=n(26896),o=n(53387),a=n(42008);function s(e,t){const n=r.wu.newInstance();(0,i.D0)().rendering.preferSizeOverAccuracy&&n.setPreferSizeOverAccuracy(!0),n.setInputData(e);const o=e.getSpacing(),a=(o[0]+o[1]+o[2])/6;return n.setMaximumSamplesPerRay(4e3),n.setSampleDistance(a),n.setScalarTexture(t),n}function l(e){const t=o.Ay.newInstance();t.setBlendMode(e.getBlendMode());const n=e.getInputData(),{voxelManager:r}=n.get("voxelManager"),i=r.getCompleteScalarDataArray(),s=a.Ay.newInstance({name:"Pixels",values:i});return n.getPointData().setScalars(s),t.setInputData(n),t.setMaximumSamplesPerRay(e.getMaximumSamplesPerRay()),t.setSampleDistance(e.getSampleDistance()),t}},30135:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c,Nw:()=>s,oI:()=>l,p8:()=>o});const r="viewport-element",i="cornerstone-canvas",o=1e-4;let a;function s(e,t=512,n=512){const r=a?a(t,n):document.createElement("canvas");return e?(r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.imageRendering="pixelated",r.classList.add(i),e.appendChild(r),r):r}function l(e){const t=`canvas.${i}`,n=`div.${r}`,o=e.querySelector(n)||function(e){const t=document.createElement("div");return t.style.position="relative",t.style.width="100%",t.style.height="100%",t.style.overflow="hidden",t.classList.add(r),e.appendChild(t),t}(e),a=o.querySelector(t);if(a)return a;const l=s(o),c=o.getBoundingClientRect(),u=window.devicePixelRatio||1,d=Math.ceil(c.width*u),p=Math.ceil(c.height*u);return l.width=d,l.height=p,l}const c=l},40661:(e,t,n)=>{"use strict";n.d(t,{ge:()=>s,x:()=>a,oI:()=>r.oI,A7:()=>o});n(61640),n(92099);var r=n(30135),i=n(46347);const o=async function(e,t,n,r=!1,o=!1){n.forEach((t=>{const n=e.getViewport(t);if(!n)throw new Error(`Viewport with Id ${t} does not exist`);if(!(n instanceof i.A))throw new Error("setVolumesForViewports only supports VolumeViewport and VolumeViewport3D")}));const a=n.map((async n=>{const i=e.getViewport(n);await i.setVolumes(t,r,o)}));await Promise.all(a)};const a=async function(e,t,n,r=!1,o=!1){for(const t of n){const n=e.getViewport(t);if(!n)throw new Error(`Viewport with Id ${t} does not exist`);if(!(n instanceof i.A))return void console.warn(`Viewport with Id ${t} is not a BaseVolumeViewport. Cannot add volume to this viewport.`)}const a=n.map((async n=>{const i=e.getViewport(n);await i.addVolumes(t,r,o)}));await Promise.all(a)};n(90740);const s=function(e,t,n){for(const t of n){const n=e.getViewport(t);if(!n)throw new Error(`Viewport with Id ${t} does not exist`);if(!n.addImages)return void console.warn(`Viewport with Id ${t} does not have addImages. Cannot add image segmentation to this viewport.`)}n.forEach((n=>{e.getViewport(n).addImages(t)}))}},89821:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(80068),i=n(74876),o=n(68136),a=n(71851),s=n(49038);const l=0,c=a.RequestType.Prefetch;const u=async function(e,t){let n=function(e){const{imageIds:t,metadata:n}=e;let r;if(t?.length){const e=t[Math.floor(t.length/2)],n=i.get("voiLutModule",e);if(n&&n.windowWidth&&n.windowCenter){n?.voiLUTFunction&&(r={},r.voiLUTFunction=n?.voiLUTFunction);const{windowWidth:e,windowCenter:t}=n,i=Array.isArray(e)?e[0]:e,o=Array.isArray(t)?t[0]:t;0!==i&&(r={windowWidth:i,windowCenter:o})}}else r=n.voiLut[0];if(r&&(0!==r.windowWidth||0!==r.windowCenter)){const{lower:e,upper:t}=o.toLowHighRange(Number(r.windowWidth),Number(r.windowCenter),r.voiLUTFunction);return{lower:e,upper:t}}return}(t);!n&&t.imageIds.length&&(n=await async function(e){const{imageIds:t}=e,n=Math.floor(t.length/2),o=e.imageIds[n],a=i.get("generalSeriesModule",o)||{},{modality:u}=a,d=i.get("modalityLutModule",o)||{},p={rescaleSlope:d.rescaleSlope,rescaleIntercept:d.rescaleIntercept,modality:u};let f;if("PT"===u){const e=i.get("scalingModule",o);e&&(f={...p,suvbw:e.suvbw})}const h={priority:l,requestType:c,preScale:{scalingParameters:f}};let m=s.Ay.getImage(o);e.referencedImageIds?.length||(m=await(0,r.loadAndCacheImage)(o,{...h,ignoreCache:!0}));let{min:g,max:v}=m.voxelManager.getMinMax();g?.length>1&&(g=Math.min(...g),v=Math.max(...v));return{lower:g,upper:v}}(t),n=function(e,t){const n=e.imageIds,r=Math.floor(n.length/2),o=n[r];if(function(e,t){if("PT"!==e||!t.isPreScaled)return!1;if(!t.scaling?.PT.suvbw)return!1;return!0}((i.get("generalSeriesModule",o)||{}).modality,e))return{lower:0,upper:5};return t}(t,n)),0===n.lower&&0===n.upper||void 0===n.lower||void 0===n.upper||e.getProperty().getRGBTransferFunction(0).setMappingRange(n.lower,n.upper)}},90740:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,g:()=>l});var r=n(47476),i=n(69372),o=n(71851),a=n(39536);const s={};function l(e){void 0!==s[e]&&delete s[e]}const c=function(e){const{renderingEngineId:t,viewportId:n}=e.detail,l=(0,a.lD)(t).getViewport(n);if(!("setVolumes"in l))throw new Error("volumeNewImageEventDispatcher: viewport does not have setVolumes method");void 0===s[l.id]&&(s[l.id]=0);const c=(0,r.A)(l);if(!c)return void console.warn(`volumeNewImageEventDispatcher: sliceData is undefined for viewport ${l.id}`);const{numberOfSlices:u,imageIndex:d}=c;if(s[l.id]===d)return;s[l.id]=d;const p={imageIndex:d,viewportId:n,renderingEngineId:t,numberOfSlices:u};(0,i.A)(l.element,o.Events.VOLUME_NEW_IMAGE,p)}},56706:(e,t,n)=>{"use strict";n.d(t,{hS:()=>p.A,PX:()=>u.A,Ay:()=>C});var r=n(32643),i=n(5862),o=n(10364),a=n(80221),s=n(69372),l=n(42295),c=n(41864),u=n(94155),d=n(46347),p=n(58165),f=n(40893),h=n(32501),m=n(81466);const g={[c.A.ORTHOGRAPHIC]:u.A,[c.A.PERSPECTIVE]:u.A,[c.A.STACK]:p.A,[c.A.VOLUME_3D]:f.A,[c.A.VIDEO]:h.A,[c.A.WHOLE_SLIDE]:m.A};function v(e){return g[e].useCustomRenderingPipeline}var y=n(30135),b=n(26896),x=n(71851);const A=class{constructor(e){if(this._needsRender=new Set,this._animationFrameSet=!1,this._animationFrameHandle=null,this.renderFrameOfReference=e=>{const t=this._getViewportsAsArray().map((t=>{if(t.getFrameOfReferenceUID()===e)return t.id}));this.renderViewports(t)},this._renderFlaggedViewports=()=>{this._throwIfDestroyed(),this.useCPURendering||this.performVtkDrawCall();const e=this._getViewportsAsArray(),t=[];for(let n=0;n<e.length;n++){const r=e[n];if(this._needsRender.has(r.id)){const e=this.renderViewportUsingCustomOrVtkPipeline(r);if(t.push(e),r.setRendered(),this._needsRender.delete(r.id),0===this._needsRender.size)break}}this._animationFrameSet=!1,this._animationFrameHandle=null,t.forEach((e=>{e?.element&&(0,s.A)(e.element,r.A.IMAGE_RENDERED,e)}))},this.id=e||(0,a.A)(),this.useCPURendering=(0,b.LH)(),i.A.set(this),!(0,b.Dh)())throw new Error("@cornerstonejs/core is not initialized, run init() first");this.useCPURendering||(this.offscreenMultiRenderWindow=l.Ig.newInstance(),this.offScreenCanvasContainer=document.createElement("div"),this.offscreenMultiRenderWindow.setContainer(this.offScreenCanvasContainer)),this._viewports=new Map,this.hasBeenDestroyed=!1}enableElement(e){const t=this._normalizeViewportInputEntry(e);this._throwIfDestroyed();const{element:n,viewportId:r}=t;if(!n)throw new Error("No element provided");this.getViewport(r)&&this.disableElement(r);const{type:i}=t,o=v(i);this.useCPURendering||o?this.addCustomViewport(t):this.enableVTKjsDrivenViewport(t);const a=(0,y.Ay)(n),{background:s}=t.defaultOptions;this.fillCanvasWithBackgroundColor(a,s)}disableElement(e){this._throwIfDestroyed();const t=this.getViewport(e);if(!t)return void console.warn(`viewport ${e} does not exist`);this._resetViewport(t),v(t.type)||this.useCPURendering||this.offscreenMultiRenderWindow.removeRenderer(e),this._removeViewport(e),t.isDisabled=!0,this._needsRender.delete(e);this.getViewports().length||this._clearAnimationFrame()}setViewports(e){const t=this._normalizeViewportInputEntries(e);this._throwIfDestroyed(),this._reset();const n=[],r=[];t.forEach((e=>{this.useCPURendering||v(e.type)?r.push(e):n.push(e)})),this.setVtkjsDrivenViewports(n),this.setCustomViewports(r),t.forEach((e=>{const t=(0,y.Ay)(e.element),{background:n}=e.defaultOptions;this.fillCanvasWithBackgroundColor(t,n)}))}resize(e=!0,t=!0){this._throwIfDestroyed();const n=this._getViewportsAsArray(),r=[],i=[];n.forEach((e=>{v(e.type)?i.push(e):r.push(e)})),r.length&&this._resizeVTKViewports(r,t,e),i.length&&this._resizeUsingCustomResizeHandler(i,t,e)}getViewport(e){return this._viewports?.get(e)}getViewports(){return this._throwIfDestroyed(),this._getViewportsAsArray()}getStackViewport(e){this._throwIfDestroyed();const t=this.getViewport(e);if(!t)throw new Error(`Viewport with Id ${e} does not exist`);if(!(t instanceof p.A))throw new Error(`Viewport with Id ${e} is not a StackViewport.`);return t}getStackViewports(){this._throwIfDestroyed();return this.getViewports().filter((e=>e instanceof p.A))}getVolumeViewports(){this._throwIfDestroyed();return this.getViewports().filter((e=>e instanceof d.A))}render(){const e=this.getViewports().map((e=>e.id));this._setViewportsToBeRenderedNextFrame(e)}renderViewports(e){this._setViewportsToBeRenderedNextFrame(e)}renderViewport(e){this._setViewportsToBeRenderedNextFrame([e])}destroy(){if(!this.hasBeenDestroyed){if(!this.useCPURendering){this._getViewportsAsArray().forEach((e=>{this.offscreenMultiRenderWindow.removeRenderer(e.id)})),this.offscreenMultiRenderWindow.delete(),delete this.offscreenMultiRenderWindow}this._reset(),i.A.delete(this.id),this.hasBeenDestroyed=!0}}fillCanvasWithBackgroundColor(e,t){const n=e.getContext("2d");let r;if(t){const e=t.map((e=>Math.floor(255*e)));r=`rgb(${e[0]}, ${e[1]}, ${e[2]})`}else r="black";n.fillStyle=r,n.fillRect(0,0,e.width,e.height)}_normalizeViewportInputEntry(e){const{type:t,defaultOptions:n}=e;let r=n;return r&&0!==Object.keys(r).length||(r={background:[0,0,0],orientation:null,displayArea:null},t===c.A.ORTHOGRAPHIC&&(r={...r,orientation:x.OrientationAxis.AXIAL})),{...e,defaultOptions:r}}_normalizeViewportInputEntries(e){const t=[];return e.forEach((e=>{t.push(this._normalizeViewportInputEntry(e))})),t}_resizeUsingCustomResizeHandler(e,t=!0,n=!0){e.forEach((e=>{"function"==typeof e.resize&&e.resize()})),e.forEach((e=>{const n=e.getCamera();e.resetCamera(),t&&e.setCamera(n)})),n&&this.render()}_resizeVTKViewports(e,t=!0,n=!0){const r=e.map((e=>(0,y.Ay)(e.element)));if(r.forEach((e=>{const t=window.devicePixelRatio||1;e.width=e.clientWidth*t,e.height=e.clientHeight*t})),r.length){const{offScreenCanvasWidth:t,offScreenCanvasHeight:n}=this._resizeOffScreenCanvas(r);this._resize(e,t,n)}e.forEach((e=>{const n=e.getCamera(),r=e.getRotation(),{flipHorizontal:i}=n;e.resetCameraForResize();const o=e.getDisplayArea();t&&(o?(i&&e.setCamera({flipHorizontal:i}),r&&e.setViewPresentation({rotation:r})):e.setCamera(n))})),n&&this.render()}enableVTKjsDrivenViewport(e){const t=this._getViewportsAsArray().filter((e=>!1===v(e.type))),n=t.map((e=>e.canvas)),r=(0,y.Ay)(e.element);n.push(r);const{offScreenCanvasWidth:i,offScreenCanvasHeight:o}=this._resizeOffScreenCanvas(n),a=this._resize(t,i,o),s={...e,canvas:r};this.addVtkjsDrivenViewport(s,{offScreenCanvasWidth:i,offScreenCanvasHeight:o,xOffset:a})}_removeViewport(e){this.getViewport(e)?this._viewports.delete(e):console.warn(`viewport ${e} does not exist`)}addVtkjsDrivenViewport(e,t){const{element:n,canvas:i,viewportId:a,type:l,defaultOptions:d}=e;n.tabIndex=-1;const{offScreenCanvasWidth:h,offScreenCanvasHeight:m,xOffset:g}=t,{sxStartDisplayCoords:v,syStartDisplayCoords:y,sxEndDisplayCoords:b,syEndDisplayCoords:x,sx:A,sy:C,sWidth:T,sHeight:S}=this._getViewportCoordsOnOffScreenCanvas(e,h,m,g);this.offscreenMultiRenderWindow.addRenderer({viewport:[v,y,b,x],id:a,background:d.background?d.background:[0,0,0]});const w={id:a,element:n,renderingEngineId:this.id,type:l,canvas:i,sx:A,sy:C,sWidth:T,sHeight:S,defaultOptions:d||{}};let _;if(l===c.A.STACK)_=new p.A(w);else if(l===c.A.ORTHOGRAPHIC||l===c.A.PERSPECTIVE)_=new u.A(w);else{if(l!==c.A.VOLUME_3D)throw new Error(`Viewport Type ${l} is not supported`);_=new f.A(w)}this._viewports.set(a,_);const I={element:n,viewportId:a,renderingEngineId:this.id};_.suppressEvents||(0,s.A)(o.A,r.A.ELEMENT_ENABLED,I)}addCustomViewport(e){const{element:t,viewportId:n,type:i,defaultOptions:a}=e;t.tabIndex=-1;const l=(0,y.Ay)(t),{clientWidth:c,clientHeight:u}=l;l.width===c&&l.height===u||(l.width=c,l.height=u);const d={id:n,renderingEngineId:this.id,element:t,type:i,canvas:l,sx:0,sy:0,sWidth:c,sHeight:u,defaultOptions:a||{}},p=new(0,g[i])(d);this._viewports.set(n,p);const f={element:t,viewportId:n,renderingEngineId:this.id};(0,s.A)(o.A,r.A.ELEMENT_ENABLED,f)}setCustomViewports(e){e.forEach((e=>{this.addCustomViewport(e)}))}setVtkjsDrivenViewports(e){if(e.length){const t=e.map((e=>(0,y.Ay)(e.element)));t.forEach((e=>{const t=window.devicePixelRatio||1,n=e.getBoundingClientRect();e.width=n.width*t,e.height=n.height*t}));const{offScreenCanvasWidth:n,offScreenCanvasHeight:r}=this._resizeOffScreenCanvas(t);let i=0;for(let o=0;o<e.length;o++){const a=e[o],s=t[o],l={...a,canvas:s};this.addVtkjsDrivenViewport(l,{offScreenCanvasWidth:n,offScreenCanvasHeight:r,xOffset:i}),i+=s.width}}}_resizeOffScreenCanvas(e){const{offScreenCanvasContainer:t,offscreenMultiRenderWindow:n}=this,r=Math.max(...e.map((e=>e.height)));let i=0;return e.forEach((e=>{i+=e.width})),t.width=i,t.height=r,n.resize(),{offScreenCanvasWidth:i,offScreenCanvasHeight:r}}_resize(e,t,n){let r=0;for(let i=0;i<e.length;i++){const o=e[i],{sxStartDisplayCoords:a,syStartDisplayCoords:s,sxEndDisplayCoords:l,syEndDisplayCoords:c,sx:u,sy:d,sWidth:p,sHeight:f}=this._getViewportCoordsOnOffScreenCanvas(o,t,n,r);r+=o.canvas.width,o.sx=u,o.sy=d,o.sWidth=p,o.sHeight=f;this.offscreenMultiRenderWindow.getRenderer(o.id).setViewport([a,s,l,c])}return r}_getViewportCoordsOnOffScreenCanvas(e,t,n,r){const{canvas:i}=e,{width:o,height:a}=i,s=r/t,l=0+(n-a)/n;return{sxStartDisplayCoords:s,syStartDisplayCoords:l,sxEndDisplayCoords:s+o/t,syEndDisplayCoords:l+a/n,sx:r,sy:0,sWidth:o,sHeight:a}}_getViewportsAsArray(){return Array.from(this._viewports.values())}_setViewportsToBeRenderedNextFrame(e){e.forEach((e=>{this._needsRender.add(e)})),this._render()}_render(){this._needsRender.size>0&&!this._animationFrameSet&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedViewports),this._animationFrameSet=!0)}performVtkDrawCall(){const{offscreenMultiRenderWindow:e}=this,t=e.getRenderWindow(),n=e.getRenderers();if(n.length){for(let e=0;e<n.length;e++){const{renderer:t,id:r}=n[e];this._needsRender.has(r)?t.setDraw(!0):t.setDraw(!1)}t.render();for(let e=0;e<n.length;e++)n[e].renderer.setDraw(!1)}}renderViewportUsingCustomOrVtkPipeline(e){let t;if(!(e.sWidth<2||e.sHeight<2)){if(!0===v(e.type))t=e.customRenderViewportToCanvas();else{if(this.useCPURendering)throw new Error("GPU not available, and using a viewport with no custom render pipeline.");const{offscreenMultiRenderWindow:n}=this,r=n.getOpenGLRenderWindow().get3DContext().canvas;t=this._renderViewportFromVtkCanvasToOnscreenCanvas(e,r)}return t}console.warn("Viewport is too small",e.sWidth,e.sHeight)}_renderViewportFromVtkCanvasToOnscreenCanvas(e,t){const{element:n,canvas:r,sx:i,sy:o,sWidth:a,sHeight:s,id:l,renderingEngineId:c,suppressEvents:u}=e,{width:d,height:p}=r;return r.getContext("2d").drawImage(t,i,o,a,s,0,0,d,p),{element:n,suppressEvents:u,viewportId:l,renderingEngineId:c,viewportStatus:e.viewportStatus}}_resetViewport(e){const t=this.id,{element:n,canvas:i,id:a}=e,l={element:n,viewportId:a,renderingEngineId:t};e.removeWidgets(),(0,s.A)(o.A,r.A.ELEMENT_DISABLED,l),n.removeAttribute("data-viewport-uid"),n.removeAttribute("data-rendering-engine-uid");i.getContext("2d").clearRect(0,0,i.width,i.height)}_clearAnimationFrame(){window.cancelAnimationFrame(this._animationFrameHandle),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null}_reset(){this._getViewportsAsArray().forEach((e=>{this._resetViewport(e)})),this._clearAnimationFrame(),this._viewports=new Map}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}_downloadOffScreenCanvas(){!function(e){const t=document.createElement("a");t.download="viewport.png",t.href=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}(this._debugRender())}_debugRender(){const{offscreenMultiRenderWindow:e}=this,t=e.getRenderWindow(),n=e.getRenderers();for(let e=0;e<n.length;e++)n[e].renderer.setDraw(!0);t.render();const r=e.getOpenGLRenderWindow().get3DContext().canvas,i=r.toDataURL();return this._getViewportsAsArray().forEach((e=>{const{sx:t,sy:n,sWidth:i,sHeight:o}=e,a=e.canvas,{width:s,height:l}=a;a.getContext("2d").drawImage(r,t,n,i,o,0,0,s,l)})),i}};n(39536),n(40661);const C=A},5862:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const r={},i={get:e=>r[e],set:e=>{const t=e.id;r[t]=e},delete:e=>delete r[e],getAll:()=>{const e=Object.keys(r).map((e=>r[e]));return e.sort(((e,t)=>"_"===e.id[0]&&"_"!==t.id[0]?1:"_"!==e.id[0]&&"_"===t.id[0]?-1:0)),e}}},42295:(e,t,n)=>{"use strict";n.d(t,{Ig:()=>en,wu:()=>on,uT:()=>dn});var r=n(37290),i=n(28914),o=n(28906);const a=Object.create(null);function s(e,t){a[e]=t}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a[e]&&a[e](t)}const c={defaultViewAPI:"WebGL",renderers:[],views:[],interactor:null,neverRendered:!0,numberOfLayers:1,childRenderWindows:[]};function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,c,n),o.m.obj(e,t),o.m.setGet(e,t,["interactor","numberOfLayers","_views","defaultViewAPI"]),o.m.get(e,t,["neverRendered"]),o.m.getArray(e,t,["renderers","childRenderWindows"]),o.m.moveToProtected(e,t,["views"]),o.m.event(e,t,"completion"),function(e,t){t.classHierarchy.push("vtkRenderWindow"),e.addRenderer=n=>{e.hasRenderer(n)||(n.setRenderWindow(e),t.renderers.push(n),e.modified())},e.removeRenderer=n=>{t.renderers=t.renderers.filter((e=>e!==n)),e.modified()},e.hasRenderer=e=>-1!==t.renderers.indexOf(e),e.newAPISpecificView=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(e||t.defaultViewAPI,n)},e.addView=n=>{e.hasView(n)||(n.setRenderable(e),t._views.push(n),e.modified())},e.removeView=n=>{t._views=t._views.filter((e=>e!==n)),e.modified()},e.hasView=e=>-1!==t._views.indexOf(e),e.preRender=()=>{t.renderers.forEach((e=>{e.isActiveCameraCreated()||e.resetCamera()}))},e.render=()=>{e.preRender(),t.interactor?t.interactor.render():t._views.forEach((e=>e.traverseAllPasses()))},e.getStatistics=()=>{const e={propCount:0,invisiblePropCount:0,gpuMemoryMB:0};return t._views.forEach((t=>{t.getGraphicsMemoryInfo&&(e.gpuMemoryMB+=t.getGraphicsMemoryInfo()/1e6)})),t.renderers.forEach((n=>{const r=n.getViewProps(),i=t._views[0].getViewNodeFor(n);r.forEach((t=>{if(t.getVisibility()){e.propCount+=1;const n=t.getMapper&&t.getMapper();if(n&&n.getPrimitiveCount){const t=i.getViewNodeFor(n);if(t){t.getAllocatedGPUMemoryInBytes&&(e.gpuMemoryMB+=t.getAllocatedGPUMemoryInBytes()/1e6);const r=n.getPrimitiveCount();Object.keys(r).forEach((t=>{e[t]||(e[t]=0),e[t]+=r[t]}))}}}else e.invisiblePropCount+=1}))})),e.str=Object.keys(e).map((t=>`${t}: ${e[t]}`)).join("\n"),e},e.captureImages=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o.m.setImmediate(e.render),t._views.map((e=>e.captureNextImage?e.captureNextImage(n,r):void 0)).filter((e=>!!e))},e.addRenderWindow=n=>!t.childRenderWindows.includes(n)&&(t.childRenderWindows.push(n),e.modified(),!0),e.removeRenderWindow=n=>{const r=t.childRenderWindows.findIndex((e=>e===n));return!(r<0||(t.childRenderWindows.splice(r,1),e.modified(),0))}}(e,t)}var d={newInstance:o.m.newInstance(u,"vtkRenderWindow"),extend:u,registerViewConstructor:s,listViewAPIs:function(){return Object.keys(a)},newAPISpecificView:l},p=n(32821);const f={delegates:[],currentOperation:null,preDelegateOperations:[],postDelegateOperations:[],currentParent:null};function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,f,n),o.m.obj(e,t),o.m.get(e,t,["currentOperation"]),o.m.setGet(e,t,["delegates","_currentParent","preDelegateOperations","postDelegateOperations"]),o.m.moveToProtected(e,t,["currentParent"]),function(e,t){t.classHierarchy.push("vtkRenderPass"),e.getOperation=()=>t.currentOperation,e.setCurrentOperation=e=>{t.currentOperation=e,t.currentTraverseOperation=`traverse${o.m.capitalize(t.currentOperation)}`},e.getTraverseOperation=()=>t.currentTraverseOperation,e.traverse=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t.deleted||(t._currentParent=r,t.preDelegateOperations.forEach((t=>{e.setCurrentOperation(t),n.traverse(e)})),t.delegates.forEach((t=>{t.traverse(n,e)})),t.postDelegateOperations.forEach((t=>{e.setCurrentOperation(t),n.traverse(e)})))}}(e,t)}var m={newInstance:o.m.newInstance(h,"vtkRenderPass"),extend:h},g=n(79525),v=n(42008),y=n(71650),b=n(89585),x=n(18713),A=n(13926);const{Representation:C}=b.Ay,{vtkErrorMacro:T}=o.m;function S(e){const t=x.A.substitute(e.Fragment,"//VTK::RenderPassFragmentShader::Impl","\n      float weight = gl_FragData[0].a * pow(max(1.1 - gl_FragCoord.z, 0.0), 2.0);\n      gl_FragData[0] = vec4(gl_FragData[0].rgb*weight, gl_FragData[0].a);\n      gl_FragData[1].r = weight;\n    ",!1);e.Fragment=t.result}const w="//VTK::System::Dec\n\nin vec2 tcoord;\n\nuniform sampler2D translucentRTexture;\nuniform sampler2D translucentRGBATexture;\n\n// the output of this shader\n//VTK::Output::Dec\n\nvoid main()\n{\n  vec4 t1Color = texture(translucentRGBATexture, tcoord);\n  float t2Color = texture(translucentRTexture, tcoord).r;\n  gl_FragData[0] = vec4(t1Color.rgb/max(t2Color,0.01), 1.0 - t1Color.a);\n}\n";const _={framebuffer:null,copyShader:null,tris:null};function I(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,_,n),m.extend(e,t,n),t.VBOBuildTime={},o.m.obj(t.VBOBuildTime,{mtime:0}),t.tris=y.Ay.newInstance(),o.m.get(e,t,["framebuffer"]),function(e,t){t.classHierarchy.push("vtkOpenGLOrderIndependentTranslucentPass"),e.createVertexBuffer=()=>{const e=new Float32Array([-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),n=new Float32Array([0,0,1,0,0,1,1,1]),r=new Uint16Array([4,0,1,3,2]),i=v.Ay.newInstance({numberOfComponents:3,values:e});i.setName("points");const o=v.Ay.newInstance({numberOfComponents:2,values:n});o.setName("tcoords");const a=v.Ay.newInstance({numberOfComponents:1,values:r});t.tris.getCABO().createVBO(a,"polys",C.SURFACE,{points:i,tcoords:o,cellOffset:0}),t.VBOBuildTime.modified()},e.createFramebuffer=e=>{const n=e.getSize(),r=e.getContext();t.framebuffer=p.Ay.newInstance(),t.framebuffer.setOpenGLRenderWindow(e),t.framebuffer.create(...n),t.framebuffer.saveCurrentBindingsAndBuffers(),t.framebuffer.bind(),t.translucentRGBATexture=g.Ay.newInstance(),t.translucentRGBATexture.setInternalFormat(r.RGBA16F),t.translucentRGBATexture.setFormat(r.RGBA),t.translucentRGBATexture.setOpenGLDataType(r.HALF_FLOAT),t.translucentRGBATexture.setOpenGLRenderWindow(e),t.translucentRGBATexture.create2DFromRaw(n[0],n[1],4,"Float32Array",null),t.translucentRTexture=g.Ay.newInstance(),t.translucentRTexture.setInternalFormat(r.R16F),t.translucentRTexture.setFormat(r.RED),t.translucentRTexture.setOpenGLDataType(r.HALF_FLOAT),t.translucentRTexture.setOpenGLRenderWindow(e),t.translucentRTexture.create2DFromRaw(n[0],n[1],1,"Float32Array",null),t.translucentZTexture=g.Ay.newInstance(),t.translucentZTexture.setOpenGLRenderWindow(e),t.translucentZTexture.createDepthFromRaw(n[0],n[1],"Float32Array",null),t.framebuffer.setColorBuffer(t.translucentRGBATexture,0),t.framebuffer.setColorBuffer(t.translucentRTexture,1),t.framebuffer.setDepthBuffer(t.translucentZTexture)},e.createCopyShader=e=>{t.copyShader=e.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","attribute vec2 tcoordTC;","varying vec2 tcoord;","void main() { tcoord = tcoordTC; gl_Position = vertexDC; }"].join("\n"),w,"")},e.createVBO=n=>{const r=n.getContext();t.tris.setOpenGLRenderWindow(n),e.createVertexBuffer();const i=t.copyShader;t.tris.getCABO().bind(),t.copyVAO.addAttributeArray(i,t.tris.getCABO(),"vertexDC",t.tris.getCABO().getVertexOffset(),t.tris.getCABO().getStride(),r.FLOAT,3,r.FALSE)||T("Error setting vertexDC in copy shader VAO."),t.copyVAO.addAttributeArray(i,t.tris.getCABO(),"tcoordTC",t.tris.getCABO().getTCoordOffset(),t.tris.getCABO().getStride(),r.FLOAT,2,r.FALSE)||T("Error setting vertexDC in copy shader VAO.")},e.traverse=(n,r,i)=>{if(t.deleted)return;const o=n.getSize(),a=n.getContext();if(t._supported=!1,r.getSelector()||!a||!n.getWebgl2()||!a.getExtension("EXT_color_buffer_half_float")&&!a.getExtension("EXT_color_buffer_float"))return e.setCurrentOperation("translucentPass"),void r.traverse(e);if(t._supported=!0,null===t.framebuffer)e.createFramebuffer(n);else{const r=t.framebuffer.getSize();null===r||r[0]!==o[0]||r[1]!==o[1]?(t.framebuffer.releaseGraphicsResources(),t.translucentRGBATexture.releaseGraphicsResources(n),t.translucentRTexture.releaseGraphicsResources(n),t.translucentZTexture.releaseGraphicsResources(n),e.createFramebuffer(n)):(t.framebuffer.saveCurrentBindingsAndBuffers(),t.framebuffer.bind())}a.drawBuffers([a.COLOR_ATTACHMENT0]),a.clearBufferfv(a.COLOR,0,[0,0,0,0]),a.clearBufferfv(a.DEPTH,0,[1]),a.colorMask(!1,!1,!1,!1),i.getOpaqueActorCount()>0&&(i.setCurrentOperation("opaqueZBufferPass"),r.traverse(i)),a.colorMask(!0,!0,!0,!0),a.drawBuffers([a.COLOR_ATTACHMENT0,a.COLOR_ATTACHMENT1]),a.viewport(0,0,o[0],o[1]),a.scissor(0,0,o[0],o[1]),a.clearBufferfv(a.COLOR,0,[0,0,0,1]),a.clearBufferfv(a.COLOR,1,[0,0,0,0]),a.enable(a.DEPTH_TEST),a.enable(a.BLEND),a.blendFuncSeparate(a.ONE,a.ONE,a.ZERO,a.ONE_MINUS_SRC_ALPHA),e.setCurrentOperation("translucentPass"),r.traverse(e),a.drawBuffers([a.NONE]),t.framebuffer.restorePreviousBindingsAndBuffers(),null===t.copyShader?e.createCopyShader(n):n.getShaderCache().readyShaderProgram(t.copyShader),t.copyVAO||(t.copyVAO=A.Ay.newInstance(),t.copyVAO.setOpenGLRenderWindow(n)),t.copyVAO.bind(),t.VBOBuildTime.getMTime()<e.getMTime()&&e.createVBO(n),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),a.depthMask(!1),a.depthFunc(a.ALWAYS),a.viewport(0,0,o[0],o[1]),a.scissor(0,0,o[0],o[1]),t.translucentRGBATexture.activate(),t.copyShader.setUniformi("translucentRGBATexture",t.translucentRGBATexture.getTextureUnit()),t.translucentRTexture.activate(),t.copyShader.setUniformi("translucentRTexture",t.translucentRTexture.getTextureUnit()),a.drawArrays(a.TRIANGLES,0,t.tris.getCABO().getElementCount()),a.depthMask(!0),a.depthFunc(a.LEQUAL),t.translucentRGBATexture.deactivate(),t.translucentRTexture.deactivate();const s=r.getTiledSizeAndOrigin();a.scissor(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize),a.viewport(s.lowerLeftU,s.lowerLeftV,s.usize,s.vsize)},e.getShaderReplacement=()=>t._supported?S:null,e.releaseGraphicsResources=n=>{t.framebuffer&&(t.framebuffer.releaseGraphicsResources(n),t.framebuffer=null),t.translucentRGBATexture&&(t.translucentRGBATexture.releaseGraphicsResources(n),t.translucentRGBATexture=null),t.translucentRTexture&&(t.translucentRTexture.releaseGraphicsResources(n),t.translucentRTexture=null),t.translucentZTexture&&(t.translucentZTexture.releaseGraphicsResources(n),t.translucentZTexture=null),t.copyVAO&&(t.copyVAO.releaseGraphicsResources(n),t.copyVAO=null),t.copyShader&&(t.copyShader.releaseGraphicsResources(n),t.copyShader=null),t.tris&&(t.tris.releaseGraphicsResources(n),t.tris=null),e.modified()}}(e,t)}var E={newInstance:o.m.newInstance(I,"vtkOpenGLOrderIndependentTranslucentPass"),extend:I};const D={opaqueActorCount:0,translucentActorCount:0,volumeCount:0,overlayActorCount:0,framebuffer:null,depthRequested:!1};function O(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,D,n),m.extend(e,t,n),o.m.get(e,t,["framebuffer","opaqueActorCount","translucentActorCount","volumeCount"]),function(e,t){t.classHierarchy.push("vtkForwardPass"),e.traverse=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t.deleted)return;t._currentParent=r,e.setCurrentOperation("buildPass"),n.traverse(e);const i=n.getRenderable().getNumberOfLayers(),o=n.getRenderable().getRenderersByReference();for(let r=0;r<i;r++)for(let i=0;i<o.length;i++){const a=o[i],s=n.getViewNodeFor(a);if(a.getDraw()&&a.getLayer()===r){if(t.opaqueActorCount=0,t.translucentActorCount=0,t.volumeCount=0,t.overlayActorCount=0,e.setCurrentOperation("queryPass"),s.traverse(e),(t.opaqueActorCount>0||t.translucentActorCount>0)&&t.volumeCount>0||t.depthRequested){const r=n.getFramebufferSize();null===t.framebuffer&&(t.framebuffer=p.Ay.newInstance()),t.framebuffer.setOpenGLRenderWindow(n),t.framebuffer.saveCurrentBindingsAndBuffers();const i=t.framebuffer.getSize();null!==i&&i[0]===r[0]&&i[1]===r[1]||(t.framebuffer.create(r[0],r[1]),t.framebuffer.populateFramebuffer()),t.framebuffer.bind(),e.setCurrentOperation("zBufferPass"),s.traverse(e),t.framebuffer.restorePreviousBindingsAndBuffers(),t.depthRequested=!1}e.setCurrentOperation("cameraPass"),s.traverse(e),t.opaqueActorCount>0&&(e.setCurrentOperation("opaquePass"),s.traverse(e)),t.translucentActorCount>0&&(t.translucentPass||(t.translucentPass=E.newInstance()),t.translucentPass.traverse(n,s,e)),t.volumeCount>0&&(e.setCurrentOperation("volumePass"),s.traverse(e)),t.overlayActorCount>0&&(e.setCurrentOperation("overlayPass"),s.traverse(e))}}},e.getZBufferTexture=()=>t.framebuffer?t.framebuffer.getColorTexture():null,e.requestDepth=()=>{t.depthRequested=!0},e.incrementOpaqueActorCount=()=>t.opaqueActorCount++,e.incrementTranslucentActorCount=()=>t.translucentActorCount++,e.incrementVolumeCount=()=>t.volumeCount++,e.incrementOverlayActorCount=()=>t.overlayActorCount++}(e,t)}var P={newInstance:o.m.newInstance(O,"vtkForwardPass"),extend:O},R=n(57703),N=n(69147);const{FieldAssociations:M}=N.Ay;const L={fieldAssociation:M.FIELD_ASSOCIATION_CELLS,captureZValues:!1};function F(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,L,n),o.m.obj(e,t),o.m.setGet(e,t,["fieldAssociation","captureZValues"]),function(e,t){t.classHierarchy.push("vtkHardwareSelector"),e.getSourceDataAsync=async(e,t,n,r,i)=>{},e.selectAsync=async(t,n,r,i,o)=>{const a=await e.getSourceDataAsync(t,n,r,i,o);return a?a.generateSelection(n,r,i,o):[]}}(e,t)}var B={newInstance:o.m.newInstance(F,"vtkHardwareSelector"),extend:F};var V={SelectionContent:{GLOBALIDS:0,PEDIGREEIDS:1,VALUES:2,INDICES:3,FRUSTUM:4,LOCATIONS:5,THRESHOLDS:6,BLOCKS:7,QUERY:8},SelectionField:{CELL:0,POINT:1,FIELD:2,VERTEX:3,EDGE:4,ROW:5}};const k={contentType:-1,fieldType:-1,properties:null,selectionList:[]};function U(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,k,n),o.m.obj(e,t),t.properties={},o.m.setGet(e,t,["contentType","fieldType","properties","selectionList"]),function(e,t){t.classHierarchy.push("vtkSelectionNode"),e.getBounds=()=>t.points.getBounds()}(e,t)}var G={newInstance:o.m.newInstance(U,"vtkSelectionNode"),extend:U,...V};const{PassTypes:z}=R.A,{SelectionContent:W,SelectionField:j}=G,{FieldAssociations:H}=N.Ay,{vtkErrorMacro:K}=o.m,q=1;function $(e){return`${e.propID} ${e.compositeID}`}function X(e,t,n,r){if(!n)return 0;return n[4*(t*(r[2]-r[0]+1)+e)+3]}function Y(e,t,n,r){if(!n)return 0;const i=4*(t*(r[2]-r[0]+1)+e),o=n[i],a=n[i+1];return 256*(256*n[i+2]+a)+o}function J(e,t){let n=t;return n<<=24,n|=e,n}function Z(e,t,n,r){const i=n<0?0:n;if(0===i){if(r[0]=t[0],r[1]=t[1],t[0]<e.area[0]||t[0]>e.area[2]||t[1]<e.area[1]||t[1]>e.area[3])return null;const n=[t[0]-e.area[0],t[1]-e.area[1]],i=Y(n[0],n[1],e.pixBuffer[z.ACTOR_PASS],e.area);if(i<=0||i-q>=e.props.length)return null;const o={valid:!0};o.propID=i-q,o.prop=e.props[o.propID];let a=Y(n[0],n[1],e.pixBuffer[z.COMPOSITE_INDEX_PASS],e.area);if((a<0||a>16777215)&&(a=0),o.compositeID=a-q,e.captureZValues){const r=4*(n[1]*(e.area[2]-e.area[0]+1)+n[0]);o.zValue=(256*e.zBuffer[r]+e.zBuffer[r+1])/65535,o.displayPosition=t}if(e.pixBuffer[z.ID_LOW24]&&0===X(n[0],n[1],e.pixBuffer[z.ID_LOW24],e.area))return o;const s=Y(n[0],n[1],e.pixBuffer[z.ID_LOW24],e.area),l=Y(n[0],n[1],e.pixBuffer[z.ID_HIGH24],e.area);return o.attributeID=J(s,l),o}const o=[t[0],t[1]],a=[0,0];let s=Z(e,t,0,r);if(s&&s.valid)return s;for(let t=1;t<i;++t){for(let n=o[1]>t?o[1]-t:0;n<=o[1]+t;++n){if(a[1]=n,o[0]>=t&&(a[0]=o[0]-t,s=Z(e,a,0,r),s&&s.valid))return s;if(a[0]=o[0]+t,s=Z(e,a,0,r),s&&s.valid)return s}for(let n=o[0]>=t?o[0]-(t-1):0;n<=o[0]+(t-1);++n){if(a[0]=n,o[1]>=t&&(a[1]=o[1]-t,s=Z(e,a,0,r),s&&s.valid))return s;if(a[1]=o[1]+t,s=Z(e,a,0,r),s&&s.valid)return s}}return r[0]=t[0],r[1]=t[1],null}function Q(e,t,n,r,i){const o=[];let a=0;return t.forEach(((t,s)=>{const l=G.newInstance();switch(l.setContentType(W.INDICES),e){case H.FIELD_ASSOCIATION_CELLS:l.setFieldType(j.CELL);break;case H.FIELD_ASSOCIATION_POINTS:l.setFieldType(j.POINT);break;default:K("Unknown field association")}l.getProperties().propID=t.info.propID,l.getProperties().prop=t.info.prop,l.getProperties().compositeID=t.info.compositeID,l.getProperties().attributeID=t.info.attributeID,l.getProperties().pixelCount=t.pixelCount,n&&(l.getProperties().displayPosition=[t.info.displayPosition[0],t.info.displayPosition[1],t.info.zValue],l.getProperties().worldPosition=i.displayToWorld(t.info.displayPosition[0],t.info.displayPosition[1],t.info.zValue,r)),l.setSelectionList(t.attributeIDs),o[a]=l,a++})),o}function ee(e,t){t.classHierarchy.push("vtkOpenGLHardwareSelector"),e.releasePixBuffers=()=>{t.rawPixBuffer=[],t.pixBuffer=[],t.zBuffer=null},e.beginSelection=()=>{t._openGLRenderer=t._openGLRenderWindow.getViewNodeFor(t._renderer),t.maxAttributeId=0;const n=t._openGLRenderWindow.getSize();if(t.framebuffer){t.framebuffer.setOpenGLRenderWindow(t._openGLRenderWindow),t.framebuffer.saveCurrentBindingsAndBuffers();const e=t.framebuffer.getSize();e&&e[0]===n[0]&&e[1]===n[1]?t.framebuffer.bind():(t.framebuffer.create(n[0],n[1]),t.framebuffer.populateFramebuffer())}else t.framebuffer=p.Ay.newInstance(),t.framebuffer.setOpenGLRenderWindow(t._openGLRenderWindow),t.framebuffer.saveCurrentBindingsAndBuffers(),t.framebuffer.create(n[0],n[1]),t.framebuffer.populateFramebuffer();if(t._openGLRenderer.clear(),t._openGLRenderer.setSelector(e),t.hitProps={},t.propPixels={},t.props=[],e.releasePixBuffers(),t.fieldAssociation===H.FIELD_ASSOCIATION_POINTS){const e=t._openGLRenderWindow.getContext(),n=e.isEnabled(e.BLEND);e.disable(e.BLEND),t._openGLRenderWindow.traverseAllPasses(),n&&e.enable(e.BLEND)}},e.endSelection=()=>{t.hitProps={},t._openGLRenderer.setSelector(null),t.framebuffer.restorePreviousBindingsAndBuffers()},e.preCapturePass=()=>{const e=t._openGLRenderWindow.getContext();t.originalBlending=e.isEnabled(e.BLEND),e.disable(e.BLEND)},e.postCapturePass=()=>{const e=t._openGLRenderWindow.getContext();t.originalBlending&&e.enable(e.BLEND)},e.select=()=>{let n=null;return e.captureBuffers()&&(n=e.generateSelection(t.area[0],t.area[1],t.area[2],t.area[3]),e.releasePixBuffers()),n},e.getSourceDataAsync=async(n,r,i,o,a)=>{if(t._renderer=n,void 0===r){const n=t._openGLRenderWindow.getSize();e.setArea(0,0,n[0]-1,n[1]-1)}else e.setArea(r,i,o,a);if(!e.captureBuffers())return!1;const s={area:[...t.area],pixBuffer:[...t.pixBuffer],captureZValues:t.captureZValues,zBuffer:t.zBuffer,props:[...t.props],fieldAssociation:t.fieldAssociation,renderer:n,openGLRenderWindow:t._openGLRenderWindow};return s.generateSelection=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,t,n,r,i){const o=Math.floor(t),a=Math.floor(n),s=Math.floor(r),l=Math.floor(i),c=new Map,u=[0,0];for(let t=a;t<=l;t++)for(let n=o;n<=s;n++){const r=Z(e,[n,t],0,u);if(r&&r.valid){const t=$(r);if(c.has(t)){const n=c.get(t);n.pixelCount++,e.captureZValues&&r.zValue<n.info.zValue&&(n.info=r),-1===n.attributeIDs.indexOf(r.attributeID)&&n.attributeIDs.push(r.attributeID)}else c.set(t,{info:r,pixelCount:1,attributeIDs:[r.attributeID]})}}return Q(e.fieldAssociation,c,e.captureZValues,e.renderer,e.openGLRenderWindow)}(s,...t)},s},e.captureBuffers=()=>{if(!t._renderer||!t._openGLRenderWindow)return K("Renderer and view must be set before calling Select."),!1;t._openGLRenderer=t._openGLRenderWindow.getViewNodeFor(t._renderer),t._openGLRenderWindow.getRenderable().preRender(),e.invokeEvent({type:"StartEvent"}),t.originalBackground=t._renderer.getBackgroundByReference(),t._renderer.setBackground(0,0,0,0);const n=t._openGLRenderWindow.getRenderPasses();e.beginSelection();const r=[];for(t.currentPass=z.MIN_KNOWN_PASS;t.currentPass<=z.MAX_KNOWN_PASS;t.currentPass++)e.passRequired(t.currentPass)&&(e.preCapturePass(t.currentPass),t.captureZValues&&t.currentPass===z.ACTOR_PASS&&"function"==typeof n[0].requestDepth&&"function"==typeof n[0].getFramebuffer?(n[0].requestDepth(),t._openGLRenderWindow.traverseAllPasses()):t._openGLRenderWindow.traverseAllPasses(),e.postCapturePass(t.currentPass),e.savePixelBuffer(t.currentPass),r.push(t.currentPass));return r.forEach((n=>{t.currentPass=n,e.processPixelBuffers()})),t.currentPass=z.MAX_KNOWN_PASS,e.endSelection(),t._renderer.setBackground(t.originalBackground),e.invokeEvent({type:"EndEvent"}),!0},e.processPixelBuffers=()=>{t.props.forEach(((n,r)=>{e.isPropHit(r)&&n.processSelectorPixelBuffers(e,t.propPixels[r])}))},e.passRequired=e=>{if(e===z.ID_HIGH24){if(t.fieldAssociation===H.FIELD_ASSOCIATION_POINTS)return t.maximumPointId>16777215;if(t.fieldAssociation===H.FIELD_ASSOCIATION_CELLS)return t.maximumCellId>16777215}return!0},e.savePixelBuffer=n=>{if(t.pixBuffer[n]=t._openGLRenderWindow.getPixelData(t.area[0],t.area[1],t.area[2],t.area[3]),!t.rawPixBuffer[n]){const e=(t.area[2]-t.area[0]+1)*(t.area[3]-t.area[1]+1)*4;t.rawPixBuffer[n]=new Uint8Array(e),t.rawPixBuffer[n].set(t.pixBuffer[n])}if(n===z.ACTOR_PASS){if(t.captureZValues){const e=t._openGLRenderWindow.getRenderPasses();if("function"==typeof e[0].requestDepth&&"function"==typeof e[0].getFramebuffer){const n=e[0].getFramebuffer();n.saveCurrentBindingsAndBuffers(),n.bind(),t.zBuffer=t._openGLRenderWindow.getPixelData(t.area[0],t.area[1],t.area[2],t.area[3]),n.restorePreviousBindingsAndBuffers()}}e.buildPropHitList(t.rawPixBuffer[n])}},e.buildPropHitList=e=>{let n=0;for(let r=0;r<=t.area[3]-t.area[1];r++)for(let i=0;i<=t.area[2]-t.area[0];i++){let o=Y(i,r,e,t.area);o>0&&(o--,o in t.hitProps||(t.hitProps[o]=!0,t.propPixels[o]=[]),t.propPixels[o].push(4*n)),++n}},e.renderProp=n=>{t.currentPass===z.ACTOR_PASS&&(e.setPropColorValueFromInt(t.props.length+q),t.props.push(n))},e.renderCompositeIndex=n=>{t.currentPass===z.COMPOSITE_INDEX_PASS&&e.setPropColorValueFromInt(n+q)},e.renderAttributeId=e=>{e<0||(t.maxAttributeId=e>t.maxAttributeId?e:t.maxAttributeId)},e.passTypeToString=e=>o.m.enumToString(z,e),e.isPropHit=e=>Boolean(t.hitProps[e]),e.setPropColorValueFromInt=e=>{t.propColorValue[0]=e%256/255,t.propColorValue[1]=Math.floor(e/256)%256/255,t.propColorValue[2]=Math.floor(e/65536)%256/255},e.getPixelInformation=(n,r,i)=>{const o=r<0?0:r;if(0===o){if(i[0]=n[0],i[1]=n[1],n[0]<t.area[0]||n[0]>t.area[2]||n[1]<t.area[1]||n[1]>t.area[3])return null;const e=[n[0]-t.area[0],n[1]-t.area[1]],r=Y(e[0],e[1],t.pixBuffer[z.ACTOR_PASS],t.area);if(r<=0||r-q>=t.props.length)return null;const o={valid:!0};o.propID=r-q,o.prop=t.props[o.propID];let a=Y(e[0],e[1],t.pixBuffer[z.COMPOSITE_INDEX_PASS],t.area);if((a<0||a>16777215)&&(a=0),o.compositeID=a-q,t.captureZValues){const r=4*(e[1]*(t.area[2]-t.area[0]+1)+e[0]);o.zValue=(256*t.zBuffer[r]+t.zBuffer[r+1])/65535,o.displayPosition=n}if(t.pixBuffer[z.ID_LOW24]&&0===X(e[0],e[1],t.pixBuffer[z.ID_LOW24],t.area))return o;const s=Y(e[0],e[1],t.pixBuffer[z.ID_LOW24],t.area),l=Y(e[0],e[1],t.pixBuffer[z.ID_HIGH24],t.area);return o.attributeID=J(s,l),o}const a=[n[0],n[1]],s=[0,0];let l=e.getPixelInformation(n,0,i);if(l&&l.valid)return l;for(let t=1;t<o;++t){for(let n=a[1]>t?a[1]-t:0;n<=a[1]+t;++n){if(s[1]=n,a[0]>=t&&(s[0]=a[0]-t,l=e.getPixelInformation(s,0,i),l&&l.valid))return l;if(s[0]=a[0]+t,l=e.getPixelInformation(s,0,i),l&&l.valid)return l}for(let n=a[0]>=t?a[0]-(t-1):0;n<=a[0]+(t-1);++n){if(s[0]=n,a[1]>=t&&(s[1]=a[1]-t,l=e.getPixelInformation(s,0,i),l&&l.valid))return l;if(s[1]=a[1]+t,l=e.getPixelInformation(s,0,i),l&&l.valid)return l}}return i[0]=n[0],i[1]=n[1],null},e.generateSelection=(n,r,i,o)=>{const a=Math.floor(n),s=Math.floor(r),l=Math.floor(i),c=Math.floor(o),u=new Map,d=[0,0];for(let n=s;n<=c;n++)for(let r=a;r<=l;r++){const i=[r,n],o=e.getPixelInformation(i,0,d);if(o&&o.valid){const e=$(o);if(u.has(e)){const n=u.get(e);n.pixelCount++,t.captureZValues&&o.zValue<n.info.zValue&&(n.info=o),-1===n.attributeIDs.indexOf(o.attributeID)&&n.attributeIDs.push(o.attributeID)}else u.set(e,{info:o,pixelCount:1,attributeIDs:[o.attributeID]})}}return Q(t.fieldAssociation,u,t.captureZValues,t._renderer,t._openGLRenderWindow)},e.getRawPixelBuffer=e=>t.rawPixBuffer[e],e.getPixelBuffer=e=>t.pixBuffer[e],e.attach=(e,n)=>{t._openGLRenderWindow=e,t._renderer=n};const n=e.setArea;e.setArea=function(){return!!n(...arguments)&&(t.area[0]=Math.floor(t.area[0]),t.area[1]=Math.floor(t.area[1]),t.area[2]=Math.floor(t.area[2]),t.area[3]=Math.floor(t.area[3]),!0)}}const te={area:void 0,currentPass:-1,propColorValue:null,props:null,maximumPointId:0,maximumCellId:0,idOffset:1};function ne(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,te,n),B.extend(e,t,n),t.propColorValue=[0,0,0],t.props=[],t.area||(t.area=[0,0,0,0]),o.m.setGetArray(e,t,["area"],4),o.m.setGet(e,t,["_renderer","currentPass","_openGLRenderWindow","maximumPointId","maximumCellId"]),o.m.setGetArray(e,t,["propColorValue"],3),o.m.moveToProtected(e,t,["renderer","openGLRenderWindow"]),o.m.event(e,t,"event"),ee(e,t)}var re={newInstance:o.m.newInstance(ne,"vtkOpenGLHardwareSelector"),extend:ne,...R.A},ie=n(10989),oe=n.n(ie);const ae=["lastShaderProgramBound","context","_openGLRenderWindow"];const se={lastShaderProgramBound:null,shaderPrograms:null,context:null};function le(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,se,n),t.shaderPrograms={},o.m.obj(e,t),o.m.setGet(e,t,ae),o.m.moveToProtected(e,t,["openGLRenderWindow"]),function(e,t){t.classHierarchy.push("vtkShaderCache"),e.replaceShaderValues=(e,n,r)=>{let i=n;r.length>0&&(i=x.A.substitute(i,"VSOut","GSOut").result);const o=t._openGLRenderWindow.getWebgl2();let a="\n",s="#version 100\n";o?s="#version 300 es\n#define attribute in\n#define textureCube texture\n#define texture2D texture\n#define textureCubeLod textureLod\n#define texture2DLod textureLod\n":(t.context.getExtension("OES_standard_derivatives"),t.context.getExtension("EXT_frag_depth")&&(a="#extension GL_EXT_frag_depth : enable\n"),t.context.getExtension("EXT_shader_texture_lod")&&(a+="#extension GL_EXT_shader_texture_lod : enable\n#define textureCubeLod textureCubeLodEXT\n#define texture2DLod texture2DLodEXT")),i=x.A.substitute(i,"//VTK::System::Dec",[`${s}\n`,o?"":"#extension GL_OES_standard_derivatives : enable\n",a,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;let l=x.A.substitute(e,"//VTK::System::Dec",[`${s}\n`,"#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","precision highp int;","#else","precision mediump float;","precision mediump int;","#endif"]).result;if(o){l=x.A.substitute(l,"varying","out").result,i=x.A.substitute(i,"varying","in").result;let e="",t=0;for(;i.includes(`gl_FragData[${t}]`);)i=x.A.substitute(i,`gl_FragData\\[${t}\\]`,`fragOutput${t}`).result,e+=`layout(location = ${t}) out vec4 fragOutput${t};\n`,t++;i=x.A.substitute(i,"//VTK::Output::Dec",e).result}return{VSSource:l,FSSource:i,GSSource:x.A.substitute(r,"//VTK::System::Dec",s).result}},e.readyShaderProgramArray=(t,n,r)=>{const i=e.replaceShaderValues(t,n,r),o=e.getShaderProgram(i.VSSource,i.FSSource,i.GSSource);return e.readyShaderProgram(o)},e.readyShaderProgram=t=>t&&(t.getCompiled()||t.compileShader())&&e.bindShaderProgram(t)?t:null,e.getShaderProgram=(e,n,r)=>{const i=`${e}${n}${r}`,o=oe().hash(i);if(!(o in t.shaderPrograms)){const i=x.A.newInstance();return i.setContext(t.context),i.getVertexShader().setSource(e),i.getFragmentShader().setSource(n),r&&i.getGeometryShader().setSource(r),i.setMd5Hash(o),t.shaderPrograms[o]=i,i}return t.shaderPrograms[o]},e.releaseGraphicsResources=n=>{e.releaseCurrentShaderProgram(),Object.keys(t.shaderPrograms).map((e=>t.shaderPrograms[e])).forEach((e=>e.cleanup())),t.shaderPrograms={}},e.releaseCurrentShaderProgram=()=>{t.lastShaderProgramBound&&(t.lastShaderProgramBound.cleanup(),t.lastShaderProgramBound=null)},e.bindShaderProgram=e=>(t.lastShaderProgramBound===e||(t.lastShaderProgramBound&&t.lastShaderProgramBound.release(),e.bind(),t.lastShaderProgramBound=e),1)}(e,t)}var ce={newInstance:o.m.newInstance(le,"vtkShaderCache"),extend:le};const{vtkErrorMacro:ue}=o.m;const de={context:null,numberOfTextureUnits:0,textureUnits:0};function pe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,de,n),o.m.obj(e,t),t.textureUnits=[],o.m.get(e,t,["numberOfTextureUnits"]),o.m.setGet(e,t,["context"]),function(e,t){t.classHierarchy.push("vtkOpenGLTextureUnitManager"),e.deleteTable=()=>{for(let e=0;e<t.numberOfTextureUnits;++e)!0===t.textureUnits[e]&&ue("some texture units  were not properly released");t.textureUnits=[],t.numberOfTextureUnits=0},e.setContext=n=>{if(t.context!==n){if(0!==t.context&&e.deleteTable(),t.context=n,t.context){t.numberOfTextureUnits=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS);for(let e=0;e<t.numberOfTextureUnits;++e)t.textureUnits[e]=!1}e.modified()}},e.allocate=()=>{for(let n=0;n<t.numberOfTextureUnits;n++)if(!e.isAllocated(n))return t.textureUnits[n]=!0,n;return-1},e.allocateUnit=n=>e.isAllocated(n)?-1:(t.textureUnits[n]=!0,n),e.isAllocated=e=>t.textureUnits[e],e.free=e=>{t.textureUnits[e]=!1},e.freeAll=()=>{for(let e=0;e<t.numberOfTextureUnits;++e)t.textureUnits[e]=!1}}(e,t)}var fe={newInstance:o.m.newInstance(pe,"vtkOpenGLTextureUnitManager"),extend:pe},he=n(88691),me=n(25196);const ge={size:void 0,selector:void 0};function ve(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ge,n),t.size||(t.size=[300,300]),o.m.getArray(e,t,["size"],2),o.m.get(e,t,["selector"]),me.A.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkRenderWindowViewNode"),e.getViewNodeFactory=()=>null,e.getAspectRatio=()=>t.size[0]/t.size[1],e.getAspectRatioForRenderer=e=>{const n=e.getViewportByReference();return t.size[0]*(n[2]-n[0])/((n[3]-n[1])*t.size[1])},e.isInViewport=(t,n,r)=>{const i=r.getViewportByReference(),o=e.getFramebufferSize();return i[0]*o[0]<=t&&i[2]*o[0]>=t&&i[1]*o[1]<=n&&i[3]*o[1]>=n},e.getViewportSize=t=>{const n=t.getViewportByReference(),r=e.getFramebufferSize();return[(n[2]-n[0])*r[0],(n[3]-n[1])*r[1]]},e.getViewportCenter=t=>{const n=e.getViewportSize(t);return[.5*n[0],.5*n[1]]},e.displayToNormalizedDisplay=(t,n,r)=>{const i=e.getFramebufferSize();return[t/i[0],n/i[1],r]},e.normalizedDisplayToDisplay=(t,n,r)=>{const i=e.getFramebufferSize();return[t*i[0],n*i[1],r]},e.worldToView=(e,t,n,r)=>r.worldToView(e,t,n),e.viewToWorld=(e,t,n,r)=>r.viewToWorld(e,t,n),e.worldToDisplay=(t,n,r,i)=>{const o=i.worldToView(t,n,r),a=e.getViewportSize(i),s=i.viewToProjection(o[0],o[1],o[2],a[0]/a[1]),l=i.projectionToNormalizedDisplay(s[0],s[1],s[2]);return e.normalizedDisplayToDisplay(l[0],l[1],l[2])},e.displayToWorld=(t,n,r,i)=>{const o=e.displayToNormalizedDisplay(t,n,r),a=i.normalizedDisplayToProjection(o[0],o[1],o[2]),s=e.getViewportSize(i),l=i.projectionToView(a[0],a[1],a[2],s[0]/s[1]);return i.viewToWorld(l[0],l[1],l[2])},e.normalizedDisplayToViewport=(t,n,r,i)=>{let o=i.getViewportByReference();o=e.normalizedDisplayToDisplay(o[0],o[1],0);const a=e.normalizedDisplayToDisplay(t,n,r);return[a[0]-o[0]-.5,a[1]-o[1]-.5,r]},e.viewportToNormalizedViewport=(t,n,r,i)=>{const o=e.getViewportSize(i);return o&&0!==o[0]&&0!==o[1]?[t/(o[0]-1),n/(o[1]-1),r]:[t,n,r]},e.normalizedViewportToViewport=(t,n,r,i)=>{const o=e.getViewportSize(i);return[t*(o[0]-1),n*(o[1]-1),r]},e.displayToLocalDisplay=(t,n,r)=>[t,e.getFramebufferSize()[1]-n-1,r],e.viewportToNormalizedDisplay=(t,n,r,i)=>{let o=i.getViewportByReference();o=e.normalizedDisplayToDisplay(o[0],o[1],0);const a=t+o[0]+.5,s=n+o[1]+.5;return e.displayToNormalizedDisplay(a,s,r)},e.getComputedDevicePixelRatio=()=>t.size[0]/e.getContainerSize()[0],e.getContainerSize=()=>{o.m.vtkErrorMacro("not implemented")},e.getPixelData=(e,t,n,r)=>{o.m.vtkErrorMacro("not implemented")},e.createSelector=()=>{o.m.vtkErrorMacro("not implemented")}}(e,t)}var ye={newInstance:o.m.newInstance(ve,"vtkRenderWindowViewNode"),extend:ve};const be="__getUnderlyingContext";function xe(){const e=new Map,t={apply:(t,n,r)=>e.has(r[0])?e.get(r[0]):t.apply(n,r)};const n=Object.create(null);return n.getParameter=(e,n,r,i)=>new Proxy(i.bind(e),t),n.depthMask=(t,n,r,i)=>{return new Proxy(i.bind(t),(o=t.DEPTH_WRITEMASK,{apply:(t,n,r)=>(e.set(o,r[0]),t.apply(n,r))}));var o},{get(e,t,r){if(t===be)return()=>e;let i=Reflect.get(e,t,e);i instanceof Function&&(i=i.bind(e));const o=n[t];return o?o(e,t,r,i):i}}}const{vtkDebugMacro:Ae,vtkErrorMacro:Ce}=o.m,Te={position:"absolute",top:0,left:0,width:"100%",height:"100%"},Se=["activateTexture","deactivateTexture","disableCullFace","enableCullFace","get3DContext","getActiveFramebuffer","getContext","getDefaultTextureByteSize","getDefaultTextureInternalFormat","getDefaultToWebgl2","getGLInformations","getGraphicsMemoryInfo","getGraphicsResourceForObject","getHardwareMaximumLineWidth","getPixelData","getShaderCache","getTextureUnitForTexture","getTextureUnitManager","getWebgl2","makeCurrent","releaseGraphicsResources","registerGraphicsResourceUser","unregisterGraphicsResourceUser","restoreContext","setActiveFramebuffer","setContext","setDefaultToWebgl2","setGraphicsResourceForObject"];function we(e,t,n){const r=e.createFramebuffer(),i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,t,2,2,0,t,n,null),e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER);return e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,null),o===e.FRAMEBUFFER_COMPLETE}let _e=0;const Ie=[];function Ee(e){e.preventDefault()}function De(e,t){let n;t.classHierarchy.push("vtkOpenGLRenderWindow"),e.getViewNodeFactory=()=>t.myFactory,t.canvas.addEventListener("webglcontextlost",Ee,!1),t.canvas.addEventListener("webglcontextrestored",e.restoreContext,!1);const r=[0,0];let a;e.onModified((function(){t.renderable&&(t.size[0]===r[0]&&t.size[1]===r[1]||(r[0]=t.size[0],r[1]=t.size[1],t.canvas.setAttribute("width",t.size[0]),t.canvas.setAttribute("height",t.size[1]))),t.viewStream&&t.viewStream.setSize(t.size[0],t.size[1]),t.canvas.style.display=t.useOffScreen?"none":"block",t.el&&(t.el.style.cursor=t.cursorVisibility?t.cursor:"none"),t.containerSize=null})),e.buildPass=n=>{if(n){if(!t.renderable)return;e.prepareNodes(),e.addMissingNodes(t.renderable.getRenderersByReference()),e.addMissingNodes(t.renderable.getChildRenderWindowsByReference()),e.removeUnusedNodes(),e.initialize(),t.children.forEach((t=>{t.setOpenGLRenderWindow?.(e)}))}},e.initialize=()=>{if(!t.initialized){if(t.rootOpenGLRenderWindow=e.getLastAncestorOfType("vtkOpenGLRenderWindow"),t.rootOpenGLRenderWindow)t.context2D=e.get2DContext();else{t.context=e.get3DContext(),e.resizeFromChildRenderWindows(),t.context&&(_e++,Ie.forEach((e=>e(_e)))),t.textureUnitManager=fe.newInstance(),t.textureUnitManager.setContext(t.context),t.shaderCache.setContext(t.context);const n=t.context;n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),n.depthFunc(n.LEQUAL),n.enable(n.BLEND)}t.initialized=!0}},e.makeCurrent=()=>{t.context.makeCurrent()},e.setContainer=n=>{t.el&&t.el!==n&&(t.canvas.parentNode!==t.el&&Ce("Error: canvas parent node does not match container"),t.el.removeChild(t.canvas),t.el.contains(t.bgImage)&&t.el.removeChild(t.bgImage)),t.el!==n&&(t.el=n,t.el&&(t.el.appendChild(t.canvas),t.useBackgroundImage&&t.el.appendChild(t.bgImage)),e.modified())},e.getContainer=()=>t.el,e.getContainerSize=()=>{if(!t.containerSize&&t.el){const{width:e,height:n}=t.el.getBoundingClientRect();t.containerSize=[e,n]}return t.containerSize||t.size},e.getFramebufferSize=()=>{const e=t.activeFramebuffer?.getSize();return e||t.size},e.getPixelData=(e,n,r,i)=>{const o=new Uint8Array((r-e+1)*(i-n+1)*4);return t.context.readPixels(e,n,r-e+1,i-n+1,t.context.RGBA,t.context.UNSIGNED_BYTE,o),o},e.get3DContext=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{preserveDrawingBuffer:!1,depth:!0,alpha:!0,powerPreference:"high-performance"},r=null;const i="undefined"!=typeof WebGL2RenderingContext;return t.webgl2=!1,t.defaultToWebgl2&&i&&(r=t.canvas.getContext("webgl2",e),r&&(t.webgl2=!0,Ae("using webgl2"))),r||(Ae("using webgl1"),r=t.canvas.getContext("webgl",e)||t.canvas.getContext("experimental-webgl",e)),new Proxy(r,(n||(n=xe()),n))},e.get2DContext=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.canvas.getContext("2d",e)},e.restoreContext=()=>{const t=m.newInstance();t.setCurrentOperation("Release"),t.traverse(e,null)},e.activateTexture=n=>{const r=t._textureResourceIds.get(n);if(void 0!==r)return void t.context.activeTexture(t.context.TEXTURE0+r);const i=e.getTextureUnitManager().allocate();i<0?Ce("Hardware does not support the number of textures defined."):(t._textureResourceIds.set(n,i),t.context.activeTexture(t.context.TEXTURE0+i))},e.deactivateTexture=n=>{const r=t._textureResourceIds.get(n);void 0!==r&&(e.getTextureUnitManager().free(r),t._textureResourceIds.delete(n))},e.getTextureUnitForTexture=e=>{const n=t._textureResourceIds.get(e);return void 0!==n?n:-1},e.getDefaultTextureByteSize=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.webgl2)switch(e){case i.JA.CHAR:case i.JA.SIGNED_CHAR:case i.JA.UNSIGNED_CHAR:return 1;case n:case r:case i.JA.UNSIGNED_SHORT:case i.JA.SHORT:case i.JA.VOID:return 2;default:return 4}return 1},e.getDefaultTextureInternalFormat=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.webgl2)switch(e){case i.JA.UNSIGNED_CHAR:switch(n){case 1:return t.context.R8;case 2:return t.context.RG8;case 3:return t.context.RGB8;default:return t.context.RGBA8}case r&&!o&&i.JA.UNSIGNED_SHORT:switch(n){case 1:return r.R16_EXT;case 2:return r.RG16_EXT;case 3:return r.RGB16_EXT;default:return r.RGBA16_EXT}case r&&!o&&i.JA.SHORT:switch(n){case 1:return r.R16_SNORM_EXT;case 2:return r.RG16_SNORM_EXT;case 3:return r.RGB16_SNORM_EXT;default:return r.RGBA16_SNORM_EXT}case i.JA.UNSIGNED_SHORT:case i.JA.SHORT:case i.JA.FLOAT:default:switch(n){case 1:return o?t.context.R16F:t.context.R32F;case 2:return o?t.context.RG16F:t.context.RG32F;case 3:return o?t.context.RGB16F:t.context.RGB32F;default:return o?t.context.RGBA16F:t.context.RGBA32F}}switch(n){case 1:return t.context.LUMINANCE;case 2:return t.context.LUMINANCE_ALPHA;case 3:return t.context.RGB;default:return t.context.RGBA}},e.setBackgroundImage=e=>{t.bgImage.src=e.src},e.setUseBackgroundImage=e=>{t.useBackgroundImage=e,t.useBackgroundImage&&!t.el.contains(t.bgImage)?t.el.appendChild(t.bgImage):!t.useBackgroundImage&&t.el.contains(t.bgImage)&&t.el.removeChild(t.bgImage)},e.captureNextImage=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",{resetCamera:r=!1,size:i=null,scale:o=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.deleted)return null;t.imageFormat=n;const a=t.notifyStartCaptureImage;return t.notifyStartCaptureImage=!0,t._screenshot={size:i||1!==o?i||t.size.map((e=>e*o)):null},new Promise(((n,i)=>{const o=e.onImageReady((i=>{if(null===t._screenshot.size)t.notifyStartCaptureImage=a,o.unsubscribe(),t._screenshot.placeHolder&&(t.size=t._screenshot.originalSize,e.modified(),t._screenshot.cameras&&t._screenshot.cameras.forEach((e=>{let{restoreParamsFn:t,arg:n}=e;return t(n)})),e.traverseAllPasses(),t.el.removeChild(t._screenshot.placeHolder),t._screenshot.placeHolder.remove(),t._screenshot=null),n(i);else{const n=document.createElement("img");if(n.style=Te,n.src=i,t._screenshot.placeHolder=t.el.appendChild(n),t.canvas.style.display="none",t._screenshot.originalSize=t.size,t.size=t._screenshot.size,t.rootOpenGLRenderWindow?.resizeFromChildRenderWindows(),t._screenshot.size=null,e.modified(),r){const e=!0!==r;t._screenshot.cameras=t.renderable.getRenderers().map((t=>{const n=t.getActiveCamera(),i=n.get("focalPoint","position","parallelScale");return{resetCameraArgs:e?{renderer:t}:void 0,resetCameraFn:e?r:t.resetCamera,restoreParamsFn:n.set,arg:JSON.parse(JSON.stringify(i))}})),t._screenshot.cameras.forEach((e=>{let{resetCameraFn:t,resetCameraArgs:n}=e;return t(n)}))}e.traverseAllPasses()}}))}))},e.getHardwareMaximumLineWidth=()=>{if(null!=a)return a;const t=e.get3DContext(),n=t.getParameter(t.ALIASED_LINE_WIDTH_RANGE);return a=n[1],n[1]},e.getGLInformations=()=>{if(t._glInformation)return t._glInformation;const n=e.get3DContext(),r=n.getExtension("OES_texture_float"),i=n.getExtension("OES_texture_half_float"),o=n.getExtension("WEBGL_debug_renderer_info"),a=n.getExtension("WEBGL_draw_buffers"),s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),l=[["Max Vertex Attributes","MAX_VERTEX_ATTRIBS",n.getParameter(n.MAX_VERTEX_ATTRIBS)],["Max Varying Vectors","MAX_VARYING_VECTORS",n.getParameter(n.MAX_VARYING_VECTORS)],["Max Vertex Uniform Vectors","MAX_VERTEX_UNIFORM_VECTORS",n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS)],["Max Fragment Uniform Vectors","MAX_FRAGMENT_UNIFORM_VECTORS",n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS)],["Max Fragment Texture Image Units","MAX_TEXTURE_IMAGE_UNITS",n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)],["Max Vertex Texture Image Units","MAX_VERTEX_TEXTURE_IMAGE_UNITS",n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)],["Max Combined Texture Image Units","MAX_COMBINED_TEXTURE_IMAGE_UNITS",n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS)],["Max 2D Texture Size","MAX_TEXTURE_SIZE",n.getParameter(n.MAX_TEXTURE_SIZE)],["Max Cube Texture Size","MAX_CUBE_MAP_TEXTURE_SIZE",n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE)],["Max Texture Anisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT",s&&n.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT)],["Point Size Range","ALIASED_POINT_SIZE_RANGE",n.getParameter(n.ALIASED_POINT_SIZE_RANGE).join(" - ")],["Line Width Range","ALIASED_LINE_WIDTH_RANGE",n.getParameter(n.ALIASED_LINE_WIDTH_RANGE).join(" - ")],["Max Viewport Dimensions","MAX_VIEWPORT_DIMS",n.getParameter(n.MAX_VIEWPORT_DIMS).join(" - ")],["Max Renderbuffer Size","MAX_RENDERBUFFER_SIZE",n.getParameter(n.MAX_RENDERBUFFER_SIZE)],["Framebuffer Red Bits","RED_BITS",n.getParameter(n.RED_BITS)],["Framebuffer Green Bits","GREEN_BITS",n.getParameter(n.GREEN_BITS)],["Framebuffer Blue Bits","BLUE_BITS",n.getParameter(n.BLUE_BITS)],["Framebuffer Alpha Bits","ALPHA_BITS",n.getParameter(n.ALPHA_BITS)],["Framebuffer Depth Bits","DEPTH_BITS",n.getParameter(n.DEPTH_BITS)],["Framebuffer Stencil Bits","STENCIL_BITS",n.getParameter(n.STENCIL_BITS)],["Framebuffer Subpixel Bits","SUBPIXEL_BITS",n.getParameter(n.SUBPIXEL_BITS)],["MSAA Samples","SAMPLES",n.getParameter(n.SAMPLES)],["MSAA Sample Buffers","SAMPLE_BUFFERS",n.getParameter(n.SAMPLE_BUFFERS)],["Supported Formats for UByte Render Targets     ","UNSIGNED_BYTE RENDER TARGET FORMATS",[r&&we(n,n.RGBA,n.UNSIGNED_BYTE)?"RGBA":"",r&&we(n,n.RGB,n.UNSIGNED_BYTE)?"RGB":"",r&&we(n,n.LUMINANCE,n.UNSIGNED_BYTE)?"LUMINANCE":"",r&&we(n,n.ALPHA,n.UNSIGNED_BYTE)?"ALPHA":"",r&&we(n,n.LUMINANCE_ALPHA,n.UNSIGNED_BYTE)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Half Float Render Targets","HALF FLOAT RENDER TARGET FORMATS",[i&&we(n,n.RGBA,i.HALF_FLOAT_OES)?"RGBA":"",i&&we(n,n.RGB,i.HALF_FLOAT_OES)?"RGB":"",i&&we(n,n.LUMINANCE,i.HALF_FLOAT_OES)?"LUMINANCE":"",i&&we(n,n.ALPHA,i.HALF_FLOAT_OES)?"ALPHA":"",i&&we(n,n.LUMINANCE_ALPHA,i.HALF_FLOAT_OES)?"LUMINANCE_ALPHA":""].join(" ")],["Supported Formats for Full Float Render Targets","FLOAT RENDER TARGET FORMATS",[r&&we(n,n.RGBA,n.FLOAT)?"RGBA":"",r&&we(n,n.RGB,n.FLOAT)?"RGB":"",r&&we(n,n.LUMINANCE,n.FLOAT)?"LUMINANCE":"",r&&we(n,n.ALPHA,n.FLOAT)?"ALPHA":"",r&&we(n,n.LUMINANCE_ALPHA,n.FLOAT)?"LUMINANCE_ALPHA":""].join(" ")],["Max Multiple Render Targets Buffers","MAX_DRAW_BUFFERS_WEBGL",a?n.getParameter(a.MAX_DRAW_BUFFERS_WEBGL):0],["High Float Precision in Vertex Shader","HIGH_FLOAT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Vertex Shader","MEDIUM_FLOAT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Vertex Shader","LOW_FLOAT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Float Precision in Fragment Shader","HIGH_FLOAT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).rangeMax,"</sup>)"].join("")],["Medium Float Precision in Fragment Shader","MEDIUM_FLOAT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).rangeMax,"</sup>)"].join("")],["Low Float Precision in Fragment Shader","LOW_FLOAT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).rangeMax,"</sup>)"].join("")],["High Int Precision in Vertex Shader","HIGH_INT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Vertex Shader","MEDIUM_INT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Vertex Shader","LOW_INT VERTEX_SHADER",[n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).rangeMax,"</sup>)"].join("")],["High Int Precision in Fragment Shader","HIGH_INT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).rangeMax,"</sup>)"].join("")],["Medium Int Precision in Fragment Shader","MEDIUM_INT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).rangeMax,"</sup>)"].join("")],["Low Int Precision in Fragment Shader","LOW_INT FRAGMENT_SHADER",[n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).precision," (-2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).rangeMin,"</sup> - 2<sup>",n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).rangeMax,"</sup>)"].join("")],["Supported Extensions","EXTENSIONS",n.getSupportedExtensions().join("<br/>\t\t\t\t\t    ")],["WebGL Renderer","RENDERER",n.getParameter(n.RENDERER)],["WebGL Vendor","VENDOR",n.getParameter(n.VENDOR)],["WebGL Version","VERSION",n.getParameter(n.VERSION)],["Shading Language Version","SHADING_LANGUAGE_VERSION",n.getParameter(n.SHADING_LANGUAGE_VERSION)],["Unmasked Renderer","UNMASKED_RENDERER",o&&n.getParameter(o.UNMASKED_RENDERER_WEBGL)],["Unmasked Vendor","UNMASKED_VENDOR",o&&n.getParameter(o.UNMASKED_VENDOR_WEBGL)],["WebGL Version","WEBGL_VERSION",t.webgl2?2:1]],c={};for(;l.length;){const[e,t,n]=l.pop();t&&(c[t]={label:e,value:n})}return t._glInformation=c,c},e.traverseAllPasses=()=>{if(t.renderPasses)for(let n=0;n<t.renderPasses.length;++n)t.renderPasses[n].traverse(e,null);e.copyParentContent(),t.notifyStartCaptureImage&&function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.imageFormat;const r=document.createElement("canvas"),i=r.getContext("2d");r.width=t.canvas.width,r.height=t.canvas.height,i.drawImage(t.canvas,0,0);const o=t.canvas.getBoundingClientRect();t.renderable.getRenderers().forEach((e=>{e.getViewProps().forEach((e=>{if(e.getContainer){const t=e.getContainer().getElementsByTagName("canvas");for(let e=0;e<t.length;e++){const n=t[e],r=n.getBoundingClientRect(),a=r.x-o.x,s=r.y-o.y;i.drawImage(n,a,s)}}}))}));const a=r.toDataURL(n);r.remove(),e.invokeImageReady(a)}();const n=t.renderable.getChildRenderWindowsByReference();for(let t=0;t<n.length;++t)e.getViewNodeFor(n[t])?.traverseAllPasses()},e.copyParentContent=()=>{const e=t.rootOpenGLRenderWindow;if(!e||!t.context2D||t.children.some((e=>!!e.getSelector?.())))return;const n=e.getCanvas(),r=t.canvas;t.context2D.drawImage(n,0,n.height-r.height,r.width,r.height,0,0,r.width,r.height)},e.resizeFromChildRenderWindows=()=>{const n=t.renderable.getChildRenderWindowsByReference();if(n.length>0){const t=[0,0];for(let r=0;r<n.length;++r){const i=e.getViewNodeFor(n[r])?.getSize();i&&(t[0]=i[0]>t[0]?i[0]:t[0],t[1]=i[1]>t[1]?i[1]:t[1])}e.setSize(...t)}},e.disableCullFace=()=>{t.cullFaceEnabled&&(t.context.disable(t.context.CULL_FACE),t.cullFaceEnabled=!1)},e.enableCullFace=()=>{t.cullFaceEnabled||(t.context.enable(t.context.CULL_FACE),t.cullFaceEnabled=!0)},e.setViewStream=n=>{if(t.viewStream===n)return!1;if(t.subscription&&(t.subscription.unsubscribe(),t.subscription=null),t.viewStream=n,t.viewStream){t.renderable.getRenderers()[0].getBackgroundByReference()[3]=0,e.setUseBackgroundImage(!0),t.subscription=t.viewStream.onImageReady((t=>e.setBackgroundImage(t.image))),t.viewStream.setSize(t.size[0],t.size[1]),t.viewStream.invalidateCache(),t.viewStream.render(),e.modified()}return!0},e.createSelector=()=>{const t=re.newInstance();return t.setOpenGLRenderWindow(e),t},e.delete=o.m.chain((()=>{t.context&&(_e--,Ie.forEach((e=>e(_e)))),e.setContainer(),e.setViewStream()}),(function(){t.canvas.removeEventListener("webglcontextlost",Ee),t.canvas.removeEventListener("webglcontextrestored",e.restoreContext)}),e.delete),e.setActiveFramebuffer=e=>{t.activeFramebuffer=e};const s=e.setSize;e.setSize=(t,n)=>{const r=s(t,n);return r&&e.invokeWindowResizeEvent({width:t,height:n}),r},e.registerGraphicsResourceUser=(n,r)=>{t._graphicsResources.has(n)||e.setGraphicsResourceForObject(n,null,null);const i=t._graphicsResources.get(n);i?.users.add(r)},e.unregisterGraphicsResourceUser=(n,r)=>{const i=t._graphicsResources.get(n);i&&(i.users.delete(r),i.users.size||(i.oglObject?.releaseGraphicsResources(e),t._graphicsResources.delete(n)))},e.getGraphicsResourceForObject=e=>t._graphicsResources.get(e),e.setGraphicsResourceForObject=(n,r,i)=>{if(!n)return;const o=t._graphicsResources.get(n);o?.oglObject?.releaseGraphicsResources(e),t._graphicsResources.set(n,{coreObject:n,oglObject:r,hash:i,users:o?.users??new Set})},e.getGraphicsMemoryInfo=()=>{let e=0;return t._graphicsResources.forEach((t=>{let{oglObject:n}=t;e+=n.getAllocatedGPUMemoryInBytes()})),e},e.releaseGraphicsResources=()=>{null!==t.shaderCache&&t.shaderCache.releaseGraphicsResources(e),t._graphicsResources.forEach((t=>{let{oglObject:n}=t;n.releaseGraphicsResources(e)})),t._graphicsResources.clear(),null!==t.textureUnitManager&&t.textureUnitManager.freeAll(),t.renderable.getRenderersByReference().forEach((t=>{const n=e.getViewNodeFor(t);n?.releaseGraphicsResources()}))};const l={...e};Se.forEach((n=>{e[n]=function(){return t.rootOpenGLRenderWindow?t.rootOpenGLRenderWindow[n](...arguments):l[n](...arguments)}}))}const Oe={cullFaceEnabled:!1,shaderCache:null,initialized:!1,context:null,context2D:null,canvas:null,cursorVisibility:!0,cursor:"pointer",textureUnitManager:null,textureResourceIds:null,containerSize:null,renderPasses:[],notifyStartCaptureImage:!1,webgl2:!1,defaultToWebgl2:!0,activeFramebuffer:null,imageFormat:"image/png",useOffScreen:!1,useBackgroundImage:!1};function Pe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Oe,n),ye.extend(e,t,n),t.canvas||(t.canvas=document.createElement("canvas"),t.canvas.style.width="100%"),t.selector||(t.selector=re.newInstance(),t.selector.setOpenGLRenderWindow(e)),t.bgImage=new Image,t.bgImage.style.position="absolute",t.bgImage.style.left="0",t.bgImage.style.top="0",t.bgImage.style.width="100%",t.bgImage.style.height="100%",t.bgImage.style.zIndex="-1",t._textureResourceIds=new Map,t._graphicsResources=new Map,t._glInformation=null,t.myFactory=he.Ay.newInstance(),t.shaderCache=ce.newInstance(),t.shaderCache.setOpenGLRenderWindow(e),t.renderPasses[0]=P.newInstance(),o.m.get(e,t,["shaderCache","textureUnitManager","webgl2","useBackgroundImage","activeFramebuffer","rootOpenGLRenderWindow"]),o.m.setGet(e,t,["initialized","context","context2D","canvas","renderPasses","notifyStartCaptureImage","defaultToWebgl2","cursor","useOffScreen"]),o.m.setGetArray(e,t,["size"],2),o.m.event(e,t,"imageReady"),o.m.event(e,t,"windowResizeEvent"),De(e,t)}const Re=o.m.newInstance(Pe,"vtkOpenGLRenderWindow");s("WebGL",Re);var Ne={newInstance:Re,extend:Pe,pushMonitorGLContextCount:function(e){Ie.push(e)},popMonitorGLContextCount:function(e){return Ie.pop()}};(0,he.c9)("vtkRenderWindow",Re);var Me=n(80639),Le=n(58601),Fe=n(38475),Be=n(3823),Ve=n(21081),ke=n(62939);const{vtkErrorMacro:Ue}=o.c,{Representation:Ge}=b.Ay,{ObjectType:ze}=Ve.Ay,{PassTypes:We}=re,je={type:"StartEvent"},He={type:"EndEvent"};const Ke={normalMatrix:null,mcpcMatrix:null,mcwcMatrix:null};function qe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Ke,n),ke.Ay.extend(e,t,n),t.tmpMat3=Be.w0.identity(new Float64Array(9)),t.normalMatrix=Be.w0.identity(new Float64Array(9)),t.mcpcMatrix=Be.pB.identity(new Float64Array(16)),t.mcvcMatrix=Be.pB.identity(new Float64Array(16)),t.tmpColor=[],t.glyphBOBuildTime={},(0,o.o)(t.glyphBOBuildTime,{mtime:0}),function(e,t){t.classHierarchy.push("vtkOpenGLGlyph3DMapper");const n={...e};e.renderPiece=(n,r)=>{if(e.invokeEvent(je),t.renderable.getStatic()||t.renderable.update(),t.currentInput=t.renderable.getInputData(1),e.invokeEvent(He),!t.currentInput)return void Ue("No input!");if(!t.currentInput.getPoints||!t.currentInput.getPoints().getNumberOfValues())return;const i=t.context;t._openGLRenderWindow.getWebgl2()?(t.hardwareSupport=!0,t.extension=null):t.extension||(t.extension=t.context.getExtension("ANGLE_instanced_arrays"),t.hardwareSupport=!!t.extension);const o=r.getProperty().getBackfaceCulling(),a=r.getProperty().getFrontfaceCulling();o||a?a?(t._openGLRenderWindow.enableCullFace(),i.cullFace(i.FRONT)):(t._openGLRenderWindow.enableCullFace(),i.cullFace(i.BACK)):t._openGLRenderWindow.disableCullFace(),e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)},e.multiply4x4WithOffset=(e,t,n,r)=>{const i=t[0],o=t[1],a=t[2],s=t[3],l=t[4],c=t[5],u=t[6],d=t[7],p=t[8],f=t[9],h=t[10],m=t[11],g=t[12],v=t[13],y=t[14],b=t[15];let x=n[r],A=n[r+1],C=n[r+2],T=n[r+3];e[0]=x*i+A*l+C*p+T*g,e[1]=x*o+A*c+C*f+T*v,e[2]=x*a+A*u+C*h+T*y,e[3]=x*s+A*d+C*m+T*b,x=n[r+4],A=n[r+5],C=n[r+6],T=n[r+7],e[4]=x*i+A*l+C*p+T*g,e[5]=x*o+A*c+C*f+T*v,e[6]=x*a+A*u+C*h+T*y,e[7]=x*s+A*d+C*m+T*b,x=n[r+8],A=n[r+9],C=n[r+10],T=n[r+11],e[8]=x*i+A*l+C*p+T*g,e[9]=x*o+A*c+C*f+T*v,e[10]=x*a+A*u+C*h+T*y,e[11]=x*s+A*d+C*m+T*b,x=n[r+12],A=n[r+13],C=n[r+14],T=n[r+15],e[12]=x*i+A*l+C*p+T*g,e[13]=x*o+A*c+C*f+T*v,e[14]=x*a+A*u+C*h+T*y,e[15]=x*s+A*d+C*m+T*b},e.replaceShaderNormal=(e,r,i)=>{if(t.hardwareSupport&&t.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let n=e.Vertex;t.lastBoundBO.getCABO().getNormalOffset()&&(n=x.A.substitute(n,"//VTK::Normal::Dec",["attribute vec3 normalMC;","attribute mat3 gNormal;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,n=x.A.substitute(n,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * gNormal * normalMC;"]).result),e.Vertex=n}n.replaceShaderNormal(e,r,i)},e.replaceShaderColor=(e,r,i)=>{if(t.hardwareSupport&&t.renderable.getColorArray()){let n=e.Vertex,r=e.Geometry,i=e.Fragment;const o=t.lastBoundBO.getReferenceByName("lastLightComplexity");let a=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity"];o&&(a=a.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let s=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];o&&(s=s.concat(["  vec3 specularColor;","  float specularPower;"])),s=s.concat(["  opacity = opacityUniform;"]),o&&(s=s.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),t.drawingEdges||(a=a.concat(["varying vec4 vertexColorVSOutput;"]),n=x.A.substitute(n,"//VTK::Color::Dec",["attribute vec4 gColor;","varying vec4 vertexColorVSOutput;"]).result,n=x.A.substitute(n,"//VTK::Color::Impl",["vertexColorVSOutput = gColor;"]).result,r=x.A.substitute(r,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,r=x.A.substitute(r,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result,s=s.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])),i=x.A.substitute(i,"//VTK::Color::Impl",s).result,i=x.A.substitute(i,"//VTK::Color::Dec",a).result,e.Vertex=n,e.Geometry=r,e.Fragment=i}n.replaceShaderColor(e,r,i)},e.replaceShaderPositionVC=(e,r,i)=>{if(t.hardwareSupport){let n=e.Vertex;t.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(n=x.A.substitute(n,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","vertexVCVSOutput = MCVCMatrix * gVertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result,n=x.A.substitute(n,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result):(n=x.A.substitute(n,"//VTK::Camera::Dec",["attribute mat4 gMatrix;","uniform mat4 MCPCMatrix;"]).result,n=x.A.substitute(n,"//VTK::PositionVC::Impl",["vec4 gVertexMC = gMatrix * vertexMC;","  gl_Position = MCPCMatrix * gVertexMC;"]).result),e.Vertex=n}n.replaceShaderPositionVC(e,r,i)},e.replaceShaderPicking=(e,r,i)=>{if(t.hardwareSupport){let t=e.Fragment,n=e.Vertex;n=x.A.substitute(n,"//VTK::Picking::Dec",["attribute vec3 mapperIndexVS;","varying vec3 mapperIndexVSOutput;"]).result,n=x.A.substitute(n,"//VTK::Picking::Impl","  mapperIndexVSOutput = mapperIndexVS;").result,e.Vertex=n,t=x.A.substitute(t,"//VTK::Picking::Dec",["varying vec3 mapperIndexVSOutput;","uniform vec3 mapperIndex;","uniform int picking;"]).result,t=x.A.substitute(t,"//VTK::Picking::Impl",["  vec4 pickColor = picking == 2 ? vec4(mapperIndexVSOutput,1.0) : vec4(mapperIndex,1.0);","  gl_FragData[0] = picking != 0 ? pickColor : gl_FragData[0];"]).result,e.Fragment=t}else n.replaceShaderPicking(e,r,i)},e.updateGlyphShaderParameters=(n,r,i,o,a,s,l,c)=>{const u=i.getProgram();if(n){const e=t.normalMatrix,n=s,r=9*l,i=t.tmpMat3,o=e[0],a=e[1],c=e[2],d=e[3],p=e[4],f=e[5],h=e[6],m=e[7],g=e[8],v=n[r],y=n[r+1],b=n[r+2],x=n[r+3],A=n[r+4],C=n[r+5],T=n[r+6],S=n[r+7],w=n[r+8];i[0]=v*o+y*d+b*h,i[1]=v*a+y*p+b*m,i[2]=v*c+y*f+b*g,i[3]=x*o+A*d+C*h,i[4]=x*a+A*p+C*m,i[5]=x*c+A*f+C*g,i[6]=T*o+S*d+w*h,i[7]=T*a+S*p+w*m,i[8]=T*c+S*f+w*g,u.setUniformMatrix3x3("normalMatrix",t.tmpMat3)}if(e.multiply4x4WithOffset(t.tmpMat4,t.mcpcMatrix,a,16*l),u.setUniformMatrix("MCPCMatrix",t.tmpMat4),r&&(e.multiply4x4WithOffset(t.tmpMat4,t.mcvcMatrix,a,16*l),u.setUniformMatrix("MCVCMatrix",t.tmpMat4)),o){const e=o.getData();t.tmpColor[0]=e[4*l]/255,t.tmpColor[1]=e[4*l+1]/255,t.tmpColor[2]=e[4*l+2]/255,u.setUniform3fArray("ambientColorUniform",t.tmpColor),u.setUniform3fArray("diffuseColorUniform",t.tmpColor)}c&&u.setUniform3fArray("mapperIndex",c.getPropColorValue())},e.renderPieceDraw=(n,r)=>{const i=r.getProperty().getRepresentation(),o=t.context,a=r.getProperty().getEdgeVisibility()&&i===Ge.SURFACE,s=t.openGLCamera.getKeyMatrices(n),l=t.openGLActor.getKeyMatrices();Be.w0.multiply(t.normalMatrix,s.normalMatrix,l.normalMatrix),Be.pB.multiply(t.mcpcMatrix,s.wcpc,l.mcwc),Be.pB.multiply(t.mcvcMatrix,s.wcvc,l.mcwc);const c=t.renderable.getMatrixArray(),u=t.renderable.getNormalArray(),d=t.renderable.getColorArray(),p=c.length/16;let f=!1;t._openGLRenderer.getSelector()&&t._openGLRenderer.getSelector().getCurrentPass()===We.COMPOSITE_INDEX_PASS&&(f=!0);for(let s=t.primTypes.Start;s<t.primTypes.End;s++){const l=t.primitives[s].getCABO();if(l.getElementCount()){t.drawingEdges=a&&(s===t.primTypes.TrisEdges||s===t.primTypes.TriStripsEdges),t.lastBoundBO=t.primitives[s],t.primitives[s].updateShaders(n,r,e);const h=t.primitives[s].getProgram(),m=t.primitives[s].getOpenGLMode(i),g=h.isUniformUsed("normalMatrix"),v=h.isUniformUsed("MCVCMatrix");if(t.hardwareSupport)t.extension?t.extension.drawArraysInstancedANGLE(m,0,l.getElementCount(),p):o.drawArraysInstanced(m,0,l.getElementCount(),p);else for(let n=0;n<p;++n)f&&t._openGLRenderer.getSelector().renderCompositeIndex(n),e.updateGlyphShaderParameters(g,v,t.primitives[s],d,c,u,n,f?t._openGLRenderer.getSelector():null),o.drawArrays(m,0,l.getElementCount())}}},e.setMapperShaderParameters=(e,r,i)=>{if(e.getCABO().getElementCount()&&(t.glyphBOBuildTime.getMTime()>e.getAttributeUpdateTime().getMTime()||e.getShaderSourceTime().getMTime()>e.getAttributeUpdateTime().getMTime()))return e.getProgram().isAttributeUsed("gMatrix")?e.getVAO().addAttributeMatrixWithDivisor(e.getProgram(),t.matrixBuffer,"gMatrix",0,64,t.context.FLOAT,4,!1,1)||Ue("Error setting gMatrix in shader VAO."):e.getVAO().removeAttributeArray("gMatrix"),e.getProgram().isAttributeUsed("gNormal")?e.getVAO().addAttributeMatrixWithDivisor(e.getProgram(),t.normalBuffer,"gNormal",0,36,t.context.FLOAT,3,!1,1)||Ue("Error setting gNormal in shader VAO."):e.getVAO().removeAttributeArray("gNormal"),e.getProgram().isAttributeUsed("gColor")?e.getVAO().addAttributeArrayWithDivisor(e.getProgram(),t.colorBuffer,"gColor",0,4,t.context.UNSIGNED_BYTE,4,!0,1,!1)||Ue("Error setting gColor in shader VAO."):e.getVAO().removeAttributeArray("gColor"),e.getProgram().isAttributeUsed("mapperIndexVS")?e.getVAO().addAttributeArrayWithDivisor(e.getProgram(),t.pickBuffer,"mapperIndexVS",0,4,t.context.UNSIGNED_BYTE,4,!0,1,!1)||Ue("Error setting mapperIndexVS in shader VAO."):e.getVAO().removeAttributeArray("mapperIndexVS"),n.setMapperShaderParameters(e,r,i),void e.getAttributeUpdateTime().modified();n.setMapperShaderParameters(e,r,i)},e.getNeedToRebuildBufferObjects=(e,r)=>(t.renderable.buildArrays(),t.VBOBuildTime.getMTime()<t.renderable.getBuildTime().getMTime()||n.getNeedToRebuildBufferObjects(e,r)),e.getNeedToRebuildShaders=(e,r,i)=>!!(n.getNeedToRebuildShaders(e,r,i)||e.getShaderSourceTime().getMTime()<t.renderable.getMTime()||e.getShaderSourceTime().getMTime()<t.currentInput.getMTime()),e.buildBufferObjects=(e,r)=>{if(t.hardwareSupport){const e=t.renderable.getMatrixArray(),n=t.renderable.getNormalArray(),r=t.renderable.getColorArray();if(t.matrixBuffer||(t.matrixBuffer=Ve.Ay.newInstance(),t.matrixBuffer.setOpenGLRenderWindow(t._openGLRenderWindow),t.normalBuffer=Ve.Ay.newInstance(),t.normalBuffer.setOpenGLRenderWindow(t._openGLRenderWindow),t.colorBuffer=Ve.Ay.newInstance(),t.colorBuffer.setOpenGLRenderWindow(t._openGLRenderWindow),t.pickBuffer=Ve.Ay.newInstance(),t.pickBuffer.setOpenGLRenderWindow(t._openGLRenderWindow)),t.renderable.getBuildTime().getMTime()>t.glyphBOBuildTime.getMTime()){t.matrixBuffer.upload(e,ze.ARRAY_BUFFER),t.normalBuffer.upload(n,ze.ARRAY_BUFFER),r?t.colorBuffer.upload(r.getData(),ze.ARRAY_BUFFER):t.colorBuffer.releaseGraphicsResources();const i=e.length/16,o=new Uint8Array(4*i);for(let e=0;e<i;++e){let t=e+1;const n=4*e;o[n]=t%256,t-=o[n],t/=256,o[n+1]=t%256,t-=o[n+1],t/=256,o[n+2]=t%256,o[n+3]=255}t.pickBuffer.upload(o,ze.ARRAY_BUFFER),t.glyphBOBuildTime.modified()}}return n.buildBufferObjects(e,r)}}(e,t)}const $e=(0,o.n)(qe,"vtkOpenGLGlyph3DMapper");var Xe={newInstance:$e,extend:qe};(0,he.c9)("vtkGlyph3DMapper",$e);var Ye=n(6814),Je=n(82967),Ze=n(64501),Qe=n(68464),et=n(63819),tt=n(92530),nt=n(60003),rt=n(16632),it="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkSphereMapperVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// this shader implements imposters in OpenGL for Spheres\n\nattribute vec4 vertexMC;\nattribute vec2 offsetMC;\n\n// optional normal declaration\n//VTK::Normal::Dec\n\n//VTK::Picking::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\nuniform mat3 normalMatrix; // transform model coordinate directions to view coordinates\n\n// material property values\n//VTK::Color::Dec\n\n// clipping plane vars\n//VTK::Clip::Dec\n\n// camera and actor matrix values\n//VTK::Camera::Dec\n\nvarying vec4 vertexVCVSOutput;\nvarying float radiusVCVSOutput;\nvarying vec3 centerVCVSOutput;\n\nuniform int cameraParallel;\nuniform float scaleFactor;\n\nvoid main()\n{\n  //VTK::Picking::Impl\n\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Clip::Impl\n\n  // compute the projected vertex position\n  vec2 scaledOffsetMC = scaleFactor * offsetMC;\n  vertexVCVSOutput = MCVCMatrix * vertexMC;\n  centerVCVSOutput = vertexVCVSOutput.xyz;\n  radiusVCVSOutput = length(scaledOffsetMC)*0.5;\n\n  // make the triangle face the camera\n  if (cameraParallel == 0)\n    {\n    vec3 dir = normalize(-vertexVCVSOutput.xyz);\n    vec3 base2 = normalize(cross(dir,vec3(1.0,0.0,0.0)));\n    vec3 base1 = cross(base2,dir);\n    vertexVCVSOutput.xyz = vertexVCVSOutput.xyz + scaledOffsetMC.x*base1 + scaledOffsetMC.y*base2;\n    }\n  else\n    {\n    // add in the offset\n    vertexVCVSOutput.xy = vertexVCVSOutput.xy + scaledOffsetMC;\n    }\n\n  gl_Position = VCPCMatrix * vertexVCVSOutput;\n}\n",ot=n(23159);const{vtkErrorMacro:at}=o.c;const st={};function lt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,st,n),ke.Ay.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkOpenGLSphereMapper");const n={...e};e.getShaderTemplate=(e,t,n)=>{e.Vertex=it,e.Fragment=ot.v,e.Geometry=""},e.replaceShaderValues=(e,r,i)=>{let o=e.Vertex,a=e.Fragment;o=x.A.substitute(o,"//VTK::Camera::Dec",["uniform mat4 VCPCMatrix;\n","uniform mat4 MCVCMatrix;"]).result,a=x.A.substitute(a,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,a=x.A.substitute(a,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;\n"]).result,a=x.A.substitute(a,"//VTK::Normal::Dec",["uniform float invertedDepth;\n","uniform int cameraParallel;\n","varying float radiusVCVSOutput;\n","varying vec3 centerVCVSOutput;\n","uniform mat4 VCPCMatrix;\n"]).result;let s="";t.context.getExtension("EXT_frag_depth")&&(s="gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;\n"),t._openGLRenderWindow.getWebgl2()&&(s="gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;\n"),a=x.A.substitute(a,"//VTK::Depth::Impl",["  vec3 EyePos;\n","  vec3 EyeDir;\n","  if (cameraParallel != 0) {\n","    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);\n","    EyeDir = vec3(0.0,0.0,-1.0); }\n","  else {\n","    EyeDir = vertexVC.xyz;\n","    EyePos = vec3(0.0,0.0,0.0);\n","    float lengthED = length(EyeDir);\n","    EyeDir = normalize(EyeDir);\n","    if (lengthED > radiusVCVSOutput*3.0) {\n","      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }\n","    }\n","  EyePos = EyePos - centerVCVSOutput;\n","  EyePos = EyePos/radiusVCVSOutput;\n","  float b = 2.0*dot(EyePos,EyeDir);\n","  float c = dot(EyePos,EyePos) - 1.0;\n","  float d = b*b - 4.0*c;\n","  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);\n","  if (d < 0.0) { discard; }\n","  else {\n","    float t = (-b - invertedDepth*sqrt(d))*0.5;\n","    normalVCVSOutput = invertedDepth*normalize(EyePos + t*EyeDir);\n","    vertexVC.xyz = normalVCVSOutput*radiusVCVSOutput + centerVCVSOutput;\n","    }\n","  vec4 pos = VCPCMatrix * vertexVC;\n",s]).result,a=x.A.substitute(a,"//VTK::Normal::Impl","").result,t.haveSeenDepthRequest&&(a=x.A.substitute(a,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),e.Vertex=o,e.Fragment=a,n.replaceShaderValues(e,r,i)},e.setMapperShaderParameters=(e,r,i)=>{if(e.getCABO().getElementCount()&&(t.VBOBuildTime>e.getAttributeUpdateTime().getMTime()||e.getShaderSourceTime().getMTime()>e.getAttributeUpdateTime().getMTime())&&e.getProgram().isAttributeUsed("offsetMC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),"offsetMC",12,e.getCABO().getStride(),t.context.FLOAT,2,!1)||at("Error setting 'offsetMC' in shader VAO.")),e.getProgram().isUniformUsed("invertedDepth")&&e.getProgram().setUniformf("invertedDepth",t.invert?-1:1),e.getProgram().isUniformUsed("scaleFactor")){const n=t.currentInput.getPointData();null!=t.renderable.getScaleArray()&&n.hasArray(t.renderable.getScaleArray())?e.getProgram().setUniformf("scaleFactor",t.renderable.getScaleFactor()):e.getProgram().setUniformf("scaleFactor",1)}n.setMapperShaderParameters(e,r,i)},e.setCameraShaderParameters=(e,n,r)=>{const i=e.getProgram(),o=n.getActiveCamera(),a=t.openGLCamera.getKeyMatrices(n);if(i.isUniformUsed("VCPCMatrix")&&i.setUniformMatrix("VCPCMatrix",a.vcpc),i.isUniformUsed("MCVCMatrix"))if(r.getIsIdentity())i.setUniformMatrix("MCVCMatrix",a.wcvc);else{const e=t.openGLActor.getKeyMatrices(),n=new Float64Array(16);Be.pB.multiply(n,a.wcvc,e.mcwc),i.setUniformMatrix("MCVCMatrix",n)}i.isUniformUsed("cameraParallel")&&e.getProgram().setUniformi("cameraParallel",o.getParallelProjection())},e.getOpenGLMode=(e,n)=>t.context.TRIANGLES,e.buildBufferObjects=(e,n)=>{const r=t.currentInput;if(null===r)return;t.renderable.mapScalars(r,1);const i=t.renderable.getColorMapColors(),o=t.primitives[t.primTypes.Tris].getCABO(),a=r.getPointData(),s=r.getPoints(),l=s.getNumberOfPoints(),c=s.getData();let u=null;null!=t.renderable.getScaleArray()&&a.hasArray(t.renderable.getScaleArray())&&(u=a.getArray(t.renderable.getScaleArray()).getData());let d=null,p=0,f=null;i?(p=i.getNumberOfComponents(),o.setColorOffset(0),o.setColorBOStride(4),d=i.getData(),f=new Uint8Array(3*l*4),o.getColorBO()||o.setColorBO(Ve.Ay.newInstance()),o.getColorBO().setOpenGLRenderWindow(t._openGLRenderWindow)):o.getColorBO()&&o.setColorBO(null),o.setColorComponents(p);const h=new Float32Array(5*l*3);o.setStride(20);const m=Math.cos((0,rt.r)(30));let g=0,v=0,y=0,b=0;for(let e=0;e<l;++e){let n=t.renderable.getRadius();u&&(n=u[e]),g=3*e,h[y++]=c[g++],h[y++]=c[g++],h[y++]=c[g++],h[y++]=-2*n*m,h[y++]=-n,d&&(v=e*p,f[b++]=d[v],f[b++]=d[v+1],f[b++]=d[v+2],f[b++]=d[v+3]),g=3*e,h[y++]=c[g++],h[y++]=c[g++],h[y++]=c[g++],h[y++]=2*n*m,h[y++]=-n,d&&(f[b++]=d[v],f[b++]=d[v+1],f[b++]=d[v+2],f[b++]=d[v+3]),g=3*e,h[y++]=c[g++],h[y++]=c[g++],h[y++]=c[g++],h[y++]=0,h[y++]=2*n,d&&(f[b++]=d[v],f[b++]=d[v+1],f[b++]=d[v+2],f[b++]=d[v+3])}o.setElementCount(y/5),o.upload(h,nt.a.ARRAY_BUFFER),i&&o.getColorBO().upload(f,nt.a.ARRAY_BUFFER),t.VBOBuildTime.modified()}}(e,t)}const ct=(0,o.n)(lt,"vtkOpenGLSphereMapper");var ut={newInstance:ct,extend:lt};(0,he.c9)("vtkSphereMapper",ct);var dt="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkStickMapperVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// this shader implements imposters in OpenGL for Sticks\n\nattribute vec4 vertexMC;\nattribute vec3 orientMC;\nattribute vec4 offsetMC;\nattribute float radiusMC;\n\n// optional normal declaration\n//VTK::Normal::Dec\n\n//VTK::Picking::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\nuniform mat3 normalMatrix; // transform model coordinate directions to view coordinates\n\n// material property values\n//VTK::Color::Dec\n\n// clipping plane vars\n//VTK::Clip::Dec\n\n// camera and actor matrix values\n//VTK::Camera::Dec\n\nvarying vec4 vertexVCVSOutput;\nvarying float radiusVCVSOutput;\nvarying float lengthVCVSOutput;\nvarying vec3 centerVCVSOutput;\nvarying vec3 orientVCVSOutput;\n\nuniform int cameraParallel;\n\nvoid main()\n{\n  //VTK::Picking::Impl\n\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Clip::Impl\n\n  vertexVCVSOutput = MCVCMatrix * vertexMC;\n  centerVCVSOutput = vertexVCVSOutput.xyz;\n  radiusVCVSOutput = radiusMC;\n  lengthVCVSOutput = length(orientMC);\n  orientVCVSOutput = normalMatrix * normalize(orientMC);\n\n  // make sure it is pointing out of the screen\n  if (orientVCVSOutput.z < 0.0)\n    {\n    orientVCVSOutput = -orientVCVSOutput;\n    }\n\n  // make the basis\n  vec3 xbase;\n  vec3 ybase;\n  vec3 dir = vec3(0.0,0.0,1.0);\n  if (cameraParallel == 0)\n    {\n    dir = normalize(-vertexVCVSOutput.xyz);\n    }\n  if (abs(dot(dir,orientVCVSOutput)) == 1.0)\n    {\n    xbase = normalize(cross(vec3(0.0,1.0,0.0),orientVCVSOutput));\n    ybase = cross(xbase,orientVCVSOutput);\n    }\n  else\n    {\n    xbase = normalize(cross(orientVCVSOutput,dir));\n    ybase = cross(orientVCVSOutput,xbase);\n    }\n\n  vec3 offsets = offsetMC.xyz*2.0-1.0;\n  vertexVCVSOutput.xyz = vertexVCVSOutput.xyz +\n    radiusVCVSOutput*offsets.x*xbase +\n    radiusVCVSOutput*offsets.y*ybase +\n    0.5*lengthVCVSOutput*offsets.z*orientVCVSOutput;\n\n  gl_Position = VCPCMatrix * vertexVCVSOutput;\n}\n";const{vtkErrorMacro:pt}=o.c;const ft={};function ht(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ft,n),ke.Ay.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkOpenGLStickMapper");const n={...e};e.getShaderTemplate=(e,t,n)=>{e.Vertex=dt,e.Fragment=ot.v,e.Geometry=""},e.replaceShaderValues=(e,r,i)=>{let o=e.Vertex,a=e.Fragment;o=x.A.substitute(o,"//VTK::Camera::Dec",["uniform mat4 VCPCMatrix;\n","uniform mat4 MCVCMatrix;"]).result,a=x.A.substitute(a,"//VTK::PositionVC::Dec","varying vec4 vertexVCVSOutput;").result,a=x.A.substitute(a,"//VTK::PositionVC::Impl","  vec4 vertexVC = vertexVCVSOutput;\n").result,a=x.A.substitute(a,"//VTK::Normal::Dec",["uniform int cameraParallel;\n","varying float radiusVCVSOutput;\n","varying vec3 orientVCVSOutput;\n","varying float lengthVCVSOutput;\n","varying vec3 centerVCVSOutput;\n","uniform mat4 VCPCMatrix;\n"]).result;let s="";t.context.getExtension("EXT_frag_depth")&&(s="  gl_FragDepthEXT = (pos.z / pos.w + 1.0) / 2.0;\n"),t._openGLRenderWindow.getWebgl2()&&(s="gl_FragDepth = (pos.z / pos.w + 1.0) / 2.0;\n"),a=x.A.substitute(a,"//VTK::Depth::Impl",["  vec3 EyePos;\n","  vec3 EyeDir;\n","  if (cameraParallel != 0) {\n","    EyePos = vec3(vertexVC.x, vertexVC.y, vertexVC.z + 3.0*radiusVCVSOutput);\n","    EyeDir = vec3(0.0,0.0,-1.0); }\n","  else {\n","    EyeDir = vertexVC.xyz;\n","    EyePos = vec3(0.0,0.0,0.0);\n","    float lengthED = length(EyeDir);\n","    EyeDir = normalize(EyeDir);\n","    if (lengthED > radiusVCVSOutput*3.0) {\n","      EyePos = vertexVC.xyz - EyeDir*3.0*radiusVCVSOutput; }\n","    }\n","  EyePos = EyePos - centerVCVSOutput;\n","  vec3 base1;\n","  if (abs(orientVCVSOutput.z) < 0.99) {\n","    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,0.0,1.0))); }\n","  else {\n","    base1 = normalize(cross(orientVCVSOutput,vec3(0.0,1.0,0.0))); }\n","  vec3 base2 = cross(orientVCVSOutput,base1);\n","  EyePos = vec3(dot(EyePos,base1),dot(EyePos,base2),dot(EyePos,orientVCVSOutput));\n","  EyeDir = vec3(dot(EyeDir,base1),dot(EyeDir,base2),dot(EyeDir,orientVCVSOutput));\n","  EyePos = EyePos/radiusVCVSOutput;\n","  float a = EyeDir.x*EyeDir.x + EyeDir.y*EyeDir.y;\n","  float b = 2.0*(EyePos.x*EyeDir.x + EyePos.y*EyeDir.y);\n","  float c = EyePos.x*EyePos.x + EyePos.y*EyePos.y - 1.0;\n","  float d = b*b - 4.0*a*c;\n","  vec3 normalVCVSOutput = vec3(0.0,0.0,1.0);\n","  if (d < 0.0) { discard; }\n","  else {\n","    float t =  (-b - sqrt(d))/(2.0*a);\n","    float tz = EyePos.z + t*EyeDir.z;\n","    vec3 iPoint = EyePos + t*EyeDir;\n","    if (abs(iPoint.z)*radiusVCVSOutput > lengthVCVSOutput*0.5) {\n","      float t2 = (-b + sqrt(d))/(2.0*a);\n","      float tz2 = EyePos.z + t2*EyeDir.z;\n","      if (tz2*radiusVCVSOutput > lengthVCVSOutput*0.5 || tz*radiusVCVSOutput < -0.5*lengthVCVSOutput) { discard; }\n","      else {\n","        normalVCVSOutput = orientVCVSOutput;\n","        float t3 = (lengthVCVSOutput*0.5/radiusVCVSOutput - EyePos.z)/EyeDir.z;\n","        iPoint = EyePos + t3*EyeDir;\n","        vertexVC.xyz = radiusVCVSOutput*(iPoint.x*base1 + iPoint.y*base2 + iPoint.z*orientVCVSOutput) + centerVCVSOutput;\n","        }\n","      }\n","    else {\n","      normalVCVSOutput = iPoint.x*base1 + iPoint.y*base2;\n","      vertexVC.xyz = radiusVCVSOutput*(normalVCVSOutput + iPoint.z*orientVCVSOutput) + centerVCVSOutput;\n","      }\n","    }\n","  vec4 pos = VCPCMatrix * vertexVC;\n",s]).result,a=x.A.substitute(a,"//VTK::Normal::Impl","").result,t.haveSeenDepthRequest&&(a=x.A.substitute(a,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float computedZ = (pos.z / pos.w + 1.0) / 2.0;","float iz = floor(computedZ * 65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),e.Vertex=o,e.Fragment=a,n.replaceShaderValues(e,r,i)},e.setMapperShaderParameters=(e,r,i)=>{e.getCABO().getElementCount()&&(t.VBOBuildTime>e.getAttributeUpdateTime().getMTime()||e.getShaderSourceTime().getMTime()>e.getAttributeUpdateTime().getMTime())&&(e.getProgram().isAttributeUsed("orientMC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),"orientMC",12,e.getCABO().getStride(),t.context.FLOAT,3,!1)||pt("Error setting 'orientMC' in shader VAO.")),e.getProgram().isAttributeUsed("offsetMC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO().getColorBO(),"offsetMC",0,e.getCABO().getColorBOStride(),t.context.UNSIGNED_BYTE,3,!0)||pt("Error setting 'offsetMC' in shader VAO.")),e.getProgram().isAttributeUsed("radiusMC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),"radiusMC",24,e.getCABO().getStride(),t.context.FLOAT,1,!1)||pt("Error setting 'radiusMC' in shader VAO."))),n.setMapperShaderParameters(e,r,i)},e.setCameraShaderParameters=(e,n,r)=>{const i=e.getProgram(),o=n.getActiveCamera(),a=t.openGLCamera.getKeyMatrices(n);if(i.isUniformUsed("VCPCMatrix")&&i.setUniformMatrix("VCPCMatrix",a.vcpc),r.getIsIdentity())i.isUniformUsed("MCVCMatrix")&&i.setUniformMatrix("MCVCMatrix",a.wcvc),i.isUniformUsed("normalMatrix")&&i.setUniformMatrix3x3("normalMatrix",a.normalMatrix);else{const e=t.openGLActor.getKeyMatrices();if(i.isUniformUsed("MCVCMatrix")){const t=new Float64Array(16);Be.pB.multiply(t,a.wcvc,e.mcwc),i.setUniformMatrix("MCVCMatrix",t)}if(i.isUniformUsed("normalMatrix")){const t=new Float64Array(9);Be.w0.multiply(t,a.normalMatrix,e.normalMatrix),i.setUniformMatrix3x3("normalMatrix",t)}}i.isUniformUsed("cameraParallel")&&e.getProgram().setUniformi("cameraParallel",o.getParallelProjection())},e.getOpenGLMode=(e,n)=>t.context.TRIANGLES,e.buildBufferObjects=(e,n)=>{const r=t.currentInput;if(null===r)return;t.renderable.mapScalars(r,1);const i=t.renderable.getColorMapColors(),o=t.primitives[t.primTypes.Tris].getCABO(),a=r.getPointData(),s=r.getPoints(),l=s.getNumberOfPoints(),c=s.getData();let u=3;u+=4;let d=null,p=0;o.setColorBOStride(4),o.getColorBO()||o.setColorBO(Ve.Ay.newInstance()),o.getColorBO().setOpenGLRenderWindow(t._openGLRenderWindow),i&&(p=i.getNumberOfComponents(),o.setColorOffset(4),d=i.getData(),o.setColorBOStride(8)),o.setColorComponents(p),o.setStride(28);const f=new Float32Array(7*l*12),h=new Uint8Array(12*l*(d?8:4));let m=null,g=null;null!=t.renderable.getScaleArray()&&a.hasArray(t.renderable.getScaleArray())&&(m=a.getArray(t.renderable.getScaleArray()).getData()),null!=t.renderable.getOrientationArray()&&a.hasArray(t.renderable.getOrientationArray())?g=a.getArray(t.renderable.getOrientationArray()).getData():pt(["Error setting orientationArray.\n","You have to specify the stick orientation"]);const v=[0,1,3,0,3,2,2,3,5,2,5,4];let y=0,b=0,x=0,A=0;for(let e=0;e<l;++e){let n=t.renderable.getLength(),r=t.renderable.getRadius();m&&(n=m[2*e],r=m[2*e+1]);for(let t=0;t<v.length;++t)y=3*e,f[x++]=c[y++],f[x++]=c[y++],f[x++]=c[y++],y=3*e,f[x++]=g[y++]*n,f[x++]=g[y++]*n,f[x++]=g[y++]*n,f[x++]=r,h[A++]=v[t]%2*255,h[A++]=v[t]>=4?255:0,h[A++]=v[t]>=2?255:0,h[A++]=255,b=e*p,d&&(h[A++]=d[b],h[A++]=d[b+1],h[A++]=d[b+2],h[A++]=d[b+3])}o.setElementCount(x/7),o.upload(f,nt.a.ARRAY_BUFFER),o.getColorBO().upload(h,nt.a.ARRAY_BUFFER),t.VBOBuildTime.modified()}}(e,t)}const mt=(0,o.n)(ht,"vtkOpenGLStickMapper");var gt={newInstance:mt,extend:ht};(0,he.c9)("vtkStickMapper",mt);var vt=n(8126),yt=n(95785),bt=n(84784),xt=n(52271),At=n(90919),Ct=n(71995),Tt=n(99576),St=n(26896);const wt={};function _t(e,t,n={}){Object.assign(t,wt,n),yt.Ay.extend(e,t,n),t.scalarTexture=n.scalarTexture,t.previousState={},function(e,t){t.classHierarchy.push("vtkStreamingOpenGLVolumeMapper"),e.buildBufferObjects=(n,r)=>{const o=t.currentInput;if(!o)return;const a=r.getProperty();if(!t.jitterTexture.getHandle()){const e=new Uint8Array(1024);for(let t=0;t<1024;++t)e[t]=255*Math.random();t.jitterTexture.setMinificationFilter(xt.dJ.LINEAR),t.jitterTexture.setMagnificationFilter(xt.dJ.LINEAR),t.jitterTexture.create2DFromRaw(32,32,1,i.JA.UNSIGNED_CHAR,e)}const{numberOfComponents:s}=o.get("numberOfComponents"),l=e.useIndependentComponents(a),c=a.getScalarOpacity(),u=t._openGLRenderWindow.getGraphicsResourceForObject(c);let d=(0,At.gP)(c,l,s);if(u?.oglObject&&u.hash===d)t.opacityTexture=u.oglObject;else{t.opacityTexture=g.Ay.newInstance(),t.opacityTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const r=1024,o=2*r*s,l=new Float32Array(o),u=new Float32Array(r);for(let t=0;t<s;++t){const i=a.getScalarOpacity(t),o=e.getCurrentSampleDistance(n)/a.getScalarOpacityUnitDistance(t),s=i.getRange();i.getTable(s[0],s[1],r,u,1);for(let e=0;e<r;++e)l[t*r*2+e]=1-(1-u[e])**o,l[t*r*2+e+r]=l[t*r*2+e]}if(t.opacityTexture.resetFormatAndType(),t.opacityTexture.setMinificationFilter(xt.dJ.LINEAR),t.opacityTexture.setMagnificationFilter(xt.dJ.LINEAR),t._openGLRenderWindow.getWebgl2()&&t.context.getExtension("OES_texture_float")&&t.context.getExtension("OES_texture_float_linear"))t.opacityTexture.create2DFromRaw(r,2*s,1,i.JA.FLOAT,l);else{const e=new Uint8ClampedArray(o);for(let t=0;t<o;++t)e[t]=255*l[t];t.opacityTexture.create2DFromRaw(r,2*s,1,i.JA.UNSIGNED_CHAR,e)}c&&(t._openGLRenderWindow.setGraphicsResourceForObject(c,t.opacityTexture,d),c!==t._scalarOpacityFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(c,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._scalarOpacityFunc,e)),t._scalarOpacityFunc=c)}const p=a.getRGBTransferFunction();d=(0,At.gP)(p,l,s);const f=t._openGLRenderWindow.getGraphicsResourceForObject(p);if(f?.oglObject?.getHandle()&&f?.hash===d)t.colorTexture=f.oglObject;else{t.colorTexture=g.Ay.newInstance(),t.colorTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const n=1024,r=new Uint8ClampedArray(2*n*s*3),o=new Float32Array(3*n);for(let e=0;e<s;++e){const t=a.getRGBTransferFunction(e),i=t.getRange();t.getTable(i[0],i[1],n,o,1);for(let t=0;t<3*n;++t)r[e*n*6+t]=255*o[t],r[e*n*6+t+3*n]=255*o[t]}t.colorTexture.resetFormatAndType(),t.colorTexture.setMinificationFilter(xt.dJ.LINEAR),t.colorTexture.setMagnificationFilter(xt.dJ.LINEAR),t.colorTexture.create2DFromRaw(n,2*s,3,i.JA.UNSIGNED_CHAR,r),p&&(t._openGLRenderWindow.setGraphicsResourceForObject(p,t.colorTexture,d),p!==t._colorTransferFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(p,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._colorTransferFunc,e)),t._colorTransferFunc=p)}if(e.updateLabelOutlineThicknessTexture(r),d=`${o.getMTime()}-${t.scalarTexture.getMTime()}`,t.scalarTextureString!==d){const e=o.getDimensions();t.scalarTexture.setOpenGLRenderWindow(t._openGLRenderWindow),t.scalarTexture.enableUseHalfFloat(!1);const n=t.scalarTexture.getTextureParameters(),r=o.get("dataType").dataType;let i=!0;if(n?.dataType===r&&n?.width===e[0]&&n?.height===e[1]&&n?.depth===e[2]&&(i=!1),i){const n=t.context.getExtension("EXT_texture_norm16");t.scalarTexture.setOglNorm16Ext((0,St.up)()?n:null),t.scalarTexture.resetFormatAndType(),t.scalarTexture.setTextureParameters({width:e[0],height:e[1],depth:e[2],numberOfComponents:s,dataType:r}),t.scalarTexture.create3DFromRaw(e[0],e[1],e[2],s,r,null),t.scalarTexture.update3DFromRaw()}else t.scalarTexture.deactivate(),t.scalarTexture.update3DFromRaw();t.scalarTextureString=d}if(!t.tris.getCABO().getElementCount()){const e=new Float32Array(12);for(let t=0;t<4;t++)e[3*t]=t%2*2-1,e[3*t+1]=t>1?1:-1,e[3*t+2]=-1;const n=new Uint16Array(8);n[0]=3,n[1]=0,n[2]=1,n[3]=3,n[4]=3,n[5]=0,n[6]=3,n[7]=2;const r=v.Ay.newInstance({numberOfComponents:3,values:e});r.setName("points");const i=v.Ay.newInstance({numberOfComponents:1,values:n});t.tris.getCABO().createVBO(i,"polys",Ct.YL.SURFACE,{points:r,cellOffset:0})}t.VBOBuildTime.modified()},e.getNeedToRebuildBufferObjects=(n,r)=>t.VBOBuildTime.getMTime()<e.getMTime()||t.VBOBuildTime.getMTime()<r.getMTime()||t.VBOBuildTime.getMTime()<t.renderable.getMTime()||t.VBOBuildTime.getMTime()<r.getProperty().getMTime()||t.VBOBuildTime.getMTime()<t.currentInput.getMTime()||t.VBOBuildTime.getMTime()<t.scalarTexture?.getMTime()||t.VBOBuildTime.getMTime()<t.colorTexture?.getMTime()||t.VBOBuildTime.getMTime()<t.labelOutlineThicknessTexture?.getMTime()||!t.scalarTexture?.getHandle()||!t.colorTexture?.getHandle()||!t.labelOutlineThicknessTexture?.getHandle()}(e,t)}const It={newInstance:r.Ay.newInstance(_t,"vtkStreamingOpenGLVolumeMapper"),extend:_t},Et=Object.create(null);function Dt(e,t){Et[e]=t}const Ot={};function Pt(e,t,n={}){Object.assign(t,Ot,n),bt.Ay.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkStreamingOpenGLViewNodeFactory"),e.createNode=n=>{if(n.isDeleted())return null;let r=0,i=n.getClassName(r++),o=!1;const a=Object.keys(t.overrides);for(;i&&!o;)a.includes(i)?o=!0:i=n.getClassName(r++);if(!o)return null;const s=t.getModelInitialValues(n),l=t.overrides[i](s);return l.setMyFactory(e),l},t.overrides=Et,t.getModelInitialValues=e=>{const t={};return"vtkSharedVolumeMapper"===e.getClassName()&&(t.scalarTexture=e.getScalarTexture()),t}}(e,t),Dt("vtkActor",Me.Ay.newInstance),Dt("vtkActor2D",Le.Ay.newInstance),Dt("vtkCamera",Fe.Ay.newInstance),Dt("vtkGlyph3DMapper",Xe.newInstance),Dt("vtkImageMapper",Ye.Ay.newInstance),Dt("vtkImageCPRMapper",Je.Ay.newInstance),Dt("vtkImageSlice",Ze.Ay.newInstance),Dt("vtkMapper",ke.Ay.newInstance),Dt("vtkPixelSpaceCallbackMapper",Qe.Ay.newInstance),Dt("vtkRenderer",et.Ay.newInstance),Dt("vtkSkybox",tt.Ay.newInstance),Dt("vtkSphereMapper",ut.newInstance),Dt("vtkStickMapper",gt.newInstance),Dt("vtkTexture",g.Ay.newInstance),Dt("vtkVolume",vt.Ay.newInstance),Dt("vtkVolumeMapper",yt.Ay.newInstance),Dt("vtkSharedVolumeMapper",It.newInstance)}const Rt={newInstance:r.Ay.newInstance(Pt,"vtkStreamingOpenGLViewNodeFactory"),extend:Pt};function Nt(e,t,n={}){Object.assign(t,n),Ne.extend(e,t,n),t.myFactory=Rt.newInstance(),Dt("vtkRenderWindow",Mt),function(e,t){t.classHierarchy.push("vtkStreamingOpenGLRenderWindow")}(0,t)}const Mt=r.Ay.newInstance(Nt,"vtkStreamingOpenGLRenderWindow"),Lt={newInstance:Mt,extend:Nt};var Ft=n(50036);var Bt={Device:{Unknown:0,LeftController:1,RightController:2},Input:{Unknown:0,Trigger:1,TrackPad:2,Grip:3,Thumbstick:4,A:5,B:6,ApplicationMenu:7},Axis:{Unknown:0,TouchpadX:1,TouchpadY:2,ThumbstickX:3,ThumbstickY:4}};const{Device:Vt,Input:kt}=Bt,{vtkWarningMacro:Ut,vtkErrorMacro:Gt,normalizeWheel:zt,vtkOnceErrorMacro:Wt}=o.m,jt={ctrlKey:!1,altKey:!1,shiftKey:!1},Ht={"xr-standard":[kt.Trigger,kt.Grip,kt.TrackPad,kt.Thumbstick,kt.A,kt.B]},Kt=["StartAnimation","Animation","EndAnimation","PointerEnter","PointerLeave","MouseEnter","MouseLeave","StartMouseMove","MouseMove","EndMouseMove","LeftButtonPress","LeftButtonRelease","MiddleButtonPress","MiddleButtonRelease","RightButtonPress","RightButtonRelease","KeyPress","KeyDown","KeyUp","StartMouseWheel","MouseWheel","EndMouseWheel","StartPinch","Pinch","EndPinch","StartPan","Pan","EndPan","StartRotate","Rotate","EndRotate","Button3D","Move3D","StartPointerLock","EndPointerLock","StartInteraction","Interaction","EndInteraction","AnimationFrameRateUpdate"];function qt(e){e.cancelable&&e.preventDefault()}function $t(e){const t=Object.create(null);return e.forEach((e=>{let{pointerId:n,position:r}=e;t[n]=r})),t}const Xt={renderWindow:null,interactorStyle:null,picker:null,pickingManager:null,initialized:!1,enabled:!1,enableRender:!0,currentRenderer:null,lightFollowCamera:!0,desiredUpdateRate:30,stillUpdateRate:2,container:null,recognizeGestures:!0,currentGesture:"Start",animationRequest:null,lastFrameTime:.1,recentAnimationFrameRate:10,wheelTimeoutID:0,moveTimeoutID:0,lastGamepadValues:{},preventDefaultOnPointerDown:!1,preventDefaultOnPointerUp:!1,mouseScrollDebounceByPass:!1};function Yt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Xt,n),o.m.obj(e,t),t._animationExtendedEnd=0,o.m.event(e,t,"RenderEvent"),Kt.forEach((n=>o.m.event(e,t,n))),o.m.get(e,t,["initialized","interactorStyle","lastFrameTime","recentAnimationFrameRate","_view"]),o.m.setGet(e,t,["container","lightFollowCamera","enabled","enableRender","recognizeGestures","desiredUpdateRate","stillUpdateRate","picker","preventDefaultOnPointerDown","preventDefaultOnPointerUp","mouseScrollDebounceByPass"]),o.m.moveToProtected(e,t,["view"]),function(e,t){t.classHierarchy.push("vtkRenderWindowInteractor");const n={...e},r=new Set,i=new Map;let o=1;function a(n,r){t._forcedRenderer||(t.currentRenderer=e.findPokedRenderer(n,r))}e.start=()=>{(t.initialized||(e.initialize(),t.initialized))&&e.startEventLoop()},e.setRenderWindow=e=>{Gt("you want to call setView(view) instead of setRenderWindow on a vtk.js interactor")},e.setInteractorStyle=n=>{t.interactorStyle!==n&&(null!=t.interactorStyle&&t.interactorStyle.setInteractor(null),t.interactorStyle=n,null!=t.interactorStyle&&t.interactorStyle.getInteractor()!==e&&t.interactorStyle.setInteractor(e))},e.initialize=()=>{t.initialized=!0,e.enable(),e.render()},e.enable=()=>e.setEnabled(!0),e.disable=()=>e.setEnabled(!1),e.startEventLoop=()=>Ut("empty event loop"),e.getCurrentRenderer=()=>(t.currentRenderer||a(0,0),t.currentRenderer);const s=t._getScreenEventPositionFor||function(e){const n=t._view.getCanvas(),r=n.getBoundingClientRect(),o=n.width/r.width,s=n.height/r.height,l={x:o*(e.clientX-r.left),y:s*(r.height-e.clientY+r.top),z:0};return(i.size<=1||!t.currentRenderer)&&a(l.x,l.y),l};function l(e){return{controlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey}}function c(e){const t=l(e);return{key:e.key,keyCode:e.charCode,...t}}function u(e){return e.pointerType||""}const d=()=>{if(null===t.container)return;const{container:n}=t;n.addEventListener("contextmenu",qt),n.addEventListener("wheel",e.handleWheel),n.addEventListener("DOMMouseScroll",e.handleWheel),n.addEventListener("pointerenter",e.handlePointerEnter),n.addEventListener("pointerleave",e.handlePointerLeave),n.addEventListener("pointermove",e.handlePointerMove,{passive:!1}),n.addEventListener("pointerdown",e.handlePointerDown,{passive:!1}),n.addEventListener("pointerup",e.handlePointerUp),n.addEventListener("pointercancel",e.handlePointerCancel),document.addEventListener("keypress",e.handleKeyPress),document.addEventListener("keydown",e.handleKeyDown),document.addEventListener("keyup",e.handleKeyUp),document.addEventListener("pointerlockchange",e.handlePointerLockChange),n.style.touchAction="none",n.style.userSelect="none",n.style.webkitTapHighlightColor="rgba(0,0,0,0)"};e.bindEvents=e=>{null!==e&&n.setContainer(e)&&d()};const p=()=>{clearTimeout(t.moveTimeoutID),clearTimeout(t.wheelTimeoutID),t.moveTimeoutID=0,t.wheelTimeoutID=0,o=1;const{container:n}=t;n&&(n.removeEventListener("contextmenu",qt),n.removeEventListener("wheel",e.handleWheel),n.removeEventListener("DOMMouseScroll",e.handleWheel),n.removeEventListener("pointerenter",e.handlePointerEnter),n.removeEventListener("pointerleave",e.handlePointerLeave),n.removeEventListener("pointermove",e.handlePointerMove,{passive:!1}),n.removeEventListener("pointerdown",e.handlePointerDown,{passive:!1}),n.removeEventListener("pointerup",e.handlePointerUp),n.removeEventListener("pointercancel",e.handlePointerCancel)),document.removeEventListener("keypress",e.handleKeyPress),document.removeEventListener("keydown",e.handleKeyDown),document.removeEventListener("keyup",e.handleKeyUp),document.removeEventListener("pointerlockchange",e.handlePointerLockChange),i.clear()};function f(){t._view&&t.enabled&&t.enableRender&&(t.inRender=!0,t._view.traverseAllPasses(),t.inRender=!1),e.invokeRenderEvent()}e.unbindEvents=()=>{p(),n.setContainer(null)},e.handleKeyPress=t=>{const n=c(t);e.keyPressEvent(n)},e.handleKeyDown=t=>{const n=c(t);e.keyDownEvent(n)},e.handleKeyUp=t=>{const n=c(t);e.keyUpEvent(n)},e.handlePointerEnter=t=>{const n={...l(t),position:s(t),deviceType:u(t)};e.pointerEnterEvent(n),"mouse"===n.deviceType&&e.mouseEnterEvent(n)},e.handlePointerLeave=t=>{const n={...l(t),position:s(t),deviceType:u(t)};e.pointerLeaveEvent(n),"mouse"===n.deviceType&&e.mouseLeaveEvent(n)},e.handlePointerDown=n=>{if(!(n.button>2||e.isPointerLocked()))switch(t.preventDefaultOnPointerDown&&qt(n),n.target.hasPointerCapture(n.pointerId)&&n.target.releasePointerCapture(n.pointerId),t.container.setPointerCapture(n.pointerId),i.has(n.pointerId)&&Ut("[RenderWindowInteractor] duplicate pointerId detected"),i.set(n.pointerId,{pointerId:n.pointerId,position:s(n)}),n.pointerType){case"pen":case"touch":e.handleTouchStart(n);break;default:e.handleMouseDown(n)}},e.handlePointerUp=n=>{if(i.has(n.pointerId))switch(t.preventDefaultOnPointerUp&&qt(n),i.delete(n.pointerId),t.container.releasePointerCapture(n.pointerId),n.pointerType){case"pen":case"touch":e.handleTouchEnd(n);break;default:e.handleMouseUp(n)}},e.handlePointerCancel=t=>{if(i.has(t.pointerId))switch(i.delete(t.pointerId),t.pointerType){case"pen":case"touch":e.handleTouchEnd(t);break;default:e.handleMouseUp(t)}},e.handlePointerMove=t=>{switch(i.has(t.pointerId)&&(i.get(t.pointerId).position=s(t)),t.pointerType){case"pen":case"touch":e.handleTouchMove(t);break;default:e.handleMouseMove(t)}},e.handleMouseDown=t=>{const n={...l(t),position:s(t),deviceType:u(t)};switch(t.button){case 0:e.leftButtonPressEvent(n);break;case 1:e.middleButtonPressEvent(n);break;case 2:e.rightButtonPressEvent(n);break;default:Gt(`Unknown mouse button pressed: ${t.button}`)}},e.requestPointerLock=()=>{t.container&&t.container.requestPointerLock()},e.exitPointerLock=()=>document.exitPointerLock?.(),e.isPointerLocked=()=>!!t.container&&document.pointerLockElement===t.container,e.handlePointerLockChange=()=>{e.isPointerLocked()?e.startPointerLockEvent():e.endPointerLockEvent()},e.requestAnimation=n=>{void 0!==n?r.has(n)?Ut("requester is already registered for animating"):(r.add(n),t.animationRequest||1!==r.size||t.xrAnimation||(t._animationStartTime=Date.now(),t._animationFrameCount=0,t.animationRequest=requestAnimationFrame(e.handleAnimation),e.startAnimationEvent())):Gt("undefined requester, can not start animating")},e.extendAnimation=n=>{const i=Date.now()+n;t._animationExtendedEnd=Math.max(t._animationExtendedEnd,i),t.animationRequest||0!==r.size||t.xrAnimation||(t._animationStartTime=Date.now(),t._animationFrameCount=0,t.animationRequest=requestAnimationFrame(e.handleAnimation),e.startAnimationEvent())},e.isAnimating=()=>t.xrAnimation||null!==t.animationRequest,e.cancelAnimation=function(n){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r.has(n))r.delete(n),t.animationRequest&&0===r.size&&Date.now()>t._animationExtendedEnd&&(cancelAnimationFrame(t.animationRequest),t.animationRequest=null,e.endAnimationEvent(),e.render());else if(!i){const e=n&&n.getClassName?n.getClassName():n;Ut(`${e} did not request an animation`)}},e.switchToXRAnimation=()=>{t.animationRequest&&(cancelAnimationFrame(t.animationRequest),t.animationRequest=null),t.xrAnimation=!0},e.returnFromXRAnimation=()=>{t.xrAnimation=!1,0!==r.size&&(t.recentAnimationFrameRate=10,t.animationRequest=requestAnimationFrame(e.handleAnimation))},e.updateXRGamepads=(n,r,i)=>{n.inputSources.forEach((n=>{const o=null==n.gripSpace?null:r.getPose(n.gripSpace,i),a=null==n.gripSpace?null:r.getPose(n.targetRaySpace,i),s=n.gamepad,l=n.handedness;if(s){s.index in t.lastGamepadValues||(t.lastGamepadValues[s.index]={left:{buttons:{}},right:{buttons:{}},none:{buttons:{}}});for(let r=0;r<s.buttons.length;++r)r in t.lastGamepadValues[s.index][l].buttons||(t.lastGamepadValues[s.index][l].buttons[r]=!1),t.lastGamepadValues[s.index][l].buttons[r]!==s.buttons[r].pressed&&null!=o&&(e.button3DEvent({gamepad:s,position:o.transform.position,orientation:o.transform.orientation,targetPosition:a.transform.position,targetOrientation:a.transform.orientation,pressed:s.buttons[r].pressed,device:"left"===n.handedness?Vt.LeftController:Vt.RightController,input:Ht[s.mapping]&&Ht[s.mapping][r]?Ht[s.mapping][r]:kt.Trigger}),t.lastGamepadValues[s.index][l].buttons[r]=s.buttons[r].pressed),t.lastGamepadValues[s.index][l].buttons[r]&&null!=o&&e.move3DEvent({gamepad:s,position:o.transform.position,orientation:o.transform.orientation,targetPosition:a.transform.position,targetOrientation:a.transform.orientation,device:"left"===n.handedness?Vt.LeftController:Vt.RightController})}}))},e.handleMouseMove=n=>{const r={...l(n),position:s(n),deviceType:u(n)};0===t.moveTimeoutID?e.startMouseMoveEvent(r):(e.mouseMoveEvent(r),clearTimeout(t.moveTimeoutID)),t.moveTimeoutID=setTimeout((()=>{e.endMouseMoveEvent(),t.moveTimeoutID=0}),200)},e.handleAnimation=()=>{const n=Date.now();t._animationFrameCount++,n-t._animationStartTime>1e3&&t._animationFrameCount>1&&(t.recentAnimationFrameRate=1e3*(t._animationFrameCount-1)/(n-t._animationStartTime),t.lastFrameTime=1/t.recentAnimationFrameRate,e.animationFrameRateUpdateEvent(),t._animationStartTime=n,t._animationFrameCount=1),e.animationEvent(),f(),r.size>0||Date.now()<t._animationExtendedEnd?t.animationRequest=requestAnimationFrame(e.handleAnimation):(cancelAnimationFrame(t.animationRequest),t.animationRequest=null,e.endAnimationEvent(),e.render())},e.handleWheel=n=>{qt(n);const r={...zt(n),...l(n),position:s(n),deviceType:u(n)};0===t.wheelTimeoutID&&(o=Math.abs(r.spinY)>=.3?Math.abs(r.spinY):1),r.spinY/=o,0===t.wheelTimeoutID?(e.startMouseWheelEvent(r),e.mouseWheelEvent(r)):(e.mouseWheelEvent(r),clearTimeout(t.wheelTimeoutID)),t.mouseScrollDebounceByPass?(e.extendAnimation(600),e.endMouseWheelEvent(),t.wheelTimeoutID=0):t.wheelTimeoutID=setTimeout((()=>{e.extendAnimation(600),e.endMouseWheelEvent(),t.wheelTimeoutID=0}),200)},e.handleMouseUp=t=>{const n={...l(t),position:s(t),deviceType:u(t)};switch(t.button){case 0:e.leftButtonReleaseEvent(n);break;case 1:e.middleButtonReleaseEvent(n);break;case 2:e.rightButtonReleaseEvent(n);break;default:Gt(`Unknown mouse button released: ${t.button}`)}},e.handleTouchStart=n=>{const r=[...i.values()];if(t.recognizeGestures&&r.length>1){const t=$t(i);if(2===r.length){const t={...l(jt),position:r[0].position,deviceType:u(n)};e.leftButtonReleaseEvent(t)}e.recognizeGesture("TouchStart",t)}else if(1===r.length){const t={...l(jt),position:s(n),deviceType:u(n)};e.leftButtonPressEvent(t)}},e.handleTouchMove=n=>{const r=[...i.values()];if(t.recognizeGestures&&r.length>1){const t=$t(i);e.recognizeGesture("TouchMove",t)}else if(1===r.length){const t={...l(jt),position:r[0].position,deviceType:u(n)};e.mouseMoveEvent(t)}},e.handleTouchEnd=n=>{const r=[...i.values()];if(t.recognizeGestures)if(0===r.length){const t={...l(jt),position:s(n),deviceType:u(n)};e.leftButtonReleaseEvent(t)}else if(1===r.length){const t=$t(i);e.recognizeGesture("TouchEnd",t);const o={...l(jt),position:r[0].position,deviceType:u(n)};e.leftButtonPressEvent(o)}else{const t=$t(i);e.recognizeGesture("TouchMove",t)}else if(1===r.length){const t={...l(jt),position:r[0].position,deviceType:u(n)};e.leftButtonReleaseEvent(t)}},e.setView=n=>{t._view!==n&&(t._view=n,t._view.getRenderable().setInteractor(e),e.modified())},e.getFirstRenderer=()=>t._view?.getRenderable()?.getRenderersByReference()?.[0],e.findPokedRenderer=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!t._view)return null;const r=t._view?.getRenderable()?.getRenderers();if(!r||0===r.length)return null;r.sort(((e,t)=>e.getLayer()-t.getLayer()));let i=null,o=null,a=null,s=r.length;for(;s--;){const l=r[s];if(t._view.isInViewport(e,n,l)&&l.getInteractive()){a=l;break}null===i&&l.getInteractive()&&(i=l),null===o&&t._view.isInViewport(e,n,l)&&(o=l)}return null===a&&(a=i),null===a&&(a=o),null==a&&(a=r[0]),a},e.render=()=>{e.isAnimating()||t.inRender||f()},Kt.forEach((n=>{const r=n.charAt(0).toLowerCase()+n.slice(1);e[`${r}Event`]=r=>{if(!t.enabled)return;if(!e.getCurrentRenderer())return void Wt("\n          Can not forward events without a current renderer on the interactor.\n        ");const i={type:n,pokedRenderer:t.currentRenderer,firstRenderer:e.getFirstRenderer(),...r};e[`invoke${n}`](i)}})),e.recognizeGesture=(n,r)=>{if(Object.keys(r).length>2)return;if(t.startingEventPositions||(t.startingEventPositions={}),"TouchStart"===n)return Object.keys(r).forEach((e=>{t.startingEventPositions[e]=r[e]})),void(t.currentGesture="Start");if("TouchEnd"===n)return"Pinch"===t.currentGesture&&(e.render(),e.endPinchEvent()),"Rotate"===t.currentGesture&&(e.render(),e.endRotateEvent()),"Pan"===t.currentGesture&&(e.render(),e.endPanEvent()),t.currentGesture="Start",void(t.startingEventPositions={});let i=0;const o=[],a=[];Object.keys(r).forEach((e=>{o[i]=r[e],a[i]=t.startingEventPositions[e],i++}));const s=Math.sqrt((a[0].x-a[1].x)*(a[0].x-a[1].x)+(a[0].y-a[1].y)*(a[0].y-a[1].y)),l=Math.sqrt((o[0].x-o[1].x)*(o[0].x-o[1].x)+(o[0].y-o[1].y)*(o[0].y-o[1].y));let c=(0,rt.A)(Math.atan2(a[1].y-a[0].y,a[1].x-a[0].x)),u=(0,rt.A)(Math.atan2(o[1].y-o[0].y,o[1].x-o[0].x)),d=u-c;u=u+180>=360?u-180:u+180,c=c+180>=360?c-180:c+180,Math.abs(u-c)<Math.abs(d)&&(d=u-c);const p=[];if(p[0]=(o[0].x-a[0].x+o[1].x-a[1].x)/2,p[1]=(o[0].y-a[0].y+o[1].y-a[1].y)/2,"TouchMove"===n)if("Start"===t.currentGesture){let n=.01*Math.sqrt(t.container.clientWidth*t.container.clientWidth+t.container.clientHeight*t.container.clientHeight);n<15&&(n=15);const i=Math.abs(l-s),o=3.1415926*l*Math.abs(d)/360,a=Math.sqrt(p[0]*p[0]+p[1]*p[1]);if(i>n&&i>o&&i>a){t.currentGesture="Pinch";const n={scale:1,touches:r};e.startPinchEvent(n)}else if(o>n&&o>a){t.currentGesture="Rotate";const n={rotation:0,touches:r};e.startRotateEvent(n)}else if(a>n){t.currentGesture="Pan";const n={translation:[0,0],touches:r};e.startPanEvent(n)}}else{if("Rotate"===t.currentGesture){const t={rotation:d,touches:r};e.rotateEvent(t)}if("Pinch"===t.currentGesture){const t={scale:l/s,touches:r};e.pinchEvent(t)}if("Pan"===t.currentGesture){const t={translation:p,touches:r};e.panEvent(t)}}},e.handleVisibilityChange=()=>{t._animationStartTime=Date.now(),t._animationFrameCount=0},e.setCurrentRenderer=e=>{t._forcedRenderer=!!e,t.currentRenderer=e},e.setContainer=e=>{p();const t=n.setContainer(e??null);return t&&d(),t},e.delete=()=>{for(;r.size;)e.cancelAnimation(r.values().next().value);void 0!==document.hidden&&document.removeEventListener("visibilitychange",e.handleVisibilityChange),t.container&&e.setContainer(null),n.delete()},void 0!==document.hidden&&document.addEventListener("visibilitychange",e.handleVisibilityChange,!1)}(e,t)}var Jt={newInstance:o.m.newInstance(Yt,"vtkRenderWindowInteractor"),extend:Yt,handledEvents:Kt,...Bt};n(74966),n(87275),n(7019),n(82409);const Zt={background:[0,0,0],container:null};function Qt(e,t,n={}){Object.assign(t,Zt,n),r.Ay.obj(e,t),r.Ay.get(e,t,["renderWindow","openGLRenderWindow","interactor","container"]),r.Ay.event(e,t,"resize"),function(e,t){const n=e.invokeResize;delete e.invokeResize,t.renderWindow=d.newInstance(),t.rendererMap={},t.openGLRenderWindow=Lt.newInstance(),t.renderWindow.addView(t.openGLRenderWindow),t.interactor=Jt.newInstance(),t.interactor.setView(t.openGLRenderWindow),t.interactor.initialize(),e.addRenderer=({viewport:e,id:n,background:r})=>{const i=Ft.Ay.newInstance({viewport:e,background:r||t.background});t.renderWindow.addRenderer(i),t.rendererMap[n]=i},e.destroy=()=>{t.renderWindow.getInteractor().delete()},e.removeRenderer=n=>{const r=e.getRenderer(n);t.renderWindow.removeRenderer(r),r.delete(),delete t.rendererMap[n]},e.getRenderer=e=>t.rendererMap[e],e.getRenderers=()=>{const{rendererMap:e}=t;return Object.keys(e).map((t=>({id:t,renderer:e[t]})))},e.resize=()=>{if(t.container){const{width:e,height:r}=t.container;t.openGLRenderWindow.setSize(Math.floor(e),Math.floor(r)),n(),t.renderWindow.render()}},e.setContainer=e=>{t.container=e,t.openGLRenderWindow.setContainer(t.container)},e.delete=r.Ay.chain(e.setContainer,e.destroy,t.openGLRenderWindow.delete,e.delete),e.resize()}(e,t)}const en={newInstance:r.Ay.newInstance(Qt),extend:Qt};var tn=n(53387);const nn={scalarTexture:null};function rn(e,t,n={}){Object.assign(t,nn,n),tn.Ay.extend(e,t,n),r.Ay.setGet(e,t,["scalarTexture"]),function(e,t){t.classHierarchy.push("vtkSharedVolumeMapper");const n=e.delete;e.delete=()=>{t.scalarTexture=null,n()}}(e,t)}const on={newInstance:r.Ay.newInstance(rn,"vtkSharedVolumeMapper"),extend:rn};var an=n(49038);function sn(e,t){const n=new((0,Tt.j)(t))(e.length);return n.set(e),n}function ln(e,t){t.classHierarchy.push("vtkStreamingOpenGLTexture"),t.updatedFrames=[],t.volumeId=null;const n=e.create3DFilterableFromRaw;e.create3DFilterableFromRaw=(e,r,i,o,a,s,l)=>{t.inputDataType=a,t.inputNumComps=o,n(e,r,i,o,a,s,l)};const r=e.updateVolumeInfoForGL;e.updateVolumeInfoForGL=(e,n)=>{const i=r(e,n);return t.volumeInfo.dataComputedScale=[1],t.volumeInfo.dataComputedOffset=[0],i},e.update3DFromRaw=()=>{const{volumeId:n}=t;if(!n)return;const r=an.Ay.getVolume(n);if(t._openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind(),!r.isDynamicVolume())return e.hasUpdatedFrames()&&function(){const n=an.Ay.getVolume(t.volumeId),r=n.imageIds;for(let i=0;i<t.updatedFrames.length;i++)if(t.updatedFrames[i]){const o=an.Ay.getImage(r[i]);if(!o)continue;let a=o.voxelManager.getScalarData();const s=t.context;n.dataType!==a.constructor.name&&(a=sn(a,n.dataType));const[l]=e.updateArrayDataTypeForGL(n.dataType,[a]);e.bind();const c=i;s.texSubImage3D(t.target,0,0,0,c,t.width,t.height,1,t.format,t.openGLDataType,l),e.deactivate(),t.updatedFrames[i]=null}t.generateMipmap&&t.context.generateMipmap(t.target);return e.deactivate(),!0}();!function(){const n=an.Ay.getVolume(t.volumeId),r=n.getCurrentDimensionGroupImageIds();if(!r.length)return!1;let i;for(let o=0;o<r.length;o++){const a=r[o],s=an.Ay.getImage(a);let l;s?(l=s.voxelManager.getScalarData(),i=l.constructor):(i=(0,Tt.j)(n.dataType,!0),l=new i(t.width*t.height));const c=t.context;n.dataType!==l.constructor.name&&(l=sn(l,n.dataType));const[u]=e.updateArrayDataTypeForGL(n.dataType,[l]);e.bind();let d=o;c.texSubImage3D(t.target,0,0,0,d,t.width,t.height,1,t.format,t.openGLDataType,u),e.deactivate()}t.generateMipmap&&t.context.generateMipmap(t.target);e.deactivate()}()};const i=e.modified;e.setUpdatedFrame=e=>{t.updatedFrames[e]=!0,i()},e.modified=()=>{i();const e=an.Ay.getVolume(t.volumeId);if(!e)return;const n=e.imageIds;for(let e=0;e<n.length;e++)t.updatedFrames[e]=!0},e.hasUpdatedFrames=()=>!t.updatedFrames.length||t.updatedFrames.some((e=>e)),e.getUpdatedFrames=()=>t.updatedFrames,e.setVolumeId=e=>{t.volumeId=e},e.getVolumeId=()=>t.volumeId,e.setTextureParameters=({width:e,height:n,depth:r,numberOfComponents:i,dataType:o})=>{t.width??=e,t.height??=n,t.depth??=r,t.inputNumComps??=i,t.inputDataType??=o},e.getTextureParameters=()=>({width:t.width,height:t.height,depth:t.depth,numberOfComponents:t.inputNumComps,dataType:t.inputDataType})}const cn={updatedFrames:[]};function un(e,t,n={}){Object.assign(t,cn,n),g.Ay.extend(e,t,n),ln(e,t)}const dn={newInstance:r.Ay.newInstance(un,"vtkStreamingOpenGLTexture"),extend:un};n(17232)},17232:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var r=n(37290),i=n(26719),o=n(84607),a=n(3823);const s={isPerformingCoordinateTransformation:!1};function l(e,t,n={}){Object.assign(t,s,n),i.Ay.extend(e,t,n),r.Ay.setGet(e,t,["isPerformingCoordinateTransformation"]),function(e,t){t.classHierarchy.push("vtkSlabCamera");const n=a.pB.identity(new Float64Array(16)),r=new Float64Array(3);e.getProjectionMatrix=(e,i,s)=>{const l=a.pB.create();if(t.projectionMatrix){const e=1/t.physicalScale;return a.eR.set(r,e,e,e),a.pB.copy(l,t.projectionMatrix),a.pB.scale(l,l,r),a.pB.transpose(l,l),l}a.pB.identity(n);let c=t.clippingRange[0],u=t.clippingRange[1];t.isPerformingCoordinateTransformation&&(c=t.distance,u=t.distance+.1);const d=u-c,p=[c+(i+1)*d/2,c+(s+1)*d/2];if(t.parallelProjection){const r=t.parallelScale*e,i=t.parallelScale,o=(t.windowCenter[0]-1)*r,s=(t.windowCenter[0]+1)*r,l=(t.windowCenter[1]-1)*i,c=(t.windowCenter[1]+1)*i;a.pB.ortho(n,o,s,l,c,p[0],p[1]),a.pB.transpose(n,n)}else{if(t.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const r=Math.tan(o.Ay.radiansFromDegrees(t.viewAngle)/2);let i,a;!0===t.useHorizontalViewAngle?(i=c*r,a=c*r/e):(i=c*r*e,a=c*r);const s=(t.windowCenter[0]-1)*i,l=(t.windowCenter[0]+1)*i,u=(t.windowCenter[1]-1)*a,d=(t.windowCenter[1]+1)*a,f=p[0],h=p[1];n[0]=2*f/(l-s),n[5]=2*f/(d-u),n[2]=(s+l)/(l-s),n[6]=(u+d)/(d-u),n[10]=-(f+h)/(h-f),n[14]=-1,n[11]=-2*f*h/(h-f),n[15]=0}}return a.pB.copy(l,n),l}}(e,t)}const c={newInstance:r.Ay.newInstance(l,"vtkSlabCamera"),extend:l}},49038:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var r=n(69372),i=n(39537),o=n(10364),a=n(32643),s=n(71851),l=n(20286);const c=new class{constructor(){this._imageCache=new Map,this._volumeCache=new Map,this._imageIdsToVolumeIdCache=new Map,this._referencedImageIdToImageIdCache=new Map,this._geometryCache=new Map,this._imageCacheSize=0,this._maxCacheSize=3221225472,this._geometryCacheSize=0,this.setMaxCacheSize=e=>{if(!e||"number"!=typeof e){const e=`New max cacheSize ${this._maxCacheSize} should be defined and should be a number.`;throw new Error(e)}this._maxCacheSize=e},this.isCacheable=e=>this.getBytesAvailable()+Array.from(this._imageCache.values()).reduce(((e,t)=>t.sharedCacheKey?e:e+t.sizeInBytes),0)>=e,this.getMaxCacheSize=()=>this._maxCacheSize,this.getCacheSize=()=>this._imageCacheSize,this._decacheImage=(e,t=!1)=>{const n=this._imageCache.get(e);if(!n)return;if(n.sharedCacheKey&&!t)throw new Error("Cannot decache an image with a shared cache key. You need to manually decache the volume first.");const{imageLoadObject:r}=n;n.image?.referencedImageId&&this._referencedImageIdToImageIdCache.delete(n.image.referencedImageId),r?.cancelFn&&r.cancelFn(),r?.decache&&r.decache(),this._imageCache.delete(e)},this._decacheVolume=e=>{const t=this._volumeCache.get(e);if(!t)return;const{volumeLoadObject:n,volume:r}=t;r&&(r.cancelLoading&&r.cancelLoading(),r.imageData&&r.imageData.delete(),n.cancelFn&&n.cancelFn(),r.imageIds&&r.imageIds.forEach((t=>{const n=this._imageCache.get(t);n&&n.sharedCacheKey===e&&(n.sharedCacheKey=void 0)})),this._volumeCache.delete(e))},this.purgeCache=()=>{const e=this._imageCache.keys();for(this.purgeVolumeCache();;){const{value:t,done:n}=e.next();if(n)break;this.removeImageLoadObject(t,{force:!0}),(0,r.A)(o.A,a.A.IMAGE_CACHE_IMAGE_REMOVED,{imageId:t})}},this.purgeVolumeCache=()=>{const e=this._volumeCache.keys();for(;;){const{value:t,done:n}=e.next();if(n)break;this.removeVolumeLoadObject(t),(0,r.A)(o.A,a.A.VOLUME_CACHE_VOLUME_REMOVED,{volumeId:t})}},this.getVolumeLoadObject=e=>{if(void 0===e)throw new Error("getVolumeLoadObject: volumeId must not be undefined");const t=this._volumeCache.get(e);if(t)return t.timeStamp=Date.now(),t.volumeLoadObject},this.putGeometryLoadObject=(e,t)=>{if(void 0===e)throw new Error("putGeometryLoadObject: geometryId must not be undefined");if(void 0===t.promise)throw new Error("putGeometryLoadObject: geometryLoadObject.promise must not be undefined");if(this._geometryCache.has(e))throw new Error("putGeometryLoadObject: geometryId already present in geometryCache");if(t.cancelFn&&"function"!=typeof t.cancelFn)throw new Error("putGeometryLoadObject: geometryLoadObject.cancel must be a function");const n={loaded:!1,geometryId:e,geometryLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};return this._geometryCache.set(e,n),t.promise.then((t=>{try{this._putGeometryCommon(e,t,n)}catch(t){throw console.debug(`Error in _putGeometryCommon for geometry ${e}:`,t),t}})).catch((t=>{throw console.debug(`Error caching geometry ${e}:`,t),this._geometryCache.delete(e),t}))},this.getGeometry=e=>{if(void 0===e)throw new Error("getGeometry: geometryId must not be undefined");const t=this._geometryCache.get(e);if(t)return t.timeStamp=Date.now(),t.geometry},this.removeGeometryLoadObject=e=>{if(void 0===e)throw new Error("removeGeometryLoadObject: geometryId must not be undefined");const t=this._geometryCache.get(e);if(!t)throw new Error("removeGeometryLoadObject: geometryId was not present in geometryCache");this.decrementGeometryCacheSize(t.sizeInBytes);const n={geometry:t,geometryId:e};(0,r.A)(o.A,a.A.GEOMETRY_CACHE_GEOMETRY_REMOVED,n),this._decacheGeometry(e)},this._decacheGeometry=e=>{const t=this._geometryCache.get(e);if(!t)return;const{geometryLoadObject:n}=t;n.cancelFn&&n.cancelFn(),n.decache&&n.decache(),this._geometryCache.delete(e)},this.incrementGeometryCacheSize=e=>{this._geometryCacheSize+=e},this.decrementGeometryCacheSize=e=>{this._geometryCacheSize-=e},this.getImageByReferencedImageId=e=>{const t=this._referencedImageIdToImageIdCache.get(e);if(t)return this._imageCache.get(t)?.image},this.getImage=(e,t=s.ImageQualityStatus.FAR_REPLICATE)=>{if(void 0===e)throw new Error("getImage: imageId must not be undefined");const n=this._imageCache.get(e);if(n&&(n.timeStamp=Date.now(),!(n.image?.imageQualityStatus<t)))return n.image},this.getVolume=(e,t=!1)=>{if(void 0===e)throw new Error("getVolume: volumeId must not be undefined");const n=this._volumeCache.get(e);return n?(n.timeStamp=Date.now(),n.volume):t?[...this._volumeCache.values()].find((t=>t.volumeId.includes(e)))?.volume:void 0},this.getVolumes=()=>Array.from(this._volumeCache.values()).map((e=>e.volume)),this.filterVolumesByReferenceId=e=>this.getVolumes().filter((t=>t.referencedVolumeId===e)),this.removeImageLoadObject=(e,{force:t=!1}={})=>{if(void 0===e)throw new Error("removeImageLoadObject: imageId must not be undefined");const n=this._imageCache.get(e);if(!n)throw new Error("removeImageLoadObject: imageId was not present in imageCache");this._decacheImage(e,t),this.incrementImageCacheSize(-n.sizeInBytes);const i={image:n,imageId:e};(0,r.A)(o.A,a.A.IMAGE_CACHE_IMAGE_REMOVED,i)},this.removeVolumeLoadObject=e=>{if(void 0===e)throw new Error("removeVolumeLoadObject: volumeId must not be undefined");const t=this._volumeCache.get(e);if(!t)throw new Error("removeVolumeLoadObject: volumeId was not present in volumeCache");const n={volume:t,volumeId:e};(0,r.A)(o.A,a.A.VOLUME_CACHE_VOLUME_REMOVED,n),this._decacheVolume(e)},this.incrementImageCacheSize=e=>{this._imageCacheSize+=e},this.decrementImageCacheSize=e=>{this._imageCacheSize-=e},this.getGeometryLoadObject=e=>{if(void 0===e)throw new Error("getGeometryLoadObject: geometryId must not be undefined");const t=this._geometryCache.get(e);if(t)return t.timeStamp=Date.now(),t.geometryLoadObject}}generateVolumeId(e){const t=e.map(i.A).sort();let n=2166136261;for(const e of t){const t=(0,l.A)(e);for(let e=0;e<t.length;e++)n^=t.charCodeAt(e),n+=(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24)}return`volume-${(n>>>0).toString(36)}`}getImageIdsForVolumeId(e){return Array.from(this._imageIdsToVolumeIdCache.entries()).filter((([t,n])=>n===e)).map((([e])=>e))}getBytesAvailable(){return this.getMaxCacheSize()-this.getCacheSize()}decacheIfNecessaryUntilBytesAvailable(e,t){let n=this.getBytesAvailable();if(n>=e)return n;const i=Array.from(this._imageCache.values()).filter((e=>!e.sharedCacheKey));i.sort((function(e,t){return e.timeStamp>t.timeStamp?1:e.timeStamp<t.timeStamp?-1:0}));const s=i.map((e=>e.imageId));let l=s;t&&(l=s.filter((e=>!t.includes(e))));for(const t of l)if(this.removeImageLoadObject(t),(0,r.A)(o.A,a.A.IMAGE_CACHE_IMAGE_REMOVED,{imageId:t}),n=this.getBytesAvailable(),n>=e)return n;for(const t of s)if(this.removeImageLoadObject(t),(0,r.A)(o.A,a.A.IMAGE_CACHE_IMAGE_REMOVED,{imageId:t}),n=this.getBytesAvailable(),n>=e)return n}_putImageCommon(e,t,n){if(!this._imageCache.has(e))return void console.warn("The image was purged from the cache before it completed loading.");if(!t)return void console.warn("Image is undefined");if(void 0===t.sizeInBytes||Number.isNaN(t.sizeInBytes))throw new Error("_putImageCommon: image.sizeInBytes must not be undefined");if(void 0===t.sizeInBytes.toFixed)throw new Error("_putImageCommon: image.sizeInBytes is not a number");if(!this.isCacheable(t.sizeInBytes))throw new Error(a.A.CACHE_SIZE_EXCEEDED);this.decacheIfNecessaryUntilBytesAvailable(t.sizeInBytes),n.loaded=!0,n.image=t,n.sizeInBytes=t.sizeInBytes,this.incrementImageCacheSize(n.sizeInBytes);const i={image:n};t.referencedImageId&&this._referencedImageIdToImageIdCache.set(t.referencedImageId,e),(0,r.A)(o.A,a.A.IMAGE_CACHE_IMAGE_ADDED,i),n.sharedCacheKey=t.sharedCacheKey}async putImageLoadObject(e,t){if(void 0===e)throw console.error("putImageLoadObject: imageId must not be undefined"),new Error("putImageLoadObject: imageId must not be undefined");if(void 0===t.promise)throw console.error("putImageLoadObject: imageLoadObject.promise must not be undefined"),new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");const n=this._imageCache.get(e);if(n?.imageLoadObject)throw console.warn(`putImageLoadObject: imageId ${e} already in cache`),new Error("putImageLoadObject: imageId already in cache");if(t.cancelFn&&"function"!=typeof t.cancelFn)throw console.error("putImageLoadObject: imageLoadObject.cancel must be a function"),new Error("putImageLoadObject: imageLoadObject.cancel must be a function");const r={...n,loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};return this._imageCache.set(e,r),this._imageCache.set(e,r),t.promise.then((t=>{try{this._putImageCommon(e,t,r)}catch(t){throw console.debug(`Error in _putImageCommon for image ${e}:`,t),t}})).catch((t=>{throw console.debug(`Error caching image ${e}:`,t),this._imageCache.delete(e),t}))}putImageSync(e,t){if(void 0===e)throw new Error("putImageSync: imageId must not be undefined");if(this._imageCache.has(e))throw new Error("putImageSync: imageId already in cache");const n={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:{promise:Promise.resolve(t)},timeStamp:Date.now(),sizeInBytes:0};this._imageCache.set(e,n);try{this._putImageCommon(e,t,n)}catch(t){throw this._imageCache.delete(e),t}}getImageLoadObject(e){if(void 0===e)throw new Error("getImageLoadObject: imageId must not be undefined");const t=this._imageCache.get(e);if(t)return t.timeStamp=Date.now(),t.imageLoadObject}isLoaded(e){const t=this._imageCache.get(e);return!!t&&t.loaded}getVolumeContainingImageId(e){const t=Array.from(this._volumeCache.keys()),n=(0,i.A)(e);for(const e of t){const t=this._volumeCache.get(e);if(!t)return;const{volume:r}=t;if(!r.imageIds.length)return;const i=r.getImageURIIndex(n);if(i>-1)return{volume:r,imageIdIndex:i}}}getCachedImageBasedOnImageURI(e){const t=(0,i.A)(e),n=Array.from(this._imageCache.keys()).find((e=>(0,i.A)(e)===t));if(n)return this._imageCache.get(n)}_putVolumeCommon(e,t,n){if(!this._volumeCache.get(e))return void console.warn("The volume was purged from the cache before it completed loading.");n.loaded=!0,n.volume=t,t.imageIds?.forEach((t=>{const n=this._imageCache.get(t);n&&(n.sharedCacheKey=e)}));const i={volume:n};(0,r.A)(o.A,a.A.VOLUME_CACHE_VOLUME_ADDED,i)}putVolumeSync(e,t){if(void 0===e)throw new Error("putVolumeSync: volumeId must not be undefined");if(this._volumeCache.has(e))throw new Error("putVolumeSync: volumeId already in cache");const n={loaded:!1,volumeId:e,volumeLoadObject:{promise:Promise.resolve(t)},timeStamp:Date.now(),sizeInBytes:0};this._volumeCache.set(e,n);try{this._putVolumeCommon(e,t,n)}catch(t){throw this._volumeCache.delete(e),t}}async putVolumeLoadObject(e,t){if(void 0===e)throw new Error("putVolumeLoadObject: volumeId must not be undefined");if(void 0===t.promise)throw new Error("putVolumeLoadObject: volumeLoadObject.promise must not be undefined");if(this._volumeCache.has(e))throw new Error(`putVolumeLoadObject: volumeId:${e} already in cache`);if(t.cancelFn&&"function"!=typeof t.cancelFn)throw new Error("putVolumeLoadObject: volumeLoadObject.cancel must be a function");const n={loaded:!1,volumeId:e,volumeLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};return this._volumeCache.set(e,n),t.promise.then((t=>{try{this._putVolumeCommon(e,t,n)}catch(t){throw console.error(`Error in _putVolumeCommon for volume ${e}:`,t),this._volumeCache.delete(e),t}})).catch((t=>{throw this._volumeCache.delete(e),t}))}_putGeometryCommon(e,t,n){if(!this._geometryCache.get(e))return void console.warn("The geometry was purged from the cache before it completed loading.");if(!t)return void console.warn("Geometry is undefined");if(void 0===t.sizeInBytes||Number.isNaN(t.sizeInBytes))throw new Error("_putGeometryCommon: geometry.sizeInBytes must not be undefined");if(void 0===t.sizeInBytes.toFixed)throw new Error("_putGeometryCommon: geometry.sizeInBytes is not a number");if(!this.isCacheable(t.sizeInBytes))throw new Error(a.A.CACHE_SIZE_EXCEEDED);this.decacheIfNecessaryUntilBytesAvailable(t.sizeInBytes),n.loaded=!0,n.geometry=t,n.sizeInBytes=t.sizeInBytes,this.incrementGeometryCacheSize(n.sizeInBytes);const i={geometry:n};(0,r.A)(o.A,a.A.GEOMETRY_CACHE_GEOMETRY_ADDED,i)}putGeometrySync(e,t){if(void 0===e)throw new Error("putGeometrySync: geometryId must not be undefined");if(this._geometryCache.has(e))throw new Error("putGeometrySync: geometryId already in cache");const n={loaded:!1,geometryId:e,geometryLoadObject:{promise:Promise.resolve(t)},timeStamp:Date.now(),sizeInBytes:0};this._geometryCache.set(e,n);try{this._putGeometryCommon(e,t,n)}catch(t){throw this._geometryCache.delete(e),t}}setPartialImage(e,t){const n=this._imageCache.get(e);n?n.loaded?(n.loaded=!1,n.imageLoadObject=null,this.incrementImageCacheSize(-n.sizeInBytes),n.sizeInBytes=0,n.image=t||n.image):n.image=t||n.image:t&&this._imageCache.set(e,{image:t,imageId:e,loaded:!1,timeStamp:Date.now(),sizeInBytes:0})}getImageQuality(e){const t=this._imageCache.get(e)?.image;return t?t.imageQualityStatus||s.ImageQualityStatus.FULL_RESOLUTION:void 0}}},35637:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var r=n(74876),i=n(71851),o=n(10364),a=n(51159),s=n(22191),l=n(17791),c=n(30169),u=n(91979),d=n(69372),p=n(86252),f=n(36822),h=n(26896),m=n(80068);const g=i.RequestType.Prefetch;class v extends p.A{constructor(e,t){super(e),this.framesLoaded=0,this.framesProcessed=0,this.framesUpdated=0,this.autoRenderOnLoad=!0,this.cachedFrames=[],this.reRenderTarget=0,this.reRenderFraction=2,this.imagesLoader=this,this.cancelLoading=()=>{const{loadStatus:e}=this;if(!e||!e.loading)return;e.loading=!1,e.cancelled=!0,this.clearLoadCallbacks();a.A.filterRequests((({additionalDetails:e})=>e.volumeId!==this.volumeId))},this.loadStatus=t.loadStatus}invalidateVolume(e){const{vtkOpenGLTexture:t}=this,{numFrames:n}=this;for(let e=0;e<n;e++)t.setUpdatedFrame(e);this.modified(),e&&(0,u.A)(this.volumeId)}clearLoadCallbacks(){this.loadStatus.callbacks=[]}callLoadStatusCallback(e){const{framesUpdated:t,framesProcessed:n,totalNumFrames:r}=e,{volumeId:a,reRenderFraction:s,loadStatus:l,metadata:c}=this,{FrameOfReferenceUID:p}=c;if(this.autoRenderOnLoad&&(t>this.reRenderTarget||n===r)&&(this.reRenderTarget+=s,(0,u.A)(a)),n===r){l.callbacks.forEach((t=>t(e)));const t={FrameOfReferenceUID:p,volumeId:a};(0,d.A)(o.A,i.Events.IMAGE_VOLUME_LOADING_COMPLETED,t)}}updateTextureAndTriggerEvents(e,t,n=i.ImageQualityStatus.FULL_RESOLUTION){const r=this.imageIdIndexToFrameIndex(e),{cachedFrames:a,numFrames:s,totalNumFrames:l}=this,{FrameOfReferenceUID:c}=this.metadata;if(a[r]>n)return;if(a[r]===i.ImageQualityStatus.FULL_RESOLUTION)return;const u=n===i.ImageQualityStatus.FULL_RESOLUTION;a[e]=n,this.framesUpdated++,u&&(this.framesLoaded++,this.framesProcessed++);const p={FrameOfReferenceUID:c,volumeId:this.volumeId,numberOfFrames:s,framesProcessed:this.framesProcessed};(0,d.A)(o.A,i.Events.IMAGE_VOLUME_MODIFIED,p),u&&this.framesProcessed===this.totalNumFrames&&(this.loadStatus.loaded=!0,this.loadStatus.loading=!1),this.callLoadStatusCallback({success:!0,imageIdIndex:e,imageId:t,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,framesUpdated:this.framesUpdated,numFrames:s,totalNumFrames:l,complete:u,imageQualityStatus:n}),this.vtkOpenGLTexture.setUpdatedFrame(r),this.loadStatus.loaded&&(this.loadStatus.callbacks=[])}successCallback(e,t){const n=this.getImageIdIndex(e),{imageQualityStatus:r}=t;this.loadStatus.cancelled?console.warn("volume load cancelled, returning for imageIdIndex: ",n):(this.updateTextureAndTriggerEvents(n,e,r),this.isDynamicVolume()&&this.checkDimensionGroupCompletion(n))}errorCallback(e,t,n){if(!t)return;const{totalNumFrames:r,numFrames:a}=this,s=this.getImageIdIndex(e);this.framesProcessed++,this.framesProcessed===r&&(this.loadStatus.loaded=!0,this.loadStatus.loading=!1),this.callLoadStatusCallback({success:!1,imageId:e,imageIdIndex:s,error:n,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,framesUpdated:this.framesUpdated,numFrames:a,totalNumFrames:r}),this.loadStatus.loaded&&(this.loadStatus.callbacks=[]);const l={error:n,imageIdIndex:s,imageId:e};(0,d.A)(o.A,i.Events.IMAGE_LOAD_ERROR,l)}load(e){const{imageIds:t,loadStatus:n,numFrames:i}=this,{transferSyntaxUID:o}=r.get("transferSyntax",t[0])||{},a=r.get(l.A.IMAGE_RETRIEVE_CONFIGURATION,this.volumeId,o,"volume");if(this.imagesLoader=this.isDynamicVolume()?this:a?(a.create||f.Ay.createProgressive)(a):this,!0===n.loading)return;const{loaded:s}=this.loadStatus,c=t.length;s?e&&e({success:!0,framesLoaded:c,framesProcessed:c,numFrames:i,totalNumFrames:c}):(e&&this.loadStatus.callbacks.push(e),this._prefetchImageIds())}getLoaderImageOptions(e){const{transferSyntaxUID:t}=r.get("transferSyntax",e)||{},n=r.get("imagePlaneModule",e)||{},{rows:i,columns:o}=n,a=this.getImageIdIndex(e),s=r.get("modalityLutModule",e)||{},l=r.get("generalSeriesModule",e)||{},u={rescaleSlope:s.rescaleSlope,rescaleIntercept:s.rescaleIntercept,modality:l.modality};if("PT"===u.modality){const t=r.get("scalingModule",e);t&&(this._addScalingToVolume(t),u.suvbw=t.suvbw)}const d=(0,c.a)(u),p=(0,h.lk)();if(this.isPreScaled=!0,u&&void 0!==u.rescaleSlope&&void 0!==u.rescaleIntercept){const{rescaleSlope:e,rescaleIntercept:t}=u;this.isPreScaled="number"==typeof e&&"number"==typeof t}!p&&d&&(this.isPreScaled=!1);return{targetBuffer:{type:this.dataType,rows:i,columns:o},allowFloatRendering:p,preScale:{enabled:this.isPreScaled,scalingParameters:u},transferPixelData:!0,requestType:g,transferSyntaxUID:t,additionalDetails:{imageId:e,imageIdIndex:a,volumeId:this.volumeId}}}callLoadImage(e,t,n){const{cachedFrames:r}=this;if(r[t]===i.ImageQualityStatus.FULL_RESOLUTION)return;const a=n=>{const{image:r}=n.detail;r.imageId===e&&(this.vtkOpenGLTexture.setUpdatedFrame(t),o.A.removeEventListener(i.Events.IMAGE_CACHE_IMAGE_ADDED,a))};o.A.addEventListener(i.Events.IMAGE_CACHE_IMAGE_ADDED,a);return s.A.as((0,m.loadAndCacheImage)(e,n)).forEach((t=>{this.successCallback(e,t)}),this.errorCallback.bind(this,t,e))}getImageIdsRequests(e,t){this.totalNumFrames=this.imageIds.length;this.autoRenderOnLoad&&(this.reRenderFraction=.02*this.totalNumFrames,this.reRenderTarget=this.reRenderFraction);return e.map((e=>{const n=this.getImageIdIndex(e),r=g,i=t,o=this.getLoaderImageOptions(e);return{callLoadImage:this.callLoadImage.bind(this),imageId:e,imageIdIndex:n,options:o,priority:i,requestType:r,additionalDetails:{volumeId:this.volumeId}}}))}getImageLoadRequests(e){throw new Error("Abstract method")}getImageIdsToLoad(){throw new Error("Abstract method")}loadImages(){this.loadStatus.loading=!0;return this.getImageLoadRequests(5).reverse().forEach((e=>{if(!e)return;const{callLoadImage:t,imageId:n,imageIdIndex:r,options:i,priority:o,requestType:s,additionalDetails:l}=e;a.A.addRequest(t.bind(this,n,r,i),s,l,o)})),Promise.resolve(!0)}_prefetchImageIds(){this.loadStatus.loading=!0;const e=[...this.getImageIdsToLoad()];this.totalNumFrames=this.imageIds.length;return this.autoRenderOnLoad&&(this.reRenderFraction=.02*this.totalNumFrames,this.reRenderTarget=this.reRenderFraction),this.imagesLoader.loadImages(e,this).catch((e=>{console.debug("progressive loading failed to complete",e)}))}_addScalingToVolume(e){if(this.scaling)return;const{suvbw:t,suvlbm:n,suvbsa:r}=e,i={};n&&(i.suvbwToSuvlbm=n/t),r&&(i.suvbwToSuvbsa=r/t),t&&(i.suvbw=t),this.scaling={PT:i}}checkDimensionGroupCompletion(e){}}},86252:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,Q:()=>l});var r=n(58498),i=n(39537),o=n(24623),a=n(42295),s=n(49038);class l{constructor(e){this._imageIdsIndexMap=new Map,this._imageURIsIndexMap=new Map,this.cornerstoneImageMetaData=null,this.isPreScaled=!1,this.numTimePoints=null,this.numFrames=null;const{imageIds:t,scaling:n,dimensions:i,spacing:s,origin:l,direction:c,dataType:u,volumeId:d,referencedVolumeId:p,metadata:f,referencedImageIds:h,additionalDetails:m,voxelManager:g,numberOfComponents:v}=e;if(!u)throw new Error('Data type is required, please provide a data type as string such as "Uint8Array", "Float32Array", etc.');let{imageData:y}=e;this.imageIds=t,this.volumeId=d,this.metadata=f,this.dimensions=i,this.spacing=s,this.origin=l,this.direction=c,this.dataType=u,this.vtkOpenGLTexture=a.uT.newInstance(),this.vtkOpenGLTexture.setVolumeId(d),this.voxelManager=g??o.A.createImageVolumeVoxelManager({dimensions:i,imageIds:t,numberOfComponents:v}),this.numVoxels=this.dimensions[0]*this.dimensions[1]*this.dimensions[2],y||(y=r.Ay.newInstance(),y.setDimensions(i),y.setSpacing(s),y.setDirection(c),y.setOrigin(l)),y.set({dataType:u,voxelManager:this.voxelManager,id:d,numberOfComponents:v||1}),y.set({hasScalarVolume:!1}),this.imageData=y,this.numFrames=this._getNumFrames(),this._reprocessImageIds(),n&&(this.scaling=n),p&&(this.referencedVolumeId=p),h&&(this.referencedImageIds=h),m&&(this.additionalDetails=m)}get sizeInBytes(){return this.voxelManager.sizeInBytes}get imageIds(){return this._imageIds}set imageIds(e){this._imageIds=e,this._reprocessImageIds()}_reprocessImageIds(){this._imageIdsIndexMap.clear(),this._imageURIsIndexMap.clear(),this._imageIds.forEach(((e,t)=>{const n=(0,i.A)(e);this._imageIdsIndexMap.set(e,t),this._imageURIsIndexMap.set(n,t)}))}isDynamicVolume(){return this.numTimePoints>1}getImageIdIndex(e){return this._imageIdsIndexMap.get(e)}getImageIdByIndex(e){return this._imageIds[e]}getImageURIIndex(e){return this._imageURIsIndexMap.get(e)}load(e){}destroy(){this.imageData.delete(),this.imageData=null,this.voxelManager.clear(),this.vtkOpenGLTexture.releaseGraphicsResources(),this.vtkOpenGLTexture.delete()}invalidate(){for(let e=0;e<this.imageIds.length;e++)this.vtkOpenGLTexture.setUpdatedFrame(e);this.imageData.modified()}modified(){this.imageData.modified(),this.vtkOpenGLTexture.modified(),this.numFrames=this._getNumFrames()}removeFromCache(){s.Ay.removeVolumeLoadObject(this.volumeId)}getScalarDataLength(){return this.voxelManager.getScalarDataLength()}_getNumFrames(){return this.isDynamicVolume()?this.numTimePoints:this.imageIds.length}imageIdIndexToFrameIndex(e){return e%this.numFrames}getCornerstoneImages(){const{imageIds:e}=this;return e.map((e=>s.Ay.getImage(e)))}}const c=l},29625:(e,t,n)=>{"use strict";n.d(t,{e:()=>$});var r=n(7019),i=n(82409),o=n(56413),a=n(8906),s=n(28906),l=n(42008),c=n(87275);n(67313);const u={ASCII:"ascii",BINARY_BIG_ENDIAN:"binary_big_endian",BINARY_LITTLE_ENDIAN:"binary_little_endian"},d={diffuse_red:"red",diffuse_green:"green",diffuse_blue:"blue"},p={patternHeader:/ply([\s\S]*)end_header\r?\n/,patternBody:/end_header\s([\s\S]*)$/};function f(e){let t="",n=0;const r=p.patternHeader.exec(e);null!==r&&(t=r[1],n=r[0].length);const i={comments:[],elements:[],headerLength:n},o=t.split("\n");let a,s,l;for(let e=0;e<o.length;e++){let t=o[e];if(t=t.trim(),""!==t){let e;switch(l=t.split(/\s+/),s=l.shift(),t=l.join(" "),s){case"format":i.format=l[0],i.version=l[1];break;case"comment":i.comments.push(t);break;case"element":void 0!==a&&i.elements.push(a),a={},a.name=l[0],a.count=parseInt(l[1],10),a.properties=[];break;case"property":e={type:l[0]},"list"===e.type?(e.name=l[3],e.countType=l[1],e.itemType=l[2]):e.name=l[1],e.name in d&&(e.name=d[e.name]),a.properties.push(e);break;case"obj_info":i.objInfo=t;break;default:console.warn("unhandled",s,l)}}}return void 0!==a&&i.elements.push(a),i}function h(e,t){const n=t.find((e=>"vertex"===e.name)),r=t.find((e=>"face"===e.name));let i=0,o=0;n&&(i=n.count),r&&(o=r.count);const a=new Float32Array(3*i),s=new Uint8Array(3*i),u=new Float32Array(2*i),d=new Float32Array(3*i),p=e.colors.length>0,f=e.uvs.length>0,h=e.normals.length>0,m=e.faceVertexUvs.length>0;for(let t=0;t<i;t++){let n=3*t+0,r=3*t+1;const i=3*t+2;a[n]=e.vertices[n],a[r]=e.vertices[r],a[i]=e.vertices[i],p&&(s[n]=e.colors[n],s[r]=e.colors[r],s[i]=e.colors[i]),f&&(n=2*t+0,r=2*t+1,u[n]=e.uvs[n],u[r]=e.uvs[r]),h&&(d[n]=e.normals[n],d[r]=e.normals[r],d[i]=e.normals[i])}if(!f&&m){let t=0,n=0;for(let r=0;r<o;++r){const r=e.indices[t++],i=e.faceVertexUvs[n++];if(i&&2*r===i.length)for(let n=0;n<r;++n){const r=e.indices[t++];u[2*r+0]=i[2*n+0],u[2*r+1]=i[2*n+1]}else t+=r}}const g=c.Ay.newInstance();if(g.getPoints().setData(a,3),p&&g.getPointData().setScalars(l.Ay.newInstance({numberOfComponents:3,values:s,name:"Scalars"})),f||m){const e=l.Ay.newInstance({numberOfComponents:2,values:u,name:"TextureCoordinates"}),t=g.getPointData();t.addArray(e),t.setActiveTCoords(e.getName())}return h&&g.getPointData().setNormals(l.Ay.newInstance({numberOfComponents:3,name:"Normals",values:d})),g.getPolys().setData(Uint32Array.from(e.indices)),g}function m(e,t){let n;switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":n=parseInt(e,10);break;case"float":case"double":case"float32":case"float64":n=parseFloat(e);break;default:console.log("Unsupported type")}return n}function g(e,t){const n=t.split(/\s+/),r={};for(let t=0;t<e.length;t++)if("list"===e[t].type){const i=[],o=m(n.shift(),e[t].countType);for(let r=0;r<o;r++)i.push(m(n.shift(),e[t].itemType));r[e[t].name]=i}else r[e[t].name]=m(n.shift(),e[t].type);return r}function v(e,t,n){if("vertex"===t)e.vertices.push(n.x,n.y,n.z),"nx"in n&&"ny"in n&&"nz"in n&&e.normals.push(n.nx,n.ny,n.nz),"s"in n&&"t"in n?e.uvs.push(n.s,n.t):"u"in n&&"v"in n?e.uvs.push(n.u,n.v):"texture_u"in n&&"texture_v"in n&&e.uvs.push(n.texture_u,n.texture_v),"red"in n&&"green"in n&&"blue"in n&&e.colors.push(n.red,n.green,n.blue);else if("face"===t){const t=n.vertex_indices||n.vertex_index,r=n.texcoord;t&&t.length>0&&(e.indices.push(t.length),t.forEach(((t,n)=>{e.indices.push(t)}))),e.faceVertexUvs.push(r)}}function y(e,t,n,r){let i;switch(n){case"int8":case"char":i=[e.getInt8(t),1];break;case"uint8":case"uchar":i=[e.getUint8(t),1];break;case"int16":case"short":i=[e.getInt16(t,r),2];break;case"uint16":case"ushort":i=[e.getUint16(t,r),2];break;case"int32":case"int":i=[e.getInt32(t,r),4];break;case"uint32":case"uint":i=[e.getUint32(t,r),4];break;case"float32":case"float":i=[e.getFloat32(t,r),4];break;case"float64":case"double":i=[e.getFloat64(t,r),8];break;default:console.log("Unsupported type")}return i}function b(e,t,n,r){const i={};let o,a=0;for(let s=0;s<n.length;s++)if("list"===n[s].type){const l=[];o=y(e,t+a,n[s].countType,r);const c=o[0];a+=o[1];for(let i=0;i<c;i++)o=y(e,t+a,n[s].itemType,r),l.push(o[0]),a+=o[1];i[n[s].name]=l}else o=y(e,t+a,n[s].type,r),i[n[s].name]=o[0],a+=o[1];return[i,a]}function x(e,t){t.classHierarchy.push("vtkPLYReader"),t.dataAccessHelper||(t.dataAccessHelper=a.Ay.get("http")),e.setUrl=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{binary:!0};t.url=n;const i=n.split("/");return i.pop(),t.baseURL=i.join("/"),t.compression=r.compression,e.loadData({progressCallback:r.progressCallback,binary:!!r.binary})},e.loadData=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{compression:i,progressCallback:o}=t;return r.binary?t.dataAccessHelper.fetchBinary(n,{compression:i,progressCallback:o}):t.dataAccessHelper.fetchText(e,n,{compression:i,progressCallback:o})}(t.url,n);return r.then(e.parse),r},e.parse=t=>{"string"==typeof t?e.parseAsText(t):e.parseAsArrayBuffer(t)},e.parseAsArrayBuffer=n=>{if(!n)return;if(n===t.parseData)return;e.modified();const r=f(o.A.arrayBufferToString(n));if(!(r.format!==u.ASCII))return void e.parseAsText(n);t.parseData=n;const i={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},a=r.format===u.BINARY_LITTLE_ENDIAN,s=n instanceof ArrayBuffer?n:n.buffer,l=new DataView(s,r.headerLength);let c,d=0;for(let e=0;e<r.elements.length;e++)for(let t=0;t<r.elements[e].count;t++){c=b(l,d,r.elements[e].properties,a),d+=c[1];const t=c[0];v(i,r.elements[e].name,t)}const p=h(i,r.elements);t.output[0]=p},e.parseAsText=n=>{if(!n)return;if(n===t.parseData)return;e.modified(),t.parseData=n;const r=o.A.arrayBufferToString(n),i=f(r);if(i.format!==u.ASCII)return void e.parseAsArrayBuffer(n);const a={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},s=p.patternBody.exec(r);let l="";null!==s&&(l=s[1]);const c=l.split("\n");let d=0,m=0;for(let e=0;e<c.length;e++){let t=c[e];if(t=t.trim(),""!==t){m>=i.elements[d].count&&(d++,m=0);const e=g(i.elements[d].properties,t);v(a,i.elements[d].name,e),m++}}const y=h(a,i.elements);t.output[0]=y},e.requestData=(n,r)=>{e.parse(t.parseData)}}const A={};function C(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,A,n),s.m.obj(e,t),s.m.get(e,t,["url","baseURL"]),s.m.setGet(e,t,["dataAccessHelper"]),s.m.algo(e,t,0,1),x(e,t),t.compression||(t.compression=null),t.progressCallback||(t.progressCallback=null)}var T={extend:C,newInstance:s.m.newInstance(C,"vtkPLYReader")},S=n(89265);const{vtkErrorMacro:w}=s.m;function _(e,t){for(let n=0;n<e.length;n++)t.push(e[n])}function I(e,t,n,r,i){const o=e[t];if(void 0===o)return-1;if(-1!==o.indexOf("endfacet"))return t+1;if(-1===o.indexOf("facet"))return t+1;let a=0,s=2;const l=n.length/3;for(_(o.split(/[ \t]+/).filter((e=>e)).slice(-3).map(Number),i);-1!==e[t+s].indexOf("vertex");){_(e[t+s].split(/[ \t]+/).filter((e=>e)).slice(-3).map(Number),n),a++,s++}r.push(a);for(let e=0;e<a;e++)r.push(l+e);for(;e[t+s]&&-1!==e[t+s].indexOf("endfacet");)s++;return t+s+2}function E(e,t){function n(n){const r=t.output[0],i=r.getPoints().getData(),o=r.getPolys().getData();if(!i||!o)return void console.warn("No valid polydata.");const a=new Map,s=new Map;let l=0,c=!1;for(let e=0;e<i.length;e+=3){const t=`${(i[e]*10**n).toFixed(0)},${(i[e+1]*10**n).toFixed(0)},${(i[e+2]*10**n).toFixed(0)}`;void 0!==a.get(t)?(s.set(e/3,a.get(t)),c=!0):(s.set(e/3,l),a.set(t,l),l++)}const u=new Float32Array(3*a.size),d=Array.from(a.keys());for(let e=0;e<d.length;e++){const t=d[e],r=3*a.get(t),i=t.split(",").map((e=>+e*10**-n));u[r]=i[0],u[r+1]=i[1],u[r+2]=i[2]}const p=new Int32Array(o);for(let e=0;e<o.length;e+=4)p[e]=3,p[e+1]=s.get(o[e+1]),p[e+2]=s.get(o[e+2]),p[e+3]=s.get(o[e+3]);r.getPoints().setData(u),r.getPolys().setData(p),c&&e.modified()}t.classHierarchy.push("vtkSTLReader"),t.dataAccessHelper||(t.dataAccessHelper=a.Ay.get("http")),e.setUrl=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{binary:!0};t.url=n;const i=n.split("/");return i.pop(),t.baseURL=i.join("/"),e.loadData(r)},e.loadData=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=void 0!==r.compression?r.compression:t.compression,o=void 0!==r.progressCallback?r.progressCallback:t.progressCallback;return r.binary?t.dataAccessHelper.fetchBinary(n,{compression:i,progressCallback:o}):t.dataAccessHelper.fetchText(e,n,{compression:i,progressCallback:o})}(t.url,n);return r.then(e.parse),r},e.parse=t=>{"string"==typeof t?e.parseAsText(t):e.parseAsArrayBuffer(t)},e.parseAsArrayBuffer=r=>{if(!r)return;if(r===t.parseData)return;e.modified(),t.parseData=r;let i=!1;if(i=84+50*new DataView(r,0,84).getUint32(80,!0)===r.byteLength,!i)return void e.parseAsText(o.A.arrayBufferToString(r));const a=r.slice(0,80),s=function(e){const t=e.split(" ").filter((e=>e.indexOf("=")>-1)),n={};for(let e=0;e<t.length;++e){const r=t[e].split("=");2===r.length&&(n[r[0]]=r[1])}return n}(o.A.arrayBufferToString(a)),u=new DataView(r,84),d=(r.byteLength-84)/50,p=new Float32Array(9*d),f=new Float32Array(3*d),h=new Uint32Array(4*d),m=new Uint16Array(d);let g=0;for(let e=0;e<d;e++){const t=50*e;f[3*e+0]=u.getFloat32(t+0,!0),f[3*e+1]=u.getFloat32(t+4,!0),f[3*e+2]=u.getFloat32(t+8,!0),p[9*e+0]=u.getFloat32(t+12,!0),p[9*e+1]=u.getFloat32(t+16,!0),p[9*e+2]=u.getFloat32(t+20,!0),p[9*e+3]=u.getFloat32(t+24,!0),p[9*e+4]=u.getFloat32(t+28,!0),p[9*e+5]=u.getFloat32(t+32,!0),p[9*e+6]=u.getFloat32(t+36,!0),p[9*e+7]=u.getFloat32(t+40,!0),p[9*e+8]=u.getFloat32(t+44,!0),h[g++]=3,h[g++]=3*e+0,h[g++]=3*e+1,h[g++]=3*e+2,m[e]=u.getUint16(t+48,!0)}const v="SPACE";if(v in s&&"LPS"!==s[v]){const e=s[v],t=new Float32Array(16);switch(t[15]=1,e[0]){case"L":t[0]=1;break;case"R":t[0]=-1;break;default:return void w(`Can not convert STL file from ${e} to LPS space: permutations not supported. Use itk.js STL reader instead.`)}switch(e[1]){case"P":t[5]=1;break;case"A":t[5]=-1;break;default:return void w(`Can not convert STL file from ${e} to LPS space: permutations not supported. Use itk.js STL reader instead.`)}switch(e[2]){case"S":t[10]=1;break;case"I":t[10]=-1;break;default:return void w(`Can not convert STL file from ${e} to LPS space: permutations not supported. Use itk.js STL reader instead.`)}S.A.buildFromDegree().setMatrix(t).apply(p).apply(f)}const y=c.Ay.newInstance();y.getPoints().setData(p,3),y.getPolys().setData(h),y.getCellData().setScalars(l.Ay.newInstance({name:"Attribute",values:m})),y.getCellData().setNormals(l.Ay.newInstance({name:"Normals",values:f,numberOfComponents:3})),t.output[0]=y,t.removeDuplicateVertices>=0&&n(t.removeDuplicateVertices)},e.parseAsText=r=>{if(!r)return;if(r===t.parseData)return;e.modified(),t.parseData=r;const i=r.split("\n");let o=1;const a=[],s=[],u=[];for(;-1!==o;)o=I(i,o,a,s,u);const d=c.Ay.newInstance();d.getPoints().setData(Float32Array.from(a),3),d.getPolys().setData(Uint32Array.from(s)),d.getCellData().setNormals(l.Ay.newInstance({name:"Normals",values:Float32Array.from(u),numberOfComponents:3})),t.output[0]=d,t.removeDuplicateVertices>=0&&n(t.removeDuplicateVertices)},e.requestData=(n,r)=>{e.parse(t.parseData)}}const D={removeDuplicateVertices:-1};function O(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,D,n),s.m.obj(e,t),s.m.get(e,t,["url","baseURL"]),s.m.setGet(e,t,["dataAccessHelper","removeDuplicateVertices"]),s.m.algo(e,t,0,1),E(e,t),t.compression||(t.compression=null),t.progressCallback||(t.progressCallback=null)}var P={extend:O,newInstance:s.m.newInstance(O,"vtkSTLReader")},R=n(94199);const N={};function M(e,t,n,r,i){for(let o=0;o<i;o++)n[r+o]=e[t+o]}function L(e){const t=e.split("/").map((e=>Number(e)));let n=t[0]-1;n=n<0?n+1+N.v.length/3:n;let r=t[1]?t[1]-1:n;r=r<0?r+1+N.vt.length/2:r;let i=t[2]?t[2]-1:n;return i=i<0?i+1+N.vn.length/3:i,[n,r,i]}function F(e){if("#"===e[0])return;const t=e.split(/[ \t]+/);if(t[0]===N.splitOn)t.shift(),N.pieces.push(t.join(" ").trim()),N.f.push([]),N.size++;else if("v"===t[0])N.v.push(Number(t[1])),N.v.push(Number(t[2])),N.v.push(Number(t[3]));else if("vt"===t[0])N.vt.push(Number(t[1])),N.vt.push(Number(t[2]));else if("vn"===t[0])N.vn.push(Number(t[1])),N.vn.push(Number(t[2])),N.vn.push(Number(t[3]));else if("f"===t[0]){0===N.size&&N.size++;const e=N.f[N.size-1];t.shift();const n=t.filter((e=>e.length>0&&"\r"!==e)),r=n.length;e.push(r);for(let t=0;t<r;t++)e.push(L(n[t]))}}const B={getPointDuplicateIds:function(e,t){const n=[],r=e.getPointData().getArrayByName("Duplicates");if(null==r)return n;const i=r.getData(),o=Math.min(t,i[t]);n.push(o);let a=i[o];if(a!==o)for(;a<i.length&&i[a]===o;)n.push(a++);return n}};function V(e,t){t.classHierarchy.push("vtkOBJReader"),t.dataAccessHelper||(t.dataAccessHelper=a.Ay.get("http")),e.setUrl=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(-1!==n.indexOf(".obj")||r.fullpath){t.url=n;const e=n.split("/");e.pop(),t.baseURL=e.join("/")}else t.baseURL=n,t.url=`${n}/index.obj`;return e.loadData(r)},e.loadData=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.dataAccessHelper.fetchText(e,n,r)}(t.url,n).then((t=>!e.isDeleted()&&e.parseAsText(t)))},e.parseAsText=n=>{return!n||(n!==t.parseData&&e.modified(),t.parseData=n,t.numberOfOutputs=0,r=t.splitMode,N.splitOn=r,N.pieces=[],N.v=[],N.vt=[],N.vn=[],N.f=[[]],N.size=0,n.split("\n").forEach(F),function(e){const t=!!N.vt.length,n=!!N.vn.length;if(e.splitMode){e.numberOfOutputs=N.size;for(let r=0;r<N.size;r++){const i=N.f[r],o=i.length,a=N.v.length/3,s={};let u;if(e.trackDuplicates){const e=[];let t=0;for(let n=0;n<o;){const r=i[n++];for(let o=0;o<r;o++){const[r,o,a]=i[n++],l=`${r}/${o}/${a}`;void 0===s[l]&&(void 0===e[r]?e[r]=[l]:(e[r].push(l),++t),s[l]=r)}}u=new Uint16Array(a+t);let n=0;for(let t=0;t<e.length;++t){const r=e[t]?e[t].length:0;u[t]=r>1?a+n:t;for(let i=1;i<r;++i){const r=a+n++;u[r]=t,s[e[t][i]]=r}}}const d={},p=c.Ay.newInstance({name:N.pieces[r]}),f=[],h=[],m=[],g=[];let v=0;for(;v<o;){const r=i[v];g.push(r);for(let o=0;o<r;o++){const[r,a,l]=i[v+o+1],c=`${r}/${a}/${l}`;if(void 0===d[c]){const i=e.trackDuplicates?s[c]:f.length/3;d[c]=i,M(N.v,3*r,f,3*i,3),t&&M(N.vt,2*a,h,2*i,2),n&&M(N.vn,3*l,m,3*i,3)}g.push(d[c])}v+=r+1}if(p.getPoints().setData(Float32Array.from(f),3),e.trackDuplicates){const e=l.Ay.newInstance({name:"Duplicates",values:u});p.getPointData().addArray(e)}if(p.getPolys().setData(Uint32Array.from(g)),t){const e=l.Ay.newInstance({numberOfComponents:2,values:Float32Array.from(h),name:"TextureCoordinates"});p.getPointData().setTCoords(e)}if(n){const e=l.Ay.newInstance({numberOfComponents:3,values:Float32Array.from(m),name:"Normals"});p.getPointData().setNormals(e)}e.output[r]=p}}else{e.numberOfOutputs=1;const r=c.Ay.newInstance();if(r.getPoints().setData(Float32Array.from(N.v),3),t&&N.v.length/3==N.vt.length/2){const e=l.Ay.newInstance({numberOfComponents:2,values:Float32Array.from(N.vt),name:"TextureCoordinates"});r.getPointData().setTCoords(e)}if(n&&N.v.length===N.vn.length){const e=l.Ay.newInstance({numberOfComponents:3,values:Float32Array.from(N.vn),name:"Normals"});r.getPointData().setNormals(e)}const i=[],o=N.f[0],a=o.length;let s=0;for(;s<a;){const e=o[s];i.push(e);for(let t=0;t<e;t++){const[e]=o[s+t+1];i.push(e)}s+=e+1}r.getPolys().setData(Uint32Array.from(i)),e.output[0]=r}}(t),!0);var r},e.requestData=(n,r)=>{e.parseAsText(t.parseData)},e.isBusy=()=>!!t.requestCount,e.getNumberOfOutputPorts=()=>t.numberOfOutputs}const k={numberOfOutputs:1,requestCount:0,splitMode:null,trackDuplicates:!1};function U(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,k,n),s.m.obj(e,t),s.m.get(e,t,["url","baseURL"]),s.m.setGet(e,t,["dataAccessHelper","splitMode","trackDuplicates"]),s.m.algo(e,t,0,1),s.m.event(e,t,"busy"),V(e,t)}var G={newInstance:s.m.newInstance(U,"vtkOBJReader"),extend:U,...B},z=n(89585),W=n(16632),j=n(96703);function H(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,function(e){return{computeCellNormals:!1,computePointNormals:!0,...e}}(n)),s.m.obj(e,t),s.m.algo(e,t,1,1),s.m.setGet(e,t,["computeCellNormals","computePointNormals"]),function(e,t){t.classHierarchy.push("vtkPolyDataNormals"),e.vtkPolyDataNormalsExecute=(e,n,r)=>{if(!r)return null;const i=new Float32Array(r.length),o=new Float32Array(3*e);let a=0,s=0;const l=n.length,c=[0,0,0],u=[0,0,0];for(let e=0;e<l;e+=s+1)if(s=n[e],!(s<3)){for(let t=1;t<=3;++t)c[t-1]=3*n[e+t];if(j.Ay.computeNormal(r.slice(c[0],c[0]+3),r.slice(c[1],c[1]+3),r.slice(c[2],c[2]+3),u),o[a++]=u[0],o[a++]=u[1],o[a++]=u[2],t.computePointNormals)for(let t=1;t<=s;++t){let r=3*n[e+t];i[r]+=u[0],i[++r]+=u[1],i[++r]+=u[2]}}if(t.computePointNormals){const e=[0,0,0];for(let t=0;t<r.length;)e[0]=i[t],e[1]=i[t+1],e[2]=i[t+2],W.f.normalize(e),i[t++]=e[0],i[t++]=e[1],i[t++]=e[2]}return[o,i]},e.requestData=(n,r)=>{if(!e.getNumberOfInputPorts())return;const i=n[0];if(!i)return;const o=c.Ay.newInstance();o.setPoints(i.getPoints()),o.setVerts(i.getVerts()),o.setLines(i.getLines()),o.setPolys(i.getPolys()),o.setStrips(i.getStrips()),o.getPointData().passData(i.getPointData()),o.getCellData().passData(i.getCellData()),o.getFieldData().passData(i.getFieldData());const[a,s]=e.vtkPolyDataNormalsExecute(i.getNumberOfPolys(),i.getPolys().getData(),i.getPoints().getData());if(t.computePointNormals){const e=l.Ay.newInstance({numberOfComponents:3,name:"Normals",values:s});o.getPointData().setNormals(e)}if(t.computeCellNormals){const e=l.Ay.newInstance({numberOfComponents:3,name:"Normals",values:a});o.getCellData().setNormals(e)}r[0]=o}}(e,t)}var K={newInstance:s.m.newInstance(H,"vtkPolyDataNormals"),extend:H},q=n(71851);class ${constructor(e){this._color=[255,255,255],this._actors=[],this.id=e.id,this._color=e.color??this._color,this._format=e.format;const t=new TextDecoder,n=K.newInstance(),o=e=>{const t=r.Ay.newInstance();t.setMapper(e);const n=z.Ay.newInstance();return n.setColor(this._color[0]/255,this._color[1]/255,this._color[2]/255),t.setProperty(n),t};if(this._format===q.MeshType.PLY){const t=i.Ay.newInstance(),n=T.newInstance();n.parseAsArrayBuffer(e.arrayBuffer),t.setInputConnection(n.getOutputPort()),this._actors.push(o(t))}else if(this._format===q.MeshType.STL){const t=i.Ay.newInstance(),r=P.newInstance();r.parseAsArrayBuffer(e.arrayBuffer),n.setInputConnection(r.getOutputPort()),t.setInputConnection(n.getOutputPort()),this._actors.push(o(t))}else if(this._format===q.MeshType.OBJ){const n=G.newInstance({splitMode:e.materialUrl?"usemtl":null});n.parseAsText(t.decode(e.arrayBuffer));const r=n.getNumberOfOutputPorts();for(let e=0;e<r;e++){const t=n.getOutputData(e),r=i.Ay.newInstance();r.setInputData(t),this._actors.push(o(r))}}else if(this._format===q.MeshType.VTP){const t=i.Ay.newInstance(),n=R.Ay.newInstance();n.parseAsArrayBuffer(e.arrayBuffer),t.setInputConnection(n.getOutputPort()),this._actors.push(o(t))}this.sizeInBytes=this._getSizeInBytes()}_getSizeInBytes(){let e=0;for(let t=0;t<this._actors.length;t++){const n=this._actors[t].getMapper().getInputData(),r=n.getPoints(),i=n.getPolys();e+=4*r.getData().length+4*i.getData().length}return e}get defaultActor(){return this._actors[0]}get actors(){return this._actors}get color(){return this._color}get format(){return this._format}}},1271:(e,t,n)=>{"use strict";n(71851),n(10364),n(10297);var r=n(35637);r.A},50180:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(35637);class i extends r.A{constructor(e,t){e.imageIds||(e.imageIds=t.imageIds),super(e,t),this.getImageIdsToLoad=()=>{const{imageIds:e}=this;return this.numFrames=e.length,e}}getScalarData(){return this.voxelManager.getScalarData()}getImageLoadRequests(e){const{imageIds:t}=this;return this.getImageIdsRequests(t,e)}}},90808:(e,t,n)=>{"use strict"},21093:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}}},19325:(e,t,n)=>{"use strict";n.d(t,{EPSILON:()=>o,MPR_CAMERA_VALUES:()=>s,RENDERING_DEFAULTS:()=>i,VIEWPORT_PRESETS:()=>l});n(21093);const r={MINIMUM_SLAB_THICKNESS:.05,MAXIMUM_RAY_DISTANCE:1e6};Object.freeze(r);const i=r,o=.001;const a=function e(t){const n=Object.getOwnPropertyNames(t);for(const r of n){const n=t[r];n&&"object"==typeof n&&e(n)}return Object.freeze(t)},s=a({axial:{viewPlaneNormal:[0,0,-1],viewUp:[0,-1,0],viewRight:[1,0,0]},sagittal:{viewPlaneNormal:[1,0,0],viewUp:[0,0,1],viewRight:[0,1,0]},coronal:{viewPlaneNormal:[0,-1,0],viewUp:[0,0,1],viewRight:[1,0,0]}}),l=[{name:"CT-AAA",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 143.556 0 166.222 0.686275 214.389 0.696078 419.736 0.833333 3071 0.803922",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 143.556 0.615686 0.356863 0.184314 166.222 0.882353 0.603922 0.290196 214.389 1 1 1 419.736 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-AAA2",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"16 -3024 0 129.542 0 145.244 0.166667 157.02 0.5 169.918 0.627451 395.575 0.8125 1578.73 0.8125 3071 0.8125",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"32 -3024 0 0 0 129.542 0.54902 0.25098 0.14902 145.244 0.6 0.627451 0.843137 157.02 0.890196 0.47451 0.6 169.918 0.992157 0.870588 0.392157 395.575 1 0.886275 0.658824 1578.73 1 0.829256 0.957922 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Bone",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0 -16.4458 0 641.385 0.715686 3071 0.705882",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 0 0 0 -16.4458 0.729412 0.254902 0.301961 641.385 0.905882 0.815686 0.552941 3071 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Bones",gradientOpacity:"4 0 1 985.12 1",specularPower:"1",scalarOpacity:"8 -1000 0 152.19 0 278.93 0.190476 952 0.2",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"20 -1000 0.3 0.3 1 -488 0.3 1 0.3 463.28 1 0 0 659.15 1 0.912535 0.0374849 953 1 0.3 0.3",diffuse:"1",interpolation:"1"},{name:"CT-Cardiac",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 -77.6875 0 94.9518 0.285714 179.052 0.553571 260.439 0.848214 3071 0.875",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 -77.6875 0.54902 0.25098 0.14902 94.9518 0.882353 0.603922 0.290196 179.052 1 0.937033 0.954531 260.439 0.615686 0 0 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cardiac2",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"12 -3024 0 42.8964 0 163.488 0.428571 277.642 0.776786 1587 0.754902 3071 0.754902",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"24 -3024 0 0 0 42.8964 0.54902 0.25098 0.14902 163.488 0.917647 0.639216 0.0588235 277.642 1 0.878431 0.623529 1587 1 1 1 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cardiac3",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"14 -3024 0 -86.9767 0 45.3791 0.169643 139.919 0.589286 347.907 0.607143 1224.16 0.607143 3071 0.616071",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"28 -3024 0 0 0 -86.9767 0 0.25098 1 45.3791 1 0 0 139.919 1 0.894893 0.894893 347.907 1 1 0.25098 1224.16 1 1 1 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Chest-Contrast-Enhanced",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"10 -3024 0 67.0106 0 251.105 0.446429 439.291 0.625 3071 0.616071",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"20 -3024 0 0 0 67.0106 0.54902 0.25098 0.14902 251.105 0.882353 0.603922 0.290196 439.291 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Chest-Vessels",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -3024 0 -1278.35 0 22.8277 0.428571 439.291 0.625 3071 0.616071",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"20 -3024 0 0 0 -1278.35 0.54902 0.25098 0.14902 22.8277 0.882353 0.603922 0.290196 439.291 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 -2048 0 136.47 0 159.215 0.258929 318.43 0.571429 478.693 0.776786 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"24 -2048 0 0 0 136.47 0 0 0 159.215 0.159804 0.159804 0.159804 318.43 0.764706 0.764706 0.764706 478.693 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries-2",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 142.677 0 145.016 0.116071 192.174 0.5625 217.24 0.776786 384.347 0.830357 3661 0.830357",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 142.677 0 0 0 145.016 0.615686 0 0.0156863 192.174 0.909804 0.454902 0 217.24 0.972549 0.807843 0.611765 384.347 0.909804 0.909804 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Coronary-Arteries-3",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"14 -2048 0 128.643 0 129.982 0.0982143 173.636 0.669643 255.884 0.857143 584.878 0.866071 3661 1",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"28 -2048 0 0 0 128.643 0 0 0 129.982 0.615686 0 0.0156863 173.636 0.909804 0.454902 0 255.884 0.886275 0.886275 0.886275 584.878 0.968627 0.968627 0.968627 3661 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Cropped-Volume-Bone",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -2048 0 -451 0 -450 1 1050 1 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"20 -2048 0 0 0 -451 0 0 0 -450 0.0556356 0.0556356 0.0556356 1050 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Fat",gradientOpacity:"6 0 1 985.12 1 988 1",specularPower:"1",scalarOpacity:"14 -1000 0 -100 0 -99 0.15 -60 0.15 -59 0 101.2 0 952 0",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"36 -1000 0.3 0.3 1 -497.5 0.3 1 0.3 -99 0 0 1 -76.946 0 1 0 -65.481 0.835431 0.888889 0.0165387 83.89 1 0 0 463.28 1 0 0 659.15 1 0.912535 0.0374849 2952 1 0.300267 0.299886",diffuse:"1",interpolation:"1"},{name:"CT-Liver-Vasculature",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 149.113 0 157.884 0.482143 339.96 0.660714 388.526 0.830357 1197.95 0.839286 3661 0.848214",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 149.113 0 0 0 157.884 0.501961 0.25098 0 339.96 0.695386 0.59603 0.36886 388.526 0.854902 0.85098 0.827451 1197.95 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Lung",gradientOpacity:"6 0 1 985.12 1 988 1",specularPower:"1",scalarOpacity:"12 -1000 0 -600 0 -599 0.15 -400 0.15 -399 0 2952 0",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 -1000 0.3 0.3 1 -600 0 0 1 -530 0.134704 0.781726 0.0724558 -460 0.929244 1 0.109473 -400 0.888889 0.254949 0.0240258 2952 1 0.3 0.3",diffuse:"1",interpolation:"1"},{name:"CT-MIP",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0 -637.62 0 700 1 3071 1",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 0 0 0 -637.62 1 1 1 700 1 1 1 3071 1 1 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Muscle",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"10 -3024 0 -155.407 0 217.641 0.676471 419.736 0.833333 3071 0.803922",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"20 -3024 0 0 0 -155.407 0.54902 0.25098 0.14902 217.641 0.882353 0.603922 0.290196 419.736 1 0.937033 0.954531 3071 0.827451 0.658824 1",diffuse:"0.9",interpolation:"1"},{name:"CT-Pulmonary-Arteries",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"14 -2048 0 -568.625 0 -364.081 0.0714286 -244.813 0.401786 18.2775 0.607143 447.798 0.830357 3592.73 0.839286",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"28 -2048 0 0 0 -568.625 0 0 0 -364.081 0.396078 0.301961 0.180392 -244.813 0.611765 0.352941 0.0705882 18.2775 0.843137 0.0156863 0.156863 447.798 0.752941 0.752941 0.752941 3592.73 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Soft-Tissue",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"10 -2048 0 -167.01 0 -160 1 240 1 3661 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"20 -2048 0 0 0 -167.01 0 0 0 -160 0.0556356 0.0556356 0.0556356 240 1 1 1 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"CT-Air",gradientOpacity:"4 0 1 255 1",specularPower:"10",scalarOpacity:"8 -3024 0.705882 -900.0 0.715686 -500.0 0 3071 0",specular:"0.2",shade:"1",ambient:"0.1",colorTransfer:"16 -3024 1 1 1 -900.0 0.2 1.0 1.0 -500.0 0.3 0.3 1.0 3071 0 0 0 ",diffuse:"0.9",interpolation:"1"},{name:"MR-Angio",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 -2048 0 151.354 0 158.279 0.4375 190.112 0.580357 200.873 0.732143 3661 0.741071",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 -2048 0 0 0 151.354 0 0 0 158.279 0.74902 0.376471 0 190.112 1 0.866667 0.733333 200.873 0.937255 0.937255 0.937255 3661 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-Default",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"12 0 0 20 0 40 0.15 120 0.3 220 0.375 1024 0.5",specular:"0",shade:"1",ambient:"0.2",colorTransfer:"24 0 0 0 0 20 0.168627 0 0 40 0.403922 0.145098 0.0784314 120 0.780392 0.607843 0.380392 220 0.847059 0.835294 0.788235 1024 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-MIP",gradientOpacity:"4 0 1 255 1",specularPower:"1",scalarOpacity:"8 0 0 98.3725 0 416.637 1 2800 1",specular:"0",shade:"0",ambient:"0.2",colorTransfer:"16 0 1 1 1 98.3725 1 1 1 416.637 1 1 1 2800 1 1 1",diffuse:"1",interpolation:"1"},{name:"MR-T2-Brain",gradientOpacity:"4 0 1 160.25 1",specularPower:"40",scalarOpacity:"10 0 0 36.05 0 218.302 0.171429 412.406 1 641 1",specular:"0.5",shade:"1",ambient:"0.3",colorTransfer:"16 0 0 0 0 98.7223 0.956863 0.839216 0.192157 412.406 0 0.592157 0.807843 641 1 1 1",diffuse:"0.6",interpolation:"1"},{name:"DTI-FA-Brain",gradientOpacity:"4 0 1 0.9950 1",specularPower:"40",scalarOpacity:"16 0 0 0 0 0.3501 0.0158 0.49379 0.7619 0.6419 1 0.9920 1 0.9950 0 0.9950 0",specular:"0.5",shade:"1",ambient:"0.3",colorTransfer:"28 0 1 0 0 0 1 0 0 0.24974 0.4941 1 0 0.49949 0 0.9882 1 0.7492 0.51764 0 1 0.9950 1 0 0 0.9950 1 0 0",diffuse:"0.9",interpolation:"1"}]},63591:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(67737);const{BlendMode:i}=r.Ay;var o;!function(e){e[e.COMPOSITE=i.COMPOSITE_BLEND]="COMPOSITE",e[e.MAXIMUM_INTENSITY_BLEND=i.MAXIMUM_INTENSITY_BLEND]="MAXIMUM_INTENSITY_BLEND",e[e.MINIMUM_INTENSITY_BLEND=i.MINIMUM_INTENSITY_BLEND]="MINIMUM_INTENSITY_BLEND",e[e.AVERAGE_INTENSITY_BLEND=i.AVERAGE_INTENSITY_BLEND]="AVERAGE_INTENSITY_BLEND",e[e.LABELMAP_EDGE_PROJECTION_BLEND=i.LABELMAP_EDGE_PROJECTION_BLEND]="LABELMAP_EDGE_PROJECTION_BLEND"}(o||(o={}));const a=o},38059:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.NOT_APPLICABLE="",e.ERMF="ERMF",e.USER="User",e.PROJECTION="Proj",e.REGION="Region",e.ERROR="Error",e.UNCALIBRATED="Uncalibrated",e.CALIBRATED="Calibrated",e.UNKNOWN="Unknown"}(r||(r={}));const i=r},86066:()=>{"use strict";var e;!function(e){e.CLOSED_PLANAR="CLOSED_PLANAR",e.OPEN_PLANAR="OPEN_PLANAR"}(e||(e={}))},91369:()=>{"use strict";var e;!function(e){e.SUM="SUM",e.AVERAGE="AVERAGE",e.SUBTRACT="SUBTRACT"}(e||(e={}))},32643:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.ERROR_EVENT="CORNERSTONE_ERROR",e.CACHE_SIZE_EXCEEDED="CACHE_SIZE_EXCEEDED",e.IMAGE_LOAD_ERROR="IMAGE_LOAD_ERROR",e.CAMERA_MODIFIED="CORNERSTONE_CAMERA_MODIFIED",e.CAMERA_RESET="CORNERSTONE_CAMERA_RESET",e.VOI_MODIFIED="CORNERSTONE_VOI_MODIFIED",e.PRESET_MODIFIED="CORNERSTONE_VIEWPORT_RENDERING_PRESET_MODIFIED",e.DISPLAY_AREA_MODIFIED="CORNERSTONE_DISPLAY_AREA_MODIFIED",e.ELEMENT_DISABLED="CORNERSTONE_ELEMENT_DISABLED",e.ELEMENT_ENABLED="CORNERSTONE_ELEMENT_ENABLED",e.IMAGE_RENDERED="CORNERSTONE_IMAGE_RENDERED",e.IMAGE_VOLUME_MODIFIED="CORNERSTONE_IMAGE_VOLUME_MODIFIED",e.IMAGE_VOLUME_LOADING_COMPLETED="CORNERSTONE_IMAGE_VOLUME_LOADING_COMPLETED",e.IMAGE_LOADED="CORNERSTONE_IMAGE_LOADED",e.IMAGE_RETRIEVAL_STAGE="CORNERSTONE_IMAGE_RETRIEVAL_STAGE",e.IMAGE_LOAD_FAILED="CORNERSTONE_IMAGE_LOAD_FAILED",e.VOLUME_VIEWPORT_NEW_VOLUME="CORNERSTONE_VOLUME_VIEWPORT_NEW_VOLUME",e.VOLUME_LOADED="CORNERSTONE_VOLUME_LOADED",e.VOLUME_LOADED_FAILED="CORNERSTONE_VOLUME_LOADED_FAILED",e.IMAGE_CACHE_IMAGE_ADDED="CORNERSTONE_IMAGE_CACHE_IMAGE_ADDED",e.IMAGE_CACHE_IMAGE_REMOVED="CORNERSTONE_IMAGE_CACHE_IMAGE_REMOVED",e.VOLUME_CACHE_VOLUME_ADDED="CORNERSTONE_VOLUME_CACHE_VOLUME_ADDED",e.VOLUME_CACHE_VOLUME_REMOVED="CORNERSTONE_VOLUME_CACHE_VOLUME_REMOVED",e.STACK_NEW_IMAGE="CORNERSTONE_STACK_NEW_IMAGE",e.VOLUME_NEW_IMAGE="CORNERSTONE_VOLUME_NEW_IMAGE",e.PRE_STACK_NEW_IMAGE="CORNERSTONE_PRE_STACK_NEW_IMAGE",e.IMAGE_SPACING_CALIBRATED="CORNERSTONE_IMAGE_SPACING_CALIBRATED",e.VIEWPORT_NEW_IMAGE_SET="CORNERSTONE_VIEWPORT_NEW_IMAGE_SET",e.STACK_VIEWPORT_SCROLL="CORNERSTONE_STACK_VIEWPORT_SCROLL",e.STACK_SCROLL_OUT_OF_BOUNDS="STACK_SCROLL_OUT_OF_BOUNDS",e.GEOMETRY_CACHE_GEOMETRY_ADDED="CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_ADDED",e.GEOMETRY_CACHE_GEOMETRY_REMOVED="CORNERSTONE_GEOMETRY_CACHE_GEOMETRY_REMOVED",e.VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS="VOLUME_VIEWPORT_SCROLL_OUT_OF_BOUNDS",e.VOLUME_VIEWPORT_SCROLL="VOLUME_VIEWPORT_SCROLL",e.CLIPPING_PLANES_UPDATED="CORNERSTONE_CLIPPING_PLANES_UPDATED",e.WEB_WORKER_PROGRESS="CORNERSTONE_WEB_WORKER_PROGRESS",e.COLORMAP_MODIFIED="CORNERSTONE_COLORMAP_MODIFIED",e.DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED="DYNAMIC_VOLUME_DIMENSION_GROUP_CHANGED",e.DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED="DYNAMIC_VOLUME_TIME_POINT_INDEX_CHANGED",e.DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED="DYNAMIC_VOLUME_DIMENSION_GROUP_LOADED",e.DYNAMIC_VOLUME_TIME_POINT_LOADED="DYNAMIC_VOLUME_TIME_POINT_LOADED",e.GEOMETRY_LOADED="GEOMETRY_LOADED",e.GEOMETRY_LOAD_PROGRESS="GEOMETRY_LOAD_PROGRESS",e.GEOMETRY_LOADED_FAILED="GEOMETRY_LOADED_FAILED"}(r||(r={}));const i=r},91346:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.CONTOUR="CONTOUR",e.SURFACE="SURFACE",e.MESH="MESH"}(r||(r={}));const i=r},77474:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e[e.FAR_REPLICATE=1]="FAR_REPLICATE",e[e.ADJACENT_REPLICATE=3]="ADJACENT_REPLICATE",e[e.SUBRESOLUTION=6]="SUBRESOLUTION",e[e.LOSSY=7]="LOSSY",e[e.FULL_RESOLUTION=8]="FULL_RESOLUTION"}(r||(r={}));const i=r},29310:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e[e.FAST_LINEAR=2]="FAST_LINEAR"}(r||(r={}));const i=r},32731:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.PLY="PLY",e.STL="STL",e.OBJ="OBJ",e.VTP="VTP"}(r||(r={}));const i=r},69850:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.CALIBRATION="calibrationModule",e.CINE="cineModule",e.GENERAL_IMAGE="generalImageModule",e.GENERAL_SERIES="generalSeriesModule",e.GENERAL_STUDY="generalStudyModule",e.IMAGE_PIXEL="imagePixelModule",e.IMAGE_PLANE="imagePlaneModule",e.IMAGE_URL="imageUrlModule",e.MODALITY_LUT="modalityLutModule",e.MULTIFRAME="multiframeModule",e.NM_MULTIFRAME_GEOMETRY="nmMultiframeGeometryModule",e.OVERLAY_PLANE="overlayPlaneModule",e.PATIENT="patientModule",e.PATIENT_STUDY="patientStudyModule",e.PET_IMAGE="petImageModule",e.PET_ISOTOPE="petIsotopeModule",e.PET_SERIES="petSeriesModule",e.SOP_COMMON="sopCommonModule",e.ULTRASOUND_ENHANCED_REGION="ultrasoundEnhancedRegionModule",e.VOI_LUT="voiLutModule",e.WADO_WEB_CLIENT="wadoWebClient"}(r||(r={}));const i=r},18735:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.AXIAL="axial",e.CORONAL="coronal",e.SAGITTAL="sagittal",e.ACQUISITION="acquisition"}(r||(r={}));const i=r},43213:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.Interaction="interaction",e.Thumbnail="thumbnail",e.Prefetch="prefetch",e.Compute="compute"}(r||(r={}));const i=r},82501:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.LINEAR="LINEAR",e.SAMPLED_SIGMOID="SIGMOID",e.LINEAR_EXACT="LINEAR_EXACT"}(r||(r={}));const i=r},13545:(e,t,n)=>{"use strict";var r;n.d(t,{SpeedUnit:()=>r}),function(e){e.FRAME="f",e.SECOND="s"}(r||(r={}))},1814:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.NO_DATA="noData",e.LOADING="loading",e.PRE_RENDER="preRender",e.RESIZE="resize",e.RENDERED="rendered"}(r||(r={}));const i=r},41864:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.STACK="stack",e.ORTHOGRAPHIC="orthographic",e.PERSPECTIVE="perspective",e.VOLUME_3D="volume3d",e.VIDEO="video",e.WHOLE_SLIDE="wholeSlide"}(r||(r={}));const i=r},6796:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.RLE="RLE",e.Volume="Volume"}(r||(r={}));const i=r},10364:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=new class{constructor(){this.listeners={},this.debouncedListeners={}}reset(){this.listeners={},this.debouncedListeners={}}addEventListenerOnce(e,t){const n=r=>{this.removeEventListener(e,n),t.call(this,r)};this.addEventListener(e,n)}addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),-1===this.listeners[e].indexOf(t)&&this.listeners[e].push(t)}addEventListenerDebounced(e,t,n){this.debouncedListeners[e]=this.debouncedListeners[e]||{};const r=this.debouncedListeners[e];if(!r[t]){const i=e=>{r[t]&&clearTimeout(r[t].timeoutId),r[t].timeoutId=setTimeout((()=>{t.call(this,e)}),n)};r[t]={original:t,handle:i,timeoutId:null},this.addEventListener(e,i)}}removeEventListenerDebounced(e,t){if(this.debouncedListeners[e]?.[t]){const n=this.debouncedListeners[e][t];this.removeEventListener(e,n.handle),clearTimeout(n.timeoutId),delete this.debouncedListeners[e][t]}}removeEventListener(e,t){if(!this.listeners[e])return;const n=this.listeners[e],r=n.length;for(let e=0;e<r;e++)if(n[e]===t)return void n.splice(e,1)}dispatchEvent(e){if(!this.listeners[e.type])return!e.defaultPrevented;const t=this.listeners[e.type].slice(),n=t.length;for(let r=0;r<n;r++)try{t[r].call(this,e)}catch(t){console.error(`error in event listener of type:  ${e.type}`,t)}return!e.defaultPrevented}}},86846:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>i,b1:()=>o,yj:()=>a,zb:()=>s});var r=n(39536);function i(e){if(!e)return;const{viewportUid:t,renderingEngineUid:n}=e.dataset;return o(t,n)}function o(e,t){if(!t||!e)return;const n=(0,r.Ay)(t);if(!n||n.hasBeenDestroyed)return;const i=n.getViewport(e);if(!i)return;const o=i.getFrameOfReferenceUID();return{viewport:i,renderingEngine:n,viewportId:e,renderingEngineId:t,FrameOfReferenceUID:o}}function a(e){const t=(0,r.qO)();for(let n=0;n<t.length;n++){const r=t[n];if(r.getViewport(e))return o(e,r.id)}}function s(){const e=[];return(0,r.qO)().forEach((t=>{t.getViewports().forEach((({element:t})=>{e.push(i(t))}))})),e}},26896:(e,t,n)=>{"use strict";n.d(t,{lk:()=>h,up:()=>f,D0:()=>v,LH:()=>m,G_:()=>y,Dh:()=>g,a:()=>b});n(39536),n(74268);var r=n(99178),i=n(71851),o=n(24743);const a=class{constructor(){this.workerRegistry={},this.workerPoolManager=new o.R("webworker")}registerWorker(e,t,n={}){const{maxWorkerInstances:i=1,overwrite:o=!1,autoTerminateOnIdle:a={enabled:!1,idleTimeThreshold:3e3}}=n;if(this.workerRegistry[e]&&!o)return void console.warn(`Worker type '${e}' is already registered...`);o&&this.workerRegistry[e]?.idleCheckIntervalId&&clearInterval(this.workerRegistry[e].idleCheckIntervalId);const s={workerFn:null,instances:[],loadCounters:[],lastActiveTime:[],nativeWorkers:[],autoTerminateOnIdle:a.enabled,idleCheckIntervalId:null,idleTimeThreshold:a.idleTimeThreshold};s.loadCounters=Array(i).fill(0),s.lastActiveTime=Array(i).fill(null);for(let e=0;e<i;e++){const e=t();s.instances.push(r.LV(e)),s.nativeWorkers.push(e),s.workerFn=t}this.workerRegistry[e]=s}getNextWorkerAPI(e){const t=this.workerRegistry[e];if(!t)return console.error(`Worker type '${e}' is not registered.`),null;const n=t.instances.filter((e=>null!==e));let i=0,o=t.loadCounters[0]||0;for(let e=1;e<n.length;e++){const n=t.loadCounters[e]||0;n<o&&(i=e,o=n)}if(null===t.instances[i]){const e=t.workerFn();t.instances[i]=r.LV(e),t.nativeWorkers[i]=e}return t.loadCounters[i]+=1,{api:t.instances[i],index:i}}executeTask(e,t,n={},{requestType:o=i.RequestType.Compute,priority:a=0,options:s={},callbacks:l=[]}={}){return new Promise(((i,c)=>{this.workerPoolManager.addRequest((async()=>{const{api:o,index:a}=this.getNextWorkerAPI(e);if(!o){const t=new Error(`No available worker instance for '${e}'`);return console.error(t),void c(t)}try{let s=[];l.length&&(s=l.map((e=>r.BX(e))));const c=this.workerRegistry[e];c.processing=!0;const u=await o[t](n,...s);c.processing=!1,c.lastActiveTime[a]=Date.now(),c.autoTerminateOnIdle&&!c.idleCheckIntervalId&&c.idleTimeThreshold&&(c.idleCheckIntervalId=setInterval((()=>{this.terminateIdleWorkers(e,c.idleTimeThreshold)}),c.idleTimeThreshold)),i(u)}catch(n){console.error(`Error executing method '${t}' on worker '${e}':`,n),c(n)}finally{this.workerRegistry[e].loadCounters[a]--}}),o,s,a)}))}terminateIdleWorkers(e,t){const n=this.workerRegistry[e];if(n.processing)return;const r=Date.now();n.instances.forEach(((i,o)=>{const a=n.lastActiveTime[o];!(null!==a&&n.loadCounters[o]>0)&&r-a>t&&this.terminateWorkerInstance(e,o)}))}terminate(e){const t=this.workerRegistry[e];t?t.instances.forEach(((t,n)=>{this.terminateWorkerInstance(e,n)})):console.error(`Worker type '${e}' is not registered.`)}terminateWorkerInstance(e,t){const n=this.workerRegistry[e],i=n.instances[t];null!==i&&(i[r.A2](),n.nativeWorkers[t].terminate(),n.instances[t]=null,n.lastActiveTime[t]=null)}};let s=!1;const l={gpuTier:{tier:2},isMobile:!1,rendering:{useCPURendering:!1,preferSizeOverAccuracy:!1,strictZSpacingForVolumeViewport:!0},peerImport:e=>null};let c={...l,rendering:{...l.rendering}},u=null,d=!1;function p(){return!!/iPad|iPhone|iPod/.test(navigator.platform)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&navigator.platform.includes("MacIntel")}function f(){return d}function h(){return!p()}function m(){return c.rendering.useCPURendering}function g(){return s}function v(){return c}function y(){return u||(u=new a),u}async function b(e){return c.peerImport(e)}},36822:(e,t,n)=>{"use strict";n.d(t,{Ke:()=>v,Ay:()=>y});const r=[{id:"initialImages",retrieveType:"single"}],i=[{id:"lossySequential",retrieveType:"singleFast"},{id:"finalSequential",retrieveType:"singleFinal"}];var o=n(71851);const a=[{offset:-1,imageQualityStatus:o.ImageQualityStatus.ADJACENT_REPLICATE},{offset:1,imageQualityStatus:o.ImageQualityStatus.ADJACENT_REPLICATE},{offset:2,imageQualityStatus:o.ImageQualityStatus.FAR_REPLICATE}],s=[{id:"initialImages",positions:[.5,0,-1],retrieveType:"default",requestType:o.RequestType.Thumbnail,priority:5,nearbyFrames:a},{id:"quarterThumb",decimate:4,offset:3,requestType:o.RequestType.Thumbnail,retrieveType:"multipleFast",priority:6,nearbyFrames:a},{id:"halfThumb",decimate:4,offset:1,priority:7,requestType:o.RequestType.Thumbnail,retrieveType:"multipleFast",nearbyFrames:a},{id:"quarterFull",decimate:4,offset:2,priority:8,requestType:o.RequestType.Thumbnail,retrieveType:"multipleFinal"},{id:"halfFull",decimate:4,offset:0,priority:9,requestType:o.RequestType.Thumbnail,retrieveType:"multipleFinal"},{id:"threeQuarterFull",decimate:4,offset:1,priority:10,requestType:o.RequestType.Thumbnail,retrieveType:"multipleFinal"},{id:"finalFull",decimate:4,offset:3,priority:11,requestType:o.RequestType.Thumbnail,retrieveType:"multipleFinal"},{id:"errorRetrieve"}];var l=n(80068),c=n(69372),u=n(22191),d=n(63470),p=n(51159),f=n(49038),h=n(10364);class m{static{this.createProgressive=v}static{this.interleavedRetrieveStages={stages:s}}static{this.singleRetrieveStages={stages:r}}static{this.sequentialRetrieveStages={stages:i}}constructor(e){this.stages=e.stages||r,this.retrieveOptions=e.retrieveOptions||{}}loadImages(e,t){return new g(this,e,t).loadImages()}}class g{constructor(e,t,n){this.outstandingRequests=0,this.stageStatusMap=new Map,this.displayedIterator=new u.A("displayed"),this.stages=e.stages,this.retrieveOptions=e.retrieveOptions,this.imageIds=t,this.listener=n}async loadImages(){const e=this.createStageRequests();this.outstandingRequests=e.length;for(const t of e)this.addRequest(t);return 0===this.outstandingRequests?Promise.resolve(null):this.displayedIterator.getDonePromise()}sendRequest(e,t){const{imageId:n,next:r}=e,i=(t.loader||l.loadAndCacheImage)(n,t),a=u.A.as(i);let s=!1;a.forEach((async(t,r)=>{const i=f.Ay.getImageQuality(n);if(!t)return void console.warn("No image retrieved",n);const{imageQualityStatus:a}=t;s||=a===o.ImageQualityStatus.FULL_RESOLUTION,void 0!==i&&i>a?this.updateStageStatus(e.stage,null,!0):(this.listener.successCallback(n,t),this.displayedIterator.add(t),r&&this.updateStageStatus(e.stage),function(e,t,n){if(t?.nearbyRequests?.length)for(const r of t.nearbyRequests)try{const{itemId:t,imageQualityStatus:i}=r,o=f.Ay.getImageQuality(t);if(void 0!==o&&o>=i)continue;const a={...n,imageId:t,imageQualityStatus:i};f.Ay.setPartialImage(t,a),e.successCallback(t,a)}catch(e){console.warn("Couldn't fill nearby item ",r.itemId,e)}}(this.listener,e,t))}),((t,i)=>{this.listener.errorCallback(n,s||!r,t),i&&this.updateStageStatus(e.stage,t)})).finally((()=>{if(!s&&r)f.Ay.setPartialImage(n),this.addRequest(r,t.streamingData);else{s||this.listener.errorCallback(n,!0,"Couldn't decode"),this.outstandingRequests--;for(let e=r;e;e=e.next)this.updateStageStatus(e.stage,null,!0)}this.outstandingRequests<=0&&this.displayedIterator.resolve()}));return a.getDonePromise().catch((e=>null))}addRequest(e,t={}){const{imageId:n,stage:r}=e,i=this.listener.getLoaderImageOptions(n);if(!i)return;const{retrieveType:a="default"}=r,{retrieveOptions:s}=this,l=s[a]||s.default,c={...i,retrieveType:a,retrieveOptions:l,streamingData:t},u=r.priority??-5,d=r.requestType||o.RequestType.Interaction,f={imageId:n};p.A.addRequest(this.sendRequest.bind(this,e,c),d,f,u)}updateStageStatus(e,t,n=!1){const{id:r}=e,i=this.stageStatusMap.get(r);if(i&&(i.imageLoadPendingCount--,t?i.imageLoadFailedCount++:n||i.totalImageCount++,n||i.stageStartTime||(i.stageStartTime=Date.now()),!i.imageLoadPendingCount)){const{imageLoadFailedCount:e,totalImageCount:t,stageStartTime:n=Date.now(),startTime:a}=i,s={stageId:r,numberOfFailures:e,numberOfImages:t,stageDurationInMS:n?Date.now()-n:null,startDurationInMS:Date.now()-a};(0,c.A)(h.A,o.Events.IMAGE_RETRIEVAL_STAGE,s),this.stageStatusMap.delete(r)}}createStageRequests(){const e=new Array,t=new Map,n=(n,r)=>{const i=r<0?this.imageIds.length+r:r<1?Math.floor((this.imageIds.length-1)*r):r,o=this.imageIds[i];if(!o)throw new Error(`No value found to add to requests at ${r}`);const a={imageId:o,stage:n,index:i,nearbyRequests:this.findNearbyRequests(i,n)};this.addStageStatus(n);const s=t.get(o);s?s.next=a:e.push(a),t.set(o,a)};for(const e of this.stages){(e.positions||(0,d.A)(this.imageIds,e.decimate||1,e.offset??0)).forEach((t=>{n(e,t)}))}return e}findNearbyRequests(e,t){const n=new Array;if(!t.nearbyFrames)return n;for(const r of t.nearbyFrames){const t=e+r.offset;t<0||t>=this.imageIds.length||n.push({itemId:this.imageIds[t],imageQualityStatus:r.imageQualityStatus,index:t})}return n}addStageStatus(e){const{id:t}=e,n=this.stageStatusMap.get(t)||{stageId:t,startTime:Date.now(),stageStartTime:null,totalImageCount:0,imageLoadFailedCount:0,imageLoadPendingCount:0};return n.imageLoadPendingCount++,this.stageStatusMap.set(t,n),n}}function v(e){return new m(e)}const y=m},56074:(e,t,n)=>{"use strict";n.d(t,{R:()=>l});var r=n(97994),i=n(71851),o=n(10364),a=n(10297);function s({url:e,signal:t,onload:n,loaderOptions:r}){return new Promise(((s,l)=>{const c=new XMLHttpRequest;c.open("GET",e,!0);const u={},d=r.beforeSend(c,u),p=Object.assign({},u,d);c.responseType="arraybuffer",Object.keys(p).forEach((function(e){null!==p[e]&&c.setRequestHeader(e,p[e])}));const f=function(e){n&&"function"==typeof n&&n(),t&&t.removeEventListener("abort",h),s(c.response)},h=()=>{c.abort(),c.removeEventListener("load",f),l(new Error("Request aborted"))};c.addEventListener("load",f);c.onprogress=function(t){((t,n)=>{const r={url:e,loaded:t,total:n};(0,a.triggerEvent)(o.A,i.Events.GEOMETRY_LOAD_PROGRESS,{data:r})})(t.loaded,t.total)},t&&t.aborted?(c.abort(),l(new Error("Request aborted"))):t&&t.addEventListener("abort",h),c.send()}))}function l(e,t,n){const i=new Promise(((i,o)=>{(async function(e,t,n){const i=e.split(":"),o=i.slice(1).join(":"),a=await s({url:o,loaderOptions:n});if(!t||!("geometryData"in t))throw new Error("Mesh must have a geometryData");return(0,r.q)(o,{...t.geometryData,arrayBuffer:a})})(e,t,n).then(i).catch(o)}));return{promise:i,cancelFn:void 0,decache:()=>{}}}},55509:(e,t,n)=>{"use strict";n(50584),n(10297)},55500:(e,t,n)=>{"use strict";n.d(t,{F:()=>c});var r=n(49038),i=n(50180),o=n(71851),a=n(51159),s=n(9734),l=n(80068);function c(e,t){if(!t||!t.imageIds||!t.imageIds.length)throw new Error("ImageIds must be provided to create a streaming image volume");const n=async function(){if("wadouri"===t.imageIds[0].split(":")[0]){const[n,i]=[Math.floor(t.imageIds.length/2),t.imageIds.length-1],s=[0,n,i];await Promise.all(s.map((n=>r.Ay.isLoaded(t.imageIds[n])?Promise.resolve(!0):new Promise(((r,i)=>{const s=t.imageIds[n];a.A.addRequest((async()=>{(0,l.loadImage)(s).then((()=>{console.log(`Prefetched imageId: ${s}`),r(!0)})).catch((e=>{i(e)}))}),o.RequestType.Prefetch,{volumeId:e},1)}))))).catch(console.error)}const n=(0,s.D)(t.imageIds,e),{dimensions:c,spacing:u,origin:d,direction:p,metadata:f,imageIds:h,dataType:m,numberOfComponents:g}=n;return new i.A({volumeId:e,metadata:f,dimensions:c,spacing:u,origin:d,direction:p,imageIds:h,dataType:m,numberOfComponents:g},{imageIds:h,loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}})}();return{promise:n,decache:()=>{n.then((e=>{e.destroy(),e=null}))},cancel:()=>{n.then((e=>{e.cancelLoading()}))}}}},89926:(e,t,n)=>{"use strict";n(38475),n(63819),n(80639),n(58601);var r=n(28906),i=n(3823),o=n(95583),a=n(16632),s=n(7019),l=n(21734),c=n(42008),u=n(82409),d=n(87275),p=n(61433);const f=[[-1,0,0],[1,0,0],[0,-1,0],[0,1,0],[0,0,-1],[0,0,1]],h=[[8,7,11,3],[9,1,10,5],[4,9,0,8],[2,11,6,10],[0,3,2,1],[4,5,6,7]],m=[[0,1],[1,3],[2,3],[0,2],[4,5],[5,7],[6,7],[4,6],[0,4],[1,5],[3,7],[2,6]],g=[0,1,0,1,0,1,0,1,2,2,2,2],v=[[1,2],[1,2],[0,2],[0,2],[0,1],[0,1]],y=new Float64Array(3),b=new Float64Array(3),x=new Float64Array(3),A=new Float64Array(3),C=new Float64Array(3),T=new Float64Array(3),S=new Float64Array(16);function w(e,t){e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeSize,e.fillStyle=t.fontColor,e.font=`${t.fontStyle} ${t.fontSize}px ${t.fontFamily}`}function _(e){const t=[],n=[];for(let r=0;r<3;r++){const i=o.m4().domain([e[2*r],e[2*r+1]]);t[r]=i.ticks(5);const a=i.tickFormat(5);n[r]=t[r].map(a)}return{ticks:t,tickStrings:n}}const I=r.m.newInstance((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{renderable:null};Object.assign(t,{},n),r.m.obj(e,t),t.tmPolyData=d.Ay.newInstance(),t.tmMapper=u.Ay.newInstance(),t.tmMapper.setInputData(t.tmPolyData),t.tmActor=s.Ay.newInstance({parentProp:e}),t.tmActor.setMapper(t.tmMapper),r.m.setGet(e,t,["renderable"]),r.m.get(e,t,["lastSize","lastAspectRatio","axisTextStyle","tickTextStyle","tmActor","ticks"]),t.forceUpdate=!1,t.lastRedrawTime={},r.m.obj(t.lastRedrawTime,{mtime:0}),t.lastRebuildTime={},r.m.obj(t.lastRebuildTime,{mtime:0}),t.lastSize=[-1,-1],t.lastTickBounds=[],function(e,t){t.classHierarchy.push("vtkCubeAxesActorHelper"),e.setRenderable=n=>{t.renderable!==n&&(t.renderable=n,t.tmActor.addTexture(t.renderable.getTmTexture()),t.tmActor.setProperty(n.getProperty()),t.tmActor.setParentProp(n),e.modified())},e.createPolyDataForOneLabel=(e,n,r,o,a,s,l)=>{const c=t.renderable.get_tmAtlas().get(e);if(!c)return;const u=t.renderable.getTextPolyData().getPoints().getData(),d=t.lastSize;y[0]=u[3*n],y[1]=u[3*n+1],y[2]=u[3*n+2],i.eR.transformMat4(x,y,r),x[0]+=.1,i.eR.transformMat4(b,x,o),i.eR.subtract(C,b,y),x[0]-=.1,x[1]+=.1,i.eR.transformMat4(b,x,o),i.eR.subtract(T,b,y);for(let e=0;e<3;e++)C[e]/=.05*d[0],T[e]/=.05*d[1];let p=l.ptIdx,f=l.cellIdx;y[0]=u[3*n],y[1]=u[3*n+1],y[2]=u[3*n+2],a[0]<-.5?i.eR.scale(x,C,a[0]*s-c.width):a[0]>.5?i.eR.scale(x,C,a[0]*s):i.eR.scale(x,C,a[0]*s-c.width/2),i.eR.add(y,y,x),i.eR.scale(x,T,a[1]*s-c.height/2),i.eR.add(y,y,x),l.points[3*p]=y[0],l.points[3*p+1]=y[1],l.points[3*p+2]=y[2],l.tcoords[2*p]=c.tcoords[0],l.tcoords[2*p+1]=c.tcoords[1],p++,i.eR.scale(x,C,c.width),i.eR.add(y,y,x),l.points[3*p]=y[0],l.points[3*p+1]=y[1],l.points[3*p+2]=y[2],l.tcoords[2*p]=c.tcoords[2],l.tcoords[2*p+1]=c.tcoords[3],p++,i.eR.scale(x,T,c.height),i.eR.add(y,y,x),l.points[3*p]=y[0],l.points[3*p+1]=y[1],l.points[3*p+2]=y[2],l.tcoords[2*p]=c.tcoords[4],l.tcoords[2*p+1]=c.tcoords[5],p++,i.eR.scale(x,C,c.width),i.eR.subtract(y,y,x),l.points[3*p]=y[0],l.points[3*p+1]=y[1],l.points[3*p+2]=y[2],l.tcoords[2*p]=c.tcoords[6],l.tcoords[2*p+1]=c.tcoords[7],p++,l.polys[4*f]=3,l.polys[4*f+1]=p-4,l.polys[4*f+2]=p-3,l.polys[4*f+3]=p-2,f++,l.polys[4*f]=3,l.polys[4*f+1]=p-4,l.polys[4*f+2]=p-2,l.polys[4*f+3]=p-1,l.ptIdx+=4,l.cellIdx+=2},e.updateTexturePolyData=()=>{const n=t.camera.getCompositeProjectionMatrix(t.lastAspectRatio,-1,1);i.pB.transpose(n,n);const r=t.renderable.getTextValues().length,o=4*r,s=2*r,l=new Float64Array(3*o),u=new Uint16Array(4*s),d=new Float32Array(2*o);i.pB.invert(S,n);const p={ptIdx:0,cellIdx:0,polys:u,points:l,tcoords:d};let f=0,h=0,m=0;const g=t.renderable.getTextPolyData().getPoints().getData(),v=t.renderable.getTextValues();for(;f<g.length/3;){y[0]=g[3*f],y[1]=g[3*f+1],y[2]=g[3*f+2],i.eR.transformMat4(x,y,n),y[0]=g[3*f+3],y[1]=g[3*f+4],y[2]=g[3*f+5],i.eR.transformMat4(A,y,n),i.eR.subtract(x,x,A);const r=[x[0],x[1]];(0,a.Q)(r),e.createPolyDataForOneLabel(v[h],f,n,S,r,t.renderable.getAxisTitlePixelOffset(),p),f+=2,h++;for(let i=0;i<t.renderable.getTickCounts()[m];i++)e.createPolyDataForOneLabel(v[h],f,n,S,r,t.renderable.getTickLabelPixelOffset(),p),f++,h++;m++}const b=c.Ay.newInstance({numberOfComponents:2,values:d,name:"TextureCoordinates"});t.tmPolyData.getPointData().setTCoords(b),t.tmPolyData.getPoints().setData(l,3),t.tmPolyData.getPoints().modified(),t.tmPolyData.getPolys().setData(u,1),t.tmPolyData.getPolys().modified(),t.tmPolyData.modified()},e.updateAPISpecificData=(n,r,i)=>{t.lastSize[0]===n[0]&&t.lastSize[1]===n[1]||(t.lastSize[0]=n[0],t.lastSize[1]=n[1],t.lastAspectRatio=n[0]/n[1],t.forceUpdate=!0),t.camera=r,e.updateTexturePolyData()}}(e,t)}),"vtkCubeAxesActorHelper");function E(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};s.Ay.extend(e,t,function(e,t,n){return{boundsScaleFactor:1.3,camera:null,dataBounds:[...l.Ay.INIT_BOUNDS],faceVisibilityAngle:8,gridLines:!0,axisLabels:null,axisTitlePixelOffset:35,tickLabelPixelOffset:12,generateTicks:_,...n,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif",...n?.axisTextStyle},tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif",...n?.tickTextStyle}}}(0,0,n)),t.lastFacesToDraw=[!1,!1,!1,!1,!1,!1],t.axisLabels=["X-Axis","Y-Axis","Z-Axis"],t.tickCounts=[],t.textValues=[],t.lastTickBounds=[],t.tmCanvas=document.createElement("canvas"),t.tmContext=t.tmCanvas.getContext("2d"),t._tmAtlas=new Map,t.tmTexture=p.Ay.newInstance({resizable:!0}),t.tmTexture.setInterpolate(!1),e.getProperty().setDiffuse(0),e.getProperty().setAmbient(1),t.gridMapper=u.Ay.newInstance(),t.polyData=d.Ay.newInstance(),t.gridMapper.setInputData(t.polyData),t.gridActor=s.Ay.newInstance(),t.gridActor.setMapper(t.gridMapper),t.gridActor.setProperty(e.getProperty()),t.gridActor.setParentProp(e),t.textPolyData=d.Ay.newInstance(),r.m.setGet(e,t,["axisTitlePixelOffset","boundsScaleFactor","faceVisibilityAngle","gridLines","tickLabelPixelOffset","generateTicks"]),r.m.setGetArray(e,t,["dataBounds"],6),r.m.setGetArray(e,t,["axisLabels"],3),r.m.get(e,t,["axisTextStyle","tickTextStyle","camera","tmTexture","textValues","textPolyData","tickCounts","gridActor"]),function(e,t){t.classHierarchy.push("vtkCubeAxesActor"),e.setCamera=n=>{t.camera!==n&&(t.cameraModifiedSub&&(t.cameraModifiedSub.unsubscribe(),t.cameraModifiedSub=null),t.camera=n,n&&(t.cameraModifiedSub=n.onModified(e.update)),e.update(),e.modified())},e.computeFacesToDraw=()=>{const e=t.camera.getViewMatrix();i.pB.transpose(e,e);let n=!1;const r=l.Ay.getDiagonalLength(t.dataBounds),o=Math.sin(t.faceVisibilityAngle*Math.PI/180);for(let a=0;a<6;a++){let s=!1;const l=Math.floor(a/2),c=(l+1)%3,u=(l+2)%3;t.dataBounds[2*c]!==t.dataBounds[2*c+1]&&t.dataBounds[2*u]!==t.dataBounds[2*u+1]&&(y[l]=t.dataBounds[a]-.1*r*f[a][l],y[c]=.5*(t.dataBounds[2*c]+t.dataBounds[2*c+1]),y[u]=.5*(t.dataBounds[2*u]+t.dataBounds[2*u+1]),i.eR.transformMat4(x,y,e),y[l]=t.dataBounds[a],i.eR.transformMat4(A,y,e),i.eR.subtract(x,A,x),i.eR.normalize(x,x),s=x[2]>o,t.camera.getParallelProjection()||(i.eR.normalize(A,A),s=i.eR.dot(A,x)>o)),s!==t.lastFacesToDraw[a]&&(t.lastFacesToDraw[a]=s,n=!0)}return n},e.updatePolyData=(e,n,r)=>{let i=0,o=0;i+=8;let a=0;for(let e=0;e<12;e++)n[e]>0&&a++;if(o+=a,t.gridLines)for(let t=0;t<6;t++)e[t]&&(i+=2*r[v[t][0]].length+2*r[v[t][1]].length,o+=r[v[t][0]].length+r[v[t][1]].length);const s=new Float64Array(3*i),l=new Uint32Array(3*o);let c=0,u=0;for(let e=0;e<2;e++)for(let n=0;n<2;n++)for(let r=0;r<2;r++)s[3*c]=t.dataBounds[r],s[3*c+1]=t.dataBounds[2+n],s[3*c+2]=t.dataBounds[4+e],c++;for(let e=0;e<12;e++)n[e]>0&&(l[3*u]=2,l[3*u+1]=m[e][0],l[3*u+2]=m[e][1],u++);if(t.gridLines)for(let n=0;n<6;n++)if(e[n]){const e=Math.floor(n/2);let i=r[v[n][0]];for(let r=0;r<i.length;r++)s[3*c+e]=t.dataBounds[n],s[3*c+v[n][0]]=i[r],s[3*c+v[n][1]]=t.dataBounds[2*v[n][1]],c++,s[3*c+e]=t.dataBounds[n],s[3*c+v[n][0]]=i[r],s[3*c+v[n][1]]=t.dataBounds[2*v[n][1]+1],c++,l[3*u]=2,l[3*u+1]=c-2,l[3*u+2]=c-1,u++;i=r[v[n][1]];for(let r=0;r<i.length;r++)s[3*c+e]=t.dataBounds[n],s[3*c+v[n][1]]=i[r],s[3*c+v[n][0]]=t.dataBounds[2*v[n][0]],c++,s[3*c+e]=t.dataBounds[n],s[3*c+v[n][1]]=i[r],s[3*c+v[n][0]]=t.dataBounds[2*v[n][0]+1],c++,l[3*u]=2,l[3*u+1]=c-2,l[3*u+2]=c-1,u++}t.polyData.getPoints().setData(s,3),t.polyData.getPoints().modified(),t.polyData.getLines().setData(l,1),t.polyData.getLines().modified(),t.polyData.modified()},e.updateTextData=(e,n,r,i)=>{let o=0;for(let e=0;e<12;e++)1===n[e]&&(o+=2,o+=r[g[e]].length);const a=t.polyData.getPoints().getData(),s=new Float64Array(3*o);let l=0,c=0,u=0;for(let o=0;o<6;o++)if(e[o])for(let e=0;e<4;e++){const d=h[o][e];if(1===n[d]){const e=g[d],n=3*m[d][0],p=3*m[d][1];s[3*l]=.5*(a[n]+a[p]),s[3*l+1]=.5*(a[n+1]+a[p+1]),s[3*l+2]=.5*(a[n+2]+a[p+2]),l++,s[3*l+Math.floor(o/2)]=t.dataBounds[o],s[3*l+v[o][0]]=.5*(t.dataBounds[2*v[o][0]]+t.dataBounds[2*v[o][0]+1]),s[3*l+v[o][1]]=.5*(t.dataBounds[2*v[o][1]]+t.dataBounds[2*v[o][1]+1]),l++,t.textValues[c]=t.axisLabels[e],c++;const f=(e+1)%3,h=(e+2)%3,y=r[e],b=i[e];t.tickCounts[u]=y.length;for(let r=0;r<y.length;r++)s[3*l+e]=y[r],s[3*l+f]=a[n+f],s[3*l+h]=a[n+h],l++,t.textValues[c]=b[r],c++;u++}}t.textPolyData.getPoints().setData(s,3),t.textPolyData.modified()},e.update=()=>{if(!t.camera)return;const n=e.computeFacesToDraw(),r=t.lastFacesToDraw;let i=!1;for(let e=0;e<6;e++)t.dataBounds[e]!==t.lastTickBounds[e]&&(i=!0,t.lastTickBounds[e]=t.dataBounds[e]);if(n||i||t.forceUpdate){const n=new Array(12).fill(0);for(let e=0;e<6;e++)if(r[e])for(let t=0;t<4;t++)n[h[e][t]]++;const o=t.generateTicks(t.dataBounds);e.updatePolyData(r,n,o.ticks),e.updateTextData(r,n,o.ticks,o.tickStrings),(i||t.forceUpdate)&&e.updateTextureAtlas(o.tickStrings)}t.forceUpdate=!1},e.updateTextureAtlas=e=>{t.tmContext.textBaseline="bottom",t.tmContext.textAlign="left",t._tmAtlas.clear();let n=0,r=1;for(let i=0;i<3;i++){if(!t._tmAtlas.has(t.axisLabels[i])){w(t.tmContext,t.axisTextStyle);const e=t.tmContext.measureText(t.axisLabels[i]),o={height:e.actualBoundingBoxAscent+2,startingHeight:r,width:e.width+2,textStyle:t.axisTextStyle};t._tmAtlas.set(t.axisLabels[i],o),r+=o.height,n<o.width&&(n=o.width)}w(t.tmContext,t.tickTextStyle);for(let o=0;o<e[i].length;o++)if(!t._tmAtlas.has(e[i][o])){const a=t.tmContext.measureText(e[i][o]),s={height:a.actualBoundingBoxAscent+2,startingHeight:r,width:a.width+2,textStyle:t.tickTextStyle};t._tmAtlas.set(e[i][o],s),r+=s.height,n<s.width&&(n=s.width)}}n=(0,a.R)(n),r=(0,a.R)(r),t._tmAtlas.forEach((e=>{e.tcoords=[0,(r-e.startingHeight-e.height)/r,e.width/n,(r-e.startingHeight-e.height)/r,e.width/n,(r-e.startingHeight)/r,0,(r-e.startingHeight)/r]})),t.tmCanvas.width=n,t.tmCanvas.height=r,t.tmContext.textBaseline="bottom",t.tmContext.textAlign="left",t.tmContext.clearRect(0,0,n,r),t._tmAtlas.forEach(((e,n)=>{w(t.tmContext,e.textStyle),t.tmContext.fillText(n,1,e.startingHeight+e.height-1)})),t.tmTexture.setCanvas(t.tmCanvas),t.tmTexture.modified()},e.onModified((()=>{t.forceUpdate=!0,e.update()})),e.setTickTextStyle=n=>{t.tickTextStyle={...t.tickTextStyle,...n},e.modified()},e.setAxisTextStyle=n=>{t.axisTextStyle={...t.axisTextStyle,...n},e.modified()},e.get_tmAtlas=()=>t._tmAtlas,e.getBounds=()=>(e.update(),l.Ay.setBounds(t.bounds,t.gridActor.getBounds()),l.Ay.scaleAboutCenter(t.bounds,t.boundsScaleFactor,t.boundsScaleFactor,t.boundsScaleFactor),t.bounds);const n=r.m.chain(e.setProperty,t.gridActor.setProperty);e.setProperty=e=>n(e)[0]}(e,t)}var D={newInstance:r.m.newInstance(E,"vtkCubeAxesActor"),extend:E,newCubeAxesActorHelper:I,defaultGenerateTicks:_},O=n(25196),P=n(88691);const R={};function N(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,R,n),O.A.extend(e,t,n),t.CubeAxesActorHelper=D.newCubeAxesActorHelper(),function(e,t){t.classHierarchy.push("vtkOpenGLCubeAxesActor"),e.buildPass=n=>{n&&(t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t._openGLRenderWindow=t._openGLRenderer.getParent(),t.CubeAxesActorHelper.getRenderable()||t.CubeAxesActorHelper.setRenderable(t.renderable),e.prepareNodes(),e.addMissingNode(t.CubeAxesActorHelper.getTmActor()),e.addMissingNode(t.renderable.getGridActor()),e.removeUnusedNodes())},e.opaquePass=(e,n)=>{if(e){const e=t._openGLRenderer?t._openGLRenderer.getRenderable().getActiveCamera():null,n=t._openGLRenderer.getTiledSizeAndOrigin();t.CubeAxesActorHelper.updateAPISpecificData([n.usize,n.vsize],e,t._openGLRenderWindow.getRenderable())}}}(e,t)}const M=(0,r.n)(N,"vtkOpenGLCubeAxesActor");(0,P.c9)("vtkCubeAxesActor",M);n(62939);var L=n(71650),F=n(85311),B=n(72879),V=n(33395);const{ColorMode:k,ScalarMode:U,GetArray:G}=V.Ay;const z={static:!1,lookupTable:null,scalarVisibility:!1,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,transformCoordinate:null,viewSpecificProperties:null,customShaderAttributes:[]};function W(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,z,n),F.A.extend(e,t,n),r.m.get(e,t,["colorMapColors"]),r.m.setGet(e,t,["arrayAccessMode","colorByArrayName","colorMode","lookupTable","renderTime","scalarMode","scalarVisibility","static","transformCoordinate","useLookupTableScalarRange","viewSpecificProperties","customShaderAttributes"]),r.m.setGetArray(e,t,["scalarRange"],2),t.viewSpecificProperties||(t.viewSpecificProperties={}),function(e,t){t.classHierarchy.push("vtkMapper2D"),e.createDefaultLookupTable=()=>{t.lookupTable=B.Ay.newInstance()},e.getColorModeAsString=()=>r.m.enumToString(k,t.colorMode),e.setColorModeToDefault=()=>e.setColorMode(0),e.setColorModeToMapScalars=()=>e.setColorMode(1),e.setColorModeToDirectScalars=()=>e.setColorMode(2),e.getScalarModeAsString=()=>r.m.enumToString(U,t.scalarMode),e.setScalarModeToDefault=()=>e.setScalarMode(0),e.setScalarModeToUsePointData=()=>e.setScalarMode(1),e.setScalarModeToUseCellData=()=>e.setScalarMode(2),e.setScalarModeToUsePointFieldData=()=>e.setScalarMode(3),e.setScalarModeToUseCellFieldData=()=>e.setScalarMode(4),e.setScalarModeToUseFieldData=()=>e.setScalarMode(5),e.getAbstractScalars=(e,n,r,i,o)=>{if(!e||!t.scalarVisibility)return{scalars:null,cellFLag:!1};let a=null,s=!1;if(n===U.DEFAULT)a=e.getPointData().getScalars(),a||(a=e.getCellData().getScalars(),s=!0);else if(n===U.USE_POINT_DATA)a=e.getPointData().getScalars();else if(n===U.USE_CELL_DATA)a=e.getCellData().getScalars(),s=!0;else if(n===U.USE_POINT_FIELD_DATA){const t=e.getPointData();a=r===G.BY_ID?t.getArrayByIndex(i):t.getArrayByName(o)}else if(n===U.USE_CELL_FIELD_DATA){const t=e.getCellData();s=!0,a=r===G.BY_ID?t.getArrayByIndex(i):t.getArrayByName(o)}else if(n===U.USE_FIELD_DATA){const t=e.getFieldData();a=r===G.BY_ID?t.getArrayByIndex(i):t.getArrayByName(o)}return{scalars:a,cellFlag:s}},e.getLookupTable=()=>(t.lookupTable||e.createDefaultLookupTable(),t.lookupTable),e.getMTime=()=>{let e=t.mtime;if(null!==t.lookupTable){const n=t.lookupTable.getMTime();e=n>e?n:e}return e},e.mapScalars=(n,r)=>{const i=e.getAbstractScalars(n,t.scalarMode,t.arrayAccessMode,t.arrayId,t.colorByArrayName).scalars;if(!i)return void(t.colorMapColors=null);const o=`${e.getMTime()}${i.getMTime()}${r}`;if(t.colorBuildString===o)return;t.useLookupTableScalarRange||e.getLookupTable().setRange(t.scalarRange[0],t.scalarRange[1]);const a=e.getLookupTable();a&&(a.build(),t.colorMapColors=a.mapScalars(i,t.colorMode,t.fieldDataTupleId)),t.colorBuildString=`${e.getMTime()}${i.getMTime()}${r}`},e.getPrimitiveCount=()=>{const t=e.getInputData();return{points:t.getPoints().getNumberOfValues()/3,verts:t.getVerts().getNumberOfValues()-t.getVerts().getNumberOfCells(),lines:t.getLines().getNumberOfValues()-2*t.getLines().getNumberOfCells(),triangles:t.getPolys().getNumberOfValues()-3*t.getPolys().getNumberOfCells()}}}(e,t)}var j={newInstance:r.m.newInstance(W,"vtkMapper2D"),extend:W},H=n(74966),K="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkPolyData2DFS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n\nuniform int PrimitiveIDOffset;\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\n// Scalar coloring\n//VTK::Color::Dec\n\n// Depth Peeling\n//VTK::DepthPeeling::Dec\n\n// picking support\n//VTK::Picking::Dec\n\n// the output of this shader\n//VTK::Output::Dec\n\n// Apple Bug\n//VTK::PrimID::Dec\n\nvoid main()\n{\n  // Apple Bug\n  //VTK::PrimID::Impl\n\n  //VTK::Color::Impl\n  //VTK::TCoord::Impl\n\n  //VTK::DepthPeeling::Impl\n  //VTK::Picking::Impl\n\n  if (gl_FragData[0].a <= 0.0)\n    {\n    discard;\n    }\n}\n",q="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkPolyData2DVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n\n// all variables that represent positions or directions have a suffix\n// indicating the coordinate system they are in. The possible values are\n// MC - Model Coordinates\n// WC - WC world coordinates\n// VC - View Coordinates\n// DC - Display Coordinates\n\nin vec4 vertexWC;\n\n// frag position in VC\n//VTK::PositionVC::Dec\n\n// material property values\n//VTK::Color::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\n// Apple Bug\n//VTK::PrimID::Dec\n\nuniform mat4 WCVCMatrix;  // World to view matrix\n\nvoid main()\n{\n  // Apple Bug\n  //VTK::PrimID::Impl\n\n  gl_Position = WCVCMatrix*vertexWC;\n\n  //VTK::TCoord::Impl\n\n  //VTK::Color::Impl\n\n  //VTK::PositionVC::Impl\n}\n",$=n(83534),X=n(18713);const Y={BACKGROUND:0,FOREGROUND:1};var J={DisplayLocation:Y};const{primTypes:Z}=L.Ay,{ScalarMode:Q}=j,{vtkErrorMacro:ee}=r.c,te={type:"StartEvent"},ne={type:"EndEvent"};const re={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null};function ie(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,re,n),O.A.extend(e,t,n),$.A.implementReplaceShaderCoincidentOffset(e,t,n),$.A.implementBuildShadersWithReplacements(e,t,n),t.primitives=[],t.primTypes=Z,t.tmpMat4=i.pB.identity(new Float64Array(16));for(let e=Z.Start;e<Z.End;e++)t.primitives[e]=L.Ay.newInstance(),t.primitives[e].setPrimitiveType(e),t.primitives[e].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);(0,r.e)(e,t,["context"]),t.VBOBuildTime={},(0,r.o)(t.VBOBuildTime,{mtime:0}),function(e,t){t.classHierarchy.push("vtkOpenGLPolyDataMapper2D"),e.buildPass=n=>{n&&(t.openGLActor2D=e.getFirstAncestorOfType("vtkOpenGLActor2D"),t._openGLRenderer=t.openGLActor2D.getFirstAncestorOfType("vtkOpenGLRenderer"),t._openGLRenderWindow=t._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),t.openGLCamera=t._openGLRenderer.getViewNodeFor(t._openGLRenderer.getRenderable().getActiveCamera()))},e.overlayPass=t=>{t&&e.render()},e.getShaderTemplate=(e,t,n)=>{e.Vertex=q,e.Fragment=K,e.Geometry=""},e.render=()=>{const n=t._openGLRenderWindow.getContext();if(t.context!==n){t.context=n;for(let e=Z.Start;e<Z.End;e++)t.primitives[e].setOpenGLRenderWindow(t._openGLRenderWindow)}const r=t.openGLActor2D.getRenderable(),i=t._openGLRenderer.getRenderable();e.renderPiece(i,r)},e.renderPiece=(n,r)=>{e.invokeEvent(te),t.renderable.getStatic()||t.renderable.update(),t.currentInput=t.renderable.getInputData(),e.invokeEvent(ne),t.currentInput?t.currentInput.getPoints&&t.currentInput.getPoints().getNumberOfValues()&&(e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)):ee("No input!")},e.renderPieceStart=(n,r)=>{t.primitiveIDOffset=0,t._openGLRenderer.getSelector()&&(t._openGLRenderer.getSelector().getCurrentPass(),t._openGLRenderer.getSelector().renderProp(r)),e.updateBufferObjects(n,r),t.lastBoundBO=null},e.getNeedToRebuildShaders=(e,n,r)=>e.getShaderSourceTime().getMTime()<t.renderable.getMTime()||e.getShaderSourceTime().getMTime()<t.currentInput.getMTime(),e.updateBufferObjects=(t,n)=>{e.getNeedToRebuildBufferObjects(t,n)&&e.buildBufferObjects(t,n)},e.getNeedToRebuildBufferObjects=(n,r)=>{const i=t.VBOBuildTime.getMTime();return!!(i<e.getMTime()||i<t._openGLRenderWindow.getMTime()||i<t.renderable.getMTime()||i<r.getMTime()||i<t.currentInput.getMTime()||t.renderable.getTransformCoordinate()&&i<n.getMTime())},e.buildBufferObjects=(e,n)=>{const r=t.currentInput;if(null===r)return;t.renderable.mapScalars(r,n.getProperty().getOpacity());const i=t.renderable.getColorMapColors();t.haveCellScalars=!1;const o=t.renderable.getScalarMode();t.renderable.getScalarVisibility()&&(o!==Q.USE_CELL_DATA&&o!==Q.USE_CELL_FIELD_DATA&&o!==Q.USE_FIELD_DATA&&r.getPointData().getScalars()||o===Q.USE_POINT_FIELD_DATA||!i||(t.haveCellScalars=!0));const a=n.getProperty().getRepresentation();let s=r.getPointData().getTCoords();t.openGLActor2D.getActiveTextures()||(s=null);const l=t.renderable.getTransformCoordinate(),c=e.getRenderWindow().getViews()[0].getViewportSize(e),u=`${r.getMTime()}A${a}B${r.getMTime()}C${i?i.getMTime():1}D${s?s.getMTime():1}E${l?e.getMTime():1}F${c}`;if(t.VBOBuildString!==u){let n=r.getPoints();if(l){const t=H.Ay.newInstance(),r=n.getNumberOfPoints();t.setNumberOfPoints(r);const i=[];for(let o=0;o<r;++o){n.getPoint(o,i),l.setValue(i);const r=l.getComputedDoubleViewportValue(e);t.setPoint(o,r[0],r[1],0)}n=t}const o={points:n,tcoords:s,colors:i,cellOffset:0,haveCellScalars:t.haveCellSCalars,customAttributes:t.renderable.getCustomShaderAttributes().map((e=>r.getPointData().getArrayByName(e)))};o.cellOffset+=t.primitives[Z.Points].getCABO().createVBO(r.getVerts(),"verts",a,o),o.cellOffset+=t.primitives[Z.Lines].getCABO().createVBO(r.getLines(),"lines",a,o),o.cellOffset+=t.primitives[Z.Tris].getCABO().createVBO(r.getPolys(),"polys",a,o),o.cellOffset+=t.primitives[Z.TriStrips].getCABO().createVBO(r.getStrips(),"strips",a,o),t.VBOBuildTime.modified(),t.VBOBuildString=u}},e.renderPieceDraw=(n,r)=>{const i=r.getProperty().getRepresentation();t.context.depthMask(!0);for(let o=Z.Start;o<Z.End;o++)t.primitives[o].getCABO().getElementCount()&&(t.lastBoundBO=t.primitives[o],t.primitiveIDOffset+=t.primitives[o].drawArrays(n,r,i,e))},e.renderPieceFinish=(e,n)=>{t.lastBoundBO&&t.lastBoundBO.getVAO().release()},e.replaceShaderValues=(t,n,r)=>{e.replaceShaderColor(t,n,r),e.replaceShaderTCoord(t,n,r),e.replaceShaderPicking(t,n,r),e.replaceShaderPositionVC(t,n,r)},e.replaceShaderColor=(e,n,r)=>{let i=e.Vertex,o=e.Geometry,a=e.Fragment;t.haveCellScalars&&(a=X.A.substitute(a,"//VTK::Color::Dec",["uniform samplerBuffer texture1;"]).result,a=X.A.substitute(a,"//VTK::Color::Impl",["gl_FragData[0] = texelFetchBuffer(texture1, gl_PrimitiveID + PrimitiveIDOffset);"]).result),0!==t.lastBoundBO.getCABO().getColorComponents()?(i=X.A.substitute(i,"//VTK::Color::Dec",["in vec4 diffuseColor;","out vec4 fcolorVSOutput;"]).result,i=X.A.substitute(i,"//VTK::Color::Impl",["fcolorVSOutput = diffuseColor;"]).result,o=X.A.substitute(o,"//VTK::Color::Dec",["in vec4 fcolorVSOutput[];\n","out vec4 fcolorGSOutput;"]).result,o=X.A.substitute(o,"//VTK::Color::Impl",["fcolorGSOutput = fcolorVSOutput[i];"]).result,a=X.A.substitute(a,"//VTK::Color::Dec",["in vec4 fcolorVSOutput;"]).result,a=X.A.substitute(a,"//VTK::Color::Impl",["gl_FragData[0] = fcolorVSOutput;"]).result):(a=X.A.substitute(a,"//VTK::Color::Dec",["uniform vec4 diffuseColor;"]).result,a=X.A.substitute(a,"//VTK::Color::Impl",["gl_FragData[0] = diffuseColor;"]).result),e.Vertex=i,e.Geometry=o,e.Fragment=a},e.replaceShaderTCoord=(e,n,r)=>{if(t.lastBoundBO.getCABO().getTCoordOffset()){let n=e.Vertex,r=e.Geometry,i=e.Fragment;const o=t.lastBoundBO.getCABO().getTCoordComponents();1===o?(n=X.A.substitute(n,"//VTK::TCoord::Dec",["in float tcoordMC;","out float tcoordVCVSOutput;"]).result,n=X.A.substitute(n,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,r=X.A.substitute(r,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput[];\n","out float tcoordVCGSOutput;"]).result,r=X.A.substitute(r,["//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,i=X.A.substitute(i,"//VTK::TCoord::Dec",["in float tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,i=X.A.substitute(i,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, vec2(tcoordVCVSOutput,0));"]).result):2===o&&(n=X.A.substitute(n,"//VTK::TCoord::Dec",["in vec2 tcoordMC;","out vec2 tcoordVCVSOutput;"]).result,n=X.A.substitute(n,"//VTK::TCoord::Impl",["tcoordVCVSOutput = tcoordMC;"]).result,r=X.A.substitute(r,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];\n","out vec2 tcoordVCGSOutput;"]).result,r=X.A.substitute(r,"//VTK::TCoord::Impl",["tcoordVCGSOutput = tcoordVCVSOutput[i];"]).result,i=X.A.substitute(i,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,i=X.A.substitute(i,"//VTK::TCoord::Impl",["gl_FragData[0] = gl_FragData[0]*texture2D(texture1, tcoordVCVSOutput.st);"]).result),t.haveCellScalars&&(r=X.A.substitute(r,"//VTK::PrimID::Impl",["gl_PrimitiveID = gl_PrimitiveIDIn;"]).result),e.Vertex=n,e.Geometry=r,e.Fragment=i}},e.replaceShaderPicking=(e,t,n)=>{let r=e.Fragment;r=X.A.substitute(r,"//VTK::Picking::Dec",["uniform vec3 mapperIndex;","uniform int picking;"]).result,r=X.A.substitute(r,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result,e.Fragment=r},e.replaceShaderPositionVC=(e,n,r)=>{t.lastBoundBO.replaceShaderPositionVC(e,n,r)},e.invokeShaderCallbacks=(e,n,r)=>{const i=t.renderable.getViewSpecificProperties().ShadersCallbacks;i&&i.forEach((t=>{t.callback(t.userData,e,n,r)}))},e.setMapperShaderParameters=(e,n,r)=>{if(e.getProgram().isUniformUsed("PrimitiveIDOffset")&&e.getProgram().setUniformi("PrimitiveIDOffset",t.primitiveIDOffset),e.getProgram().isAttributeUsed("vertexWC")&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),"vertexWC",e.getCABO().getVertexOffset(),e.getCABO().getStride(),t.context.FLOAT,3,!1)||ee("Error setting vertexWC in shader VAO.")),e.getCABO().getElementCount()&&(t.VBOBuildTime.getMTime()>e.getAttributeUpdateTime().getMTime()||e.getShaderSourceTime().getMTime()>e.getAttributeUpdateTime().getMTime())){t.renderable.getCustomShaderAttributes().forEach(((n,r)=>{e.getProgram().isAttributeUsed(`${n}MC`)&&(e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),`${n}MC`,e.getCABO().getCustomData()[r].offset,e.getCABO().getStride(),t.context.FLOAT,e.getCABO().getCustomData()[r].components,!1)||ee(`Error setting ${n}MC in shader VAO.`))})),e.getProgram().isAttributeUsed("tcoordMC")&&e.getCABO().getTCoordOffset()?e.getVAO().addAttributeArray(e.getProgram(),e.getCABO(),"tcoordMC",e.getCABO().getTCoordOffset(),e.getCABO().getStride(),t.context.FLOAT,e.getCABO().getTCoordComponents(),!1)||ee("Error setting tcoordMC in shader VAO."):e.getVAO().removeAttributeArray("tcoordMC"),t.internalColorTexture&&e.getProgram().isUniformUsed("texture1")&&e.getProgram().setUniformi("texture1",t.internalColorTexture.getTextureUnit());const i=t.openGLActor2D.getActiveTextures();if(i)for(let t=0;t<i.length;++t){const n=i[t].getTextureUnit(),r=`texture${n+1}`;e.getProgram().isUniformUsed(r)&&e.getProgram().setUniformi(r,n)}e.setMapperShaderParameters(n,r,t._openGLRenderer.getTiledSizeAndOrigin());const o=t._openGLRenderer.getSelector();e.getProgram().setUniform3fArray("mapperIndex",o?o.getPropColorValue():[0,0,0]),e.getProgram().setUniformi("picking",o?o.getCurrentPass()+1:0)}},e.setPropertyShaderParameters=(e,n,r)=>{const i=t.renderable.getColorMapColors();if(!i||0===i.getNumberOfComponents()){const t=e.getProgram(),n=r.getProperty(),i=n.getOpacity(),o=n.getColor(),a=[o[0],o[1],o[2],i];t.setUniform4f("diffuseColor",a)}},e.setLightingShaderParameters=(e,t,n)=>{},e.setCameraShaderParameters=(e,n,r)=>{const o=e.getProgram(),s=e.getCABO().getCoordShiftAndScaleEnabled()?e.getCABO().getInverseShiftAndScaleMatrix():null,l=n.getRenderWindow().getViews()[0].getViewportSize(n),c=n.getViewport(),u=r.getActualPositionCoordinate().getComputedDoubleViewportValue(n),d=[0,0,1,1],p=[0,0,1,1];if(p[0]=c[0]>=d[0]?c[0]:d[0],p[1]=c[1]>=d[1]?c[1]:d[1],p[2]=c[2]<=d[2]?c[2]:d[2],p[3]=c[3]<=d[3]?c[3]:d[3],p[0]>=p[2])return;if(p[1]>=p[3])return;l[0]=(0,a.P)(l[0]*(p[2]-p[0])/(c[2]-c[0])),l[1]=(0,a.P)(l[1]*(p[3]-p[1])/(c[3]-c[1]));const f=t._openGLRenderer.getParent().getSize(),h=(0,a.P)(u[0]-(p[0]-c[0])*f[0]),m=(0,a.P)(u[1]-(p[1]-c[1])*f[1]),g=-h;let v=-h+l[0];const y=-m;let b=-m+l[1];g===v&&(v=g+1),y===b&&(b=y+1);const x=i.pB.identity(new Float64Array(16));var A,C,T;x[0]=2/(v-g),x[5]=2/(b-y),x[3]=-1*(v+g)/(v-g),x[7]=-1*(b+y)/(b-y),x[10]=0,x[11]=r.getProperty().getDisplayLocation()===Y.FOREGROUND?-1:1,x[15]=1,i.pB.transpose(x,x),o.setUniformMatrix("WCVCMatrix",(A=[x,s],C=i.pB,T=t.tmpMat4,C.identity(T),A.reduce(((e,t,n)=>0===n?t?C.copy(e,t):C.identity(e):t?C.multiply(e,e,t):e),T)))},e.getAllocatedGPUMemoryInBytes=()=>{let e=0;return t.primitives.forEach((t=>{e+=t.getAllocatedGPUMemoryInBytes()})),e}}(e,t)}const oe=(0,r.n)(ie,"vtkOpenGLPolyDataMapper2D");(0,P.c9)("vtkMapper2D",oe);var ae=n(80993);const{VectorMode:se}=ae.Ay;function le(e,t){e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeSize,e.fillStyle=t.fontColor,e.font=`${t.fontStyle} ${t.fontSize}px ${t.fontFamily}`}function ce(e,t){return e=>{const n=e.getLastSize(),r=(n[0]/700)**.8,i=(n[1]/700)**.8,o=Math.min(r,i),a=e.getAxisTextStyle(),s=e.getTickTextStyle();Object.assign(a,t.axisTextStyle),Object.assign(s,t.tickTextStyle),a.fontSize=Math.max(24*o,12),e.getLastAspectRatio()>1?s.fontSize=Math.max(20*o,10):s.fontSize=Math.max(16*o,10);const l=e.updateTextureAtlas();e.setTopTitle(!1);const c=e.getBoxSizeByReference();if(e.getLastAspectRatio()>1)e.setTickLabelPixelOffset(.3*s.fontSize),l.titleWidth<=l.tickWidth+e.getTickLabelPixelOffset()+.8*s.fontSize?(e.setTopTitle(!0),e.setAxisTitlePixelOffset(.2*s.fontSize),c[0]=2*(l.tickWidth+e.getTickLabelPixelOffset()+.8*s.fontSize)/n[0],e.setBoxPosition([.98-c[0],-.92])):(e.setAxisTitlePixelOffset(.2*s.fontSize),c[0]=2*(l.titleHeight+e.getAxisTitlePixelOffset()+l.tickWidth+e.getTickLabelPixelOffset()+.8*s.fontSize)/n[0],e.setBoxPosition([.99-c[0],-.92])),c[1]=Math.max(1.2,Math.min(1.84/i,1.84));else{e.setAxisTitlePixelOffset(1.2*s.fontSize),e.setTickLabelPixelOffset(.1*s.fontSize);const t=2*(.8*s.fontSize+l.titleHeight+e.getAxisTitlePixelOffset())/n[1],r=2*l.tickWidth/n[0];c[0]=Math.min(1.9,Math.max(1.4,1.4*r*(e.getTicks().length+3))),c[1]=t,e.setBoxPosition([-.5*c[0],-.97])}e.recomputeBarSegments(l)}}function ue(e,t){return e=>{const t=e.getLastTickBounds(),n=o.m4().domain([t[0],t[1]]),r=n.ticks(5),i=n.tickFormat(5);e.setTicks(r),e.setTickStrings(r.map(i))}}const de=r.m.newInstance((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{renderable:null};Object.assign(t,{},n),r.m.obj(e,t),r.m.setGet(e,t,["axisTitlePixelOffset","tickLabelPixelOffset","renderable","topTitle","ticks","tickStrings"]),r.m.get(e,t,["lastSize","lastAspectRatio","lastTickBounds","axisTextStyle","tickTextStyle","barActor","tmActor"]),r.m.getArray(e,t,["boxPosition","boxSize"]),r.m.setArray(e,t,["boxPosition","boxSize"],2),t.forceUpdate=!1,t.lastRebuildTime={},r.m.obj(t.lastRebuildTime,{mtime:0}),t.lastSize=[-1,-1],t.tmCanvas=document.createElement("canvas"),t.tmContext=t.tmCanvas.getContext("2d"),t._tmAtlas=new Map,t.barMapper=u.Ay.newInstance(),t.barMapper.setInterpolateScalarsBeforeMapping(!0),t.barMapper.setUseLookupTableScalarRange(!0),t.polyData=d.Ay.newInstance(),t.barMapper.setInputData(t.polyData),t.barActor=s.Ay.newInstance(),t.barActor.setMapper(t.barMapper),t.tmPolyData=d.Ay.newInstance(),t.tmMapper=u.Ay.newInstance(),t.tmMapper.setInputData(t.tmPolyData),t.tmTexture=p.Ay.newInstance({resizable:!0}),t.tmTexture.setInterpolate(!1),t.tmActor=s.Ay.newInstance({parentProp:e}),t.tmActor.setMapper(t.tmMapper),t.tmActor.addTexture(t.tmTexture),t.barPosition=[0,0],t.barSize=[0,0],t.boxPosition=[.88,-.92],t.boxSize=[.1,1.1],t.lastTickBounds=[],function(e,t){t.classHierarchy.push("vtkScalarBarActorHelper"),e.setRenderable=n=>{t.renderable!==n&&(t.renderable=n,t.barActor.setProperty(n.getProperty()),t.barActor.setParentProp(n),t.barActor.setCoordinateSystemToDisplay(),t.tmActor.setProperty(n.getProperty()),t.tmActor.setParentProp(n),t.tmActor.setCoordinateSystemToDisplay(),t.generateTicks=n.generateTicks,t.axisTextStyle={...n.getAxisTextStyle()},t.tickTextStyle={...n.getTickTextStyle()},e.modified())},e.updateAPISpecificData=(n,r,i)=>{t.lastSize[0]===n[0]&&t.lastSize[1]===n[1]||(t.lastSize[0]=n[0],t.lastSize[1]=n[1],t.lastAspectRatio=n[0]/n[1],t.forceUpdate=!0);const o=t.renderable.getScalarsToColors();if(o&&t.renderable.getVisibility()&&(t.barMapper.setLookupTable(o),t.camera=r,t.renderWindow=i,t.forceUpdate||Math.max(o.getMTime(),e.getMTime(),t.renderable.getMTime())>t.lastRebuildTime.getMTime())){const n=o.getMappingRange();if(t.lastTickBounds=[...n],t.renderable.getGenerateTicks()(e),t.renderable.getAutomated())t.renderable.getAutoLayout()(e);else{t.axisTextStyle={...t.renderable.getAxisTextStyle()},t.tickTextStyle={...t.renderable.getTickTextStyle()},t.barPosition=[...t.renderable.getBarPosition()],t.barSize=[...t.renderable.getBarSize()],t.boxPosition=[...t.renderable.getBoxPosition()],t.boxSize=[...t.renderable.getBoxSize()],t.axisTitlePixelOffset=t.renderable.getAxisTitlePixelOffset(),t.tickLabelPixelOffset=t.renderable.getTickLabelPixelOffset();const n=e.updateTextureAtlas();e.recomputeBarSegments(n)}e.updatePolyDataForLabels(),e.updatePolyDataForBarSegments(),t.lastRebuildTime.modified(),t.forceUpdate=!1}},e.updateTextureAtlas=()=>{t.tmContext.textBaseline="bottom",t.tmContext.textAlign="left";const n={},r=new Map;let i=0,o=1;le(t.tmContext,t.axisTextStyle);let s=t.tmContext.measureText(t.renderable.getAxisLabel()),l={height:s.actualBoundingBoxAscent+2,startingHeight:o,width:s.width+2,textStyle:t.axisTextStyle};r.set(t.renderable.getAxisLabel(),l),o+=l.height,i=l.width,n.titleWidth=l.width,n.titleHeight=l.height,n.tickWidth=0,n.tickHeight=0,le(t.tmContext,t.tickTextStyle);const c=[...e.getTickStrings(),"NaN","Below","Above"];for(let e=0;e<c.length;e++)r.has(c[e])||(s=t.tmContext.measureText(c[e]),l={height:s.actualBoundingBoxAscent+2,startingHeight:o,width:s.width+2,textStyle:t.tickTextStyle},r.set(c[e],l),o+=l.height,i<l.width&&(i=l.width),n.tickWidth<l.width&&(n.tickWidth=l.width),n.tickHeight<l.height&&(n.tickHeight=l.height));return i=(0,a.R)(i),o=(0,a.R)(o),r.forEach((e=>{e.tcoords=[0,(o-e.startingHeight-e.height)/o,e.width/i,(o-e.startingHeight-e.height)/o,e.width/i,(o-e.startingHeight)/o,0,(o-e.startingHeight)/o]})),t.tmCanvas.width=i,t.tmCanvas.height=o,t.tmContext.textBaseline="bottom",t.tmContext.textAlign="left",t.tmContext.clearRect(0,0,i,o),r.forEach(((e,n)=>{le(t.tmContext,e.textStyle),t.tmContext.fillText(n,1,e.startingHeight+e.height-1)})),t.tmTexture.setCanvas(t.tmCanvas),t.tmTexture.modified(),t._tmAtlas=r,n},e.computeBarSize=e=>{t.vertical=t.boxSize[1]>t.boxSize[0];const n=2*e.tickHeight/t.lastSize[1],r=[1,1];if(t.vertical){const i=2*(e.tickWidth+t.tickLabelPixelOffset)/t.lastSize[0];if(t.topTitle){const n=2*(e.titleHeight+t.axisTitlePixelOffset)/t.lastSize[1];t.barSize[0]=t.boxSize[0]-i,t.barSize[1]=t.boxSize[1]-n}else{const n=2*(e.titleHeight+t.axisTitlePixelOffset)/t.lastSize[0];t.barSize[0]=t.boxSize[0]-n-i,t.barSize[1]=t.boxSize[1]}t.barPosition[0]=t.boxPosition[0]+i,t.barPosition[1]=t.boxPosition[1],r[1]=n}else{const n=(2*e.tickWidth-8)/t.lastSize[0],i=2*(e.titleHeight+t.axisTitlePixelOffset)/t.lastSize[1];t.barSize[0]=t.boxSize[0],t.barPosition[0]=t.boxPosition[0],t.barSize[1]=t.boxSize[1]-i,t.barPosition[1]=t.boxPosition[1],r[0]=n}return r},e.recomputeBarSegments=n=>{const r=e.computeBarSize(n);t.barSegments=[];const i=[0,0],o=t.vertical?1:0,a=t.vertical?.01:.02;function s(e,n){t.barSegments.push({corners:[[...i],[i[0]+r[0],i[1]],[i[0]+r[0],i[1]+r[1]],[i[0],i[1]+r[1]]],scalars:n,title:e}),i[o]+=r[o]+a}t.renderable.getDrawNanAnnotation()&&t.renderable.getScalarsToColors().getNanColor()&&s("NaN",[NaN,NaN,NaN,NaN]),t.renderable.getDrawBelowRangeSwatch()&&t.renderable.getScalarsToColors().getUseBelowRangeColor?.()&&s("Below",[-.1,-.1,-.1,-.1]);const l=t.renderable.getScalarsToColors().getUseAboveRangeColor?.();i[o]+=a;const c=r[o];r[o]=l?1-2*a-r[o]-i[o]:1-a-i[o],s("ticks",t.vertical?[0,0,.995,.995]:[0,.995,.995,0]),t.renderable.getDrawAboveRangeSwatch()&&l&&(r[o]=c,i[o]+=a,s("Above",[1.1,1.1,1.1,1.1]))};const n=new Float64Array(3);e.createPolyDataForOneLabel=(e,r,i,o,a,s)=>{const l=t._tmAtlas.get(e);if(!l)return;let c=s.ptIdx,u=s.cellIdx;n[0]=(.5*r[0]+.5)*t.lastSize[0],n[1]=(.5*r[1]+.5)*t.lastSize[1],n[2]=r[2],n[0]+=a[0],n[1]+=a[1];const d=[],p="vertical"===o?[1,0]:[0,1];"vertical"===o?(d[0]=l.width,d[1]=-l.height,"middle"===i[0]?n[1]-=l.width/2:"right"===i[0]&&(n[1]-=l.width),"middle"===i[1]?n[0]+=l.height/2:"top"===i[1]&&(n[0]+=l.height)):(d[0]=l.width,d[1]=l.height,"middle"===i[0]?n[0]-=l.width/2:"right"===i[0]&&(n[0]-=l.width),"middle"===i[1]?n[1]-=l.height/2:"top"===i[1]&&(n[1]-=l.height)),s.points[3*c]=n[0],s.points[3*c+1]=n[1],s.points[3*c+2]=n[2],s.tcoords[2*c]=l.tcoords[0],s.tcoords[2*c+1]=l.tcoords[1],c++,n[p[0]]+=d[0],s.points[3*c]=n[0],s.points[3*c+1]=n[1],s.points[3*c+2]=n[2],s.tcoords[2*c]=l.tcoords[2],s.tcoords[2*c+1]=l.tcoords[3],c++,n[p[1]]+=d[1],s.points[3*c]=n[0],s.points[3*c+1]=n[1],s.points[3*c+2]=n[2],s.tcoords[2*c]=l.tcoords[4],s.tcoords[2*c+1]=l.tcoords[5],c++,n[p[0]]-=d[0],s.points[3*c]=n[0],s.points[3*c+1]=n[1],s.points[3*c+2]=n[2],s.tcoords[2*c]=l.tcoords[6],s.tcoords[2*c+1]=l.tcoords[7],c++,s.polys[4*u]=3,s.polys[4*u+1]=c-4,s.polys[4*u+2]=c-3,s.polys[4*u+3]=c-2,u++,s.polys[4*u]=3,s.polys[4*u+1]=c-4,s.polys[4*u+2]=c-2,s.polys[4*u+3]=c-1,s.ptIdx+=4,s.cellIdx+=2};const r=new Float64Array(3);e.updatePolyDataForLabels=()=>{const n=e.getTickStrings().length+t.barSegments.length,i=4*n,o=2*n,a=new Float64Array(3*i),s=new Uint16Array(4*o),l=new Float32Array(2*i),u={ptIdx:0,cellIdx:0,polys:s,points:a,tcoords:l},d=t.vertical?0:1,p=t.vertical?1:0;r[2]=-.99;const f=t.vertical?["right","middle"]:["middle","bottom"];let h=[0,1];const m=[0,0];t.vertical?(m[0]=-t.tickLabelPixelOffset,t.topTitle?(r[0]=t.boxPosition[0]+.5*t.boxSize[0],r[1]=t.barPosition[1]+t.barSize[1],e.createPolyDataForOneLabel(t.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,t.axisTitlePixelOffset],u)):(r[0]=t.barPosition[0]+t.barSize[0],r[1]=t.barPosition[1]+.5*t.barSize[1],e.createPolyDataForOneLabel(t.renderable.getAxisLabel(),r,["middle","top"],"vertical",[t.axisTitlePixelOffset,0],u)),h=[-1,0]):(m[1]=t.tickLabelPixelOffset,r[0]=t.barPosition[0]+.5*t.barSize[0],r[1]=t.barPosition[1]+t.barSize[1],e.createPolyDataForOneLabel(t.renderable.getAxisLabel(),r,["middle","bottom"],"horizontal",[0,t.axisTitlePixelOffset],u)),r[d]=t.barPosition[d]+(.5*h[d]+.5)*t.barSize[d],r[p]=t.barPosition[p]+.5*t.barSize[p];let g=null;for(let n=0;n<t.barSegments.length;n++){const i=t.barSegments[n];"ticks"===i.title?g=i:(r[p]=t.barPosition[p]+.5*t.barSize[p]*(i.corners[2][p]+i.corners[0][p]),e.createPolyDataForOneLabel(i.title,r,f,"horizontal",m,u))}const v=t.barPosition[p]+t.barSize[p]*g.corners[0][p],y=t.barSize[p]*(g.corners[2][p]-g.corners[0][p]),b=e.getTicks(),x=e.getTickStrings();for(let n=0;n<b.length;n++){const i=(b[n]-t.lastTickBounds[0])/(t.lastTickBounds[1]-t.lastTickBounds[0]);r[p]=v+y*i,e.createPolyDataForOneLabel(x[n],r,f,"horizontal",m,u)}const A=c.Ay.newInstance({numberOfComponents:2,values:l,name:"TextureCoordinates"});t.tmPolyData.getPointData().setTCoords(A),t.tmPolyData.getPoints().setData(a,3),t.tmPolyData.getPoints().modified(),t.tmPolyData.getPolys().setData(s,1),t.tmPolyData.getPolys().modified(),t.tmPolyData.modified()},e.updatePolyDataForBarSegments=()=>{const e=t.renderable.getScalarsToColors();let n=0;t.renderable.getDrawNanAnnotation()&&e.getNanColor()&&(n+=1),t.renderable.getDrawBelowRangeSwatch()&&e.getUseBelowRangeColor?.()&&(n+=1),t.renderable.getDrawAboveRangeSwatch()&&e.getUseAboveRangeColor?.()&&(n+=1);const i=4*(1+n),o=i;let a=1;e.getVectorMode()===se.COMPONENT&&(a=e.getVectorComponent()+1);const s=new Float64Array(3*i),l=new Uint16Array(5*o),u=new Float32Array(i*a);let d=0,p=0;for(let e=0;e<t.barSegments.length;e++){const n=t.barSegments[e];for(let e=0;e<4;e++){r[0]=t.barPosition[0]+n.corners[e][0]*t.barSize[0],r[1]=t.barPosition[1]+n.corners[e][1]*t.barSize[1],s[3*d]=(.5*r[0]+.5)*t.lastSize[0],s[3*d+1]=(.5*r[1]+.5)*t.lastSize[1],s[3*d+2]=r[2];for(let r=0;r<a;r++)u[d*a+r]=t.lastTickBounds[0]+n.scalars[e]*(t.lastTickBounds[1]-t.lastTickBounds[0]);d++}l[5*p]=4,l[5*p+1]=d-4,l[5*p+2]=d-3,l[5*p+3]=d-2,l[5*p+4]=d-1,p++}const f=c.Ay.newInstance({numberOfComponents:a,values:u,name:"Scalars"});t.polyData.getPointData().setScalars(f),t.polyData.getPoints().setData(s,3),t.polyData.getPoints().modified(),t.polyData.getPolys().setData(l,1),t.polyData.getPolys().modified(),t.polyData.modified()}}(e,t)}),"vtkScalarBarActorHelper");function pe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,function(e){return{automated:!0,autoLayout:null,axisLabel:"Scalar Value",barPosition:[0,0],barSize:[0,0],boxPosition:[.88,-.92],boxSize:[.1,1.1],scalarToColors:null,axisTitlePixelOffset:36,axisTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:18,fontFamily:"serif"},tickLabelPixelOffset:14,tickTextStyle:{fontColor:"white",fontStyle:"normal",fontSize:14,fontFamily:"serif"},generateTicks:null,drawNanAnnotation:!0,drawBelowRangeSwatch:!0,drawAboveRangeSwatch:!0,...e}}(n)),t.autoLayout||(t.autoLayout=ce(0,t)),t.generateTicks||(t.generateTicks=ue()),s.Ay.extend(e,t,n),e.getProperty().setDiffuse(0),e.getProperty().setAmbient(1),r.m.setGet(e,t,["automated","autoLayout","axisTitlePixelOffset","axisLabel","scalarsToColors","tickLabelPixelOffset","generateTicks","drawNanAnnotation","drawBelowRangeSwatch","drawAboveRangeSwatch"]),r.m.get(e,t,["axisTextStyle","tickTextStyle"]),r.m.getArray(e,t,["barPosition","barSize","boxPosition","boxSize"]),r.m.setArray(e,t,["barPosition","barSize","boxPosition","boxSize"],2),function(e,t){t.classHierarchy.push("vtkScalarBarActor"),e.setTickTextStyle=n=>{t.tickTextStyle={...t.tickTextStyle,...n},e.modified()},e.setAxisTextStyle=n=>{t.axisTextStyle={...t.axisTextStyle,...n},e.modified()},e.resetAutoLayoutToDefault=()=>{e.setAutoLayout(ce(0,t))},e.resetGenerateTicksToDefault=()=>{e.setGenerateTicks(ue())}}(e,t)}var fe={newInstance:r.m.newInstance(pe,"vtkScalarBarActor"),extend:pe,newScalarBarActorHelper:de};const he={};function me(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,he,n),O.A.extend(e,t,n),t.scalarBarActorHelper=fe.newScalarBarActorHelper(),function(e,t){t.classHierarchy.push("vtkOpenGLScalarBarActor"),e.buildPass=n=>{n&&(t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t._openGLRenderWindow=t._openGLRenderer.getParent(),t.scalarBarActorHelper.getRenderable()||t.scalarBarActorHelper.setRenderable(t.renderable),e.prepareNodes(),e.addMissingNode(t.scalarBarActorHelper.getBarActor()),e.addMissingNode(t.scalarBarActorHelper.getTmActor()),e.removeUnusedNodes())},e.opaquePass=(e,n)=>{if(e){const e=t._openGLRenderer?t._openGLRenderer.getRenderable().getActiveCamera():null,n=t._openGLRenderer.getTiledSizeAndOrigin();t.scalarBarActorHelper.updateAPISpecificData([n.usize,n.vsize],e,t._openGLRenderWindow.getRenderable())}}}(e,t)}const ge=(0,r.n)(me,"vtkOpenGLScalarBarActor");(0,P.c9)("vtkScalarBarActor",ge);n(92530),n(79525),n(68464),n(26910),n(24210);var ve=n(46985),ye=n(50440);const{CoordinateSystem:be}=ve.Ay;const xe={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function Ae(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,xe,n),O.A.extend(e,t,n),t.keyMatricesTime={},r.m.obj(t.keyMatricesTime,{mtime:0}),t.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},r.m.get(e,t,["propID","keyMatricesTime"]),t.bufferShift=[0,0,0,0],function(e,t){t.classHierarchy.push("vtkWebGPUActor"),e.buildPass=n=>{n&&(t.WebGPURenderer=e.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),void 0===t.propID&&(t.propID=t.WebGPURenderWindow.getUniquePropID()),e.prepareNodes(),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes())},e.traverseOpaquePass=n=>{t.renderable&&t.renderable.getNestedVisibility()&&t.renderable.getIsOpaque()&&(!t.WebGPURenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.children[0]&&t.children[0].traverse(n),e.apply(n,!1))},e.traverseTranslucentPass=n=>{!t.renderable||!t.renderable.getNestedVisibility()||t.renderable.getIsOpaque()||t.WebGPURenderer.getSelector()&&!t.renderable.getNestedPickable()||(e.apply(n,!0),t.children[0]&&t.children[0].traverse(n),e.apply(n,!1))},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;t.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},e.getBufferShift=n=>(e.getKeyMatrices(n),t.bufferShift),e.getKeyMatrices=e=>{if(Math.max(t.renderable.getMTime(),e.getStabilizedTime())>t.keyMatricesTime.getMTime()){t.renderable.computeMatrix();const n=t.renderable.getMatrix();t.bufferShift[0]=n[3],t.bufferShift[1]=n[7],t.bufferShift[2]=n[11];const r=e.getStabilizedCenterByReference();t.renderable.getCoordinateSystem()===be.WORLD&&(t.bufferShift[0]-=r[0],t.bufferShift[1]-=r[1],t.bufferShift[2]-=r[2]),i.pB.transpose(t.keyMatrices.bcwc,n),t.renderable.getIsIdentity()?i.pB.identity(t.keyMatrices.normalMatrix):(i.pB.copy(t.keyMatrices.normalMatrix,t.keyMatrices.bcwc),t.keyMatrices.normalMatrix[3]=0,t.keyMatrices.normalMatrix[7]=0,t.keyMatrices.normalMatrix[11]=0,i.pB.invert(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix),i.pB.transpose(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix)),i.pB.translate(t.keyMatrices.bcwc,t.keyMatrices.bcwc,[-t.bufferShift[0],-t.bufferShift[1],-t.bufferShift[2]]),t.renderable.getCoordinateSystem()===be.WORLD?i.pB.translate(t.keyMatrices.bcsc,t.keyMatrices.bcwc,[-r[0],-r[1],-r[2]]):i.pB.copy(t.keyMatrices.bcsc,t.keyMatrices.bcwc),t.keyMatricesTime.modified()}return t.keyMatrices}}(e,t)}const Ce=r.m.newInstance(Ae);(0,ye.c9)("vtkActor",Ce);const{CoordinateSystem:Te}=ve.Ay;const Se={keyMatricesTime:null,keyMatrices:null,propID:void 0,bufferShift:void 0};function we(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Se,n),O.A.extend(e,t,n),t.keyMatricesTime={},r.m.obj(t.keyMatricesTime,{mtime:0}),t.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},r.m.get(e,t,["propID","keyMatricesTime"]),t.bufferShift=[0,0,0,0],function(e,t){t.classHierarchy.push("vtkWebGPUActor2D"),e.buildPass=n=>{n&&(t.WebGPURenderer=e.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),void 0===t.propID&&(t.propID=t.WebGPURenderWindow.getUniquePropID()),e.prepareNodes(),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes())},e.traverseOpaquePass=n=>{t.renderable&&t.renderable.getNestedVisibility()&&t.renderable.getIsOpaque()&&(!t.WebGPURenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.children[0]&&t.children[0].traverse(n),e.apply(n,!1))},e.traverseTranslucentPass=n=>{!t.renderable||!t.renderable.getNestedVisibility()||t.renderable.getIsOpaque()||t.WebGPURenderer.getSelector()&&!t.renderable.getNestedPickable()||(e.apply(n,!0),t.children[0]&&t.children[0].traverse(n),e.apply(n,!1))},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;t.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},e.getBufferShift=n=>(e.getKeyMatrices(n),t.bufferShift),e.getKeyMatrices=e=>{if(Math.max(t.renderable.getMTime(),e.getStabilizedTime())>t.keyMatricesTime.getMTime()){t.bufferShift[0]=0,t.bufferShift[1]=0,t.bufferShift[2]=0;const n=e.getStabilizedCenterByReference();t.renderable.getCoordinateSystem()===Te.WORLD&&(t.bufferShift[0]-=n[0],t.bufferShift[1]-=n[1],t.bufferShift[2]-=n[2]),i.pB.identity(t.keyMatrices.bcwc),i.pB.identity(t.keyMatrices.normalMatrix),i.pB.translate(t.keyMatrices.bcwc,t.keyMatrices.bcwc,[-t.bufferShift[0],-t.bufferShift[1],-t.bufferShift[2]]),t.renderable.getCoordinateSystem()===Te.WORLD?i.pB.translate(t.keyMatrices.bcsc,t.keyMatrices.bcwc,[-n[0],-n[1],-n[2]]):i.pB.copy(t.keyMatrices.bcsc,t.keyMatrices.bcwc),t.keyMatricesTime.modified()}return t.keyMatrices}}(e,t)}const _e=r.m.newInstance(we);(0,ye.c9)("vtkActor2D",_e);const Ie={};function Ee(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Ie,n),O.A.extend(e,t,n),t.CubeAxesActorHelper=D.newCubeAxesActorHelper(),function(e,t){t.classHierarchy.push("vtkWebGPUCubeAxesActor"),e.buildPass=n=>{n&&(t.WebGPURenderer=e.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getParent(),t.CubeAxesActorHelper.getRenderable()||t.CubeAxesActorHelper.setRenderable(t.renderable),e.prepareNodes(),e.addMissingNode(t.CubeAxesActorHelper.getTmActor()),e.addMissingNode(t.renderable.getGridActor()),e.removeUnusedNodes())},e.opaquePass=(e,n)=>{if(e){const e=t.WebGPURenderer?t.WebGPURenderer.getRenderable().getActiveCamera():null,n=t.WebGPURenderer.getTiledSizeAndOrigin();t.CubeAxesActorHelper.updateAPISpecificData([n.usize,n.vsize],e,t.WebGPURenderWindow.getRenderable())}}}(e,t)}const De=(0,r.n)(Ee,"vtkWebGPUCubeAxesActor");(0,ye.c9)("vtkCubeAxesActor",De);var Oe=n(49767),Pe=n(89585),Re=n(71995);const{DisplayLocation:Ne}=J;const Me={color:[1,1,1],opacity:1,pointSize:1,lineWidth:1,representation:Re.YL.SURFACE,displayLocation:Ne.FOREGROUND};function Le(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Me,n),r.m.obj(e,t),r.m.setGet(e,t,["opacity","lineWidth","pointSize","displayLocation","representation"]),r.m.setGetArray(e,t,["color"],3),function(e,t){t.classHierarchy.push("vtkProperty2D"),e.setDisplayLocationToBackground=()=>e.setDisplayLocation(Ne.BACKGROUND),e.setDisplayLocationToForeground=()=>e.setDisplayLocation(Ne.FOREGROUND),e.setRepresentationToWireframe=()=>e.setRepresentation(Re.YL.WIREFRAME),e.setRepresentationToSurface=()=>e.setRepresentation(Re.YL.SURFACE),e.setRepresentationToPoints=()=>e.setRepresentation(Re.YL.POINTS),e.getRepresentationAsString=()=>r.m.enumToString(Re.YL,t.representation)}(e,t)}var Fe={newInstance:r.m.newInstance(Le,"vtkProperty2D"),extend:Le,...J},Be=n(9806),Ve=n(83259),ke=n(32603),Ue=n(57372);const{BufferUsage:Ge,PrimitiveTypes:ze}=Oe.Ay,{Representation:We}=Pe.Ay,{ScalarMode:je}=u.Ay,{CoordinateSystem:He}=ve.Ay,{DisplayLocation:Ke}=Fe;function qe(e){return e.indexOf("edge")>=0}const $e={is2D:!1,cellArray:null,currentInput:null,cellOffset:0,primitiveType:0,colorTexture:null,renderEncoder:null,textures:null};function Xe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,$e,n),ke.Ay.extend(e,t,n),t.fragmentShaderTemplate='\nstruct PBRData {\n  diffuse: vec3<f32>,\n  specular: vec3<f32>,\n}\n\n// Dot product with the max already in it\nfn mdot(a: vec3<f32>, b: vec3<f32>) -> f32 {\n  return max(0.0, dot(a, b));\n}\n// Dot product with a max in it that does not allow for negative values\n// Physically based rendering is accurate as long as normals are accurate,\n// however this is pretty often not the case. In order to prevent negative\n// values from ruining light calculations and creating zones of zero light,\n// this remapping is used, which smoothly clamps the dot product between\n// zero and one while still maintaining a good amount of accuracy.\nfn cdot(a: vec3<f32>, b: vec3<f32>) -> f32 {\n  var d: f32 = max(0.0, dot(a, b));\n  d = pow((d + 1.0) / 2.0, 2.6);\n  return d;\n}\n\n// Lambertian diffuse model\nfn lambertDiffuse(base: vec3<f32>, N: vec3<f32>, L: vec3<f32>) -> vec3<f32> {\n  var pi: f32 = 3.14159265359; \n  var NdotL: f32 = mdot(N, L);\n  NdotL = pow(NdotL, 1.5);\n  return (base/pi)*NdotL;\n}\n\n// Yasuhiro Fujii improvement on the Oren-Nayar model\n// https://mimosa-pudica.net/improved-oren-nayar.html\n// p is surface color, o is roughness\nfn fujiiOrenNayar(p: vec3<f32>, o: f32, N: vec3<f32>, L: vec3<f32>, V: vec3<f32>) -> vec3<f32> {\n  var invpi: f32 = 0.31830988618; // 1/pi\n\n  var o2 = o*o;\n  var NdotL: f32 = mdot(N, L);\n  NdotL = pow(NdotL, 1.5); // Less physically accurate, but hides the "seams" between lights better\n\n  var NdotV: f32 = mdot(N, V);\n  var LdotV: f32 = mdot(L, V);\n\n  var s: f32 = LdotV - NdotL*NdotV;\n  var t: f32 = mix(1.0, max(NdotL, NdotV), step(0.0, s)); // Mix with step is the equivalent of an if statement\n  var A: vec3<f32> = 0.5*(o2 / (o2 + 0.33)) + 0.17*p*(o2 / (o2 + 0.13));\n  A = invpi*(1 - A);\n  var B: f32 = 0.45*(o2 / (o2 + 0.09));\n  B = invpi*B;\n\n  return p*NdotL*(A + B*(s/t));\n}\n\n// Fresnel portion of BRDF (IOR only, simplified)\nfn schlickFresnelIOR(V: vec3<f32>, N: vec3<f32>, ior: f32, k: f32) -> f32 {\n  var NdotV: f32 = mdot(V, N);\n  var F0: f32 = (pow((ior - 1.0), 2.0) + k*k) / (pow((ior + 1.0), 2.0) + k*k); // This takes into account the roughness, which the other one does not\n  return F0 + (1.0 - F0) * pow((1.0-NdotV), 5.0);\n}\n\n// Fresnel portion of BRDF (Color ior, better)\nfn schlickFresnelRGB(V: vec3<f32>, N: vec3<f32>, F0: vec3<f32>) -> vec3<f32> {\n  var NdotV: f32 = mdot(V, N);\n  return F0 + (1.0 - F0) * pow((1-NdotV), 5.0);\n}\n\n// Normal portion of BRDF\n// https://learnopengl.com/PBR/Theory\n// Trowbridge-Reitz GGX functions: normal, halfway, roughness^2\nfn trGGX(N: vec3<f32>, H: vec3<f32>, a: f32) -> f32 {\n  var pi: f32 = 3.14159265359; \n\n  var a2: f32 = a*a;\n  var NdotH = mdot(N, H);\n  var NdotH2 = NdotH*NdotH;\n  \n  var denom: f32 = NdotH2 * (a2 - 1.0) + 1.0;\n\n  return a2 / max((pi*denom*denom), 0.000001);\n}\n\n// A VERY bad approximation of anisotropy. Real anisotropic calculations require tangent and bitangent\nfn anisotrophicTrGGX(N: vec3<f32>, H: vec3<f32>, O: vec3<f32>, s: f32, a: f32) -> f32 {\n  var Op: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(O) * s, 0.)).xyz;\n\n  var ggx1: f32 = trGGX(N + Op*s, H, a);\n  var ggx2: f32 = trGGX(N - Op*s, H, a);\n  return (0.5 * ggx1 + 0.5 * ggx2);\n}\n\n// Geometry portion of BRDF\nfn schlickGGX(N: vec3<f32>, X: vec3<f32>, k: f32) -> f32 {\n  var NdotX = cdot(N, X);\n  return NdotX / max(0.000001, (NdotX*(1.0-k) + k));\n}\n\nfn smithSurfaceRoughness(N: vec3<f32>, V: vec3<f32>, L: vec3<f32>, k: f32) -> f32 {\n  var ggx1: f32 = min(1.0, schlickGGX(N, V, k));\n  var ggx2: f32 = min(1.0, schlickGGX(N, L, k));\n  return ggx1*ggx2;\n}\n\n// BRDF Combination\nfn cookTorrance(D: f32, F: f32, G: f32, N: vec3<f32>, V: vec3<f32>, L: vec3<f32>) -> f32 {\n  var num: f32 = D*F*G;\n  var denom: f32 = 4*cdot(V, N)*cdot(L, N);\n\n  return num / max(denom, 0.000001);\n}\n\n// Different lighting calculations for different light sources\nfn calcDirectionalLight(N: vec3<f32>, V: vec3<f32>, ior: f32, roughness: f32, metallic: f32, direction: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {  \n  var L: vec3<f32> = normalize(direction); // Light Vector\n  var H: vec3<f32> = normalize(L + V); // Halfway Vector\n\n  var alpha = roughness*roughness;\n  var k: f32 = alpha*alpha / 2;\n\n  var D: f32 = trGGX(N, H, alpha); // Distribution\n  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel\n  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry\n\n  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L); // Fresnel term is replaced with 1 because it is added later\n  var incoming: vec3<f32> = color;\n  var angle: f32 = mdot(L, N);\n  angle = pow(angle, 1.5);\n\n  var specular: vec3<f32> = brdf*incoming*angle;\n  // Oren-Nayar gives a clay-like effect when fully rough which some people may not want, so it might be better to give a separate\n  // control property for the diffuse vs specular roughness\n  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V); \n  // Stores the specular and diffuse separately to allow for finer post processing\n  var out = PBRData(diffuse, specular);\n  \n  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)\n}\n\n// TODO: find some way to reduce the number of arguments going in here\nfn calcPointLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {\n  var L: vec3<f32> = normalize(position - fragPos); // Light Vector\n  var H: vec3<f32> = normalize(L + V); // Halfway Vector\n  var dist = distance(position, fragPos);\n\n  var alpha = roughness*roughness;\n  var k: f32 = alpha*alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8\n\n  var D: f32 = trGGX(N, H, alpha); // Distribution\n  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel\n  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry\n\n  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);\n  var incoming: vec3<f32> = color * (1.0 / (dist*dist));\n  var angle: f32 = mdot(L, N);\n  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources\n\n  var specular: vec3<f32> = brdf*incoming*angle;\n  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);\n\n  // Stores the specular and diffuse separately to allow for finer post processing\n  // Could also be done (propably more properly) with a struct\n  var out = PBRData(diffuse, specular);\n  \n  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)\n}\n\n// For a reason unknown to me, spheres dont seem to behave propperly with head-on spot lights\nfn calcSpotLight(N: vec3<f32>, V: vec3<f32>, fragPos: vec3<f32>, ior: f32, roughness: f32, metallic: f32, position: vec3<f32>, direction: vec3<f32>, cones: vec2<f32>, color: vec3<f32>, base: vec3<f32>) -> PBRData {\n  var L: vec3<f32> = normalize(position - fragPos);\n  var H: vec3<f32> = normalize(L + V); // Halfway Vector\n  var dist = distance(position, fragPos);\n\n  var alpha = roughness*roughness;\n  var k: f32 = alpha*alpha / 2.0; // could also be pow(alpha + 1.0, 2) / 8\n\n  var D: f32 = trGGX(N, H, alpha); // Distribution\n  // var F: f32 = schlickFresnelIOR(V, N, ior, k); // Fresnel\n  var G: f32 = smithSurfaceRoughness(N, V, L, k); // Geometry\n\n  var brdf: f32 = cookTorrance(D, 1.0, G, N, V, L);\n  \n  // Cones.x is the inner phi and cones.y is the outer phi\n  var theta: f32 = mdot(normalize(direction), L);\n  var epsilon: f32 = cones.x - cones.y;\n  var intensity: f32 = (theta - cones.y) / epsilon;\n  intensity = clamp(intensity, 0.0, 1.0);\n  intensity /= dist*dist;\n\n  var incoming: vec3<f32> = color * intensity;\n\n  var angle: f32 = mdot(L, N);\n  angle = pow(angle, 1.5); // Smoothing factor makes it less accurate, but reduces ugly "seams" bewteen light sources\n\n  var specular: vec3<f32> = brdf*incoming*angle;\n  var diffuse: vec3<f32> = incoming*fujiiOrenNayar(base, roughness, N, L, V);\n\n  // Stores the specular and diffuse separately to allow for finer post processing\n  // Could also be done (propably more properly) with a struct\n  var out = PBRData(diffuse, specular);\n  \n  return out; // Returns angle along with color of light so the final color can be multiplied by angle as well (creates black areas)\n}\n\n// Environment mapping stuff\n// Takes in a vector and converts it to an equivalent coordinate in a rectilinear texture. Should be replaced with cubemaps at some point\nfn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {\n  var tau: f32 = 6.28318530718;\n  var pi: f32 = 3.14159265359;\n  var out: vec2<f32> = vec2<f32>(0.0);\n\n  out.x = atan2(dir.z, dir.x) / tau;\n  out.x += 0.5;\n\n  var phix: f32 = length(vec2(dir.x, dir.z));\n  out.y = atan2(dir.y, phix) / pi + 0.5;\n\n  return out;\n}\n\n//VTK::Renderer::Dec\n\n//VTK::Color::Dec\n\n//VTK::TCoord::Dec\n\n// optional surface normal declaration\n//VTK::Normal::Dec\n\n//VTK::Select::Dec\n\n//VTK::RenderEncoder::Dec\n\n//VTK::Mapper::Dec\n\n//VTK::IOStructs::Dec\n\n@fragment\nfn main(\n//VTK::IOStructs::Input\n)\n//VTK::IOStructs::Output\n{\n  var output : fragmentOutput;\n\n  // Temporary ambient, diffuse, and opacity\n  var ambientColor: vec4<f32> = mapperUBO.AmbientColor;\n  var diffuseColor: vec4<f32> = mapperUBO.DiffuseColor;\n  var opacity: f32 = mapperUBO.Opacity;\n\n  // This should be declared somewhere else\n  var _diffuseMap: vec4<f32> = vec4<f32>(1.0);\n  var _roughnessMap: vec4<f32> = vec4<f32>(1.0);\n  var _metallicMap: vec4<f32> = vec4<f32>(1.0);\n  var _normalMap: vec4<f32> = vec4<f32>(0.0, 0.0, 1.0, 0.0); // normal map was setting off the normal vector detection in fragment\n  var _ambientOcclusionMap: vec4<f32> = vec4<f32>(1.);\n  var _emissionMap: vec4<f32> = vec4<f32>(0.);\n\n  //VTK::Color::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Normal::Impl\n\n  var computedColor: vec4<f32> = vec4<f32>(diffuseColor.rgb, 1.0);\n\n  //VTK::Light::Impl\n\n  //VTK::Select::Impl\n\n  if (computedColor.a == 0.0) { discard; };\n\n  //VTK::Position::Impl\n\n  //VTK::RenderEncoder::Impl\n\n  return output;\n}\n',t.vertexShaderTemplate="\n//VTK::Renderer::Dec\n\n//VTK::Color::Dec\n\n//VTK::Normal::Dec\n\n//VTK::TCoord::Dec\n\n//VTK::Select::Dec\n\n//VTK::Mapper::Dec\n\n//VTK::IOStructs::Dec\n\n@vertex\nfn main(\n//VTK::IOStructs::Input\n)\n//VTK::IOStructs::Output\n{\n  var output : vertexOutput;\n\n  var vertex: vec4<f32> = vertexBC;\n\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Select::Impl\n\n  //VTK::Position::Impl\n\n  return output;\n}\n",t._tmpMat3=i.w0.identity(new Float64Array(9)),t._tmpMat4=i.pB.identity(new Float64Array(16)),t.UBO=Ve.Ay.newInstance({label:"mapperUBO"}),t.UBO.addEntry("BCWCMatrix","mat4x4<f32>"),t.UBO.addEntry("BCSCMatrix","mat4x4<f32>"),t.UBO.addEntry("MCWCNormals","mat4x4<f32>"),t.UBO.addEntry("AmbientColor","vec4<f32>"),t.UBO.addEntry("DiffuseColor","vec4<f32>"),t.UBO.addEntry("EdgeColor","vec4<f32>"),t.UBO.addEntry("SpecularColor","vec4<f32>"),t.UBO.addEntry("AmbientIntensity","f32"),t.UBO.addEntry("DiffuseIntensity","f32"),t.UBO.addEntry("Roughness","f32"),t.UBO.addEntry("Metallic","f32"),t.UBO.addEntry("Ambient","f32"),t.UBO.addEntry("Normal","f32"),t.UBO.addEntry("Emission","f32"),t.UBO.addEntry("NormalStrength","f32"),t.UBO.addEntry("BaseIOR","f32"),t.UBO.addEntry("SpecularIntensity","f32"),t.UBO.addEntry("LineWidth","f32"),t.UBO.addEntry("Opacity","f32"),t.UBO.addEntry("ZValue","f32"),t.UBO.addEntry("PropID","u32"),t.UBO.addEntry("ClipNear","f32"),t.UBO.addEntry("ClipFar","f32"),t.UBO.addEntry("Time","u32"),(0,r.e)(e,t,["cellArray","currentInput","cellOffset","is2D","primitiveType","renderEncoder"]),t.textures=[],function(e,t){t.classHierarchy.push("vtkWebGPUCellArrayMapper"),e.buildPass=n=>{n&&(t.is2D?(t.WebGPUActor=e.getFirstAncestorOfType("vtkWebGPUActor2D"),t.forceZValue=!0):(t.WebGPUActor=e.getFirstAncestorOfType("vtkWebGPUActor"),t.forceZValue=!1),t.coordinateSystem=t.WebGPUActor.getRenderable().getCoordinateSystem(),t.useRendererMatrix=t.coordinateSystem!==He.DISPLAY,t.WebGPURenderer=t.WebGPUActor.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getParent(),t.device=t.WebGPURenderWindow.getDevice())},e.translucentPass=n=>{n&&(e.prepareToDraw(t.WebGPURenderer.getRenderEncoder()),t.renderEncoder.registerDrawCallback(t.pipeline,e.draw))},e.opaquePass=n=>{n&&(e.prepareToDraw(t.WebGPURenderer.getRenderEncoder()),t.renderEncoder.registerDrawCallback(t.pipeline,e.draw))},e.updateUBO=()=>{const n=t.WebGPUActor.getRenderable().getProperty(),r=t.UBO.getSendTime();if(e.getMTime()>r||n.getMTime()>r||t.renderable.getMTime()>r){const e=t.WebGPUActor.getKeyMatrices(t.WebGPURenderer);if(t.UBO.setArray("BCWCMatrix",e.bcwc),t.UBO.setArray("BCSCMatrix",e.bcsc),t.UBO.setArray("MCWCNormals",e.normalMatrix),t.is2D){t.UBO.setValue("ZValue",t.WebGPUActor.getRenderable().getProperty().getDisplayLocation()===Ke.FOREGROUND?1:0);const e=n.getColorByReference();t.UBO.setValue("AmbientIntensity",1),t.UBO.setArray("DiffuseColor",[e[0],e[1],e[2],1]),t.UBO.setValue("DiffuseIntensity",0),t.UBO.setValue("SpecularIntensity",0)}else{let e=n.getAmbientColorByReference();t.UBO.setValue("AmbientIntensity",n.getAmbient()),t.UBO.setArray("AmbientColor",[e[0],e[1],e[2],1]),t.UBO.setValue("DiffuseIntensity",n.getDiffuse()),e=n.getDiffuseColorByReference(),t.UBO.setArray("DiffuseColor",[e[0],e[1],e[2],1]),t.UBO.setValue("Roughness",n.getRoughness()),t.UBO.setValue("BaseIOR",n.getBaseIOR()),t.UBO.setValue("Metallic",n.getMetallic()),t.UBO.setValue("NormalStrength",n.getNormalStrength()),t.UBO.setValue("Emission",n.getEmission()),t.UBO.setValue("SpecularIntensity",n.getSpecular()),e=n.getSpecularColorByReference(),t.UBO.setArray("SpecularColor",[e[0],e[1],e[2],1])}const r=n.getEdgeColorByReference?.();r&&t.UBO.setArray("EdgeColor",[r[0],r[1],r[2],1]),t.UBO.setValue("LineWidth",n.getLineWidth()),t.UBO.setValue("Opacity",n.getOpacity()),t.UBO.setValue("PropID",t.WebGPUActor.getPropID());const i=t.WebGPURenderWindow.getDevice();t.UBO.sendIfNeeded(i)}},e.haveWideLines=()=>{const e=t.WebGPUActor.getRenderable(),n=e.getProperty().getRepresentation();return!(e.getProperty().getLineWidth()<=1)&&t.primitiveType!==ze.Verts&&(t.primitiveType!==ze.Triangles&&t.primitiveType!==ze.TriangleStrips||n===We.WIREFRAME)},e.replaceShaderPosition=(n,r,i)=>{const o=r.getShaderDescription("vertex");o.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),o.hasOutput("vertexVC")||o.addOutput("vec4<f32>","vertexVC");let a=o.getCode();t.useRendererMatrix?(a=Be.Ay.substitute(a,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = rendererUBO.SCPCMatrix*mapperUBO.BCSCMatrix*vertexBC;","    output.vertexVC = rendererUBO.SCVCMatrix * mapperUBO.BCSCMatrix * vec4<f32>(vertexBC.xyz, 1.0);","//VTK::Position::Impl"]).result,t.forceZValue&&(a=Be.Ay.substitute(a,"//VTK::Position::Impl",["pCoord = vec4<f32>(pCoord.xyz/pCoord.w, 1.0);","pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)):(a=Be.Ay.substitute(a,"//VTK::Position::Impl",["    var pCoord: vec4<f32> = mapperUBO.BCSCMatrix*vertexBC;","    pCoord.x = 2.0* pCoord.x / rendererUBO.viewportSize.x - 1.0;","    pCoord.y = 2.0* pCoord.y / rendererUBO.viewportSize.y - 1.0;","    pCoord.z = 0.5 - 0.5 * pCoord.z;","//VTK::Position::Impl"]).result,t.forceZValue&&(a=Be.Ay.substitute(a,"//VTK::Position::Impl",["    pCoord.z = mapperUBO.ZValue;","//VTK::Position::Impl"]).result)),e.haveWideLines()&&(o.addBuiltinInput("u32","@builtin(instance_index) instanceIndex"),a=Be.Ay.substitute(a,"//VTK::Position::Impl",["    var tmpPos: vec4<f32> = pCoord;","    var numSteps: f32 = ceil(mapperUBO.LineWidth - 1.0);","    var offset: f32 = (mapperUBO.LineWidth - 1.0) * (f32(input.instanceIndex / 2u) - numSteps/2.0) / numSteps;","    var tmpPos2: vec3<f32> = tmpPos.xyz / tmpPos.w;","    tmpPos2.x = tmpPos2.x + 2.0 * (f32(input.instanceIndex) % 2.0) * offset / rendererUBO.viewportSize.x;","    tmpPos2.y = tmpPos2.y + 2.0 * (f32(input.instanceIndex + 1u) % 2.0) * offset / rendererUBO.viewportSize.y;","    tmpPos2.z = min(1.0, tmpPos2.z + 0.00001);","    pCoord = vec4<f32>(tmpPos2.xyz * tmpPos.w, tmpPos.w);","//VTK::Position::Impl"]).result),a=Be.Ay.substitute(a,"//VTK::Position::Impl",["    output.Position = pCoord;"]).result,o.setCode(a)},t.shaderReplacements.set("replaceShaderPosition",e.replaceShaderPosition),e.replaceShaderNormal=(e,n,r)=>{const i=r.getBuffer("normalMC"),o=t.WebGPUActor.getRenderable();if(i){const e=n.getShaderDescription("vertex");e.hasOutput("normalVC")||e.addOutput("vec3<f32>","normalVC",i.getArrayInformation()[0].interpolation),e.hasOutput("tangentVC")||e.addOutput("vec3<f32>","tangentVC",i.getArrayInformation()[0].interpolation),e.hasOutput("bitangentVC")||e.addOutput("vec3<f32>","bitangentVC",i.getArrayInformation()[0].interpolation);let t=e.getCode();t=Be.Ay.substitute(t,"//VTK::Normal::Impl",["  output.normalVC = normalize((rendererUBO.WCVCNormals * mapperUBO.MCWCNormals * normalMC).xyz);","  var c1: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 0, 1));","  var c2: vec3<f32> = cross(output.normalVC, vec3<f32>(0, 1, 0));","  var tangent: vec3<f32> = mix(c1, c2, distance(c1, c2));","  output.tangentVC = normalize(tangent);","  output.bitangentVC = normalize(cross(output.normalVC, tangent));"]).result,e.setCode(t);const r=n.getShaderDescription("fragment");t=r.getCode(),t=o.getProperty().getNormalTexture()?Be.Ay.substitute(t,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  var tangent: vec3<f32> = input.tangentVC;","  var bitangent: vec3<f32> = input.bitangentVC;","  var TCVCMatrix: mat3x3<f32> = mat3x3<f32>(","    tangent.x, bitangent.x, normal.x,","    tangent.y, bitangent.y, normal.y,","    tangent.z, bitangent.z, normal.z,","  );","  var mappedNormal: vec3<f32> = TCVCMatrix * (_normalMap.xyz * 2 - 1);","  normal = mix(normal, mappedNormal, mapperUBO.NormalStrength);","  normal = normalize(normal);"]).result:Be.Ay.substitute(t,"//VTK::Normal::Impl",["  var normal: vec3<f32> = input.normalVC;","  if (!input.frontFacing) { normal = -normal; }","  normal = normalize(normal);"]).result,r.setCode(t)}},t.shaderReplacements.set("replaceShaderNormal",e.replaceShaderNormal),e.replaceShaderLight=(e,n,r)=>{if(e.includes("sel"))return;const i=n.getShaderDescription("vertex");i.hasOutput("vertexVC")||i.addOutput("vec4<f32>","vertexVC");const o=t.WebGPURenderer.getRenderable(),a=n.getShaderDescription("fragment");let s=a.getCode();if(!s.includes("var normal:")||!t.useRendererMatrix||qe(e)||t.is2D||e.includes("sel"))s=Be.Ay.substitute(s,"//VTK::Light::Impl",["  var diffuse: vec3<f32> = diffuseColor.rgb;","  var specular: vec3<f32> = mapperUBO.SpecularColor.rgb * mapperUBO.SpecularColor.a;","  computedColor = vec4<f32>(diffuse * _diffuseMap.rgb, mapperUBO.Opacity);"]).result,a.setCode(s);else{const e=["  var pi: f32 = 3.14159265359;","  var fragPos: vec3<f32> = vec3<f32>(input.vertexVC.xyz);","  var V: vec3<f32> = mix(normalize(-fragPos), vec3<f32>(0, 0, 1), f32(rendererUBO.cameraParallel)); // View Vector","  var baseColor: vec3<f32> = _diffuseMap.rgb * diffuseColor.rgb;","  var roughness: f32 = max(0.000001, mapperUBO.Roughness * _roughnessMap.r);","  var metallic: f32 = mapperUBO.Metallic * _metallicMap.r;","  var alpha: f32 = roughness*roughness;","  var ior: f32 = mapperUBO.BaseIOR;","  var k: f32 = alpha*alpha / 2;","  var diffuse: vec3<f32> = vec3<f32>(0.);","  var specular: vec3<f32> = vec3<f32>(0.);","  var emission: vec3<f32> = _emissionMap.rgb * mapperUBO.Emission;","  {","    var i: i32 = 0;","    loop {","      if !(i < rendererUBO.LightCount) { break; }","      switch (i32(rendererLightSSBO.values[i].LightData.x)) {","         // Point Light","         case 0 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var calculated: PBRData = calcPointLight(normal, V, fragPos, ior, roughness, metallic, pos, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","          }","         // Directional light","         case 1 {","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var calculated: PBRData = calcDirectionalLight(normal, V, ior, roughness, metallic, dir, color, baseColor); // diffuseColor.rgb needs to be fixed with a more dynamic diffuse color","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         // Spot Light","         case 2 {","           var color: vec3<f32> = rendererLightSSBO.values[i].LightColor.rgb * rendererLightSSBO.values[i].LightColor.w;","           var pos: vec3<f32> = (rendererLightSSBO.values[i].LightPos).xyz;","           var dir: vec3<f32> = (rendererUBO.WCVCNormals * vec4<f32>(normalize(rendererLightSSBO.values[i].LightDir.xyz), 0.)).xyz;","           dir = normalize(dir);","           var cones: vec2<f32> = vec2<f32>(rendererLightSSBO.values[i].LightData.y, rendererLightSSBO.values[i].LightData.z);","           var calculated: PBRData = calcSpotLight(normal, V, fragPos, ior, roughness, metallic, pos, dir, cones, color, baseColor);","           diffuse += max(vec3<f32>(0), calculated.diffuse);","           specular += max(vec3<f32>(0), calculated.specular);","         }","         default { continue; }","       }","      continuing { i++; }","    }","  }","  var fresnel: f32 = schlickFresnelIOR(V, normal, ior, k); // Fresnel","  fresnel = min(1.0, fresnel);","  // This could be controlled with its own variable (that isnt base color) for better artistic control","  var fresnelMetallic: vec3<f32> = schlickFresnelRGB(V, normal, baseColor); // Fresnel for metal, takes color into account","  var kS: vec3<f32> = mix(vec3<f32>(fresnel), fresnelMetallic, metallic);","  kS = min(vec3<f32>(1.0), kS);","  var kD: vec3<f32> = (1.0 - kS) * (1.0 - metallic);","  var PBR: vec3<f32> = mapperUBO.DiffuseIntensity*kD*diffuse + kS*specular;","  PBR += emission;","  computedColor = vec4<f32>(PBR, mapperUBO.Opacity);"];o.getEnvironmentTexture()?.getImageLoaded()&&e.push("  // To get diffuse IBL, the texture is sampled with normals in worldspace","  var diffuseIBLCoords: vec3<f32> = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(normal, 1.)).xyz;","  var diffuseCoords: vec2<f32> = vecToRectCoord(diffuseIBLCoords);","  // To get specular IBL, the texture is sampled as the worldspace reflection between the normal and view vectors","  // Reflections are first calculated in viewspace, then converted to worldspace to sample the environment","  var VreflN: vec3<f32> = normalize(reflect(-V, normal));","  var reflectionIBLCoords = (transpose(rendererUBO.WCVCNormals) * vec4<f32>(VreflN, 1.)).xyz;","  var specularCoords: vec2<f32> = vecToRectCoord(reflectionIBLCoords);","  var diffuseIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, diffuseCoords, rendererUBO.MaxEnvironmentMipLevel);","  var level = roughness * rendererUBO.MaxEnvironmentMipLevel;","  var specularIBL = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, specularCoords, level);","  var specularIBLContribution: vec3<f32> = specularIBL.rgb*rendererUBO.BackgroundSpecularStrength;","  computedColor += vec4<f32>(specularIBLContribution*kS, 0);","  var diffuseIBLContribution: vec3<f32> = diffuseIBL.rgb*rendererUBO.BackgroundDiffuseStrength;","  diffuseIBLContribution *= baseColor * _ambientOcclusionMap.rgb;","  computedColor += vec4<f32>(diffuseIBLContribution*kD, 0);"),s=Be.Ay.substitute(s,"//VTK::Light::Impl",e).result,a.setCode(s)}},t.shaderReplacements.set("replaceShaderLight",e.replaceShaderLight),e.replaceShaderColor=(e,t,n)=>{if(qe(e)){const e=t.getShaderDescription("fragment");let n=e.getCode();return n=Be.Ay.substitute(n,"//VTK::Color::Impl",["ambientColor = mapperUBO.EdgeColor;","diffuseColor = mapperUBO.EdgeColor;"]).result,void e.setCode(n)}const r=n.getBuffer("colorVI");if(!r)return;const i=t.getShaderDescription("vertex");i.addOutput("vec4<f32>","color",r.getArrayInformation()[0].interpolation);let o=i.getCode();o=Be.Ay.substitute(o,"//VTK::Color::Impl",["  output.color = colorVI;"]).result,i.setCode(o);const a=t.getShaderDescription("fragment");o=a.getCode(),o=Be.Ay.substitute(o,"//VTK::Color::Impl",["ambientColor = input.color;","diffuseColor = input.color;","opacity = mapperUBO.Opacity * input.color.a;"]).result,a.setCode(o)},t.shaderReplacements.set("replaceShaderColor",e.replaceShaderColor),e.replaceShaderTCoord=(e,n,r)=>{if(!r.hasAttribute("tcoord"))return;const i=n.getShaderDescription("vertex"),o=r.getBuffer("tcoord"),a=Ue.A.getNumberOfComponentsFromBufferFormat(o.getArrayInformation()[0].format);let s=i.getCode();i.addOutput(`vec${a}<f32>`,"tcoordVS"),s=Be.Ay.substitute(s,"//VTK::TCoord::Impl",["  output.tcoordVS = tcoord;"]).result,i.setCode(s);const l=n.getShaderDescription("fragment");s=l.getCode();const c=t.WebGPUActor.getRenderable(),u=e=>!!e&&e.getDimensionality()===a,d=[];(c.getProperty().getDiffuseTexture?.()?.getImageLoaded()||c.getTextures()[0]||t.colorTexture)&&(u(c.getProperty().getDiffuseTexture?.())||u(c.getTextures()[0])||u(t.colorTexture))&&d.push("_diffuseMap = textureSample(DiffuseTexture, DiffuseTextureSampler, input.tcoordVS);"),c.getProperty().getRoughnessTexture?.()?.getImageLoaded()&&u(c.getProperty().getRoughnessTexture())&&d.push("_roughnessMap = textureSample(RoughnessTexture, RoughnessTextureSampler, input.tcoordVS);"),c.getProperty().getMetallicTexture?.()?.getImageLoaded()&&u(c.getProperty().getMetallicTexture())&&d.push("_metallicMap = textureSample(MetallicTexture, MetallicTextureSampler, input.tcoordVS);"),c.getProperty().getNormalTexture?.()?.getImageLoaded()&&u(c.getProperty().getNormalTexture())&&d.push("_normalMap = textureSample(NormalTexture, NormalTextureSampler, input.tcoordVS);"),c.getProperty().getAmbientOcclusionTexture?.()?.getImageLoaded()&&u(c.getProperty().getAmbientOcclusionTexture())&&d.push("_ambientOcclusionMap = textureSample(AmbientOcclusionTexture, AmbientOcclusionTextureSampler, input.tcoordVS);"),c.getProperty().getEmissionTexture?.()?.getImageLoaded()&&u(c.getProperty().getEmissionTexture())&&d.push("_emissionMap = textureSample(EmissionTexture, EmissionTextureSampler, input.tcoordVS);"),s=Be.Ay.substitute(s,"//VTK::TCoord::Impl",d).result,l.setCode(s)},t.shaderReplacements.set("replaceShaderTCoord",e.replaceShaderTCoord),e.replaceShaderSelect=(e,t,n)=>{if(e.includes("sel")){const e=t.getShaderDescription("fragment");let n=e.getCode();n=Be.Ay.substitute(n,"//VTK::Select::Impl",["  var compositeID: u32 = 0u;"]).result,e.setCode(n)}},t.shaderReplacements.set("replaceShaderSelect",e.replaceShaderSelect),e.getUsage=(e,t)=>e===We.POINTS||t===ze.Points?Ge.Verts:t===ze.Lines?Ge.Lines:e===We.WIREFRAME?t===ze.Triangles?Ge.LinesFromTriangles:Ge.LinesFromStrips:t===ze.Triangles?Ge.Triangles:t===ze.TriangleStrips?Ge.Strips:t===ze.TriangleEdges?Ge.LinesFromTriangles:Ge.LinesFromStrips,e.getHashFromUsage=e=>`pt${e}`,e.getTopologyFromUsage=e=>{switch(e){case Ge.Triangles:return"triangle-list";case Ge.Verts:return"point-list";case Ge.Lines:default:return"line-list"}},e.buildVertexInput=()=>{const n=t.currentInput,r=t.cellArray,i=t.primitiveType;let o=t.WebGPUActor.getRenderable().getProperty().getRepresentation();const a=t.WebGPURenderWindow.getDevice();let s=!1;i===ze.TriangleEdges&&(s=!0,o=We.WIREFRAME);const l=t.vertexInput,c=n.getPoints();let u;if(r){const e={hash:`R${o}P${i}${r.getMTime()}`,usage:Ge.Index,cells:r,numberOfPoints:c.getNumberOfPoints(),primitiveType:i,representation:o};u=a.getBufferManager().getBuffer(e),l.setIndexBuffer(u)}else l.setIndexBuffer(null);if(c){const e=t.WebGPUActor.getBufferShift(t.WebGPURenderer),n={hash:`${c.getMTime()}I${u.getMTime()}${e.join()}float32x4`,usage:Ge.PointArray,format:"float32x4",dataArray:c,indexBuffer:u,shift:e,packExtra:!0},r=a.getBufferManager().getBuffer(n);l.addBuffer(r,["vertexBC"])}else l.removeBufferIfPresent("vertexBC");const d=e.getUsage(o,i);if(t._usesCellNormals=!1,t.is2D||d!==Ge.Triangles&&d!==Ge.Strips)l.removeBufferIfPresent("normalMC");else{const e=n.getPointData().getNormals(),o={format:"snorm8x4",indexBuffer:u,packExtra:!0,shift:0,scale:127};if(e){o.hash=`${e.getMTime()}I${u.getMTime()}snorm8x4`,o.dataArray=e,o.usage=Ge.PointArray;const t=a.getBufferManager().getBuffer(o);l.addBuffer(t,["normalMC"])}else if(i===ze.Triangles){t._usesCellNormals=!0,o.hash=`PFN${c.getMTime()}I${u.getMTime()}snorm8x4`,o.dataArray=c,o.cells=r,o.usage=Ge.NormalsFromPoints;const e=a.getBufferManager().getBuffer(o);l.addBuffer(e,["normalMC"])}else l.removeBufferIfPresent("normalMC")}let p=!1;if(t.renderable.getScalarVisibility()){const e=t.renderable.getColorMapColors();if(e&&!s){const r=t.renderable.getScalarMode();let i=!1;r!==je.USE_CELL_DATA&&r!==je.USE_CELL_FIELD_DATA&&r!==je.USE_FIELD_DATA&&n.getPointData().getScalars()||r===je.USE_POINT_FIELD_DATA||!e||(i=!0);const o={usage:Ge.PointArray,format:"unorm8x4",hash:`${i}${e.getMTime()}I${u.getMTime()}unorm8x4`,dataArray:e,indexBuffer:u,cellData:i,cellOffset:0},s=a.getBufferManager().getBuffer(o);l.addBuffer(s,["colorVI"]),p=!0}}p||l.removeBufferIfPresent("colorVI");let f=null;if(f=t.renderable.getInterpolateScalarsBeforeMapping?.()&&t.renderable.getColorCoordinates()?t.renderable.getColorCoordinates():n.getPointData().getTCoords(),f&&!s){const e=a.getBufferManager().getBufferForPointArray(f,l.getIndexBuffer());l.addBuffer(e,["tcoord"])}else l.removeBufferIfPresent("tcoord")},e.updateTextures=()=>{const e=[],n=[],r=t.renderable.getColorTextureMap?.();r&&(t.colorTexture||(t.colorTexture=p.Ay.newInstance({label:"polyDataColor"})),t.colorTexture.setInputData(r),n.push(["Diffuse",t.colorTexture]));const i=t.WebGPUActor.getRenderable(),o=t.WebGPURenderer.getRenderable(),a=[];if(i.getProperty().getDiffuseTexture?.()){const e=["Diffuse",i.getProperty().getDiffuseTexture()];a.push(e)}if(i.getTextures()[0]){const e=["Diffuse",i.getTextures()[0]];a.push(e)}if(t.colorTexture){const e=["Diffuse",t.colorTexture];a.push(e)}if(i.getProperty().getRoughnessTexture?.()){const e=["Roughness",i.getProperty().getRoughnessTexture()];a.push(e)}if(i.getProperty().getMetallicTexture?.()){const e=["Metallic",i.getProperty().getMetallicTexture()];a.push(e)}if(i.getProperty().getNormalTexture?.()){const e=["Normal",i.getProperty().getNormalTexture()];a.push(e)}if(i.getProperty().getAmbientOcclusionTexture?.()){const e=["AmbientOcclusion",i.getProperty().getAmbientOcclusionTexture()];a.push(e)}if(i.getProperty().getEmissionTexture?.()){const e=["Emission",i.getProperty().getEmissionTexture()];a.push(e)}if(o.getEnvironmentTexture?.()){const e=["Environment",o.getEnvironmentTexture()];a.push(e)}for(let e=0;e<a.length;e++)(a[e][1].getInputData()||a[e][1].getJsImageData()||a[e][1].getCanvas())&&n.push(a[e]),a[e][1].getImage()&&a[e][1].getImageLoaded()&&n.push(a[e]);for(let r=0;r<n.length;r++){const i=n[r][1],o=n[r][0],a=t.device.getTextureManager().getTextureForVTKTexture(i);if(a.getReady()){let n=!1;for(let r=0;r<t.textures.length;r++)t.textures[r]===a&&(n=!0,e[r]=!0);if(!n){e[t.textures.length]=!0;const n=a.createView(`${o}Texture`);t.textures.push(a),t.textureViews.push(n);const r=i.getInterpolate()?"linear":"nearest";let s=null;!s&&i.getEdgeClamp()&&i.getRepeat()&&(s="mirror-repeat"),!s&&i.getEdgeClamp()&&(s="clamp-to-edge"),!s&&i.getRepeat()&&(s="repeat"),"Environment"!==o?n.addSampler(t.device,{addressModeU:s,addressModeV:s,addressModeW:s,minFilter:r,magFilter:r}):n.addSampler(t.device,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:r,magFilter:r,mipmapFilter:"linear"})}}}for(let n=t.textures.length-1;n>=0;n--)e[n]||(t.textures.splice(n,1),t.textureViews.splice(n,1))},e.computePipelineHash=()=>{let n=`pd${t.useRendererMatrix?"r":""}${t.forceZValue?"z":""}`;if(t.primitiveType===ze.TriangleEdges||t.primitiveType===ze.TriangleStripEdges)n+="edge";else{if(t.vertexInput.hasAttribute("normalMC")&&(n+="n"),t.vertexInput.hasAttribute("colorVI")&&(n+="c"),t.vertexInput.hasAttribute("tcoord")){const e=t.vertexInput.getBuffer("tcoord");n+=`t${Ue.A.getNumberOfComponentsFromBufferFormat(e.getArrayInformation()[0].format)}`}t.textures.length&&(n+=`tx${t.textures.length}`)}t._usesCellNormals&&(n+="cn"),t.SSBO&&(n+="ssbo"),n+=e.getHashFromUsage(t.usage),n+=t.renderEncoder.getPipelineHash(),t.pipelineHash=n},e.updateBuffers=()=>{t.primitiveType!==ze.TriangleEdges&&t.primitiveType!==ze.TriangleStripEdges&&e.updateTextures();const n=t.WebGPUActor.getRenderable(),r=n.getProperty().getRepresentation();t.usage=e.getUsage(r,t.primitiveType),e.buildVertexInput();const i=t.vertexInput.getBuffer("vertexBC");if(e.setNumberOfVertices(i.getSizeInBytes()/i.getStrideInBytes()),e.setTopology(e.getTopologyFromUsage(t.usage)),e.updateUBO(),e.haveWideLines()){const t=n.getProperty();e.setNumberOfInstances(Math.ceil(2*t.getLineWidth()))}else e.setNumberOfInstances(1)}}(e,t)}var Ye={newInstance:(0,r.n)(Xe,"vtkWebGPUCellArrayMapper"),extend:Xe};const{PrimitiveTypes:Je}=Oe.Ay;const Ze={primitives:null};function Qe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Ze,n),O.A.extend(e,t,n),t.primitives=[],function(e,t){t.classHierarchy.push("vtkWebGPUPolyDataMapper"),e.createCellArrayMapper=()=>Ye.newInstance(),e.buildPass=n=>{if(n){t.WebGPUActor=e.getFirstAncestorOfType("vtkWebGPUActor"),t.renderable.getStatic()||t.renderable.update();const n=t.renderable.getInputData();t.renderable.mapScalars(n,1),e.updateCellArrayMappers(n)}},e.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],i=[];let o=0;for(let a=Je.Points;a<=Je.Triangles;a++)if(r[a].getNumberOfValues()>0){t.primitives[a]||(t.primitives[a]=e.createCellArrayMapper());const s=t.primitives[a];s.setCellArray(r[a]),s.setCurrentInput(n),s.setCellOffset(o),s.setPrimitiveType(a),s.setRenderable(t.renderable),o+=r[a].getNumberOfCells(),i.push(s)}else t.primitives[a]=null;if(t.WebGPUActor.getRenderable().getProperty().getEdgeVisibility())for(let o=Je.TriangleEdges;o<=Je.TriangleStripEdges;o++)if(r[o-2].getNumberOfValues()>0){t.primitives[o]||(t.primitives[o]=e.createCellArrayMapper());const a=t.primitives[o];a.setCellArray(r[o-2]),a.setCurrentInput(n),a.setCellOffset(t.primitives[o-2].getCellOffset()),a.setPrimitiveType(o),a.setRenderable(t.renderable),i.push(a)}else t.primitives[o]=null;e.prepareNodes(),e.addMissingChildren(i),e.removeUnusedNodes()}}(e,t)}const et=(0,r.n)(Qe,"vtkWebGPUPolyDataMapper");(0,ye.c9)("vtkMapper",et);const{PrimitiveTypes:tt}=Oe.Ay;function nt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,function(e){return{primitives:[],...e}}(n)),O.A.extend(e,t,n),t.primitives=[],function(e,t){t.classHierarchy.push("vtkWebGPUPolyDataMapper2D"),e.createCellArrayMapper=()=>Ye.newInstance(),e.buildPass=n=>{if(n){t.WebGPUActor=e.getFirstAncestorOfType("vtkWebGPUActor2D"),t.renderable.getStatic()||t.renderable.update();const n=t.renderable.getInputData();t.renderable.mapScalars(n,1),e.updateCellArrayMappers(n)}},e.updateCellArrayMappers=n=>{const r=[n.getVerts(),n.getLines(),n.getPolys(),n.getStrips()],i=[];let o=0;for(let a=tt.Points;a<=tt.Triangles;a++)if(r[a].getNumberOfValues()>0){t.primitives[a]||(t.primitives[a]=e.createCellArrayMapper());const s=t.primitives[a];s.setCellArray(r[a]),s.setCurrentInput(n),s.setCellOffset(o),s.setPrimitiveType(a),s.setRenderable(t.renderable),s.setIs2D(!0),o+=r[a].getNumberOfCells(),i.push(s)}else t.primitives[a]=null;e.prepareNodes(),e.addMissingChildren(i),e.removeUnusedNodes()}}(e,t)}const rt=(0,r.n)(nt,"vtkWebGPUPolyDataMapper2D");(0,ye.c9)("vtkMapper2D",rt);const it={};function ot(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,it,n),O.A.extend(e,t,n),t.scalarBarActorHelper=fe.newScalarBarActorHelper(),function(e,t){t.classHierarchy.push("vtkWebGPUScalarBarActor"),e.buildPass=n=>{n&&(t.WebGPURenderer=e.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getParent(),t.scalarBarActorHelper.getRenderable()||t.scalarBarActorHelper.setRenderable(t.renderable),e.prepareNodes(),e.addMissingNode(t.scalarBarActorHelper.getBarActor()),e.addMissingNode(t.scalarBarActorHelper.getTmActor()),e.removeUnusedNodes())},e.opaquePass=(e,n)=>{if(e){const e=t.WebGPURenderer?t.WebGPURenderer.getRenderable().getActiveCamera():null,n=t.WebGPURenderer.getTiledSizeAndOrigin();t.scalarBarActorHelper.updateAPISpecificData([n.usize,n.vsize],e,t.WebGPURenderWindow.getRenderable())}}}(e,t)}const at=(0,r.n)(ot,"vtkWebGPUScalarBarActor");(0,ye.c9)("vtkScalarBarActor",at);var st=n(97888),lt=n(20461);const ct={texture:null,handle:null,sampler:null,label:null};function ut(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ct,n),r.m.obj(e,t),t.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d"}},t.bindGroupTime={},r.m.obj(t.bindGroupTime,{mtime:0}),r.m.get(e,t,["bindGroupTime","texture"]),r.m.setGet(e,t,["bindGroupLayoutEntry","label","sampler"]),function(e,t){t.classHierarchy.push("vtkWebGPUTextureView"),e.create=(e,n)=>{t.texture=e,t.options=n,t.options.dimension=t.options.dimension||"2d",t.options.label=t.label,t.textureHandle=e.getHandle(),t.handle=t.textureHandle.createView(t.options),t.bindGroupLayoutEntry.texture.viewDimension=t.options.dimension;const r=Ue.A.getDetailsFromTextureFormat(t.texture.getFormat());t.bindGroupLayoutEntry.texture.sampleType=r.sampleType},e.createFromTextureHandle=(e,n)=>{t.texture=null,t.options=n,t.options.dimension=t.options.dimension||"2d",t.options.label=t.label,t.textureHandle=e,t.handle=t.textureHandle.createView(t.options),t.bindGroupLayoutEntry.texture.viewDimension=t.options.dimension;const r=Ue.A.getDetailsFromTextureFormat(n.format);t.bindGroupLayoutEntry.texture.sampleType=r.sampleType,t.bindGroupTime.modified()},e.getBindGroupEntry=()=>({resource:e.getHandle()}),e.getShaderCode=(e,n)=>{let r="f32";"sint"===t.bindGroupLayoutEntry.texture.sampleType?r="i32":"uint"===t.bindGroupLayoutEntry.texture.sampleType&&(r="u32");let i=`@binding(${e}) @group(${n}) var ${t.label}: texture_${t.options.dimension}<${r}>;`;return"depth"===t.bindGroupLayoutEntry.texture.sampleType&&(i=`@binding(${e}) @group(${n}) var ${t.label}: texture_depth_${t.options.dimension};`),i},e.addSampler=(n,r)=>{const i=lt.Ay.newInstance({label:`${t.label}Sampler`});i.create(n,r),e.setSampler(i)},e.getBindGroupTime=()=>(t.texture&&t.texture.getHandle()!==t.textureHandle&&(t.textureHandle=t.texture.getHandle(),t.handle=t.textureHandle.createView(t.options),t.bindGroupTime.modified()),t.bindGroupTime),e.getHandle=()=>(t.texture&&t.texture.getHandle()!==t.textureHandle&&(t.textureHandle=t.texture.getHandle(),t.handle=t.textureHandle.createView(t.options),t.bindGroupTime.modified()),t.handle)}(e,t)}var dt={newInstance:r.m.newInstance(ut),extend:ut};const{BufferUsage:pt}=Oe.Ay;const ft={device:null,handle:null,buffer:null,ready:!1,label:null};function ht(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ft,n),r.m.obj(e,t),r.m.get(e,t,["handle","ready","width","height","depth","format","usage"]),r.m.setGet(e,t,["device","label"]),function(e,t){t.classHierarchy.push("vtkWebGPUTexture"),e.create=(e,n)=>{t.device=e,t.width=n.width,t.height=n.height,t.depth=n.depth?n.depth:1;const r=1===t.depth?"2d":"3d";t.format=n.format?n.format:"rgba8unorm",t.mipLevel=n.mipLevel?n.mipLevel:0,t.usage=n.usage?n.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,t.handle=t.device.getHandle().createTexture({size:[t.width,t.height,t.depth],format:t.format,usage:t.usage,label:t.label,dimension:r,mipLevelCount:t.mipLevel+1})},e.assignFromHandle=(e,n,r)=>{t.device=e,t.handle=n,t.width=r.width,t.height=r.height,t.depth=r.depth?r.depth:1,t.format=r.format?r.format:"rgba8unorm",t.usage=r.usage?r.usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},e.writeImageData=n=>{let i=[];if(n.canvas)return t.device.getHandle().queue.copyExternalImageToTexture({source:n.canvas,flipY:n.flip},{texture:t.handle,premultipliedAlpha:!0},[t.width,t.height,t.depth]),void(t.ready=!0);n.jsImageData&&!n.nativeArray&&(n.width=n.jsImageData.width,n.height=n.jsImageData.height,n.depth=1,n.format="rgba8unorm",n.flip=!0,n.nativeArray=n.jsImageData.data);const o=Ue.A.getDetailsFromTextureFormat(t.format);let a=t.width*o.stride;const s=(e,t,n)=>{const i=e.length/(t*n)*e.BYTES_PER_ELEMENT,a=2===o.elementSize&&"float"===o.sampleType;if(a||i%256){const s=e,l=i/s.BYTES_PER_ELEMENT,c=o.elementSize,u=256*Math.floor((l*c+255)/256),d=u/c,p=r.m.newTypedArray(a?"Uint16Array":s.constructor.name,d*t*n);for(let e=0;e<t*n;e++)if(a)for(let t=0;t<l;t++)p[e*d+t]=st.A.toHalf(s[e*l+t]);else p.set(s.subarray(e*l,(e+1)*l),e*d);return[p,u]}return[e,i]};if(n.nativeArray&&(i=n.nativeArray),n.image){const e=document.createElement("canvas");e.width=n.image.width,e.height=n.image.height;const t=e.getContext("2d");t.translate(0,e.height),t.scale(1,-1),t.drawImage(n.image,0,0,n.image.width,n.image.height,0,0,e.width,e.height),i=t.getImageData(0,0,n.image.width,n.image.height).data}const l=t.device.createCommandEncoder();if(3!==e.getDimensionality()){const e=p.Ay.generateMipmaps(i,t.width,t.height,t.mipLevel);let r=t.width,o=t.height;for(let i=0;i<=t.mipLevel;i++){const c=s(e[i],o,1);a=c[1];const u={dataArray:n.dataArray?n.dataArray:null,nativeArray:c[0],usage:pt.Texture},d=t.device.getBufferManager().getBuffer(u);l.copyBufferToTexture({buffer:d.getHandle(),offset:0,bytesPerRow:a,rowsPerImage:o},{texture:t.handle,mipLevel:i},[r,o,1]),r/=2,o/=2}t.device.submitCommandEncoder(l),t.ready=!0}else{const e=s(i,t.height,t.depth);a=e[1];const r={dataArray:n.dataArray?n.dataArray:null,usage:pt.Texture};r.nativeArray=e[0];const o=t.device.getBufferManager().getBuffer(r);l.copyBufferToTexture({buffer:o.getHandle(),offset:0,bytesPerRow:a,rowsPerImage:t.height},{texture:t.handle},[t.width,t.height,t.depth]),t.device.submitCommandEncoder(l),t.ready=!0}},e.getScale=()=>{const e=Ue.A.getDetailsFromTextureFormat(t.format);return 2===e.elementSize&&"float"===e.sampleType?1:255},e.getNumberOfComponents=()=>Ue.A.getDetailsFromTextureFormat(t.format).numComponents,e.getDimensionality=()=>{let e=0;return t.width>1&&e++,t.height>1&&e++,t.depth>1&&e++,e},e.resizeToMatch=e=>{e.getWidth()===t.width&&e.getHeight()===t.height&&e.getDepth()===t.depth||(t.width=e.getWidth(),t.height=e.getHeight(),t.depth=e.getDepth(),t.handle=t.device.getHandle().createTexture({size:[t.width,t.height,t.depth],format:t.format,usage:t.usage,label:t.label}))},e.resize=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e===t.width&&n===t.height&&r===t.depth||(t.width=e,t.height=n,t.depth=r,t.handle=t.device.getHandle().createTexture({size:[t.width,t.height,t.depth],format:t.format,usage:t.usage,label:t.label}))},e.createView=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.dimension||(r.dimension=1===t.depth?"2d":"3d");const i=dt.newInstance({label:n});return i.create(e,r),i}}(e,t)}r.m.newInstance(ht),n(77489),n(49038),n(71851);n(90808);n(97994),n(32643),n(10364),n(69372);var mt=n(56074);const gt={};var vt,yt;vt="mesh",yt=mt.R,gt[vt]=yt},97994:(e,t,n)=>{"use strict";n.d(t,{q:()=>p});var r=n(71851),i=n(29625);var o=n(28906),a=n(8906),s=n(61433);n(67313);function l(e,t){function n(){t.requestCount--,0===t.requestCount&&e.invokeBusy(!1)}function r(e){if("#"===e[0]||0===e.length)return;const r=e.split(/[ \t]+/).map((e=>e.trim())).filter((e=>e.length));if("newmtl"===r[0])r.shift(),t.currentMaterial=r.join(" ").trim();else if(t.currentMaterial){if(r.length<2)return;if(t.materials[t.currentMaterial]||(t.materials[t.currentMaterial]={}),t.materials[t.currentMaterial][r[0]]=r.slice(1),"map_Kd"===r[0]){const e=new Image;e.onload=()=>setTimeout(n,0),e.src=[t.baseURL,r[1]].join("/"),t.materials[t.currentMaterial].image=e,t.requestCount++}}}t.classHierarchy.push("vtkMTLReader"),t.dataAccessHelper||(t.dataAccessHelper=a.Ay.get("http")),e.setUrl=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(-1!==n.indexOf(".mtl")||r.fullpath){t.url=n;const e=n.split("/");e.pop(),t.baseURL=e.join("/")}else t.baseURL=n,t.url=`${n}/index.mtl`;return e.loadData(r)},e.loadData=n=>new Promise(((r,i)=>{var o,a;(o=t.url,a=n,t.dataAccessHelper.fetchText(e,o,a)).then((t=>{e.parseAsText(t),r()}),(e=>{i()}))})),e.parseAsText=n=>{e.modified(),t.materials={},n.split("\n").forEach(r)},e.isBusy=()=>!!t.requestCount,e.getMaterialNames=()=>Object.keys(t.materials),e.getMaterial=e=>t.materials[e],e.listImages=()=>Object.keys(t.materials).map((e=>t.materials[e].map_Kd)).filter((e=>!!e)).map((e=>e[0].trim())),e.setImageSrc=(e,n)=>new Promise(((r,i)=>{const o=Object.keys(t.materials).find((n=>t.materials[n].map_Kd&&t.materials[n].map_Kd[0].trim()===e.trim())),a=t.materials[o];a&&a.image?(a.image.src=n,a.image.onload=()=>setTimeout(r,0)):r()})),e.applyMaterialToActor=(e,n)=>{const r=t.materials[e];if(r&&n){const e=[1,1,1],i={ambientColor:r.Ka?r.Ka.map((e=>Number(e))):e,specularColor:r.Ks?r.Ks.map((e=>Number(e))):e,diffuseColor:r.Kd?r.Kd.map((e=>Number(e))):e,opacity:r.d?Number(r.d):1,specularPower:r.Ns?Number(r.Ns):1},o=Number(r.illum||2);if(["ambient","diffuse","specular"].forEach(((e,t)=>{i[e]=t<=o?1:0})),r.image){const e=s.Ay.newInstance({interpolate:t.interpolateTextures});e.setImage(r.image),n.addTexture(e)}n.getProperty().set(i)}}}const c={numberOfOutputs:1,requestCount:0,materials:{},interpolateTextures:!0};function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,c,n),(0,o.o)(e,t),(0,o.g)(e,t,["url","baseURL"]),(0,o.e)(e,t,["dataAccessHelper","interpolateTextures","splitGroup"]),(0,o.f)(e,t,"busy"),l(e,t)}var d={newInstance:(0,o.n)(u,"vtkMTLReader"),extend:u};function p(e,t){!function(e){if(!e.id)throw new Error("Mesh must have an id");if(!e.arrayBuffer)throw new Error("Mesh must have an arrayBuffer");if(!(e.format in r.MeshType))throw new Error(`Mesh format must be one of the following: ${Object.values(r.MeshType).join(", ")}`)}(t);const n=new i.e({...t}),o={id:e,type:r.GeometryType.MESH,data:n,sizeInBytes:n.sizeInBytes};switch(t.format){case r.MeshType.PLY:if(t.materialUrl){const e=new Image;return new Promise(((r,i)=>{e.onload=()=>{try{const t=s.Ay.newInstance();t.setInterpolate(!0),t.setImage(e),n.defaultActor.addTexture(t),r(o)}catch(e){i(e)}},e.onerror=e=>i(e),e.src=t.materialUrl}))}return Promise.resolve(o);case r.MeshType.OBJ:if(t.materialUrl){const e=d.newInstance();return e.setUrl(t.materialUrl).then((()=>{for(let t=0;t<n.actors.length;t++){const r=n.actors[t],i=r.getMapper();if(i){const t=i.getInputData();if(t){const n=t.get("name").name;e.applyMaterialToActor(n,r)}}}return o})).catch((e=>{throw new Error(`Failed to load material: ${e}`)}))}return Promise.resolve(o);case r.MeshType.STL:case r.MeshType.VTP:return Promise.resolve(o);default:return Promise.reject(new Error(`Unsupported format: ${t.format}`))}}},87142:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createAndCacheDerivedLabelmapVolume:()=>Le,createAndCacheDerivedVolume:()=>Ie,createAndCacheVolume:()=>_e,createAndCacheVolumeFromImages:()=>Ee,createAndCacheVolumeFromImagesSync:()=>De,createLocalLabelmapVolume:()=>Fe,createLocalVolume:()=>Oe,getUnknownVolumeLoaderSchema:()=>Me,getVolumeLoaderSchemes:()=>Re,loadVolume:()=>we,registerUnknownVolumeLoader:()=>Ne,registerVolumeLoader:()=>Pe});n(38475),n(63819);var r=n(28906),i=n(3823),o=n(35056),a=n(87275);const{vtkErrorMacro:s}=r.m;class l{constructor(){this.segmentMapping={},this.segments=[null],this.faces=[]}addSegment(e){const t=e[0],n=e[e.length-1];if(t===n||e.length<2)return;const r=this.segmentMapping[t],i=this.segmentMapping[n];if(void 0!==r&&void 0!==i)if(Math.abs(r)===Math.abs(i)){const o=r<i?i:r,a=this.segments[o];if(r>0)for(let t=1;t<e.length-1;t++)a.push(e[t]);else for(let t=1;t<e.length-1;t++)a.unshift(e[e.length-1-t]);this.faces.push(a),this.segments[o]=null,this.segmentMapping[t]=void 0,this.segmentMapping[n]=void 0}else{const t=Math.abs(r),n=Math.abs(i),o=this.segments[t],a=this.segments[n];this.segments[t]=null,this.segments[n]=null,this.segmentMapping[o[0]]=void 0,this.segmentMapping[a[0]]=void 0,this.segmentMapping[o[o.length-1]]=void 0,this.segmentMapping[a[a.length-1]]=void 0,this.addSegment(e),this.addSegment(o),this.addSegment(a)}else if(void 0!==r){if(r>0){const t=this.segments[r];for(let n=1;n<e.length;n++)t.push(e[n]);this.segmentMapping[n]=r}else{const t=this.segments[-r];this.segmentMapping[n]=r;for(let n=1;n<e.length;n++)t.unshift(e[n])}this.segmentMapping[t]=void 0}else if(void 0!==i){if(i>0){const n=this.segments[i];for(let t=1;t<e.length;t++)n.push(e[e.length-1-t]);this.segmentMapping[t]=i}else{const n=this.segments[-i];this.segmentMapping[t]=i;for(let t=1;t<e.length;t++)n.unshift(e[e.length-t-1])}this.segmentMapping[n]=void 0}else{const r=this.segments.length;this.segments.push(e),this.segmentMapping[t]=-r,this.segmentMapping[n]=r}}}const c={};function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,c,n),r.m.obj(e,t),r.m.algo(e,t,1,1),function(e,t){t.classHierarchy.push("vtkClosedPolyLineToSurfaceFilter"),e.requestData=(e,t)=>{const n=e[0];if(!n)return void s("Invalid or missing input");const r=a.Ay.newInstance();r.shallowCopy(n);const i=new l,c=n.getLines().getData();let u=0;for(;u<c.length;){const e=c[u++],t=[];for(let n=0;n<e;n++)t.push(c[u+n]);i.addSegment(t),u+=e}const{faces:d}=i;let p=d.length;for(let e=0;e<d.length;e++)p+=d[e].length;const f=new Uint16Array(p);u=0;for(let e=0;e<d.length;e++){const t=d[e];f[u++]=t.length;for(let e=0;e<t.length;e++)f[u++]=t[e]}r.setPolys(o.Ay.newInstance({values:f,name:"faces"})),t[0]=r}}(e,t)}var d={newInstance:r.m.newInstance(u,"vtkClosedPolyLineToSurfaceFilter"),extend:u},p=n(61088),f=n(42008),h=n(71650),m=n(56748);const{vtkErrorMacro:g}=r.m;const v={};function y(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,v,n),r.m.obj(e,t),r.m.algo(e,t,1,1),t._cubeSource=m.Ay.newInstance(),r.m.moveToProtected(e,t,["cubeSource","tmpOut"]),function(e,t){t.classHierarchy.push("vtkImageDataOutlineFilter");const n={...e};e.requestData=(e,n)=>{const r=e[0];if(!r||!r.isA("vtkImageData"))return void g("Invalid or missing input");const i=r.getSpatialExtent();i?(t._cubeSource.setBounds(i),t._cubeSource.setMatrix(r.getIndexToWorld()),n[0]=t._cubeSource.getOutputData()):g("Unable to fetch spatial extents of input image.")},e.getMTime=()=>Math.max(n.getMTime(),t._cubeSource.getMTime()),e.setGenerateFaces=t._cubeSource.setGenerateFaces,e.setGenerateLines=t._cubeSource.setGenerateLines,e.getGenerateFaces=t._cubeSource.getGenerateFaces,e.getGenerateLines=t._cubeSource.getGenerateLines}(e,t)}var b={newInstance:r.m.newInstance(y,"vtkImageDataOutlineFilter"),extend:y},x=n(16632),A=n(79525),C=n(75127),T=n(83534),S=n(18713);let w;const _={preMultiplyFlag:!1,matrix:[...n(35341).zK]};function I(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,_,n),r.m.obj(e,t),r.m.setGet(e,t,["preMultiplyFlag"]),r.m.setGetArray(e,t,["matrix"],16),function(e,t){t.classHierarchy.push("vtkAbstractTransform","vtkHomogeneousTransform","vtkTransform"),e.transformPoint=(e,n)=>(i.eR.transformMat4(n,e,t.matrix),n),e.transformPoints=(e,n)=>{const r=new Float64Array(3),o=new Float64Array(3);for(let a=0;a<e.length;a+=3)r[0]=e[a],r[1]=e[a+1],r[2]=e[a+2],i.eR.transformMat4(o,r,t.matrix),n[a]=o[0],n[a+1]=o[1],n[a+2]=o[2];return n},e.preMultiply=()=>{e.setPreMultiplyFlag(!0)},e.postMultiply=()=>{e.setPreMultiplyFlag(!1)},e.transformMatrix=(e,n)=>(t.preMultiplyFlag?i.pB.multiply(n,t.matrix,e):i.pB.multiply(n,e,t.matrix),n),e.transformMatrices=(e,n)=>{const r=new Float64Array(16),o=new Float64Array(16),a=t.preMultiplyFlag?()=>i.pB.multiply(o,t.matrix,r):()=>i.pB.multiply(o,r,t.matrix);for(let t=0;t<e.length;t+=16){for(let n=0;n<16;++n)r[n]=e[t+n];a();for(let e=0;e<16;++e)n[t+e]=o[e]}return n},e.getInverse=()=>w({matrix:x.f.invertMatrix(Array.from(t.matrix),[],4),preMultiplyFlag:t.preMultiplyFlag})}(e,t)}w=r.m.newInstance(I,"vtkTransform");var E={newInstance:w,extend:I},D=n(25196),O=n(90919),P="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkImageResliceMapperVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n\n// all variables that represent positions or directions have a suffix\n// indicating the coordinate system they are in. The possible values are\n// MC - Model coordinates\n// WC - World coordinates\n// VC - View coordinates\n// DC - Display coordinates\n// TC - Texture coordinates\n\n// frag position in VC\n//VTK::PositionVC::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\n// picking support\n//VTK::Picking::Dec\n\n// camera and actor matrix values\n//VTK::Camera::Dec\n\nvoid main()\n{\n  //VTK::PositionVC::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Picking::Impl\n}\n",R="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkImageResliceMapperFS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// Template for the gpu image mapper fragment shader\n\n// VC position of this fragment\n//VTK::PositionVC::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\n// picking support\n//VTK::Picking::Dec\n\n// handle coincident offsets\n//VTK::Coincident::Dec\n\n//VTK::ZBuffer::Dec\n\n// the output of this shader\n//VTK::Output::Dec\n\nvoid main()\n{\n  // VC position of this fragment. This should not branch/return/discard.\n  //VTK::PositionVC::Impl\n\n  // Place any calls that require uniform flow (e.g. dFdx) here.\n  //VTK::UniformFlow::Impl\n\n  // Set gl_FragDepth here (gl_FragCoord.z by default)\n  //VTK::Depth::Impl\n\n  // Early depth peeling abort:\n  //VTK::DepthPeeling::PreColor\n\n  //VTK::TCoord::Impl\n\n  if (gl_FragData[0].a <= 0.0)\n    {\n    discard;\n    }\n\n  //VTK::DepthPeeling::Impl\n\n  //VTK::Picking::Impl\n\n  // handle coincident offsets\n  //VTK::Coincident::Impl\n\n  //VTK::ZBuffer::Impl\n\n  //VTK::RenderPassFragmentShader::Impl\n}\n",N=n(52271),M=n(91732),L=n(71995),F=n(28914),B=n(88691),V=(n(57285),n(7698));const{vtkErrorMacro:k}=r.c;function U(e,t,n){return t.identity(n),e.reduce(((e,n,r)=>0===r?n?t.copy(e,n):t.identity(e):n?t.multiply(e,e,n):e),n)}function G(e,t){function n(n){[t._scalars,t._colorTransferFunc,t._pwFunc].forEach((t=>n.unregisterGraphicsResourceUser(t,e)))}t.classHierarchy.push("vtkOpenGLImageResliceMapper"),e.buildPass=r=>{if(r){t.currentRenderPass=null,t._openGLImageSlice=e.getFirstAncestorOfType("vtkOpenGLImageSlice"),t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer");const r=t._openGLRenderer.getRenderable();t._openGLCamera=t._openGLRenderer.getViewNodeFor(r.getActiveCamera());const i=t._openGLRenderWindow;t._openGLRenderWindow=t._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),i&&!i.isDeleted()&&i!==t._openGLRenderWindow&&n(i),t.context=t._openGLRenderWindow.getContext(),t.tris.setOpenGLRenderWindow(t._openGLRenderWindow)}},e.translucentPass=(n,r)=>{n&&(t.currentRenderPass=r,e.render())},e.zBufferPass=n=>{n&&(t.haveSeenDepthRequest=!0,t.renderDepth=!0,e.render(),t.renderDepth=!1)},e.opaqueZBufferPass=t=>e.zBufferPass(t),e.opaquePass=t=>{t&&e.render()},e.getCoincidentParameters=(e,n)=>t.renderable.getResolveCoincidentTopology()==V.XK.PolygonOffset?t.renderable.getCoincidentTopologyPolygonOffsetParameters():null,e.render=()=>{const n=t._openGLImageSlice.getRenderable(),r=t._openGLRenderer.getRenderable();e.renderPiece(r,n)},e.renderPiece=(n,r)=>{e.invokeEvent({type:"StartEvent"}),t.renderable.update(),t.currentInput=t.renderable.getInputData(),t.currentInput?(e.updateResliceGeometry(),e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r),e.invokeEvent({type:"EndEvent"})):k("No input!")},e.renderPieceStart=(n,r)=>{e.updateBufferObjects(n,r);r.getProperty().getInterpolationType()===M.V.NEAREST?(t.openGLTexture.setMinificationFilter(N.dJ.NEAREST),t.openGLTexture.setMagnificationFilter(N.dJ.NEAREST),t.colorTexture.setMinificationFilter(N.dJ.NEAREST),t.colorTexture.setMagnificationFilter(N.dJ.NEAREST),t.pwfTexture.setMinificationFilter(N.dJ.NEAREST),t.pwfTexture.setMagnificationFilter(N.dJ.NEAREST)):(t.openGLTexture.setMinificationFilter(N.dJ.LINEAR),t.openGLTexture.setMagnificationFilter(N.dJ.LINEAR),t.colorTexture.setMinificationFilter(N.dJ.LINEAR),t.colorTexture.setMagnificationFilter(N.dJ.LINEAR),t.pwfTexture.setMinificationFilter(N.dJ.LINEAR),t.pwfTexture.setMagnificationFilter(N.dJ.LINEAR)),t.lastBoundBO=null},e.renderPieceDraw=(n,r)=>{const i=t.context;t.openGLTexture.activate(),t.colorTexture.activate(),t.pwfTexture.activate(),e.updateShaders(t.tris,n,r),i.drawArrays(i.TRIANGLES,0,t.tris.getCABO().getElementCount()),t.tris.getVAO().release(),t.openGLTexture.deactivate(),t.colorTexture.deactivate(),t.pwfTexture.deactivate()},e.renderPieceFinish=(e,t)=>{},e.updateBufferObjects=(t,n)=>{e.getNeedToRebuildBufferObjects(t,n)&&e.buildBufferObjects(t,n)},e.getNeedToRebuildBufferObjects=(n,r)=>t.VBOBuildTime.getMTime()<e.getMTime()||t.VBOBuildTime.getMTime()<r.getMTime()||t.VBOBuildTime.getMTime()<t.renderable.getMTime()||t.VBOBuildTime.getMTime()<r.getProperty().getMTime()||t.VBOBuildTime.getMTime()<t.currentInput.getMTime()||t.VBOBuildTime.getMTime()<t.resliceGeom.getMTime()||!t.openGLTexture?.getHandle()||!t.colorTexture?.getHandle()||!t.pwfTexture?.getHandle(),e.buildBufferObjects=(n,r)=>{const i=t.currentInput;if(!i)return;const o=i.getPointData()?.getScalars();if(!o)return;const a=o.getNumberOfComponents();let s=(0,O.eS)(i,o);const l=t._openGLRenderWindow.getGraphicsResourceForObject(o),c=!l?.oglObject?.getHandle()||l?.hash!==s,u=t.renderable.getUpdatedExtents(),d=!!u.length;if(c&&!d){t.openGLTexture=A.Ay.newInstance(),t.openGLTexture.setOpenGLRenderWindow(t._openGLRenderWindow),t.openGLTexture.setOglNorm16Ext(t.context.getExtension("EXT_texture_norm16")),t.openGLTexture.resetFormatAndType();const n=i.getDimensions();t.openGLTexture.create3DFilterableFromDataArray(n[0],n[1],n[2],o,!1,u),t._openGLRenderWindow.setGraphicsResourceForObject(o,t.openGLTexture,s),o!==t._scalars&&(t._openGLRenderWindow.registerGraphicsResourceUser(o,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._scalars,e)),t._scalars=o}else t.openGLTexture=l.oglObject;if(d){t.renderable.setUpdatedExtents([]);const e=i.getDimensions();t.openGLTexture.create3DFilterableFromDataArray(e[0],e[1],e[2],o,!1,u)}const p=r.getProperty(),h=p.getIndependentComponents(),m=h?a:1,g=h?2*m:1,v=p.getRGBTransferFunction();s=(0,O.gP)(v,h,m);const y=t._openGLRenderWindow.getGraphicsResourceForObject(v);if(!y?.oglObject?.getHandle()||y?.hash!==s){const n=1024,r=new Uint8ClampedArray(n*g*3);if(t.colorTexture=A.Ay.newInstance(),t.colorTexture.setOpenGLRenderWindow(t._openGLRenderWindow),v){const e=new Float32Array(3*n);for(let t=0;t<m;t++){const i=p.getRGBTransferFunction(t),o=i.getRange();if(i.getTable(o[0],o[1],n,e,1),h)for(let i=0;i<3*n;i++)r[t*n*6+i]=255*e[i],r[t*n*6+i+3*n]=255*e[i];else for(let i=0;i<3*n;i++)r[t*n*6+i]=255*e[i]}t.colorTexture.resetFormatAndType(),t.colorTexture.create2DFromRaw(n,g,3,F.JA.UNSIGNED_CHAR,r)}else{for(let e=0;e<3*n;++e)r[e]=255*e/(3*(n-1)),r[e+1]=255*e/(3*(n-1)),r[e+2]=255*e/(3*(n-1));t.colorTexture.resetFormatAndType(),t.colorTexture.create2DFromRaw(n,1,3,F.JA.UNSIGNED_CHAR,r)}v&&(t._openGLRenderWindow.setGraphicsResourceForObject(v,t.colorTexture,s),v!==t._colorTransferFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(v,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._colorTransferFunc,e)),t._colorTransferFunc=v)}else t.colorTexture=y.oglObject;const b=p.getPiecewiseFunction();s=(0,O.gP)(b,h,m);const x=t._openGLRenderWindow.getGraphicsResourceForObject(b);if(!x?.oglObject?.getHandle()||x?.hash!==s){const n=1024,r=n*g,i=new Uint8ClampedArray(r);if(t.pwfTexture=A.Ay.newInstance(),t.pwfTexture.setOpenGLRenderWindow(t._openGLRenderWindow),b){const e=new Float32Array(r),i=new Float32Array(n);for(let t=0;t<m;++t){const r=p.getPiecewiseFunction(t);if(null===r)e.fill(1);else{const o=r.getRange();if(r.getTable(o[0],o[1],n,i,1),h)for(let r=0;r<n;r++)e[t*n*2+r]=i[r],e[t*n*2+r+n]=i[r];else for(let r=0;r<n;r++)e[t*n*2+r]=i[r]}}t.pwfTexture.resetFormatAndType(),t.pwfTexture.create2DFromRaw(n,g,1,F.JA.FLOAT,e)}else i.fill(255),t.pwfTexture.resetFormatAndType(),t.pwfTexture.create2DFromRaw(n,1,1,F.JA.UNSIGNED_CHAR,i);b&&(t._openGLRenderWindow.setGraphicsResourceForObject(b,t.pwfTexture,s),b!==t._pwFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(b,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._pwFunc,e)),t._pwFunc=b)}else t.pwfTexture=x.oglObject;const C=`${t.resliceGeom.getMTime()}A${t.renderable.getSlabThickness()}`;if(!t.tris.getCABO().getElementCount()||t.VBOBuildString!==C){const e=f.Ay.newInstance({numberOfComponents:3,values:t.resliceGeom.getPoints().getData()});e.setName("points");const n=f.Ay.newInstance({numberOfComponents:1,values:t.resliceGeom.getPolys().getData()}),r={points:e,cellOffset:0};if(t.renderable.getSlabThickness()>0){const e=t.resliceGeom.getPointData().getNormals();e?r.normals=e:k("Slab mode requested without normals")}t.tris.getCABO().createVBO(n,"polys",L.YL.SURFACE,r)}t.VBOBuildString=C,t.VBOBuildTime.modified()},e.updateShaders=(n,r,i)=>{if(t.lastBoundBO=n,e.getNeedToRebuildShaders(n,r,i)){const o={Vertex:null,Fragment:null,Geometry:null};e.buildShaders(o,r,i);const a=t._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);a!==n.getProgram()&&(n.setProgram(a),n.getVAO().releaseGraphicsResources()),n.getShaderSourceTime().modified()}else t._openGLRenderWindow.getShaderCache().readyShaderProgram(n.getProgram());n.getVAO().bind(),e.setMapperShaderParameters(n,r,i),e.setCameraShaderParameters(n,r,i),e.setPropertyShaderParameters(n,r,i)},e.setMapperShaderParameters=(n,r,o)=>{const a=n.getProgram();if(n.getCABO().getElementCount()&&(t.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){a.isUniformUsed("texture1")&&a.setUniformi("texture1",t.openGLTexture.getTextureUnit()),a.isAttributeUsed("vertexWC")&&(n.getVAO().addAttributeArray(a,n.getCABO(),"vertexWC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||k("Error setting vertexWC in shader VAO.")),a.isAttributeUsed("normalWC")&&(n.getVAO().addAttributeArray(a,n.getCABO(),"normalWC",n.getCABO().getNormalOffset(),n.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||k("Error setting normalWC in shader VAO.")),a.isUniformUsed("slabThickness")&&a.setUniformf("slabThickness",t.renderable.getSlabThickness()),a.isUniformUsed("spacing")&&a.setUniform3fv("spacing",t.currentInput.getSpacing()),a.isUniformUsed("slabType")&&a.setUniformi("slabType",t.renderable.getSlabType()),a.isUniformUsed("slabType")&&a.setUniformi("slabType",t.renderable.getSlabType()),a.isUniformUsed("slabTrapezoid")&&a.setUniformi("slabTrapezoid",t.renderable.getSlabTrapezoidIntegration());const e=n.getCABO().getCoordShiftAndScaleEnabled()?n.getCABO().getInverseShiftAndScaleMatrix():null;if(a.isUniformUsed("WCTCMatrix")){const n=t.currentInput,r=n.getDimensions();i.pB.copy(t.tmpMat4,n.getIndexToWorld()),i.pB.translate(t.tmpMat4,t.tmpMat4,[-.5,-.5,-.5]),i.pB.scale(t.tmpMat4,t.tmpMat4,r),i.pB.invert(t.tmpMat4,t.tmpMat4),e&&i.pB.multiply(t.tmpMat4,t.tmpMat4,e),a.setUniformMatrix("WCTCMatrix",t.tmpMat4)}a.isUniformUsed("vboScaling")&&a.setUniform3fv("vboScaling",n.getCABO().getCoordScale()??[1,1,1]),n.getAttributeUpdateTime().modified()}if(t.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",t.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){const t=e.getCoincidentParameters(r,o);n.getProgram().setUniformf("coffset",t.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",t.factor)}},e.setCameraShaderParameters=(e,n,r)=>{const o=t._openGLCamera.getKeyMatrices(n),a=t._openGLImageSlice.getKeyMatrices(),s=e.getCABO().getCoordShiftAndScaleEnabled()?e.getCABO().getInverseShiftAndScaleMatrix():null,l=e.getProgram();l.isUniformUsed("MCPCMatrix")&&(i.pB.identity(t.tmpMat4),l.setUniformMatrix("MCPCMatrix",U([o.wcpc,a.mcwc,s],i.pB,t.tmpMat4))),l.isUniformUsed("MCVCMatrix")&&(i.pB.identity(t.tmpMat4),l.setUniformMatrix("MCVCMatrix",U([o.wcvc,a.mcwc,s],i.pB,t.tmpMat4)))},e.setPropertyShaderParameters=(e,n,r)=>{const i=e.getProgram(),o=r.getProperty(),a=o.getOpacity();i.setUniformf("opacity",a);const s=t.openGLTexture.getComponents(),l=o.getIndependentComponents();if(l)for(let e=0;e<s;++e)i.setUniformf(`mix${e}`,o.getComponentWeight(e));const c=t.openGLTexture.getVolumeInfo();for(let e=0;e<s;e++){let t=o.getColorWindow(),n=o.getColorLevel();const r=l?e:0,a=o.getRGBTransferFunction(r);if(a&&o.getUseLookupTableScalarRange()){const e=a.getRange();t=e[1]-e[0],n=.5*(e[1]+e[0])}const s=c.scale[e]/t,u=(c.offset[e]-n)/t+.5;i.setUniformf(`cshift${e}`,u),i.setUniformf(`cscale${e}`,s)}const u=t.colorTexture.getTextureUnit();i.setUniformi("colorTexture1",u);for(let e=0;e<s;e++){let t=1,n=0;const r=l?e:0,a=o.getPiecewiseFunction(r);if(a){const r=a.getRange(),i=r[1]-r[0],o=.5*(r[0]+r[1]);t=c.scale[e]/i,n=(c.offset[e]-o)/i+.5}i.setUniformf(`pwfshift${e}`,n),i.setUniformf(`pwfscale${e}`,t)}const d=t.pwfTexture.getTextureUnit();i.setUniformi("pwfTexture1",d),i.setUniform4fv("backgroundColor",t.renderable.getBackgroundColor())},e.getNeedToRebuildShaders=(e,n,r)=>{const i=t.openGLTexture.getComponents(),o=r.getProperty().getIndependentComponents(),a=t.renderable.getSlabThickness(),s=t.renderable.getSlabType(),l=t.renderable.getSlabTrapezoidIntegration();let c=!1;return(!t.currentRenderPass&&t.lastRenderPassShaderReplacement||t.currentRenderPass&&t.currentRenderPass.getShaderReplacement()!==t.lastRenderPassShaderReplacement)&&(c=!0),!(!c&&t.lastHaveSeenDepthRequest===t.haveSeenDepthRequest&&0!==e.getProgram()?.getHandle()&&t.lastTextureComponents===i&&t.lastIndependentComponents===o&&t.lastSlabThickness===a&&t.lastSlabType===s&&t.lastSlabTrapezoidIntegration===l)&&(t.lastHaveSeenDepthRequest=t.haveSeenDepthRequest,t.lastTextureComponents=i,t.lastIndependentComponents=o,t.lastSlabThickness=a,t.lastSlabType=s,t.lastSlabTrapezoidIntegration=l,!0)},e.getShaderTemplate=(e,t,n)=>{e.Vertex=P,e.Fragment=R,e.Geometry=""},e.replaceShaderValues=(n,r,i)=>{if(e.replaceShaderTCoord(n,r,i),e.replaceShaderPositionVC(n,r,i),t.haveSeenDepthRequest){let e=n.Fragment;e=S.A.substitute(e,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,e=S.A.substitute(e,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,n.Fragment=e}e.replaceShaderCoincidentOffset(n,r,i)},e.replaceShaderTCoord=(e,n,r)=>{let i=e.Vertex;const o=e.Geometry;let a=e.Fragment;const s=t.renderable.getSlabThickness();i=S.A.substitute(i,"//VTK::TCoord::Dec",["uniform mat4 WCTCMatrix;","out vec3 fragTexCoord;"]).result;i=S.A.substitute(i,"//VTK::TCoord::Impl",["fragTexCoord = (WCTCMatrix * vertexWC).xyz;"]).result;const l=t.openGLTexture.getComponents(),c=r.getProperty().getIndependentComponents();let u=["in vec3 fragTexCoord;","uniform highp sampler3D texture1;","uniform mat4 WCTCMatrix;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;","uniform vec4 backgroundColor;"];if(c){for(let e=1;e<l;e++)u=u.concat([`uniform float cshift${e};`,`uniform float cscale${e};`,`uniform float pwfshift${e};`,`uniform float pwfscale${e};`]);switch(l){case 1:u=u.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:u=u.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:u=u.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:u=u.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:k("Unsupported number of independent coordinates.")}}s>0&&(u=u.concat(["uniform vec3 spacing;","uniform float slabThickness;","uniform int slabType;","uniform int slabTrapezoid;","uniform vec3 vboScaling;"]),u=u.concat(["vec4 compositeValue(vec4 currVal, vec4 valToComp, int trapezoid)","{","  vec4 retVal = vec4(1.0);","  if (slabType == 0) // min","  {","    retVal = min(currVal, valToComp);","  }","  else if (slabType == 1) // max","  {","    retVal = max(currVal, valToComp);","  }","  else if (slabType == 3) // sum","  {","    retVal = currVal + (trapezoid > 0 ? 0.5 * valToComp : valToComp); ","  }","  else // mean","  {","    retVal = currVal + (trapezoid > 0 ? 0.5 * valToComp : valToComp); ","  }","  return retVal;","}"])),a=S.A.substitute(a,"//VTK::TCoord::Dec",u).result;let d=["if (any(greaterThan(fragTexCoord, vec3(1.0))) || any(lessThan(fragTexCoord, vec3(0.0))))","{","  // set the background color and exit","  gl_FragData[0] = backgroundColor;","  return;","}","vec4 tvalue = texture(texture1, fragTexCoord);"];if(s>0&&(d=d.concat(["// Get the first and last samples","int numSlices = 1;","float scaling = min(min(spacing.x, spacing.y), spacing.z) * 0.5;","vec3 normalxspacing = scaling * normalWCVSOutput;","float distTraveled = length(normalxspacing);","int trapezoid = 0;","while (distTraveled < slabThickness * 0.5)","{","  distTraveled += length(normalxspacing);","  float fnumSlices = float(numSlices);","  if (distTraveled > slabThickness * 0.5)","  {","    // Before stepping outside the slab, sample at the boundaries","    normalxspacing = normalWCVSOutput * slabThickness * 0.5 / fnumSlices;","    trapezoid = slabTrapezoid;","  }","  vec3 fragTCoordNeg = (WCTCMatrix * vec4(vertexWCVSOutput.xyz - fnumSlices * normalxspacing * vboScaling, 1.0)).xyz;","  if (!any(greaterThan(fragTCoordNeg, vec3(1.0))) && !any(lessThan(fragTCoordNeg, vec3(0.0))))","  {","    vec4 newVal = texture(texture1, fragTCoordNeg);","    tvalue = compositeValue(tvalue, newVal, trapezoid);","    numSlices += 1;","  }","  vec3 fragTCoordPos = (WCTCMatrix * vec4(vertexWCVSOutput.xyz + fnumSlices * normalxspacing * vboScaling, 1.0)).xyz;","  if (!any(greaterThan(fragTCoordNeg, vec3(1.0))) && !any(lessThan(fragTCoordNeg, vec3(0.0))))","  {","    vec4 newVal = texture(texture1, fragTCoordPos);","    tvalue = compositeValue(tvalue, newVal, trapezoid);","    numSlices += 1;","  }","}","// Finally, if slab type is *mean*, divide the sum by the numSlices","if (slabType == 2)","{","  tvalue = tvalue / float(numSlices);","}"])),c){const e=["r","g","b","a"];for(let t=0;t<l;++t)d=d.concat([`vec3 tcolor${t} = mix${t} * texture2D(colorTexture1, vec2(tvalue.${e[t]} * cscale${t} + cshift${t}, height${t})).rgb;`,`float compWeight${t} = mix${t} * texture2D(pwfTexture1, vec2(tvalue.${e[t]} * pwfscale${t} + pwfshift${t}, height${t})).r;`]);switch(l){case 1:d=d.concat(["gl_FragData[0] = vec4(tcolor0.rgb, compWeight0 * opacity);"]);break;case 2:d=d.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:d=d.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:d=d.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:k("Unsupported number of independent coordinates.")}}else switch(l){case 1:d=d.concat(["// Dependent components","float intensity = tvalue.r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]);break;case 2:d=d.concat(["float intensity = tvalue.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tvalue.g + pwfshift0);"]);break;case 3:d=d.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]);break;default:d=d.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"])}a=S.A.substitute(a,"//VTK::TCoord::Impl",d).result,e.Vertex=i,e.Fragment=a,e.Geometry=o},e.replaceShaderPositionVC=(n,r,i)=>{let o=n.Vertex;const a=n.Geometry;let s=n.Fragment;const l=t.renderable.getSlabThickness();let c=["attribute vec4 vertexWC;"];c=c.concat([`//${e.getMTime()}${t.resliceGeomUpdateString}`]),l>0&&(c=c.concat(["attribute vec3 normalWC;","varying vec3 normalWCVSOutput;","varying vec4 vertexWCVSOutput;"])),o=S.A.substitute(o,"//VTK::PositionVC::Dec",c).result;let u=["gl_Position = MCPCMatrix * vertexWC;"];l>0&&(u=u.concat(["normalWCVSOutput = normalWC;","vertexWCVSOutput = vertexWC;"])),o=S.A.substitute(o,"//VTK::PositionVC::Impl",u).result,o=S.A.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result;let d=[];l>0&&(d=d.concat(["varying vec3 normalWCVSOutput;","varying vec4 vertexWCVSOutput;"])),s=S.A.substitute(s,"//VTK::PositionVC::Dec",d).result,n.Vertex=o,n.Geometry=a,n.Fragment=s},e.updateResliceGeometry=()=>{let e="";const n=t.currentInput,r=n?.getBounds();let o=!0,s=2;const l=t.renderable.getSlicePolyData(),c=t.renderable.getSlicePlane();if(l)e=e.concat(`PolyData${l.getMTime()}`);else if(c){e=e.concat(`Plane${c.getMTime()}`);const t=i.w0.create();n&&(e=e.concat(`Image${n.getMTime()}`),i.w0.set(t,...n.getDirection()),i.w0.invert(t,t));const r=[...c.getNormal()];i.eR.transformMat3(r,r,t),[o,s]=function(e){x.f.normalize(e);const t=[0,0,0];for(let n=0;n<3;++n){i.eR.zero(t),t[n]=1;const r=x.f.dot(e,t);if(r<-.999999||r>.999999)return[!0,n]}return[!1,2]}(r)}else{const i=C.Ay.newInstance();i.setNormal(0,0,1);let o=[0,1,0,1,0,1];n&&(o=r),i.setOrigin(o[0],o[2],.5*(o[5]+o[4])),t.renderable.setSlicePlane(i),e=e.concat(`Plane${c?.getMTime()}`),n&&(e=e.concat(`Image${n.getMTime()}`))}if(!t.resliceGeom||t.resliceGeomUpdateString!==e){if(l)t.resliceGeom||(t.resliceGeom=a.Ay.newInstance()),t.resliceGeom.getPoints().setData(l.getPoints().getData(),3),t.resliceGeom.getPolys().setData(l.getPolys().getData(),1),t.resliceGeom.getPointData().setNormals(l.getPointData().getNormals());else if(c)if(o){const e=new Float32Array(12),r=n.worldToIndex(c.getOrigin(),[0,0,0]),i=[(s+1)%3,(s+2)%3].sort(),o=n.getSpatialExtent();let l=0;for(let t=0;t<2;++t)for(let n=0;n<2;++n)e[l+s]=r[s],e[l+i[0]]=o[2*i[0]+n],e[l+i[1]]=o[2*i[1]+t],l+=3;t.transform.setMatrix(n.getIndexToWorld()),t.transform.transformPoints(e,e);const u=new Uint16Array(8);u[0]=3,u[1]=0,u[2]=1,u[3]=3,u[4]=3,u[5]=0,u[6]=3,u[7]=2;const d=c.getNormal();x.f.normalize(d);const p=new Float32Array(12);for(let e=0;e<4;++e)p[3*e]=d[0],p[3*e+1]=d[1],p[3*e+2]=d[2];t.resliceGeom||(t.resliceGeom=a.Ay.newInstance()),t.resliceGeom.getPoints().setData(e,3),t.resliceGeom.getPolys().setData(u,1);const h=f.Ay.newInstance({numberOfComponents:3,values:p,name:"Normals"});t.resliceGeom.getPointData().setNormals(h)}else{t.outlineFilter.setInputData(n),t.cutter.setInputConnection(t.outlineFilter.getOutputPort()),t.cutter.setCutFunction(c),t.lineToSurfaceFilter.setInputConnection(t.cutter.getOutputPort()),t.lineToSurfaceFilter.update(),t.resliceGeom||(t.resliceGeom=a.Ay.newInstance());const e=t.lineToSurfaceFilter.getOutputData();t.resliceGeom.getPoints().setData(e.getPoints().getData(),3),t.resliceGeom.getPolys().setData(e.getPolys().getData(),1),t.resliceGeom.getPointData().setNormals(e.getPointData().getNormals());const r=c.getNormal(),i=t.resliceGeom.getNumberOfPoints();x.f.normalize(r);const o=new Float32Array(3*i);for(let e=0;e<i;++e)o[3*e]=r[0],o[3*e+1]=r[1],o[3*e+2]=r[2];const s=f.Ay.newInstance({numberOfComponents:3,values:o,name:"Normals"});t.resliceGeom.getPointData().setNormals(s)}else k("Something went wrong.","A default slice plane should have been created in the beginning of","updateResliceGeometry.");t.resliceGeomUpdateString=e,t.resliceGeom?.modified()}},e.setOpenGLTexture=e=>{e&&(t.openGLTexture=e,t._externalOpenGLTexture=!0)},e.delete=(0,r.h)((()=>{t._openGLRenderWindow&&n(t._openGLRenderWindow)}),e.delete)}const z={VBOBuildTime:{},VBOBuildString:null,haveSeenDepthRequest:!1,lastHaveSeenDepthRequest:!1,lastIndependentComponents:!1,lastTextureComponents:0,lastSlabThickness:0,lastSlabTrapezoidIntegration:0,lastSlabType:-1,openGLTexture:null,colorTextureString:null,pwfTextureString:null,resliceGeom:null,resliceGeomUpdateString:null,tris:null,colorTexture:null,pwfTexture:null,_externalOpenGLTexture:!1};function W(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,z,n),D.A.extend(e,t,n),T.A.implementReplaceShaderCoincidentOffset(e,t,n),T.A.implementBuildShadersWithReplacements(e,t,n),t.tris=h.Ay.newInstance(),t.openGLTexture=null,t.colorTexture=null,t.pwfTexture=null,t.VBOBuildTime={},(0,r.o)(t.VBOBuildTime),t.tmpMat4=i.pB.identity(new Float64Array(16)),t.outlineFilter=b.newInstance(),t.outlineFilter.setGenerateFaces(!0),t.outlineFilter.setGenerateLines(!1),t.cubePolyData=a.Ay.newInstance(),t.cutter=p.Ay.newInstance(),t.lineToSurfaceFilter=d.newInstance(),t.transform=E.newInstance(),(0,r.g)(e,t,["openGLTexture"]),G(e,t)}const j=(0,r.n)(W,"vtkOpenGLImageResliceMapper");(0,B.c9)("vtkImageResliceMapper",j);n(6814),n(82967),n(64501),n(8126),n(95785),n(68464),n(26910),n(24210);var H=n(94520),K=n(9806),q=n(94363),$=n(83259),X=n(20461),Y=n(50440);const{SlicingMode:J}=H.A;const Z=new Float64Array(16),Q=new Float64Array(16),ee=new Float64Array(16),te=new Float64Array(4),ne=new Float64Array(4);const re={rowLength:1024};function ie(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,re,n),q.Ay.extend(e,t,n),e.setFragmentShaderTemplate("\n//VTK::Renderer::Dec\n\n//VTK::Mapper::Dec\n\n//VTK::TCoord::Dec\n\n//VTK::Image::Dec\n\n//VTK::RenderEncoder::Dec\n\n//VTK::IOStructs::Dec\n\n@fragment\nfn main(\n//VTK::IOStructs::Input\n)\n//VTK::IOStructs::Output\n{\n  var output: fragmentOutput;\n\n  //VTK::Image::Sample\n\n  // var computedColor: vec4<f32> = vec4<f32>(1.0,0.7, 0.5, 1.0);\n\n//VTK::RenderEncoder::Impl\n\n  return output;\n}\n"),t.UBO=$.Ay.newInstance({label:"mapperUBO"}),t.UBO.addEntry("SCTCMatrix","mat4x4<f32>"),t.UBO.addEntry("Origin","vec4<f32>"),t.UBO.addEntry("Axis2","vec4<f32>"),t.UBO.addEntry("Axis1","vec4<f32>"),t.UBO.addEntry("cScale","vec4<f32>"),t.UBO.addEntry("cShift","vec4<f32>"),t.lutBuildTime={},(0,r.o)(t.lutBuildTime,{mtime:0}),t.imagemat=i.pB.identity(new Float64Array(16)),t.imagematinv=i.pB.identity(new Float64Array(16)),t.VBOBuildTime={},(0,r.o)(t.VBOBuildTime),function(e,t){t.classHierarchy.push("vtkWebGPUImageMapper"),e.buildPass=n=>{if(n){t.WebGPUImageSlice=e.getFirstAncestorOfType("vtkWebGPUImageSlice"),t.WebGPURenderer=t.WebGPUImageSlice.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getParent(),t.device=t.WebGPURenderWindow.getDevice();const n=t.WebGPURenderer.getRenderable();t.renderable.getSliceAtFocalPoint()&&t.renderable.setSliceFromCamera(n.getActiveCamera())}},e.translucentPass=t=>{t&&e.render()},e.opaquePass=t=>{t&&e.render()},e.render=()=>{t.renderable.update(),t.currentInput=t.renderable.getInputData(),e.prepareToDraw(t.WebGPURenderer.getRenderEncoder()),t.renderEncoder.registerDrawCallback(t.pipeline,e.draw)},e.computePipelineHash=()=>{const e=t.currentInput.getExtent();e[0]===e[1]||e[2]===e[3]||e[4]===e[5]?(t.dimensions=2,t.pipelineHash="img2"):(t.dimensions=3,t.pipelineHash="img3")},e.updateUBO=()=>{const n=t.UBO.getSendTime(),r=t.WebGPUImageSlice.getRenderable(),o=r.getMapper();if(e.getMTime()>n||t.renderable.getMTime()>n||r.getProperty().getMTime()>n){const e=o.getInputData(),n=t.WebGPURenderer.getStabilizedCenterByReference();i.pB.identity(Z),i.pB.translate(Z,Z,n);const a=r.getMatrix();i.pB.transpose(Q,a),i.pB.invert(Q,Q),i.pB.multiply(Z,Q,Z);const s=e.getWorldToIndex();i.pB.multiply(Z,s,Z),i.pB.invert(ee,Z),i.pB.fromTranslation(Q,[.5,.5,.5]),i.pB.multiply(Z,Q,Z);const l=e.getDimensions();i.pB.identity(Q),i.pB.scale(Q,Q,[1/l[0],1/l[1],1/l[2]]),i.pB.multiply(Z,Q,Z),t.UBO.setArray("SCTCMatrix",Z);const c=t.currentInput.getExtent(),{ijkMode:u}=t.renderable.getClosestIJKAxis();let d=t.renderable.getSlice();u!==t.renderable.getSlicingMode()&&(d=t.renderable.getSliceAtPosition(d));let p=2,f=0,h=1;u===J.I?(p=0,f=1,h=2):u===J.J&&(p=1,f=2,h=0),te[p]=d,te[f]=c[2*f]-.5,te[h]=c[2*h]-.5,te[3]=1,i.ln.transformMat4(te,te,ee),t.UBO.setArray("Origin",te),ne[p]=d,ne[f]=c[2*f+1]+.5,ne[h]=c[2*h]-.5,ne[3]=1,i.ln.transformMat4(ne,ne,ee),i.ln.subtract(ne,ne,te),ne[3]=1,t.UBO.setArray("Axis1",ne),ne[p]=d,ne[f]=c[2*f]-.5,ne[h]=c[2*h+1]+.5,ne[3]=1,i.ln.transformMat4(ne,ne,ee),i.ln.subtract(ne,ne,te),ne[3]=1,t.UBO.setArray("Axis2",ne);const m=[1,1,1,1],g=[0,0,0,0],v=t.textureViews[0],y=v.getTexture().getScale(),b=v.getTexture().getNumberOfComponents();for(let e=0;e<b;e++){let t=r.getProperty().getColorWindow(),n=r.getProperty().getColorLevel();const i=0,o=r.getProperty().getRGBTransferFunction(i);if(o){const e=o.getRange();t=e[1]-e[0],n=.5*(e[1]+e[0])}m[e]=y/t,g[e]=-n/t+.5}t.UBO.setArray("cScale",m),t.UBO.setArray("cShift",g),t.UBO.sendIfNeeded(t.device)}},e.updateLUTImage=()=>{const n=t.WebGPUImageSlice.getRenderable().getProperty();e.getTextureViews()[0].getTexture().getNumberOfComponents();const r=function(e,t,n){if(t.apply(e)){const t=e.getIndependentComponents();return`${e.getMTime()}-${t}-${n}`}return"0"}(n,n.getRGBTransferFunction,1);if(t.colorTextureString!==r){t.numRows=1;const e=new Uint8ClampedArray(2*t.numRows*t.rowLength*4);let i=n.getRGBTransferFunction();if(i){const r=new Float32Array(3*t.rowLength);for(let o=0;o<1;o++){i=n.getRGBTransferFunction(o);const a=i.getRange();i.getTable(a[0],a[1],t.rowLength,r,1);for(let n=0;n<t.rowLength;n++){const i=o*t.rowLength*8+4*n;e[i]=255*r[3*n],e[i+1]=255*r[3*n+1],e[i+2]=255*r[3*n+2],e[i+3]=255;for(let n=0;n<4;n++)e[i+4*t.rowLength+n]=e[i+n]}}}else for(let n=0;n<t.rowLength;++n){const r=255*n/(t.rowLength-1);e[4*n]=r,e[4*n+1]=r,e[4*n+2]=r,e[4*n+3]=255;for(let r=0;r<4;r++)e[4*n+4*t.rowLength+r]=e[4*n+r]}{const n={nativeArray:e,width:t.rowLength,height:2*t.numRows,depth:1,format:"rgba8unorm"},r=t.device.getTextureManager().getTexture(n).createView("tfunTexture");t.textureViews[1]=r}t.colorTextureString=r}};const n=e.updateBuffers;e.updateBuffers=()=>{n();const r=t.device.getTextureManager().getTextureForImageData(t.currentInput),i=t.textureViews;if(!i[0]||i[0].getTexture()!==r){const e=r.createView("imgTexture");i[0]=e}e.updateLUTImage(),e.updateUBO();const o=t.WebGPUImageSlice.getRenderable().getProperty().getInterpolationType()===M.V.NEAREST?"nearest":"linear";t.clampSampler&&o===t.clampSampler.getOptions().minFilter||(t.clampSampler=X.Ay.newInstance({label:"clampSampler"}),t.clampSampler.create(t.device,{minFilter:o,magFilter:o}),t.additionalBindables=[t.clampSampler])};const r=e.getShaderReplacements();e.replaceShaderPosition=(e,n,r)=>{const i=n.getShaderDescription("vertex");i.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let o=i.getCode();const a=["var pos: vec4<f32> = mapperUBO.Origin +","   (vertexBC.x * 0.5 + 0.5) * mapperUBO.Axis1 + (vertexBC.y * 0.5 + 0.5) * mapperUBO.Axis2;","pos.w = 1.0;"];2===t.dimensions?a.push("var tcoord : vec2<f32> = (mapperUBO.SCTCMatrix * pos).xy;"):a.push("var tcoord : vec3<f32> = (mapperUBO.SCTCMatrix * pos).xyz;"),a.push("output.tcoordVS = tcoord;","output.Position = rendererUBO.SCPCMatrix * pos;"),o=K.Ay.substitute(o,"//VTK::Position::Impl",a).result,i.setCode(o)},r.set("replaceShaderPosition",e.replaceShaderPosition),e.replaceShaderTCoord=(e,n,r)=>{const i=n.getShaderDescription("vertex");2===t.dimensions?i.addOutput("vec2<f32>","tcoordVS"):i.addOutput("vec3<f32>","tcoordVS")},r.set("replaceShaderTCoord",e.replaceShaderTCoord),e.replaceShaderImage=(e,n,r)=>{const i=n.getShaderDescription("fragment");let o=i.getCode();t.dimensions,o=K.Ay.substitute(o,"//VTK::Image::Sample",["    var computedColor: vec4<f32> =","      textureSampleLevel(imgTexture, clampSampler, input.tcoordVS, 0.0);","//VTK::Image::Sample"]).result,o=K.Ay.substitute(o,"//VTK::Image::Sample",["    var coord: vec2<f32> =","      vec2<f32>(computedColor.r * mapperUBO.cScale.r + mapperUBO.cShift.r, 0.5);","    computedColor = textureSampleLevel(tfunTexture, clampSampler, coord, 0.0);"]).result,i.setCode(o)},r.set("replaceShaderImage",e.replaceShaderImage)}(e,t)}const oe=(0,r.n)(ie,"vtkWebGPUImageMapper");(0,Y.c9)("vtkImageMapper",oe);const ae={bufferShift:void 0,keyMatrixTime:null,keyMatrices:null,propID:void 0};function se(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ae,n),D.A.extend(e,t,n),t.keyMatricesTime={},(0,r.o)(t.keyMatricesTime,{mtime:0}),t.keyMatrices={normalMatrix:new Float64Array(16),bcwc:new Float64Array(16),bcsc:new Float64Array(16)},t.keyMatrixTime={},(0,r.o)(t.keyMatrixTime,{mtime:0}),t.keyMatrices={mcwc:i.pB.identity(new Float64Array(16))},t.bufferShift=[0,0,0,0],(0,r.g)(e,t,["propID","keyMatricesTime"]),function(e,t){t.classHierarchy.push("vtkWebGPUImageSlice"),e.buildPass=n=>{if(t.renderable&&t.renderable.getVisibility()&&n){if(!t.renderable)return;t.WebGPURenderer=e.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),void 0===t.propID&&(t.propID=t.WebGPURenderWindow.getUniquePropID()),e.prepareNodes(),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes()}},e.traverseOpaquePass=n=>{t.renderable&&t.renderable.getNestedVisibility()&&t.renderable.getIsOpaque()&&(!t.WebGPURenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.children.forEach((e=>{e.traverse(n)})),e.apply(n,!1))},e.traverseTranslucentPass=n=>{!t.renderable||!t.renderable.getNestedVisibility()||t.renderable.getIsOpaque()||t.WebGPURenderer.getSelector()&&!t.renderable.getNestedPickable()||(e.apply(n,!0),t.children.forEach((e=>{e.traverse(n)})),e.apply(n,!1))},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;t.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},e.getBufferShift=n=>(e.getKeyMatrices(n),t.bufferShift),e.getKeyMatrices=e=>{if(Math.max(t.renderable.getMTime(),e.getStabilizedTime())>t.keyMatricesTime.getMTime()){t.renderable.computeMatrix();const n=t.renderable.getMatrix(),r=e.getStabilizedCenterByReference();t.bufferShift[0]=n[3]-r[0],t.bufferShift[1]=n[7]-r[1],t.bufferShift[2]=n[11]-r[2],i.pB.transpose(t.keyMatrices.bcwc,n),t.renderable.getIsIdentity()?i.pB.identity(t.keyMatrices.normalMatrix):(i.pB.copy(t.keyMatrices.normalMatrix,t.keyMatrices.bcwc),t.keyMatrices.normalMatrix[3]=0,t.keyMatrices.normalMatrix[7]=0,t.keyMatrices.normalMatrix[11]=0,i.pB.invert(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix),i.pB.transpose(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix)),i.pB.translate(t.keyMatrices.bcwc,t.keyMatrices.bcwc,[-t.bufferShift[0],-t.bufferShift[1],-t.bufferShift[2]]),i.pB.translate(t.keyMatrices.bcsc,t.keyMatrices.bcwc,[-r[0],-r[1],-r[2]]),t.keyMatricesTime.modified()}return t.keyMatrices}}(e,t)}const le=(0,r.n)(se,"vtkWebGPUImageSlice");(0,Y.c9)("vtkImageSlice",le);const ce={propID:void 0,keyMatricesTime:null};function ue(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ce,n),D.A.extend(e,t,n),t.keyMatricesTime={},r.m.obj(t.keyMatricesTime,{mtime:0}),t.keyMatrices={bcwc:new Float64Array(16),bcsc:new Float64Array(16)},r.m.get(e,t,["propID","keyMatricesTime"]),function(e,t){t.classHierarchy.push("vtkWebGPUVolume"),e.buildPass=n=>{t.renderable&&t.renderable.getVisibility()&&n&&(t.WebGPURenderer=e.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getFirstAncestorOfType("vtkWebGPURenderWindow"),void 0===t.propID&&(t.propID=t.WebGPURenderWindow.getUniquePropID()),t.renderable.getMapper().update())},e.queryPass=(n,r)=>{if(n){if(!t.renderable||!t.renderable.getVisibility())return;const n=t.renderable.getMapper().getBounds();if(!n||6!==n.length||n[0]>n[1])return;r.addVolume(e)}};const n=new Float64Array(3),r=new Float64Array(3);e.getBoundingCubePoints=(e,i)=>{const o=t.renderable.getMapper().getInputData();if(!o)return;const a=o.getExtent(),s=t.renderable.getMatrix();let l=0;for(let t=4;t<6;t++){n[2]=a[t];for(let t=2;t<4;t++){n[1]=a[t];for(let t=0;t<2;t++){n[0]=a[t],o.indexToWorld(n,r);let c=i+3*l;e[c++]=s[0]*r[0]+s[1]*r[1]+s[2]*r[2]+s[3],e[c++]=s[4]*r[0]+s[5]*r[1]+s[6]*r[2]+s[7],e[c++]=s[8]*r[0]+s[9]*r[1]+s[10]*r[2]+s[11],l++}}}},e.getKeyMatrices=e=>{if(Math.max(t.renderable.getMTime(),e.getStabilizedTime())>t.keyMatricesTime.getMTime()){t.renderable.computeMatrix();const n=t.renderable.getMatrix(),r=e.getStabilizedCenterByReference();i.pB.transpose(t.keyMatrices.bcwc,n),i.pB.translate(t.keyMatrices.bcsc,t.keyMatrices.bcwc,[-r[0],-r[1],-r[2]]),t.keyMatricesTime.modified()}return t.keyMatrices}}(e,t)}const de=r.m.newInstance(ue,"vtkWebGPUVolume");(0,Y.c9)("vtkVolume",de);n(77489);var pe=n(86252),fe=n(49038),he=n(32643),me=n(10364),ge=n(69372),ve=n(80221),ye=n(24623),be=n(80068),xe=n(9734),Ae=n(55500);const Ce={};let Te=Ae.F;function Se(e,t){const n=e.indexOf(":"),r=e.substring(0,n);let i=Ce[r];if(null==i){if(null==Te||"function"!=typeof Te)throw new Error(`No volume loader for scheme ${r} has been registered`);i=Te}const o=i(e,t);return o.promise.then((function(e){(0,ge.A)(me.A,he.A.VOLUME_LOADED,{volume:e})}),(function(t){const n={volumeId:e,error:t};(0,ge.A)(me.A,he.A.VOLUME_LOADED_FAILED,n)})),o}function we(e,t={imageIds:[]}){if(void 0===e)throw new Error("loadVolume: parameter volumeId must not be undefined");let n=fe.Ay.getVolumeLoadObject(e);return void 0!==n?n.promise:(n=Se(e,t),n.promise.then((e=>e)))}async function _e(e,t){if(void 0===e)throw new Error("createAndCacheVolume: parameter volumeId must not be undefined");let n=fe.Ay.getVolumeLoadObject(e);return void 0!==n||(n=Se(e,t),fe.Ay.putVolumeLoadObject(e,n)),n.promise}function Ie(e,t){const n=fe.Ay.getVolume(e);if(!n)throw new Error(`Cannot created derived volume: Referenced volume with id ${e} does not exist.`);let{volumeId:r}=t;const{voxelRepresentation:i}=t;void 0===r&&(r=(0,ve.A)());const{metadata:o,dimensions:a,spacing:s,origin:l,direction:c}=n,u=n.isDynamicVolume()?n.getCurrentDimensionGroupImageIds():n.imageIds??[],d=(0,be.createAndCacheDerivedImages)(u,{targetBuffer:t.targetBuffer,voxelRepresentation:i}),p=d[0].dataType,f=d.map((e=>e.imageId)),h=new pe.Q({volumeId:r,dataType:p,metadata:structuredClone(o),dimensions:[a[0],a[1],a[2]],spacing:s,origin:l,direction:c,referencedVolumeId:e,imageIds:f,referencedImageIds:n.imageIds??[]});return fe.Ay.putVolumeSync(r,h),h}async function Ee(e,t){if(void 0===t)throw new Error("createAndCacheVolumeFromImages: parameter imageIds must not be undefined");if(void 0===e)throw new Error("createAndCacheVolumeFromImages: parameter volumeId must not be undefined");const n=fe.Ay.getVolume(e);if(n)return n;if(0===t.filter((e=>!fe.Ay.getImage(e))).length)return De(e,t);return await _e(e,{imageIds:t})}function De(e,t){if(void 0===t)throw new Error("createAndCacheVolumeFromImagesSync: parameter imageIds must not be undefined");if(void 0===e)throw new Error("createAndCacheVolumeFromImagesSync: parameter volumeId must not be undefined");const n=fe.Ay.getVolume(e);if(n)return n;const r=(0,xe.D)(t,e),i=new pe.Q({volumeId:e,dataType:r.dataType,metadata:structuredClone(r.metadata),dimensions:r.dimensions,spacing:r.spacing,origin:r.origin,direction:r.direction,referencedVolumeId:r.referencedVolumeId,imageIds:r.imageIds,referencedImageIds:r.referencedImageIds});return fe.Ay.putVolumeSync(e,i),i}function Oe(e,t={}){const{metadata:n,dimensions:r,spacing:i,origin:o,direction:a,scalarData:s,targetBuffer:l,preventCache:c=!1}=t,u=fe.Ay.getVolume(e);if(u)return u;const d=r[0]*r[1],p=s?s.constructor.name:l?.type??"Float32Array",f=d*r[2];let h;switch(p){case"Uint8Array":case"Int8Array":h=f;break;case"Uint16Array":case"Int16Array":h=2*f;break;case"Float32Array":h=4*f}if(!fe.Ay.isCacheable(h))throw new Error(`Cannot created derived volume: Volume with id ${e} is not cacheable.`);const m=[],g=[];for(let t=0;t<r[2];t++){const n=`${e}_slice_${t}`;m.push(n);const l=s.subarray(t*d,(t+1)*d),c=(0,be.createAndCacheLocalImage)(n,{scalarData:l,dimensions:[r[0],r[1]],spacing:[i[0],i[1]],origin:o,direction:a,targetBuffer:{type:p}});g.push(c)}const v=new pe.Q({volumeId:e,metadata:structuredClone(n),dimensions:[r[0],r[1],r[2]],spacing:i,origin:o,direction:a,imageIds:m,dataType:p}),y=ye.A.createImageVolumeVoxelManager({imageIds:m,dimensions:r,numberOfComponents:1,id:e});return v.voxelManager=y,c||fe.Ay.putVolumeSync(e,v),v}function Pe(e,t){Ce[e]=t}function Re(){return Object.keys(Ce)}function Ne(e){const t=Te;return Te=e,t}function Me(){return Te.name}function Le(e,t={}){return Ie(e,{...t,targetBuffer:{type:"Uint8Array",...t?.targetBuffer}})}function Fe(e,t,n=!1){return e.scalarData||(e.scalarData=new Uint8Array(e.dimensions[0]*e.dimensions[1]*e.dimensions[2])),Oe(t,{...e,preventCache:n})}},74876:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addProvider:()=>i,get:()=>s,removeAllProviders:()=>a,removeProvider:()=>o});const r=[];function i(e,t=0){let n;for(n=0;n<r.length&&!(r[n].priority<=t);n++);r.splice(n,0,{priority:t,provider:e})}function o(e){for(let t=0;t<r.length;t++)if(r[t].provider===e){r.splice(t,1);break}}function a(){for(;r.length>0;)r.pop()}function s(e,...t){for(let n=0;n<r.length;n++){const i=r[n].provider(e,...t);if(void 0!==i)return i}}},51159:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(24743),i=n(43213);const o=new r.R("imageLoadPool");o.grabDelay=0,o.setMaxSimultaneousRequests(i.A.Interaction,1e3),o.setMaxSimultaneousRequests(i.A.Thumbnail,1e3),o.setMaxSimultaneousRequests(i.A.Prefetch,1e3);const a=o},91073:(e,t,n)=>{"use strict";var r=n(24743),i=n(43213);const o=new r.R("imageRetrievalPool");o.setMaxSimultaneousRequests(i.A.Interaction,200),o.setMaxSimultaneousRequests(i.A.Thumbnail,200),o.setMaxSimultaneousRequests(i.A.Prefetch,200),o.grabDelay=0},24743:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var r=n(43213),i=n(80221);class o{constructor(e){this.numRequests={[r.A.Interaction]:0,[r.A.Thumbnail]:0,[r.A.Prefetch]:0,[r.A.Compute]:0},this.id=e||(0,i.A)(),this.requestPool={[r.A.Interaction]:{0:[]},[r.A.Thumbnail]:{0:[]},[r.A.Prefetch]:{0:[]},[r.A.Compute]:{0:[]}},this.grabDelay=5,this.awake=!1,this.numRequests={[r.A.Interaction]:0,[r.A.Thumbnail]:0,[r.A.Prefetch]:0,[r.A.Compute]:0},this.maxNumRequests={[r.A.Interaction]:6,[r.A.Thumbnail]:6,[r.A.Prefetch]:5,[r.A.Compute]:1e3}}setMaxSimultaneousRequests(e,t){this.maxNumRequests[e]=t}getMaxSimultaneousRequests(e){return this.maxNumRequests[e]}destroy(){this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}addRequest(e,t,n,r=0){const i={requestFn:e,type:t,additionalDetails:n};void 0===this.requestPool[t][r]&&(this.requestPool[t][r]=[]),this.requestPool[t][r].push(i),this.startGrabbing()}filterRequests(e){Object.keys(this.requestPool).forEach((t=>{const n=this.requestPool[t];Object.keys(n).forEach((t=>{n[t]=n[t].filter((t=>e(t)))}))}))}clearRequestStack(e){if(!this.requestPool[e])throw new Error(`No category for the type ${e} found`);this.requestPool[e]={0:[]}}sendRequests(e){const t=this.maxNumRequests[e]-this.numRequests[e];let n=0;for(let r=0;r<t;r++){const t=this.getNextRequest(e);if(null===t)return!1;if(t){let r;this.numRequests[e]++,this.awake=!0;try{r=t.requestFn()}catch(e){console.warn("sendRequest failed",e)}r?.finally?r.finally((()=>{this.numRequests[e]--,this.startAgain()})):(this.numRequests[e]--,n++)}}return n&&this.startAgain(),!0}getNextRequest(e){const t=this.getSortedPriorityGroups(e);for(const n of t)if(this.requestPool[e][n].length)return this.requestPool[e][n].shift();return null}startGrabbing(){const e=this.sendRequests(r.A.Interaction),t=this.sendRequests(r.A.Thumbnail),n=this.sendRequests(r.A.Prefetch),i=this.sendRequests(r.A.Compute);e||t||n||i||(this.awake=!1)}startAgain(){this.awake&&(void 0!==this.grabDelay?this.timeoutHandle||(this.timeoutHandle=window.setTimeout((()=>{this.timeoutHandle=null,this.startGrabbing()}),this.grabDelay)):this.startGrabbing())}getSortedPriorityGroups(e){return Object.keys(this.requestPool[e]).map(Number).filter((t=>this.requestPool[e][t].length)).sort(((e,t)=>e-t))}getRequestPool(){return this.requestPool}}},24623:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(49038),i=n(67645),o=n(74638),a=n(56577);class s{get id(){return this._id}constructor(e,t){this.modifiedSlices=new Set,this.boundsIJK=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],this.scalarData=null,this._sliceDataCache=null,this.getAtIJK=(e,t,n)=>{const r=this.toIndex([e,t,n]);return this._get(r)},this.setAtIJK=(e,t,n,r)=>{const i=this.toIndex([e,t,n]),o=this._set(i,r);return!1!==o&&(this.modifiedSlices.add(n),s.addBounds(this.boundsIJK,[e,t,n])),o},this.getAtIJKPoint=([e,t,n])=>this.getAtIJK(e,t,n),this.setAtIJKPoint=([e,t,n],r)=>{this.setAtIJK(e,t,n,r)},this.getAtIndex=e=>this._get(e),this.setAtIndex=(e,t)=>{const n=this._set(e,t);if(!1!==n){const t=this.toIJK(e);this.modifiedSlices.add(t[2]),s.addBounds(this.boundsIJK,t)}return n},this.getMiddleSliceData=()=>{const e=Math.floor(this.dimensions[2]/2);return this.getSliceData({sliceIndex:e,slicePlane:2})},this.forEach=(e,t={})=>{const n=t.boundsIJK||this.getBoundsIJK(),r=t.isInObject||this.isInObject||(()=>!0),o=t.returnPoints||!1,s=t.imageData,l=Math.min(n[0][0],n[0][1]),c=Math.max(n[0][0],n[0][1]),u=Math.min(n[1][0],n[1][1]),d=Math.max(n[1][0],n[1][1]),p=Math.min(n[2][0],n[2][1]),f=Math.max(n[2][0],n[2][1]),h=[];if(s){return(0,a.X6)({voxelManager:this,imageData:t.imageData,bounds:[[l,c],[u,d],[p,f]],pointInShapeFn:r,callback:e,returnPoints:o})}if(this.map){if(this.map instanceof i.A)return this.rleForEach(e,t);for(const t of this.map.keys()){const n=this.toIJK(t);if(!r(null,n))continue;const i=this._get(t);o&&h.push({value:i,index:t,pointIJK:n,pointLPS:null}),e({value:i,index:t,pointIJK:n,pointLPS:null})}return h}for(let t=p;t<=f;t++){const n=t*this.frameSize;for(let i=u;i<=d;i++){for(let a=l,s=n+i*this.width+a;a<=c;a++,s++){const n=this.getAtIndex(s),l=[a,i,t];r(null,l)&&(o&&h.push({value:n,index:s,pointIJK:l,pointLPS:null}),e({value:n,index:s,pointIJK:[a,i,t],pointLPS:null}))}}}return h},this.getSliceData=({sliceIndex:e,slicePlane:t})=>{const[n,r,i]=this.dimensions,o=n*r,a=e*o;let s;const l=this.getConstructor();if("function"!=typeof l)return new Uint8Array(0);let c;switch(t){case 0:s=r*i,c=new l(s);for(let t=0;t<r;t++)for(let r=0;r<i;r++){const a=e+t*n+r*o;this.setSliceDataValue(c,t*i+r,this._get(a))}break;case 1:s=n*i,c=new l(s);for(let t=0;t<n;t++)for(let r=0;r<i;r++){const i=t+e*n+r*o;this.setSliceDataValue(c,t+r*n,this._get(i))}break;case 2:s=n*r,c=new l(s);for(let e=0;e<s;e++)this.setSliceDataValue(c,e,this._get(a+e));break;default:throw new Error("Oblique plane - todo - implement as ortho normal vector")}return c},this.dimensions=e,this.width=e[0],this.frameSize=this.width*e[1],this._get=t._get,this._set=t._set,this._id=t._id||"",this._getConstructor=t._getConstructor,this.numberOfComponents=this.numberOfComponents||1,this.scalarData=t.scalarData,this._getScalarData=t._getScalarData,this._updateScalarData=t._updateScalarData}getMinMax(){let e,t;return this.forEach((({value:n})=>{const r=Array.isArray(n);if(void 0===e&&(e=r?[...n]:n,t=r?[...n]:n),r)for(let r=0;r<n.length;r++)e[r]=Math.min(e[r],n[r]),t[r]=Math.max(t[r],n[r]);else e=Math.min(e,n),t=Math.max(t,n)}),{boundsIJK:this.getDefaultBounds()}),{min:e,max:t}}toIJK(e){return[e%this.width,Math.floor(e%this.frameSize/this.width),Math.floor(e/this.frameSize)]}toIndex(e){return e[0]+e[1]*this.width+e[2]*this.frameSize}getDefaultBounds(){return this.dimensions.map((e=>[0,e-1]))}getBoundsIJK(){return this.boundsIJK[0][0]<this.dimensions[0]?this.boundsIJK:this.getDefaultBounds()}rleForEach(e,t){const n=t?.boundsIJK||this.getBoundsIJK(),{isWithinObject:r}=t||{},i=this.map;if(i){i.defaultValue=void 0;for(let t=n[2][0];t<=n[2][1];t++)for(let o=n[1][0];o<=n[1][1];o++){const n=i.getRun(o,t);if(n)for(const i of n){const{start:n,end:a,value:s}=i,l=this.toIndex([0,o,t]);for(let i=n;i<a;i++){const n={value:s,index:l+i,pointIJK:[i,o,t]};!1!==r?.(n)&&e(n)}}}}else console.warn("No map found, you need to use a map voxel manager to use rleForEach")}getScalarData(e=!1){if(this.scalarData)return this._updateScalarData?.(this.scalarData),this.scalarData;if(this._getScalarData){const t=this._getScalarData();return e&&console.log("Not transient, should store value",t),t}throw new Error("No scalar data available")}setScalarData(e){this.scalarData=e}getScalarDataLength(){if(this.scalarData)return this.scalarData.length;if(this._getScalarDataLength)return this._getScalarDataLength();throw new Error("No scalar data available")}get sizeInBytes(){return this.getScalarDataLength()*this.bytePerVoxel}get bytePerVoxel(){if(this.scalarData)return this.scalarData.BYTES_PER_ELEMENT;return this._get(0).BYTES_PER_ELEMENT}clearBounds(){this.boundsIJK.map((e=>{e[0]=1/0,e[1]=-1/0}))}clear(){this.map?.clear(),this.clearBounds(),this.modifiedSlices.clear(),this.points?.clear()}getConstructor(){return this.scalarData?this.scalarData.constructor:this._getConstructor?this._getConstructor():(console.warn("No scalar data available or can be used to get the constructor"),Float32Array)}getArrayOfModifiedSlices(){return Array.from(this.modifiedSlices)}resetModifiedSlices(){this.modifiedSlices.clear()}setBounds(e){this.boundsIJK=e}static addBounds(e,t){e||(e=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]]),e[0][0]=Math.min(t[0],e[0][0]),e[0][1]=Math.max(t[0],e[0][1]),e[1][0]=Math.min(t[1],e[1][0]),e[1][1]=Math.max(t[1],e[1][1]),e[2][0]=Math.min(t[2],e[2][0]),e[2][1]=Math.max(t[2],e[2][1])}addPoint(e){const t=Array.isArray(e)?e[0]+this.width*e[1]+this.frameSize*e[2]:e;this.points||(this.points=new Set),this.points.add(t)}getPoints(){return this.points?[...this.points].map((e=>this.toIJK(e))):[]}setSliceDataValue(e,t,n){if(Array.isArray(n))for(let r=0;r<n.length;r++)e[t*n.length+r]=this.toNumber(n[r]);else e[t]=this.toNumber(n)}toNumber(e){return"number"==typeof e?e:Array.isArray(e)&&e[0]||0}static _createRGBScalarVolumeVoxelManager({dimensions:e,scalarData:t,numberOfComponents:n=3,id:r}){const i=new s(e,{_get:e=>(e*=n,[t[e++],t[e++],t[e++]]),_id:r||"_createRGBScalarVolumeVoxelManager",_set:(e,n)=>{e*=3;const r=!(0,o.Ay)(t[e],n);return t[e++]=n[0],t[e++]=n[1],t[e++]=n[2],r},numberOfComponents:n,scalarData:t});return i.clear=()=>{t.fill(0)},i}static createImageVolumeVoxelManager({dimensions:e,imageIds:t,numberOfComponents:n=1,id:i}){const a=e[0]*e[1];function l(n){const i=Math.floor(n/a);if(i<0||i>=e[2])return{};const o=t[i];if(!o)return console.warn(`ImageId not found for sliceIndex: ${i}`),{pixelData:null,pixelIndex:null};const s=r.Ay.getImage(o);if(!s)return console.warn(`Image not found for imageId: ${o}`),{pixelData:null,pixelIndex:null};return{voxelManager:s.voxelManager,pixelIndex:n%a}}const c=new s(e,{_get:function(e){const{voxelManager:t,pixelIndex:n}=l(e);return t&&null!==n?t.getAtIndex(n):null},_set:function(e,t){const{voxelManager:n,pixelIndex:r}=l(e);if(!n||null===r)return!1;const i=n.getAtIndex(r),a=!(0,o.Ay)(t,i);return a?(n.setAtIndex(r,t),!0):a},numberOfComponents:n,_getConstructor:()=>{const{voxelManager:e,pixelIndex:t}=l(0);return e&&null!==t?e.getConstructor():null},_id:i||"createImageVolumeVoxelManager"});return c.getMiddleSliceData=()=>{const t=Math.floor(e[2]/2);return c.getSliceData({sliceIndex:t,slicePlane:2})},c.clear=()=>{for(const e of t){r.Ay.getImage(e).voxelManager.clear()}},c.getRange=()=>{let e=1/0,n=-1/0;for(const i of t){const t=r.Ay.getImage(i);t&&(t.minPixelValue<e&&(e=t.minPixelValue),t.maxPixelValue>n&&(n=t.maxPixelValue))}return e===1/0&&n===-1/0?[0,0]:[e,n]},c._getScalarDataLength=()=>{const{voxelManager:t,pixelIndex:n}=l(0);return t&&null!==n?t.getScalarDataLength()*e[2]:0},c.getCompleteScalarDataArray=()=>{const t=c._getConstructor();if(!t)return new Uint8Array(0);const r=new t(c.getScalarDataLength()),i=e[0]*e[1]*n;for(let t=0;t<e[2];t++){const{voxelManager:e,pixelIndex:o}=l(t*i/n);if(e&&null!==o){const o=t*i,a=e.getScalarData();if(1===n)r.set(a,o);else for(let e=0;e<a.length;e+=n)for(let t=0;t<n;t++)r[o+e+t]=a[e+t]}}return r},c.setCompleteScalarDataArray=i=>{const o=e[0]*e[1]*n,a=c._getConstructor();let s=1/0,u=-1/0;for(let c=0;c<e[2];c++){const{voxelManager:e}=l(c*o/n);if(e&&a){const n=c*o,l=n+o,d=new a(o);if(d.set(i.subarray(n,l)),e.scalarData)e.scalarData.set(d),e.modifiedSlices.add(c);else for(let t=0;t<o;t++)e.setAtIndex(t,d[t]);for(let e=0;e<d.length;e++){const t=d[e];s=Math.min(s,t),u=Math.max(u,t)}const p=t[c],f=r.Ay.getImage(p);f&&(f.minPixelValue=s,f.maxPixelValue=u)}}for(let t=0;t<e[2];t++)c.modifiedSlices.add(t);c.boundsIJK=[[0,e[0]-1],[0,e[1]-1],[0,e[2]-1]]},c}static createScalarVolumeVoxelManager({dimensions:e,scalarData:t,numberOfComponents:n,id:r}){if(3!==e.length)throw new Error("Dimensions must be provided as [number, number, number] for [width, height, depth]");if(!n&&((n=t.length/e[0]/e[1]/e[2])>4||n<1||2===n))throw new Error(`Number of components ${n} must be 1, 3 or 4`);return n>1?s._createRGBScalarVolumeVoxelManager({dimensions:e,scalarData:t,numberOfComponents:n,id:r}):s._createNumberVolumeVoxelManager({dimensions:e,scalarData:t,id:r})}static createScalarDynamicVolumeVoxelManager({imageIdGroups:e,dimensions:t,dimensionGroupNumber:n=1,timePoint:i=0,numberOfComponents:o=1,id:a}){let l=0;if(void 0!==n?l=n-1:void 0!==i&&(console.warn("Warning: timePoint parameter is deprecated. Please use dimensionGroupNumber instead. timePoint is zero-based while dimensionGroupNumber starts at 1."),l=i),!o){const n=r.Ay.getImage(e[0][0]);if(!n)throw new Error("Unable to determine number of components: No image found");if((o=n.getPixelData().length/(t[0]*t[1]))>4||o<1||2===o)throw new Error(`Number of components ${o} must be 1, 3 or 4`)}const c=e.map((e=>s.createImageVolumeVoxelManager({dimensions:t,imageIds:e,numberOfComponents:o,id:a}))),u=new s(t,{_get:e=>c[l]._get(e),_set:(e,t)=>c[l]._set(e,t),numberOfComponents:o,_id:a||"createScalarDynamicVolumeVoxelManager"});return u.getScalarDataLength=()=>c[l].getScalarDataLength(),u.getConstructor=()=>c[l].getConstructor(),u.getRange=()=>c[l].getRange(),u.getMiddleSliceData=()=>c[l].getMiddleSliceData(),u.setTimePoint=e=>{console.warn("Warning: setTimePoint is deprecated. Please use setDimensionGroupNumber instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),u.setDimensionGroupNumber(e+1)},u.setDimensionGroupNumber=e=>{l=e-1,u._get=e=>c[l]._get(e),u._set=(e,t)=>c[l]._set(e,t)},u.getAtIndexAndTimePoint=(e,t)=>(console.warn("Warning: getAtIndexAndTimePoint is deprecated. Please use getAtIndexAndDimensionGroup instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),u.getAtIndexAndDimensionGroup(e,t+1)),u.getAtIndexAndDimensionGroup=(e,t)=>c[t-1]._get(e),u.getTimePointScalarData=e=>(console.warn("Warning: getTimePointScalarData is deprecated. Please use getDimensionGroupScalarData instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),u.getDimensionGroupScalarData(e+1)),u.getDimensionGroupScalarData=e=>c[e-1].getCompleteScalarDataArray(),u.getCurrentTimePointScalarData=()=>(console.warn("Warning: getCurrentTimePointScalarData is deprecated. Please use getCurrentDimensionGroupScalarData instead."),u.getCurrentDimensionGroupScalarData()),u.getCurrentDimensionGroupScalarData=()=>c[l].getCompleteScalarDataArray(),u.getCurrentTimePoint=()=>(console.warn("Warning: getCurrentTimePoint is deprecated. Please use getCurrentDimensionGroupNumber instead. Note that timePoint is zero-based while dimensionGroupNumber starts at 1."),l),u.getCurrentDimensionGroupNumber=()=>l+1,u}static createImageVoxelManager({width:e,height:t,scalarData:n,numberOfComponents:r=1,id:i}){const o=[e,t,1];if(!r&&((r=n.length/e/t)>4||r<1||2===r))throw new Error(`Number of components ${r} must be 1, 3 or 4`);return r>1?s._createRGBScalarVolumeVoxelManager({dimensions:o,scalarData:n,numberOfComponents:r,id:i}):s._createNumberVolumeVoxelManager({dimensions:o,scalarData:n,id:i})}static _createNumberVolumeVoxelManager({dimensions:e,scalarData:t,id:n}){const r=new s(e,{_get:e=>t[e],_set:(e,n)=>{const r=t[e]!==n;return t[e]=n,r},_getConstructor:()=>t.constructor,_id:n||"_createNumberVolumeVoxelManager"});return r.scalarData=t,r.clear=()=>{r.scalarData.fill(0)},r.getMiddleSliceData=()=>{const t=Math.floor(e[2]/2);return r.getSliceData({sliceIndex:t,slicePlane:2})},r}static createMapVoxelManager({dimension:e,id:t}){const n=new Map,r=new s(e,{_get:n.get.bind(n),_set:(e,t)=>n.set(e,t)&&!0,_id:t||"createMapVoxelManager"});return r.map=n,r}static createHistoryVoxelManager(e,t){const n=new Map,{dimensions:r}=e,i=new s(r,{_get:e=>n.get(e),_set:function(e,t){if(n.has(e))t===n.get(e)&&n.delete(e);else{const r=this.sourceVoxelManager.getAtIndex(e);if(r===t)return!1;n.set(e,r)}this.sourceVoxelManager.setAtIndex(e,t)},_id:t||"createHistoryVoxelManager"});return i.map=n,i.scalarData=e.scalarData,i.sourceVoxelManager=e,i}static createRLEHistoryVoxelManager(e,t){const{dimensions:n}=e,r=new i.A(n[0],n[1],n[2]),o=new s(n,{_get:e=>r.get(e),_set:function(e,t){const n=r.get(e);if(void 0===n){const n=this.sourceVoxelManager.getAtIndex(e);if(n===t||void 0===n&&0===t||null===t)return!1;r.set(e,n??0)}else t!==n&&null!==t||(r.delete(e),t=n);this.sourceVoxelManager.setAtIndex(e,t)},_getScalarData:i.A.getScalarData,_updateScalarData:e=>(r.updateScalarData(e),e),_id:t||"createRLEHistoryVoxelManager"});return o.map=r,o.sourceVoxelManager=e,o}static createLazyVoxelManager({dimensions:e,planeFactory:t,id:n}){const r=new Map,[i,o]=e,a=i*o,l=new s(e,{_get:e=>r.get(Math.floor(e/a))[e%a],_set:(e,n)=>{const s=Math.floor(e/a);let l=r.get(s);return l||(l=t(i,o),r.set(s,l)),l[e%a]=n,!0},_id:n||"createLazyVoxelManager"});return l.map=r,l}static createRLEVolumeVoxelManager({dimensions:e,id:t}){const[n,r,o]=e,a=new i.A(n,r,o),l=new s(e,{_get:e=>a.get(e),_set:(e,t)=>(a.set(e,t),!0),_getScalarData:i.A.getScalarData,_updateScalarData:e=>(a.updateScalarData(e),e),_id:t||"createRLEVolumeVoxelManager"});return l.map=a,l.getPixelData=a.getPixelData.bind(a),l}static createRLEImageVoxelManager({dimensions:e,id:t}){const[n,r]=e;return s.createRLEVolumeVoxelManager({dimensions:[n,r,1],id:t})}static addInstanceToImage(e){const{width:t,height:n}=e,r=e.voxelManager.getScalarData();r.length>=t*n?e.voxelManager=s.createScalarVolumeVoxelManager({dimensions:[t,n,1],scalarData:r}):(e.voxelManager=s.createRLEVolumeVoxelManager({dimensions:[t,n,1]}),e.getPixelData=e.voxelManager.getPixelData,e.sizeInBytes=5120)}}},87784:(e,t,n)=>{"use strict";n.d(t,{P:()=>o});var r=n(9175),i=n(13876);function o(e){const t=r.create(),n=e.getDimensions(),o=i.A.create3(n[0]),a=i.A.create3(n[1]),s=i.A.create3(n[2]),l=e.getDirection(),c=l.slice(0,3),u=l.slice(3,6),d=l.slice(6,9),p=e.getSpacing(),[f,h,m]=p,g=e.indexToWorld([0,0,0]),v=r.fromValues(c[0]*f,c[1]*f,c[2]*f),y=r.fromValues(u[0]*h,u[1]*h,u[2]*h),b=r.fromValues(d[0]*m,d[1]*m,d[2]*m),x=r.create();for(let e=0;e<n[0];e++)o.push(r.add(x,g,r.scale(x,v,e)));for(let e=0;e<n[1];e++)a.push(r.scale(x,y,e));for(let e=0;e<n[2];e++)s.push(r.scale(x,b,e));const A=o.getTypedArray(),C=a.getTypedArray(),T=s.getTypedArray();return(e,n=t)=>{const[r,i,o]=e,a=3*r,s=3*i,l=3*o;return n[0]=A[a]+C[s]+T[l],n[1]=A[a+1]+C[s+1]+T[l+1],n[2]=A[a+2]+C[s+2]+T[l+2],n}}},74268:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});const r=e=>e&&"object"==typeof e&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e),i=(e,t)=>{return t&&!0===t.clone&&r(e)?a((n=e,Array.isArray(n)?[]:{}),e,t):e;var n},o=(e,t,n)=>{const o=e.slice();return t.forEach((function(t,s){void 0===o[s]?o[s]=i(t,n):r(t)?o[s]=a(e[s],t,n):-1===e.indexOf(t)&&(o[s]=i(t,n))})),o},a=(e={},t={},n=void 0)=>{const s=Array.isArray(t),l=(n||{arrayMerge:o}).arrayMerge||o;return s?Array.isArray(e)?l(e,t,n):i(t,n):((e,t,n)=>{const o={};return r(e)&&Object.keys(e).forEach((function(t){o[t]=i(e[t],n)})),Object.keys(t).forEach((function(s){r(t[s])&&e[s]?o[s]=a(e[s],t[s],n):o[s]=i(t[s],n)})),o})(e,t,n)},s=a},9734:(e,t,n)=>{"use strict";n.d(t,{D:()=>d});var r=n(3823),i=n(1865),o=n(90537),a=n(32173),s=n(30169),l=n(26896),c=n(49038);const u={Uint8Array:"Uint8Array",Int16Array:"Int16Array",Uint16Array:"Uint16Array",Float32Array:"Float32Array"};function d(e,t){const n=(0,i.A)(e),{ImageOrientationPatient:a,PixelSpacing:s,Columns:l,Rows:c}=n,u=r.eR.fromValues(a[0],a[1],a[2]),d=r.eR.fromValues(a[3],a[4],a[5]),f=r.eR.create();r.eR.cross(f,u,d);const{zSpacing:h,origin:m,sortedImageIds:g}=(0,o.A)(e,f),v=e.length,y=[s[1],s[0],h],b=[l,c,v].map((e=>Math.floor(e))),x=[...u,...d,...f];return{dimensions:b,spacing:y,origin:m,dataType:p(g,n),direction:x,metadata:n,imageIds:g,volumeId:t,voxelManager:null,numberOfComponents:"RGB"===n.PhotometricInterpretation?3:1}}function p(e,t){const{BitsAllocated:n,PixelRepresentation:r}=t,i=1===r,o=function(e){const t=[0,Math.floor(e.length/2),e.length-1],n=t.map((t=>c.Ay.getImage(e[t])));if(!n.every(Boolean))return null;const r=n[0].getPixelData().constructor.name;if(n.every((e=>e.getPixelData().constructor.name===r))&&r in u)return u[r];return null}(e);if(o)return o;const[d,p,f]=[0,Math.floor(e.length/2),e.length-1],h=[d,p,f].map((t=>(0,a.A)(e[t]))),m=h.some((e=>e.rescaleIntercept<0||e.rescaleSlope<0)),g=h.some((e=>(0,s.a)(e))),v=(0,l.lk)();switch(n){case 8:case 24:return"Uint8Array";case 16:return v&&g?"Float32Array":i||m?"Int16Array":i||m?"Float32Array":"Uint16Array";case 32:return"Float32Array";default:throw new Error(`Bits allocated of ${n} is not defined to generate scalarData for the volume.`)}}},27119:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(74876);let i={};const o={add:(e,t)=>{o.addRaw(e,{...t,metadata:structuredClone(t.metadata)})},addRaw:(e,t)=>{const n=t.type;i[e]||(i[e]={}),i[e][n]=t.metadata},get:(e,t)=>i[t]?.[e],clear:()=>{i={}}};(0,r.addProvider)(o.get);const a=o},99576:(e,t,n)=>{"use strict";function r(e,t){switch(e){case"Float32Array":return Float32Array;case"Uint8Array":return Uint8Array;case"Uint16Array":case"Int16Array":return t?(console.debug(`${e} is not supported for volume rendering, switching back to Float32Array`),Float32Array):"Uint16Array"===e?Uint16Array:Int16Array;default:if(e)throw new Error("TargetBuffer should be Float32Array, Uint8Array, Uint16Array, or Int16Array");return Float32Array}}function i(e,t,n={}){const{isVolumeBuffer:i=!1}=n,o=r(e,i);return{numBytes:t*o.BYTES_PER_ELEMENT,TypedArrayConstructor:o}}n.d(t,{h:()=>i,j:()=>r})},58977:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});const r=(e,t,n)=>t-n/4*Math.log((1-e)/e)},69372:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(10364);function i(e=r.A,t,n=null){if(!t)throw new Error("Event type was not defined");const i=new CustomEvent(t,{detail:n,cancelable:!0});return e?.dispatchEvent(i)}},80221:(e,t,n)=>{"use strict";function r(){return"function"==typeof crypto.randomUUID?crypto.randomUUID():([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}n.d(t,{A:()=>r})},36625:(e,t,n)=>{"use strict";n.d(t,{Qy:()=>a,zj:()=>i});let r={};function i(){return r}let o=!1;function a(){if(!r.addons?.polySeg)return console.warn("PolySeg add-on not configured. This will prevent automatic conversion between segmentation representations (labelmap, contour, surface). To enable these features, install @cornerstonejs/polymorphic-segmentation and register it during initialization: cornerstoneTools.init({ addons: { polySeg } })."),null;const e=r.addons.polySeg;return o||(e.init(),o=!0),e}},94430:(e,t,n)=>{"use strict";n.d(t,{A:()=>o,i:()=>s});const r=Symbol("DefinedCursors"),i=new Set(["alias","all-scroll","auto","cell","col-resize","context-menu","copy","crosshair","default","e-resize","ew-resize","grab","grabbing","help","move","ne-resize","nesw-resize","no-drop","none","not-allowed","n-resize","ns-resize","nw-resize","nwse-resize","pointer","progress","row-resize","se-resize","s-resize","sw-resize","text","vertical-text","wait","w-resize","zoom-in","zoom-out"]);class o{constructor(e,t){this.name=e+"",this.fallback=t}getName(){return this.name+""}addFallbackStyleProperty(e){const{fallback:t}=this;return t instanceof o?`${e}, ${t.getStyleProperty()}`:e+""}getStyleProperty(){return this.addFallbackStyleProperty(this.name)+""}static getDefinedCursor(e){const t=a(o,r);let n=t.get(e);return n instanceof o?n:i.has(e)?(n=new o(e),t.set(e,n),n):void 0}static setDefinedCursor(e,t){if(t instanceof o){return a(o,r).set(e,t),!0}return!1}}function a(e,t){let n=e[t];return n instanceof Map||(n=new Map,Object.defineProperty(e,t,{value:n})),n}const s=i.values()},7001:(e,t,n)=>{"use strict";n.d(t,{hideElementCursor:()=>s,resetElementCursor:()=>a});var r=n(94430);const i=Symbol("ElementCursorsMap");function o(e,t){const n=l(e);n[1]=n[0],n[0]=t,e.style.cursor=(t instanceof r.A?t:r.A.getDefinedCursor("auto")).getStyleProperty()}function a(e){o(e,l(e)[1])}function s(e){o(e,r.A.getDefinedCursor("none"))}function l(e){let t=l[i];t instanceof WeakMap||(t=new WeakMap,Object.defineProperty(l,i,{value:t}));let n=t.get(e);return n||(n=[null,null],t.set(e,n)),n}},79475:(e,t,n)=>{"use strict";var r=n(94430);n(15327);r.A;var i=n(99737);const o={iconContent:"",iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:'\n    <path stroke="{{color}}" d="M8 16L8 0"></path>\n    <path stroke="{{color}}" d="M16 8L0 8"></path>\n  '},a={x:127,y:60},s='\n<rect fill="{{color}}" x="80.19" y="25.03" width="47.14" height="15.85"/>\n',l='\n<rect fill="{{color}}" x="80.19" y="25.03" width="47.14" height="15.85"/>\n<rect fill="{{color}}" x="95.84" y="9.38" width="15.85" height="47.14"/>\n',c='<path fill="{{color}}" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',u='<path fill="{{color}}" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',d='<path fill="{{color}}" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',p={Angle:f(o,{name:"Angle",iconContent:'<path fill="{{color}}" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n    50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n    10l50 50q10 10 10 23z" />',viewBox:{x:1792,y:1792}}),ArrowAnnotate:f(o,{name:"ArrowAnnotate",iconContent:'<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">\n    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />\n  </g>',viewBox:{x:24,y:24}}),Bidirectional:f(o,{name:"Bidirectional",iconContent:'<g fill="{{color}}" stroke-width="3" stroke="{{color}}">\n    <path d="M27.63 3.21L3.12 28.81"></path>\n    <path d="M27.63 15.75L15.27 4.43"></path>\n    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>\n    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>\n    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>\n    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>\n  </g>',viewBox:{x:48,y:48}}),CobbAngle:f(o,{name:"CobbAngle",iconContent:'<g stroke="{{color}}" stroke-width="3">\n    <path d="M28.59 2.34L3.82 12.32"></path>\n    <path d="M28.59 29.66L3.82 19.68"></path>\n    <path stroke-dasharray="2" fill-opacity="0" d="M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63">\n    </path>\n  </g>',viewBox:{x:32,y:32}}),CircleROI:f(o,{name:"CircleROI",iconContent:'<circle stroke="{{color}}" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',viewBox:{x:32,y:32}}),EllipticalROI:f(o,{name:"EllipticalROI",iconContent:'<path stroke="{{color}}" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z" />',viewBox:{x:32,y:32}}),FreehandROI:f(o,{name:"FreehandROI",iconContent:'<g fill="{{color}}" stroke="{{color}}" stroke-width="2">\n    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>\n    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>\n    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>\n    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>\n    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>\n    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>\n    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>\n    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>\n    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>\n    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>\n    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>\n    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>\n    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>\n    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>\n    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>\n    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>\n    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>\n    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>\n    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>\n    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>\n    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>\n    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>\n    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>\n    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>\n    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>\n    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>\n    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>\n    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>\n    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>\n    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>\n  </g>',viewBox:{x:18,y:18}}),FreehandROISculptor:f(o,{name:"FreehandROISculptor",iconContent:'<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">\n    <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>\n    <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>\n    <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>\n    <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>\n    <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>\n    <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>\n    <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>\n    <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>\n    <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>\n    <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>\n    <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>\n    <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>\n    <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>\n    <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>\n    <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>\n    <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>\n    <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>\n    <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>\n    <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>\n    <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>\n    <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>\n    <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>\n    <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>\n    <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>\n    <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>\n    <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>\n    <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>\n    <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>\n    <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>\n    <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>\n    <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>\n    <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>\n  </g>',viewBox:{x:18,y:18}}),Length:f(o,{name:"Length",iconContent:'<g id="length-group" fill="none" stroke-width="1" stroke="{{color}}" stroke-linecap="round" stroke-linejoin="round">\n    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />\n  </g>',viewBox:{x:24,y:24}}),Height:f(o,{name:"Height",iconContent:'<path d="m 6 22 l 8.5 0 v -16 h 8" stroke-width="3" fill="none" stroke="{{color}}" />',viewBox:{x:24,y:24}}),Probe:f(o,{name:"Probe",iconContent:'<path fill="{{color}}" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z" />',viewBox:{x:1792,y:1792}}),RectangleROI:f(o,{name:"RectangleROI",iconContent:'<path fill="{{color}}" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z" />',viewBox:{x:1792,y:1792}}),Label:f(o,{name:"Label",iconContent:'<path fill="{{color}}" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z" />',viewBox:{x:1792,y:1792}}),Crosshairs:f(o,{name:"Crosshairs",iconContent:'<path fill="{{color}}" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z" />',viewBox:{x:1792,y:1792}}),Eraser:f(o,{name:"Eraser",iconContent:'<path transform="translate(0,1792) scale(1,-1)" fill="{{color}}" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n    34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n    0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n    0 69.5 20.5t47.5 54.5z" />',viewBox:{x:2048,y:1792}}),Magnify:f(o,{name:"Magnify",iconContent:'<path fill="{{color}}" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z" />',viewBox:{x:512,y:512}}),Pan:f(o,{name:"Pan",iconContent:'<path fill="{{color}}" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n    39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n    355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n    39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n    0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n    144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n    45v448q0 42-39 59-13 5-25 5-26 0-45-19z" />',viewBox:{x:1792,y:1792}}),Rotate:f(o,{name:"Rotate",iconContent:'<path fill="{{color}}" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n    14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n    163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n    225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n    132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n    164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n    39 17 39 59z" />',viewBox:{x:1792,y:1792}}),StackScroll:f(o,{name:"StackScroll",iconContent:'<path fill="{{color}}" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n    0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n    0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z" />',viewBox:{x:24,y:28}}),WindowLevelRegion:f(o,{name:"WindowLevelRegion",iconContent:'<path fill="{{color}}" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z" />',viewBox:{x:1792,y:1792}}),WindowLevel:f(o,{name:"WindowLevel",iconContent:'\n    <path fill="{{color}}" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />\n    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="{{color}}" />',viewBox:{x:18,y:18}}),Zoom:f(o,{name:"Zoom",iconContent:'\n  <path fill="{{color}}" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z" />\n  <path fill="{{color}}" transform="scale(0.22,0.22) translate(1400,0)" d="M1216\n    320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n    19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n    0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z" />',viewBox:{x:640,y:512}}),SegmentationFreeHandEraseInside:f(o,{name:"SegmentationFreeHandEraseInside",iconContent:`${c} ${s}`,viewBox:a}),SegmentationFreeHandFillInside:f(o,{name:"SegmentationFreeHandFillInside",iconContent:`${c} ${l}`,viewBox:a}),SegmentationFreeHandEraseOutside:f(o,{name:"SegmentationFreeHandEraseOutside",iconContent:`${c} ${s}`,viewBox:a}),SegmentationFreeHandFillOutside:f(o,{name:"SegmentationFreeHandFillOutside",iconContent:`${c} ${l}`,viewBox:a}),SegmentationRectangleEraseInside:f(o,{name:"SegmentationRectangleEraseInside",iconContent:`${u} ${s}`,viewBox:a}),RectangleScissor:f(o,{name:"RectangleScissor",iconContent:`${u} ${l}`,viewBox:a}),"RectangleScissor.FILL_INSIDE":f(o,{name:"RectangleScissor.FILL_INSIDE",iconContent:`${u} ${l}`,viewBox:a}),"RectangleScissor.FILL_OUTSIDE":f(o,{name:"RectangleScissor.FILL_OUTSIDE",iconContent:`${u} ${l}`,viewBox:a}),"RectangleScissor.ERASE_OUTSIDE":f(o,{name:"RectangleScissor.ERASE_OUTSIDE",iconContent:`${u} ${s}`,viewBox:a}),"RectangleScissor.ERASE_INSIDE":f(o,{name:"RectangleScissor.ERASE_INSIDE",iconContent:`${u} ${s}`,viewBox:a}),CircleScissor:f(o,{name:"CircleScissor",iconContent:`${d} ${l}`,viewBox:a}),"CircleScissor.FILL_INSIDE":f(o,{name:"CircleScissor.FILL_INSIDE",iconContent:`${d} ${l}`,viewBox:a}),"CircleScissor.ERASE_OUTSIDE":f(o,{name:"CircleScissor.ERASE_OUTSIDE",iconContent:`${d} ${s}`,viewBox:a}),"CircleScissor.FILL_OUTSIDE":f(o,{name:"CircleScissor.FILL_OUTSIDE",iconContent:`${d} ${l}`,viewBox:a})};function f(e,t){return Object.assign(Object.create(e),{...t,name:t.name||e.name})}const h=Object.keys(p);n(76712);i.AnnotationStyleStates.Highlighted,i.ToolModes.Active;n(7001);r.i},85856:(e,t,n)=>{"use strict";n(97181),n(95074)},94042:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(97181),i=n(56442),o=n(85899);const a=function(e,t,n,a,s={},l){const{color:c,handleRadius:u,width:d,lineWidth:p,fill:f,type:h,opacity:m}=Object.assign({color:"rgb(0, 255, 0)",handleRadius:"6",width:"2",lineWidth:void 0,fill:"transparent",type:"circle",opacity:1},s),g=p||d,v=(0,r.A)(t,"handle",`hg-${n}-index-${l}`);let y;if("circle"===h)y={cx:`${a[0]}`,cy:`${a[1]}`,r:u,stroke:c,fill:f,"stroke-width":g,opacity:m};else{if("rect"!==h)throw new Error(`Unsupported handle type: ${h}`);{const e=1.5*parseFloat(u);y={x:`${a[0]-.5*e}`,y:`${a[1]-.5*e}`,width:`${e}`,height:`${e}`,stroke:c,fill:f,"stroke-width":g,rx:""+.1*e,opacity:m}}}const b=e.getSvgNode(v);if(b)(0,o.A)(y,b),e.setNodeTouched(v);else{const t=document.createElementNS("http://www.w3.org/2000/svg",h);(0,i.A)(y,t),e.appendNode(t,v)}}},92118:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(97181),i=n(56442),o=n(85899);function a(e,t,n,a,s,l={},c=""){if(isNaN(a[0])||isNaN(a[1])||isNaN(s[0])||isNaN(s[1]))return;const{color:u="rgb(0, 255, 0)",width:d=10,lineWidth:p,lineDash:f,markerStartId:h=null,markerEndId:m=null,shadow:g=!1}=l,v=p||d,y=(0,r.A)(t,"line",n),b=e.getSvgNode(y),x=e.svgLayerElement.id,A=g?`filter:url(#shadow-${x});`:"",C={x1:`${a[0]}`,y1:`${a[1]}`,x2:`${s[0]}`,y2:`${s[1]}`,stroke:u,style:A,"stroke-width":v,"stroke-dasharray":f,"marker-start":h?`url(#${h})`:"","marker-end":m?`url(#${m})`:""};if(b)(0,o.A)(C,b),e.setNodeTouched(y);else{const t=document.createElementNS("http://www.w3.org/2000/svg","line");""!==c&&t.setAttribute("data-id",c),(0,i.A)(C,t),e.appendNode(t,y)}}},17311:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(97181),i=n(56442),o=n(85899);function a(e,t,n,a,s){const l=a.length&&a[0].length&&Array.isArray(a[0][0])?a:[a],{color:c="rgb(0, 255, 0)",width:u=10,fillColor:d="none",fillOpacity:p=0,lineWidth:f,lineDash:h,closePath:m=!1}=s,g=f||u,v=(0,r.A)(t,"path",n),y=e.getSvgNode(v);let b="";for(let e=0,t=l.length;e<t;e++){const t=l[e],n=t.length;if(!(n<2)){for(let e=0;e<n;e++){const n=t[e];b+=`${e?"L":"M"} ${n[0].toFixed(1)}, ${n[1].toFixed(1)} `}m&&(b+="Z ")}}if(!b)return;const x={d:b,stroke:c,fill:d,"fill-opacity":p,"stroke-width":g,"stroke-dasharray":h};if(y)(0,o.A)(x,y),e.setNodeTouched(v);else{const t=document.createElementNS("http://www.w3.org/2000/svg","path");(0,i.A)(x,t),e.appendNode(t,v)}}},98812:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(97181),i=n(56442),o=n(85899);function a(e,t,n,a,s){if(a.length<2)return;const{color:l="rgb(0, 255, 0)",width:c=10,fillColor:u="none",fillOpacity:d=0,lineWidth:p,lineDash:f,closePath:h=!1,markerStartId:m=null,markerEndId:g=null}=s,v=p||c,y=(0,r.A)(t,"polyline",n),b=e.getSvgNode(y);let x="";for(const e of a)x+=`${e[0].toFixed(1)}, ${e[1].toFixed(1)} `;if(h){const e=a[0];x+=`${e[0]}, ${e[1]}`}const A={points:x,stroke:l,fill:u,"fill-opacity":d,"stroke-width":v,"stroke-dasharray":f,"marker-start":m?`url(#${m})`:"","marker-end":g?`url(#${g})`:""};if(b)(0,o.A)(A,b),e.setNodeTouched(y);else{const t=document.createElementNS("http://www.w3.org/2000/svg","polyline");(0,i.A)(A,t),e.appendNode(t,y)}}},75076:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(97181),i=n(85899),o=n(56442);function a(e,t,n,a,s={},l=""){const{color:c,width:u,lineWidth:d,lineDash:p}=Object.assign({color:"rgb(0, 255, 0)",width:"2",lineWidth:void 0,lineDash:void 0},s),f=d||u,h=(0,r.A)(t,"rect",n),m=e.getSvgNode(h),[g,v,y,b]=a,x=Math.hypot(g[0]-v[0],g[1]-v[1]),A=Math.hypot(g[0]-y[0],g[1]-y[1]),C=[(b[0]+g[0])/2,(b[1]+g[1])/2],T=[(y[0]+g[0])/2,(y[1]+g[1])/2],S=180*Math.atan2(C[1]-T[1],C[0]-T[0])/Math.PI,w={x:""+(C[0]-x/2),y:""+(C[1]-A/2),width:`${x}`,height:`${A}`,stroke:c,fill:"transparent",transform:`rotate(${S} ${C[0]} ${C[1]})`,"stroke-width":f,"stroke-dasharray":p};if(m)(0,i.A)(w,m),e.setNodeTouched(h);else{const t=document.createElementNS("http://www.w3.org/2000/svg","rect");""!==l&&t.setAttribute("data-id",l),(0,o.A)(w,t),e.appendNode(t,h)}}},26290:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(97181),i=n(85899);function o(e){const t=document.createElementNS("http://www.w3.org/2000/svg","tspan");return t.setAttribute("x","0"),t.setAttribute("dy","1.2em"),t.textContent=e,t}function a(e,t){let n=e.querySelector("rect.background");if(!t)return n&&e.removeChild(n),e.getBBox();n||(n=document.createElementNS("http://www.w3.org/2000/svg","rect"),n.setAttribute("class","background"),e.insertBefore(n,e.firstChild));const r=e.getBBox(),o={x:`${r.x}`,y:`${r.y}`,width:`${r.width}`,height:`${r.height}`,fill:t};return(0,i.A)(o,n),r}const s=function(e,t,n,s,l,c={}){return function(e,t,n,s=[""],l,c){const{padding:u,color:d,fontFamily:p,fontSize:f,background:h}=c;let m;const[g,v]=[l[0]+u,l[1]+u],y="http://www.w3.org/2000/svg",b=(0,r.A)(t,"text",n),x=e.getSvgNode(b);if(x){const n=x.querySelector("text"),r=Array.from(n.children);for(let e=0;e<r.length;e++){const t=r[e],n=s[e]||"";t.textContent=n}if(s.length>r.length){for(let e=0;e<s.length-r.length;e++){const t=o(s[e+r.length]);n.appendChild(t)}x.appendChild(n),e.appendNode(x,b)}const l={fill:d,"font-size":f,"font-family":p},c={transform:`translate(${g} ${v})`};(0,i.A)(l,n),(0,i.A)(c,x),x.setAttribute("data-annotation-uid",t),m=a(x,h),e.setNodeTouched(b)}else{const n=document.createElementNS(y,"g");n.setAttribute("data-annotation-uid",t),n.setAttribute("transform",`translate(${g} ${v})`);const r=function(e,t){const{color:n,fontFamily:r,fontSize:i}=t,o="http://www.w3.org/2000/svg",a=document.createElementNS(o,"text"),s="user-select: none; pointer-events: none; -webkit-tap-highlight-color:  rgba(255, 255, 255, 0);",l=`filter:url(#shadow-${e.svgLayerElement.id});`,c=`${s}${l}`;return a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("fill",n),a.setAttribute("font-family",r),a.setAttribute("font-size",i),a.setAttribute("style",c),a.setAttribute("pointer-events","visible"),a}(e,c);for(let e=0;e<s.length;e++){const t=o(s[e]);r.appendChild(t)}n.appendChild(r),e.appendNode(n,b),m=a(n,h)}return Object.assign({},m,{x:g,y:v,height:m.height+u,width:m.width+u})}(e,t,n,s,l,Object.assign({fontFamily:"Helvetica, Arial, sans-serif",fontSize:"14px",color:"rgb(255, 255, 0)",background:"",padding:25,centerX:!1,centerY:!0},c))}},85899:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(e,t){Object.keys(e).forEach((n=>{const r=t.getAttribute(n),i=e[n];void 0===i||""===i?t.removeAttribute(n):r!==i&&t.setAttribute(n,i)}))}},56442:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(e,t){Object.keys(e).forEach((n=>{const r=e[n];void 0!==r&&""!==r&&t.setAttribute(n,r)}))}},94021:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.TOOL_ACTIVATED="CORNERSTONE_TOOLS_TOOL_ACTIVATED",e.TOOLGROUP_VIEWPORT_ADDED="CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_ADDED",e.TOOLGROUP_VIEWPORT_REMOVED="CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_REMOVED",e.TOOL_MODE_CHANGED="CORNERSTONE_TOOLS_TOOL_MODE_CHANGED",e.CROSSHAIR_TOOL_CENTER_CHANGED="CORNERSTONE_TOOLS_CROSSHAIR_TOOL_CENTER_CHANGED",e.ANNOTATION_ADDED="CORNERSTONE_TOOLS_ANNOTATION_ADDED",e.ANNOTATION_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_COMPLETED",e.ANNOTATION_MODIFIED="CORNERSTONE_TOOLS_ANNOTATION_MODIFIED",e.ANNOTATION_REMOVED="CORNERSTONE_TOOLS_ANNOTATION_REMOVED",e.ANNOTATION_SELECTION_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_SELECTION_CHANGE",e.ANNOTATION_LOCK_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_LOCK_CHANGE",e.ANNOTATION_VISIBILITY_CHANGE="CORNERSTONE_TOOLS_ANNOTATION_VISIBILITY_CHANGE",e.ANNOTATION_RENDERED="CORNERSTONE_TOOLS_ANNOTATION_RENDERED",e.ANNOTATION_INTERPOLATION_PROCESS_COMPLETED="CORNERSTONE_TOOLS_ANNOTATION_INTERPOLATION_PROCESS_COMPLETED",e.INTERPOLATED_ANNOTATIONS_REMOVED="CORNERSTONE_TOOLS_INTERPOLATED_ANNOTATIONS_REMOVED",e.SEGMENTATION_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_MODIFIED",e.SEGMENTATION_RENDERED="CORNERSTONE_TOOLS_SEGMENTATION_RENDERED",e.SEGMENTATION_REPRESENTATION_ADDED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_ADDED",e.SEGMENTATION_ADDED="CORNERSTONE_TOOLS_SEGMENTATION_ADDED",e.SEGMENTATION_REPRESENTATION_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_MODIFIED",e.SEGMENTATION_REMOVED="CORNERSTONE_TOOLS_SEGMENTATION_REMOVED",e.SEGMENTATION_REPRESENTATION_REMOVED="CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_REMOVED",e.SEGMENTATION_DATA_MODIFIED="CORNERSTONE_TOOLS_SEGMENTATION_DATA_MODIFIED",e.HISTORY_UNDO="CORNERSTONE_TOOLS_HISTORY_UNDO",e.HISTORY_REDO="CORNERSTONE_TOOLS_HISTORY_REDO",e.KEY_DOWN="CORNERSTONE_TOOLS_KEY_DOWN",e.KEY_UP="CORNERSTONE_TOOLS_KEY_UP",e.MOUSE_DOWN="CORNERSTONE_TOOLS_MOUSE_DOWN",e.MOUSE_UP="CORNERSTONE_TOOLS_MOUSE_UP",e.MOUSE_DOWN_ACTIVATE="CORNERSTONE_TOOLS_MOUSE_DOWN_ACTIVATE",e.MOUSE_DRAG="CORNERSTONE_TOOLS_MOUSE_DRAG",e.MOUSE_MOVE="CORNERSTONE_TOOLS_MOUSE_MOVE",e.MOUSE_CLICK="CORNERSTONE_TOOLS_MOUSE_CLICK",e.MOUSE_DOUBLE_CLICK="CORNERSTONE_TOOLS_MOUSE_DOUBLE_CLICK",e.MOUSE_WHEEL="CORNERSTONE_TOOLS_MOUSE_WHEEL",e.TOUCH_START="CORNERSTONE_TOOLS_TOUCH_START",e.TOUCH_START_ACTIVATE="CORNERSTONE_TOOLS_TOUCH_START_ACTIVATE",e.TOUCH_PRESS="CORNERSTONE_TOOLS_TOUCH_PRESS",e.TOUCH_DRAG="CORNERSTONE_TOOLS_TOUCH_DRAG",e.TOUCH_END="CORNERSTONE_TOOLS_TOUCH_END",e.TOUCH_TAP="CORNERSTONE_TOOLS_TAP",e.TOUCH_SWIPE="CORNERSTONE_TOOLS_SWIPE"}(r||(r={}));const i=r},18682:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.Labelmap="Labelmap",e.Contour="Contour",e.Surface="Surface"}(r||(r={}));const i=r},84093:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.OnInteractionStart="onInteractionStart",e.OnInteractionEnd="onInteractionEnd",e.Preview="preview",e.RejectPreview="rejectPreview",e.AcceptPreview="acceptPreview",e.Fill="fill",e.Interpolate="interpolate",e.StrategyFunction="strategyFunction",e.CreateIsInThreshold="createIsInThreshold",e.Initialize="initialize",e.INTERNAL_setValue="setValue",e.AddPreview="addPreview",e.ComputeInnerCircleRadius="computeInnerCircleRadius",e.GetStatistics="getStatistics",e.EnsureImageVolumeFor3DManipulation="ensureImageVolumeFor3DManipulation",e.EnsureSegmentationVolumeFor3DManipulation="ensureSegmentationVolumeFor3DManipulation"}(r||(r={}));const i=r},66452:(e,t,n)=>{"use strict";var r,i;n.d(t,{i:()=>r,q:()=>i}),function(e){e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary",e[e.Primary_And_Secondary=3]="Primary_And_Secondary",e[e.Auxiliary=4]="Auxiliary",e[e.Primary_And_Auxiliary=5]="Primary_And_Auxiliary",e[e.Secondary_And_Auxiliary=6]="Secondary_And_Auxiliary",e[e.Primary_And_Secondary_And_Auxiliary=7]="Primary_And_Secondary_And_Auxiliary",e[e.Fourth_Button=8]="Fourth_Button",e[e.Fifth_Button=16]="Fifth_Button",e[e.Wheel=524288]="Wheel",e[e.Wheel_Primary=524289]="Wheel_Primary"}(r||(r={})),function(e){e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta",e[e.ShiftCtrl=1617]="ShiftCtrl",e[e.ShiftAlt=1618]="ShiftAlt",e[e.ShiftMeta=1691]="ShiftMeta",e[e.CtrlAlt=1718]="CtrlAlt",e[e.CtrlMeta=1791]="CtrlMeta",e[e.AltMeta=1891]="AltMeta"}(i||(i={}))},49892:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>i}),function(e){e.Active="Active",e.Passive="Passive",e.Enabled="Enabled",e.Disabled="Disabled"}(r||(r={}));const i=r},99737:(e,t,n)=>{"use strict";n.d(t,{AnnotationStyleStates:()=>a,ChangeTypes:()=>d.A,Events:()=>l.A,KeyboardBindings:()=>i.q,MouseBindings:()=>i.i,SegmentationRepresentations:()=>c.A,StrategyCallbacks:()=>u.A,ToolModes:()=>o.A,WorkerTypes:()=>p});var r,i=n(66452),o=n(49892);!function(e){e.Default="",e.Highlighted="Highlighted",e.Selected="Selected",e.Locked="Locked",e.AutoGenerated="AutoGenerated"}(r||(r={}));const a=r;var s,l=n(94021),c=n(18682),u=(n(10401),n(84093)),d=n(75183);!function(e){e.POLYSEG_CONTOUR_TO_LABELMAP="Converting Contour to Labelmap",e.POLYSEG_SURFACE_TO_LABELMAP="Converting Surfaces to Labelmap",e.POLYSEG_CONTOUR_TO_SURFACE="Converting Contour to Surface",e.POLYSEG_LABELMAP_TO_SURFACE="Converting Labelmap to Surface",e.SURFACE_CLIPPING="Clipping Surfaces",e.COMPUTE_STATISTICS="Computing Statistics",e.INTERPOLATE_LABELMAP="Interpolating Labelmap",e.COMPUTE_LARGEST_BIDIRECTIONAL="Computing Largest Bidirectional",e.GENERATE_CONTOUR_SETS="Generating Contour Sets"}(s||(s={}));const p=s},39011:(e,t,n)=>{"use strict";n.d(t,{o:()=>u});var r=n(15327),i=n(99737),o=n(17328),a=n(39848);const{Active:s,Passive:l,Enabled:c}=i.ToolModes;const u=new class{constructor(){this._needsRender=new Set,this._animationFrameSet=!1,this._animationFrameHandle=null,this._renderFlaggedViewports=()=>{this._throwIfDestroyed();const e=Array.from(this._viewportElements.values());for(let t=0;t<e.length;t++){const n=e[t];if(this._needsRender.has(n)&&(this._triggerRender(n),this._needsRender.delete(n),0===this._needsRender.size))break}this._animationFrameSet=!1,this._animationFrameHandle=null,this._render()},this._viewportElements=new Map}addViewportElement(e,t){this._viewportElements.set(e,t)}removeViewportElement(e,t){this._viewportElements.delete(e),this._needsRender.delete(t),this._reset()}renderViewport(e){this._setViewportsToBeRenderedNextFrame([e])}_throwIfDestroyed(){if(this.hasBeenDestroyed)throw new Error("this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.")}_setAllViewportsToBeRenderedNextFrame(){[...this._viewportElements.values()].forEach((e=>{this._needsRender.add(e)})),this._renderFlaggedViewports()}_setViewportsToBeRenderedNextFrame(e){const t=[...this._viewportElements.values()];e.forEach((e=>{-1!==t.indexOf(e)&&this._needsRender.add(e)})),this._render()}_render(){this._needsRender.size>0&&!1===this._animationFrameSet&&(this._animationFrameHandle=window.requestAnimationFrame(this._renderFlaggedViewports),this._animationFrameSet=!0)}_triggerRender(e){const t=(0,r.getEnabledElement)(e);if(!t)return;if(!(0,r.getRenderingEngine)(t.renderingEngineId))return void console.warn("rendering Engine has been destroyed");const n=(0,a.A)(e,[s,l,c]),{renderingEngineId:u,viewportId:d}=t,p={element:e,renderingEngineId:u,viewportId:d};(0,o.draw)(e,(o=>{let a=!1;n.forEach((e=>{if(e.renderAnnotation){const n=e.renderAnnotation(t,o);a=a||n}})),a&&(0,r.triggerEvent)(e,i.Events.ANNOTATION_RENDERED,{...p})}))}_reset(){window.cancelAnimationFrame(this._animationFrameHandle),this._needsRender.clear(),this._animationFrameSet=!1,this._animationFrameHandle=null,this._setAllViewportsToBeRenderedNextFrame()}}},67013:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var r=n(15327);class i{constructor(e){this.getGroupKey=e=>{if("string"==typeof e)return e;const t=e,n=(0,r.getEnabledElement)(t);if(!n)throw new Error("Element not enabled, you must have an enabled element if you are not providing a FrameOfReferenceUID");return n.FrameOfReferenceUID},this._imageVolumeModifiedHandler=e=>{const t=e.detail,{FrameOfReferenceUID:n}=t,r=this.annotations[n];r&&Object.keys(r).forEach((e=>{r[e].forEach((e=>{void 0!==e.invalidated&&(e.invalidated=!0)}))}))},this.getFramesOfReference=()=>Object.keys(this.annotations),this.getAnnotations=(e,t)=>{const n=this.annotations;return n[e]?t?n[e][t]?n[e][t]:[]:n[e]:[]},this.getAnnotation=e=>{const t=this.annotations;for(const n in t){const r=t[n];for(const t in r){const n=r[t];for(const t of n)if(e===t.annotationUID)return t}}},this.getNumberOfAnnotations=(e,t)=>{const n=this.getAnnotations(e,t);if(!n.length)return 0;if(t)return n.length;let r=0;for(const e in n)r+=n[e].length;return r},this.addAnnotation=(e,t)=>{const{metadata:n}=e,{FrameOfReferenceUID:r,toolName:i}=n;t=t||r;const o=this.annotations;let a=o[t];a||(o[t]={},a=o[t]);let s=a[i];s||(a[i]=[],s=a[i]),this.preprocessingFn&&(e=this.preprocessingFn(e)),s.push(e)},this.removeAnnotation=e=>{const{annotations:t}=this;for(const n in t){const r=t[n];for(const t in r){const n=r[t],i=n.findIndex((t=>t.annotationUID===e));-1!==i&&(n.splice(i,1),0===n.length&&delete r[t])}0===Object.keys(r).length&&delete t[n]}},this.removeAnnotations=(e,t)=>{const n=this.annotations,r=[];if(!n[e])return r;if(t){const i=n[e][t];for(const e of i)this.removeAnnotation(e.annotationUID),r.push(e)}else for(const t in n[e]){const i=n[e][t];for(const e of i)this.removeAnnotation(e.annotationUID),r.push(e)}return r},this.saveAnnotations=(e,t)=>{const n=this.annotations;if(e&&t){const r=n[e];if(!r)return;const i=r[t];return structuredClone(i)}if(e){const t=n[e];return structuredClone(t)}return structuredClone(n)},this.restoreAnnotations=(e,t,n)=>{const r=this.annotations;if(t&&n){let i=r[t];i||(r[t]={},i=r[t]),i[n]=e}else t?r[t]=e:this.annotations=structuredClone(e)},this.getAllAnnotations=()=>Object.values(this.annotations).map((e=>Object.values(e))).flat(2),this.getNumberOfAllAnnotations=()=>{let e=0;const t=this.annotations;for(const n in t){const r=t[n];for(const t in r){e+=r[t].length}}return e},this.removeAllAnnotations=()=>{const e=[];for(const t of this.getAllAnnotations())this.removeAnnotation(t.annotationUID),e.push(t);return e},e||(e=r.utilities.uuidv4()),this.annotations={},this.uid=e,r.eventTarget.addEventListener(r.Enums.Events.IMAGE_VOLUME_MODIFIED,this._imageVolumeModifiedHandler)}setPreprocessingFn(e){this.preprocessingFn=e}}const o=new i("DEFAULT")},2076:(e,t,n)=>{"use strict";n.d(t,{checkAndSetAnnotationLocked:()=>c,isAnnotationLocked:()=>l});var r=n(15327),i=n(99737),o=n(82056);const a=new Set;function s(e,t=!0){const n=u();e&&(t?function(e,t,n){if(!t.has(e)){t.add(e),n.added.push(e);const r=(0,o.getAnnotation)(e);r&&(r.isLocked=!0)}}(e,a,n):d(e,a,n)),p(n,a)}function l(e){return a.has(e)}function c(e){const t=l(e);return s(e,t),t}function u(){return Object.freeze({added:[],removed:[],locked:[]})}function d(e,t,n){if(t.delete(e)){n.removed.push(e);const t=(0,o.getAnnotation)(e);t&&(t.isLocked=!1)}}function p(e,t){(e.added.length>0||e.removed.length>0)&&(t.forEach((t=>{e.locked.push(t)})),(0,r.triggerEvent)(r.eventTarget,i.Events.ANNOTATION_LOCK_CHANGE,e))}},17343:(e,t,n)=>{"use strict";n.d(t,{deselectAnnotation:()=>l,isAnnotationSelected:()=>c,setAnnotationSelected:()=>s});var r=n(15327),i=n(99737),o=n(82056);const a=new Set;function s(e,t=!0,n=!1){t?function(e,t=!1){const n=u();if(!t){d(a,n);const t=(0,o.getAnnotation)(e);t&&(t.isSelected=!0)}if(e&&!a.has(e)){a.add(e),n.added.push(e);const t=(0,o.getAnnotation)(e);t&&(t.isSelected=!0)}p(n,a)}(e,n):l(e)}function l(e){const t=u();if(e){if(a.delete(e)){t.removed.push(e);(0,o.getAnnotation)(e).isSelected=!1}}else d(a,t);p(t,a)}function c(e){return a.has(e)}function u(){return Object.freeze({added:[],removed:[],selection:[]})}function d(e,t){e.forEach((n=>{if(e.delete(n)){t.removed.push(n);const e=(0,o.getAnnotation)(n);e&&(e.isSelected=!1)}}))}function p(e,t){(e.added.length>0||e.removed.length>0)&&(t.forEach((t=>{e.selection.push(t)})),(0,r.triggerEvent)(r.eventTarget,i.Events.ANNOTATION_SELECTION_CHANGE,e))}},82056:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addAnnotation:()=>m,addChildAnnotation:()=>p,clearParentAnnotation:()=>d,getAllAnnotations:()=>u,getAnnotation:()=>c,getAnnotationManager:()=>a,getAnnotations:()=>l,getChildAnnotations:()=>h,getNumberOfAnnotations:()=>g,getParentAnnotation:()=>f,invalidateAnnotation:()=>x,removeAllAnnotations:()=>y,removeAnnotation:()=>v,removeAnnotations:()=>b,setAnnotationManager:()=>s});var r=n(15327),i=n(44049);let o;function a(){return o}function s(e){o=e}function l(e,t){const n=a(),r=n.getGroupKey(t);return n.getAnnotations(r,e)}function c(e){return a().getAnnotation(e)}function u(){return a().getAllAnnotations()}function d(e){const{annotationUID:t,parentAnnotationUID:n}=e;if(!n)return;const r=c(n),i=r.childAnnotationUIDs.indexOf(t);r.childAnnotationUIDs.splice(i,1),e.parentAnnotationUID=void 0}function p(e,t){const{annotationUID:n}=e,{annotationUID:r}=t;d(t),e.childAnnotationUIDs||(e.childAnnotationUIDs=[]),e.childAnnotationUIDs.includes(r)||(e.childAnnotationUIDs.push(r),t.parentAnnotationUID=n)}function f(e){return e.parentAnnotationUID?c(e.parentAnnotationUID):void 0}function h(e){return e.childAnnotationUIDs?.map((e=>c(e)))??[]}function m(e,t){e.annotationUID||(e.annotationUID=r.utilities.uuidv4());const n=a();if(t instanceof HTMLDivElement){const r=n.getGroupKey(t);n.addAnnotation(e,r),(0,i.triggerAnnotationAddedForElement)(e,t)}else n.addAnnotation(e,void 0),(0,i.triggerAnnotationAddedForFOR)(e);return e.annotationUID}function g(e,t){const n=a(),r=n.getGroupKey(t);return n.getNumberOfAnnotations(r,e)}function v(e){if(!e)return;const t=a(),n=t.getAnnotation(e);n&&(n.childAnnotationUIDs?.forEach((e=>v(e))),t.removeAnnotation(e),(0,i.triggerAnnotationRemoved)({annotation:n,annotationManagerUID:t.uid}))}function y(){const e=a(),t=e.removeAllAnnotations();for(const n of t)(0,i.triggerAnnotationRemoved)({annotation:n,annotationManagerUID:e.uid})}function b(e,t){const n=a(),r=n.getGroupKey(t),o=n.removeAnnotations(r,e);for(const e of o)(0,i.triggerAnnotationRemoved)({annotation:e,annotationManagerUID:n.uid})}function x(e){let t=e;for(;t;)t.invalidated=!0,t=t.parentAnnotationUID?c(t.parentAnnotationUID):void 0}},29601:(e,t,n)=>{"use strict";n.d(t,{checkAndSetAnnotationVisibility:()=>f,isAnnotationVisible:()=>c});var r=n(15327),i=n(99737),o=n(17343),a=n(82056);const s=new Set;function l(e,t=!0){const n=u();e&&(t?d(e,s,n):function(e,t,n){t.has(e)||(t.add(e),(0,o.isAnnotationSelected)(e)&&(0,o.deselectAnnotation)(e),n.lastHidden.push(e))}(e,s,n)),p(n)}function c(e){if((0,a.getAnnotation)(e))return!s.has(e)}function u(){return Object.freeze({lastVisible:[],lastHidden:[],hidden:[]})}function d(e,t,n){if(t.delete(e)){n.lastVisible.push(e);(0,a.getAnnotation)(e).isVisible=!0}}function p(e){(e.lastHidden.length>0||e.lastVisible.length>0)&&(s.forEach((t=>{e.hidden.push(t)})),(0,r.triggerEvent)(r.eventTarget,i.Events.ANNOTATION_VISIBILITY_CHANGE,e))}function f(e){const t=!s.has(e);return l(e,t),t}},8710:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=new class{constructor(){this._initializeConfig({color:"rgb(255, 255, 0)",colorHighlighted:"rgb(0, 255, 0)",colorSelected:"rgb(0, 220, 0)",colorLocked:"rgb(209, 193, 90)",lineWidth:"1",lineDash:"",shadow:!0,textBoxVisibility:!0,textBoxFontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif",textBoxFontSize:"14px",textBoxColor:"rgb(255, 255, 0)",textBoxColorHighlighted:"rgb(0, 255, 0)",textBoxColorSelected:"rgb(0, 255, 0)",textBoxColorLocked:"rgb(209, 193, 90)",textBoxBackground:"",textBoxLinkLineWidth:"1",textBoxLinkLineDash:"2,3",textBoxShadow:!0,markerSize:"10"})}getAnnotationToolStyles(e){return this.config.annotations&&this.config.annotations[e]}getViewportToolStyles(e){return this.config.viewports&&this.config.viewports[e]}getToolGroupToolStyles(e){return this.config.toolGroups&&this.config.toolGroups[e]}getDefaultToolStyles(){return this.config.default}setAnnotationStyles(e,t){let n=this.config.annotations;n||(this.config={...this.config,annotations:{}},n=this.config.annotations),n[e]=t}setViewportToolStyles(e,t){let n=this.config.viewports;n||(this.config={...this.config,viewports:{}},n=this.config.viewports),n[e]=t}setToolGroupToolStyles(e,t){let n=this.config.toolGroups;n||(this.config={...this.config,toolGroups:{}},n=this.config.toolGroups),n[e]=t}setDefaultToolStyles(e){this.config.default=e}getStyleProperty(e,t){const{annotationUID:n,viewportId:r,toolGroupId:i,toolName:o}=t;return this._getToolStyle(e,n,r,i,o)}_getToolStyle(e,t,n,r,i){if(t){const n=this.getAnnotationToolStyles(t);if(n&&void 0!==n[e])return n[e]}if(n){const t=this.getViewportToolStyles(n);if(t){if(t[i]&&void 0!==t[i][e])return t[i][e];if(t.global&&void 0!==t.global[e])return t.global[e]}}if(r){const t=this.getToolGroupToolStyles(r);if(t){if(t[i]&&void 0!==t[i][e])return t[i][e];if(t.global&&void 0!==t.global[e])return t.global[e]}}const o=this.getDefaultToolStyles();return o[i]&&void 0!==o[i][e]?o[i][e]:o.global&&void 0!==o.global[e]?o.global[e]:void 0}_initializeConfig(e){const t={};for(const n in e)t[n]=e[n];this.config={default:{global:t}}}}},76712:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var r=n(8710);function i(e,t,n,i){const o=function(e,t,n){const r=[`${e}`];return t&&r.push(`${r[0]}${t}`),n&&r.push(`${r[r.length-1]}${n}`),r}(e,n,i);for(let e=o.length-1;e>=0;--e){const n=r.A.getStyleProperty(o[e],t);if(void 0!==n)return n}}},49310:(e,t,n)=>{"use strict";n.d(t,{getState:()=>a});var r=n(2076),i=n(17343),o=n(99737);const a=function(e){if(e){if(e.data&&e.highlighted)return o.AnnotationStyleStates.Highlighted;if((0,i.isAnnotationSelected)(e.annotationUID))return o.AnnotationStyleStates.Selected;if((0,r.isAnnotationLocked)(e.annotationUID))return o.AnnotationStyleStates.Locked;if(e.data&&e.autoGenerated)return o.AnnotationStyleStates.AutoGenerated}return o.AnnotationStyleStates.Default};n(76712);n(8710)},44049:(e,t,n)=>{"use strict";n.r(t),n.d(t,{triggerAnnotationAddedForElement:()=>a,triggerAnnotationAddedForFOR:()=>s,triggerAnnotationCompleted:()=>u,triggerAnnotationModified:()=>c,triggerAnnotationRemoved:()=>l,triggerContourAnnotationCompleted:()=>d});var r=n(15327),i=n(99737),o=n(77609);function a(e,t){const n=(0,r.getEnabledElement)(t),{renderingEngine:o,viewportId:a}=n,s=i.Events.ANNOTATION_ADDED,l={annotation:e,viewportId:a,renderingEngineId:o.id};(0,r.triggerEvent)(r.eventTarget,s,l)}function s(e){const{toolName:t}=e.metadata,n=(0,o.getToolGroupsWithToolName)(t);if(!n.length)return;const a=[];n.forEach((t=>{t.viewportsInfo.forEach((t=>{const{renderingEngineId:n,viewportId:i}=t,{FrameOfReferenceUID:o}=(0,r.getEnabledElementByIds)(i,n);e.metadata.FrameOfReferenceUID===o&&a.push(t)}))}));const s=i.Events.ANNOTATION_ADDED,l={annotation:e};a.length?a.forEach((({renderingEngineId:e,viewportId:t})=>{l.viewportId=t,l.renderingEngineId=e,(0,r.triggerEvent)(r.eventTarget,s,l)})):(0,r.triggerEvent)(r.eventTarget,s,l)}function l(e){const t=i.Events.ANNOTATION_REMOVED;(0,r.triggerEvent)(r.eventTarget,t,e)}function c(e,t,n=i.ChangeTypes.HandlesUpdated){const o=t&&(0,r.getEnabledElement)(t),{viewportId:a,renderingEngineId:s}=o||{},l=i.Events.ANNOTATION_MODIFIED,c={annotation:e,viewportId:a,renderingEngineId:s,changeType:n};(0,r.triggerEvent)(r.eventTarget,l,c)}function u(e){p({annotation:e})}function d(e,t=!1){p({annotation:e,contourHoleProcessingEnabled:t})}function p(e){const t=i.Events.ANNOTATION_COMPLETED;(0,r.triggerEvent)(r.eventTarget,t,e)}},47807:(e,t,n)=>{"use strict";n.d(t,{state:()=>o});n(49310),n(2076),n(17343);var r=n(82056),i=n(44049);n(29601),n(67013),n(15327),n(94021);const o={...r,...i,resetAnnotationManager:n(97).c}},60740:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});var r=n(33283);function i(e){const t=(0,r.T)(e);if(t){const e=Object.keys(t.segments).find((e=>t.segments[e].active));return e?Number(e):void 0}}},50409:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});var r=n(59475);function i(e){return r._6.getColorLUT(e)}},97577:(e,t,n)=>{"use strict";n.d(t,{aF:()=>o,vl:()=>i});var r=n(59475);function i(e,t){return o(e,t)[0]}function o(e,t){return r._6.getCurrentLabelmapImageIdsForViewport(e,t)}},33283:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var r=n(59475);function i(e){return r._6.getSegmentation(e)}},58859:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});var r=n(59475);function i(e){const t=r._6.getState().viewportSegRepresentations;return Object.entries(t).filter((([,t])=>t.some((t=>t.segmentationId===e)))).map((([e])=>e))}},59452:(e,t,n)=>{"use strict";n.d(t,{DU:()=>u,ED:()=>s,Qe:()=>a,Th:()=>c,wV:()=>l});var r=n(15327),i=n(99737);function o(e,t,n){const i=(0,r.getEnabledElementByViewportId)(e);if(!i)return;const{renderingEngine:o,viewport:a}=i;if(!o||!a)return;const s=a.getActors().filter(n);return s.length>0?s[0]:void 0}function a(e,t){const n=l(e,t);return n?.uid}function s(e,t){return function(e,t){const n=(0,r.getEnabledElementByViewportId)(e);if(!n)return;const{renderingEngine:i,viewport:o}=n;if(!i||!o)return;const a=o.getActors().filter(t);return a.length>0?a:void 0}(e,(e=>e.representationUID?.startsWith(`${t}-${i.SegmentationRepresentations.Labelmap}`)))}function l(e,t){return o(e,0,(e=>e.representationUID?.startsWith(`${t}-${i.SegmentationRepresentations.Labelmap}`)))}function c(e,t,n){return o(e,0,(e=>e.representationUID===u(t,n)))}function u(e,t){return`${e}-${i.SegmentationRepresentations.Surface}-${t}`}},91963:(e,t,n)=>{"use strict";n.d(t,{wV:()=>r.wV});n(9711);var r=n(59452)},49906:(e,t,n)=>{"use strict";n.d(t,{triggerSegmentationDataModified:()=>r.Q,triggerSegmentationModified:()=>i.G,triggerSegmentationRemoved:()=>o.B,triggerSegmentationRepresentationModified:()=>a.r,triggerSegmentationRepresentationRemoved:()=>s.O});var r=n(98798),i=n(9726),o=n(1485),a=n(44951),s=n(65290)},77609:(e,t,n)=>{"use strict";n.d(t,{getToolGroup:()=>o,getToolGroupForViewport:()=>u.A,getToolGroupsWithToolName:()=>d.A});var r=n(85204),i=n(99737);n(93008),n(15327),n(79475),n(7001);const o=function(e){return r.wk.toolGroups.find((t=>t.id===e))},{Active:a,Passive:s,Enabled:l,Disabled:c}=i.ToolModes;i.MouseBindings.Primary;var u=n(65136);var d=n(88029)},68040:(e,t,n)=>{"use strict";n.d(t,{Gx:()=>i});var r=n(85204);function i(e){const t=e.toolName;if(!t)throw new Error(`No Tool Found for the ToolClass ${e.name}`);r.wk.tools[t]||(r.wk.tools[t]={toolClass:e})}},85204:(e,t,n)=>{"use strict";n.d(t,{wk:()=>i});var r=n(48145);r.A;let i={isInteractingWithTool:!1,isMultiPartToolActive:!1,tools:{},toolGroups:[],synchronizers:[],svgNodeCache:r.A,enabledElements:[],handleRadius:6}},6030:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(15327),i=n(37234),o=n(82056),a=n(56069),s=n(94418),l=n(76712),c=n(49310);class u extends i.A{constructor(){super(...arguments),this.onImageSpacingCalibrated=e=>{const{element:t,imageId:n}=e.detail,i=r.utilities.imageIdToURI(n),s=(0,o.getAnnotationManager)();s.getFramesOfReference().forEach((e=>{const n=s.getAnnotations(e)[this.getToolName()];n&&n.length&&(n.forEach((e=>{if(!e.metadata?.referencedImageId)return;r.utilities.imageIdToURI(e.metadata.referencedImageId)===i&&(e.invalidated=!0,e.data.cachedStats={})})),(0,a.A)(t))}))}}filterInteractableAnnotationsForElement(e,t){if(!t?.length)return[];const n=(0,r.getEnabledElement)(e),{viewport:i}=n;return(0,s.A)(i,t)}createAnnotation(e){const t=e.detail,{currentPoints:n,element:i}=t,{world:o}=n,a=(0,r.getEnabledElement)(i),{viewport:s}=a,l=s.getCamera(),{viewPlaneNormal:c,viewUp:u,position:d}=l,p=this.getReferencedImageId(s,o,c,u),f=s.getViewReference({points:[o]});return{highlighted:!0,invalidated:!0,metadata:{toolName:this.getToolName(),...f,referencedImageId:p,viewUp:u,cameraPosition:d},data:{cachedStats:{},handles:{points:[],activeHandleIndex:null,textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}}}}}}getReferencedImageId(e,t,n,i){const o=this.getTargetId(e);let a=o.split(/^[a-zA-Z]+:/)[1];if(e instanceof r.BaseVolumeViewport){const e=r.utilities.getVolumeId(o),i=r.cache.getVolume(e);a=r.utilities.getClosestImageId(i,t,n)}return a}getStyle(e,t,n){return(0,l.h)(e,t,(0,c.getState)(n),this.mode)}}u.toolName="AnnotationDisplayTool";const d=u},37234:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(15327),i=n(49892);const{DefaultHistoryMemo:o}=r.utilities.HistoryMemo;class a{static{this.defaults={configuration:{strategies:{},defaultStrategy:void 0,activeStrategy:void 0,strategyOptions:{}}}}constructor(e,t){const n=a.mergeDefaultProps(a.defaults,t),o=r.utilities.deepMerge(n,e),{configuration:s={},supportedInteractionTypes:l,toolGroupId:c}=o;this.toolGroupId=c,this.supportedInteractionTypes=l||[],this.configuration=Object.assign({},s),this.mode=i.A.Disabled}static mergeDefaultProps(e={},t){return t?r.utilities.deepMerge(e,t):e}get toolName(){return this.getToolName()}getToolName(){return this.constructor.toolName}applyActiveStrategy(e,t){const{strategies:n,activeStrategy:r}=this.configuration;return n[r]?.call(this,e,t)}applyActiveStrategyCallback(e,t,n,...r){const{strategies:i,activeStrategy:o}=this.configuration;if(!i[o])throw new Error(`applyActiveStrategyCallback: active strategy ${o} not found, check tool configuration or spellings`);return i[o][n]?.call(this,e,t,...r)}setConfiguration(e){this.configuration=r.utilities.deepMerge(this.configuration,e)}setActiveStrategy(e){this.setConfiguration({activeStrategy:e})}getTargetImageData(e){if(e.startsWith("imageId:")){const t=e.split("imageId:")[1],n=r.utilities.imageIdToURI(t);let i=r.utilities.getViewportsWithImageURI(n);if(!i||!i.length)return;if(i=i.filter((e=>e.getCurrentImageId()===t)),!i||!i.length)return;return i[0].getImageData()}if(e.startsWith("volumeId:")){const t=r.utilities.getVolumeId(e),n=r.utilities.getViewportsWithVolumeId(t);if(!n||!n.length)return;return n[0].getImageData()}if(e.startsWith("videoId:")){const t=r.utilities.imageIdToURI(e),n=r.utilities.getViewportsWithImageURI(t);if(!n||!n.length)return;return n[0].getImageData()}throw new Error('getTargetIdImage: targetId must start with "imageId:" or "volumeId:"')}getTargetId(e){const t=e.getViewReferenceId?.();if(t)return t;throw new Error("getTargetId: viewport must have a getViewReferenceId method")}undo(){this.doneEditMemo(),o.undo()}redo(){o.redo()}static createZoomPanMemo(e){const t={pan:e.getPan(),zoom:e.getZoom()},n={restoreMemo:()=>{const n=e.getPan(),r=e.getZoom();e.setZoom(t.zoom),e.setPan(t.pan),e.render(),t.pan=n,t.zoom=r}};return o.push(n),n}doneEditMemo(){this.memo?.commitMemo?.()&&o.push(this.memo),this.memo=null}}a.toolName="BaseTool";const s=a},25894:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(15327),i=n(18682),o=n(22384),a=n(33283),s=n(87420),l=n(36625),c=n(27479);let u=!1;new Map;const d={render:async function(e,t){const{segmentationId:n}=t,r=(0,a.T)(n);if(!r)return;let s=r.representationData[i.A.Contour];if(s||!(0,l.Qy)()?.canComputeRequestedRepresentation(n,i.A.Contour)||u)s||(0,l.Qy)()||console.debug(`No contour data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to contour. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);else{u=!0;const t=(0,l.Qy)();s=await(0,c.d)(n,i.A.Contour,(()=>t.computeContourData(n,{viewport:e})),(()=>{})),u=!1}s&&s.geometryIds?.length&&(0,o.d)(e,s.geometryIds,s.annotationUIDsMap,t)},removeRepresentation:function(e,t,n=!1){const i=(0,r.getEnabledElementByViewportId)(e);if(!i)return;const{viewport:o}=i;n&&((0,s.A)(e,t),o.render())}}},684:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>_});var r=n(15327),i=n(63597),o=n(88234),a=n(26228),s=n(50409),l=n(97577),c=n(33283),u=n(92686),d=n(18682),p=n(47098),f=n(60740),h=n(59452),m=n(36625),g=n(27479),v=n(49906),y=n(59475);const b=255,x=new Map;let A=!1;function C(e,t,n){const{segmentationId:r}=n,{cfun:i,ofun:o}=n.config,{colorLUTIndex:l}=n,c=(0,a.getActiveSegmentation)(e),h=c?.segmentationId===r,m=u.Y.getStyle({viewportId:e,type:d.A.Labelmap,segmentationId:r}),g=u.Y.getRenderInactiveSegmentations(e),v=(0,s.B)(l),y=Math.min(256,v.length),{outlineWidth:x,renderOutline:A,outlineOpacity:C,activeSegmentOutlineWidthDelta:w}=T(m,h),_=(0,p.s)(e,{segmentationId:r,type:d.A.Labelmap});for(let t=0;t<y;t++){const n=t,a=v[n],s=u.Y.getStyle({viewportId:e,type:d.A.Labelmap,segmentationId:r,segmentIndex:n}),{fillAlpha:l,outlineWidth:c,renderFill:p,renderOutline:f}=T(m,h,s),{forceOpacityUpdate:g,forceColorUpdate:y}=S(e,r,n,{fillAlpha:l,renderFill:p,renderOutline:f,segmentColor:a,outlineWidth:c,segmentsHidden:_,cfun:i,ofun:o});if(y&&i.addRGBPoint(n,a[0]/b,a[1]/b,a[2]/b),g)if(p){const e=_.has(n)?0:a[3]/255*l;o.removePoint(n),o.addPointLong(n,e,.5,1)}else o.addPointLong(n,.01,.5,1)}o.setClamping(!1);const I=t.actor,{preLoad:E}=I.get?.("preLoad")||{preLoad:null};if(E?E({cfun:i,ofun:o,actor:I}):(I.getProperty().setRGBTransferFunction(0,i),I.getProperty().setScalarOpacity(0,o),I.getProperty().setInterpolationTypeToNearest()),A){I.getProperty().setUseLabelOutline(A),I.getProperty().setLabelOutlineOpacity(C);const e=(0,f.Q)(n.segmentationId),t=new Array(y-1);for(let n=1;n<y;n++){_.has(n)?t[n-1]=0:t[n-1]=n===e?x+w:x}I.getProperty().setLabelOutlineThickness(t),I.modified(),I.getProperty().modified(),I.getMapper().modified()}else I.getProperty().setLabelOutlineThickness(new Array(y-1).fill(0));const D=h||g;I.setVisibility(D)}function T(e,t,n){const r={...e,...n||{}};return{fillAlpha:t?r.fillAlpha:r.fillAlphaInactive,outlineWidth:t?r.outlineWidth:r.outlineWidthInactive,renderFill:t?r.renderFill:r.renderFillInactive,renderOutline:t?r.renderOutline:r.renderOutlineInactive,outlineOpacity:t?r.outlineOpacity:r.outlineOpacityInactive,activeSegmentOutlineWidthDelta:r.activeSegmentOutlineWidthDelta}}function S(e,t,n,{fillAlpha:r,renderFill:i,renderOutline:o,segmentColor:a,outlineWidth:s,segmentsHidden:l,cfun:c,ofun:u}){const d=`${e}-${t}-${n}`,p=x.get(d);if(!p)return x.set(d,{fillAlpha:r,renderFill:i,renderOutline:o,outlineWidth:s,segmentColor:a.slice(),segmentsHidden:new Set(l),cfunMTime:c.getMTime(),ofunMTime:u.getMTime()}),{forceOpacityUpdate:!0,forceColorUpdate:!0};const{fillAlpha:f,renderFill:h,renderOutline:m,outlineWidth:g,segmentColor:v,segmentsHidden:y,cfunMTime:b,ofunMTime:A}=p,C=v[0]!==a[0]||v[1]!==a[1]||v[2]!==a[2],T=v[3]!==a[3]||f!==r||h!==i||m!==o||g!==s||y!==l;return(T||C)&&x.set(d,{fillAlpha:r,renderFill:i,renderOutline:o,outlineWidth:s,segmentColor:a.slice(),segmentsHidden:new Set(l),cfunMTime:c.getMTime(),ofunMTime:u.getMTime()}),{forceOpacityUpdate:T,forceColorUpdate:C}}async function w(e,t,n,r){return await(0,i.A)(e.element,t,n,r)||void 0}const _={render:async function(e,t){const{segmentationId:n,config:i}=t,o=(0,c.T)(n);if(!o)return void console.warn("No segmentation found for segmentationId: ",n);let a=o.representationData[d.A.Labelmap],s=(0,h.ED)(e.id,n);if(a||!(0,m.Qy)()?.canComputeRequestedRepresentation(n,d.A.Labelmap)||A)a||(0,m.Qy)()||console.debug(`No labelmap data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to labelmap. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);else{A=!0;const t=(0,m.Qy)();if(a=await(0,g.d)(n,d.A.Labelmap,(()=>t.computeLabelmapData(n,{viewport:e})),(()=>null),(()=>{y._6.processLabelmapRepresentationAddition(e.id,n),setTimeout((()=>{(0,v.triggerSegmentationDataModified)(n)}),0)})),!a)throw new Error(`No labelmap data found for segmentationId ${n}.`);A=!1}if(a){if(e instanceof r.VolumeViewport)s?.length||await w(e,a,n,i),s=(0,h.ED)(e.id,n);else{const t=(0,l.aF)(e.id,n);if(!t?.length)return;s||await w(e,a,n,i),s=(0,h.ED)(e.id,n)}if(s?.length)for(const n of s)C(e.id,n,t)}},removeRepresentation:function(e,t,n=!1){const i=(0,r.getEnabledElementByViewportId)(e);if(x.forEach(((e,n)=>{n.includes(t)&&x.delete(n)})),!i)return;const{viewport:a}=i;(0,o.A)(a.element,t),n&&a.render()}}},67014:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>p});var r=n(15327),i=n(18682),o=n(20552),a=n(18796),s=n(33283),l=n(50409),c=n(36625),u=n(27479),d=n(47098);const p={render:async function(e,t){const{segmentationId:n,type:o}=t,p=(0,s.T)(n);if(!p)return;let f=p.representationData[i.A.Surface];if(!f&&(0,c.Qy)()?.canComputeRequestedRepresentation(n,i.A.Surface)){const t=(0,c.Qy)();if(f=await(0,u.d)(n,i.A.Surface,(()=>t.computeSurfaceData(n,{viewport:e})),(()=>t.updateSurfaceData(n,{viewport:e}))),!f)throw new Error(`No Surface data found for segmentationId ${n} even we tried to compute it`)}else f||(0,c.Qy)()||console.debug(`No surface data found for segmentationId ${n} and PolySeg add-on is not configured. Unable to convert from other representations to surface. Please register PolySeg using cornerstoneTools.init({ addons: { polySeg } }) to enable automatic conversion.`);if(!f)return void console.warn(`No Surface data found for segmentationId ${n}. Skipping render.`);const{geometryIds:h}=f;h?.size||console.warn(`No Surfaces found for segmentationId ${n}. Skipping render.`);const{colorLUTIndex:m}=t,g=(0,l.B)(m),v=[];h.forEach((t=>{const i=r.cache.getGeometry(t);if(!i?.data)return void console.warn(`No Surfaces found for geometryId ${t}. Skipping render.`);const{segmentIndex:s}=i.data,l=(0,d.s)(e.id,{segmentationId:n,type:o}).has(s),c=i.data,u=g[s];c.color=u.slice(0,3),c.visible=!l,v.push(c),(0,a.A)(e.element,c,n)})),e.render()},removeRepresentation:function(e,t,n=!1){const i=(0,r.getEnabledElementByViewportId)(e);if(!i)return;const{viewport:a}=i;(0,o.A)(a.element,t),n&&a.render()}}},67847:(e,t,n)=>{"use strict";var r=n(15327),i=n(4096),o=n(3823),a=n(6802),s=n(2076),l=n(17328),c=n(60810),u=n(27730),d=n(473),p=n(35489),f=n(29601),h=n(7001),m=n(58640),g=n(44049),v=n(4010),y=n(18990),b=n(73262),x=n(13165),A=n(40634);const{transformWorldToIndex:C}=r.utilities;class T extends v.A{constructor(e={},t={configuration:{storePointData:!1,numSlicesToPropagate:10,computePointsInsideVolume:!1,getTextLines:S,statsCalculator:b.BasicStatsCalculator,showTextBox:!1}}){super(e,t),this.addNewAnnotation=e=>{const t=e.detail,{currentPoints:n,element:i}=t,o=n.world,s=(0,r.getEnabledElement)(i),{viewport:l,renderingEngine:u}=s;this.isDrawing=!0;const d=l.getCamera(),{viewPlaneNormal:p,viewUp:f}=d;let g,v,y;if(l instanceof r.StackViewport)throw new Error("Stack Viewport Not implemented");{const e=this.getTargetId(l);y=r.utilities.getVolumeId(e),v=r.cache.getVolume(y),g=r.utilities.getClosestImageId(v,o,p)}const b=r.utilities.getSpacingInNormalDirection(v,p),x=this._getStartCoordinate(o,p),A=this._getEndCoordinate(o,b,p),C=l.getFrameOfReferenceUID(),T={highlighted:!0,invalidated:!0,metadata:{viewPlaneNormal:[...p],enabledElement:s,viewUp:[...f],FrameOfReferenceUID:C,referencedImageId:g,toolName:this.getToolName(),volumeId:y,spacingInNormal:b},data:{label:"",startCoordinate:x,endCoordinate:A,cachedStats:{pointsInVolume:[],projectionPoints:[],projectionPointsImageIds:[g],statistics:[]},handles:{textBox:{hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}},points:[[...o],[...o],[...o],[...o]],activeHandleIndex:null},labelmapUID:null}};this._computeProjectionPoints(T,v),(0,a.lC)(T,i);const S=(0,c.getViewportIdsWithToolToRender)(i,this.getToolName());return this.editData={annotation:T,viewportIdsToRender:S,handleIndex:3,newAnnotation:!0,hasMoved:!1},this._activateDraw(i),(0,h.hideElementCursor)(i),e.preventDefault(),(0,m.A)(S),T},this._endCallback=e=>{const t=e.detail,{element:n}=t,{annotation:i,viewportIdsToRender:o,newAnnotation:s,hasMoved:l}=this.editData,{data:c}=i;if(s&&!l)return;c.handles.activeHandleIndex=null,this._deactivateModify(n),this._deactivateDraw(n),(0,h.resetElementCursor)(n);const u=(0,r.getEnabledElement)(n);this.editData=null,this.isDrawing=!1,this.isHandleOutsideImage&&this.configuration.preventHandleOutsideImage&&(0,a.O8)(i.annotationUID);const d=this.getTargetId(u.viewport),p=r.cache.getVolume(d.split(/volumeId:|\?/)[1]);this.configuration.calculatePointsInsideVolume&&this._computePointsInsideVolume(i,d,p,u),(0,m.A)(o),s&&(0,g.triggerAnnotationCompleted)(i)},this.renderAnnotation=(e,t)=>{let n=!1;const{viewport:i}=e;let o=(0,a.Rh)(this.getToolName(),i.element);if(!o?.length)return n;o=(0,x.filterAnnotationsWithinSamePlane)(o,i.getCamera());const c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:e.viewport.id};for(let a=0;a<o.length;a++){const u=o[a],{annotationUID:p,data:h,metadata:m}=u,{startCoordinate:g,endCoordinate:v}=h,{points:y,activeHandleIndex:b}=h.handles,x=y.map((e=>i.worldToCanvas(e)));c.annotationUID=p;const A=this.getStyle("lineWidth",c,u),C=this.getStyle("lineDash",c,u),T=this.getStyle("color",c,u),S=i.getCamera().focalPoint,w=i.getCamera().viewPlaneNormal;let _=g,I=v;if(Array.isArray(g)){_=this._getCoordinateForViewplaneNormal(_,w);const e=this._getIndexOfCoordinatesForViewplaneNormal(w);h.handles.points.forEach((t=>{t[e]=_})),h.startCoordinate=_}Array.isArray(v)&&(I=this._getCoordinateForViewplaneNormal(I,w),h.endCoordinate=I,h.endCoordinate=I);const E=r.utilities.roundToPrecision(_),D=r.utilities.roundToPrecision(I),O=this._getCoordinateForViewplaneNormal(S,w),P=r.utilities.roundToPrecision(O);if(P<Math.min(E,D)||P>Math.max(E,D))continue;u.invalidated&&this._throttledCalculateCachedStats(u,e);let R,N=!1;if(P!==E&&P!==D||(N=!0),!i.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),n;if(!(0,f.isAnnotationVisible)(p))continue;if((0,s.isAnnotationLocked)(p)||this.editData||null===b||!N||(R=[x[b]]),R){const e="0";(0,l.drawHandles)(t,p,e,R,{color:T})}let M=C;N||(M=2);const L="0";if((0,l.drawRect)(t,p,L,x[0],x[3],{color:T,lineDash:M,lineWidth:A}),n=!0,this.configuration.showTextBox&&this.configuration.calculatePointsInsideVolume){const e=this.getLinkedTextBoxStyle(c,u);if(!e.visibility){h.handles.textBox={hasMoved:!1,worldPosition:[0,0,0],worldBoundingBox:{topLeft:[0,0,0],topRight:[0,0,0],bottomLeft:[0,0,0],bottomRight:[0,0,0]}};continue}const n=this.configuration.getTextLines(h,{metadata:m});if(!n||0===n.length)continue;if(!h.handles.textBox.hasMoved){const e=(0,d.getTextBoxCoordsCanvas)(x);h.handles.textBox.worldPosition=i.canvasToWorld(e)}const r=i.worldToCanvas(h.handles.textBox.worldPosition),o="1",a=(0,l.drawLinkedTextBox)(t,p,o,n,r,x,{},e),{x:s,y:f,width:g,height:v}=a;h.handles.textBox.worldBoundingBox={topLeft:i.canvasToWorld([s,f]),topRight:i.canvasToWorld([s+g,f]),bottomLeft:i.canvasToWorld([s,f+v]),bottomRight:i.canvasToWorld([s+g,f+v])}}}return n},this._throttledCalculateCachedStats=(0,u.A)(this._calculateCachedStatsTool,100,{trailing:!0})}_computeProjectionPoints(e,t){const{data:n,metadata:r}=e,{viewPlaneNormal:i,spacingInNormal:a}=r,{imageData:s}=t,{startCoordinate:l,endCoordinate:c}=n,{points:u}=n.handles,d=C(s,u[0]),p=C(s,u[0]),f=o.eR.create();s.indexToWorldVec3(d,f);const h=o.eR.create();s.indexToWorldVec3(p,h),2==this._getIndexOfCoordinatesForViewplaneNormal(i)?(f[2]=l,h[2]=c):0==this._getIndexOfCoordinatesForViewplaneNormal(i)?(f[0]=l,h[0]=c):1==this._getIndexOfCoordinatesForViewplaneNormal(i)&&(f[1]=l,h[1]=c);const m=o.eR.distance(f,h),g=[];for(let e=0;e<m;e+=a)g.push(u.map((t=>{const n=o.eR.create();return o.eR.scaleAndAdd(n,t,i,e),Array.from(n)})));n.cachedStats.projectionPoints=g}_computePointsInsideVolume(e,t,n,r){const{data:o,metadata:a}=e,{viewPlaneNormal:s,viewUp:l}=a,{viewport:c}=r,u=o.cachedStats.projectionPoints,d=[[]],f=this.getTargetImageData(t),h=o.handles.points[0],m=o.handles.points[3],{worldWidth:g,worldHeight:v}=(0,p.A)(s,l,h,m),b=(0,i.Op)(f,o.habdles),x=Math.abs(g*v)/(b.scale*b.scale),T={isPreScaled:(0,y.u)(c,t),isSuvScaled:this.isSuvScaled(c,t,e.metadata.referencedImageId)},S=(0,A.j)(a.Modality,e.metadata.referencedImageId,T);for(let e=0;e<u.length;e++){if(!n)continue;const t=u[e][0],{dimensions:r,imageData:i,voxelManager:o}=n,a=C(i,h),l=C(i,t),c=this._getIndexOfCoordinatesForViewplaneNormal(s);a[0]=Math.floor(a[0]),a[1]=Math.floor(a[1]),a[2]=Math.floor(a[2]),a[c]=l[c];const p=C(i,m);if(p[0]=Math.floor(p[0]),p[1]=Math.floor(p[1]),p[2]=Math.floor(p[2]),p[c]=l[c],this._isInsideVolume(a,p,r)){this.isHandleOutsideImage=!1;const e=[[Math.min(a[0],p[0]),Math.max(a[0],p[0])],[Math.min(a[1],p[1]),Math.max(a[1],p[1])],[Math.min(a[2],p[2]),Math.max(a[2],p[2])]],t=o.forEach(this.configuration.statsCalculator.statsCallback,{boundsIJK:e,imageData:i,returnPoints:this.configuration.storePointData});d.push(t)}}const w=this.configuration.statsCalculator.getStatistics();o.cachedStats.pointsInVolume=d,o.cachedStats.statistics={Modality:a.Modality,area:x,mean:w.mean?.value,stdDev:w.stdDev?.value,max:w.max?.value,statsArray:w.array,areaUnit:b.areaUnit,modalityUnit:S}}_calculateCachedStatsTool(e,t){const n=e.data,{viewport:i}=t,{cachedStats:o}=n,a=this.getTargetId(i),s=r.cache.getVolume(a.split(/volumeId:|\?/)[1]);return this._computeProjectionPoints(e,s),this.configuration.calculatePointsInsideVolume&&this._computePointsInsideVolume(e,a,s,t),this.configuration.calculatePointsInsideVolume&&this._computePointsInsideVolume(e,a,s,t),e.invalidated=!1,(0,g.triggerAnnotationModified)(e,i.element),o}_getStartCoordinate(e,t){const n=e;return this._getCoordinateForViewplaneNormal(n,t)}_getEndCoordinate(e,t,n){const r=this.configuration.numSlicesToPropagate,i=o.eR.create();o.eR.scaleAndAdd(i,e,n,r*t);return this._getCoordinateForViewplaneNormal(i,n)}_getIndexOfCoordinatesForViewplaneNormal(e){const t=[Math.abs(e[0]),Math.abs(e[1]),Math.abs(e[2])];return t.indexOf(Math.max(...t))}_getCoordinateForViewplaneNormal(e,t){return e[this._getIndexOfCoordinatesForViewplaneNormal(t)]}}function S(e,t={}){const n=e.cachedStats.statistics,{area:i,mean:o,max:a,stdDev:s,areaUnit:l,modalityUnit:c}=n;if(void 0===o)return;const u=[];return u.push(`Area: ${r.utilities.roundNumber(i)} ${l}`),u.push(`Mean: ${r.utilities.roundNumber(o)} ${c}`),u.push(`Max: ${r.utilities.roundNumber(a)} ${c}`),u.push(`Std Dev: ${r.utilities.roundNumber(s)} ${c}`),u}T.toolName="RectangleROIStartEndThreshold"},40336:(e,t,n)=>{"use strict";var r=n(15327),i=n(6802),o=n(2076),a=n(17328),s=n(60810),l=n(7001),c=n(58640),u=n(29601),d=n(44049),p=n(4010);class f extends p.A{constructor(e={},t={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1}}){super(e,t),this.addNewAnnotation=e=>{const t=e.detail,{currentPoints:n,element:o}=t,a=n.world,u=(0,r.getEnabledElement)(o),{viewport:d,renderingEngine:p}=u;this.isDrawing=!0;const f=d.getCamera(),{viewPlaneNormal:h,viewUp:m}=f,g=this.getTargetId(d);let v,y;if(d instanceof r.StackViewport)v=g.split("imageId:")[1];else{y=r.utilities.getVolumeId(g);const e=r.cache.getVolume(y);v=r.utilities.getClosestImageId(e,a,h)}const b=d.getFrameOfReferenceUID(),x={highlighted:!0,invalidated:!0,metadata:{viewPlaneNormal:[...h],enabledElement:u,viewUp:[...m],FrameOfReferenceUID:b,referencedImageId:v,toolName:this.getToolName(),volumeId:y},data:{label:"",handles:{textBox:{hasMoved:!1,worldPosition:null,worldBoundingBox:null},points:[[...a],[...a],[...a],[...a]],activeHandleIndex:null},segmentationId:null}};(0,i.lC)(x,o);const A=(0,s.getViewportIdsWithToolToRender)(o,this.getToolName());return this.editData={annotation:x,viewportIdsToRender:A,handleIndex:3,newAnnotation:!0,hasMoved:!1},this._activateDraw(o),(0,l.hideElementCursor)(o),e.preventDefault(),(0,c.A)(A),x},this.renderAnnotation=(e,t)=>{let n=!1;const{viewport:r}=e,{element:s}=r;let l=(0,i.Rh)(this.getToolName(),s);if(!l?.length)return n;if(l=this.filterInteractableAnnotationsForElement(s,l),!l?.length)return n;const c={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:e.viewport.id};for(let e=0;e<l.length;e++){const i=l[e],{annotationUID:p,data:f}=i,{points:h,activeHandleIndex:m}=f.handles,g=h.map((e=>r.worldToCanvas(e)));c.annotationUID=p;const v=this.getStyle("lineWidth",c,i),y=this.getStyle("lineDash",c,i),b=this.getStyle("color",c,i);if(!r.getRenderingEngine())return console.warn("Rendering Engine has been destroyed"),n;let x;if((0,d.triggerAnnotationModified)(i,s),!(0,u.isAnnotationVisible)(p))continue;if((0,o.isAnnotationLocked)(p)||this.editData||null===m||(x=[g[m]]),x){const e="0";(0,a.drawHandles)(t,p,e,x,{color:b})}const A="0";(0,a.drawRect)(t,p,A,g[0],g[3],{color:b,lineDash:y,lineWidth:v}),n=!0}return n}}}f.toolName="RectangleROIThreshold"},62753:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(15327),i=n(84093),o=n(33283),a=n(83075);const s={[i.A.EnsureImageVolumeFor3DManipulation]:e=>{const{operationData:t,viewport:n}=e;let i;if(n){i=n.getImageIds();if(!r.utilities.isValidVolume(i))throw new Error("Volume is not reconstructable for sphere manipulation")}else{i=(0,o.T)(t.segmentationId).representationData.Labelmap.imageIds.map((e=>r.cache.getImage(e).referencedImageId))}const s=(0,a.A)(i);if(!s)throw new Error("Failed to create or get image volume");t.imageVoxelManager=s.voxelManager,t.imageData=s.imageData}}},38732:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(15327),i=n(84093),o=n(30722);const a={[i.A.EnsureSegmentationVolumeFor3DManipulation]:e=>{const{operationData:t,viewport:n}=e,{segmentationId:i,imageIds:a}=t,s=n?n.getImageIds():a.map((e=>r.cache.getImage(e).referencedImageId));if(!r.utilities.isValidVolume(s))throw new Error("Volume is not reconstructable for sphere manipulation");const l=(0,o.A)(i);l&&(t.segmentationVoxelManager=l.voxelManager,t.segmentationImageData=l.imageData)}}},93126:(e,t,n)=>{"use strict";var r;n.d(t,{W:()=>r}),function(e){e[e.CounterClockwise=-1]="CounterClockwise",e[e.Unknown=0]="Unknown",e[e.Clockwise=1]="Clockwise"}(r||(r={}))},87063:(e,t,n)=>{"use strict";n.d(t,{C:()=>s,g:()=>a});var r=n(15327);const{EPSILON:i}=r.CONSTANTS;function o(e,t,n=!1){let r=1/0,o=n?-1/0:0,a=1/0,s=n?-1/0:0,l=1/0,c=n?-1/0:0;const u=3===e[0]?.length;for(let t=0;t<e.length;t++){const n=e[t];r=Math.min(n[0],r),o=Math.max(n[0],o),a=Math.min(n[1],a),s=Math.max(n[1],s),u&&(l=Math.min(n[2]??l,l),c=Math.max(n[2]??c,c))}return t?(r=Math.max(n?t[0]+i:0,r),o=Math.min(n?t[0]-i:t[0]-1,o),a=Math.max(n?t[1]+i:0,a),s=Math.min(n?t[1]-i:t[1]-1,s),u&&3===t.length&&(l=Math.max(n?t[2]+i:0,l),c=Math.min(n?t[2]-i:t[2]-1,c))):n||(r=Math.max(0,r),o=Math.min(1/0,o),a=Math.max(0,a),s=Math.min(1/0,s),u&&(l=Math.max(0,l),c=Math.min(1/0,c))),u?[[r,o],[a,s],[l,c]]:[[r,o],[a,s],null]}function a(e,t){return o(e,t,!1)}function s(e,t){return o(e,t,!0)}},62854:(e,t,n)=>{"use strict"},78130:(e,t,n)=>{"use strict"},37354:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var r=n(33283);function i(e){if(!e.data.segmentation)throw new Error("removeContourSegmentationAnnotation: annotation does not have a segmentation data");const{segmentationId:t,segmentIndex:n}=e.data.segmentation,i=(0,r.T)(t),{annotationUIDsMap:o}=i?.representationData.Contour||{},a=o?.get(n);a&&(a.delete(e.annotationUID),a.size||o.delete(n))}},93843:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(e,t){let n=0;for(let t=0;t<e.length-1;t++){const r=e[t],i=e[t+1];n+=Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2))}if(t){const t=e[0],r=e[e.length-1];n+=Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2))}return n}},15451:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(55659);function i(e,t){const n=(0,r.A)(e),i=[];return n.forEach((e=>{const n=e.length,r=new Array(n);for(let i=0;i<n;i++)r[i]=t.worldToCanvas(e[i]);i.push(r)})),i}},55659:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(82056);function i(e){return(e.childAnnotationUIDs??[]).map((e=>(0,r.getAnnotation)(e).data.contour.polyline))}},54889:(e,t,n)=>{"use strict";n(3823);n(46228),n(37546);n(15327);var r=n(18682);n(99737),n(44460),n(54285),n(30722);const{Labelmap:i}=r.A;var o=n(109);class a{static{this.TOOL_NAMES={}}constructor(){}static convert(e,t,n){!function(e){if(!e?.data)throw new Error("Tool data is empty");if(!e.metadata||e.metadata.referencedImageId)throw new Error("Tool data is not associated with any imageId")}(e);const{toolName:r}=e.metadata,i=a.TOOL_NAMES[r];if(!i)throw new Error(`Unknown tool type: ${r}, cannot convert to RTSSReport`);const o=i.getContourSequence(e,n);return{ReferencedROINumber:t+1,ROIDisplayColor:[Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())],ContourSequence:o}}static register(e){a.TOOL_NAMES[e.toolName]=e}}a.register(o.A);n(55659),n(15451),n(72967),n(27740);n(98013),n(93843)},72967:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(15327),i=n(95527),o=n(82056);function a(e,t,n,a){const{canvasToWorld:s,worldToCanvas:l}=n,{data:c}=e,{targetWindingDirection:u}=t;let{points:d}=t,p=i.polyline.getWindingDirection(d);a?.decimate?.enabled&&(d=i.polyline.decimate(t.points,a?.decimate?.epsilon));let{closed:f}=t;const h=d.length,m=new Array(h),g=(i.polyline.getWindingDirection(d),(0,o.getParentAnnotation)(e));if(void 0===f){let e=!1;if(d.length>3){const t=i.point.distanceToPointSquared(d[0],d[h-1]);e=r.utilities.isEqual(0,t)}f=e}if(!1!==a?.updateWindingDirection){let e=g?-1*g.data.contour.windingDirection:u;void 0===e&&(e=p),e!==p&&d.reverse();const t=(c.handles?.points??[]).map(l);if(t.length>2){i.polyline.getWindingDirection(t)!==e&&c.handles.points.reverse()}p=e}for(let e=0;e<h;e++)m[e]=s(d[e]);c.contour.polyline=m,c.contour.closed=f,c.contour.windingDirection=p,(0,o.invalidateAnnotation)(e)}},40634:(e,t,n)=>{"use strict";n.d(t,{N:()=>i,j:()=>o});var r=n(15327);function i(e,t){return o(r.metaData.get("generalSeriesModule",e).modality,e,t)}function o(e,t,n){return"CT"===e?"HU":"PT"===e?function(e,t){if(!t.isPreScaled)return"raw";if(t.isSuvScaled)return"SUV";const n=r.metaData.get("generalSeriesModule",e);if("PT"===n?.modality){const t=r.metaData.get("petSeriesModule",e);return t?.units||"unitless"}return"unknown"}(t,n):""}},15295:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(15327);const{isEqual:i}=r.utilities;function o(e){const{metadata:t}=e;return(0,r.getEnabledElements)().filter((e=>{if(e.FrameOfReferenceUID===t.FrameOfReferenceUID){const n=e.viewport,{viewPlaneNormal:r,viewUp:o}=n.getCamera();return i(r,t.viewPlaneNormal)&&(!t.viewUp||i(o,t.viewUp))}})).map((e=>e.viewport))}},92984:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addCanvasPointsToArray:()=>A.A,containsPoint:()=>i.A,containsPoints:()=>o.A,decimate:()=>h.A,getAABB:()=>a.A,getArea:()=>s.A,getClosestLineSegmentIntersection:()=>y.A,getFirstLineSegmentIntersectionIndexes:()=>m.A,getLineSegmentIntersectionsCoordinates:()=>v.A,getLineSegmentIntersectionsIndexes:()=>g.A,getNormal2:()=>d.A,getNormal3:()=>u.A,getSignedArea:()=>l.A,getSubPixelSpacingAndXYDirections:()=>b.A,getWindingDirection:()=>c.A,intersectPolyline:()=>f.A,isClosed:()=>r.A,isPointInsidePolyline3D:()=>T.i,mergePolylines:()=>p.S,pointCanProjectOnLine:()=>C.A,pointsAreWithinCloseContourProximity:()=>x.A,projectTo2D:()=>S.p,subtractPolylines:()=>p.Y});var r=n(19246),i=n(46513),o=n(42436),a=n(98122),s=n(86909),l=n(63113),c=n(4239),u=n(43490),d=n(11377),p=n(68385),f=n(405),h=n(99944),m=n(4338),g=n(37135),v=n(50932),y=n(32979),b=n(61785),x=n(82265),A=n(97792),C=n(80514),T=n(8361),S=n(28502)},90554:(e,t,n)=>{"use strict";function r(e,t){let n=[0,0],r=Number.MAX_SAFE_INTEGER;return e.forEach((function(e){const i=function(e,t){const[n,r]=e,[i,o]=t;return Math.sqrt(Math.pow(n-i,2)+Math.pow(r-o,2))}(t,e);i<r&&(r=i,n=[...e])})),n}n.d(t,{A:()=>r})},27963:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(15327);const{isEqual:i}=r.utilities,o={toIJK:e=>e,fromIJK:e=>e,type:"acquistion"},a={toIJK:([e,t,n])=>[n,e,t],fromIJK:([e,t,n])=>[t,n,e],type:"jk"},s={toIJK:([e,t,n])=>[e,n,t],fromIJK:([e,t,n])=>[e,n,t],type:"ik"};function l(e,t){if(!(e instanceof r.BaseVolumeViewport))return{...o,boundsIJKPrime:t};const{viewPlaneNormal:n}=e.getCamera(),l=i(Math.abs(n[0]),1)&&a||i(Math.abs(n[1]),1)&&s||i(Math.abs(n[2]),1)&&o;return l?{...l,boundsIJKPrime:l.fromIJK(t)}:{toIJK:null,boundsIJKPrime:null,fromIJK:null,error:`Only mappings orthogonal to acquisition plane are permitted, but requested ${n}`}}},37162:(e,t,n)=>{"use strict";n(15327),n(87063),n(76802)},44460:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var r=n(15327),i=n(36625);let o=!1;function a(){if(o)return;o=!0;const e=(0,r.getWebWorkerManager)(),t=(0,i.zj)().computeWorker,a={maxWorkerInstances:1,autoTerminateOnIdle:t?.autoTerminateOnIdle??{enabled:!0,idleTimeThreshold:2e3}};e.registerWorker("compute",(()=>new Worker(new URL(n.p+n.u(3694),n.b),{name:"compute",type:void 0})),a)}},27740:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var r=n(15327),i=n(47807),o=n(51893),a=n(73816),s=n(56229),l=n(75183),c=n(40133),u=n(85263);const{uuidv4:d}=r.utilities,p=[l.A.HandlesUpdated,l.A.InterpolationUpdated];class f{static{this.toolNames=[]}static addTool(e){this.toolNames.includes(e)||this.toolNames.push(e)}static acceptAutoGenerated(e,t={}){const{toolNames:n,segmentationId:r,segmentIndex:o,sliceIndex:a}=t;for(const t of n||f.toolNames){const n=i.state.getAnnotations(t,e);if(n?.length)for(const e of n){const{interpolationUID:t,data:n,autoGenerated:i,metadata:s}=e;t&&(e.interpolationCompleted=!0),i&&(o&&o!==n.segmentation.segmentIndex||void 0!==a&&s&&a!==s.sliceIndex||r&&r!==n.segmentation.segmentationId||((0,u.V)(e),e.autoGenerated=!1))}}}static{this.handleAnnotationCompleted=e=>{const t=e.detail.annotation;if(!t?.metadata)return;const{toolName:n,originalToolName:r}=t.metadata;if(!this.toolNames.includes(n)&&!this.toolNames.includes(r))return;const i=(0,c.A)(t);if(!i)return void console.warn("Unable to find viewport for",t);const l={viewport:i,sliceData:h(i),annotation:t,interpolationUID:t.interpolationUID},u=!!t.interpolationUID;if(t.autoGenerated=!1,u)return(0,s.A)(l),void(0,a.A)(l);const p=[{key:"segmentIndex",value:t.data.segmentation.segmentIndex,parentKey:e=>e.data.segmentation},{key:"viewPlaneNormal",value:t.metadata.viewPlaneNormal,parentKey:e=>e.metadata},{key:"viewUp",value:t.metadata.viewUp,parentKey:e=>e.metadata}];let f=(0,o.A)(l,p);const{sliceIndex:m}=t.metadata,g=new Set;f.forEach((e=>{if(e.interpolationCompleted||e.metadata.sliceIndex===m){const{interpolationUID:t}=e;g.add(t)}})),f=f.filter((e=>!g.has(e.interpolationUID))),t.interpolationUID=f[0]?.interpolationUID||d(),l.interpolationUID=t.interpolationUID,(0,a.A)(l)}}static{this.handleAnnotationUpdate=e=>{const t=e.detail.annotation,{changeType:n=l.A.HandlesUpdated}=e.detail;if(!t?.metadata)return;const{toolName:r,originalToolName:i}=t.metadata;if(!this.toolNames.includes(r)&&!this.toolNames.includes(i)||!p.includes(n))return;const o=(0,c.A)(t);if(!o)return void console.warn("Unable to find matching viewport for annotation interpolation",t);t.autoGenerated&&((0,u.V)(t),t.autoGenerated=!1);const s={viewport:o,sliceData:h(o),annotation:t,interpolationUID:t.interpolationUID,isInterpolationUpdate:n===l.A.InterpolationUpdated};(0,a.A)(s)}}static{this.handleAnnotationDelete=e=>{const t=e.detail.annotation;if(!t?.metadata)return;const{toolName:n}=t.metadata;if(!this.toolNames.includes(n)||t.autoGenerated)return;const r=(0,c.A)(t);if(!r)return void console.warn("No viewport, can't delete interpolated results",t);const i={viewport:r,sliceData:h(r),annotation:t,interpolationUID:t.interpolationUID};t.autoGenerated=!1,(0,s.A)(i)}}}function h(e){return{numberOfSlices:e.getNumberOfSlices(),imageIndex:e.getCurrentImageIdIndex()}}},68915:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c,C3:()=>l});var r=n(69013),i=n(4096);function o(e,t){const{value:n}=t,{maxIJKs:r}=e,i=r.length;if("number"!=typeof n||i>=10&&n<r[0].value)return;const o={value:t.value,pointLPS:t.pointLPS?[t.pointLPS[0],t.pointLPS[1],t.pointLPS[2]]:void 0,pointIJK:t.pointIJK?[t.pointIJK[0],t.pointIJK[1],t.pointIJK[2]]:void 0};if(!i||n>=r[i-1].value)r.push(o);else for(let e=0;e<i;e++)if(n<=r[e].value){r.splice(e,0,o);break}i>=10&&r.splice(0,1)}function a(e,t,n){const{spacing:r,calibration:o}=n,{volumeUnit:a}=(0,i.Op)({calibration:o,hasPixelSpacing:!0},[]),s=r?r[0]*r[1]*r[2]*1e3:1;return t.volume={value:Array.isArray(t.count.value)?t.count.value.map((e=>e*s)):t.count.value*s,unit:a,name:"volume",label:"Volume"},t.maxIJKs=e.maxIJKs.filter((e=>void 0!==e.pointIJK)),t.array.push(t.volume),e.maxIJKs=[],t}class s extends r.O{static{this.volumetricState={maxIJKs:[]}}static statsInit(e){super.statsInit(e),this.volumetricState={maxIJKs:[]}}static statsCallback(e){super.statsCallback(e),o(this.volumetricState,e)}static getStatistics(e){const t={...e,unit:e?.unit||"none",calibration:e?.calibration,hasPixelSpacing:e?.hasPixelSpacing},n=super.getStatistics(t);return a(this.volumetricState,n,t)}}class l extends r.B{constructor(e){super(e),this.volumetricState={maxIJKs:[]}}statsInit(e){super.statsInit(e),this.volumetricState={maxIJKs:[]}}statsCallback(e){super.statsCallback(e),o(this.volumetricState,e)}getStatistics(e){const t={...e,unit:e?.unit||"none",calibration:e?.calibration,hasPixelSpacing:e?.hasPixelSpacing},n=super.getStatistics(t);return a(this.volumetricState,n,t)}}const c=s},17014:(e,t,n)=>{"use strict";n(77609),n(58640),n(15327),n(14957)},49492:(e,t,n)=>{"use strict";n(77609),n(58640),n(14957)},88274:(e,t,n)=>{"use strict";n(15327),n(54285),n(99737),n(44460),n(4334),n(33283),n(30722),n(83075)},13276:(e,t,n)=>{"use strict";n(54889),n(60199),n(30722)},14514:(e,t,n)=>{"use strict"},2397:(e,t,n)=>{"use strict";n.d(t,{createLabelmapMemo:()=>s});var r=n(15327),i=n(49906);n(94021);const{VoxelManager:o,RLEVoxelMap:a}=r.utilities;function s(e,t){return function(e,t){const n=o.createRLEHistoryVoxelManager(t),i={segmentationId:e,restoreMemo:l,commitMemo:c,segmentationVoxelManager:t,voxelManager:n,id:r.utilities.uuidv4(),operationType:"labelmap"};return i}(e,t)}function l(e){const{segmentationVoxelManager:t,undoVoxelManager:n,redoVoxelManager:r}=this,o=!1===e?r:n;o.forEach((({value:e,pointIJK:n})=>{t.setAtIJKPoint(n,e)}));const a=o.getArrayOfModifiedSlices();(0,i.triggerSegmentationDataModified)(this.segmentationId,a)}function c(){if(this.redoVoxelManager)return!0;if(!this.voxelManager.modifiedSlices.size)return!1;const{segmentationVoxelManager:e}=this,t=o.createRLEHistoryVoxelManager(e);a.copyMap(t.map,this.voxelManager.map);for(const e of this.voxelManager.modifiedSlices.keys())t.modifiedSlices.add(e);this.undoVoxelManager=t;const n=o.createRLEVolumeVoxelManager({dimensions:this.segmentationVoxelManager.dimensions});return this.redoVoxelManager=n,t.forEach((({index:t,pointIJK:r,value:i})=>{const o=e.getAtIJKPoint(r);o!==i&&n.setAtIndex(t,o)})),!0}},97492:(e,t,n)=>{"use strict";n(15327)},4334:(e,t,n)=>{"use strict";n(15327)},83075:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(15327);const i=function(e){if(!e||e.length<=1)return;if(!r.utilities.isValidVolume(e))return;const t=r.cache.generateVolumeId(e);let n=r.cache.getVolume(t);return n||(n=r.volumeLoader.createAndCacheVolumeFromImagesSync(t,e),n)}},30722:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(15327),i=n(33283);const o=function(e){const{representationData:t}=(0,i.T)(e);let n,{volumeId:o}=t.Labelmap;if(o&&(n=r.cache.getVolume(o),n))return n;const{imageIds:a}=t.Labelmap;if(o=r.cache.generateVolumeId(a),!a||1===a.length)return;return r.utilities.isValidVolume(a)?(n=r.volumeLoader.createAndCacheVolumeFromImagesSync(o,a),n):void 0}},12853:(e,t,n)=>{"use strict";n.d(t,{b:()=>i});var r=n(15327);function i(e){const t=r.cache.getVolume(e);if(!t)return null;const n=t.referencedVolumeId;let i;if(n)i=r.cache.getVolume(n);else{const e=t.imageIds,n=r.cache.getImage(e[0]).referencedImageId,o=r.cache.getVolumeContainingImageId(n);i=o?.volume}return i}},78773:(e,t,n)=>{"use strict";n(15327),n(99737),n(44460),n(54285)},38440:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var r=n(15327),i=n(54285),o=n(40634),a=n(68915),s=n(99737),l=n(44460);const c=Math.pow(3e3/(4*Math.PI),1/3);const u=(e,t)=>{if(!e.array)return;const n=e.array.findIndex((e=>e.name===t.name));-1!==n?e.array[n]=t:e.array.push(t)},d=({stats:e,unit:t,spacing:n,segmentationImageData:r,imageVoxelManager:i})=>{if(e.mean.unit=t,e.max.unit=t,e.min.unit=t,"SUV"!==t)return e;const o=n.map((e=>Math.max(1,Math.round(1.1*c/e))));for(const a of e.maxIJKs){const s=p(a,o,r,i,n);if(!s)continue;const{mean:l}=s;(!e.peakValue||e.peakValue.value<=l.value)&&(e.peakValue={name:"peakValue",label:"Peak Value",value:l.value,unit:t},e.peakPoint={name:"peakLPS",label:"Peak SUV Point",value:a.pointLPS?[...a.pointLPS]:null,unit:null},u(e,e.peakValue),u(e,e.peakPoint))}if(e.volume&&e.mean){const n=e.volume.value,r=e.mean.value;e.lesionGlycolysis={name:"lesionGlycolysis",label:"Lesion Glycolysis",value:n*r,unit:`${e.volume.unit}·${t}`},u(e,e.lesionGlycolysis)}return e};function p(e,t,n,i,o){const{pointIJK:s,pointLPS:l}=e;if(!s)return;const c=s.map(((e,n)=>[e-t[n],e+t[n]]));return a.Ay.statsInit({storePointData:!1}),r.utilities.pointInShapeCallback(n,{pointInShapeFn:(e,n)=>{const r=(n[0]-s[0])/t[0],i=(n[1]-s[1])/t[1],o=(n[2]-s[2])/t[2];return r*r+i*i+o*o<=1},callback:({pointIJK:e,pointLPS:t})=>{const n=i.getAtIJKPoint(e);void 0!==n&&a.Ay.statsCallback({value:n,pointLPS:t,pointIJK:e})},boundsIJK:c}),a.Ay.getStatistics({spacing:o})}const f=async function({segmentationId:e,segmentIndices:t,mode:n="collective"}){(0,l.D)(),(0,i.sg)(s.WorkerTypes.COMPUTE_STATISTICS,0);const c=(0,i.yR)(e,t);if(!c)return;const{operationData:u,segVolumeId:p,segImageIds:f,reconstructableVolume:h,indices:m}=c,{refImageId:g,modalityUnitOptions:v}=(0,i.FI)(p,f),y=(0,o.N)(g,v);return h?await async function({operationData:e,indices:t,unit:n,mode:o}){const l=(0,i.o9)(e),{segmentationVoxelManager:c,imageVoxelManager:u,segmentationImageData:p,imageData:f}=l;if(!c||!p)return;const h=p.getSpacing(),{boundsIJK:m}=c;if(!m)return a.Ay.getStatistics({spacing:h});const g={scalarData:c.getCompleteScalarDataArray(),dimensions:p.getDimensions(),spacing:p.getSpacing(),origin:p.getOrigin(),direction:p.getDirection()},v={scalarData:u.getCompleteScalarDataArray(),dimensions:f.getDimensions(),spacing:f.getSpacing(),origin:f.getOrigin(),direction:f.getDirection()},y=await(0,r.getWebWorkerManager)().executeTask("compute","calculateSegmentsStatisticsVolume",{segmentationInfo:g,imageInfo:v,indices:t,mode:o});if((0,i.sg)(s.WorkerTypes.COMPUTE_STATISTICS,100),"collective"===o)return d({stats:y,unit:n,spacing:h,segmentationImageData:p,imageVoxelManager:u});{const e={};return Object.entries(y).forEach((([t,r])=>{e[t]=d({stats:r,unit:n,spacing:h,segmentationImageData:p,imageVoxelManager:u})})),e}}({operationData:u,indices:m,unit:y,mode:n}):await async function({segImageIds:e,indices:t,unit:n,mode:o}){(0,i.sg)(s.WorkerTypes.COMPUTE_STATISTICS,0);const{segmentationInfo:a,imageInfo:l}=(0,i.Dn)(e),c=await(0,r.getWebWorkerManager)().executeTask("compute","calculateSegmentsStatisticsStack",{segmentationInfo:a,imageInfo:l,indices:t,mode:o});(0,i.sg)(s.WorkerTypes.COMPUTE_STATISTICS,100);const u=a[0].spacing,p=a[0],f=l[0].voxelManager;if("collective"===o)return d({stats:c,unit:n,spacing:u,segmentationImageData:p,imageVoxelManager:f});{const e={};return Object.entries(c).forEach((([t,r])=>{e[t]=d({stats:r,unit:n,spacing:u,segmentationImageData:p,imageVoxelManager:f})})),e}}({segImageIds:f,indices:m,unit:y,mode:n})}},25758:(e,t,n)=>{"use strict";n(15327),n(99737),n(64063),n(33283)},67912:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(15327),i=n(27963);const{RLEVoxelMap:o,VoxelManager:a}=r.utilities;var s;!function(e){e[e.SEGMENT=-1]="SEGMENT",e[e.ISLAND=-2]="ISLAND",e[e.INTERIOR=-3]="INTERIOR",e[e.EXTERIOR=-4]="EXTERIOR",e[e.INTERIOR_SMALL=-5]="INTERIOR_SMALL",e[e.INTERIOR_TEST=-6]="INTERIOR_TEST"}(s||(s={}));class l{constructor(e){this.fillInternalEdge=!1,this.maxInternalRemove=128,this.maxInternalRemove=e?.maxInternalRemove??this.maxInternalRemove,this.fillInternalEdge=e?.fillInternalEdge??this.fillInternalEdge}initialize(e,t,n){const r=!!t.sourceVoxelManager,l=r?t.sourceVoxelManager:t,c=r?t:a.createRLEHistoryVoxelManager(l),{segmentIndex:u=1,previewSegmentIndex:d=1}=n,p=n.points||l.getPoints();if(!p?.length)return;const f=l.getBoundsIJK().map(((e,t)=>[Math.min(e[0],...p.map((e=>e[t]))),Math.max(e[1],...p.map((e=>e[t])))]));if(f.find((e=>e[0]<0||e[1]>65535)))return;const{toIJK:h,fromIJK:m,boundsIJKPrime:g,error:v}=(0,i.A)(e,f);if(v)return void console.warn("Not performing island removal for planes not orthogonal to acquisition plane",v);const[y,b,x]=m(l.dimensions),A=new o(y,b,x);return A.fillFrom(((e,t,n)=>{const r=l.toIndex(h([e,t,n])),i=l.getAtIndex(r);if(i===d||i===u)return s.SEGMENT}),g),A.normalizer={toIJK:h,fromIJK:m,boundsIJKPrime:g},this.segmentSet=A,this.previewVoxelManager=c,this.segmentIndex=u,this.previewSegmentIndex=d??u,this.selectedPoints=p,!0}floodFillSegmentIsland(){const{selectedPoints:e,segmentSet:t}=this;let n=0;const{fromIJK:r}=t.normalizer;return e.forEach((e=>{const i=r(e),o=t.toIndex(i),[a,l,c]=i;t.get(o)===s.SEGMENT&&(n+=t.floodFill(a,l,c,s.ISLAND))})),n}removeExternalIslands(){const{previewVoxelManager:e,segmentSet:t}=this,{toIJK:n}=t.normalizer;t.forEach(((r,i)=>{const[,o,a]=t.toIJK(r);if(i.value!==s.ISLAND)for(let t=i.start;t<i.end;t++){const r=n([t,o,a]),i=e.getAtIJKPoint(r);e.setAtIJKPoint(r,void 0===i?0:null)}}),{rowModified:!0})}removeInternalIslands(){const{segmentSet:e,previewVoxelManager:t,previewSegmentIndex:n}=this,{height:r,normalizer:i,width:o}=e,{toIJK:a}=i;return e.forEachRow(((t,n)=>{let r;for(const i of[...n])if(i.value===s.ISLAND)if(r){for(let n=r.end;n<i.start;n++)e.set(t+n,s.INTERIOR);r=i}else{if(this.fillInternalEdge&&i.start>0)for(let n=0;n<i.start;n++)e.set(t+n,s.INTERIOR);r=i}if(this.fillInternalEdge&&r?.end<o)for(let n=r.end;n<o;n++)e.set(t+n,s.INTERIOR)})),e.forEach(((t,n)=>{if(n.value!==s.INTERIOR)return;const[,i,o]=e.toIJK(t),a=i>0?e.getRun(i-1,o):null,c=i+1<r?e.getRun(i+1,o):null,u=i===r-1,d=0===i,p=l.covers(n,a)||d&&this.fillInternalEdge,f=l.covers(n,c)||u&&this.fillInternalEdge;!(n.end-n.start>2)||p&&f||e.floodFill(n.start,i,o,s.EXTERIOR,{singlePlane:!0})})),e.forEach(((t,n)=>{if(n.value!==s.INTERIOR)return;const[,r,i]=e.toIJK(t),o=e.floodFill(n.start,r,i,s.INTERIOR_TEST)>this.maxInternalRemove?s.EXTERIOR:s.INTERIOR_SMALL;e.floodFill(n.start,r,i,o)})),e.forEach(((r,i)=>{if(i.value===s.INTERIOR_SMALL)for(let o=i.start;o<i.end;o++){const i=a(e.toIJK(r+o));t.setAtIJKPoint(i,n)}})),t.getArrayOfModifiedSlices()}static covers(e,t){if(!t)return!1;let{start:n}=e;const{end:r}=e;for(const e of t)if(n>=e.start&&n<e.end&&(n=e.end,n>=r))return!0;return!1}}},52323:(e,t,n)=>{"use strict";n(47807),n(67847),n(40336),n(8582),n(37162)},22592:(e,t,n)=>{"use strict";n(15327),n(47807),n(13276),n(14514),n(25072),n(70758),n(60740)},73706:(e,t,n)=>{"use strict";n(49906),n(64063)},8582:(e,t,n)=>{"use strict";n(49906),n(64063)},64063:(e,t,n)=>{"use strict";n.d(t,{HM:()=>i});n(15327),n(87063);const r=new Map,i=e=>{const t=r.get(e);t&&(t.isDirty=!0)}},54285:(e,t,n)=>{"use strict";n.d(t,{Dn:()=>p,FI:()=>f,o9:()=>d,sg:()=>c,yR:()=>u});var r=n(15327),i=n(60740),o=n(33283),a=n(40905),s=n(38732),l=n(62753);const c=(e,t)=>{(0,r.triggerEvent)(r.eventTarget,r.Enums.Events.WEB_WORKER_PROGRESS,{progress:t,type:e})},u=(e,t)=>{const n=(0,o.T)(e),{representationData:a}=n,{Labelmap:s}=a;if(!s)return console.debug("No labelmap found for segmentation",e),null;const l=s.volumeId,c=s.imageIds,u={segmentationId:e,volumeId:l,imageIds:c};let d=!1;if(c){const e=c.map((e=>r.cache.getImage(e).referencedImageId));d=r.utilities.isValidVolume(e)}let p=t;return p?Array.isArray(p)||(p=[p,255]):p=[(0,i.Q)(e)],{operationData:u,segVolumeId:l,segImageIds:c,reconstructableVolume:d,indices:p}},d=e=>(0,a.S)({operationData:e,strategy:{ensureSegmentationVolumeFor3DManipulation:s.A.ensureSegmentationVolumeFor3DManipulation,ensureImageVolumeFor3DManipulation:l.A.ensureImageVolumeFor3DManipulation}}),p=e=>{const t=[],n=[];for(const i of e){const e=r.cache.getImage(i),o=e.getPixelData(),{origin:a,direction:s,spacing:l,dimensions:c}=r.utilities.getImageDataMetadata(e);t.push({scalarData:o,dimensions:c,spacing:l,origin:a,direction:s});const u=e.referencedImageId;if(u){const e=r.cache.getImage(u);if(!e)continue;const t=e.getPixelData(),i=e.voxelManager,o=[e.rowPixelSpacing,e.columnPixelSpacing];n.push({scalarData:t,dimensions:i?i.dimensions:[e.columns,e.rows,1],spacing:o})}}return{segmentationInfo:t,imageInfo:n}},f=(e,t)=>{let n;if(e){const t=r.cache.getVolume(e).imageIds,i=r.cache.getImage(t[0]);i&&(n=i.referencedImageId)}else if(t?.length){n=r.cache.getImage(t[0]).referencedImageId}const i=r.cache.getImage(n),o=r.metaData.get("scalingModule",n);return{refImageId:n,modalityUnitOptions:{isPreScaled:Boolean(i.preScale?.scaled),isSuvScaled:"number"==typeof o?.suvbw}}}},21345:(e,t,n)=>{"use strict";n(15327)},56069:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(39011);const i=function(e){r.o.renderViewport(e)}},3198:(e,t,n)=>{"use strict";function r(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const n=e[i];n.getFrameOfReferenceUID()===t&&r.push(n)}return r}n.d(t,{A:()=>r})},67514:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(3823);const i=function(e,t,n=.999){return e.filter((e=>{const i=e.getCamera();return Math.abs(r.eR.dot(i.viewPlaneNormal,t.viewPlaneNormal))>n}))}},9356:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(99737),i=n(77609);const{Active:o,Passive:a,Enabled:s}=r.ToolModes;function l(e,t){const n=e.length,r=[];for(let o=0;o<n;o++){const n=e[o],a=(0,i.getToolGroupForViewport)(n.id,n.renderingEngineId);if(!a)continue;c(a,t)&&r.push(n)}return r}function c(e,t){const{toolOptions:n}=e,r=n[t];if(!r)return!1;const i=r.mode;return i===o||i===a||i===s}},35056:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(28906),i=n(42008),o=n(28914);function a(e){let t=0;return e.filter(((e,n)=>n===t&&(t+=e+1,!0)))}function s(e){let t=0;for(let n=0;n<e.length;)n+=e[n]+1,t++;return t}const l={extractCellSizes:a,getNumberOfCells:s};function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i.Ay.extend(e,t,function(e){return{empty:!0,numberOfComponents:1,dataType:o.JA.UNSIGNED_INT,...e}}(n)),function(e,t){t.classHierarchy.push("vtkCellArray");const n={...e};e.getNumberOfCells=n=>void 0===t.numberOfCells||n?(t.cellSizes?t.numberOfCells=t.cellSizes.length:t.numberOfCells=s(e.getData()),t.numberOfCells):t.numberOfCells,e.getCellSizes=n=>void 0===t.cellSizes||n?(t.cellSizes=a(e.getData()),t.cellSizes):t.cellSizes,e.resize=r=>{const i=e.getNumberOfTuples();n.resize(r);const o=e.getNumberOfTuples();o<i&&(0===o?(t.numberOfCells=0,t.cellSizes=[]):(t.numberOfCells=void 0,t.cellSizes=void 0))},e.setData=e=>{n.setData(e,1),t.numberOfCells=void 0,t.cellSizes=void 0},e.getCell=e=>{let n=e;const r=t.values[n++];return t.values.subarray(n,n+r)},e.insertNextCell=n=>{const r=e.getNumberOfCells();return e.insertNextTuples([n.length,...n]),++t.numberOfCells,null!=t.cellSizes&&t.cellSizes.push(n.length),r}}(e,t)}var u={newInstance:r.m.newInstance(c,"vtkCellArray"),extend:c,...l}},44302:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});class r extends Array{push(){for(let e=0;e<arguments.length;e++)this.includes(arguments[e])||super.push(arguments[e]);return this.length}}},42008:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>v});var r=n(28914),i=n(28906),o=n(16632);const{vtkErrorMacro:a}=i.c,{DefaultDataType:s}=r.Ay,l=1e-6;function c(e,t,n){const r=e.length;let i,o,a=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(o=t;o<r;o+=n)if(!Number.isNaN(e[o])){a=e[o],s=a;break}for(;o<r;o+=n)i=e[o],i<a?a=i:i>s&&(s=i);return{min:a,max:s}}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t<0&&n>1){const t=e.length/n,r=new Float64Array(t);for(let i=0,o=0;i<t;++i){for(let t=o+n;o<t;++o)r[i]+=e[o]*e[o];r[i]**=.5}return c(r,0,1)}return c(e,t<0?0:t,n)}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=e||[];for(;n.length<=t;)n.push(null);return n}function p(e){return Object.prototype.toString.call(e).slice(8,-1)}const f={computeRange:u,createRangeHelper:function(){let e=Number.MAX_VALUE,t=-Number.MAX_VALUE,n=0,r=0;return{add(i){e>i&&(e=i),t<i&&(t=i),n++,r+=i},get:()=>({min:e,max:t,count:n,sum:r,mean:r/n}),getRange:()=>({min:e,max:t})}},fastComputeRange:c,getDataType:p,getMaxNorm:function(e){const t=e.getNumberOfComponents();let n=0;const r=new Array(t);for(let i=0;i<e.getNumberOfTuples();++i){e.getTuple(i,r);const a=(0,o.n)(r,t);a>n&&(n=a)}return n}};const h={name:"",numberOfComponents:1,dataType:s,rangeTuple:[0,0]};function m(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Object.assign(t,h,n),Array.isArray(n.values)&&void 0===n.dataType&&console.warn("vtkDataArray.newInstance: no dataType provided, converting to Float32Array"),!t.empty&&!t.values&&!t.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(t.values?Array.isArray(t.values)&&(t.values=(0,i.b)(t.dataType,t.values)):t.values=(0,i.a)(t.dataType,t.size),t.values&&(t.size=t.size??t.values.length,t.dataType=p(t.values)),(0,i.o)(e,t),(0,i.s)(e,t,["name","numberOfComponents"]),t.size%t.numberOfComponents!=0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");!function(e,t){function n(n){if(n<0)return!1;const r=e.getNumberOfComponents(),o=t.values.length/(r>0?r:1);if(n===o)return!0;if(n>o){const e=t.values;return t.values=(0,i.a)(t.dataType,(n+o)*r),t.values.set(e),!0}return t.size>n*r&&(t.size=n*r,e.dataChange()),!0}t.classHierarchy.push("vtkDataArray"),e.dataChange=()=>{t.ranges=null,e.modified()},e.resize=r=>{n(r);const i=r*e.getNumberOfComponents();return t.size!==i&&(t.size=i,e.dataChange(),!0)},e.initialize=()=>{e.resize(0)},e.getElementComponentSize=()=>t.values.BYTES_PER_ELEMENT,e.getComponent=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.values[e*t.numberOfComponents+n]},e.setComponent=(n,r,i)=>{i!==t.values[n*t.numberOfComponents+r]&&(t.values[n*t.numberOfComponents+r]=i,e.dataChange())},e.getValue=n=>{const r=n/t.numberOfComponents,i=n%t.numberOfComponents;return e.getComponent(r,i)},e.setValue=(n,r)=>{const i=n/t.numberOfComponents,o=n%t.numberOfComponents;e.setComponent(i,o,r)},e.getData=()=>t.size===t.values.length?t.values:t.values.subarray(0,t.size),e.getRange=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=n;r<0&&(r=1===t.numberOfComponents?0:t.numberOfComponents);let i=null;return t.ranges||(t.ranges=d(t.ranges,t.numberOfComponents)),i=t.ranges[r],i?(t.rangeTuple[0]=i.min,t.rangeTuple[1]=i.max,t.rangeTuple):(i=u(e.getData(),n,t.numberOfComponents),t.ranges[r]=i,t.rangeTuple[0]=i.min,t.rangeTuple[1]=i.max,t.rangeTuple)},e.setRange=(e,n)=>{t.ranges||(t.ranges=d(t.ranges,t.numberOfComponents));const r={min:e.min,max:e.max};return t.ranges[n]=r,t.rangeTuple[0]=r.min,t.rangeTuple[1]=r.max,t.rangeTuple},e.getRanges=function(){if(arguments.length>0&&void 0!==arguments[0]&&!arguments[0])return structuredClone(t.ranges);const n=[];for(let r=0;r<t.numberOfComponents;r++){const[t,i]=e.getRange(r),o={min:t,max:i};n.push(o)}if(t.numberOfComponents>1){const[t,r]=e.getRange(-1),i={min:t,max:r};n.push(i)}return n},e.setTuple=(e,n)=>{const r=e*t.numberOfComponents;for(let e=0;e<t.numberOfComponents;e++)t.values[r+e]=n[e]},e.setTuples=(e,n)=>{let r=e*t.numberOfComponents;const i=Math.min(n.length,t.size-r);for(let e=0;e<i;)t.values[r++]=n[e++]},e.insertTuple=(r,i)=>(t.size<=r*t.numberOfComponents&&(t.size=(r+1)*t.numberOfComponents,n(r+1)),e.setTuple(r,i),r),e.insertTuples=(r,i)=>{const o=r+i.length/t.numberOfComponents;return t.size<o*t.numberOfComponents&&(t.size=o*t.numberOfComponents,n(o)),e.setTuples(r,i),o},e.insertNextTuple=n=>{const r=t.size/t.numberOfComponents;return e.insertTuple(r,n)},e.insertNextTuples=n=>{const r=t.size/t.numberOfComponents;return e.insertTuples(r,n)},e.findTuple=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;for(let r=0;r<t.size;r+=t.numberOfComponents)if(Math.abs(e[0]-t.values[r])<=n){let i=!0;for(let o=1;o<t.numberOfComponents;++o)if(Math.abs(e[o]-t.values[r+o])>n){i=!1;break}if(i)return r/t.numberOfComponents}return-1},e.getTuple=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=t.numberOfComponents||1,i=e*r;switch(r){case 4:n[3]=t.values[i+3];case 3:n[2]=t.values[i+2];case 2:n[1]=t.values[i+1];case 1:n[0]=t.values[i];break;default:for(let e=r-1;e>=0;--e)n[e]=t.values[i+e]}return n},e.getTuples=(n,r)=>{const i=(n??0)*t.numberOfComponents,o=(r??e.getNumberOfTuples())*t.numberOfComponents,a=e.getData().subarray(i,o);return a.length>0?a:null},e.getTupleLocation=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)*t.numberOfComponents},e.getNumberOfComponents=()=>t.numberOfComponents,e.getNumberOfValues=()=>t.size,e.getNumberOfTuples=()=>t.size/t.numberOfComponents,e.getDataType=()=>t.dataType,e.newClone=()=>g({empty:!0,name:t.name,dataType:t.dataType,numberOfComponents:t.numberOfComponents}),e.getName=()=>(t.name||(e.modified(),t.name=`vtkDataArray${e.getMTime()}`),t.name),e.setData=(n,r)=>{t.values=n,t.size=n.length,t.dataType=p(n),r&&(t.numberOfComponents=r),t.size%t.numberOfComponents!=0&&(t.numberOfComponents=1),e.dataChange()},e.getState=()=>{if(t.deleted)return null;const n={...t,vtkClass:e.getClassName()};n.values=Array.from(n.values),delete n.buffer,Object.keys(n).forEach((e=>{n[e]||delete n[e]}));const r={};return Object.keys(n).sort().forEach((e=>{r[e]=n[e]})),r.mtime&&delete r.mtime,r},e.deepCopy=n=>{const r=e.getDataType(),i=t.values;e.shallowCopy(n),t.ranges=structuredClone(n.getRanges()),i?.length>=n.getNumberOfValues()&&r===n.getDataType()?(i.set(n.getData()),t.values=i,e.dataChange()):e.setData(n.getData().slice())},e.interpolateTuple=(n,r,i,o,s,l)=>{const c=t.numberOfComponents||1;c===r.getNumberOfComponents()&&c===o.getNumberOfComponents()||a("numberOfComponents must match");const u=r.getTuple(i),d=o.getTuple(s),p=[];switch(p.length=c,c){case 4:p[3]=u[3]+(d[3]-u[3])*l;case 3:p[2]=u[2]+(d[2]-u[2])*l;case 2:p[1]=u[1]+(d[1]-u[1])*l;case 1:p[0]=u[0]+(d[0]-u[0])*l;break;default:for(let e=0;e<c;e++)p[e]=u[e]+(d[e]-u[e])*l}return e.insertTuple(n,p)}}(e,t)}const g=(0,i.n)(m,"vtkDataArray");var v={newInstance:g,extend:m,...f,...r.Ay}},28914:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o,JA:()=>i,uP:()=>r});const r={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},i={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"};var o={DefaultDataType:i.FLOAT,DataTypeByteSize:r,VtkDataTypes:i}},97888:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const r=new Float32Array(1),i=new Int32Array(r.buffer);var o={fromHalf:function(e){const t=(32768&e)>>15,n=(31744&e)>>10,r=1023&e;return 0===n?(t?-1:1)*2**-14*(r/1024):31===n?r?NaN:1/0*(t?-1:1):(t?-1:1)*2**(n-15)*(1+r/1024)},toHalf:function(e){r[0]=e;const t=i[0];let n=t>>16&32768,o=t>>12&2047;const a=t>>23&255;return a<103?n:a>142?(n|=31744,n|=(255===a?0:1)&&8388607&t,n):a<113?(o|=2048,n|=(o>>114-a)+(o>>113-a&1),n):(n|=a-112<<10|o>>1,n+=1&o,n)}}},72879:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>h});var r=n(28906),i=n(16632),o=n(80993),a=n(62955),s=n(28914);const{vtkErrorMacro:l}=r.m,c=0,u=1,d=2;const p={numberOfColors:256,hueRange:[0,.66667],saturationRange:[1,1],valueRange:[1,1],alphaRange:[1,1],nanColor:[.5,0,0,1],belowRangeColor:[0,0,0,1],aboveRangeColor:[1,1,1,1],useAboveRangeColor:!1,useBelowRangeColor:!1,alpha:1};function f(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,p,n),o.Ay.extend(e,t,n),t.table||(t.table=[]),t.buildTime={},r.m.obj(t.buildTime),t.opaqueFlagBuildTime={},r.m.obj(t.opaqueFlagBuildTime,{mtime:0}),t.insertTime={},r.m.obj(t.insertTime,{mtime:0}),r.m.get(e,t,["buildTime"]),r.m.setGet(e,t,["numberOfColors","useAboveRangeColor","useBelowRangeColor"]),r.m.setArray(e,t,["alphaRange","hueRange","saturationRange","valueRange"],2),r.m.setArray(e,t,["nanColor","belowRangeColor","aboveRangeColor"],4),r.m.getArray(e,t,["hueRange","saturationRange","valueRange","alphaRange","nanColor","belowRangeColor","aboveRangeColor"]),function(e,t){t.classHierarchy.push("vtkLookupTable"),e.isOpaque=()=>{if(t.opaqueFlagBuildTime.getMTime()<e.getMTime()){let e=!0;t.nanColor[3]<1&&(e=0),t.useBelowRangeColor&&t.belowRangeColor[3]<1&&(e=0),t.useAboveRangeColor&&t.aboveRangeColor[3]<1&&(e=0);for(let n=3;n<t.table.length&&e;n+=4)t.table[n]<255&&(e=!1);t.opaqueFlag=e,t.opaqueFlagBuildTime.modified()}return t.opaqueFlag},e.usingLogScale=()=>!1,e.getNumberOfAvailableColors=()=>t.table.length/4-3,e.linearIndexLookup=(e,t)=>{let n=0;const r=Number(e);return r<t.range[0]?n=t.maxIndex+c+1.5:r>t.range[1]?n=t.maxIndex+u+1.5:(n=(r+t.shift)*t.scale,n=n<t.maxIndex?n:t.maxIndex),Math.floor(n)},e.linearLookup=(t,n,r)=>{let o=0;o=(0,i.i)(t)?Math.floor(r.maxIndex+1.5+d):e.linearIndexLookup(t,r);const a=4*o;return n.slice(a,a+4)},e.indexedLookupFunction=(n,r,i)=>{let o=e.getAnnotatedValueIndexInternal(n);-1===o&&(o=t.numberOfColors+d);const a=4*o;return[r[a],r[a+1],r[a+2],r[a+3]]},e.lookupShiftAndScale=(e,t)=>{t.shift=-e[0],t.scale=Number.MAX_VALUE,e[1]>e[0]&&(t.scale=(t.maxIndex+1)/(e[1]-e[0]))},e.mapScalarsThroughTable=(n,r,i,o)=>{let s=e.linearLookup;t.indexedLookup&&(s=e.indexedLookupFunction);const l=e.getMappingRange(),c={maxIndex:e.getNumberOfColors()-1,range:l,shift:0,scale:0};e.lookupShiftAndScale(l,c);const u=e.getAlpha(),d=n.getNumberOfTuples(),p=n.getNumberOfComponents(),f=r.getData(),h=n.getData();if(u>=1){if(i===a.y0.RGBA)for(let e=0;e<d;e++){const n=s(h[e*p+o],t.table,c);f[4*e]=n[0],f[4*e+1]=n[1],f[4*e+2]=n[2],f[4*e+3]=n[3]}}else if(i===a.y0.RGBA)for(let e=0;e<d;e++){const n=s(h[e*p+o],t.table,c);f[4*e]=n[0],f[4*e+1]=n[1],f[4*e+2]=n[2],f[4*e+3]=Math.floor(n[3]*u+.5)}},e.forceBuild=()=>{let n=0,r=0,o=0,a=0;const s=t.numberOfColors-1;s&&(n=(t.hueRange[1]-t.hueRange[0])/s,r=(t.saturationRange[1]-t.saturationRange[0])/s,o=(t.valueRange[1]-t.valueRange[0])/s,a=(t.alphaRange[1]-t.alphaRange[0])/s),t.table.length=4*s+16;const l=[],c=[];for(let e=0;e<=s;e++)l[0]=t.hueRange[0]+e*n,l[1]=t.saturationRange[0]+e*r,l[2]=t.valueRange[0]+e*o,(0,i.h)(l,c),c[3]=t.alphaRange[0]+e*a,t.table[4*e]=255*c[0]+.5,t.table[4*e+1]=255*c[1]+.5,t.table[4*e+2]=255*c[2]+.5,t.table[4*e+3]=255*c[3]+.5;e.buildSpecialColors(),t.buildTime.modified()},e.setTable=n=>{if(Array.isArray(n)){const r=n[0].length;t.numberOfColors=n.length;const i=4-r;let o=0;for(let e=0;e<t.numberOfColors;e++)t.table[4*e]=255,t.table[4*e+1]=255,t.table[4*e+2]=255,t.table[4*e+3]=255;for(let e=0;e<n.length;e++){const a=n[e];for(let e=0;e<r;e++)t.table[o++]=a[e];o+=i}return e.buildSpecialColors(),t.insertTime.modified(),e.modified(),!0}if(4!==n.getNumberOfComponents())return l("Expected 4 components for RGBA colors"),!1;if(n.getDataType()!==s.JA.UNSIGNED_CHAR)return l("Expected unsigned char values for RGBA colors"),!1;t.numberOfColors=n.getNumberOfTuples();const r=n.getData();t.table.length=r.length;for(let e=0;e<r.length;e++)t.table[e]=r[e];return e.buildSpecialColors(),t.insertTime.modified(),e.modified(),!0},e.buildSpecialColors=()=>{const{numberOfColors:e}=t,n=t.table;let r=4*(e+c);t.useBelowRangeColor||0===e?(n[r]=255*t.belowRangeColor[0]+.5,n[r+1]=255*t.belowRangeColor[1]+.5,n[r+2]=255*t.belowRangeColor[2]+.5,n[r+3]=255*t.belowRangeColor[3]+.5):(n[r]=n[0],n[r+1]=n[1],n[r+2]=n[2],n[r+3]=n[3]),r=4*(e+u),t.useAboveRangeColor||0===e?(n[r]=255*t.aboveRangeColor[0]+.5,n[r+1]=255*t.aboveRangeColor[1]+.5,n[r+2]=255*t.aboveRangeColor[2]+.5,n[r+3]=255*t.aboveRangeColor[3]+.5):(n[r]=n[4*(e-1)+0],n[r+1]=n[4*(e-1)+1],n[r+2]=n[4*(e-1)+2],n[r+3]=n[4*(e-1)+3]),r=4*(e+d),n[r]=255*t.nanColor[0]+.5,n[r+1]=255*t.nanColor[1]+.5,n[r+2]=255*t.nanColor[2]+.5,n[r+3]=255*t.nanColor[3]+.5},e.build=()=>{(t.table.length<1||e.getMTime()>t.buildTime.getMTime()&&t.insertTime.getMTime()<=t.buildTime.getMTime())&&e.forceBuild()},t.table.length>0&&(e.buildSpecialColors(),t.insertTime.modified())}(e,t)}var h={newInstance:r.m.newInstance(f,"vtkLookupTable"),extend:f}},84607:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>r.f});n(56037),n(28906),n(35341);var r=n(16632)},35341:(e,t,n)=>{"use strict";n.d(t,{GY:()=>i,kP:()=>a,p8:()=>o,zK:()=>r});const r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=[1,0,0,0,1,0,0,0,1],o=1e-6,a=1e-12},16632:(e,t,n)=>{"use strict";n.d(t,{A:()=>y,E:()=>Je,H:()=>pt,K:()=>x,L:()=>lt,M:()=>Ue,N:()=>Ke,O:()=>qe,P:()=>b,Q:()=>oe,R:()=>D,S:()=>ue,T:()=>ht,U:()=>Xe,V:()=>O,a:()=>ve,b:()=>Se,c:()=>Ze,d:()=>j,e:()=>Q,f:()=>bt,g:()=>Ne,h:()=>Ge,i:()=>dt,j:()=>K,k:()=>V,l:()=>$,m:()=>z,n:()=>q,o:()=>ae,r:()=>v,s:()=>k,u:()=>$e});var r=n(56037),i=n.n(r),o=n(28906),a=n(35341);const{vtkErrorMacro:s,vtkWarningMacro:l}=o.m;let c=0;const u=20;function d(e){return()=>s(`vtkMath::${e} - NOT IMPLEMENTED`)}function p(e,t,n,r){let i;for(let o=0;o<t;o++)i=e[n*t+o],e[n*t+o]=e[r*t+o],e[r*t+o]=i}function f(e,t,n,r){let i;for(let o=0;o<t;o++)i=e[o*t+n],e[o*t+n]=e[o*t+r],e[o*t+r]=i}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;const t=Array(e);for(let n=0;n<e;++n)t[n]=0;return t}const m=()=>Math.PI;function g(e,t){return t>1023?e*2**1023*2**(t-1023):t<-1074?5e-324*e*2**(t+1074):e*2**t}function v(e){return e/180*Math.PI}function y(e){return 180*e/Math.PI}const{round:b,floor:x,ceil:A,min:C,max:T}=Math;function S(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=1/0;for(let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.length;r<i;r+=t)e[r]<n&&(n=e[r]);return n}function w(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=-1/0;for(let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.length;r<i;r+=t)n<e[r]&&(n=e[r]);return n}function _(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=1/0,r=-1/0;for(let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e.length;i<o;i+=t)e[i]<n&&(n=e[i]),r<e[i]&&(r=e[i]);return[n,r]}const I=d("ceilLog2"),E=d("factorial");function D(e){let t=1;for(;t<e;)t*=2;return t}function O(e){return e===D(e)}function P(e,t){let n=1;for(let r=1;r<=t;++r)n*=(e-r+1)/r;return Math.floor(n)}function R(e,t){if(e<t)return 0;const n=h(t);for(let e=0;e<t;++e)n[e]=e;return n}function N(e,t,n){let r=0;for(let i=t-1;i>=0;--i)if(n[i]<e-t+i){let e=n[i]+1;for(;i<t;)n[i++]=e++;r=1;break}return r}function M(e){i()(`${e}`,{global:!0}),c=e}function L(){return c}function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e+((arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)-e)*Math.random()}const B=d("gaussian");function V(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function k(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function U(e,t){return e[0]*=t,e[1]*=t,e[2]*=t,e}function G(e,t){return e[0]*=t,e[1]*=t,e}function z(e,t,n,r){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r}function W(e,t,n,r){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r}function j(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function H(e,t,n){n[0]=e[0]*t[0],n[1]=e[0]*t[1],n[2]=e[0]*t[2],n[3]=e[1]*t[0],n[4]=e[1]*t[1],n[5]=e[1]*t[2],n[6]=e[2]*t[0],n[7]=e[2]*t[1],n[8]=e[2]*t[2]}function K(e,t,n){const r=e[1]*t[2]-e[2]*t[1],i=e[2]*t[0]-e[0]*t[2],o=e[0]*t[1]-e[1]*t[0];return n[0]=r,n[1]=i,n[2]=o,n}function q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;switch(t){case 1:return Math.abs(e);case 2:return Math.sqrt(e[0]*e[0]+e[1]*e[1]);case 3:return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);default:{let n=0;for(let r=0;r<t;r++)n+=e[r]*e[r];return Math.sqrt(n)}}}function $(e){const t=q(e);return 0!==t&&(e[0]/=t,e[1]/=t,e[2]/=t),t}function X(e,t,n,r){const i=e[0]*e[0],o=e[1]*e[1],a=e[2]*e[2],s=Math.sqrt(i+o+a);let l,c,u;i>o&&i>a?(l=0,c=1,u=2):o>a?(l=1,c=2,u=0):(l=2,c=0,u=1);const d=e[l]/s,p=e[c]/s,f=e[u]/s,h=Math.sqrt(d*d+f*f);if(0!==r){const e=Math.sin(r),i=Math.cos(r);t&&(t[l]=(f*i-d*p*e)/h,t[c]=e*h,t[u]=(-d*i-p*f*e)/h),n&&(n[l]=(-f*e-d*p*i)/h,n[c]=i*h,n[u]=(d*e-p*f*i)/h)}else t&&(t[l]=f/h,t[c]=0,t[u]=-d/h),n&&(n[l]=-d*p/h,n[c]=h,n[u]=-p*f/h)}function Y(e,t,n){const r=j(t,t);if(0===r)return n[0]=0,n[1]=0,n[2]=0,!1;const i=j(e,t)/r;for(let e=0;e<3;e++)n[e]=t[e];return U(n,i),!0}function J(e,t){return e[0]*t[0]+e[1]*t[1]}function Z(e,t,n){const r=J(t,t);if(0===r)return n[0]=0,n[1]=0,!1;const i=J(e,t)/r;for(let e=0;e<2;e++)n[e]=t[e];return G(n,i),!0}function Q(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])+(e[2]-t[2])*(e[2]-t[2])}function ee(e,t){const n=[0,0,0];return K(e,t,n),Math.atan2(q(n),j(e,t))}function te(e,t,n){const r=Math.abs(e-n);return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-(r**2)/(2*t))}function ne(e,t,n){const r=Math.abs(e-n);return Math.exp(-(r**2)/(2*t))}function re(e,t,n){n[0]=e[0]*t[0],n[1]=e[0]*t[1],n[2]=e[1]*t[0],n[3]=e[1]*t[1]}function ie(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function oe(e){const t=ie(e);return 0!==t&&(e[0]/=t,e[1]/=t),t}function ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 2===t.length?t[0][0]*t[1][1]-t[1][0]*t[0][1]:4===t.length?t[0]*t[3]-t[1]*t[2]:Number.NaN}function se(e,t){let n,r,i;const o=[0,0,0];for(let t=0;t<3;t++)i=Math.abs(e[3*t]),(r=Math.abs(e[3*t+1]))>i&&(i=r),(r=Math.abs(e[3*t+2]))>i&&(i=r),o[t]=1/i;i=o[0]*Math.abs(e[0]),n=0,(r=o[1]*Math.abs(e[3]))>=i&&(i=r,n=1),(r=o[2]*Math.abs(e[6]))>=i&&(n=2),0!==n&&(p(e,3,n,0),o[n]=o[0]),t[0]=n,e[3]/=e[0],e[6]/=e[0],e[4]-=e[3]*e[1],e[7]-=e[6]*e[1],i=o[1]*Math.abs(e[4]),n=1,(r=o[2]*Math.abs(e[7]))>=i&&(n=2,p(e,3,1,2),o[2]=o[1]),t[1]=n,e[7]/=e[4],e[5]-=e[3]*e[2],e[8]-=e[6]*e[2]+e[7]*e[5],t[2]=2}function le(e,t,n){let r=n[t[0]];n[t[0]]=n[0],n[0]=r,r=n[t[1]],n[t[1]]=n[1],n[1]=r-e[3]*n[0],r=n[t[2]],n[t[2]]=n[2],n[2]=r-e[6]*n[0]-e[7]*n[1],n[2]/=e[8],n[1]=(n[1]-e[5]*n[2])/e[4],n[0]=(n[0]-e[1]*n[1]-e[2]*n[2])/e[0]}function ce(e,t,n){const r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],d=e[8],p=+ae(s,u,l,d),f=-ae(a,c,l,d),h=+ae(a,c,s,u),m=-ae(i,u,o,d),g=+ae(r,c,o,d),v=-ae(r,c,i,u),y=+ae(i,s,o,l),b=-ae(r,a,o,l),x=+ae(r,a,i,s),A=r*p+i*f+o*h,C=p*t[0]+m*t[1]+y*t[2],T=f*t[0]+g*t[1]+b*t[2],S=h*t[0]+v*t[1]+x*t[2];n[0]=C/A,n[1]=T/A,n[2]=S/A}function ue(e,t,n){const r=e[0]*t[0]+e[1]*t[1]+e[2]*t[2],i=e[3]*t[0]+e[4]*t[1]+e[5]*t[2],o=e[6]*t[0]+e[7]*t[1]+e[8]*t[2];n[0]=r,n[1]=i,n[2]=o}function de(e,t,n){const r=[...e],i=[...t];for(let e=0;e<3;e++)n[e]=r[0]*i[e]+r[1]*i[e+3]+r[2]*i[e+6],n[e+3]=r[3]*i[e]+r[4]*i[e+3]+r[5]*i[e+6],n[e+6]=r[6]*i[e]+r[7]*i[e+3]+r[8]*i[e+6]}function pe(e,t,n,r,i,o,a){r!==i&&s("Number of columns of A must match number of rows of B.");const l=[...e],c=[...t];for(let e=0;e<n;e++)for(let t=0;t<o;t++){a[e*o+t]=0;for(let n=0;n<r;n++)a[e*o+t]+=l[e*r+n]*c[t+o*n]}}function fe(e,t){let n;n=e[3],t[3]=e[1],t[1]=n,n=e[6],t[6]=e[2],t[2]=n,n=e[7],t[7]=e[5],t[5]=n,t[0]=e[0],t[4]=e[4],t[8]=e[8]}function he(e,t){const n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],c=e[6],u=e[7],d=e[8],p=+ae(a,u,s,d),f=-ae(o,c,s,d),h=+ae(o,c,a,u),m=-ae(r,u,i,d),g=+ae(n,c,i,d),v=-ae(n,c,r,u),y=+ae(r,a,i,s),b=-ae(n,o,i,s),x=+ae(n,o,r,a),A=n*p+r*f+i*h;0===A&&l("Matrix has 0 determinant"),t[0]=p/A,t[3]=f/A,t[6]=h/A,t[1]=m/A,t[4]=g/A,t[7]=v/A,t[2]=y/A,t[5]=b/A,t[8]=x/A}function me(e){return e[0]*e[4]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]-e[6]*e[4]*e[2]}function ge(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.p8;if(e.length!==t.length)return!1;return e.every((function(e,r){return Math.abs(e-t[r])<=n}))}const ve=ge;function ye(e){for(let t=0;t<3;t++)e[3*t]=e[3*t+1]=e[3*t+2]=0,e[3*t+t]=1}function be(e,t){for(let n=0;n<e;n++){for(let r=0;r<e;r++)t[n*e+r]=0;t[n*e+n]=1}return t}function xe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.p8;return ve(e,a.zK,t)}function Ae(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.p8;return ve(e,a.GY,t)}function Ce(e,t){const n=e[0]*e[0],r=e[0]*e[1],i=e[0]*e[2],o=e[0]*e[3],a=e[1]*e[1],s=e[2]*e[2],l=e[3]*e[3],c=e[1]*e[2],u=e[1]*e[3],d=e[2]*e[3],p=a+s+l;let f=1/(n+p);const h=(n-p)*f;f*=2,t[0]=a*f+h,t[3]=(c+o)*f,t[6]=(u-i)*f,t[1]=(c-o)*f,t[4]=s*f+h,t[7]=(d+r)*f,t[2]=(u+i)*f,t[5]=(d-r)*f,t[8]=l*f+h}function Te(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!`${e}`.includes("e"))return+`${Math.round(`${e}e+${t}`)}e-${t}`;const n=`${e}`.split("e");let r="";return+n[1]+t>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+t}`)}e-${t}`}function Se(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t[0]=Te(e[0],n),t[1]=Te(e[1],n),t[2]=Te(e[2],n),t}function we(e,t,n,r){let i,o,s,c,d,p,m,g,v,y,b,x,A,C,T,S;const w=h(t),_=h(t),I=(e,t,n)=>{C=e[t],A=e[n],e[t]=C-x*(A+C*y),e[n]=A+x*(C-A*y)};for(be(t,r),d=0;d<t;d++)w[d]=n[d]=e[d+d*t],_[d]=0;for(i=0;i<u;i++){for(b=0,d=0;d<t-1;d++)for(c=d+1;c<t;c++)b+=Math.abs(e[d*t+c]);if(0===b)break;for(m=i<3?.2*b/(t*t):0,d=0;d<t-1;d++)for(c=d+1;c<t;c++)if(C=100*Math.abs(e[d*t+c]),i>3&&Math.abs(n[d])+C===Math.abs(n[d])&&Math.abs(n[c])+C===Math.abs(n[c]))e[d*t+c]=0;else if(Math.abs(e[d*t+c])>m){for(A=n[c]-n[d],Math.abs(A)+C===Math.abs(A)?v=e[d*t+c]/A:(g=.5*A/e[d*t+c],v=1/(Math.abs(g)+Math.sqrt(1+g*g)),g<0&&(v=-v)),T=1/Math.sqrt(1+v*v),x=v*T,y=x/(1+T),A=v*e[d*t+c],_[d]-=A,_[c]+=A,n[d]-=A,n[c]+=A,e[d*t+c]=0,o=0;o<=d-1;o++)I(e,o*t+d,o*t+c);for(o=d+1;o<=c-1;o++)I(e,d*t+o,o*t+c);for(o=c+1;o<t;o++)I(e,d*t+o,c*t+o);for(o=0;o<t;o++)I(r,o*t+d,o*t+c)}for(d=0;d<t;d++)w[d]+=_[d],n[d]=w[d],_[d]=0}if(i>=u)return l("vtkMath::Jacobi: Error extracting eigenfunctions"),0;for(o=0;o<t-1;o++){for(s=o,S=n[s],i=o+1;i<t;i++)(n[i]>=S||Math.abs(n[i]-S)<a.kP)&&(s=i,S=n[s]);s!==o&&(n[s]=n[o],n[o]=S,f(r,t,o,s))}const E=(t>>1)+(1&t);for(p=0,i=0;i<t*t;i++)r[i]>=0&&p++;if(p<E)for(i=0;i<t;i++)r[i*t+o]*=-1;return 1}function _e(e,t){const n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];n[0]=e[0]+e[4]+e[8],n[5]=e[0]-e[4]-e[8],n[10]=-e[0]+e[4]-e[8],n[15]=-e[0]-e[4]+e[8],n[1]=n[4]=e[7]-e[5],n[2]=n[8]=e[2]-e[6],n[3]=n[12]=e[3]-e[1],n[6]=n[9]=e[3]+e[1],n[7]=n[13]=e[2]+e[6],n[11]=n[14]=e[7]+e[5];const r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];we([...n],4,[0,0,0,0],r),t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12]}function Ie(e,t,n){const r=e[0]*t[0],i=e[0]*t[1],o=e[0]*t[2],a=e[0]*t[3],s=e[1]*t[0],l=e[1]*t[1],c=e[1]*t[2],u=e[1]*t[3],d=e[2]*t[0],p=e[2]*t[1],f=e[2]*t[2],h=e[2]*t[3],m=e[3]*t[0],g=e[3]*t[1],v=e[3]*t[2],y=e[3]*t[3];n[0]=r-l-f-y,n[1]=i+s+h-v,n[2]=o-u+d+g,n[3]=a+c-p+m}function Ee(e,t){for(let n=0;n<9;n++)t[n]=e[n];const n=h(3),r=h(3);let i;for(let e=0;e<3;e++){const r=Math.abs(t[3*e]),o=Math.abs(t[3*e+1]),a=Math.abs(t[3*e+2]);i=o>r?o:r,i=a>i?a:i,n[e]=1,0!==i&&(n[e]/=i)}const o=Math.abs(t[0])*n[0],a=Math.abs(t[3])*n[1],s=Math.abs(t[6])*n[2];r[0]=0,i=o,a>=i&&(i=a,r[0]=1),s>=i&&(r[0]=2),0!==r[0]&&(f(t,3,r[0],0),n[r[0]]=n[0]);const l=Math.abs(t[4])*n[1],c=Math.abs(t[7])*n[2];r[1]=1,i=l,c>=i&&(r[1]=2,f(t,3,1,2)),r[2]=2;let u=0;if(me(t)<0){u=1;for(let e=0;e<9;e++)t[e]=-t[e]}const d=h(4);if(_e(t,d),Ce(d,t),u)for(let e=0;e<9;e++)t[e]=-t[e];1!==r[1]&&f(t,3,r[1],1),0!==r[0]&&f(t,3,r[0],0)}function De(e,t,n){let r,i,o,a,s,l;if(we([...e],3,t,n),t[0]!==t[1]||t[0]!==t[2]){for(fe(n,n),r=0;r<3;r++)if(t[(r+1)%3]===t[(r+2)%3]){for(l=Math.abs(n[3*r]),a=0,i=1;i<3;i++)l<(s=Math.abs(n[3*r+i]))&&(l=s,a=i);a!==r&&(s=t[a],t[a]=t[r],t[r]=s,p(n,3,r,a)),n[3*a+a]<0&&(n[3*a]=-n[3*a],n[3*a+1]=-n[3*a+1],n[3*a+2]=-n[3*a+2]),i=(a+1)%3,o=(a+2)%3,n[3*i]=0,n[3*i+1]=0,n[3*i+2]=0,n[3*i+i]=1;const e=K([n[3*a],n[3*a+1],n[3*a+2]],[n[3*i],n[3*i+1],n[3*i+2]],[]);$(e);const c=K(e,[n[3*a],n[3*a+1],n[3*a+2]],[]);for(let t=0;t<3;t++)n[3*o+t]=e[t],n[3*i+t]=c[t];return void fe(n,n)}for(l=Math.abs(n[0]),a=0,r=1;r<3;r++)l<(s=Math.abs(n[3*r]))&&(l=s,a=r);if(0!==a){const e=t[a];t[a]=t[0],t[0]=e,p(n,3,a,0)}if(Math.abs(n[4])<Math.abs(n[7])){const e=t[2];t[2]=t[1],t[1]=e,p(n,3,1,2)}for(r=0;r<2;r++)n[3*r+r]<0&&(n[3*r]=-n[3*r],n[3*r+1]=-n[3*r+1],n[3*r+2]=-n[3*r+2]);me(n)<0&&(n[6]=-n[6],n[7]=-n[7],n[8]=-n[8]),fe(n,n)}else ye(n)}function Oe(e,t,n,r){let i;const o=[...e],a=me(o);if(a<0)for(i=0;i<9;i++)o[i]=-o[i];Ee(o,t),fe(o,o),de(o,t,r),De(r,n,r),de(t,r,t),fe(r,r),a<0&&(n[0]=-n[0],n[1]=-n[1],n[2]=-n[2])}function Pe(e,t,n){let r,i,o,s,c,u,d,p=0;const f=h(n);for(r=0;r<n;r++){for(s=0,i=0;i<n;i++)(d=Math.abs(e[r*n+i]))>s&&(s=d);if(0===s)return l("Unable to factor linear system"),0;f[r]=1/s}for(i=0;i<n;i++){for(r=0;r<i;r++){for(c=e[r*n+i],o=0;o<r;o++)c-=e[r*n+o]*e[o*n+i];e[r*n+i]=c}for(s=0,r=i;r<n;r++){for(c=e[r*n+i],o=0;o<i;o++)c-=e[r*n+o]*e[o*n+i];e[r*n+i]=c,(u=f[r]*Math.abs(c))>=s&&(s=u,p=r)}if(i!==p){for(o=0;o<n;o++)u=e[p*n+o],e[p*n+o]=e[i*n+o],e[i*n+o]=u;f[p]=f[i]}if(t[i]=p,Math.abs(e[i*n+i])<=a.kP)return l("Unable to factor linear system"),0;if(i!==n-1)for(u=1/e[i*n+i],r=i+1;r<n;r++)e[r*n+i]*=u}return 1}function Re(e,t,n,r){let i,o,a,s,l;for(a=-1,i=0;i<r;i++){if(s=t[i],l=n[s],n[s]=n[i],a>=0)for(o=a;o<=i-1;o++)l-=e[i*r+o]*n[o];else 0!==l&&(a=i);n[i]=l}for(i=r-1;i>=0;i--){for(l=n[i],o=i+1;o<r;o++)l-=e[i*r+o]*n[o];n[i]=l/e[i*r+i]}}function Ne(e,t,n){if(2===n){const n=h(2),r=ae(e[0],e[1],e[2],e[3]);return 0===r?0:(n[0]=(e[3]*t[0]-e[1]*t[1])/r,n[1]=(-e[2]*t[0]+e[0]*t[1])/r,t[0]=n[0],t[1]=n[1],1)}if(1===n)return 0===e[0]?0:(t[0]/=e[0],1);const r=h(n);return 0===Pe(e,r,n)?0:(Re(e,r,t,n),1)}function Me(e,t,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const i=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)||h(n),o=r||h(n);if(0===Pe(e,i,n))return null;for(let r=0;r<n;r++){for(let e=0;e<n;e++)o[e]=0;o[r]=1,Re(e,i,o,n);for(let e=0;e<n;e++)t[e*n+r]=o[e]}return t}function Le(e,t){let n=+Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let n=0;n<t;n++)for(let i=n;i<t;i++)Math.abs(e[n*t+i])>r&&(r=Math.abs(e[n*t+i]));for(let r=0;r<t;r++)Math.abs(e[r*t+r])<n&&(n=Math.abs(e[r*t+r]));return 0===n?Number.MAX_VALUE:r/n}function Fe(e,t,n){return we(e,3,t,n)}function Be(e,t,n,r){if(e<n)return l("Insufficient number of samples. Underdetermined."),0;let i,o,a;const s=h(n*n),c=h(n),u=h(n*n);for(a=0;a<e;a++)for(i=0;i<n;i++)for(o=i;o<n;o++)s[i*n+o]+=t[a*n+i]*t[a*n+o];for(i=0;i<n;i++)for(o=0;o<i;o++)s[i*n+o]=s[o*n+i];for(we(s,n,c,u),i=0;i<n;i++)r[i]=u[i*n+n-1];return 1}function Ve(e,t,n,r,i,o){let s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(e<n||e<i)return l("Insufficient number of samples. Underdetermined."),0;const c=h(i);let u,d,p,f,m=1,g=0,v=0;if(s){for(p=0;p<i;p++)c[p]=1;for(d=0;d<e;d++)for(p=0;p<i;p++)Math.abs(r[d*i+p])>a.kP&&(m=0,c[p]=0);if(m&&1===i)return l("Detected homogeneous system (Y=0), calling SolveHomogeneousLeastSquares()"),Be(e,t,n,o);if(m)v=1;else for(p=0;p<i;p++)c[p]&&(v=1)}v&&(u=h(n),g=Be(e,t,n,u));const y=h(n*n),b=h(n*n),x=h(n*i);for(f=0;f<e;f++)for(d=0;d<n;d++){for(p=d;p<n;p++)y[d*n+p]+=t[f*n+d]*t[f*n+p];for(p=0;p<i;p++)x[d*i+p]+=t[f*n+d]*r[f*i+p]}for(d=0;d<n;d++)for(p=0;p<d;p++)y[d*n+p]=y[p*n+d];const A=Me(y,b,n);if(A)for(d=0;d<n;d++)for(p=0;p<i;p++)for(o[d*i+p]=0,f=0;f<n;f++)o[d*i+p]+=b[d*n+f]*x[f*i+p];if(v)for(p=0;p<i;p++)if(c[p])for(d=0;d<n;d++)o[d*i+p]=u[d*i];return v?g&&A:A}function ke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,.5,1];switch(e.length){case 3:return t[0]=17*parseInt(e[0],16)/255,t[1]=17*parseInt(e[1],16)/255,t[2]=17*parseInt(e[2],16)/255,t;case 4:return t[0]=17*parseInt(e[1],16)/255,t[1]=17*parseInt(e[2],16)/255,t[2]=17*parseInt(e[3],16)/255,t;case 6:return t[0]=parseInt(e.substr(0,2),16)/255,t[1]=parseInt(e.substr(2,2),16)/255,t[2]=parseInt(e.substr(4,2),16)/255,t;case 7:return t[0]=parseInt(e.substr(1,2),16)/255,t[1]=parseInt(e.substr(3,2),16)/255,t[2]=parseInt(e.substr(5,2),16)/255,t;case 9:return t[0]=parseInt(e.substr(1,2),16)/255,t[1]=parseInt(e.substr(3,2),16)/255,t[2]=parseInt(e.substr(5,2),16)/255,t[3]=parseInt(e.substr(7,2),16)/255,t;default:return t}}function Ue(e,t){let n,r;const[i,o,a]=e,s=1/6;let l=i,c=i;o>l?l=o:o<c&&(c=o),a>l?l=a:a<c&&(c=a);const u=l;r=u>0?(l-c)/l:0,r>0?(n=i===l?s*(o-a)/(l-c):o===l?1/3+s*(a-i)/(l-c):2/3+s*(i-o)/(l-c),n<0&&(n+=1)):n=0,t[0]=n,t[1]=r,t[2]=u}function Ge(e,t){const[n,r,i]=e,o=1/3,a=1/6,s=2/3,l=5/6;let c,u,d;n>a&&n<=o?(u=1,c=(o-n)/a,d=0):n>o&&n<=.5?(u=1,d=(n-o)/a,c=0):n>.5&&n<=s?(d=1,u=(s-n)/a,c=0):n>s&&n<=l?(d=1,c=(n-s)/a,u=0):n>l&&n<=1?(c=1,d=(1-n)/a,u=0):(c=1,u=n/a,d=0),c=r*c+(1-r),u=r*u+(1-r),d=r*d+(1-r),c*=i,u*=i,d*=i,t[0]=c,t[1]=u,t[2]=d}function ze(e,t){const[n,r,i]=e;let o=(n+16)/116,a=r/500+o,s=o-i/200;o**3>.008856?o**=3:o=(o-16/116)/7.787,a**3>.008856?a**=3:a=(a-16/116)/7.787,s**3>.008856?s**=3:s=(s-16/116)/7.787;t[0]=.9505*a,t[1]=1*o,t[2]=1.089*s}function We(e,t){const[n,r,i]=e;let o=n/.9505,a=r/1,s=i/1.089;o>.008856?o**=1/3:o=7.787*o+16/116,a>.008856?a**=1/3:a=7.787*a+16/116,s>.008856?s**=1/3:s=7.787*s+16/116,t[0]=116*a-16,t[1]=500*(o-a),t[2]=200*(a-s)}function je(e,t){const[n,r,i]=e;let o=3.2406*n+-1.5372*r+-.4986*i,a=-.9689*n+1.8758*r+.0415*i,s=.0557*n+-.204*r+1.057*i;o>.0031308?o=1.055*o**(1/2.4)-.055:o*=12.92,a>.0031308?a=1.055*a**(1/2.4)-.055:a*=12.92,s>.0031308?s=1.055*s**(1/2.4)-.055:s*=12.92;let l=o;l<a&&(l=a),l<s&&(l=s),l>1&&(o/=l,a/=l,s/=l),o<0&&(o=0),a<0&&(a=0),s<0&&(s=0),t[0]=o,t[1]=a,t[2]=s}function He(e,t){let[n,r,i]=e;n>.04045?n=((n+.055)/1.055)**2.4:n/=12.92,r>.04045?r=((r+.055)/1.055)**2.4:r/=12.92,i>.04045?i=((i+.055)/1.055)**2.4:i/=12.92,t[0]=.4124*n+.3576*r+.1805*i,t[1]=.2126*n+.7152*r+.0722*i,t[2]=.0193*n+.1192*r+.9505*i}function Ke(e,t){const n=[0,0,0];He(e,n),We(n,t)}function qe(e,t){const n=[0,0,0];ze(e,n),je(n,t)}function $e(e){return e[0]=1,e[1]=-1,e[2]=1,e[3]=-1,e[4]=1,e[5]=-1,e}function Xe(e){return!(e[1]-e[0]<0)}function Ye(e,t,n){return n[0]=Math.min(e[0],t[0]),n[1]=Math.max(e[0],t[0]),n[2]=Math.min(e[1],t[1]),n[3]=Math.max(e[1],t[1]),n[4]=Math.min(e[2],t[2]),n[5]=Math.max(e[2],t[2]),n}function Je(e,t,n){return e<t?t:e>n?n:e}function Ze(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0];return r[0]=Je(e[0],t[0],n[0]),r[1]=Je(e[1],t[1],n[1]),r[2]=Je(e[2],t[2],n[2]),r}function Qe(e,t){let n=0;return t[0]!==t[1]&&(n=e<t[0]?t[0]:e>t[1]?t[1]:e,n=(n-t[0])/(t[1]-t[0])),n}const et=d("GetScalarTypeFittingRange"),tt=d("GetAdjustedScalarRange");function nt(e,t){if(!e||!t)return 0;for(let n=0;n<6;n+=2)if(e[n]<t[n]||e[n]>t[n+1]||e[n+1]<t[n]||e[n+1]>t[n+1])return 0;return 1}function rt(e,t,n){if(!e||!t)return 0;for(let r=0;r<6;r+=2)if(e[r]+n[r/2]<t[r]||e[r]-n[r/2]>t[r+1]||e[r+1]+n[r/2]<t[r]||e[r+1]-n[r/2]>t[r+1])return 0;return 1}function it(e,t,n){if(!e||!t||!n)return 0;for(let r=0;r<3;r++)if(e[r]+n[r]<t[2*r]||e[r]-n[r]>t[2*r+1])return 0;return 1}function ot(e,t,n,r){const i=h(3),o=h(3),a=h(3),s=h(3),l=h(3),c=h(3);for(let r=0;r<3;++r)i[r]=e[r]-t[r],o[r]=t[r]-n[r],a[r]=n[r]-e[r],s[r]=-i[r],l[r]=-o[r],c[r]=-a[r];const u=q(s),d=q(l),p=q(a),f=h(3);K(i,o,f);const m=q(f),g=u*d*p/(2*m),v=2*m*m,y=d*d*j(i,c)/v,b=p*p*j(s,o)/v,x=u*u*j(a,l)/v;for(let i=0;i<3;++i)r[i]=y*e[i]+b*t[i]+x*n[i];return g}const at=1/0,st=-1/0,lt=e=>!Number.isFinite(e),{isFinite:ct,isNaN:ut}=Number,dt=ut;function pt(){return[].concat([Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE])}function ft(e){let t=-1,n=-1;for(let r=0;r<e.length;r++){const i=Math.abs(e[r]);i>t&&(n=r,t=i)}return n}function ht(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;const n=new Array(t),r=new Array(t);for(let e=0;e<t;++e)n[e]=e,r[e]=e;for(let i=t-1;i>0;i--){let o=-1/0,a=0,s=0;for(let l=0;l<=i;++l){const c=n[l];for(let n=0;n<=i;++n){const i=r[n],u=Math.abs(e[c+t*i]);u>o&&(o=u,a=l,s=n)}}[n[i],n[a]]=[n[a],n[i]],[r[i],r[s]]=[r[s],r[i]]}const i=new Array(t*t).fill(0);for(let o=0;o<t;++o){const a=n[o]+t*r[o];i[a]=e[a]<0?-1:1}return i}function mt(e){const t=Math.floor(255*e);return t>15?t.toString(16):`0${t.toString(16)}`}function gt(e){return`${arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#"}${e.map(mt).join("")}`}function vt(e){return Math.round(255*e)}function yt(e){return 3===e.length?`rgb(${e.map(vt).join(", ")})`:`rgba(${vt(e[0]||0)}, ${vt(e[1]||0)}, ${vt(e[2]||0)}, ${e[3]||0})`}var bt={Pi:m,ldexp:g,radiansFromDegrees:v,degreesFromRadians:y,round:b,floor:x,ceil:A,ceilLog2:I,min:C,max:T,arrayMin:S,arrayMax:w,arrayRange:_,isPowerOfTwo:O,nearestPowerOfTwo:D,factorial:E,binomial:P,beginCombination:R,nextCombination:N,randomSeed:M,getSeed:L,random:F,gaussian:B,add:V,subtract:k,multiplyScalar:U,multiplyScalar2D:G,multiplyAccumulate:z,multiplyAccumulate2D:W,dot:j,outer:H,cross:K,norm:q,normalize:$,perpendiculars:X,projectVector:Y,projectVector2D:Z,distance2BetweenPoints:Q,angleBetweenVectors:ee,gaussianAmplitude:te,gaussianWeight:ne,dot2D:J,outer2D:re,norm2D:ie,normalize2D:oe,determinant2x2:ae,LUFactor3x3:se,LUSolve3x3:le,linearSolve3x3:ce,multiply3x3_vect3:ue,multiply3x3_mat3:de,multiplyMatrix:pe,transpose3x3:fe,invert3x3:he,identity3x3:ye,identity:be,isIdentity:xe,isIdentity3x3:Ae,determinant3x3:me,quaternionToMatrix3x3:Ce,areEquals:ge,areMatricesEqual:ve,roundNumber:Te,roundVector:Se,matrix3x3ToQuaternion:_e,multiplyQuaternion:Ie,orthogonalize3x3:Ee,diagonalize3x3:De,singularValueDecomposition3x3:Oe,solveLinearSystem:Ne,invertMatrix:Me,luFactorLinearSystem:Pe,luSolveLinearSystem:Re,estimateMatrixCondition:Le,jacobi:Fe,jacobiN:we,solveHomogeneousLeastSquares:Be,solveLeastSquares:Ve,hex2float:ke,rgb2hsv:Ue,hsv2rgb:Ge,lab2xyz:ze,xyz2lab:We,xyz2rgb:je,rgb2xyz:He,rgb2lab:Ke,lab2rgb:qe,uninitializeBounds:$e,areBoundsInitialized:Xe,computeBoundsFromPoints:Ye,clampValue:Je,clampVector:Ze,clampAndNormalizeValue:Qe,getScalarTypeFittingRange:et,getAdjustedScalarRange:tt,extentIsWithinOtherExtent:nt,boundsIsWithinOtherBounds:rt,pointIsWithinBounds:it,solve3PointCircle:ot,inf:at,negInf:st,isInf:lt,isNan:ut,isNaN:ut,isFinite:ct,createUninitializedBounds:pt,getMajorAxisIndex:ft,getSparseOrthogonalMatrix:ht,floatToHex2:mt,floatRGB2HexCode:gt,float2CssRGBA:yt}},89265:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(3823),i=n(16632),o=n(35341);const a=e=>e,s=1e-6;class l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.matrix=r.pB.identity(new Float64Array(16)),this.tmp=new Float64Array(3),this.angleConv=e?r.Fd.toRadian:a}rotateFromDirections(e,t){const n=new Float64Array(3),i=new Float64Array(3),o=new Float64Array(16);r.eR.set(n,e[0],e[1],e[2]),r.eR.set(i,t[0],t[1],t[2]),r.eR.normalize(n,n),r.eR.normalize(i,i);const a=r.eR.dot(n,i);return a>=1||(r.eR.cross(this.tmp,n,i),r.eR.length(this.tmp)<s&&(r.eR.cross(this.tmp,[1,0,0],e),r.eR.length(this.tmp)<s&&r.eR.cross(this.tmp,[0,1,0],e)),r.pB.fromRotation(o,Math.acos(a),this.tmp),r.pB.multiply(this.matrix,this.matrix,o)),this}rotate(e,t){return r.eR.set(this.tmp,...t),r.eR.normalize(this.tmp,this.tmp),r.pB.rotate(this.matrix,this.matrix,this.angleConv(e),this.tmp),this}rotateX(e){return r.pB.rotateX(this.matrix,this.matrix,this.angleConv(e)),this}rotateY(e){return r.pB.rotateY(this.matrix,this.matrix,this.angleConv(e)),this}rotateZ(e){return r.pB.rotateZ(this.matrix,this.matrix,this.angleConv(e)),this}translate(e,t,n){return r.eR.set(this.tmp,e,t,n),r.pB.translate(this.matrix,this.matrix,this.tmp),this}scale(e,t,n){return r.eR.set(this.tmp,e,t,n),r.pB.scale(this.matrix,this.matrix,this.tmp),this}multiply(e){return r.pB.multiply(this.matrix,this.matrix,e),this}multiply3x3(e){return r.pB.multiply(this.matrix,this.matrix,[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]),this}invert(){return r.pB.invert(this.matrix,this.matrix),this}identity(){return r.pB.identity(this.matrix),this}apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if((0,i.a)(o.zK,this.matrix))return this;const a=-1===n?e.length:t+3*n;for(let n=t;n<a;n+=3)r.eR.set(this.tmp,e[n],e[n+1],e[n+2]),r.eR.transformMat4(this.tmp,this.tmp,this.matrix),e[n]=this.tmp[0],e[n+1]=this.tmp[1],e[n+2]=this.tmp[2];return this}getMatrix(){return this.matrix}setMatrix(e){return e&&16===e.length&&r.pB.copy(this.matrix,e),this}}var c={buildFromDegree:function(){return new l(!0)},buildFromRadian:function(){return new l(!1)}}},74966:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(28906),i=n(42008),o=n(28914);const{vtkErrorMacro:a}=r.m,s=[1,-1,1,-1,1,-1];const l={empty:!0,numberOfComponents:3,dataType:o.JA.FLOAT,bounds:[1,-1,1,-1,1,-1]};function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,l,n),i.Ay.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkPoints"),e.getNumberOfPoints=e.getNumberOfTuples,e.setNumberOfPoints=function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;e.getNumberOfPoints()!==n&&(t.size=n*i,t.values=r.m.newTypedArray(t.dataType,t.size),e.setNumberOfComponents(i),e.modified())},e.setPoint=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.setTuple(t,r)},e.getPoint=e.getTuple,e.findPoint=e.findTuple,e.insertNextPoint=(t,n,r)=>e.insertNextTuple([t,n,r]),e.getBounds=()=>{if(3===e.getNumberOfComponents()){const n=e.getRange(0);t.bounds[0]=n[0],t.bounds[1]=n[1];const r=e.getRange(1);t.bounds[2]=r[0],t.bounds[3]=r[1];const i=e.getRange(2);return t.bounds[4]=i[0],t.bounds[5]=i[1],t.bounds}if(2!==e.getNumberOfComponents())return a(`getBounds called on an array with components of\n        ${e.getNumberOfComponents()}`),s;const n=e.getRange(0);t.bounds[0]=n[0],t.bounds[1]=n[1];const r=e.getRange(1);return t.bounds[2]=r[0],t.bounds[3]=r[1],t.bounds[4]=0,t.bounds[5]=0,t.bounds},e.computeBounds=e.getBounds,e.setNumberOfComponents(t.numberOfComponents<2?3:t.numberOfComponents)}(e,t)}var u={newInstance:r.m.newInstance(c,"vtkPoints"),extend:c}},80993:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>g});var r=n(28906),i=n(42008),o=n(62955),a=n(33395);const{ScalarMappingTarget:s,VectorMode:l}=o.Ay,{VtkDataTypes:c}=i.Ay,{ColorMode:u}=a.Ay,{vtkErrorMacro:d}=r.m;function p(e){return e}function f(e){return Math.floor(255*e+.5)}const h={alpha:1,vectorComponent:0,vectorSize:-1,vectorMode:l.COMPONENT,mappingRange:null,annotationArray:null,annotatedValueMap:null,indexedLookup:!1};function m(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,h,n),r.m.obj(e,t),t.mappingRange=[0,255],t.annotationArray=[],t.annotatedValueMap=[],r.m.setGet(e,t,["vectorSize","vectorComponent","vectorMode","alpha","indexedLookup"]),r.m.setArray(e,t,["mappingRange"],2),r.m.getArray(e,t,["mappingRange"]),function(e,t){t.classHierarchy.push("vtkScalarsToColors"),e.setVectorModeToMagnitude=()=>e.setVectorMode(l.MAGNITUDE),e.setVectorModeToComponent=()=>e.setVectorMode(l.COMPONENT),e.setVectorModeToRGBColors=()=>e.setVectorMode(l.RGBCOLORS),e.build=()=>{},e.isOpaque=()=>!0,e.setAnnotations=(n,r)=>{if(!(n&&!r||!n&&r))if(n&&r&&n.length!==r.length)d("Values and annotations do not have the same number of tuples so ignoring");else{if(t.annotationArray=[],r&&n){const e=r.length;for(let i=0;i<e;i++)t.annotationArray.push({value:n[i],annotation:String(r[i])})}e.updateAnnotatedValueMap(),e.modified()}},e.setAnnotation=(n,r)=>{let i=e.checkForAnnotatedValue(n),o=!1;return i>=0?t.annotationArray[i].annotation!==r&&(t.annotationArray[i].annotation=r,o=!0):(t.annotationArray.push({value:n,annotation:r}),i=t.annotationArray.length-1,o=!0),o&&(e.updateAnnotatedValueMap(),e.modified()),i},e.getNumberOfAnnotatedValues=()=>t.annotationArray.length,e.getAnnotatedValue=e=>e<0||e>=t.annotationArray.length?null:t.annotationArray[e].value,e.getAnnotation=e=>void 0===t.annotationArray[e]?null:t.annotationArray[e].annotation,e.getAnnotatedValueIndex=n=>t.annotationArray.length?e.checkForAnnotatedValue(n):-1,e.removeAnnotation=n=>{const r=e.checkForAnnotatedValue(n),i=r>=0;return i&&(t.annotationArray.splice(r,1),e.updateAnnotatedValueMap(),e.modified()),i},e.resetAnnotations=()=>{t.annotationArray=[],t.annotatedValueMap=[],e.modified()},e.getAnnotationColor=(n,r)=>{if(t.indexedLookup){const t=e.getAnnotatedValueIndex(n);e.getIndexedColor(t,r)}else e.getColor(parseFloat(n),r),r[3]=1},e.checkForAnnotatedValue=t=>e.getAnnotatedValueIndexInternal(t),e.getAnnotatedValueIndexInternal=e=>{if(void 0!==t.annotatedValueMap[e]){const n=t.annotationArray.length;return t.annotatedValueMap[e]%n}return-1},e.getIndexedColor=(e,t)=>{t[0]=0,t[1]=0,t[2]=0,t[3]=0},e.updateAnnotatedValueMap=()=>{t.annotatedValueMap=[];const e=t.annotationArray.length;for(let n=0;n<e;n++)t.annotatedValueMap[t.annotationArray[n].value]=n},e.mapScalars=(t,n,o)=>{const a=t.getNumberOfComponents();let l=null;if(n===u.DEFAULT&&(t.getDataType()===c.UNSIGNED_CHAR||t.getDataType()===c.UNSIGNED_CHAR_CLAMPED)||n===u.DIRECT_SCALARS&&t)l=e.convertToRGBA(t,a,t.getNumberOfTuples());else{const n={type:"vtkDataArray",name:"temp",numberOfComponents:4,dataType:c.UNSIGNED_CHAR},u=r.m.newTypedArray(n.dataType,4*t.getNumberOfTuples());n.values=u,n.size=u.length,l=i.Ay.newInstance(n);let d=o;d<0&&a>1?e.mapVectorsThroughTable(t,l,s.RGBA,-1,-1):(d<0&&(d=0),d>=a&&(d=a-1),e.mapScalarsThroughTable(t,l,s.RGBA,d))}return l},e.mapVectorsToMagnitude=(e,t,n)=>{const r=e.getNumberOfTuples(),i=e.getNumberOfComponents(),o=t.getData(),a=e.getData();for(let e=0;e<r;e++){let t=0;for(let r=0;r<n;r++)t+=a[e*i+r]*a[e*i+r];o[e]=Math.sqrt(t)}},e.mapVectorsThroughTable=(t,n,r,o,a)=>{let s=e.getVectorMode(),c=a,u=o;const d=t.getNumberOfComponents();s===l.COMPONENT?(-1===u&&(u=e.getVectorComponent()),u<0&&(u=0),u>=d&&(u=d-1)):(-1===c&&(c=e.getVectorSize()),c<=0?(u=0,c=d):(u<0&&(u=0),u>=d&&(u=d-1),u+c>d&&(c=d-u)),s!==l.MAGNITUDE||1!==d&&1!==c||(s=l.COMPONENT));let p=0;switch(u>0&&(p=u),s){case l.COMPONENT:e.mapScalarsThroughTable(t,n,r,p);break;case l.RGBCOLORS:break;case l.MAGNITUDE:default:{const o=i.Ay.newInstance({numberOfComponents:1,values:new Float32Array(t.getNumberOfTuples())});e.mapVectorsToMagnitude(t,o,c),e.mapScalarsThroughTable(o,n,r,0);break}}},e.luminanceToRGBA=(e,t,n,r)=>{const i=r(n),o=t.getData(),a=e.getData(),s=o.length;let l=0;for(let e=0;e<s;e+=1){const t=r(o[e]);a[4*l]=t,a[4*l+1]=t,a[4*l+2]=t,a[4*l+3]=i,l++}},e.luminanceAlphaToRGBA=(e,t,n,r)=>{const i=t.getData(),o=e.getData(),a=i.length;let s=0;for(let e=0;e<a;e+=2){const t=r(i[e]);o[s]=t,o[s+1]=t,o[s+2]=t,o[s+3]=r(i[e+1])*n,s+=4}},e.rGBToRGBA=(e,t,n,r)=>{const i=f(n),o=t.getData(),a=e.getData(),s=o.length;let l=0;for(let e=0;e<s;e+=3)a[4*l]=r(o[e]),a[4*l+1]=r(o[e+1]),a[4*l+2]=r(o[e+2]),a[4*l+3]=i,l++},e.rGBAToRGBA=(e,t,n,r)=>{const i=t.getData(),o=e.getData(),a=i.length;let s=0;for(let e=0;e<a;e+=4)o[4*s]=r(i[e]),o[4*s+1]=r(i[e+1]),o[4*s+2]=r(i[e+2]),o[4*s+3]=r(i[e+3])*n,s++},e.convertToRGBA=(n,r,o)=>{let{alpha:a}=t;if(4===r&&a>=1&&n.getDataType()===c.UNSIGNED_CHAR)return n;const s=i.Ay.newInstance({numberOfComponents:4,empty:!0,size:4*o,dataType:c.UNSIGNED_CHAR});if(o<=0)return s;a=a>0?a:0,a=a<1?a:1;let l=p;switch(n.getDataType()!==c.FLOAT&&n.getDataType()!==c.DOUBLE||(l=f),r){case 1:e.luminanceToRGBA(s,n,a,l);break;case 2:e.luminanceAlphaToRGBA(s,n,l);break;case 3:e.rGBToRGBA(s,n,a,l);break;case 4:e.rGBAToRGBA(s,n,a,l);break;default:return d("Cannot convert colors"),null}return s},e.usingLogScale=()=>!1,e.getNumberOfAvailableColors=()=>16777216,e.setRange=(t,n)=>e.setMappingRange(t,n),e.getRange=()=>e.getMappingRange(),e.areScalarsOpaque=(n,r,i)=>{if(!n)return e.isOpaque();const o=n.getNumberOfComponents();return(r!==u.DEFAULT||n.getDataType()!==c.UNSIGNED_CHAR)&&r!==u.DIRECT_SCALARS||(3===o||1===o?t.alpha>=1:255===n.getRange(o-1)[0])}}(e,t)}var g={newInstance:r.m.newInstance(m,"vtkScalarsToColors"),extend:m,...o.Ay}},62955:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>i,y0:()=>r});const r={LUMINANCE:1,LUMINANCE_ALPHA:2,RGB:3,RGBA:4};var i={VectorMode:{MAGNITUDE:0,COMPONENT:1,RGBCOLORS:2},ScalarMappingTarget:r}},88903:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>l});var r=n(28906),i=n(16632),o=n(74966);const a={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,a,n),r.m.obj(e,t),t.points||(t.points=o.Ay.newInstance()),r.m.get(e,t,["points","pointsIds"]),function(e,t){t.classHierarchy.push("vtkCell"),e.initialize=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n){t.pointsIds=n;let i=t.points.getData();i.length!==3*t.pointsIds.length&&(i=r.m.newTypedArray(e.getDataType(),3*t.pointsIds.length));const o=e.getData();t.pointsIds.forEach(((e,t)=>{let n=3*e,r=3*t;i[r]=o[n],i[++r]=o[++n],i[++r]=o[++n]})),t.points.setData(i)}else{t.points=e,t.pointsIds=new Array(e.getNumberOfPoints());for(let n=e.getNumberOfPoints()-1;n>=0;--n)t.pointsIds[n]=n}},e.getBounds=()=>{const e=t.points.getNumberOfPoints(),n=[];if(e){t.points.getPoint(0,n),t.bounds[0]=n[0],t.bounds[1]=n[0],t.bounds[2]=n[1],t.bounds[3]=n[1],t.bounds[4]=n[2],t.bounds[5]=n[2];for(let r=1;r<e;r++)t.points.getPoint(r,n),t.bounds[0]=n[0]<t.bounds[0]?n[0]:t.bounds[0],t.bounds[1]=n[0]>t.bounds[1]?n[0]:t.bounds[1],t.bounds[2]=n[1]<t.bounds[2]?n[1]:t.bounds[2],t.bounds[3]=n[1]>t.bounds[3]?n[1]:t.bounds[3],t.bounds[4]=n[2]<t.bounds[4]?n[2]:t.bounds[4],t.bounds[5]=n[2]>t.bounds[5]?n[2]:t.bounds[5]}else(0,i.u)(t.bounds);return t.bounds},e.getLength2=()=>{e.getBounds();let n=0,r=0;for(let e=0;e<3;e++)r=t.bounds[2*e+1]-t.bounds[2*e],n+=r*r;return n},e.getParametricDistance=e=>{let t,n=0;for(let r=0;r<3;r++)t=e[r]<0?-e[r]:e[r]>1?e[r]-1:0,t>n&&(n=t);return n},e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.deepCopy=e=>{e.initialize(t.points,t.pointsIds)},e.getCellDimension=()=>{},e.intersectWithLine=(e,t,n,r,i,o,a)=>{},e.evaluatePosition=(e,t,n,i,o,a)=>{r.m.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}(e,t)}var l={newInstance:r.m.newInstance(s,"vtkCell"),extend:s}},25737:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>h});var r=n(28906);var i={IntersectionState:{NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2}},o=n(88903),a=n(16632),s=n(3823);const{IntersectionState:l}=i;function c(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i={t:Number.MIN_VALUE,distance:0},o=[];let s;o[0]=n[0]-t[0],o[1]=n[1]-t[1],o[2]=n[2]-t[2];const l=o[0]*(e[0]-t[0])+o[1]*(e[1]-t[1])+o[2]*(e[2]-t[2]),c=(0,a.d)(o,o);let u=1e-5*l;return 0!==c&&(i.t=l/c),u<0&&(u=-u),-u<c&&c<u||c<=0||i.t<0?s=t:i.t>1?s=n:(s=o,o[0]=t[0]+i.t*o[0],o[1]=t[1]+i.t*o[1],o[2]=t[2]+i.t*o[2]),r&&(r[0]=s[0],r[1]=s[1],r[2]=s[2]),i.distance=(0,a.e)(s,e),i}function u(e,t,n,r,i,o){const s=[],u=[],d=[];i[0]=0,o[0]=0,(0,a.s)(t,e,s),(0,a.s)(r,n,u),(0,a.s)(n,e,d);const p=[(0,a.d)(s,s),-(0,a.d)(s,u),-(0,a.d)(s,u),(0,a.d)(u,u)],f=[];if(f[0]=(0,a.d)(s,d),f[1]=-(0,a.d)(u,d),0===(0,a.g)(p,f,2)){let a=Number.MAX_VALUE;const s=[e,t,n,r],u=[n,n,e,e],d=[r,r,t,t];let p;o[0],o[0],i[0],i[0],i[0],i[0],o[0],o[0];for(let e=0;e<4;e++)p=c(s[e],u[e],d[e]),p.distance<a&&(a=p.distance,p.t);return l.ON_LINE}return i[0]=f[0],o[0]=f[1],i[0]>=0&&i[0]<=1&&o[0]>=0&&o[0]<=1?l.YES_INTERSECTION:l.NO_INTERSECTION}const d={distanceToLine:c,intersection:u};const p={orientations:null};function f(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,p,n),o.Ay.extend(e,t,n),r.m.setGet(e,t,["orientations"]),function(e,t){t.classHierarchy.push("vtkLine"),e.getCellDimension=()=>1,e.intersectWithLine=(e,n,r,i,o)=>{const s={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};o[1]=0,o[2]=0;const d=[],p=[],f=[];t.points.getPoint(0,p),t.points.getPoint(1,f);const h=[],m=[],g=u(e,n,p,f,h,m);var v;if(s.t=h[0],s.betweenPoints=(v=s.t)>=0&&v<=1,o[0]=m[0],g===l.YES_INTERSECTION){for(let t=0;t<3;t++)i[t]=p[t]+o[0]*(f[t]-p[t]),d[t]=e[t]+s.t*(n[t]-e[t]);if((0,a.e)(i,d)<=r*r)return s.intersect=1,s}else{let t;if(s.t<0)return t=c(e,p,f,i),t.distance<=r*r?(s.t=0,s.intersect=1,s.betweenPoints=!0,s):s;if(s.t>1)return t=c(n,p,f,i),t.distance<=r*r?(s.t=1,s.intersect=1,s.betweenPoints=!0,s):s;if(o[0]<0)return o[0]=0,t=c(p,e,n,i),s.t=t.t,t.distance<=r*r?(s.intersect=1,s):s;if(o[0]>1)return o[0]=1,t=c(f,e,n,i),s.t=t.t,t.distance<=r*r?(s.intersect=1,s):s}return s},e.evaluateLocation=(e,n,r)=>{const i=[],o=[];t.points.getPoint(0,i),t.points.getPoint(1,o);for(let t=0;t<3;t++)n[t]=i[t]+e[0]*(o[t]-i[t]);r[0]=1-e[0],r[1]=e[0]},e.evaluateOrientation=(e,n,r)=>!!t.orientations&&(s.Yu.slerp(n,t.orientations[0],t.orientations[1],e[0]),r[0]=1-e[0],r[1]=e[0],!0)}(e,t)}var h={newInstance:r.m.newInstance(f,"vtkLine"),extend:f,...d,...i}},99341:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>s});var r=n(28906);const{vtkErrorMacro:i}=r.m;const o={range:[0,0],clamping:!0,allowDuplicateScalars:!1};function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,o,n),r.m.obj(e,t),t.nodes=[],r.m.setGet(e,t,["allowDuplicateScalars","clamping"]),r.m.setArray(e,t,["range"],2),r.m.getArray(e,t,["range"]),function(e,t){t.classHierarchy.push("vtkPiecewiseFunction"),e.getSize=()=>t.nodes.length,e.getType=()=>{let e,n=0,r=0;t.nodes.length>0&&(n=t.nodes[0].y);for(let i=1;i<t.nodes.length;i++){if(e=t.nodes[i].y,e!==n)if(e>n)switch(r){case 0:case 1:r=1;break;default:r=3}else switch(r){case 0:case 2:r=2;break;default:r=3}if(n=e,3===r)break}switch(r){case 0:return"Constant";case 1:return"NonDecreasing";case 2:return"NonIncreasing";default:return"Varied"}},e.getDataPointer=()=>{const e=t.nodes.length;if(t.function=null,e>0){t.function=[];for(let n=0;n<e;n++)t.function[2*n]=t.nodes[n].x,t.function[2*n+1]=t.nodes[n].y}return t.function},e.getFirstNonZeroValue=()=>{if(0===t.nodes.length)return 0;let e=1,n=0,r=0;for(;r<t.nodes.length;r++)if(0!==t.nodes[r].y){e=0;break}return n=e?Number.MAX_VALUE:r>0?t.nodes[r-1].x:t.clamping?-Number.MAX_VALUE:t.nodes[0].x,n},e.getNodeValue=(e,n)=>{const r=t.nodes.length;return e<0||e>=r?(i("Index out of range!"),-1):(n[0]=t.nodes[e].x,n[1]=t.nodes[e].y,n[2]=t.nodes[e].midpoint,n[3]=t.nodes[e].sharpness,1)},e.setNodeValue=(n,r)=>{const o=t.nodes.length;if(n<0||n>=o)return i("Index out of range!"),-1;const a=t.nodes[n].x;return t.nodes[n].x=r[0],t.nodes[n].y=r[1],t.nodes[n].midpoint=r[2],t.nodes[n].sharpness=r[3],a!==r[0]?e.sortAndUpdateRange():e.modified(),1},e.addPoint=(t,n)=>e.addPointLong(t,n,.5,0),e.addPointLong=(n,r,o,a)=>{if(o<0||o>1)return i("Midpoint outside range [0.0, 1.0]"),-1;if(a<0||a>1)return i("Sharpness outside range [0.0, 1.0]"),-1;t.allowDuplicateScalars||e.removePoint(n);const s={x:n,y:r,midpoint:o,sharpness:a};let l;for(t.nodes.push(s),e.sortAndUpdateRange(),l=0;l<t.nodes.length&&t.nodes[l].x!==n;l++);return l<t.nodes.length?l:-1},e.setNodes=n=>{t.nodes!==n&&(t.nodes=n,e.sortAndUpdateRange())},e.sortAndUpdateRange=()=>{t.nodes.sort(((e,t)=>e.x-t.x)),e.updateRange()||e.modified()},e.updateRange=()=>{const n=t.range.slice(),r=t.nodes.length;return r?(t.range[0]=t.nodes[0].x,t.range[1]=t.nodes[r-1].x):(t.range[0]=0,t.range[1]=0),(n[0]!==t.range[0]||n[1]!==t.range[1])&&(e.modified(),!0)},e.removePoint=n=>{let r;for(r=0;r<t.nodes.length&&t.nodes[r].x!==n;r++);if(r>=t.nodes.length)return-1;const i=r;let o=!1;return t.nodes.splice(r,1),0!==r&&r!==t.nodes.length||(o=e.updateRange()),o||e.modified(),i},e.removeAllPoints=()=>{t.nodes=[],e.sortAndUpdateRange()},e.addSegment=(n,r,i,o)=>{e.sortAndUpdateRange();for(let e=0;e<t.nodes.length;)t.nodes[e].x>=n&&t.nodes[e].x<=i?t.nodes.splice(e,1):e++;e.addPoint(n,r,.5,0),e.addPoint(i,o,.5,0)},e.getValue=t=>{const n=[];return e.getTable(t,t,1,n),n[0]},e.adjustRange=n=>{if(n.length<2)return 0;const r=e.getRange();r[0]<n[0]?e.addPoint(n[0],e.getValue(n[0])):e.addPoint(n[0],e.getValue(r[0])),r[1]>n[1]?e.addPoint(n[1],e.getValue(n[1])):e.addPoint(n[1],e.getValue(r[1])),e.sortAndUpdateRange();for(let e=0;e<t.nodes.length;)t.nodes[e].x>=n[0]&&t.nodes[e].x<=n[1]?t.nodes.splice(e,1):++e;return e.sortAndUpdateRange(),1},e.estimateMinNumberOfSamples=(t,n)=>{const r=e.findMinimumXDistance();return Math.ceil((n-t)/r)},e.findMinimumXDistance=()=>{const e=t.nodes.length;if(e<2)return-1;let n=t.nodes[1].x-t.nodes[0].x;for(let r=0;r<e-1;r++){const e=t.nodes[r+1].x-t.nodes[r].x;e<n&&(n=e)}return n},e.getTable=function(e,n,r,i){let o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=0;const l=t.nodes.length;let c=0;0!==l&&(c=t.nodes[l-1].y);let u=0,d=0,p=0,f=0,h=0,m=0,g=0;for(o=0;o<r;o++){const v=a*o;for(u=r>1?e+o/(r-1)*(n-e):.5*(e+n);s<l&&u>t.nodes[s].x;)s++,s<l&&(d=t.nodes[s-1].x,p=t.nodes[s].x,f=t.nodes[s-1].y,h=t.nodes[s].y,m=t.nodes[s-1].midpoint,g=t.nodes[s-1].sharpness,m<1e-5&&(m=1e-5),m>.99999&&(m=.99999));if(s>=l)i[v]=t.clamping?c:0;else if(0===s)i[v]=t.clamping?t.nodes[0].y:0;else{let e=(u-d)/(p-d);if(e=e<m?.5*e/m:.5+.5*(e-m)/(1-m),g>.99){if(e<.5){i[v]=f;continue}i[v]=h;continue}if(g<.01){i[v]=(1-e)*f+e*h;continue}e<.5?e=.5*(2*e)**(1+10*g):e>.5&&(e=1-.5*(2*(1-e))**(1+10*g));const t=e*e,n=t*e,r=2*n-3*t+1,o=-2*n+3*t,a=n-2*t+e,s=n-t,l=(1-g)*(h-f);i[v]=r*f+o*h+a*l+s*l;const c=f<h?f:h,y=f>h?f:h;i[v]=i[v]<c?c:i[v],i[v]=i[v]>y?y:i[v]}}}}(e,t)}var s={newInstance:r.m.newInstance(a,"vtkPiecewiseFunction"),extend:a}},87275:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>E});var r=n(28906),i=n(42852),o=n(35056),a=n(88903);const s={array:null,maxId:0,extend:0};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),r.m.obj(e,t),function(e,t){t.classHierarchy.push("vtkCellLinks"),e.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),i=n.getNumberOfCells(),o=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let t=0;t<i;++t){const{cellPointIds:r}=n.getCellPoints(t);r.forEach((t=>{e.incrementLinkCount(t)}))}e.allocateLinks(r),t.maxId=r-1;for(let t=0;t<i;++t){const{cellPointIds:r}=n.getCellPoints(t);r.forEach((n=>{e.insertCellReference(n,o[n]++,t)}))}}else{for(let t=0;t<i;t++)a.Ay.newInstance().getPointsIds().forEach((t=>{e.incrementLinkCount(t)}));e.allocateLinks(r),t.maxId=r-1;for(let t=0;t<i;++t)a.Ay.newInstance().getPointsIds().forEach((n=>{e.insertCellReference(n,o[n]++,t)}))}},e.allocate=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;t.array=Array(e).fill().map((()=>({ncells:0,cells:null}))),t.extend=n,t.maxId=-1},e.initialize=()=>{t.array=null},e.getLink=e=>t.array[e],e.getNcells=e=>t.array[e].ncells,e.getCells=e=>t.array[e].cells,e.insertNextPoint=e=>{t.array.push({ncells:e,cells:Array(e)}),++t.maxId},e.insertNextCellReference=(e,n)=>{t.array[e].cells[t.array[e].ncells++]=n},e.deletePoint=e=>{t.array[e].ncells=0,t.array[e].cells=null},e.removeCellReference=(e,n)=>{t.array[n].cells=t.array[n].cells.filter((t=>t!==e)),t.array[n].ncells=t.array[n].cells.length},e.addCellReference=(e,n)=>{t.array[n].cells[t.array[n].ncells++]=e},e.resizeCellList=(e,n)=>{t.array[e].cells.length=n},e.squeeze=()=>{!function(e,t){let n=t;for(t>=e.array.length&&(n+=e.array.length);n>e.array.length;)e.array.push({ncells:0,cells:null});e.array.length=n}(t,t.maxId+1)},e.reset=()=>{t.maxId=-1},e.deepCopy=e=>{t.array=[...e.array],t.extend=e.extend,t.maxId=e.maxId},e.incrementLinkCount=e=>{++t.array[e].ncells},e.allocateLinks=e=>{for(let n=0;n<e;++n)t.array[n].cells=new Array(t.array[n].ncells)},e.insertCellReference=(e,n,r)=>{t.array[e].cells[n]=r}}(e,t)}var c={newInstance:r.m.newInstance(l,"vtkCellLinks"),extend:l};const u={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_PIXEL:8,VTK_QUAD:9,VTK_TETRA:10,VTK_VOXEL:11,VTK_HEXAHEDRON:12,VTK_WEDGE:13,VTK_PYRAMID:14,VTK_PENTAGONAL_PRISM:15,VTK_HEXAGONAL_PRISM:16,VTK_QUADRATIC_EDGE:21,VTK_QUADRATIC_TRIANGLE:22,VTK_QUADRATIC_QUAD:23,VTK_QUADRATIC_POLYGON:36,VTK_QUADRATIC_TETRA:24,VTK_QUADRATIC_HEXAHEDRON:25,VTK_QUADRATIC_WEDGE:26,VTK_QUADRATIC_PYRAMID:27,VTK_BIQUADRATIC_QUAD:28,VTK_TRIQUADRATIC_HEXAHEDRON:29,VTK_QUADRATIC_LINEAR_QUAD:30,VTK_QUADRATIC_LINEAR_WEDGE:31,VTK_BIQUADRATIC_QUADRATIC_WEDGE:32,VTK_BIQUADRATIC_QUADRATIC_HEXAHEDRON:33,VTK_BIQUADRATIC_TRIANGLE:34,VTK_CUBIC_LINE:35,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42,VTK_PARAMETRIC_CURVE:51,VTK_PARAMETRIC_SURFACE:52,VTK_PARAMETRIC_TRI_SURFACE:53,VTK_PARAMETRIC_QUAD_SURFACE:54,VTK_PARAMETRIC_TETRA_REGION:55,VTK_PARAMETRIC_HEX_REGION:56,VTK_HIGHER_ORDER_EDGE:60,VTK_HIGHER_ORDER_TRIANGLE:61,VTK_HIGHER_ORDER_QUAD:62,VTK_HIGHER_ORDER_POLYGON:63,VTK_HIGHER_ORDER_TETRAHEDRON:64,VTK_HIGHER_ORDER_WEDGE:65,VTK_HIGHER_ORDER_PYRAMID:66,VTK_HIGHER_ORDER_HEXAHEDRON:67,VTK_LAGRANGE_CURVE:68,VTK_LAGRANGE_TRIANGLE:69,VTK_LAGRANGE_QUADRILATERAL:70,VTK_LAGRANGE_TETRAHEDRON:71,VTK_LAGRANGE_HEXAHEDRON:72,VTK_LAGRANGE_WEDGE:73,VTK_LAGRANGE_PYRAMID:74,VTK_NUMBER_OF_CELL_TYPES:75},d=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];const p={getClassNameFromTypeId:function(e){return e<d.length?d[e]:"UnknownClass"},getTypeIdFromClassName:function(e){return d.findIndex(e)},isLinear:function(e){return e<u.VTK_QUADRATIC_EDGE||e===u.VTK_CONVEX_POINT_SET||e===u.VTK_POLYHEDRON},hasSubCells:function(e){return e===u.VTK_TRIANGLE_STRIP||e===u.VTK_POLY_LINE||e===u.VTK_POLY_VERTEX}};const f={size:0,maxId:-1,extend:1e3};function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,f,n),r.m.obj(e,t),r.m.get(e,t,["size","maxId","extend"]),r.m.getArray(e,t,["typeArray","locationArray"]),function(e,t){t.classHierarchy.push("vtkCellTypes"),e.allocate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:512,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;t.size=e>0?e:1,t.extend=n>0?n:1,t.maxId=-1,t.typeArray=new Uint8Array(e),t.locationArray=new Uint32Array(e)},e.insertCell=(e,n,r)=>{t.typeArray[e]=n,t.locationArray[e]=r,e>t.maxId&&(t.maxId=e)},e.insertNextCell=(n,r)=>(e.insertCell(++t.maxId,n,r),t.maxId),e.setCellTypes=(e,n,r)=>{t.size=e,t.typeArray=n,t.locationArray=r,t.maxId=e-1},e.getCellLocation=e=>t.locationArray[e],e.deleteCell=e=>{t.typeArray[e]=u.VTK_EMPTY_CELL},e.getNumberOfTypes=()=>t.maxId+1,e.isType=t=>{const n=e.getNumberOfTypes();for(let r=0;r<n;++r)if(t===e.getCellType(r))return!0;return!1},e.insertNextType=t=>e.insertNextCell(t,-1),e.getCellType=e=>t.typeArray[e],e.reset=()=>{t.maxId=-1},e.deepCopy=n=>{e.allocate(n.getSize(),n.getExtend()),t.typeArray.set(n.getTypeArray()),t.locationArray.set(n.getLocationArray()),t.maxId=n.getMaxId()}}(e,t)}var m={newInstance:r.m.newInstance(h,"vtkCellTypes"),extend:h,...p},g=n(25737),v=n(69147),y=n(74966);const b={};function x(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,b,n),v.Ay.extend(e,t,n),r.m.setGet(e,t,["points"]),function(e,t){t.classHierarchy.push("vtkPointSet"),t.points?t.points=(0,i.A)(t.points):t.points=y.Ay.newInstance(),e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.getBounds=()=>t.points.getBounds(),e.computeBounds=()=>{e.getBounds()};const n=e.shallowCopy;e.shallowCopy=function(e){n(e,arguments.length>1&&void 0!==arguments[1]&&arguments[1]),t.points=y.Ay.newInstance(),t.points.shallowCopy(e.getPoints())}}(e,t)}var A={newInstance:r.m.newInstance(x,"vtkPointSet"),extend:x},C=n(96703);const T=["verts","lines","polys","strips"];const{vtkWarningMacro:S}=r.m,w={[u.VTK_LINE]:g.Ay,[u.VTK_POLY_LINE]:g.Ay,[u.VTK_TRIANGLE]:C.Ay};const _={};function I(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,_,n),A.extend(e,t,n),r.m.get(e,t,["cells","links"]),r.m.setGet(e,t,["verts","lines","polys","strips"]),function(e,t){t.classHierarchy.push("vtkPolyData"),T.forEach((n=>{var r;e[`getNumberOf${r=n,r.replace(/(?:^\w|[A-Z]|\b\w)/g,(e=>e.toUpperCase())).replace(/\s+/g,"")}`]=()=>t[n].getNumberOfCells(),t[n]?t[n]=(0,i.A)(t[n]):t[n]=o.Ay.newInstance()})),e.getNumberOfCells=()=>T.reduce(((e,n)=>e+t[n].getNumberOfCells()),0);const n=e.shallowCopy;e.shallowCopy=function(e){n(e,arguments.length>1&&void 0!==arguments[1]&&arguments[1]),T.forEach((n=>{t[n]=o.Ay.newInstance(),t[n].shallowCopy(e.getReferenceByName(n))}))},e.buildCells=()=>{const n=e.getNumberOfVerts(),r=e.getNumberOfLines(),i=e.getNumberOfPolys(),o=e.getNumberOfStrips(),a=n+r+i+o,s=new Uint8Array(a);let l=s;const c=new Uint32Array(a);let d=c;if(n){let e=0;t.verts.getCellSizes().forEach(((t,n)=>{d[n]=e,l[n]=t>1?u.VTK_POLY_VERTEX:u.VTK_VERTEX,e+=t+1})),d=d.subarray(n),l=l.subarray(n)}if(r){let e=0;t.lines.getCellSizes().forEach(((t,n)=>{d[n]=e,l[n]=t>2?u.VTK_POLY_LINE:u.VTK_LINE,1===t&&S("Building VTK_LINE ",n," with only one point, but VTK_LINE needs at least two points. Check the input."),e+=t+1})),d=d.subarray(r),l=l.subarray(r)}if(i){let e=0;t.polys.getCellSizes().forEach(((t,n)=>{switch(d[n]=e,t){case 3:l[n]=u.VTK_TRIANGLE;break;case 4:l[n]=u.VTK_QUAD;break;default:l[n]=u.VTK_POLYGON}t<3&&S("Building VTK_TRIANGLE ",n," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),e+=t+1})),d+=d.subarray(i),l+=l.subarray(i)}if(o){let e=0;l.fill(u.VTK_TRIANGLE_STRIP,0,o),t.strips.getCellSizes().forEach(((t,n)=>{d[n]=e,e+=t+1}))}t.cells=m.newInstance(),t.cells.setCellTypes(a,s,c)},e.buildLinks=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;void 0===t.cells&&e.buildCells(),t.links=c.newInstance(),n>0?t.links.allocate(n):t.links.allocate(e.getPoints().getNumberOfPoints()),t.links.buildLinks(e)},e.getCellType=e=>t.cells.getCellType(e),e.getCellPoints=n=>{const r=e.getCellType(n);let i=null;switch(r){case u.VTK_VERTEX:case u.VTK_POLY_VERTEX:i=t.verts;break;case u.VTK_LINE:case u.VTK_POLY_LINE:i=t.lines;break;case u.VTK_TRIANGLE:case u.VTK_QUAD:case u.VTK_POLYGON:i=t.polys;break;case u.VTK_TRIANGLE_STRIP:i=t.strips;break;default:return i=null,{type:0,cellPointIds:null}}const o=t.cells.getCellLocation(n);return{cellType:r,cellPointIds:i.getCell(o)}},e.getPointCells=e=>t.links.getCells(e),e.getCellEdgeNeighbors=(e,n,r)=>{const i=t.links.getLink(n),o=t.links.getLink(r);return i.cells.filter((t=>t!==e&&-1!==o.cells.indexOf(t)))},e.getCell=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=e.getCellPoints(t),i=n||w[r.cellType].newInstance();return i.initialize(e.getPoints(),r.cellPointIds),i}}(e,t)}var E={newInstance:r.m.newInstance(I,"vtkPolyData"),extend:I}},96703:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>f});var r=n(28906),i=n(88903),o=n(16632),a=n(25737),s=n(75127);function l(e,t,n,r){const i=n[0]-t[0],o=n[1]-t[1],a=n[2]-t[2],s=e[0]-t[0],l=e[1]-t[1],c=e[2]-t[2];r[0]=o*c-a*l,r[1]=a*s-i*c,r[2]=i*l-o*s}function c(e,t,n,r){l(e,t,n,r);const i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);0!==i&&(r[0]/=i,r[1]/=i,r[2]/=i)}const u={computeNormalDirection:l,computeNormal:c,intersectWithTriangle:function(e,t,n,r,i,a){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1e-6,u=!1;const d=[],p=[],f=[],h=[],m=[];c(e,t,n,h),c(r,i,a,m);const g=-(0,o.d)(h,e),v=-(0,o.d)(m,r),y=[(0,o.d)(m,e)+v,(0,o.d)(m,t)+v,(0,o.d)(m,n)+v];if(y[0]*y[1]>l&&y[0]*y[2]>l)return{intersect:!1,coplanar:u,pt1:d,pt2:p,surfaceId:f};const b=[(0,o.d)(h,r)+g,(0,o.d)(h,i)+g,(0,o.d)(h,a)+g];if(b[0]*b[1]>l&&b[0]*b[2]>l)return{intersect:!1,coplanar:u,pt1:d,pt2:p,surfaceId:f};if(Math.abs(h[0]-m[0])<1e-9&&Math.abs(h[1]-m[1])<1e-9&&Math.abs(h[2]-m[2])<1e-9&&Math.abs(g-v)<1e-9)return u=!0,{intersect:!1,coplanar:u,pt1:d,pt2:p,surfaceId:f};const x=[e,t,n],A=[r,i,a],C=(0,o.d)(h,m),T=(g-v*C)/(C*C-1),S=(v-g*C)/(C*C-1),w=[T*h[0]+S*m[0],T*h[1]+S*m[1],T*h[2]+S*m[2]],_=(0,o.j)(h,m,[]);(0,o.l)(_);let I=0,E=0;const D=[],O=[];let P,R,N=50,M=50;for(let t=0;t<3;t++){const n=t,i=(t+1)%3,a=s.Ay.intersectWithLine(x[n],x[i],r,m);a.intersection&&a.t>0-l&&a.t<1+l&&(a.t<1+l&&a.t>1-l&&(N=I),D[I++]=(0,o.d)(a.x,_)-(0,o.d)(w,_));const c=s.Ay.intersectWithLine(A[n],A[i],e,h);c.intersection&&c.t>0-l&&c.t<1+l&&(c.t<1+l&&c.t>1-l&&(M=E),O[E++]=(0,o.d)(c.x,_)-(0,o.d)(w,_))}if(I>2){I--;const e=D[2];D[2]=D[N],D[N]=e}if(E>2){E--;const e=O[2];O[2]=O[M],O[M]=e}if(2!==I||2!==E)return{intersect:!1,coplanar:u,pt1:d,pt2:p,surfaceId:f};if(Number.isNaN(D[0])||Number.isNaN(D[1])||Number.isNaN(O[0])||Number.isNaN(O[1]))return{intersect:!1,coplanar:u,pt1:d,pt2:p,surfaceId:f};if(D[0]>D[1]){const e=D[1];D[1]=D[0],D[0]=e}if(O[0]>O[1]){const e=O[1];O[1]=O[0],O[0]=e}return D[1]<O[0]||O[1]<D[0]?{intersect:!1,coplanar:u,pt1:d,pt2:p,surfaceId:f}:(D[0]<O[0]?D[1]<O[1]?(f[0]=2,f[1]=1,P=O[0],R=D[1]):(f[0]=2,f[1]=2,P=O[0],R=O[1]):D[1]<O[1]?(f[0]=1,f[1]=1,P=D[0],R=D[1]):(f[0]=1,f[1]=2,P=D[0],R=O[1]),(0,o.m)(w,_,P,d),(0,o.m)(w,_,R,p),{intersect:!0,coplanar:u,pt1:d,pt2:p,surfaceId:f})}};const d={};function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,d,n),i.Ay.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkTriangle"),e.getCellDimension=()=>2,e.intersectWithLine=(n,r,i,l,u)=>{const d={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};u[2]=0;const p=[],f=i*i,h=[],m=[],g=[];t.points.getPoint(0,h),t.points.getPoint(1,m),t.points.getPoint(2,g);const v=[],y=[];if(c(h,m,g,v),0!==v[0]||0!==v[1]||0!==v[2]){const t=s.Ay.intersectWithLine(n,r,h,v);if(d.betweenPoints=t.betweenPoints,d.t=t.t,l[0]=t.x[0],l[1]=t.x[1],l[2]=t.x[2],!t.intersection)return u[0]=0,u[1]=0,d.intersect=0,d;const i=e.evaluatePosition(l,p,u,y);if(i.evaluation>=0)return i.dist2<=f?(d.intersect=1,d):(d.intersect=i.evaluation,d)}const b=(0,o.e)(h,m),x=(0,o.e)(m,g),A=(0,o.e)(g,h);t.line||(t.line=a.Ay.newInstance()),b>x&&b>A?(t.line.getPoints().setPoint(0,h),t.line.getPoints().setPoint(1,m)):x>A&&x>b?(t.line.getPoints().setPoint(0,m),t.line.getPoints().setPoint(1,g)):(t.line.getPoints().setPoint(0,g),t.line.getPoints().setPoint(1,h));const C=t.line.intersectWithLine(n,r,i,l,u);if(d.betweenPoints=C.betweenPoints,d.t=C.t,C.intersect){const e=[],t=[],n=[];for(let r=0;r<3;r++)e[r]=h[r]-g[r],t[r]=m[r]-g[r],n[r]=l[r]-g[r];return u[0]=(0,o.d)(n,e)/A,u[1]=(0,o.d)(n,t)/x,d.intersect=1,d}return u[0]=0,u[1]=0,d.intersect=0,d},e.evaluatePosition=(e,n,r,i)=>{const c={subId:0,dist2:0,evaluation:-1};let u,d;const p=[],f=[],h=[],m=[];let g;const v=[],y=[],b=[];let x=0,A=0;const C=[];let T,S,w,_=[];const I=[],E=[],D=[];c.subId=0,r[2]=0,t.points.getPoint(1,p),t.points.getPoint(2,f),t.points.getPoint(0,h),l(p,f,h,m),s.Ay.generalizedProjectPoint(e,p,m,D);let O=0;for(u=0;u<3;u++)g=m[u]<0?-m[u]:m[u],g>O&&(O=g,A=u);for(d=0,u=0;u<3;u++)u!==A&&(C[d++]=u);for(u=0;u<2;u++)v[u]=D[C[u]]-h[C[u]],y[u]=p[C[u]]-h[C[u]],b[u]=f[C[u]]-h[C[u]];if(x=(0,o.o)(y,b),0===x)return r[0]=0,r[1]=0,c.evaluation=-1,c;if(r[0]=(0,o.o)(v,b)/x,r[1]=(0,o.o)(y,v)/x,i[0]=1-(r[0]+r[1]),i[1]=r[0],i[2]=r[1],i[0]>=0&&i[0]<=1&&i[1]>=0&&i[1]<=1&&i[2]>=0&&i[2]<=1)n&&(c.dist2=(0,o.e)(D,e),n[0]=D[0],n[1]=D[1],n[2]=D[2]),c.evaluation=1;else{let t;if(n)if(i[1]<0&&i[2]<0)for(T=(0,o.e)(e,h),S=a.Ay.distanceToLine(e,p,h,t,I),w=a.Ay.distanceToLine(e,h,f,t,E),T<S?(c.dist2=T,_=h):(c.dist2=S,_=I),w<c.dist2&&(c.dist2=w,_=E),u=0;u<3;u++)n[u]=_[u];else if(i[2]<0&&i[0]<0)for(T=(0,o.e)(e,p),S=a.Ay.distanceToLine(e,p,h,t,I),w=a.Ay.distanceToLine(e,p,f,t,E),T<S?(c.dist2=T,_=p):(c.dist2=S,_=I),w<c.dist2&&(c.dist2=w,_=E),u=0;u<3;u++)n[u]=_[u];else if(i[1]<0&&i[0]<0)for(T=(0,o.e)(e,f),S=a.Ay.distanceToLine(e,f,h,t,I),w=a.Ay.distanceToLine(e,p,f,t,E),T<S?(c.dist2=T,_=f):(c.dist2=S,_=I),w<c.dist2&&(c.dist2=w,_=E),u=0;u<3;u++)n[u]=_[u];else if(i[0]<0){const t=a.Ay.distanceToLine(e,p,f,n);c.dist2=t.distance}else if(i[1]<0){const t=a.Ay.distanceToLine(e,f,h,n);c.dist2=t.distance}else if(i[2]<0){const t=a.Ay.distanceToLine(e,p,h,n);c.dist2=t.distance}c.evaluation=0}return c},e.evaluateLocation=(e,n,r)=>{const i=[],o=[],a=[];t.points.getPoint(0,i),t.points.getPoint(1,o),t.points.getPoint(2,a);const s=1-e[0]-e[1];for(let t=0;t<3;t++)n[t]=i[t]*s+o[t]*e[0]+a[t]*e[1];r[0]=s,r[1]=e[0],r[2]=e[1]},e.getParametricDistance=e=>{let t,n=0;const r=[];r[0]=e[0],r[1]=e[1],r[2]=1-e[0]-e[1];for(let e=0;e<3;e++)t=r[e]<0?-r[e]:r[e]>1?r[e]-1:0,t>n&&(n=t);return n}}(e,t)}var f={newInstance:r.m.newInstance(p,"vtkTriangle"),extend:p,...u}},61088:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var r=n(28906),i=n(87275);const{vtkErrorMacro:o}=r.c;function a(e,t){t.classHierarchy.push("vtkCutter");const n={...e};function a(e,n){const i=e.getPoints(),o=i.getData(),a=i.getNumberOfPoints(),s=[],l=[],c=[];(!t.cutScalars||t.cutScalars.length<a)&&(t.cutScalars=new Float32Array(a));let u=0,d=0;for(;u<o.length;)t.cutScalars[d++]=t.cutFunction.evaluateFunction(o[u++],o[u++],o[u++]);const p=[],f=new Array(3),h=new Array(3),m=[];for(const n=function(e){const t=e.getPolys().getData(),n=e.getStrips().getData(),r={cellSize:0,cell:[],done:!1,polyIdx:0,stripIdx:0,remainingStripLength:0,next(){if(r.polyIdx<t.length){r.cellSize=t[r.polyIdx];const e=r.polyIdx+1,n=e+r.cellSize;r.polyIdx=n;let i=0;for(let o=e;o<n;++o)r.cell[i++]=t[o]}else if(r.stripIdx<n.length){r.cellSize=3,0===r.remainingStripLength&&(r.remainingStripLength=n[r.stripIdx]-2,r.stripIdx+=3);const e=r.stripIdx-2,t=r.stripIdx+1;r.stripIdx++,r.remainingStripLength--;let i=0;for(let o=e;o<t;++o)r.cell[i++]=n[o]}else{if(r.done)throw new Error("Iterator is done");r.done=!0}}};return r.next(),r}(e);!n.done;n.next()){if(n.cellSize<=2)continue;for(let e=0;e<n.cellSize;)m[e]=t.cutScalars[n.cell[e++]];const e=m[0]>0;let r=!0;for(let t=1;t<n.cell.length;t++){if(m[t]>0!==e){r=!1;break}}if(r)continue;const i=[];for(let e=0;e<n.cellSize;e++){const r=e+1===n.cellSize?0:e+1,a=m[e]>0;if(m[r]>0===a)continue;let s=e,l=r,c=m[l]-m[s];c<=0&&(s=r,l=e,c*=-1);let u=0;0!==c&&(u=(t.cutValue-m[s])/c);const d=n.cell[s],p=n.cell[l];f[0]=o[3*d],f[1]=o[3*d+1],f[2]=o[3*d+2],h[0]=o[3*p],h[1]=o[3*p+1],h[2]=o[3*p+2];const g=[f[0]+u*(h[0]-f[0]),f[1]+u*(h[1]-f[1]),f[2]+u*(h[2]-f[2])];i.push({pointEdge1:d,pointEdge2:p,intersectedPoint:g,newPointID:-1})}for(let e=0;e<i.length;e++){const t=i[e];let n=!1;for(let r=0;r<p.length;r++){const o=p[r],a=t.pointEdge1===o.pointEdge1&&t.pointEdge2===o.pointEdge2,s=t.intersectedPoint[0]===o.intersectedPoint[0]&&t.intersectedPoint[1]===o.intersectedPoint[1]&&t.intersectedPoint[2]===o.intersectedPoint[2];if(a||s){n=!0,i[e].newPointID=p[r].newPointID;break}}n||(s.push(t.intersectedPoint[0]),s.push(t.intersectedPoint[1]),s.push(t.intersectedPoint[2]),i[e].newPointID=s.length/3-1,p.push(i[e]))}const a=i.length;2===a?l.push(a,i[0].newPointID,i[1].newPointID):a>2&&(c.push(a),i.forEach((e=>{c.push(e.newPointID)})))}n.getPoints().setData((0,r.b)(i.getDataType(),s),3),0!==l.length&&n.getLines().setData(Uint16Array.from(l)),0!==c.length&&n.getPolys().setData(Uint16Array.from(c))}e.getMTime=()=>{let e=n.getMTime();return t.cutFunction?(e=Math.max(e,t.cutFunction.getMTime()),e):e},e.requestData=(e,n)=>{const r=e[0];if(!r)return void o("Invalid or missing input");if(!t.cutFunction)return void o("Missing cut function");const s=i.Ay.newInstance();a(r,s),n[0]=s}}const s={cutFunction:null,cutScalars:null,cutValue:0};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),(0,r.o)(e,t),(0,r.d)(e,t,1,1),(0,r.e)(e,t,["cutFunction","cutValue"]),a(e,t)}var c={newInstance:(0,r.n)(l,"vtkCutter"),extend:l}},56748:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>p});var r=n(28906),i=n(35056),o=n(42008),a=n(87275),s=n(89265);const l=[2,0,1,2,2,3,2,4,5,2,6,7,2,0,2,2,1,3,2,4,6,2,5,7,2,0,4,2,1,5,2,2,6,2,3,7],c=[4,0,1,3,2,4,4,6,7,5,4,8,10,11,9,4,12,13,15,14,4,16,18,19,17,4,20,21,23,22];const u={xLength:1,yLength:1,zLength:1,pointType:"Float64Array",generate3DTextureCoordinates:!1,generateFaces:!0,generateLines:!1};function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,u,n),r.m.obj(e,t),r.m.setGet(e,t,["xLength","yLength","zLength","generate3DTextureCoordinates","generateFaces","generateLines"]),r.m.setGetArray(e,t,["center","rotations"],3),r.m.setGetArray(e,t,["matrix"],16),t._polys=i.Ay.newInstance({values:Uint16Array.from(c)}),t._lineCells=i.Ay.newInstance({values:Uint16Array.from(l)}),r.m.moveToProtected(e,t,["polys","lineCells"]),r.m.algo(e,t,0,1),function(e,t){t.classHierarchy.push("vtkCubeSource"),e.setBounds=function(){let t=[];if(Array.isArray(arguments.length<=0?void 0:arguments[0]))t=arguments.length<=0?void 0:arguments[0];else for(let e=0;e<arguments.length;e++)t.push(e<0||arguments.length<=e?void 0:arguments[e]);6===t.length&&(e.setXLength(t[1]-t[0]),e.setYLength(t[3]-t[2]),e.setZLength(t[5]-t[4]),e.setCenter([(t[0]+t[1])/2,(t[2]+t[3])/2,(t[4]+t[5])/2]))},e.requestData=function(e,n){if(t.deleted)return;const i=a.Ay.newInstance();n[0]=i;const l=r.m.newTypedArray(t.pointType,72);i.getPoints().setData(l,3);const c=r.m.newTypedArray(t.pointType,72),u=o.Ay.newInstance({name:"Normals",values:c,numberOfComponents:3});i.getPointData().setNormals(u);let d=2;!0===t.generate3DTextureCoordinates&&(d=3);const p=r.m.newTypedArray(t.pointType,24*d),f=o.Ay.newInstance({name:"TextureCoordinates",values:p,numberOfComponents:d});i.getPointData().setTCoords(f);const h=[0,0,0],m=[0,0,0],g=[0,0];let v=0;h[0]=-t.xLength/2,m[0]=-1,m[1]=0,m[2]=0;for(let e=0;e<2;e++){h[1]=-t.yLength/2;for(let n=0;n<2;n++){g[1]=h[1]+.5,h[2]=-t.zLength/2;for(let r=0;r<2;r++)g[0]=(h[2]+.5)*(1-2*e),l[3*v]=h[0],l[3*v+1]=h[1],l[3*v+2]=h[2],c[3*v]=m[0],c[3*v+1]=m[1],c[3*v+2]=m[2],2===d?(p[v*d]=g[0],p[v*d+1]=g[1]):(p[v*d]=2*e-1,p[v*d+1]=2*n-1,p[v*d+2]=2*r-1),v++,h[2]+=t.zLength;h[1]+=t.yLength}h[0]+=t.xLength,m[0]+=2}h[1]=-t.yLength/2,m[1]=-1,m[0]=0,m[2]=0;for(let e=0;e<2;e++){h[0]=-t.xLength/2;for(let n=0;n<2;n++){g[0]=(h[0]+.5)*(2*e-1),h[2]=-t.zLength/2;for(let r=0;r<2;r++)g[1]=-1*(h[2]+.5),l[3*v]=h[0],l[3*v+1]=h[1],l[3*v+2]=h[2],c[3*v]=m[0],c[3*v+1]=m[1],c[3*v+2]=m[2],2===d?(p[v*d]=g[0],p[v*d+1]=g[1]):(p[v*d]=2*n-1,p[v*d+1]=2*e-1,p[v*d+2]=2*r-1),v++,h[2]+=t.zLength;h[0]+=t.xLength}h[1]+=t.yLength,m[1]+=2}h[2]=-t.zLength/2,m[2]=-1,m[0]=0,m[1]=0;for(let e=0;e<2;e++){h[1]=-t.yLength/2;for(let n=0;n<2;n++){g[1]=h[1]+.5,h[0]=-t.xLength/2;for(let r=0;r<2;r++)g[0]=(h[0]+.5)*(2*e-1),l[3*v]=h[0],l[3*v+1]=h[1],l[3*v+2]=h[2],c[3*v]=m[0],c[3*v+1]=m[1],c[3*v+2]=m[2],2===d?(p[v*d]=g[0],p[v*d+1]=g[1]):(p[v*d]=2*r-1,p[v*d+1]=2*n-1,p[v*d+2]=2*e-1),v++,h[0]+=t.xLength;h[1]+=t.yLength}h[2]+=t.zLength,m[2]+=2}if(t.rotations&&s.A.buildFromDegree().rotateX(t.rotations[0]).rotateY(t.rotations[1]).rotateZ(t.rotations[2]).apply(l).apply(c),t.center&&s.A.buildFromRadian().translate(...t.center).apply(l),t.matrix){s.A.buildFromRadian().setMatrix(t.matrix).apply(l);const e=[t.matrix[0],t.matrix[1],t.matrix[2],0,t.matrix[4],t.matrix[5],t.matrix[6],0,t.matrix[8],t.matrix[9],t.matrix[10],0,0,0,0,1];s.A.buildFromRadian().setMatrix(e).apply(c)}t.generateFaces?i.getPolys().deepCopy(t._polys):i.getPolys().initialize(),t.generateLines?(i.getLines().deepCopy(t._lineCells),i.getPointData().setNormals(null)):i.getLines().initialize(),i.modified()}}(e,t)}var p={newInstance:r.m.newInstance(d,"vtkCubeSource"),extend:d}},56413:(e,t,n)=>{"use strict";function r(e){return new TextDecoder("latin1").decode(e)}n.d(t,{A:()=>i});var i={arrayBufferToString:r,extractBinary:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=r(e),o=t.exec(i);if(!o)return{text:i};const a=o.index+o[0].length,s=i.substring(0,a);let l=null;const c=n?n.exec(i):null;if(c){l={text:s+i.substr(c.index),binaryBuffer:e.slice(a,c.index)}}else l={text:s,binaryBuffer:e.slice(a)};return l}}},8906:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a,uE:()=>o,zy:()=>i});const r={};function i(e){return!!r[e]}function o(e,t){r[e]=t}var a={get:function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"http"](e)},has:i,registerType:o}},67313:(e,t,n)=>{"use strict";var r=n(28906);function i(){const e=new ArrayBuffer(4),t=new Uint8Array(e),n=new Uint32Array(e);return t[0]=161,t[1]=178,t[2]=195,t[3]=212,3569595041===n[0]?"LittleEndian":2712847316===n[0]?"BigEndian":null}var o={ENDIANNESS:i(),getEndianness:i,swapBytes:function(e,t){if(t<2)return;const n=new Int8Array(e),r=n.length,i=[];for(let e=0;e<r;e+=t){for(let r=0;r<t;r++)i.push(n[e+r]);for(let r=0;r<t;r++)n[e+r]=i.pop()}}},a=n(28914),s=n(8906);const{vtkErrorMacro:l,vtkDebugMacro:c}=r.m,u=()=>(l("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead."),Promise.reject(new Error("LiteHttpDataAccessHelper does not support compression. Need to register HttpDataAccessHelper instead.")));let d=0;function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new XMLHttpRequest;return r.open(e,t,!0),n.headers&&Object.entries(n.headers).forEach((e=>{let[t,n]=e;return r.setRequestHeader(t,n)})),n.progressCallback&&r.addEventListener("progress",n.progressCallback),r}const f={fetchArray:function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i&&i.compression?u():n.ref&&!n.ref.pending?new Promise(((s,u)=>{const f=p("GET",[t,n.ref.basepath,n.ref.id].join("/"),i);f.onreadystatechange=t=>{1===f.readyState&&(n.ref.pending=!0,1==++d&&e?.invokeBusy&&e.invokeBusy(!0)),4===f.readyState&&(n.ref.pending=!1,200===f.status||0===f.status?(n.buffer=f.response,"JSON"===n.ref.encode?n.values=JSON.parse(n.buffer):(o.ENDIANNESS!==n.ref.encode&&o.ENDIANNESS&&(c(`Swap bytes of ${n.name}`),o.swapBytes(n.buffer,a.uP[n.dataType])),n.values=r.m.newTypedArray(n.dataType,n.buffer)),n.values.length!==n.size&&l(`Error in FetchArray: ${n.name}, does not have the proper array size. Got ${n.values.length}, instead of ${n.size}`),delete n.ref,0==--d&&e?.invokeBusy&&e.invokeBusy(!1),e?.modified&&e.modified(),s(n)):u({xhr:f,e:t}))},f.responseType="string"!==n.dataType?"arraybuffer":"text",f.send()})):Promise.resolve(n)},fetchJSON:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n&&n.compression?u():new Promise(((r,i)=>{const o=p("GET",t,n);o.onreadystatechange=t=>{1===o.readyState&&1==++d&&e?.invokeBusy&&e.invokeBusy(!0),4===o.readyState&&(0==--d&&e?.invokeBusy&&e.invokeBusy(!1),200===o.status||0===o.status?r(JSON.parse(o.responseText)):i({xhr:o,e:t}))},o.responseType="text",o.send()}))},fetchText:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n&&n.compression?u():new Promise(((r,i)=>{const o=p("GET",t,n);o.onreadystatechange=t=>{1===o.readyState&&1==++d&&e?.invokeBusy&&e.invokeBusy(!0),4===o.readyState&&(0==--d&&e?.invokeBusy&&e.invokeBusy(!1),200===o.status||0===o.status?r(o.responseText):i({xhr:o,e:t}))},o.responseType="text",o.send()}))},fetchBinary:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((n,r)=>{const i=p("GET",e,t);i.onreadystatechange=e=>{4===i.readyState&&(200===i.status||0===i.status?n(i.response):r({xhr:i,e}))},i.responseType="arraybuffer",i.send()}))},fetchImage:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(((e,r)=>{const i=new Image;n.crossOrigin&&(i.crossOrigin=n.crossOrigin),i.onload=()=>e(i),i.onerror=r,i.src=t}))}};(0,s.zy)("http")||(0,s.uE)("http",(e=>f))},94199:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>ye});var r=n(28906),i=n(87275),o=n(14235),a=Uint8Array,s=Uint16Array,l=Uint32Array,c=new a([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),u=new a([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d=new a([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p=function(e,t){for(var n=new s(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new l(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},f=p(c,2),h=f[0],m=f[1];h[28]=258,m[258]=28;for(var g=p(u,0),v=g[0],y=(g[1],new s(32768)),b=0;b<32768;++b){var x=(43690&b)>>>1|(21845&b)<<1;x=(61680&(x=(52428&x)>>>2|(13107&x)<<2))>>>4|(3855&x)<<4,y[b]=((65280&x)>>>8|(255&x)<<8)>>>1}var A=function(e,t,n){for(var r=e.length,i=0,o=new s(t);i<r;++i)e[i]&&++o[e[i]-1];var a,l=new s(t);for(i=0;i<t;++i)l[i]=l[i-1]+o[i-1]<<1;if(n){a=new s(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var u=i<<4|e[i],d=t-e[i],p=l[e[i]-1]++<<d,f=p|(1<<d)-1;p<=f;++p)a[y[p]>>>c]=u}else for(a=new s(r),i=0;i<r;++i)e[i]&&(a[i]=y[l[e[i]-1]++]>>>15-e[i]);return a},C=new a(288);for(b=0;b<144;++b)C[b]=8;for(b=144;b<256;++b)C[b]=9;for(b=256;b<280;++b)C[b]=7;for(b=280;b<288;++b)C[b]=8;var T=new a(32);for(b=0;b<32;++b)T[b]=5;var S=A(C,9,1),w=A(T,5,1),_=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},I=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},E=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},D=function(e){return(e+7)/8|0},O=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(2==e.BYTES_PER_ELEMENT?s:4==e.BYTES_PER_ELEMENT?l:a)(n-t);return r.set(e.subarray(t,n)),r},P=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],R=function(e,t,n){var r=new Error(t||P[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,R),!n)throw r;return r},N=function(e,t,n){var r=e.length;if(!r||n&&n.f&&!n.l)return t||new a(0);var i=!t||n,o=!n||n.i;n||(n={}),t||(t=new a(3*r));var s=function(e){var n=t.length;if(e>n){var r=new a(Math.max(2*n,e));r.set(t),t=r}},l=n.f||0,p=n.p||0,f=n.b||0,m=n.l,g=n.d,y=n.m,b=n.n,x=8*r;do{if(!m){l=I(e,p,1);var C=I(e,p+1,3);if(p+=3,!C){var T=e[(z=D(p)+4)-4]|e[z-3]<<8,P=z+T;if(P>r){o&&R(0);break}i&&s(f+T),t.set(e.subarray(z,P),f),n.b=f+=T,n.p=p=8*P,n.f=l;continue}if(1==C)m=S,g=w,y=9,b=5;else if(2==C){var N=I(e,p,31)+257,M=I(e,p+10,15)+4,L=N+I(e,p+5,31)+1;p+=14;for(var F=new a(L),B=new a(19),V=0;V<M;++V)B[d[V]]=I(e,p+3*V,7);p+=3*M;var k=_(B),U=(1<<k)-1,G=A(B,k,1);for(V=0;V<L;){var z,W=G[I(e,p,U)];if(p+=15&W,(z=W>>>4)<16)F[V++]=z;else{var j=0,H=0;for(16==z?(H=3+I(e,p,3),p+=2,j=F[V-1]):17==z?(H=3+I(e,p,7),p+=3):18==z&&(H=11+I(e,p,127),p+=7);H--;)F[V++]=j}}var K=F.subarray(0,N),q=F.subarray(N);y=_(K),b=_(q),m=A(K,y,1),g=A(q,b,1)}else R(1);if(p>x){o&&R(0);break}}i&&s(f+131072);for(var $=(1<<y)-1,X=(1<<b)-1,Y=p;;Y=p){var J=(j=m[E(e,p)&$])>>>4;if((p+=15&j)>x){o&&R(0);break}if(j||R(2),J<256)t[f++]=J;else{if(256==J){Y=p,m=null;break}var Z=J-254;if(J>264){var Q=c[V=J-257];Z=I(e,p,(1<<Q)-1)+h[V],p+=Q}var ee=g[E(e,p)&X],te=ee>>>4;ee||R(3),p+=15&ee;q=v[te];if(te>3){Q=u[te];q+=E(e,p)&(1<<Q)-1,p+=Q}if(p>x){o&&R(0);break}i&&s(f+131072);for(var ne=f+Z;f<ne;f+=4)t[f]=t[f-q],t[f+1]=t[f+1-q],t[f+2]=t[f+2-q],t[f+3]=t[f+3-q];f=ne}}n.l=m,n.p=Y,n.b=f,n.f=l,m&&(l=1,n.m=y,n.d=g,n.n=b)}while(!l);return f==t.length?t:O(t,0,f)},M=new a(0),L=function(e){31==e[0]&&139==e[1]&&8==e[2]||R(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=e[10]|2+(e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},F=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},B=function(e){(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)&&R(6,"invalid zlib data"),32&e[1]&&R(6,"invalid zlib data: preset dictionaries not supported")};function V(e,t){return N(e,t)}function k(e,t){return N(e.subarray(L(e),-8),t||new a(F(e)))}function U(e,t){return N((B(e),e.subarray(2,-4)),t)}var G="undefined"!=typeof TextDecoder&&new TextDecoder;try{G.decode(M,{stream:!0}),1}catch(e){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var z=n(8906);const W=[];W["-".charCodeAt(0)]=62,W["_".charCodeAt(0)]=63;const j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let e=0;e<j.length;e++)W[j.charCodeAt(e)]=e;function H(e){return void 0!==W[e.charCodeAt(0)]}function K(e,t,n,r){const{start:i,count:o}=t,a=o%4,s=Math.floor(o/4);let l=i,c=null,u=n;for(let t=0;t<s;t++){for(;!H(e[l]);)l++;for(c=W[e.charCodeAt(l++)]<<18;!H(e[l]);)l++;for(c|=W[e.charCodeAt(l++)]<<12;!H(e[l]);)l++;for(c|=W[e.charCodeAt(l++)]<<6;!H(e[l]);)l++;c|=W[e.charCodeAt(l++)],r[u++]=c>>16&255,r[u++]=c>>8&255,r[u++]=255&c}switch(a){case 3:for(;!H(e[l]);)l++;for(c=W[e.charCodeAt(l++)]<<10;!H(e[l]);)l++;for(c|=W[e.charCodeAt(l++)]<<4;!H(e[l]);)l++;c|=W[e.charCodeAt(l++)]>>2,r[u++]=c>>8&255,r[u++]=255&c;break;case 2:for(;!H(e[l]);)l++;for(c=W[e.charCodeAt(l++)]<<2;!H(e[l]);)l++;c|=W[e.charCodeAt(l++)]>>4,r[u++]=255&c;break;case 1:throw new Error("BASE64: remain 1 should not happen")}return u}function q(e,t,n){const r=(e<<16)+(t<<8)+n;return j[r>>18]+j[r>>12&63]+j[r>>6&63]+j[63&r]}var $={toArrayBuffer:function(e){const t=function(e){const t=e.length,n=[];let r=null;for(let i=0;i<t;i++)H(e[i])?(r||(r={start:i,count:0}),r.count++,r.end=i):"="===e[i]&&r&&(n.push(r),r=null);return r&&n.push(r),n}(e),n=t[t.length-1].end+1,r=(4-n%4)%4,i=new ArrayBuffer(3*(n+r)/4-r),o=new Uint8Array(i);let a=0;for(let n=0;n<t.length;n++)a+=K(e,t[n],a,o),a+=(4-t[n].count%4)%4;return i},fromArrayBuffer:function(e){const t=new Uint8Array(e),n=e.byteLength%3,r=e.byteLength-n,i=Array(r/3);for(let e=0;e<i.length;e++){const n=3*e;i[e]=q(t[n],t[n+1],t[n+2])}if(n>0){const e=q(t[r],t[r+1]||0,t[r+2]||0);1===n?i.push(`${e.substr(0,2)}==`):2===n&&i.push(`${e.substr(0,3)}=`)}return i.join("")}},X=n(42008);const Y={name:"",numberOfComponents:1,size:0,dataType:"string"};function J(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Object.assign(t,Y,n),!t.empty&&!t.values&&!t.size)throw new TypeError("Cannot create vtkStringArray object without: size > 0, values");t.values?Array.isArray(t.values)&&(t.values=[...t.values]):t.values=[],t.values&&(t.size=t.values.length),r.m.obj(e,t),r.m.set(e,t,["name"]),function(e,t){t.classHierarchy.push("vtkStringArray"),e.getComponent=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.values[e*t.numberOfComponents+n]},e.setComponent=(n,r,i)=>{i!==t.values[n*t.numberOfComponents+r]&&(t.values[n*t.numberOfComponents+r]=i,e.modified())},e.getData=()=>t.values,e.getTuple=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=t.numberOfComponents||1;n.length&&(n.length=r);const i=e*r;for(let e=0;e<r;e++)n[e]=t.values[i+e];return n},e.getTupleLocation=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)*t.numberOfComponents},e.getNumberOfComponents=()=>t.numberOfComponents,e.getNumberOfValues=()=>t.values.length,e.getNumberOfTuples=()=>t.values.length/t.numberOfComponents,e.getDataType=()=>t.dataType,e.newClone=()=>Z({name:t.name,numberOfComponents:t.numberOfComponents,empty:!0}),e.getName=()=>(t.name||e.setName(`vtkStringArray${e.getMTime()}`),t.name),e.setData=(n,r)=>{t.values=n,t.size=n.length,r&&(t.numberOfComponents=r),t.size%t.numberOfComponents!=0&&(t.numberOfComponents=1),e.modified()}}(e,t)}const Z=r.m.newInstance(J,"vtkStringArray");var Q={newInstance:Z,extend:J},ee=n(56413);n(67313);function te(e,t){return function(e,t){return[...e.getElementsByTagName(t)]}(e,t)[0]}const ne={Int8:Int8Array,UInt8:Uint8Array,Int16:Int16Array,UInt16:Uint16Array,Int32:Int32Array,UInt32:Uint32Array,Int64:Int32Array,UInt64:Uint32Array,Float32:Float32Array,Float64:Float64Array},re={Int8:1,UInt8:1,Int16:2,UInt16:2,Int32:4,UInt32:4,Int64:8,UInt64:8,Float32:4,Float64:8};function ie(e){const t=e.length-1;return e.filter(((e,n)=>n<t&&n%2==0))}function oe(e,t,n){if(!["UInt64","UInt32"].includes(n))throw new Error(`Cannot handle a header type of ${n}`);let r=ne[n],i=ne[t],o=!1;"UInt64"===n&&(r=ne.UInt32),/^U?Int64$/.test(t)&&(o=!0,i=ne[t.replace("64","32")]);const{byteOffset:a}=e,s=re[t],l=re[n];let c;c=a%l==0?new r(e.buffer,a,1):new r(e.buffer.slice(a,a+l));const u=Number(c[0]);let d,p=u/s;o&&(p*=2);const f=a+l;return d=f%s==0?new i(e.buffer,f,p):new i(e.buffer.slice(f,f+u)),o&&(d=ie(d)),d}function ae(e,t){const n=31==(r=e)[0]&&139==r[1]&&8==r[2]?k(r,i):8!=(15&r[0])||r[0]>>4>7||(r[0]<<8|r[1])%31?V(r,i):U(r,i);var r,i;t.uint8.set(n,t.offset),t.offset+=n.length}function se(e,t){const n=function(e,t){if("UInt64"===t){const t=8;let n=new Uint32Array(e.buffer,0,6);const r=n[0],i=[t,r,n[2],n[4]];n=new Uint32Array(e.buffer,24,2*r);for(let e=0;e<r;e++)i.push(n[2*e]);return i}let n=new Uint32Array(e.buffer,0,3);const r=n[0],i=[4,r,n[1],n[2]];n=new Uint32Array(e.buffer,12,r);for(let e=0;e<r;e++)i.push(n[e]);return i}(e,t),r=n[1],i=n[2],o=n[3];let a=0;r>0&&(a=0===o?r*i:(r-1)*i+o);const s=new ArrayBuffer(a),l={offset:0,uint8:new Uint8Array(s)};let c=function(e,t){const[n]=e;return(e.length-1)*n}(n);for(;c<e.length&&120!==e[c];)c++;for(let t=0;t<r;t++){const r=n[4+t];ae(new Uint8Array(e.buffer,c,r),l),c+=r}return l.uint8}function le(e,t,n,r,i,o){const a=t.getAttribute("type"),s=t.getAttribute("Name"),l=t.getAttribute("format"),c=Number(t.getAttribute("NumberOfComponents")||"1");let u=null;if("ascii"===l){u=new ne[a](e*c);let n=0;t.firstChild.nodeValue.split(/[\\t \\n]+/).forEach((e=>{e.trim().length&&(u[n++]=Number(e))}))}else if("binary"===l){const e=new Uint8Array($.toArrayBuffer(t.firstChild.nodeValue.trim()));if("vtkZLibDataCompressor"===n){const t=se(e,i);u=new ne[a](t.buffer),/^U?Int64$/.test(a)&&(u=ie(u))}else u=new ne[a](e.buffer,re[i]),-1!==a.indexOf("Int64")&&(u=ie(u))}else if("appended"===l){const e=Number(t.getAttribute("offset"));u=oe(new Uint8Array(o,e),a,i)}else console.error("Format not supported",l);return{name:s,values:u,numberOfComponents:c}}function ce(e){return(new TextDecoder).decode(e).split("\0").slice(0,-1)}function ue(e,t,n,i,o){const a=[...e.getElementsByTagName("DataArray")].map((e=>X.Ay.newInstance(le(Number(e.getAttribute("NumberOfTuples")),e,t,0,i,o)))),s=[...e.getElementsByTagName("Array")].filter((e=>"String"===e.getAttribute("type"))).map((e=>{const n=Q.newInstance(function(e,t,n,i,o){const a=e.getAttribute("Name"),s=e.getAttribute("format"),l=Number(e.getAttribute("NumberOfComponents")||"1"),c=Number(e.getAttribute("NumberOfTuples")||"1")*l,u=[];if("ascii"===s){const t=e.firstChild.nodeValue.trim().split(/\s+/);let n=0;const r=[];for(;u.length<c;){const e=Number(t[n++]);0===e?(u.push(r.join("")),r.length=0):r.push(String.fromCharCode(e))}}else if("binary"===s){const n=new Uint8Array($.toArrayBuffer(e.firstChild.nodeValue.trim()));if("vtkZLibDataCompressor"===t){const e=se(n,i);u.push(...ce(e))}else{const e=oe(n,"UInt8",i);u.push(...ce(e))}}else if("appended"===s){const t=Number(e.getAttribute("offset")),n=oe(new Uint8Array(o,t),"UInt8",i);u.push(...ce(n))}else r.m.vtkErrorMacro(`Format not supported: ${s}`);return{name:a,values:u,numberOfComponents:l}}(e,t,0,i,o));return n}));return[...a,...s]}function de(e,t){t.classHierarchy.push("vtkXMLReader"),t.dataAccessHelper||(t.dataAccessHelper=z.Ay.get("http")),e.setUrl=function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.url=n;const i=n.split("/");return i.pop(),t.baseURL=i.join("/"),e.loadData(r)},e.loadData=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.dataAccessHelper.fetchBinary(e,n)}(t.url,n).then(e.parseAsArrayBuffer)},e.parseAsArrayBuffer=n=>{if(!n)return!1;if(n===t.rawDataBuffer)return!0;e.modified();const{text:r,binaryBuffer:i}=(a=n,ee.A.extractBinary(a,/^\s*<AppendedData\s+encoding="raw">\s*_/m,/\n\s*<\/AppendedData>/m));var a;t.rawDataBuffer=n,t.binaryBuffer=i;var s;const l=(s=r,(0,o.create)(s)).root(),c=l.node,u=c.getAttribute("type"),d=c.getAttribute("compressor"),p=c.getAttribute("byte_order"),f=c.getAttribute("header_type")||"UInt32";if(d&&"vtkZLibDataCompressor"!==d)return console.error("Invalid compressor",d),!1;if(p&&"LittleEndian"!==p)return console.error("Only LittleEndian encoding is supported"),!1;if(u!==t.dataType)return console.error("Invalid data type",u,"expecting",t.dataType),!1;if(te(c,"AppendedData")){const e=te(c,"AppendedData"),n=e.getAttribute("encoding"),r=l.filter((e=>{const{node:t}=e;return t.nodeType===Node.ELEMENT_NODE&&"appended"===t.getAttribute("format")&&t.hasAttribute("offset")}),!1,!0).map((e=>({node:e.node,offset:Number(e.node.getAttribute("offset"))})));r.sort(((e,t)=>e.offset-t.offset));let i=t.binaryBuffer;"base64"===n&&(i=e.textContent.trim().substr(1));const o=[];for(let e=0;e<r.length;++e){const t=r[e].offset;let a=0;a=e===r.length-1?i.length||i.byteLength:r[e+1].offset,"base64"===n?o.push(new Uint8Array($.toArrayBuffer(i.substring(t,a)))):o.push(new Uint8Array(i.slice(t,a)))}if("vtkZLibDataCompressor"===d)for(let e=0;e<o.length;++e){const t=se(o[e],f),n=new Uint8Array(t.length+re[f]);new ne[f](n.buffer,0,1)[0]=t.length,n.set(t,re[f]),o[e]=n}const a=o.reduce(((e,t)=>e+t.length),0),s=new ArrayBuffer(a),u=new Uint8Array(s);for(let e=0,t=0;e<o.length;++e)r[e].node.setAttribute("offset",t),u.set(o[e],t),t+=o[e].length;if(t.binaryBuffer=s,!t.binaryBuffer)return console.error("Processing appended data format: requires binaryBuffer to parse"),!1}e.parseXML(c,u,d,p,f);const h=c.getElementsByTagName(u)[0].getElementsByTagName("FieldData")[0];if(h){const e=ue(h,d,0,f,t.binaryBuffer);for(let n=0;n<t.output.length;n++){const r=t.output[n].getFieldData();for(let t=0;t<e.length;t++)r.addArray(e[t])}}return!0},e.requestData=(n,r)=>{e.parseAsArrayBuffer(t.rawDataBuffer)}}const pe={};var fe={extend:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,pe,n),r.m.obj(e,t),r.m.get(e,t,["url","baseURL"]),r.m.setGet(e,t,["dataAccessHelper"]),r.m.algo(e,t,0,1),de(e,t)},processDataArray:le,processFieldData:function(e,t,n,r,i,o,a){if(t){const i={};["Scalars","Vectors","Normals","Tensors","TCoords"].forEach((e=>{const r=t.getAttribute(e);r&&(i[r]=n[`set${e}`])}));const s=t.getElementsByTagName("DataArray"),l=s.length;for(let t=0;t<l;t++){const l=s[t],c=X.Ay.newInstance(le(e,l,r,0,o,a)),u=c.getName();(i[u]||n.addArray)(c)}}},processCells:function(e,t,n,r,i,o){const a={},s=t.getElementsByTagName("DataArray");for(let e=0;e<s.length;e++){const t=s[e];a[t.getAttribute("Name")]=t}const l=le(e,a.offsets,n,0,i,o).values,c=l[l.length-1],u=le(c,a.connectivity,n,0,i,o).values,d=new Uint32Array(e+c);let p=0,f=0;return l.forEach((e=>{const t=e-f;d[p++]=t;for(let e=0;e<t;e++)d[p++]=u[f+e];f=e})),d}};function he(e,t,n,r,i,o,a){const s=Number(n.getAttribute(`NumberOf${t}`));if(s>0){const l=n.getElementsByTagName(t)[0].getElementsByTagName("DataArray")[0],{values:c,numberOfComponents:u}=fe.processDataArray(s,l,r,i,o,a);e[`get${t}`]().setData(c,u)}return s}function me(e,t,n,r,i,o,a){const s=Number(n.getAttribute(`NumberOf${t}`));if(s>0){const l=fe.processCells(s,n.getElementsByTagName(t)[0],r,i,o,a);e[`get${t}`]().setData(l)}return s}const ge={dataType:"PolyData"};function ve(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,ge,n),fe.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkXMLPolyDataReader"),e.parseXML=(e,n,r,o,a)=>{const s=e.getElementsByTagName(t.dataType)[0].getElementsByTagName("Piece"),l=s.length;for(let e=0;e<l;e++){const n=i.Ay.newInstance(),l=s[e],c=he(n,"Points",l,r,o,a,t.binaryBuffer);let u=0;["Verts","Lines","Strips","Polys"].forEach((e=>{u+=me(n,e,l,r,o,a,t.binaryBuffer)})),fe.processFieldData(c,l.getElementsByTagName("PointData")[0],n.getPointData(),r,o,a,t.binaryBuffer),fe.processFieldData(u,l.getElementsByTagName("CellData")[0],n.getCellData(),r,o,a,t.binaryBuffer),t.output[e]=n}}}(e,t)}var ye={newInstance:r.m.newInstance(ve,"vtkXMLPolyDataReader"),extend:ve}},85311:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(28906);const i={clippingPlanes:[]};var o={extend:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,i,n),r.m.obj(e,t),r.m.algo(e,t,1,0),t.clippingPlanes||(t.clippingPlanes=[]),function(e,t){t.classHierarchy.push("vtkAbstractMapper"),e.update=()=>{e.getInputData()},e.addClippingPlane=n=>!!n.isA("vtkPlane")&&!t.clippingPlanes.includes(n)&&(t.clippingPlanes.push(n),e.modified(),!0),e.getNumberOfClippingPlanes=()=>t.clippingPlanes.length,e.removeAllClippingPlanes=()=>0!==t.clippingPlanes.length&&(t.clippingPlanes.length=0,e.modified(),!0),e.removeClippingPlane=n=>{const r=t.clippingPlanes.indexOf(n);return-1!==r&&(t.clippingPlanes.splice(r,1),e.modified(),!0)},e.getClippingPlanes=()=>t.clippingPlanes,e.setClippingPlanes=t=>{if(t)if(Array.isArray(t)){const n=t.length;for(let r=0;r<n&&r<6;r++)e.addClippingPlane(t[r])}else e.addClippingPlane(t)},e.getClippingPlaneInDataCoords=(e,n,i)=>{const o=t.clippingPlanes,a=e;if(o){const e=o.length;if(n>=0&&n<e){const e=o[n],t=e.getNormal(),r=e.getOrigin(),s=t[0],l=t[1],c=t[2],u=-(s*r[0]+l*r[1]+c*r[2]);return i[0]=s*a[0]+l*a[4]+c*a[8]+u*a[12],i[1]=s*a[1]+l*a[5]+c*a[9]+u*a[13],i[2]=s*a[2]+l*a[6]+c*a[10]+u*a[14],void(i[3]=s*a[3]+l*a[7]+c*a[11]+u*a[15])}}r.m.vtkErrorMacro(`Clipping plane index ${n} is out of range.`)}}(e,t)}}},68076:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(28906),i=n(85311),o=n(21734),a=n(16632);var s={extend:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,(e=>({bounds:[...o.Ay.INIT_BOUNDS],center:[0,0,0],viewSpecificProperties:{},...e}))(n)),i.A.extend(e,t,n),r.m.setGet(e,t,["viewSpecificProperties"]),function(e,t){e.getBounds=()=>(r.m.vtkErrorMacro("vtkAbstractMapper3D.getBounds - NOT IMPLEMENTED"),(0,a.H)()),e.getCenter=()=>{const n=e.getBounds();return t.center=o.Ay.isValid(n)?o.Ay.getCenter(n):null,t.center?.slice()},e.getLength=()=>{const t=e.getBounds();return o.Ay.getDiagonalLength(t)}}(e,t)}}},7019:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>d});var r=n(3823),i=n(28906),o=n(21734),a=n(62502),s=n(89585);const{vtkDebugMacro:l}=i.m;const c={mapper:null,property:null,backfaceProperty:null,forceOpaque:!1,forceTranslucent:!1,bounds:[1,-1,1,-1,1,-1]};function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,c,n),a.Ay.extend(e,t,n),t.boundsMTime={},i.m.obj(t.boundsMTime),i.m.set(e,t,["property"]),i.m.setGet(e,t,["backfaceProperty","forceOpaque","forceTranslucent","mapper"]),function(e,t){t.classHierarchy.push("vtkActor");const n={...e};e.getActors=()=>[e],e.getIsOpaque=()=>{if(t.forceOpaque)return!0;if(t.forceTranslucent)return!1;t.property||e.getProperty();let n=t.property.getOpacity()>=1;return n=n&&(!t.texture||!t.texture.isTranslucent()),n=n&&(!t.mapper||t.mapper.getIsOpaque()),n},e.hasTranslucentPolygonalGeometry=()=>null!==t.mapper&&(null===t.property&&e.setProperty(e.makeProperty()),!e.getIsOpaque()),e.makeProperty=s.Ay.newInstance,e.getProperty=()=>(null===t.property&&(t.property=e.makeProperty()),t.property),e.getBounds=()=>{if(null===t.mapper)return t.bounds;const n=t.mapper.getBounds();if(!n||6!==n.length)return n;if(n[0]>n[1])return t.mapperBounds=n.concat(),t.bounds=[1,-1,1,-1,1,-1],t.boundsMTime.modified(),n;if(!t.mapperBounds||n[0]!==t.mapperBounds[0]||n[1]!==t.mapperBounds[1]||n[2]!==t.mapperBounds[2]||n[3]!==t.mapperBounds[3]||n[4]!==t.mapperBounds[4]||n[5]!==t.mapperBounds[5]||e.getMTime()>t.boundsMTime.getMTime()){l("Recomputing bounds..."),t.mapperBounds=n.concat();const i=[];o.Ay.getCorners(n,i),e.computeMatrix();const a=new Float64Array(16);r.pB.transpose(a,t.matrix),i.forEach((e=>r.eR.transformMat4(e,e,a))),t.bounds[0]=t.bounds[2]=t.bounds[4]=Number.MAX_VALUE,t.bounds[1]=t.bounds[3]=t.bounds[5]=-Number.MAX_VALUE,t.bounds=t.bounds.map(((e,t)=>t%2==0?i.reduce(((e,n)=>e>n[t/2]?n[t/2]:e),e):i.reduce(((e,n)=>e<n[(t-1)/2]?n[(t-1)/2]:e),e))),t.boundsMTime.modified()}return t.bounds},e.getMTime=()=>{let e=n.getMTime();if(null!==t.property){const n=t.property.getMTime();e=n>e?n:e}if(null!==t.backfaceProperty){const n=t.backfaceProperty.getMTime();e=n>e?n:e}return e},e.getRedrawMTime=()=>{let e=t.mtime;if(null!==t.mapper){let n=t.mapper.getMTime();e=n>e?n:e,null!==t.mapper.getInput()&&(t.mapper.getInputAlgorithm().update(),n=t.mapper.getInput().getMTime(),e=n>e?n:e)}return e},e.getSupportsSelection=()=>!!t.mapper&&t.mapper.getSupportsSelection(),e.processSelectorPixelBuffers=(e,n)=>{t.mapper&&t.mapper.processSelectorPixelBuffers&&t.mapper.processSelectorPixelBuffers(e,n)}}(e,t)}var d={newInstance:i.m.newInstance(u,"vtkActor"),extend:u}},26719:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var r=n(3823),i=n(28906),o=n(16632);const{vtkDebugMacro:a}=i.m;const s={position:[0,0,1],focalPoint:[0,0,0],viewUp:[0,1,0],directionOfProjection:[0,0,-1],parallelProjection:!1,useHorizontalViewAngle:!1,viewAngle:30,parallelScale:1,clippingRange:[.01,1000.01],windowCenter:[0,0],viewPlaneNormal:[0,0,1],useOffAxisProjection:!1,screenBottomLeft:[-.5,-.5,-.5],screenBottomRight:[.5,-.5,-.5],screenTopRight:[.5,.5,-.5],freezeFocalPoint:!1,projectionMatrix:null,viewMatrix:null,cameraLightTransform:r.pB.create(),physicalTranslation:[0,0,0],physicalScale:1,physicalViewUp:[0,1,0],physicalViewNorth:[0,0,-1]};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),i.m.obj(e,t),i.m.get(e,t,["distance"]),i.m.setGet(e,t,["parallelProjection","useHorizontalViewAngle","viewAngle","parallelScale","useOffAxisProjection","freezeFocalPoint","physicalScale"]),i.m.getArray(e,t,["directionOfProjection","viewPlaneNormal","position","focalPoint"]),i.m.setGetArray(e,t,["clippingRange","windowCenter"],2),i.m.setGetArray(e,t,["viewUp","screenBottomLeft","screenBottomRight","screenTopRight","physicalTranslation","physicalViewUp","physicalViewNorth"],3),function(e,t){t.classHierarchy.push("vtkCamera");const n=new Float64Array(3),i=new Float64Array([0,0,-1]),s=new Float64Array([0,1,0]),l=r.pB.identity(new Float64Array(16)),c=r.pB.identity(new Float64Array(16)),u=new Float64Array(3),d=new Float64Array(3),p=new Float64Array(3),f=r.pB.identity(new Float64Array(16)),h=r.pB.identity(new Float64Array(16)),m=new Float64Array(3),g=new Float64Array(3);function v(){t.viewPlaneNormal[0]=-t.directionOfProjection[0],t.viewPlaneNormal[1]=-t.directionOfProjection[1],t.viewPlaneNormal[2]=-t.directionOfProjection[2]}e.orthogonalizeViewUp=()=>{const n=e.getViewMatrix();t.viewUp[0]=n[4],t.viewUp[1]=n[5],t.viewUp[2]=n[6],e.modified()},e.setPosition=(n,r,i)=>{n===t.position[0]&&r===t.position[1]&&i===t.position[2]||(t.position[0]=n,t.position[1]=r,t.position[2]=i,e.computeDistance(),e.modified())},e.setFocalPoint=(n,r,i)=>{n===t.focalPoint[0]&&r===t.focalPoint[1]&&i===t.focalPoint[2]||(t.focalPoint[0]=n,t.focalPoint[1]=r,t.focalPoint[2]=i,e.computeDistance(),e.modified())},e.setDistance=n=>{if(t.distance===n)return;t.distance=n,t.distance<1e-20&&(t.distance=1e-20,a("Distance is set to minimum."));const r=t.directionOfProjection;t.focalPoint[0]=t.position[0]+r[0]*t.distance,t.focalPoint[1]=t.position[1]+r[1]*t.distance,t.focalPoint[2]=t.position[2]+r[2]*t.distance,e.modified()},e.computeDistance=()=>{const e=t.focalPoint[0]-t.position[0],n=t.focalPoint[1]-t.position[1],r=t.focalPoint[2]-t.position[2];if(t.distance=Math.sqrt(e*e+n*n+r*r),t.distance<1e-20){t.distance=1e-20,a("Distance is set to minimum.");const e=t.directionOfProjection;t.focalPoint[0]=t.position[0]+e[0]*t.distance,t.focalPoint[1]=t.position[1]+e[1]*t.distance,t.focalPoint[2]=t.position[2]+e[2]*t.distance}t.directionOfProjection[0]=e/t.distance,t.directionOfProjection[1]=n/t.distance,t.directionOfProjection[2]=r/t.distance,v()},e.dolly=n=>{if(n<=0)return;const r=t.distance/n;e.setPosition(t.focalPoint[0]-r*t.directionOfProjection[0],t.focalPoint[1]-r*t.directionOfProjection[1],t.focalPoint[2]-r*t.directionOfProjection[2])},e.roll=n=>{const i=t.position,a=t.focalPoint,s=t.viewUp,l=new Float64Array([s[0],s[1],s[2],0]);r.pB.identity(f);const c=new Float64Array([a[0]-i[0],a[1]-i[1],a[2]-i[2]]);r.pB.rotate(f,f,(0,o.r)(n),c),r.ln.transformMat4(l,l,f),t.viewUp[0]=l[0],t.viewUp[1]=l[1],t.viewUp[2]=l[2],e.modified()},e.azimuth=n=>{const i=t.focalPoint;r.pB.identity(h),r.pB.translate(h,h,i),r.pB.rotate(h,h,(0,o.r)(n),t.viewUp),r.pB.translate(h,h,[-i[0],-i[1],-i[2]]),r.eR.transformMat4(m,t.position,h),e.setPosition(m[0],m[1],m[2])},e.yaw=n=>{const i=t.position;r.pB.identity(h),r.pB.translate(h,h,i),r.pB.rotate(h,h,(0,o.r)(n),t.viewUp),r.pB.translate(h,h,[-i[0],-i[1],-i[2]]),r.eR.transformMat4(g,t.focalPoint,h),e.setFocalPoint(g[0],g[1],g[2])},e.elevation=n=>{const i=t.focalPoint,a=e.getViewMatrix(),s=[-a[0],-a[1],-a[2]];r.pB.identity(h),r.pB.translate(h,h,i),r.pB.rotate(h,h,(0,o.r)(n),s),r.pB.translate(h,h,[-i[0],-i[1],-i[2]]),r.eR.transformMat4(m,t.position,h),e.setPosition(m[0],m[1],m[2])},e.pitch=n=>{const i=t.position,a=e.getViewMatrix(),s=[a[0],a[1],a[2]];r.pB.identity(h),r.pB.translate(h,h,i),r.pB.rotate(h,h,(0,o.r)(n),s),r.pB.translate(h,h,[-i[0],-i[1],-i[2]]),r.eR.transformMat4(g,t.focalPoint,h),e.setFocalPoint(...g)},e.zoom=n=>{n<=0||(t.parallelProjection?t.parallelScale/=n:t.viewAngle/=n,e.modified())},e.translate=(n,r,i)=>{const a=[n,r,i];(0,o.k)(t.position,a,t.position),(0,o.k)(t.focalPoint,a,t.focalPoint),e.computeDistance(),e.modified()},e.applyTransform=n=>{const i=[...t.viewUp,1],o=[],a=[],s=[];i[0]+=t.position[0],i[1]+=t.position[1],i[2]+=t.position[2],r.ln.transformMat4(o,[...t.position,1],n),r.ln.transformMat4(a,[...t.focalPoint,1],n),r.ln.transformMat4(s,i,n),s[0]-=o[0],s[1]-=o[1],s[2]-=o[2],e.setPosition(...o.slice(0,3)),e.setFocalPoint(...a.slice(0,3)),e.setViewUp(...s.slice(0,3))},e.getThickness=()=>t.clippingRange[1]-t.clippingRange[0],e.setThickness=n=>{let r=n;r<1e-20&&(r=1e-20,a("Thickness is set to minimum.")),e.setClippingRange(t.clippingRange[0],t.clippingRange[0]+r)},e.setThicknessFromFocalPoint=n=>{let r=n;r<1e-20&&(r=1e-20,a("Thickness is set to minimum.")),e.setClippingRange(t.distance-r/2,t.distance+r/2)},e.setRoll=e=>{},e.getRoll=()=>{},e.setObliqueAngles=(e,t)=>{},e.getOrientation=()=>{},e.getOrientationWXYZ=()=>{},e.getFrustumPlanes=e=>{},e.getCameraLightTransformMatrix=e=>(r.pB.copy(e,t.cameraLightTransform),e),e.computeCameraLightTransform=()=>{r.pB.copy(l,e.getViewMatrix()),r.pB.invert(l,l),r.pB.fromScaling(c,[t.distance,t.distance,t.distance]),r.pB.multiply(l,l,c),r.pB.identity(t.cameraLightTransform),r.pB.translate(t.cameraLightTransform,l,[0,0,-1])},e.deepCopy=e=>{},e.physicalOrientationToWorldDirection=e=>{const t=r.Yu.fromValues(e[0],e[1],e[2],e[3]),n=r.Yu.create(),i=r.Yu.fromValues(0,0,1,0);return r.Yu.conjugate(n,t),r.Yu.multiply(i,t,i),r.Yu.multiply(i,i,n),[i[0],i[1],i[2]]},e.getPhysicalToWorldMatrix=t=>{e.getWorldToPhysicalMatrix(t),r.pB.invert(t,t)},e.getWorldToPhysicalMatrix=e=>{r.pB.identity(e);const n=[3];(0,o.j)(t.physicalViewNorth,t.physicalViewUp,n),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[4]=t.physicalViewUp[0],e[5]=t.physicalViewUp[1],e[6]=t.physicalViewUp[2],e[8]=-t.physicalViewNorth[0],e[9]=-t.physicalViewNorth[1],e[10]=-t.physicalViewNorth[2],r.pB.transpose(e,e),r.eR.set(u,1/t.physicalScale,1/t.physicalScale,1/t.physicalScale),r.pB.scale(e,e,u),r.pB.translate(e,e,t.physicalTranslation)},e.computeViewParametersFromViewMatrix=o=>{r.pB.invert(l,o),r.eR.transformMat4(u,n,l),e.computeDistance();const a=t.distance;e.setPosition(u[0],u[1],u[2]),r.eR.transformMat4(d,i,l),r.eR.subtract(d,d,u),r.eR.normalize(d,d),e.setDirectionOfProjection(d[0],d[1],d[2]),r.eR.transformMat4(p,s,l),r.eR.subtract(p,p,u),r.eR.normalize(p,p),e.setViewUp(p[0],p[1],p[2]),e.setDistance(a)},e.computeViewParametersFromPhysicalMatrix=t=>{e.getWorldToPhysicalMatrix(l),r.pB.multiply(l,t,l),e.computeViewParametersFromViewMatrix(l)},e.setViewMatrix=n=>{t.viewMatrix=n,t.viewMatrix&&(r.pB.copy(l,t.viewMatrix),e.computeViewParametersFromViewMatrix(l),r.pB.transpose(t.viewMatrix,t.viewMatrix))},e.getViewMatrix=()=>{if(t.viewMatrix)return t.viewMatrix;r.pB.lookAt(l,t.position,t.focalPoint,t.viewUp),r.pB.transpose(l,l);const e=new Float64Array(16);return r.pB.copy(e,l),e},e.setProjectionMatrix=e=>{t.projectionMatrix=e},e.getProjectionMatrix=(e,n,i)=>{const a=new Float64Array(16);if(r.pB.identity(a),t.projectionMatrix){const e=1/t.physicalScale;return r.eR.set(u,e,e,e),r.pB.copy(a,t.projectionMatrix),r.pB.scale(a,a,u),r.pB.transpose(a,a),a}r.pB.identity(l);const s=t.clippingRange[1]-t.clippingRange[0],c=[t.clippingRange[0]+(n+1)*s/2,t.clippingRange[0]+(i+1)*s/2];if(t.parallelProjection){const n=t.parallelScale*e,i=t.parallelScale,o=(t.windowCenter[0]-1)*n,a=(t.windowCenter[0]+1)*n,s=(t.windowCenter[1]-1)*i,u=(t.windowCenter[1]+1)*i;r.pB.ortho(l,o,a,s,u,c[0],c[1]),r.pB.transpose(l,l)}else{if(t.useOffAxisProjection)throw new Error("Off-Axis projection is not supported at this time");{const n=Math.tan((0,o.r)(t.viewAngle)/2);let r,i;!0===t.useHorizontalViewAngle?(r=t.clippingRange[0]*n,i=t.clippingRange[0]*n/e):(r=t.clippingRange[0]*n*e,i=t.clippingRange[0]*n);const a=(t.windowCenter[0]-1)*r,s=(t.windowCenter[0]+1)*r,u=(t.windowCenter[1]-1)*i,d=(t.windowCenter[1]+1)*i,p=c[0],f=c[1];l[0]=2*p/(s-a),l[5]=2*p/(d-u),l[2]=(a+s)/(s-a),l[6]=(u+d)/(d-u),l[10]=-(p+f)/(f-p),l[14]=-1,l[11]=-2*p*f/(f-p),l[15]=0}}return r.pB.copy(a,l),a},e.getCompositeProjectionMatrix=(t,n,i)=>{const o=e.getViewMatrix(),a=e.getProjectionMatrix(t,n,i);return r.pB.multiply(a,o,a),a},e.setDirectionOfProjection=(e,n,r)=>{if(t.directionOfProjection[0]===e&&t.directionOfProjection[1]===n&&t.directionOfProjection[2]===r)return;t.directionOfProjection[0]=e,t.directionOfProjection[1]=n,t.directionOfProjection[2]=r;const i=t.directionOfProjection;t.focalPoint[0]=t.position[0]+i[0]*t.distance,t.focalPoint[1]=t.position[1]+i[1]*t.distance,t.focalPoint[2]=t.position[2]+i[2]*t.distance,v()},e.setDeviceAngles=(n,i,a,s)=>{const l=[3];(0,o.j)(t.physicalViewNorth,t.physicalViewUp,l);const c=r.pB.identity(new Float64Array(16));r.pB.rotate(c,c,(0,o.r)(n),t.physicalViewUp),r.pB.rotate(c,c,(0,o.r)(i),l),r.pB.rotate(c,c,(0,o.r)(a),t.physicalViewNorth),r.pB.rotate(c,c,(0,o.r)(-s),t.physicalViewUp);const u=new Float64Array([-t.physicalViewUp[0],-t.physicalViewUp[1],-t.physicalViewUp[2]]),d=new Float64Array(t.physicalViewNorth);r.eR.transformMat4(u,u,c),r.eR.transformMat4(d,d,c),e.setDirectionOfProjection(u[0],u[1],u[2]),e.setViewUp(d[0],d[1],d[2]),e.modified()},e.setOrientationWXYZ=(t,n,i,a)=>{const s=r.pB.identity(new Float64Array(16));if(0!==t&&(0!==n||0!==i||0!==a)){const e=(0,o.r)(t),l=r.Yu.create();r.Yu.setAxisAngle(l,[n,i,a],e),r.pB.fromQuat(s,l)}const l=new Float64Array(3);r.eR.transformMat4(l,[0,0,-1],s);const c=new Float64Array(3);r.eR.transformMat4(c,[0,1,0],s),e.setDirectionOfProjection(...l),e.setViewUp(...c),e.modified()},e.computeClippingRange=e=>{let n=null,r=null;n=t.viewPlaneNormal,r=t.position;const i=-n[0],o=-n[1],a=-n[2],s=-(i*r[0]+o*r[1]+a*r[2]),l=[i*e[0]+o*e[2]+a*e[4]+s,1e-18];for(let t=0;t<2;t++)for(let n=0;n<2;n++)for(let r=0;r<2;r++){const c=i*e[r]+o*e[2+n]+a*e[4+t]+s;l[0]=c<l[0]?c:l[0],l[1]=c>l[1]?c:l[1]}return l}}(e,t)}var c={newInstance:i.m.newInstance(l,"vtkCamera"),extend:l}},33739:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>y});var r=n(28906),i=n(16632),o=n(80993);var a={ColorSpace:{RGB:0,HSV:1,LAB:2,DIVERGING:3},Scale:{LINEAR:0,LOG10:1}};const{ColorSpace:s,Scale:l}=a,{ScalarMappingTarget:c}=o.Ay,{vtkDebugMacro:u,vtkErrorMacro:d,vtkWarningMacro:p}=r.m;function f(e,t){const n=e[0],r=e[1],i=e[2],o=Math.sqrt(n*n+r*r+i*i),a=o>.001?Math.acos(n/o):0,s=a>.001?Math.atan2(i,r):0;t[0]=o,t[1]=a,t[2]=s}function h(e,t){if(e[0]>=t-.1)return e[2];const n=e[1]*Math.sqrt(t*t-e[0]*e[0])/(e[0]*Math.sin(e[1]));return e[2]>-.3*Math.PI?e[2]+n:e[2]-n}function m(e,t,n,r){const o=[],a=[];(0,i.N)(t,o),(0,i.N)(n,a);const s=[],l=[];f(o,s),f(a,l);let c=e;if(s[1]>.05&&l[1]>.05&&function(e,t){let n=e-t;for(n<0&&(n=-n);n>=2*Math.PI;)n-=2*Math.PI;return n>Math.PI&&(n=2*Math.PI-n),n}(s[2],l[2])>.33*Math.PI){let t=Math.max(s[0],l[0]);t=Math.max(88,t),e<.5?(l[0]=t,l[1]=0,l[2]=0,c*=2):(s[0]=t,s[1]=0,s[2]=0,c=2*c-1)}s[1]<.05&&l[1]>.05?s[2]=h(l,s[0]):l[1]<.05&&s[1]>.05&&(l[2]=h(s,l[0]));const u=[];u[0]=(1-c)*s[0]+c*l[0],u[1]=(1-c)*s[1]+c*l[1],u[2]=(1-c)*s[2]+c*l[2];const d=[];!function(e,t){const n=e[0],r=e[1],i=e[2];t[0]=n*Math.cos(r),t[1]=n*Math.sin(r)*Math.cos(i),t[2]=n*Math.sin(r)*Math.sin(i)}(u,d),(0,i.O)(d,r)}const g={clamping:!0,colorSpace:s.RGB,hSVWrap:!0,scale:l.LINEAR,nanColor:null,belowRangeColor:null,aboveRangeColor:null,useAboveRangeColor:!1,useBelowRangeColor:!1,allowDuplicateScalars:!1,table:null,tableSize:0,buildTime:null,nodes:null,discretize:!1,numberOfValues:256};function v(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,g,n),o.Ay.extend(e,t,n),t.table=[],t.nodes=[],t.nanColor=[.5,0,0,1],t.belowRangeColor=[0,0,0,1],t.aboveRangeColor=[1,1,1,1],t.buildTime={},r.m.obj(t.buildTime),r.m.get(e,t,["buildTime","mappingRange"]),r.m.setGet(e,t,["useAboveRangeColor","useBelowRangeColor","discretize","numberOfValues",{type:"enum",name:"colorSpace",enum:s},{type:"enum",name:"scale",enum:l}]),r.m.setArray(e,t,["nanColor","belowRangeColor","aboveRangeColor"],4),r.m.getArray(e,t,["nanColor","belowRangeColor","aboveRangeColor"]),function(e,t){t.classHierarchy.push("vtkColorTransferFunction"),e.getSize=()=>t.nodes.length,e.addRGBPoint=(t,n,r,i)=>e.addRGBPointLong(t,n,r,i,.5,0),e.addRGBPointLong=function(n,r,i,o){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(a<0||a>1)return d("Midpoint outside range [0.0, 1.0]"),-1;if(s<0||s>1)return d("Sharpness outside range [0.0, 1.0]"),-1;t.allowDuplicateScalars||e.removePoint(n);const l={x:n,r,g:i,b:o,midpoint:a,sharpness:s};t.nodes.push(l),e.sortAndUpdateRange();let c=0;for(;c<t.nodes.length&&t.nodes[c].x!==n;c++);return c<t.nodes.length?c:-1},e.addHSVPoint=(t,n,r,i)=>e.addHSVPointLong(t,n,r,i,.5,0),e.addHSVPointLong=function(t,n,r,o){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const l=[],c=[n,r,o];return(0,i.h)(c,l),e.addRGBPoint(t,l[0],l[1],l[2],a,s)},e.setNodes=n=>{if(t.nodes!==n){const r=JSON.stringify(t.nodes);t.nodes=n;const i=JSON.stringify(t.nodes);if(e.sortAndUpdateRange()||r!==i)return e.modified(),!0}return!1},e.sortAndUpdateRange=()=>{const n=JSON.stringify(t.nodes);t.nodes.sort(((e,t)=>e.x-t.x));const r=JSON.stringify(t.nodes),i=e.updateRange();return i||n===r?i:(e.modified(),!0)},e.updateRange=()=>{const n=[2];n[0]=t.mappingRange[0],n[1]=t.mappingRange[1];const r=t.nodes.length;return r?(t.mappingRange[0]=t.nodes[0].x,t.mappingRange[1]=t.nodes[r-1].x):(t.mappingRange[0]=0,t.mappingRange[1]=0),(n[0]!==t.mappingRange[0]||n[1]!==t.mappingRange[1])&&(e.modified(),!0)},e.removePoint=n=>{let r=0;for(;r<t.nodes.length&&t.nodes[r].x!==n;r++);const i=r;if(r>=t.nodes.length)return-1;let o=!1;return t.nodes.splice(r,1),0!==r&&r!==t.nodes.length||(o=e.updateRange()),o||e.modified(),i},e.movePoint=(n,r)=>{if(n!==r){e.removePoint(r);for(let i=0;i<t.nodes.length;i++)if(t.nodes[i].x===n){t.nodes[i].x=r,e.sortAndUpdateRange();break}}},e.removeAllPoints=()=>{t.nodes=[],e.sortAndUpdateRange()},e.addRGBSegment=(n,r,i,o,a,s,l,c)=>{e.sortAndUpdateRange();for(let e=0;e<t.nodes.length;)t.nodes[e].x>=n&&t.nodes[e].x<=a?t.nodes.splice(e,1):e++;e.addRGBPointLong(n,r,i,o,.5,0),e.addRGBPointLong(a,s,l,c,.5,0),e.modified()},e.addHSVSegment=(t,n,r,o,a,s,l,c)=>{const u=[n,r,o],d=[s,l,c],p=[],f=[];(0,i.h)(u,p),(0,i.h)(d,f),e.addRGBSegment(t,p[0],p[1],p[2],a,f[0],f[1],f[2])},e.mapValue=t=>{const n=[];return e.getColor(t,n),[Math.floor(255*n[0]+.5),Math.floor(255*n[1]+.5),Math.floor(255*n[2]+.5),255]},e.getColor=(n,r)=>{if(t.indexedLookup){const t=e.getSize(),i=e.getAnnotatedValueIndexInternal(n);if(i<0||0===t){const t=e.getNanColorByReference();r[0]=t[0],r[1]=t[1],r[2]=t[2]}else{const n=[];e.getNodeValue(i%t,n),r[0]=n[1],r[1]=n[2],r[2]=n[3]}}else e.getTable(n,n,1,r)},e.getRedValue=t=>{const n=[];return e.getColor(t,n),n[0]},e.getGreenValue=t=>{const n=[];return e.getColor(t,n),n[1]},e.getBlueValue=t=>{const n=[];return e.getColor(t,n),n[2]},e.getTable=(n,r,o,a)=>{const c=Number(n),u=Number(r);if((0,i.i)(c)||(0,i.i)(u)){for(let e=0;e<o;e++)a[3*e+0]=t.nanColor[0],a[3*e+1]=t.nanColor[1],a[3*e+2]=t.nanColor[2];return}let p=0;const f=t.nodes.length;let h=0,g=0,v=0;0!==f&&(h=t.nodes[f-1].r,g=t.nodes[f-1].g,v=t.nodes[f-1].b);let y=0,b=0,x=0;const A=[0,0,0],C=[0,0,0];let T=0,S=0;const w=[];let _=t.scale===l.LOG10;_&&(_=t.mappingRange[0]>0);let I=0,E=0,D=0;_&&(I=Math.log10(c),E=Math.log10(u));for(let n=0;n<o;n++){const r=3*n;if(o>1?_?(D=I+n/(o-1)*(E-I),y=10**D):y=c+n/(o-1)*(u-c):_?(D=.5*(I+E),y=10**D):y=.5*(c+u),t.discretize){const e=t.mappingRange;if(y>=e[0]&&y<=e[1]){const n=t.numberOfValues,r=e[1]-e[0];if(n<=1)y=e[0]+r/2;else{const t=(y-e[0])/r,o=(0,i.K)(n*t);y=e[0]+o/(n-1)*r}}}for(;p<f&&y>t.nodes[p].x;)p++,p<f&&(b=t.nodes[p-1].x,x=t.nodes[p].x,_&&(b=Math.log10(b),x=Math.log10(x)),A[0]=t.nodes[p-1].r,C[0]=t.nodes[p].r,A[1]=t.nodes[p-1].g,C[1]=t.nodes[p].g,A[2]=t.nodes[p-1].b,C[2]=t.nodes[p].b,T=t.nodes[p-1].midpoint,S=t.nodes[p-1].sharpness,T<1e-5&&(T=1e-5),T>.99999&&(T=.99999));if(y>t.mappingRange[1])a[r]=0,a[r+1]=0,a[r+2]=0,t.clamping&&(e.getUseAboveRangeColor()?(a[r]=t.aboveRangeColor[0],a[r+1]=t.aboveRangeColor[1],a[r+2]=t.aboveRangeColor[2]):(a[r]=h,a[r+1]=g,a[r+2]=v));else if(y<t.mappingRange[0]||(0,i.L)(y)&&y<0)a[r]=0,a[r+1]=0,a[r+2]=0,t.clamping&&(e.getUseBelowRangeColor()?(a[r]=t.belowRangeColor[0],a[r+1]=t.belowRangeColor[1],a[r+2]=t.belowRangeColor[2]):f>0&&(a[r]=t.nodes[0].r,a[r+1]=t.nodes[0].g,a[r+2]=t.nodes[0].b));else if(0===p&&(Math.abs(y-c)<1e-6||t.discretize))f>0?(a[r]=t.nodes[0].r,a[r+1]=t.nodes[0].g,a[r+2]=t.nodes[0].b):(a[r]=0,a[r+1]=0,a[r+2]=0);else{let e=0;if(e=_?(D-b)/(x-b):(y-b)/(x-b),e=e<T?.5*e/T:.5+.5*(e-T)/(1-T),S>.99){if(e<.5){a[r]=A[0],a[r+1]=A[1],a[r+2]=A[2];continue}a[r]=C[0],a[r+1]=C[1],a[r+2]=C[2];continue}if(S<.01){if(t.colorSpace===s.RGB)a[r]=(1-e)*A[0]+e*C[0],a[r+1]=(1-e)*A[1]+e*C[1],a[r+2]=(1-e)*A[2]+e*C[2];else if(t.colorSpace===s.HSV){const n=[],o=[];(0,i.M)(A,n),(0,i.M)(C,o),t.hSVWrap&&(n[0]-o[0]>.5||o[0]-n[0]>.5)&&(n[0]>o[0]?n[0]-=1:o[0]-=1);const s=[];s[0]=(1-e)*n[0]+e*o[0],s[0]<0&&(s[0]+=1),s[1]=(1-e)*n[1]+e*o[1],s[2]=(1-e)*n[2]+e*o[2],(0,i.h)(s,w),a[r]=w[0],a[r+1]=w[1],a[r+2]=w[2]}else if(t.colorSpace===s.LAB){const t=[],n=[];(0,i.N)(A,t),(0,i.N)(C,n);const o=[];o[0]=(1-e)*t[0]+e*n[0],o[1]=(1-e)*t[1]+e*n[1],o[2]=(1-e)*t[2]+e*n[2],(0,i.O)(o,w),a[r]=w[0],a[r+1]=w[1],a[r+2]=w[2]}else t.colorSpace===s.DIVERGING?(m(e,A,C,w),a[r]=w[0],a[r+1]=w[1],a[r+2]=w[2]):d("ColorSpace set to invalid value.",t.colorSpace);continue}e<.5?e=.5*(2*e)**(1+10*S):e>.5&&(e=1-.5*(2*(1-e))**(1+10*S));const n=e*e,o=n*e,l=2*o-3*n+1,c=-2*o+3*n,u=o-2*n+e,p=o-n;let f,h;if(t.colorSpace===s.RGB)for(let e=0;e<3;e++)f=C[e]-A[e],h=(1-S)*f,a[r+e]=l*A[e]+c*C[e]+u*h+p*h;else if(t.colorSpace===s.HSV){const e=[],n=[];(0,i.M)(A,e),(0,i.M)(C,n),t.hSVWrap&&(e[0]-n[0]>.5||n[0]-e[0]>.5)&&(e[0]>n[0]?e[0]-=1:n[0]-=1);const o=[];for(let t=0;t<3;t++)f=n[t]-e[t],h=(1-S)*f,o[t]=l*e[t]+c*n[t]+u*h+p*h,0===t&&o[t]<0&&(o[t]+=1);(0,i.h)(o,w),a[r]=w[0],a[r+1]=w[1],a[r+2]=w[2]}else if(t.colorSpace===s.LAB){const e=[],t=[];(0,i.N)(A,e),(0,i.N)(C,t);const n=[];for(let r=0;r<3;r++)f=t[r]-e[r],h=(1-S)*f,n[r]=l*e[r]+c*t[r]+u*h+p*h;(0,i.O)(n,w),a[r]=w[0],a[r+1]=w[1],a[r+2]=w[2]}else t.colorSpace===s.DIVERGING?(m(e,A,C,w),a[r]=w[0],a[r+1]=w[1],a[r+2]=w[2]):d("ColorSpace set to invalid value.");for(let e=0;e<3;e++)a[r+e]=a[r+e]<0?0:a[r+e],a[r+e]=a[r+e]>1?1:a[r+e]}}},e.getUint8Table=function(n,r,i){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e.getMTime()<=t.buildTime&&t.tableSize===i&&t.tableWithAlpha!==o)return t.table;if(0===t.nodes.length)return d("Attempting to lookup a value with no points in the function"),t.table;const a=o?4:3;t.tableSize===i&&t.tableWithAlpha===o||(t.table=new Uint8Array(i*a),t.tableSize=i,t.tableWithAlpha=o);const s=[];e.getTable(n,r,i,s);for(let e=0;e<i;e++)t.table[e*a+0]=Math.floor(255*s[3*e+0]+.5),t.table[e*a+1]=Math.floor(255*s[3*e+1]+.5),t.table[e*a+2]=Math.floor(255*s[3*e+2]+.5),o&&(t.table[e*a+3]=255);return t.buildTime.modified(),t.table},e.buildFunctionFromArray=n=>{e.removeAllPoints();const r=n.getNumberOfComponents();for(let e=0;e<n.getNumberOfTuples();e++)switch(r){case 3:t.nodes.push({x:e,r:n.getComponent(e,0),g:n.getComponent(e,1),b:n.getComponent(e,2),midpoint:.5,sharpness:0});break;case 4:t.nodes.push({x:n.getComponent(e,0),r:n.getComponent(e,1),g:n.getComponent(e,2),b:n.getComponent(e,3),midpoint:.5,sharpness:0});break;case 5:t.nodes.push({x:e,r:n.getComponent(e,0),g:n.getComponent(e,1),b:n.getComponent(e,2),midpoint:n.getComponent(e,4),sharpness:n.getComponent(e,5)});break;case 6:t.nodes.push({x:n.getComponent(e,0),r:n.getComponent(e,1),g:n.getComponent(e,2),b:n.getComponent(e,3),midpoint:n.getComponent(e,4),sharpness:n.getComponent(e,5)})}e.sortAndUpdateRange()},e.buildFunctionFromTable=(n,r,i,o)=>{let a=0;e.removeAllPoints(),i>1&&(a=(r-n)/(i-1));for(let e=0;e<i;e++){const r={x:n+a*e,r:o[3*e],g:o[3*e+1],b:o[3*e+2],sharpness:0,midpoint:.5};t.nodes.push(r)}e.sortAndUpdateRange()},e.getNodeValue=(e,n)=>e<0||e>=t.nodes.length?(d("Index out of range!"),-1):(n[0]=t.nodes[e].x,n[1]=t.nodes[e].r,n[2]=t.nodes[e].g,n[3]=t.nodes[e].b,n[4]=t.nodes[e].midpoint,n[5]=t.nodes[e].sharpness,1),e.setNodeValue=(n,r)=>{if(n<0||n>=t.nodes.length)return d("Index out of range!"),-1;const i=t.nodes[n].x;return t.nodes[n].x=r[0],t.nodes[n].r=r[1],t.nodes[n].g=r[2],t.nodes[n].b=r[3],t.nodes[n].midpoint=r[4],t.nodes[n].sharpness=r[5],i!==r[0]?e.sortAndUpdateRange():e.modified(),1},e.getNumberOfAvailableColors=()=>{if(t.indexedLookup&&e.getSize())return e.getSize();if(t.tableSize)return t.tableSize;const n=t.nodes?.length??0;return Math.max(4094,n)},e.getIndexedColor=(t,n)=>{const r=e.getSize();if(r>0&&t>=0){const i=[];e.getNodeValue(t%r,i);for(let e=0;e<3;++e)n[e]=i[e+1];return void(n[3]=1)}const i=e.getNanColorByReference();n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=1},e.fillFromDataPointer=(t,n)=>{if(!(t<=0)&&n){e.removeAllPoints();for(let r=0;r<t;r++)e.addRGBPoint(n[4*r],n[4*r+1],n[4*r+2],n[4*r+3])}},e.setMappingRange=(n,r)=>{const i=[n,r],o=e.getRange();if(o[1]===i[1]&&o[0]===i[0])return;if(i[1]===i[0])return void d("attempt to set zero width color range");const a=(i[1]-i[0])/(o[1]-o[0]),s=i[0]-o[0]*a;for(let e=0;e<t.nodes.length;++e)t.nodes[e].x=t.nodes[e].x*a+s;t.mappingRange[0]=i[0],t.mappingRange[1]=i[1],e.modified()},e.adjustRange=n=>{const r=e.getRange(),i=[];r[0]<n[0]?(e.getColor(n[0],i),e.addRGBPoint(n[0],i[0],i[1],i[2])):(e.getColor(r[0],i),e.addRGBPoint(n[0],i[0],i[1],i[2])),r[1]>n[1]?(e.getColor(n[1],i),e.addRGBPoint(n[1],i[0],i[1],i[2])):(e.getColor(r[1],i),e.addRGBPoint(n[1],i[0],i[1],i[2])),e.sortAndUpdateRange();for(let e=0;e<t.nodes.length;)t.nodes[e].x>=n[0]&&t.nodes[e].x<=n[1]?t.nodes.splice(e,1):++e;return 1},e.estimateMinNumberOfSamples=(t,n)=>{const r=e.findMinimumXDistance();return Math.ceil((n-t)/r)},e.findMinimumXDistance=()=>{if(t.nodes.length<2)return-1;let e=Number.MAX_VALUE;for(let n=0;n<t.nodes.length-1;n++){const r=t.nodes[n+1].x-t.nodes[n].x;r<e&&(e=r)}return e},e.mapScalarsThroughTable=(n,r,i,o)=>{0!==e.getSize()?t.indexedLookup?e.mapDataIndexed(n,r,i,o):e.mapData(n,r,i,o):u("Transfer Function Has No Points!")},e.mapData=(t,n,r,i)=>{if(0===e.getSize())return void p("Transfer Function Has No Points!");const o=Math.floor(255*e.getAlpha()+.5),a=t.getNumberOfTuples(),s=t.getNumberOfComponents(),l=n.getData(),u=t.getData(),d=[];if(r===c.RGBA)for(let t=0;t<a;t++){const n=u[t*s+i];e.getColor(n,d),l[4*t]=Math.floor(255*d[0]+.5),l[4*t+1]=Math.floor(255*d[1]+.5),l[4*t+2]=Math.floor(255*d[2]+.5),l[4*t+3]=o}if(r===c.RGB)for(let t=0;t<a;t++){const n=u[t*s+i];e.getColor(n,d),l[3*t]=Math.floor(255*d[0]+.5),l[3*t+1]=Math.floor(255*d[1]+.5),l[3*t+2]=Math.floor(255*d[2]+.5)}if(r===c.LUMINANCE)for(let t=0;t<a;t++){const n=u[t*s+i];e.getColor(n,d),l[t]=Math.floor(76.5*d[0]+150.45*d[1]+28.05*d[2]+.5)}if(r===c.LUMINANCE_ALPHA)for(let t=0;t<a;t++){const n=u[t*s+i];e.getColor(n,d),l[2*t]=Math.floor(76.5*d[0]+150.45*d[1]+28.05*d[2]+.5),l[2*t+1]=o}},e.applyColorMap=n=>{const r=JSON.stringify(t.colorSpace);n.ColorSpace&&(t.colorSpace=s[n.ColorSpace.toUpperCase()],void 0===t.colorSpace&&(d(`ColorSpace ${n.ColorSpace} not supported, using RGB instead`),t.colorSpace=s.RGB));let i=r!==JSON.stringify(t.colorSpace);const o=i||JSON.stringify(t.nanColor);if(n.NanColor)for(t.nanColor=[].concat(n.NanColor);t.nanColor.length<4;)t.nanColor.push(1);i=i||o!==JSON.stringify(t.nanColor);const a=i||JSON.stringify(t.nodes);if(n.RGBPoints){const e=n.RGBPoints.length;t.nodes=[];const r=.5,i=0;for(let o=0;o<e;o+=4)t.nodes.push({x:n.RGBPoints[o],r:n.RGBPoints[o+1],g:n.RGBPoints[o+2],b:n.RGBPoints[o+3],midpoint:r,sharpness:i})}const l=e.sortAndUpdateRange(),c=!l&&(i||a!==JSON.stringify(t.nodes));return c&&e.modified(),l||c}}(e,t)}var y={newInstance:r.m.newInstance(v,"vtkColorTransferFunction"),extend:v,...a}},660:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const r=Object.create(null);[{Name:"KAAMS",IndexedColors:[1,1,1,1,0,0,0,1,0,0,0,1,1,1,0,1,0,1,0,1,1,.63,.63,1,.67,.5,.33,1,.5,.75,.53,.35,.7,1,.75,.5],Annotations:[0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11]},{ColorSpace:"Diverging",Name:"Cool to Warm",NanColor:[1,1,0],RGBPoints:[0,.23137254902,.298039215686,.752941176471,.5,.865,.865,.865,1,.705882352941,.0156862745098,.149019607843]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Cool to Warm (Extended)",NanColor:[.25,0,0],RGBPoints:[0,0,0,.34902,.03125,.039216,.062745,.380392,.0625,.062745,.117647,.411765,.09375,.090196,.184314,.45098,.125,.12549,.262745,.501961,.15625,.160784,.337255,.541176,.1875,.2,.396078,.568627,.21875,.239216,.454902,.6,.25,.286275,.521569,.65098,.28125,.337255,.592157,.701961,.3125,.388235,.654902,.74902,.34375,.466667,.737255,.819608,.375,.572549,.819608,.878431,.40625,.654902,.866667,.909804,.4375,.752941,.917647,.941176,.46875,.823529,.956863,.968627,.5,.988235,.960784,.901961,.5,.941176,.984314,.988235,.52,.988235,.945098,.85098,.54,.980392,.898039,.784314,.5625,.968627,.835294,.698039,.59375,.94902,.733333,.588235,.625,.929412,.65098,.509804,.65625,.909804,.564706,.435294,.6875,.878431,.458824,.352941,.71875,.839216,.388235,.286275,.75,.760784,.294118,.211765,.78125,.701961,.211765,.168627,.8125,.65098,.156863,.129412,.84375,.6,.094118,.094118,.875,.54902,.066667,.098039,.90625,.501961,.05098,.12549,.9375,.45098,.054902,.172549,.96875,.4,.054902,.192157,1,.34902,.070588,.211765]},{ColorSpace:"Diverging",Name:"Warm to Cool",NanColor:[1,1,0],RGBPoints:[0,.705882352941,.0156862745098,.149019607843,.5,.865,.865,.865,1,.23137254902,.298039215686,.752941176471]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Warm to Cool (Extended)",NanColor:[.250004,0,0],RGBPoints:[0,.34902,0,.129412,.025,.4,.00392157,.101961,.05,.470588,.0156863,.0901961,.075,.54902,.027451,.0705882,.1,.619608,.0627451,.0431373,.125,.690196,.12549,.0627451,.15,.741176,.184314,.0745098,.175,.788235,.266667,.0941176,.2,.811765,.345098,.113725,.225,.831373,.411765,.133333,.25,.85098,.47451,.145098,.275,.870588,.54902,.156863,.3,.878431,.619608,.168627,.325,.890196,.658824,.196078,.35,.909804,.717647,.235294,.375,.929412,.776471,.278431,.395522,.94902,.823529,.321569,.418905,.968627,.87451,.407843,.444278,.980392,.917647,.509804,.470149,.988235,.956863,.643137,.483582,.992157,.964706,.713725,.499,.988235,.980392,.870588,.5,1,1,1,.501,.913725,.988235,.937255,.516418,.827451,.980392,.886275,.531343,.764706,.980392,.866667,.546766,.658824,.980392,.843137,.564179,.572549,.964706,.835294,.587562,.423529,.941176,.87451,.60597,.262745,.901961,.862745,.629851,.0705882,.854902,.870588,.651741,.0509804,.8,.85098,.681592,.0235294,.709804,.831373,.712935,.0313725,.615686,.811765,.75,.0313725,.537255,.788235,.775,.0392157,.466667,.768627,.8,.0509804,.396078,.741176,.825,.054902,.317647,.709804,.85,.054902,.243137,.678431,.875,.0431373,.164706,.639216,.9,.0313725,.0980392,.6,.925,.0392157,.0392157,.560784,.95,.105882,.0509804,.509804,.975,.113725,.0235294,.45098,1,.12549,0,.380392]},{ColorSpace:"RGB",Name:"Rainbow Desaturated",NanColor:[1,1,0],RGBPoints:[0,.278431372549,.278431372549,.858823529412,.143,0,0,.360784313725,.285,0,1,1,.429,0,.501960784314,0,.571,1,1,0,.714,1,.380392156863,0,.857,.419607843137,0,0,1,.878431372549,.301960784314,.301960784314]},{ColorSpace:"RGB",Name:"Cold and Hot",NanColor:[1,1,0],RGBPoints:[0,0,1,1,.45,0,0,1,.5,0,0,.501960784314,.55,1,0,0,1,1,1,0]},{ColorSpace:"RGB",Name:"Black-Body Radiation",NanColor:[0,.498039215686,1],RGBPoints:[0,0,0,0,.4,.901960784314,0,0,.8,.901960784314,.901960784314,0,1,1,1,1]},{ColorSpace:"RGB",Name:"X Ray",NanColor:[1,0,0],RGBPoints:[0,1,1,1,1,0,0,0]},{ColorSpace:"RGB",Name:"Grayscale",NanColor:[1,0,0],RGBPoints:[0,0,0,0,1,1,1,1]},{ColorSpace:"RGB",Name:"BkRd",NanColor:[0,1,1],RGBPoints:[0,0,0,0,1,1,0,0]},{ColorSpace:"RGB",Name:"BkGn",NanColor:[1,0,1],RGBPoints:[0,0,0,0,1,0,1,0]},{ColorSpace:"RGB",Name:"BkBu",NanColor:[1,1,0],RGBPoints:[0,0,0,0,1,0,0,1]},{ColorSpace:"RGB",Name:"BkMa",NanColor:[0,1,0],RGBPoints:[0,0,0,0,1,1,0,1]},{ColorSpace:"RGB",Name:"BkCy",NanColor:[0,1,1],RGBPoints:[0,0,0,0,1,0,1,1]},{ColorSpace:"RGB",Name:"Black, Blue and White",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.333,0,0,.501960784314,.666,0,.501960784314,1,1,1,1,1]},{ColorSpace:"RGB",Name:"Black, Orange and White",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.333,.501960784314,0,0,.666,1,.501960784314,0,1,1,1,1]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Linear YGB 1211g",NanColor:[.25,0,0],RGBPoints:[0,1,.988235,.968627,.02,1,.952941,.878431,.05,.968627,.905882,.776471,.1,.94902,.898039,.647059,.15,.901961,.878431,.556863,.2,.847059,.858824,.482353,.25,.690196,.819608,.435294,.3,.513725,.768627,.384314,.35,.337255,.721569,.337255,.4,.278431,.658824,.392157,.45,.231373,.639216,.435294,.5,.203922,.6,.486275,.55,.172549,.568627,.537255,.6,.141176,.517647,.54902,.65,.133333,.458824,.541176,.7,.12549,.396078,.529412,.75,.117647,.321569,.521569,.8,.121569,.258824,.509804,.85,.133333,.227451,.501961,.9,.145098,.192157,.490196,.95,.188235,.164706,.470588,1,.258824,.196078,.439216]},{ColorSpace:"CIELAB",Creator:"Francesca Samsel",Name:"Linear Green (Gr4L)",NanColor:[.25,0,0],RGBPoints:[0,.054902,.109804,.121569,.05,.07451,.172549,.180392,.1,.086275,.231373,.219608,.15,.094118,.278431,.25098,.2,.109804,.34902,.278431,.25,.113725,.4,.278431,.3,.117647,.45098,.270588,.35,.117647,.490196,.243137,.4,.113725,.521569,.203922,.45,.109804,.54902,.152941,.5,.082353,.588235,.082353,.55,.109804,.631373,.05098,.6,.211765,.678431,.082353,.65,.317647,.721569,.113725,.7,.431373,.760784,.160784,.75,.556863,.8,.239216,.8,.666667,.839216,.294118,.85,.784314,.878431,.396078,.9,.886275,.921569,.533333,.95,.960784,.94902,.670588,1,1,.984314,.901961]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Linear Blue (8_31f)",NanColor:[.25,0,0],RGBPoints:[0,.960784,1,.980392,.05,.815686,.960784,.913725,.1,.670588,.929412,.870588,.15,.556863,.901961,.843137,.2,.478431,.870588,.823529,.25,.439216,.831373,.803922,.3,.4,.8,.788235,.35,.376471,.768627,.768627,.4,.34902,.709804,.729412,.45,.32549,.654902,.690196,.5,.301961,.607843,.658824,.55,.247059,.545098,.619608,.6,.239216,.494118,.580392,.65,.227451,.439216,.541176,.7,.227451,.403922,.521569,.75,.231373,.368627,.501961,.8,.227451,.321569,.470588,.85,.219608,.282353,.439216,.9,.192157,.235294,.4,.95,.160784,.184314,.34902,1,.133333,.12549,.301961]},{ColorSpace:"HSV",Name:"Blue to Red Rainbow",NanColor:[.498039215686,.498039215686,.498039215686],RGBPoints:[0,0,0,1,1,1,0,0]},{ColorSpace:"HSV",Name:"Red to Blue Rainbow",NanColor:[.498039215686,.498039215686,.498039215686],RGBPoints:[0,1,0,0,1,0,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended White",NanColor:[1,1,0],RGBPoints:[0,1,1,1,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended Grey",NanColor:[1,1,0],RGBPoints:[0,.317647058824,.341176470588,.43137254902,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Rainbow Blended Black",NanColor:[1,1,0],RGBPoints:[0,0,0,0,.17,0,0,1,.34,0,1,1,.5,0,1,0,.67,1,1,0,.84,1,0,0,1,.878431372549,0,1]},{ColorSpace:"RGB",Name:"Blue to Yellow",NanColor:[1,0,0],RGBPoints:[0,.0392156862745,.0392156862745,.949019607843,1,.949019607843,.949019607843,.0392156862745]},{ColorSpace:"HSV",Name:"blot",RGBPoints:[0,0,0,1,.166,0,0,1,.167,1,0,1,.332,1,0,1,.333,0,1,1,.5,0,1,1,.501,0,1,0,.666,0,1,0,.667,1,1,0,.832,1,1,0,.833,1,0,0,1,1,0,0]},{ColorSpace:"Lab",Name:"CIELab Blue to Red",NanColor:[1,1,0],RGBPoints:[0,0,.6,.749019607843,1,.76862745098,.466666666667,.341176470588]},{ColorSpace:"RGB",Name:"jet",RGBPoints:[-1,0,0,.5625,-.777778,0,0,1,-.269841,0,1,1,-.015873,.5,1,.5,.238095,1,1,0,.746032,1,0,0,1,.5,0,0]},{ColorSpace:"RGB",Name:"rainbow",RGBPoints:[-1,0,0,1,-.5,0,1,1,0,0,1,0,.5,1,1,0,1,1,0,0]},{ColorSpace:"Lab",Name:"erdc_rainbow_bright",RGBPoints:[-1,.32549,.14902,.960784,-.866221,.297047,.375586,.963836,-.732441,.180302,.536818,.964627,-.598662,.1302,.649207,.929647,-.464883,.0445143,.749654,.855998,-.331104,.0271325,.830713,.721527,-.197324,.259504,.866145,.543555,-.0635452,.428364,.890725,.329819,.0702341,.568503,.898508,.187623,.204013,.738259,.890317,.0825461,.337793,.84546,.86136,.0147555,.471572,.912191,.808018,0,.605351,.962848,.710445,0,.73913,.999469,.600258,.0176284,.87291,.994156,.445975,.193912,1,.980407,.247105,.262699]},{ColorSpace:"Lab",Name:"erdc_rainbow_dark",RGBPoints:[-1,0,0,.423499,-.866221,0,.119346,.529237,-.732441,0,.238691,.634976,-.598662,0,.346852,.68788,-.464883,0,.45022,.718141,-.331104,0,.553554,.664839,-.197324,0,.651082,.519303,-.0635452,.115841,.72479,.352857,.0702341,.326771,.781195,.140187,.204013,.522765,.798524,.0284624,.337793,.703162,.788685,.00885756,.471572,.845118,.751133,0,.605351,.955734,.690825,0,.73913,.995402,.567916,.0618524,.87291,.987712,.403398,.164851,1,.980407,.247105,.262699]},{ColorSpace:"Lab",Name:"nic_CubicL",RGBPoints:[-1,.479965,.0118108,.5307,-.87451,.522213,.0551282,.706919,-.74902,.50839,.237278,.867764,-.623529,.451617,.373834,.987255,-.498039,.39365,.497255,.97506,-.372549,.328631,.599639,.891843,-.247059,.250043,.690286,.778553,-.121569,.249656,.764905,.645857,.00392157,.297954,.821466,.50449,.129412,.337509,.872595,.358447,.254902,.430011,.913789,.297079,.380392,.587191,.931381,.333353,.505882,.727937,.93591,.353742,.631373,.826403,.921081,.365066,.756863,.893201,.846317,.372662,.882353,.965347,.73884,.378506,1,.983235,.597451,.366856]},{ColorSpace:"Lab",Name:"nic_CubicYF",RGBPoints:[-1,.5151,.0482,.6697,-.87451,.520711,.168955,.800574,-.74902,.493694,.278596,.911824,-.623529,.440026,.369475,.984978,-.498039,.398932,.457593,.987053,-.372549,.350651,.540644,.929608,-.247059,.298827,.615625,.857729,-.121569,.239928,.685061,.769531,.00392157,.228832,.739349,.673287,.129412,.263297,.78608,.569988,.254902,.298107,.828337,.460214,.380392,.33092,.864071,.352674,.505882,.38306,.898169,.287309,.631373,.49023,.917481,.307961,.756863,.62372,.926026,.332309,.882353,.717458,.92527,.342476,1,.8,.9255,.3529]},{ColorSpace:"Lab",Name:"gist_earth",RGBPoints:[-1,0,0,0,-.87451,.239216,.027451,.415686,-.74902,.0901961,.254902,.556863,-.623529,.0941176,.352941,.54902,-.498039,.105882,.435294,.533333,-.372549,.12549,.52549,.501961,-.247059,.156863,.596078,.443137,-.121569,.196078,.65098,.380392,.00392157,.282353,.717647,.301961,.129412,.466667,.772549,.27451,.254902,.678431,.784314,.309804,.380392,.901961,.756863,.376471,.505882,.992157,.705882,.521569,.631373,1,.721569,.701961,.756863,1,.784314,.784314,.882353,1,.866667,.866667,1,1,1,1]},{ColorSpace:"Lab",Name:"2hot",RGBPoints:[-1,.0416667,0,0,-.873016,.208333,0,0,-.746032,.375,0,0,-.619048,.541667,0,0,-.492063,.708333,0,0,-.365079,.854137,0,0,-.238095,.937488,.039062,0,-.111111,1,.208333,0,.015873,1,.375,0,.142857,1,.541667,0,.269841,1,.708333,0,.396825,1,.858805,.03125,.52381,1,.947392,.15625,.650794,1,1,.3125,.777778,1,1,.5625,.904762,1,1,.8125,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_red2yellow_BW",RGBPoints:[-1,7.54296e-7,0,109827e-10,-.87451,.18285,.0264094,0,-.74902,.3066,0,0,-.623529,.422841,0,0,-.498039,.522945,0,0,-.372549,.605721,0,0,-.247059,.672502,.14168,0,-.121569,.728167,.244025,0,.00392157,.781215,.333454,0,.129412,.825,.423586,0,.254902,.855893,.516793,0,.380392,.880491,.608846,0,.505882,.910305,.695505,0,.631373,.94109,.779067,.223528,.756863,.967873,.858572,.473521,.882353,.986815,.933211,.751583,1,1,1,.999997]},{ColorSpace:"Lab",Name:"erdc_marine2gold_BW",RGBPoints:[-1,1.11641e-7,0,162551e-11,-.87451,.0413146,.0619808,.209857,-.74902,.0185557,.101341,.350684,-.623529,.00486405,.149847,.461054,-.498039,.0836345,.210845,.517906,-.372549,.173222,.276134,.541793,-.247059,.259857,.343877,.535869,-.121569,.362299,.408124,.504293,.00392157,.468266,.468276,.468257,.129412,.582781,.527545,.374914,.254902,.691591,.585251,.274266,.380392,.784454,.645091,.247332,.505882,.862299,.710383,.27518,.631373,.920863,.782923,.351563,.756863,.955792,.859699,.533541,.882353,.976162,.93433,.780671,1,1,1,.999983]},{ColorSpace:"Lab",Name:"erdc_blue2gold_BW",RGBPoints:[-1,0,0,0,-.87451,.0742735,.0440331,.230013,-.74902,.125276,.0258685,.415826,-.623529,.143879,.0163031,.591346,-.498039,.212261,.0627855,.705239,-.372549,.306048,.141178,.763636,-.247059,.391537,.232286,.773263,-.121569,.461734,.336633,.708321,.00392157,.54209,.427581,.590007,.129412,.61704,.508623,.460978,.254902,.702703,.579586,.309117,.380392,.790336,.644811,.170397,.505882,.870173,.710733,.117134,.631373,.93656,.781991,.157144,.756863,.965672,.862068,.409836,.882353,.985751,.936296,.714162,1,1,1,.999999]},{ColorSpace:"Lab",Name:"erdc_sapphire2gold_BW",RGBPoints:[-1,.107704,.107708,.107694,-.87451,.1851,.112354,.308554,-.74902,.236782,.114233,.48788,-.623529,.28296,.126187,.639464,-.498039,.344787,.171643,.739713,-.372549,.413325,.242371,.76913,-.247059,.481863,.3131,.719841,-.121569,.550402,.383829,.612222,.00392157,.61894,.454558,.51126,.129412,.687478,.525287,.39993,.254902,.756017,.596016,.289923,.380392,.824555,.666745,.255498,.505882,.892979,.736822,.27696,.631373,.938851,.804966,.351734,.756863,.966491,.874853,.53572,.882353,.982105,.94153,.782579,1,1,1,.999986]},{ColorSpace:"Lab",Name:"erdc_red2purple_BW",RGBPoints:[-1,0,0,0,-.87451,.167793,.0166271,.0431278,-.74902,.262608,.0107595,.0791181,-.623529,.351902,.0101858,.100926,-.498039,.441257,.0160835,.131919,-.372549,.5221,.0555972,.195625,-.247059,.593852,.104294,.310234,-.121569,.654628,.158115,.448486,.00392157,.707443,.220914,.570253,.129412,.749504,.293268,.67897,.254902,.781587,.370517,.779269,.380392,.809951,.451099,.855831,.505882,.84424,.531462,.900451,.631373,.865174,.620901,.91606,.756863,.875041,.714054,.910284,.882353,.880764,.80554,.896276,1,.887572,.887591,.887556]},{ColorSpace:"Lab",Name:"erdc_purple2pink_BW",RGBPoints:[-1,0,0,0,-.87451,.117562,.0291202,.175876,-.74902,.178368,.0458476,.285454,-.623529,.237731,.0680173,.387717,-.498039,.300877,.0956291,.484802,-.372549,.370929,.136858,.554985,-.247059,.449033,.189273,.58863,-.121569,.529971,.245796,.598587,.00392157,.609914,.300643,.610244,.129412,.697079,.351286,.616371,.254902,.785858,.401991,.617376,.380392,.862517,.45745,.64463,.505882,.91359,.525462,.705336,.631373,.932583,.61064,.767412,.756863,.922478,.706966,.817522,.882353,.901302,.803071,.856311,1,.887571,.887591,.887549]},{ColorSpace:"Lab",Name:"erdc_pbj_lin",RGBPoints:[-1,0,0,0,-.87451,.091821,.0611476,.10617,-.74902,.160311,.0900022,.192713,-.623529,.22484,.12126,.272128,-.498039,.291263,.157469,.340828,-.372549,.360015,.200388,.388903,-.247059,.437497,.250058,.387201,-.121569,.512636,.304969,.355955,.00392157,.582603,.360874,.33488,.129412,.655126,.416374,.306351,.254902,.725889,.473329,.279051,.380392,.778125,.537928,.302697,.505882,.815894,.606931,.382431,.631373,.839159,.679308,.497608,.756863,.854748,.751666,.631792,.882353,.869483,.822508,.768592,1,.887572,.887589,.887565]},{ColorSpace:"Lab",Name:"erdc_blue2green_muted",RGBPoints:[-1,.107704,.107708,.107695,-.87451,.141522,.13066,.270741,-.74902,.180123,.146119,.42308,-.623529,.210161,.169674,.551795,-.498039,.239701,.212939,.634969,-.372549,.253916,.282947,.653641,-.247059,.242791,.366933,.608521,-.121569,.226302,.446776,.52693,.00392157,.236237,.514689,.458798,.129412,.274641,.577589,.376069,.254902,.349625,.633993,.288131,.380392,.4437,.683677,.260497,.505882,.536247,.731214,.285424,.631373,.628472,.777128,.349151,.756863,.718259,.819287,.496825,.882353,.804768,.856164,.703299,1,.887571,.887591,.887548]},{ColorSpace:"Lab",Name:"erdc_blue2green_BW",RGBPoints:[-1,3.63578e-7,0,529374e-11,-.87451,.0539915,.0577948,.212806,-.74902,.0620393,.0758942,.388959,-.623529,.0697499,.102032,.54177,-.498039,.113295,.156156,.64334,-.372549,.152047,.243196,.670283,-.247059,.158096,.344084,.622864,-.121569,.151142,.43922,.532767,.00392157,.17155,.521588,.457719,.129412,.225861,.599141,.363997,.254902,.32328,.67007,.259083,.380392,.442344,.733697,.223754,.505882,.558409,.794941,.257411,.631373,.673875,.854344,.340822,.756863,.787244,.909326,.524717,.882353,.896483,.958063,.775914,1,1,1,.999982]},{ColorSpace:"Lab",Name:"GREEN-WHITE_LINEAR",RGBPoints:[-1,0,0,0,-.87451,0,.062745,0,-.74902,0,.12549,0,-.623529,0,.188235,0,-.498039,0,.25098,0,-.372549,0,.313725,0,-.247059,0,.376471,0,-.121569,.094118,.439216,0,.00392157,.196078,.501961,0,.129412,.294118,.564706,0,.254902,.396078,.627451,0,.380392,.498039,.690196,0,.505882,.6,.752941,.145098,.631373,.701961,.815686,.364706,.756863,.8,.878431,.580392,.882353,.901961,.941176,.796078,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_green2yellow_BW",RGBPoints:[-1,0,0,0,-.87451,0,.105542,.0603919,-.74902,0,.159454,.104148,-.623529,0,.219502,.15542,-.498039,0,.282276,.203811,-.372549,0,.346331,.235652,-.247059,0,.411765,.235428,-.121569,0,.477177,.217977,.00392157,.0593644,.541635,.21361,.129412,.233081,.604722,.210591,.254902,.369803,.664942,.226536,.380392,.498446,.722367,.288237,.505882,.601929,.782244,.380815,.631373,.703207,.840497,.512134,.756863,.803186,.896433,.674462,.882353,.903834,.950266,.846715,1,1,1,.999981]},{ColorSpace:"Lab",Name:"blue2cyan",RGBPoints:[-1,0,0,0,-.87451,0,.152941,.364706,-.74902,0,.254902,.470588,-.623529,0,.34902,.572549,-.498039,0,.443137,.670588,-.372549,0,.537255,.772549,-.247059,0,.627451,.870588,-.121569,0,.717647,.964706,.00392157,.0784314,.772549,1,.129412,.207843,.858824,1,.254902,.32549,.941176,1,.380392,.45098,1,1,.505882,.560784,1,1,.631373,.662745,1,1,.756863,.760784,1,1,.882353,.870588,1,1,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_blue2cyan_BW",RGBPoints:[-1,4.05298e-7,0,59012e-10,-.87451,.0207526,.0740933,.18093,-.74902,0,.121033,.30343,-.623529,0,.166892,.416095,-.498039,0,.216768,.524796,-.372549,.0164769,.275471,.608585,-.247059,.0544527,.344824,.659267,-.121569,.0880643,.419118,.688675,.00392157,.127938,.492556,.720256,.129412,.149476,.566946,.756918,.254902,.188961,.641333,.792122,.380392,.245482,.715336,.827609,.505882,.329216,.786235,.874761,.631373,.453558,.852803,.918466,.756863,.626281,.910493,.954,.882353,.82257,.958709,.980146,1,1,1,.999989]},{ColorSpace:"Lab",Name:"erdc_blue_BW",RGBPoints:[-1,0,0,0,-.87451,.0425591,.0763529,.150682,-.74902,.0569472,.119154,.275403,-.623529,.0635978,.164772,.395427,-.498039,.0774342,.213851,.510014,-.372549,.106815,.267034,.615102,-.247059,.122093,.324649,.720068,-.121569,.160851,.387068,.806956,.00392157,.213754,.453516,.878012,.129412,.26722,.524656,.932436,.254902,.326844,.599279,.968038,.380392,.403403,.674712,.984784,.505882,.499703,.745519,1,.631373,.615055,.813983,1,.756863,.74405,.879228,1,.882353,.877909,.941913,1,1,1,1,.999996]},{ColorSpace:"Lab",Name:"BLUE-WHITE",RGBPoints:[-1,0,0,0,-.87451,0,0,.082353,-.74902,0,0,.168627,-.623529,0,0,.254902,-.498039,0,0,.337255,-.372549,0,0,.423529,-.247059,0,0,.509804,-.121569,0,.101961,.592157,.00392157,0,.203922,.678431,.129412,0,.301961,.764706,.254902,0,.403922,.85098,.380392,0,.505882,.933333,.505882,0,.603922,1,.631373,.254902,.705882,1,.756863,.509804,.807843,1,.882353,.764706,.905882,1,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_purple_BW",RGBPoints:[-1,4.264e-8,0,6.20844e-7,-.87451,.100579,.0593111,.145666,-.74902,.167794,.0889224,.254953,-.623529,.231446,.123339,.360511,-.498039,.296699,.163027,.461278,-.372549,.363211,.209286,.55306,-.247059,.431136,.260776,.637195,-.121569,.498202,.320012,.705799,.00392157,.567456,.380459,.778091,.129412,.629381,.445284,.8448,.254902,.688373,.517374,.895694,.380392,.74891,.590906,.93976,.505882,.805017,.667956,.977626,.631373,.850914,.752618,.992396,.756863,.89724,.838454,.994093,.882353,.948461,.922603,.994449,1,1,1,.999967]},{ColorSpace:"Lab",Name:"erdc_magenta_BW",RGBPoints:[-1,0,0,254023e-10,-.87451,.128696,.0456782,.11635,-.74902,.228133,.0476299,.201452,-.623529,.327273,.0374065,.282107,-.498039,.420953,.0408166,.35709,-.372549,.511562,.0642203,.430511,-.247059,.599552,.102686,.504257,-.121569,.684646,.150536,.579429,.00392157,.765817,.205978,.656062,.129412,.839176,.27229,.731807,.254902,.89536,.357594,.797309,.380392,.930238,.457825,.846984,.505882,.945921,.564536,.880571,.631373,.948995,.670753,.902279,.756863,.947124,.772819,.918171,.882353,.947265,.869424,.934352,1,.954719,.95475,.954726]},{ColorSpace:"Lab",Name:"magenta",RGBPoints:[-1,0,0,0,-.87451,.364706,0,.152941,-.74902,.470588,0,.254902,-.623529,.572549,0,.34902,-.498039,.670588,0,.443137,-.372549,.772549,0,.537255,-.247059,.870588,0,.627451,-.121569,.964706,0,.717647,.00392157,1,.0784314,.772549,.129412,1,.207843,.858824,.254902,1,.32549,.941176,.380392,1,.45098,1,.505882,1,.560784,1,.631373,1,.662745,1,.756863,1,.760784,1,.882353,1,.870588,1,1,1,1,1]},{ColorSpace:"Lab",Name:"RED-PURPLE",RGBPoints:[-1,0,0,0,-.87451,.188235,0,.007843,-.74902,.345098,0,.035294,-.623529,.439216,0,.098039,-.498039,.533333,0,.152941,-.372549,.627451,.015686,.211765,-.247059,.721569,.031373,.266667,-.121569,.8,.047059,.329412,.00392157,.862745,.047059,.403922,.129412,.941176,.062745,.466667,.254902,.988235,.078431,.54902,.380392,.988235,.141176,.643137,.505882,.988235,.25098,.729412,.631373,.988235,.376471,.811765,.756863,.988235,.54902,.886275,.882353,.988235,.752941,.952941,1,.996078,.996078,.996078]},{ColorSpace:"Lab",Name:"erdc_red_BW",RGBPoints:[-1,0,0,0,-.87451,.147204,.0480135,.0401815,-.74902,.253411,.0617478,.0301333,-.623529,.356059,.0746331,.0446897,-.498039,.457731,.0934935,.0636931,-.372549,.557199,.122714,.0860013,-.247059,.665179,.144238,.105585,-.121569,.763833,.187056,.138326,.00392157,.847035,.254558,.189407,.129412,.905663,.345937,.258215,.254902,.941431,.447111,.346277,.380392,.962608,.546927,.457571,.505882,.987833,.637276,.569944,.631373,.994202,.732176,.687958,.756863,.993304,.826268,.800567,.882353,.994413,.917205,.906393,1,1,1,.999979]},{ColorSpace:"Lab",Name:"RED_TEMPERATURE",RGBPoints:[-1,0,0,0,-.87451,.090196,0,0,-.74902,.180392,0,0,-.623529,.270588,0,0,-.498039,.360784,0,0,-.372549,.45098,0,0,-.247059,.545098,0,0,-.121569,.635294,0,0,.00392157,.72549,.058824,0,.129412,.815686,.176471,0,.254902,.905882,.294118,0,.380392,1,.411765,0,.505882,1,.533333,.027451,.631373,1,.65098,.27451,.756863,1,.768627,.521569,.882353,1,.886275,.768627,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_orange_BW",RGBPoints:[-1,0,0,253806e-10,-.87451,.135871,.0593824,0,-.74902,.224328,.0907216,0,-.623529,.318083,.119647,0,-.498039,.414443,.150246,0,-.372549,.511077,.184884,0,-.247059,.605501,.226033,0,-.121569,.695274,.275491,0,.00392157,.777826,.334445,0,.129412,.851498,.402441,0,.254902,.915899,.47759,602975e-9,.380392,.971984,.557882,.0361443,.505882,1,.641287,.135967,.631373,1,.725198,.27997,.756863,1,.808205,.438135,.882353,1,.89306,.587036,1,1,.977928,.721599]},{ColorSpace:"Lab",Name:"heated_object",RGBPoints:[-1,0,0,0,-.87451,.34902,.0862745,0,-.74902,.45098,.172549,0,-.623529,.52549,.231373,0,-.498039,.580392,.278431,0,-.372549,.623529,.313725,0,-.247059,.670588,.352941,0,-.121569,.717647,.392157,0,.00392157,.772549,.439216,0,.129412,.839216,.494118,0,.254902,.901961,.541176,0,.380392,.968627,.6,0,.505882,1,.658824,0,.631373,1,.721569,0,.756863,1,.827451,.298039,.882353,1,.976471,.72549,1,1,1,1]},{ColorSpace:"Lab",Name:"erdc_gold_BW",RGBPoints:[-1,0,0,190933e-10,-.87451,.128363,.0636265,0,-.74902,.193795,.111057,0,-.623529,.25976,.15987,0,-.498039,.328546,.210589,0,-.372549,.399726,.26332,0,-.247059,.472969,.318261,0,-.121569,.546245,.375827,0,.00392157,.61745,.436719,0,.129412,.685545,.501113,0,.254902,.749578,.568799,0,.380392,.80962,.6394,0,.505882,.865572,.712699,.10257,.631373,.917709,.787569,.233665,.756863,.966914,.863138,.369608,.882353,1,.939405,.496104,1,.999225,1,.612275]},{ColorSpace:"Lab",Name:"erdc_brown_BW",RGBPoints:[-1,3.3216e-7,0,483629e-11,-.87451,.14693,.0518172,0,-.74902,.225806,.0814996,0,-.623529,.301681,.111452,0,-.498039,.370487,.150664,0,-.372549,.43108,.199477,0,-.247059,.4849,.255107,0,-.121569,.536798,.313486,0,.00392157,.59286,.371167,0,.129412,.653119,.428135,0,.254902,.714589,.485917,.0379541,.380392,.774667,.54565,.116634,.505882,.831222,.608047,.183895,.631373,.880305,.674199,.260298,.756863,.922314,.742472,.367086,.882353,.959408,.811222,.497258,1,.993548,.875183,.622093]},{ColorSpace:"Lab",Name:"copper_Matlab",RGBPoints:[-1,0,0,0,-.87451,.0784314,.0501961,.0313725,-.74902,.156863,.100392,.0627451,-.623529,.235294,.150588,.0941176,-.498039,.313725,.200784,.12549,-.372549,.392157,.25098,.156863,-.247059,.470588,.301176,.188235,-.121569,.54902,.351373,.219608,.00392157,.627451,.401569,.25098,.129412,.705882,.451765,.282353,.254902,.784314,.501961,.313725,.380392,.862745,.552157,.345098,.505882,.941176,.602353,.376471,.631373,1,.652549,.407843,.756863,1,.702745,.439216,.882353,1,.752941,.470588,1,1,.8,.5]},{ColorSpace:"Lab",Name:"pink_Matlab",RGBPoints:[-1,0,0,0,-.87451,.312416,.204524,.204524,-.74902,.441822,.289241,.289241,-.623529,.54112,.354246,.354246,-.498039,.624831,.409048,.409048,-.372549,.698582,.45733,.45733,-.247059,.764404,.502282,.500979,-.121569,.791292,.591516,.54112,.00392157,.817297,.66895,.578481,.129412,.842499,.738308,.613572,.254902,.866968,.801687,.646762,.380392,.890766,.86041,.678329,.505882,.913944,.913944,.711254,.631373,.936549,.936549,.79459,.756863,.958621,.958621,.869979,.882353,.980196,.980196,.939336,1,1,1,1]},{ColorSpace:"Lab",Name:"bone_Matlab",RGBPoints:[-1,0,0,0,-.87451,.054902,.054902,.075817,-.74902,.109804,.109804,.151634,-.623529,.164706,.164706,.227451,-.498039,.219608,.219608,.303268,-.372549,.27451,.27451,.379085,-.247059,.329412,.329902,.454412,-.121569,.384314,.405719,.509314,.00392157,.439216,.481536,.564216,.129412,.494118,.557353,.619118,.254902,.54902,.63317,.67402,.380392,.603922,.708987,.728922,.505882,.660294,.783824,.783824,.631373,.746569,.838725,.838725,.756863,.832843,.893627,.893627,.882353,.919118,.948529,.948529,1,1,1,1]},{ColorSpace:"Lab",Name:"gray_Matlab",RGBPoints:[-1,0,0,0,-.87451,.0627451,.0627451,.0627451,-.74902,.12549,.12549,.12549,-.623529,.188235,.188235,.188235,-.498039,.25098,.25098,.25098,-.372549,.313725,.313725,.313725,-.247059,.376471,.376471,.376471,-.121569,.439216,.439216,.439216,.00392157,.501961,.501961,.501961,.129412,.564706,.564706,.564706,.254902,.627451,.627451,.627451,.380392,.690196,.690196,.690196,.505882,.752941,.752941,.752941,.631373,.815686,.815686,.815686,.756863,.878431,.878431,.878431,.882353,.941176,.941176,.941176,1,1,1,1]},{ColorSpace:"Lab",Name:"Purples",RGBPoints:[-1,.247059,0,.490196,-.87451,.288397,.07677,.525629,-.74902,.32975,.153587,.561092,-.623529,.373057,.236263,.600461,-.498039,.416363,.319,.639923,-.372549,.459669,.405613,.685198,-.247059,.503345,.491534,.730058,-.121569,.562399,.54862,.757616,.00392157,.621453,.606075,.785544,.129412,.680508,.674971,.824914,.254902,.739562,.743406,.863899,.380392,.798616,.800492,.893426,.505882,.85684,.856655,.922491,.631373,.898178,.894056,.942176,.756863,.938654,.930919,.961646,.882353,.964245,.958478,.977393,1,.988235,.984314,.992157]},{ColorSpace:"Lab",Name:"Blues",RGBPoints:[-1,.031373,.188235,.419608,-.87451,.031373,.253195,.516063,-.74902,.031757,.318139,.612149,-.623529,.080969,.38113,.661361,-.498039,.130427,.444152,.710327,-.372549,.195386,.509112,.743791,-.247059,.260715,.573841,.777209,-.121569,.341423,.628958,.808704,.00392157,.422745,.684075,.839892,.129412,.523137,.739193,.861546,.254902,.622684,.793464,.883429,.380392,.701423,.826928,.910988,.505882,.778685,.8603,.937993,.631373,.825928,.891795,.953741,.756863,.87328,.923291,.969489,.882353,.922491,.954787,.985236,1,.968627,.984314,1]},{ColorSpace:"Lab",Name:"Greens",RGBPoints:[-1,0,.266667,.105882,-.87451,0,.347374,.139346,-.74902,538e-6,.427912,.172933,-.623529,.069435,.486967,.222145,-.498039,.138178,.546082,.271326,-.372549,.197232,.609073,.31857,-.247059,.257255,.671742,.365859,-.121569,.357647,.720953,.415071,.00392157,.45767,.769919,.465021,.129412,.546251,.811257,.537855,.254902,.634295,.852211,.610688,.380392,.709097,.883706,.683522,.505882,.78316,.914833,.755894,.631373,.842215,.938454,.818885,.756863,.899977,.961538,.880692,.882353,.935409,.975317,.92203,1,.968627,.988235,.960784]},{ColorSpace:"Lab",Name:"PuBu",RGBPoints:[-1,.301961,0,.294118,-.87451,.404321,.029527,.390573,-.74902,.50599,.059592,.486782,-.623529,.519769,.158016,.551742,-.498039,.533456,.256194,.616301,-.372549,.54133,.33887,.655671,-.247059,.54902,.421592,.695087,-.121569,.54902,.506236,.736424,.00392157,.550127,.590573,.777701,.129412,.585559,.665375,.81707,.254902,.622145,.739023,.855825,.380392,.687105,.784298,.879446,.505882,.752065,.829758,.903253,.631373,.817024,.87897,.930811,.756863,.880907,.927213,.957832,.882353,.926182,.958708,.975548,1,.968627,.988235,.992157]},{ColorSpace:"Lab",Name:"BuPu",RGBPoints:[-1,.007843,.219608,.345098,-.87451,.01178,.286536,.449427,-.74902,.015702,.35328,.553479,-.623529,.01767,.396586,.622376,-.498039,.021115,.4402,.690688,-.372549,.11757,.503191,.722184,-.247059,.214625,.565859,.753633,-.121569,.336671,.615071,.78316,.00392157,.457978,.663975,.812503,.129412,.556401,.703345,.836125,.254902,.65421,.742714,.859669,.380392,.736886,.782084,.881323,.505882,.81827,.821638,.903068,.631373,.873387,.864944,.92669,.756863,.927536,.907605,.949988,.882353,.964937,.9391,.967705,1,1,.968627,.984314]},{ColorSpace:"Lab",Name:"BuGn",RGBPoints:[-1,.031373,.25098,.505882,-.87451,.031373,.329719,.590527,-.74902,.031911,.408397,.674787,-.623529,.100807,.479262,.710219,-.498039,.169704,.550219,.745744,-.372549,.238601,.62699,.787082,-.247059,.307958,.703114,.826759,-.121569,.39654,.752326,.797232,.00392157,.485121,.801046,.767705,.129412,.573702,.83451,.738178,.254902,.661592,.867743,.711034,.380392,.732457,.895302,.74253,.505882,.801845,.922307,.774579,.631373,.841215,.938055,.817885,.756863,.880907,.95391,.861084,.882353,.926182,.971626,.902422,1,.968627,.988235,.941176]},{ColorSpace:"Lab",Name:"GnBu",RGBPoints:[-1,0,.266667,.105882,-.87451,0,.347374,.139346,-.74902,538e-6,.427912,.172933,-.623529,.069435,.486967,.222145,-.498039,.138178,.546175,.272095,-.372549,.197232,.615071,.368551,-.247059,.256609,.683276,.464867,-.121569,.329443,.722645,.555417,.00392157,.403137,.762138,.645413,.129412,.503529,.805444,.718247,.254902,.603922,.848597,.790465,.380392,.704314,.887966,.847551,.505882,.802307,.926321,.903714,.631373,.851519,.944037,.941115,.756863,.899977,.961538,.976901,.882353,.935409,.975317,.984775,1,.968627,.988235,.992157]},{ColorSpace:"Lab",Name:"GnBuPu",RGBPoints:[-1,.003922,.27451,.211765,-.87451,.003922,.349312,.280661,-.74902,.003937,.423852,.349773,-.623529,.005905,.46519,.446228,-.498039,.009443,.506344,.542837,-.372549,.111803,.535871,.649135,-.247059,.214025,.565859,.753633,-.121569,.310481,.615071,.78316,.00392157,.407797,.663975,.812503,.129412,.531811,.703345,.836125,.254902,.65421,.742714,.859669,.380392,.736886,.782084,.881323,.505882,.81827,.821176,.902884,.631373,.873387,.854641,.922568,.756863,.927536,.888535,.942361,.882353,.964937,.929873,.964014,1,1,.968627,.984314]},{ColorSpace:"Lab",Name:"BuGnYl",RGBPoints:[-1,.031373,.113725,.345098,-.87451,.088458,.159,.463206,-.74902,.145052,.204567,.5807,-.623529,.139146,.287243,.620069,-.498039,.13318,.370196,.659562,-.372549,.123337,.470588,.706805,-.247059,.115386,.570335,.753126,-.121569,.186251,.643168,.761,.00392157,.258716,.71514,.768074,.129412,.380761,.760415,.750358,.254902,.503576,.806075,.732795,.380392,.645306,.861192,.719016,.505882,.783899,.91511,.705606,.631373,.858701,.944637,.6997,.756863,.931349,.973303,.698424,.882353,.966782,.987082,.777163,1,1,1,.85098]},{ColorSpace:"Lab",Name:"PuRd",RGBPoints:[-1,.286275,0,.415686,-.87451,.38273,.001968,.441276,-.74902,.479231,.003922,.466774,-.623529,.581592,.003922,.480554,-.498039,.683799,.00549,.494887,-.372549,.776317,.105882,.544098,-.247059,.867866,.206321,.592618,-.121569,.919047,.308681,.612303,.00392157,.968812,.411226,.632603,.129412,.974717,.519493,.671972,.254902,.980546,.626451,.71065,.380392,.984483,.701253,.732303,.505882,.988328,.77504,.755617,.631373,.990296,.828189,.812703,.756863,.992372,.880907,.869035,.882353,.996309,.926182,.912341,1,1,.968627,.952941]},{ColorSpace:"Lab",Name:"RdPu",RGBPoints:[-1,.403922,0,.121569,-.87451,.500377,0,.192434,-.74902,.596909,277e-6,.263037,-.623529,.703206,.035709,.300438,-.498039,.808612,.071296,.338854,-.372549,.857824,.116571,.441215,-.247059,.905513,.163552,.54293,-.121569,.889765,.281661,.617732,.00392157,.873156,.39897,.691611,.129412,.82985,.491488,.736886,.254902,.789081,.583237,.781853,.380392,.810734,.656071,.819254,.505882,.833126,.729181,.85684,.631373,.870527,.80792,.898178,.756863,.907605,.884398,.938331,.882353,.9391,.921799,.958016,1,.968627,.956863,.976471]},{ColorSpace:"Lab",Name:"Oranges",RGBPoints:[-1,.498039,.152941,.015686,-.87451,.57481,.182468,.013718,-.74902,.651765,.212042,.011734,-.623529,.752157,.247474,.007797,-.498039,.851719,.283368,.004475,-.372549,.898962,.348328,.039908,-.247059,.945652,.413426,.076401,-.121569,.969273,.484291,.157109,.00392157,.992157,.554971,.238185,.129412,.992157,.619931,.330704,.254902,.992157,.684967,.423837,.380392,.992157,.751895,.532103,.505882,.992249,.817716,.639354,.631373,.994218,.861023,.725967,.756863,.996186,.903576,.810965,.882353,.998155,.933103,.868051,1,1,.960784,.921569]},{ColorSpace:"Lab",Name:"Reds",RGBPoints:[-1,.403922,0,.05098,-.87451,.525967,.029527,.066728,-.74902,.647643,.058962,.082476,-.623529,.722445,.076678,.098224,-.498039,.797186,.095194,.114187,-.372549,.868051,.164091,.143714,-.247059,.937809,.233541,.173933,-.121569,.96143,.326059,.232987,.00392157,.984375,.418147,.292657,.129412,.986344,.496886,.371396,.254902,.988235,.575702,.450673,.380392,.988235,.656409,.543191,.505882,.98842,.736747,.635894,.631373,.992357,.809581,.732349,.756863,.996186,.880692,.826759,.882353,.998155,.92203,.885813,1,1,.960784,.941176]},{ColorSpace:"Lab",Name:"RdOr",RGBPoints:[-1,.498039,0,0,-.87451,.6004,0,0,-.74902,.702514,738e-6,477e-6,-.623529,.773379,.095225,.061499,-.498039,.843875,.189865,.12283,-.372549,.891119,.294195,.203537,-.247059,.937855,.397924,.283137,-.121569,.963445,.476663,.316601,.00392157,.988297,.555771,.351665,.129412,.990265,.646321,.436309,.254902,.992157,.735256,.519646,.380392,.992157,.784468,.570827,.505882,.992249,.833218,.623483,.631373,.994218,.872587,.706159,.756863,.996186,.911419,.788189,.882353,.998155,.940946,.859054,1,1,.968627,.92549]},{ColorSpace:"Lab",Name:"BrOrYl",RGBPoints:[-1,.4,.145098,.023529,-.87451,.500392,.174625,.019592,-.74902,.600784,.204291,.015656,-.623529,.701176,.251534,.011719,-.498039,.800984,.299146,.008397,-.372549,.863975,.370012,.043829,-.247059,.926321,.441107,.0794,-.121569,.961753,.521815,.120738,.00392157,.996078,.602645,.163122,.129412,.996078,.68729,.237924,.254902,.996078,.771011,.314879,.380392,.996078,.832034,.444798,.505882,.996171,.892042,.572595,.631373,.998139,.931411,.65724,.756863,1,.969489,.741669,.882353,1,.985236,.822376,1,1,1,.898039]},{ColorSpace:"Lab",Name:"RdOrYl",RGBPoints:[-1,.501961,0,.14902,-.87451,.622038,0,.14902,-.74902,.741761,4e-4,.148866,-.623529,.816563,.05158,.129181,-.498039,.890965,.10356,.110235,-.372549,.940177,.205921,.137793,-.247059,.988281,.308789,.165536,-.121569,.99025,.432803,.200969,.00392157,.992218,.555217,.236278,.129412,.994187,.628051,.267774,.254902,.996078,.701038,.301269,.380392,.996078,.777809,.383945,.505882,.996171,.852826,.466621,.631373,.998139,.892195,.549296,.756863,1,.931349,.632188,.882353,1,.966782,.7188,1,1,1,.8]},{ColorSpace:"Lab",Name:"CIELab_blue2red",RGBPoints:[-1,0,.6,.74902,1,.76863,.46667,.34118]},{ColorSpace:"Lab",Name:"blue2yellow",RGBPoints:[-1,0,0,1,0,.5,.5,.5,1,1,1,0]},{ColorSpace:"Lab",Name:"erdc_blue2gold",RGBPoints:[-1,.175119,.0438468,1,-.874016,.22383,.159771,.94557,-.748031,.27254,.233611,.891216,-.622047,.321251,.296526,.836857,-.496063,.369962,.354296,.782359,-.370079,.418672,.409139,.72754,-.244094,.467383,.462152,.672148,-.11811,.51609,.51396,.615825,.00787402,.572863,.55452,.559172,.133858,.630269,.593822,.517729,.259843,.689588,.624668,.47446,.385827,.745394,.656113,.428638,.511811,.798624,.688104,.379105,.637795,.849926,.720593,.323834,.76378,.899765,.753543,.258657,.889764,.948487,.78692,.171778,1,.990413,.816451,.00729848]},{ColorSpace:"Lab",Name:"erdc_blue2yellow",RGBPoints:[-1,.0830122,0,.495617,-.87451,.141973,.0551288,.57363,-.74902,.193048,.110258,.604561,-.623529,.234231,.165386,.57643,-.498039,.275413,.220515,.548299,-.372549,.316596,.275644,.520169,-.247059,.357778,.330773,.492038,-.121569,.398961,.385901,.463908,.00392157,.449929,.438487,.426815,.129412,.511572,.488299,.379944,.254902,.581222,.53603,.325741,.380392,.650871,.583761,.271538,.505882,.720521,.631493,.217335,.631373,.79017,.679224,.163132,.756863,.85982,.726955,.108929,.882353,.910254,.774159,.14112,1,.927513,.81759,.306289]},{ColorSpace:"Lab",Name:"erdc_cyan2orange",RGBPoints:[-1,.0471513,.213874,.414329,-.87451,.0674702,.256648,.439027,-.74902,.0959957,.299331,.462089,-.623529,.132428,.341872,.483212,-.498039,.188743,.38277,.500597,-.372549,.268511,.420229,.512179,-.247059,.352945,.455602,.519101,-.121569,.43893,.489368,.521538,.00392157,.522445,.522495,.522436,.129412,.600089,.555682,.53205,.254902,.67988,.587981,.539163,.380392,.761011,.619586,.544439,.505882,.84278,.650741,.548567,.631373,.910713,.687347,.557822,.756863,.952232,.734972,.577775,.882353,.975642,.789858,.604868,1,.990752,.843643,.632857]},{ColorSpace:"Lab",Name:"erdc_purple2green",RGBPoints:[-1,.235006,.0483128,.530899,-.87451,.302968,.108419,.552391,-.74902,.360241,.166059,.569502,-.623529,.406746,.226782,.579373,-.498039,.444073,.28964,.582094,-.372549,.473648,.353774,.577947,-.247059,.497636,.418154,.567911,-.121569,.519086,.481741,.553968,.00392157,.542884,.542914,.542875,.129412,.566303,.603989,.527499,.254902,.595218,.662965,.516857,.380392,.628641,.720701,.510673,.505882,.665373,.777849,.508165,.631373,.704182,.834921,.508303,.756863,.743846,.892328,.50999,.882353,.783158,.950422,.512181,1,.818617,1,.513888]},{ColorSpace:"Lab",Name:"erdc_purple2green_dark",RGBPoints:[-1,.107656,0,.428682,-.87451,.1924,0,.449799,-.74902,.255118,.0648939,.466726,-.623529,.304256,.133066,.476703,-.498039,.343202,.19716,.479793,-.372549,.373876,.260353,.476241,-.247059,.398497,.322872,.466953,-.121569,.420016,.384252,.453785,.00392157,.44319,.443216,.443186,.129412,.465553,.502139,.428233,.254902,.492959,.559151,.417591,.380392,.524654,.615092,.411016,.505882,.55959,.670583,.40779,.631373,.596614,.726102,.406948,.756863,.634544,.782032,.407439,.882353,.672183,.838703,.408237,1,.706131,.892759,.408452]},{ColorSpace:"Lab",Name:"coolwarm",RGBPoints:[-1,.229806,.298718,.753683,-.875,.303869,.406535,.844959,-.75,.383013,.509419,.917388,-.625,.466667,.604563,.968155,-.5,.552953,.688929,.995376,-.375,.639176,.7596,.998151,-.25,.722193,.813953,.976575,-.125,.798692,.849786,.931689,0,.865395,.86541,.865396,.125,.924128,.827385,.774508,.25,.958853,.769768,.678008,.375,.969954,.694267,.579375,.5,.958003,.602842,.481776,.625,.923945,.497309,.38797,.75,.869187,.378313,.300267,.875,.795632,.241284,.220526,1,.705673,.0155562,.150233]},{ColorSpace:"Lab",Name:"BuRd",RGBPoints:[-1,.019608,.188235,.380392,-.87451,.088504,.321107,.564937,-.74902,.163399,.444983,.697501,-.623529,.247059,.555709,.754095,-.498039,.420684,.676432,.818685,-.372549,.606459,.789773,.880277,-.247059,.761476,.868512,.924567,-.121569,.878047,.925721,.951942,.00392157,.969089,.966474,.964937,.129412,.983852,.897578,.846828,.254902,.982468,.800692,.706113,.380392,.960323,.66782,.536332,.505882,.894579,.503806,.399769,.631373,.81707,.33218,.281046,.756863,.728489,.155017,.197386,.882353,.576932,.055363,.14925,1,.403922,0,.121569]},{ColorSpace:"Lab",Name:"Spectral_lowBlue",RGBPoints:[-1,.368627,.309804,.635294,-.87451,.260361,.450058,.70173,-.74902,.248058,.591311,.717186,-.623529,.376009,.734025,.658132,-.498039,.537947,.814764,.64506,-.372549,.702345,.879585,.636678,-.247059,.84752,.938639,.607151,-.121569,.940408,.976163,.656055,.00392157,.999923,.997616,.745021,.129412,.997463,.921338,.61707,.254902,.995002,.824606,.499885,.380392,.992541,.701576,.39654,.505882,.973472,.547405,.318108,.631373,.937793,.398539,.270127,.756863,.861515,.282891,.299654,.882353,.746482,.144637,.288812,1,.619608,.003922,.258824]},{ColorSpace:"Lab",Name:"GnRP",RGBPoints:[-1,0,.266667,.105882,-.87451,.066436,.394617,.174779,-.74902,.168858,.524567,.25767,-.623529,.323875,.657439,.361015,-.498039,.504883,.772318,.506344,-.372549,.678431,.870127,.654902,-.247059,.803922,.921799,.780392,-.121569,.897116,.951942,.882814,.00392157,.967397,.965936,.967474,.129412,.928028,.879815,.930565,.254902,.866052,.780777,.882891,.380392,.77501,.665129,.821376,.505882,.675663,.537024,.737024,.631373,.57847,.396155,.645982,.756863,.492349,.223914,.547559,.882353,.375548,.096886,.423299,1,.25098,0,.294118]},{ColorSpace:"Lab",Name:"GYPi",RGBPoints:[-1,.152941,.392157,.098039,-.87451,.246444,.505344,.117724,-.74902,.351942,.614533,.161399,-.623529,.474971,.717878,.240138,-.498039,.611995,.811226,.392849,-.372549,.746328,.893118,.565321,-.247059,.859516,.94233,.747405,-.121569,.928105,.96386,.875663,.00392157,.969089,.966859,.968012,.129412,.983852,.910265,.948328,.254902,.979239,.833218,.914648,.380392,.949712,.729873,.862976,.505882,.905652,.58293,.763552,.631373,.85521,.410073,.652211,.756863,.793695,.183699,.531642,.882353,.683737,.063899,.420761,1,.556863,.003922,.321569]},{ColorSpace:"Lab",Name:"GnYlRd",RGBPoints:[-1,0,.407843,.215686,-.87451,.063975,.525952,.277201,-.74902,.177932,.633064,.332718,-.623529,.364937,.724106,.379469,-.498039,.527951,.797155,.40223,-.372549,.678431,.862822,.433449,-.247059,.803922,.916955,.514648,-.121569,.909419,.961861,.625067,.00392157,.999923,.997616,.745021,.129412,.997463,.921338,.61707,.254902,.995002,.824606,.499885,.380392,.992541,.701576,.39654,.505882,.973472,.547405,.318108,.631373,.939023,.389927,.245521,.756863,.867666,.239831,.176624,.882353,.762399,.110727,.151326,1,.647059,0,.14902]},{ColorSpace:"Lab",Name:"GBBr",RGBPoints:[-1,0,.235294,.188235,-.87451,.002461,.338639,.301423,-.74902,.055902,.448981,.417609,-.623529,.183852,.56955,.538178,-.498039,.357785,.700115,.660746,-.372549,.540177,.819531,.77624,-.247059,.714879,.890888,.864821,-.121569,.851134,.934564,.922645,.00392157,.960861,.959785,.95694,.129412,.963322,.927797,.83391,.254902,.939946,.868897,.68935,.380392,.883353,.775394,.517109,.505882,.808074,.625836,.324106,.631373,.717647,.476355,.15494,.756863,.592157,.358247,.06882,.882353,.458593,.26436,.031142,1,.329412,.188235,.019608]},{ColorSpace:"Lab",Name:"PuOr",RGBPoints:[-1,.498039,.231373,.031373,-.87451,.62599,.30273,.026451,-.74902,.746943,.387082,.037524,-.623529,.85767,.490427,.071972,-.498039,.936409,.617762,.236371,-.372549,.992695,.743099,.43291,-.247059,.995156,.841523,.63714,-.121569,.985313,.913802,.813687,.00392157,.966244,.966398,.967705,.129412,.889965,.89504,.938178,.254902,.806151,.804306,.894656,.380392,.712649,.688658,.833141,.505882,.594233,.554325,.744637,.631373,.474894,.404229,.652364,.756863,.366628,.217224,.563783,.882353,.266436,.089965,.434833,1,.176471,0,.294118]},{ColorSpace:"Lab",Name:"PRGn",RGBPoints:[-1,.25098,0,.294118,-.87451,.383852,.103345,.431911,-.74902,.497732,.234679,.55371,-.623529,.583852,.40692,.652134,-.498039,.681968,.545175,.742561,-.372549,.7807,.672357,.825221,-.247059,.871742,.788005,.886736,-.121569,.930488,.885198,.932872,.00392157,.966321,.968089,.965859,.129412,.892503,.950865,.877278,.254902,.796078,.91857,.772549,.380392,.670588,.866897,.647059,.505882,.493195,.765398,.496655,.631373,.314187,.649135,.354556,.756863,.15917,.516263,.251211,.882353,.062284,.386621,.170473,1,0,.266667,.105882]},{ColorSpace:"Lab",Name:"PiYG",RGBPoints:[-1,.556863,.003922,.321569,-.87451,.692195,.067897,.427374,-.74902,.797539,.197847,.539177,-.623529,.859054,.424221,.659746,-.498039,.908574,.592618,.770319,-.372549,.951557,.736332,.866205,-.247059,.981084,.839677,.917878,-.121569,.98293,.913802,.949558,.00392157,.96732,.968474,.965629,.129412,.92549,.963552,.869666,.254902,.852441,.939254,.736025,.380392,.739254,.890042,.553941,.505882,.60323,.805536,.382238,.631373,.467282,.711419,.235217,.756863,.344252,.608074,.156478,.882353,.2406,.49827,.116494,1,.152941,.392157,.098039]},{ColorSpace:"Lab",Name:"OrPu",RGBPoints:[-1,.176471,0,.294118,-.87451,.272434,.095963,.444214,-.74902,.373395,.228912,.56932,-.623529,.481661,.415917,.657901,-.498039,.601922,.562937,.750481,-.372549,.718493,.695886,.836986,-.247059,.811995,.811534,.898501,-.121569,.894733,.8995,.940023,.00392157,.969166,.966859,.963629,.129412,.98639,.910265,.803691,.254902,.995002,.835371,.624375,.380392,.992541,.736947,.420146,.505882,.931949,.609458,.224221,.631373,.85075,.483968,.069819,.756863,.740023,.380623,.035371,.882353,.617993,.29827,.026759,1,.498039,.231373,.031373]},{ColorSpace:"Lab",Name:"BrBG",RGBPoints:[-1,.329412,.188235,.019608,-.87451,.467205,.269435,.031911,-.74902,.6,.365629,.074202,-.623529,.72549,.483737,.160323,-.498039,.812995,.635832,.336409,-.372549,.88689,.781238,.527874,-.247059,.943483,.87474,.700115,-.121569,.963168,.929796,.841599,.00392157,.957247,.959938,.959554,.129412,.84406,.932872,.920185,.254902,.70396,.886428,.859285,.380392,.529258,.815071,.770704,.505882,.346251,.691811,.653057,.631373,.175855,.562015,.530642,.756863,.047905,.441446,.410073,.882353,.002307,.33218,.294348,1,0,.235294,.188235]},{ColorSpace:"Lab",Name:"GyRd",RGBPoints:[-1,.101961,.101961,.101961,-.87451,.227451,.227451,.227451,-.74902,.359939,.359939,.359939,-.623529,.502653,.502653,.502653,-.498039,.631373,.631373,.631373,-.372549,.749865,.749865,.749865,-.247059,.843368,.843368,.843368,-.121569,.926105,.926105,.926105,.00392157,.999846,.997232,.995694,.129412,.994925,.908651,.857901,.254902,.982468,.800692,.706113,.380392,.960323,.66782,.536332,.505882,.894579,.503806,.399769,.631373,.81707,.33218,.281046,.756863,.728489,.155017,.197386,.882353,.576932,.055363,.14925,1,.403922,0,.121569]},{ColorSpace:"Lab",Name:"erdc_divHi_purpleGreen",RGBPoints:[-1,.297553,0,.489074,-.87451,.40259,.151146,.567754,-.74902,.516038,.284843,.658231,-.623529,.629783,.423646,.750938,-.498039,.735198,.563697,.835956,-.372549,.82408,.695541,.903582,-.247059,.889091,.807454,.944862,-.121569,.92334,.886917,.951839,.00392157,.921045,.921084,.921003,.129412,.877324,.907455,.845381,.254902,.797649,.849713,.734695,.380392,.691646,.75964,.600532,.505882,.568981,.649159,.453807,.631373,.438945,.529756,.304259,.756863,.30973,.412001,.158303,.882353,.187078,.305111,.00251458,1,.101655,.220836,0]},{ColorSpace:"Lab",Name:"erdc_divHi_purpleGreen_dim",RGBPoints:[-1,.404088,.131038,.592767,-.87451,.486469,.230957,.651243,-.74902,.575165,.339335,.717723,-.623529,.662741,.454332,.784263,-.498039,.742071,.570213,.842918,-.372549,.806935,.678992,.886227,-.247059,.852219,.771315,.90763,-.121569,.873345,.837327,.901572,.00392157,.866783,.86682,.866745,.129412,.82839,.858225,.796812,.254902,.762578,.814287,.700202,.380392,.676429,.744229,.585735,.505882,.577033,.65732,.461526,.631373,.47128,.562476,.33476,.756863,.365461,.467957,.21076,.882353,.264758,.381138,.0878313,1,.182591,.312249,0]},{ColorSpace:"Lab",Name:"erdc_divLow_icePeach",RGBPoints:[-1,.480048,.817441,.998056,-.87451,.425898,.726921,.883187,-.74902,.366682,.629445,.761936,-.623529,.308756,.531002,.640217,-.498039,.258021,.43705,.523433,-.372549,.219244,.352381,.416348,-.247059,.195127,.281032,.322979,-.121569,.186286,.22627,.246525,.00392157,.192352,.19236,.192364,.129412,.255927,.214469,.191756,.254902,.340459,.254426,.206666,.380392,.444655,.309315,.234029,.505882,.565353,.376004,.270969,.631373,.697917,.450748,.314293,.756863,.836657,.529064,.360227,.882353,.972695,.614884,.413123,1,1,.705904,.472699]},{ColorSpace:"Lab",Name:"erdc_divLow_purpleGreen",RGBPoints:[-1,.956034,.666487,.952663,-.87451,.874457,.572698,.936352,-.74902,.753465,.488253,.909063,-.623529,.63309,.413507,.763833,-.498039,.514491,.345878,.620015,-.372549,.405008,.288141,.484376,-.247059,.311388,.241986,.363556,-.121569,.238722,.209044,.263449,.00392157,.192352,.192366,.192362,.129412,.200379,.233201,.168618,.254902,.230151,.291737,.165227,.380392,.279481,.366076,.178607,.505882,.344927,.453267,.205703,.631373,.421554,.549449,.242643,.756863,.503334,.649999,.284377,.882353,.583497,.749672,.324969,1,.650705,.837228,.356264]},{ColorSpace:"Lab",Name:"Haze_green",RGBPoints:[-1,1,.835294,.886275,-.87451,.937255,.756863,.870443,-.74902,.875817,.666376,.857807,-.623529,.778359,.583007,.808134,-.498039,.676253,.494118,.745098,-.372549,.561365,.390123,.682353,-.247059,.438344,.262745,.621496,-.121569,.321133,.141031,.558751,.00392157,.203922,.0217865,.495861,.129412,.265505,.129412,.433261,.254902,.311692,.255338,.37008,.380392,.356282,.377342,.310821,.505882,.39971,.488889,.258243,.631373,.442556,.604357,.205519,.756863,.48671,.71968,.152941,.882353,.529847,.830356,.100944,1,.572549,.933333,.054902]},{ColorSpace:"Lab",Name:"Haze_lime",RGBPoints:[-1,.704034,.784196,1,-.87451,.633111,.691418,.956078,-.74902,.564021,.600606,.912157,-.623529,.496827,.51189,.868235,-.498039,.43157,.425416,.824314,-.372549,.368248,.341347,.780392,-.247059,.306767,.259855,.736471,-.121569,.246862,.181069,.692549,.00392157,.191619,.109542,.648627,.129412,.257404,.194031,.604706,.254902,.321794,.278775,.560784,.380392,.387909,.364617,.516863,.505882,.456569,.451881,.472941,.631373,.527424,.540773,.42902,.756863,.599759,.631427,.385098,.882353,.673065,.723898,.341176,1,.742751,.812252,.3]},{ColorSpace:"RGB",Name:"Haze",RGBPoints:[-1,1,.835294,.996078,-.00392157,.023529,.141176,.498039,.00392157,.015686,.137255,.494118,1,.984314,.764706,0]},{ColorSpace:"Lab",Name:"Haze_cyan",RGBPoints:[-1,.956863,1,.835294,-.87451,.933188,.921714,.760784,-.74902,.870588,.803486,.671605,-.623529,.807843,.684096,.583297,-.498039,.745098,.569208,.494118,-.372549,.682353,.437763,.390123,-.247059,.621496,.288163,.262745,-.121569,.558751,.144517,.141031,.00392157,.495861,.0217865,.0413943,.129412,.433261,.137255,.129412,.254902,.37008,.263181,.255338,.380392,.306318,.381845,.372694,.505882,.243137,.503994,.494263,.631373,.180392,.629484,.619753,.756863,.117647,.754975,.747131,.882353,.054902,.876398,.866812,1,0,.988235,.976471]},{ColorSpace:"Lab",Name:"nic_Edge",RGBPoints:[-1,.191208,.191208,.191208,-.87451,.239484,.00545035,.614821,-.74902,.220593,.0617459,.863547,-.623529,.17509,.278988,.97794,-.498039,.143526,.576069,.998553,-.372549,.166456,.871883,.96594,-.247059,.376202,.993555,.981833,-.121569,.681996,.991297,.999239,.00392157,.954172,.952734,.94374,.129412,.999735,.99301,.662896,.254902,.979399,.991466,.357973,.380392,.968771,.854967,.162659,.505882,.999245,.556697,.144323,.631373,.973959,.26223,.177946,.756863,.852358,.0526707,.222974,.882353,.593889,.00912724,.238855,1,.191208,.191208,.191208]},{ColorSpace:"Lab",Name:"erdc_iceFire_H",RGBPoints:[-1,4.05432e-7,0,590122e-11,-.87451,0,.120401,.302675,-.74902,0,.216583,.524574,-.623529,.0552475,.345025,.6595,-.498039,.128047,.492588,.720288,-.372549,.188955,.641309,.792092,-.247059,.327673,.784935,.873434,-.121569,.60824,.892164,.935547,.00392157,.881371,.912178,.818099,.129412,.951407,.835621,.449279,.254902,.904481,.690489,0,.380392,.85407,.510864,0,.505882,.777093,.33018,88199e-8,.631373,.672862,.139087,.00269398,.756863,.508815,0,0,.882353,.299417,366289e-9,547829e-9,1,.0157519,.00332021,4.55569e-8]},{ColorSpace:"Lab",Name:"erdc_iceFire_L",RGBPoints:[-1,.870485,.913768,.832905,-.87451,.586919,.887865,.934003,-.74902,.31583,.776442,.867858,-.623529,.18302,.632034,.787722,-.498039,.117909,.484134,.713825,-.372549,.0507239,.335979,.654741,-.247059,0,.209874,.511832,-.121569,0,.114689,.28935,.00392157,.0157519,.00332021,4.55569e-8,.129412,.312914,0,0,.254902,.520865,0,0,.380392,.680105,.15255,.0025996,.505882,.785109,.339479,797922e-9,.631373,.857354,.522494,0,.756863,.910974,.699774,0,.882353,.951921,.842817,.478545,1,.881371,.912178,.818099]},{ColorSpace:"RGB",Name:"hsv",RGBPoints:[-1,1,0,0,-.666666,1,0,1,-.333333,0,0,1,0,0,1,1,.33333,0,1,0,.66666,1,1,0,1,1,0,0]},{ColorSpace:"Lab",Name:"hue_L60",RGBPoints:[-1,.964784,.400592,.349549,-.87451,.964915,.372498,.53785,-.74902,.892353,.401039,.759569,-.623529,.79263,.446956,.903017,-.498039,.682208,.49954,.966673,-.372549,.56392,.553082,.968836,-.247059,.442031,.606396,.901601,-.121569,.305499,.65701,.765784,.00392157,.197251,.687914,.620914,.129412,.193882,.701887,.472654,.254902,.249866,.706123,.320005,.380392,.35132,.697417,.202919,.505882,.498097,.669467,.125232,.631373,.637477,.626239,.107431,.756863,.762115,.56872,.155812,.882353,.889434,.481116,.240445,1,.964784,.400592,.349549]},{IndexedColors:[0,0,0,.8941176470588236,.1019607843137255,.1098039215686274,.2156862745098039,.4941176470588236,.7215686274509804,.3019607843137255,.6862745098039216,.2901960784313726,.596078431372549,.3058823529411765,.6392156862745098,1,.4980392156862745,0,.6509803921568628,.3372549019607843,.1568627450980392],Name:"Spectrum",NanColor:[.6509803921568628,.3372549019607843,.1568627450980392]},{IndexedColors:[.4745098039215686,.09019607843137255,.09019607843137255,.7098039215686275,.00392156862745098,.00392156862745098,.9372549019607843,.2784313725490196,.09803921568627451,.9764705882352941,.5137254901960784,.1411764705882353,1,.7058823529411765,0,1,.8980392156862745,.02352941176470588],Name:"Warm",NanColor:[1,.8980392156862745,.02352941176470588]},{IndexedColors:[.4588235294117647,.6941176470588235,.00392156862745098,.3450980392156863,.5019607843137255,.1607843137254902,.3137254901960784,.8431372549019608,.7490196078431373,.1098039215686274,.5843137254901961,.803921568627451,.2313725490196079,.407843137254902,.6705882352941176,.6039215686274509,.407843137254902,1,.3725490196078431,.2,.5019607843137255],Name:"Cool",NanColor:[.3725490196078431,.2,.5019607843137255]},{IndexedColors:[.2313725490196079,.407843137254902,.6705882352941176,.1098039215686274,.5843137254901961,.803921568627451,.3058823529411765,.8509803921568627,.9176470588235294,.4509803921568628,.6039215686274509,.8352941176470589,.2588235294117647,.2392156862745098,.6627450980392157,.3137254901960784,.3294117647058823,.5294117647058824,.06274509803921569,.1647058823529412,.3215686274509804],Name:"Blues",NanColor:[.06274509803921569,.1647058823529412,.3215686274509804]},{IndexedColors:[.1098039215686274,.5843137254901961,.803921568627451,.2313725490196079,.407843137254902,.6705882352941176,.4,.2431372549019608,.7176470588235294,.6352941176470588,.3294117647058823,.8117647058823529,.8705882352941177,.3803921568627451,.807843137254902,.8627450980392157,.3803921568627451,.5843137254901961,.2392156862745098,.06274509803921569,.3215686274509804],Name:"Wild Flower",NanColor:[.2392156862745098,.06274509803921569,.3215686274509804]},{IndexedColors:[.396078431372549,.4862745098039216,.2156862745098039,.4588235294117647,.6941176470588235,.00392156862745098,.6980392156862745,.7294117647058823,.1882352941176471,1,.8980392156862745,.02352941176470588,1,.7058823529411765,0,.9764705882352941,.5137254901960784,.1411764705882353],Name:"Citrus",NanColor:[.9764705882352941,.5137254901960784,.1411764705882353]},{IndexedColors:[.4980392156862745,.2313725490196079,.03137254901960784,.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333,.1764705882352941,0,.2941176470588235],Name:"Brewer Diverging Purple-Orange (11)",NanColor:[.1764705882352941,0,.2941176470588235]},{IndexedColors:[.4980392156862745,.2313725490196079,.03137254901960784,.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333,.1764705882352941,0,.2941176470588235],Name:"Brewer Diverging Purple-Orange (10)",NanColor:[.1764705882352941,0,.2941176470588235]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (9)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.8784313725490196,.5098039215686274,.0784313725490196,.9921568627450981,.7215686274509804,.3882352941176471,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6980392156862745,.6705882352941176,.8235294117647058,.5019607843137255,.4509803921568628,.6745098039215687,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (8)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.9450980392156862,.6392156862745098,.2509803921568627,.996078431372549,.8784313725490196,.7137254901960784,.9686274509803922,.9686274509803922,.9686274509803922,.8470588235294118,.8549019607843137,.9215686274509803,.6,.5568627450980392,.7647058823529411,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (7)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.7019607843137254,.3450980392156863,.02352941176470588,.9450980392156862,.6392156862745098,.2509803921568627,.996078431372549,.8784313725490196,.7137254901960784,.8470588235294118,.8549019607843137,.9215686274509803,.6,.5568627450980392,.7647058823529411,.3294117647058823,.1529411764705882,.5333333333333333],Name:"Brewer Diverging Purple-Orange (6)",NanColor:[.3294117647058823,.1529411764705882,.5333333333333333]},{IndexedColors:[.9019607843137255,.3803921568627451,.00392156862745098,.9921568627450981,.7215686274509804,.3882352941176471,.9686274509803922,.9686274509803922,.9686274509803922,.6980392156862745,.6705882352941176,.8235294117647058,.3686274509803922,.2352941176470588,.6],Name:"Brewer Diverging Purple-Orange (5)",NanColor:[.3686274509803922,.2352941176470588,.6]},{IndexedColors:[.9019607843137255,.3803921568627451,.00392156862745098,.9921568627450981,.7215686274509804,.3882352941176471,.6980392156862745,.6705882352941176,.8235294117647058,.3686274509803922,.2352941176470588,.6],Name:"Brewer Diverging Purple-Orange (4)",NanColor:[.3686274509803922,.2352941176470588,.6]},{IndexedColors:[.9450980392156862,.6392156862745098,.2509803921568627,.9686274509803922,.9686274509803922,.9686274509803922,.6,.5568627450980392,.7647058823529411],Name:"Brewer Diverging Purple-Orange (3)",NanColor:[.6,.5568627450980392,.7647058823529411]},{IndexedColors:[.6196078431372549,.00392156862745098,.2588235294117647,.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353,.3686274509803922,.3098039215686275,.6352941176470588],Name:"Brewer Diverging Spectral (11)",NanColor:[.3686274509803922,.3098039215686275,.6352941176470588]},{IndexedColors:[.6196078431372549,.00392156862745098,.2588235294117647,.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353,.3686274509803922,.3098039215686275,.6352941176470588],Name:"Brewer Diverging Spectral (10)",NanColor:[.3686274509803922,.3098039215686275,.6352941176470588]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (9)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9568627450980393,.4274509803921568,.2627450980392157,.9921568627450981,.6823529411764706,.3803921568627451,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6705882352941176,.8666666666666667,.6431372549019608,.4,.7607843137254902,.6470588235294118,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (8)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9882352941176471,.5529411764705883,.3490196078431372,.996078431372549,.8784313725490196,.5450980392156862,1,1,.7490196078431373,.9019607843137255,.9607843137254902,.596078431372549,.6,.8352941176470589,.5803921568627451,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (7)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8352941176470589,.2431372549019608,.3098039215686275,.9882352941176471,.5529411764705883,.3490196078431372,.996078431372549,.8784313725490196,.5450980392156862,.9019607843137255,.9607843137254902,.596078431372549,.6,.8352941176470589,.5803921568627451,.196078431372549,.5333333333333333,.7411764705882353],Name:"Brewer Diverging Spectral (6)",NanColor:[.196078431372549,.5333333333333333,.7411764705882353]},{IndexedColors:[.8431372549019608,.09803921568627451,.1098039215686274,.9921568627450981,.6823529411764706,.3803921568627451,1,1,.7490196078431373,.6705882352941176,.8666666666666667,.6431372549019608,.1686274509803922,.5137254901960784,.7294117647058823],Name:"Brewer Diverging Spectral (5)",NanColor:[.1686274509803922,.5137254901960784,.7294117647058823]},{IndexedColors:[.8431372549019608,.09803921568627451,.1098039215686274,.9921568627450981,.6823529411764706,.3803921568627451,.6705882352941176,.8666666666666667,.6431372549019608,.1686274509803922,.5137254901960784,.7294117647058823],Name:"Brewer Diverging Spectral (4)",NanColor:[.1686274509803922,.5137254901960784,.7294117647058823]},{IndexedColors:[.9882352941176471,.5529411764705883,.3490196078431372,1,1,.7490196078431373,.6,.8352941176470589,.5803921568627451],Name:"Brewer Diverging Spectral (3)",NanColor:[.6,.8352941176470589,.5803921568627451]},{IndexedColors:[.3294117647058823,.1882352941176471,.0196078431372549,.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922,0,.2352941176470588,.1882352941176471],Name:"Brewer Diverging Brown-Blue-Green (11)",NanColor:[0,.2352941176470588,.1882352941176471]},{IndexedColors:[.3294117647058823,.1882352941176471,.0196078431372549,.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922,0,.2352941176470588,.1882352941176471],Name:"Brewer Diverging Brown-Blue-Green (10)",NanColor:[0,.2352941176470588,.1882352941176471]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (9)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.7490196078431373,.5058823529411764,.1764705882352941,.8745098039215686,.7607843137254902,.4901960784313725,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.5019607843137255,.803921568627451,.7568627450980392,.207843137254902,.592156862745098,.5607843137254902,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (8)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.8470588235294118,.7019607843137254,.396078431372549,.9647058823529412,.9098039215686274,.7647058823529411,.9607843137254902,.9607843137254902,.9607843137254902,.7803921568627451,.9176470588235294,.8980392156862745,.3529411764705883,.7058823529411765,.6745098039215687,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (7)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.5490196078431373,.3176470588235294,.0392156862745098,.8470588235294118,.7019607843137254,.396078431372549,.9647058823529412,.9098039215686274,.7647058823529411,.7803921568627451,.9176470588235294,.8980392156862745,.3529411764705883,.7058823529411765,.6745098039215687,.00392156862745098,.4,.3686274509803922],Name:"Brewer Diverging Brown-Blue-Green (6)",NanColor:[.00392156862745098,.4,.3686274509803922]},{IndexedColors:[.6509803921568628,.3803921568627451,.1019607843137255,.8745098039215686,.7607843137254902,.4901960784313725,.9607843137254902,.9607843137254902,.9607843137254902,.5019607843137255,.803921568627451,.7568627450980392,.00392156862745098,.5215686274509804,.4431372549019608],Name:"Brewer Diverging Brown-Blue-Green (5)",NanColor:[.00392156862745098,.5215686274509804,.4431372549019608]},{IndexedColors:[.6509803921568628,.3803921568627451,.1019607843137255,.8745098039215686,.7607843137254902,.4901960784313725,.5019607843137255,.803921568627451,.7568627450980392,.00392156862745098,.5215686274509804,.4431372549019608],Name:"Brewer Diverging Brown-Blue-Green (4)",NanColor:[.00392156862745098,.5215686274509804,.4431372549019608]},{IndexedColors:[.8470588235294118,.7019607843137254,.396078431372549,.9607843137254902,.9607843137254902,.9607843137254902,.3529411764705883,.7058823529411765,.6745098039215687],Name:"Brewer Diverging Brown-Blue-Green (3)",NanColor:[.3529411764705883,.7058823529411765,.6745098039215687]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8980392156862745,.9607843137254902,.9764705882352941,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.4274509803921568,.1725490196078431,0,.2666666666666667,.1058823529411765],Name:"Brewer Sequential Blue-Green (9)",NanColor:[0,.2666666666666667,.1058823529411765]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8980392156862745,.9607843137254902,.9764705882352941,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.3450980392156863,.1411764705882353],Name:"Brewer Sequential Blue-Green (8)",NanColor:[0,.3450980392156863,.1411764705882353]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.8,.9254901960784314,.9019607843137255,.8,.9254901960784314,.9019607843137255,.4,.7607843137254902,.6431372549019608,.2549019607843137,.6823529411764706,.4627450980392157,.1372549019607843,.5450980392156862,.2705882352941176,0,.3450980392156863,.1411764705882353],Name:"Brewer Sequential Blue-Green (7)",NanColor:[0,.3450980392156863,.1411764705882353]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.8,.9254901960784314,.9019607843137255,.6,.8470588235294118,.788235294117647,.4,.7607843137254902,.6431372549019608,.1725490196078431,.6352941176470588,.3725490196078431,0,.4274509803921568,.1725490196078431],Name:"Brewer Sequential Blue-Green (6)",NanColor:[0,.4274509803921568,.1725490196078431]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.6980392156862745,.8862745098039215,.8862745098039215,.4,.7607843137254902,.6431372549019608,.1725490196078431,.6352941176470588,.3725490196078431,0,.4274509803921568,.1725490196078431],Name:"Brewer Sequential Blue-Green (5)",NanColor:[0,.4274509803921568,.1725490196078431]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.6980392156862745,.8862745098039215,.8862745098039215,.4,.7607843137254902,.6431372549019608,.1372549019607843,.5450980392156862,.2705882352941176],Name:"Brewer Sequential Blue-Green (4)",NanColor:[.1372549019607843,.5450980392156862,.2705882352941176]},{IndexedColors:[.8980392156862745,.9607843137254902,.9764705882352941,.6,.8470588235294118,.788235294117647,.1725490196078431,.6352941176470588,.3725490196078431],Name:"Brewer Sequential Blue-Green (3)",NanColor:[.1725490196078431,.6352941176470588,.3725490196078431]},{IndexedColors:[1,1,.8980392156862745,1,.9686274509803922,.7372549019607844,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.6,.203921568627451,.01568627450980392,.4,.1450980392156863,.02352941176470588],Name:"Brewer Sequential Yellow-Orange-Brown (9)",NanColor:[.4,.1450980392156863,.02352941176470588]},{IndexedColors:[1,1,.8980392156862745,1,.9686274509803922,.7372549019607844,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.5490196078431373,.1764705882352941,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (8)",NanColor:[.5490196078431373,.1764705882352941,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.9254901960784314,.4392156862745098,.0784313725490196,.8,.2980392156862745,.00784313725490196,.5490196078431373,.1764705882352941,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (7)",NanColor:[.5490196078431373,.1764705882352941,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8901960784313725,.5686274509803921,.996078431372549,.7686274509803922,.3098039215686275,.996078431372549,.6,.1607843137254902,.8509803921568627,.3725490196078431,.05490196078431372,.6,.203921568627451,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (6)",NanColor:[.6,.203921568627451,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8509803921568627,.5568627450980392,.996078431372549,.6,.1607843137254902,.8509803921568627,.3725490196078431,.05490196078431372,.6,.203921568627451,.01568627450980392],Name:"Brewer Sequential Yellow-Orange-Brown (5)",NanColor:[.6,.203921568627451,.01568627450980392]},{IndexedColors:[1,1,.8313725490196079,.996078431372549,.8509803921568627,.5568627450980392,.996078431372549,.6,.1607843137254902,.8,.2980392156862745,.00784313725490196],Name:"Brewer Sequential Yellow-Orange-Brown (4)",NanColor:[.8,.2980392156862745,.00784313725490196]},{IndexedColors:[1,.9686274509803922,.7372549019607844,.996078431372549,.7686274509803922,.3098039215686275,.8509803921568627,.3725490196078431,.05490196078431372],Name:"Brewer Sequential Yellow-Orange-Brown (3)",NanColor:[.8509803921568627,.3725490196078431,.05490196078431372]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8784313725490196,.9254901960784314,.9568627450980393,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.5058823529411764,.05882352941176471,.4862745098039216,.3019607843137255,0,.2941176470588235],Name:"Brewer Sequential Blue-Purple (9)",NanColor:[.3019607843137255,0,.2941176470588235]},{IndexedColors:[.9686274509803922,.9882352941176471,.9921568627450981,.8784313725490196,.9254901960784314,.9568627450980393,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.4313725490196079,.00392156862745098,.4196078431372549],Name:"Brewer Sequential Blue-Purple (8)",NanColor:[.4313725490196079,.00392156862745098,.4196078431372549]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5490196078431373,.4196078431372549,.6941176470588235,.5333333333333333,.2549019607843137,.615686274509804,.4313725490196079,.00392156862745098,.4196078431372549],Name:"Brewer Sequential Blue-Purple (7)",NanColor:[.4313725490196079,.00392156862745098,.4196078431372549]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7490196078431373,.8274509803921568,.9019607843137255,.6196078431372549,.7372549019607844,.8549019607843137,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.3372549019607843,.6549019607843137,.5058823529411764,.05882352941176471,.4862745098039216],Name:"Brewer Sequential Blue-Purple (6)",NanColor:[.5058823529411764,.05882352941176471,.4862745098039216]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7019607843137254,.803921568627451,.8901960784313725,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.3372549019607843,.6549019607843137,.5058823529411764,.05882352941176471,.4862745098039216],Name:"Brewer Sequential Blue-Purple (5)",NanColor:[.5058823529411764,.05882352941176471,.4862745098039216]},{IndexedColors:[.9294117647058824,.9725490196078431,.984313725490196,.7019607843137254,.803921568627451,.8901960784313725,.5490196078431373,.5882352941176471,.7764705882352941,.5333333333333333,.2549019607843137,.615686274509804],Name:"Brewer Sequential Blue-Purple (4)",NanColor:[.5333333333333333,.2549019607843137,.615686274509804]},{IndexedColors:[.8784313725490196,.9254901960784314,.9568627450980393,.6196078431372549,.7372549019607844,.8549019607843137,.5333333333333333,.3372549019607843,.6549019607843137],Name:"Brewer Sequential Blue-Purple (3)",NanColor:[.5333333333333333,.3372549019607843,.6549019607843137]},{IndexedColors:[.4980392156862745,.788235294117647,.4980392156862745,.7450980392156863,.6823529411764706,.8313725490196079,.9921568627450981,.7529411764705882,.5254901960784314,1,1,.6,.2196078431372549,.4235294117647059,.6901960784313725,.9411764705882353,.00784313725490196,.4980392156862745,.7490196078431373,.3568627450980392,.09019607843137255,.4,.4,.4],Name:"Brewer Qualitative Accent",NanColor:[.4,.4,.4]},{IndexedColors:[.1058823529411765,.6196078431372549,.4666666666666667,.8509803921568627,.3725490196078431,.00784313725490196,.4588235294117647,.4392156862745098,.7019607843137254,.9058823529411765,.1607843137254902,.5411764705882353,.4,.6509803921568628,.1176470588235294,.9019607843137255,.6705882352941176,.00784313725490196,.6509803921568628,.4627450980392157,.1137254901960784,.4,.4,.4],Name:"Brewer Qualitative Dark2",NanColor:[.4,.4,.4]},{IndexedColors:[.4,.7607843137254902,.6470588235294118,.9882352941176471,.5529411764705883,.3843137254901961,.5529411764705883,.6274509803921569,.796078431372549,.9058823529411765,.5411764705882353,.7647058823529411,.6509803921568628,.8470588235294118,.3294117647058823,1,.8509803921568627,.1843137254901961,.8980392156862745,.7686274509803922,.5803921568627451,.7019607843137254,.7019607843137254,.7019607843137254],Name:"Brewer Qualitative Set2",NanColor:[.7019607843137254,.7019607843137254,.7019607843137254]},{IndexedColors:[.7019607843137254,.8862745098039215,.803921568627451,.9921568627450981,.803921568627451,.6745098039215687,.796078431372549,.8352941176470589,.9098039215686274,.9568627450980393,.792156862745098,.8941176470588236,.9019607843137255,.9607843137254902,.788235294117647,1,.9490196078431372,.6823529411764706,.9450980392156862,.8862745098039215,.8,.8,.8,.8],Name:"Brewer Qualitative Pastel2",NanColor:[.8,.8,.8]},{IndexedColors:[.984313725490196,.7058823529411765,.6823529411764706,.7019607843137254,.803921568627451,.8901960784313725,.8,.9215686274509803,.7725490196078432,.8705882352941177,.796078431372549,.8941176470588236,.996078431372549,.8509803921568627,.6509803921568628,1,1,.8,.8980392156862745,.8470588235294118,.7411764705882353,.9921568627450981,.8549019607843137,.9254901960784314,.9490196078431372,.9490196078431372,.9490196078431372],Name:"Brewer Qualitative Pastel1",NanColor:[.9490196078431372,.9490196078431372,.9490196078431372]},{IndexedColors:[.8941176470588236,.1019607843137255,.1098039215686274,.2156862745098039,.4941176470588236,.7215686274509804,.3019607843137255,.6862745098039216,.2901960784313726,.596078431372549,.3058823529411765,.6392156862745098,1,.4980392156862745,0,1,1,.2,.6509803921568628,.3372549019607843,.1568627450980392,.9686274509803922,.5058823529411764,.7490196078431373,.6,.6,.6],Name:"Brewer Qualitative Set1",NanColor:[.6,.6,.6]},{IndexedColors:[.6509803921568628,.807843137254902,.8901960784313725,.1215686274509804,.4705882352941176,.7058823529411765,.6980392156862745,.8745098039215686,.5411764705882353,.2,.6274509803921569,.1725490196078431,.984313725490196,.6039215686274509,.6,.8901960784313725,.1019607843137255,.1098039215686274,.9921568627450981,.7490196078431373,.4352941176470588,1,.4980392156862745,0,.792156862745098,.6980392156862745,.8392156862745098,.4156862745098039,.2392156862745098,.6039215686274509,1,1,.6],Name:"Brewer Qualitative Paired",NanColor:[1,1,.6]},{IndexedColors:[.5529411764705883,.8274509803921568,.7803921568627451,1,1,.7019607843137254,.7450980392156863,.7294117647058823,.8549019607843137,.984313725490196,.5019607843137255,.4470588235294118,.5019607843137255,.6941176470588235,.8274509803921568,.9921568627450981,.7058823529411765,.3843137254901961,.7019607843137254,.8705882352941177,.4117647058823529,.9882352941176471,.803921568627451,.8980392156862745,.8509803921568627,.8509803921568627,.8509803921568627,.7372549019607844,.5019607843137255,.7411764705882353,.8,.9215686274509803,.7725490196078432,1,.9294117647058824,.4352941176470588],Name:"Brewer Qualitative Set3",NanColor:[1,.9294117647058824,.4352941176470588]},{IndexedColors:[1,0,0,1,.862745,0,0,.695201,0],Name:"Traffic Lights",NanColor:[.803922,0,.803922]},{IndexedColors:[.908659,.604013,.581857,1,.862745,0,0,.695201,0],Name:"Traffic Lights For Deuteranopes",NanColor:[.803922,0,.803922]},{IndexedColors:[.4196078431372549,0,.07058823529411765,.9019607843137255,.9411764705882353,.0196078431372549,.01568627450980392,.6196078431372549,.00784313725490196],Name:"Traffic Lights For Deuteranopes 2",NanColor:[.803922,0,.803922]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Muted Blue-Green",NanColor:[.25,0,0],RGBPoints:[0,.109804,.27451,.301961,.02,.129412,.309804,.341176,.05,.14902,.341176,.380392,.1,.188235,.403922,.458824,.15,.227451,.447059,.521569,.2,.290196,.494118,.588235,.25,.368627,.552941,.670588,.3,.458824,.619608,.74902,.35,.588235,.713725,.85098,.4,.72549,.815686,.941176,.45,.831373,.882353,.980392,.475,.909804,.933333,1,.5,.980392,.984314,1,.5,.996078,1,.94902,.5,1,1,.980392,.5,.980392,.984314,1,.525,.972549,.988235,.890196,.55,.917647,.960784,.835294,.6,.835294,.921569,.772549,.65,.768627,.901961,.737255,.7,.670588,.831373,.654902,.75,.576471,.760784,.584314,.8,.498039,.678431,.521569,.85,.392157,.560784,.427451,.9,.294118,.45098,.333333,.95,.211765,.34902,.254902,1,.152941,.278431,.196078]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Green-Blue Asymmetric Divergent (62Blbc)",NanColor:[.25,0,0],RGBPoints:[0,.121569,.2,.145098,.05,.196078,.301961,.223529,.1,.258824,.4,.278431,.2,.341176,.54902,.341176,.25,.419608,.619608,.376471,.3,.545098,.701961,.392157,.35,.643137,.780392,.403922,.4,.729412,.819608,.45098,.45,.811765,.870588,.521569,.5,.898039,.909804,.564706,.55,.941176,.92549,.686275,.6,.960784,.94902,.776471,.64,1,1,1,.65,.890196,.988235,.972549,.7,.721569,.894118,.901961,.75,.631373,.823529,.839216,.8,.517647,.662745,.701961,.85,.384314,.494118,.54902,.9,.298039,.360784,.45098,.95,.223529,.25098,.34902,.99,.156863,.172549,.25098,1,.137255,.137255,.188235]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Asymmtrical Earth Tones (6_21b)",NanColor:[.25,0,0],RGBPoints:[0,.141176,.14902,.2,.05,.215686,.258824,.321569,.1,.243137,.368627,.380392,.15,.27451,.439216,.4,.2,.32549,.501961,.384314,.25,.403922,.6,.419608,.3,.486275,.701961,.454902,.35,.556863,.74902,.494118,.4,.670588,.8,.545098,.5,.854902,.901961,.631373,.55,.92549,.941176,.694118,.6,.960784,.94902,.776471,.65,.988235,.968627,.909804,.7,.839216,.815686,.772549,.75,.701961,.662745,.615686,.8,.6,.529412,.478431,.85,.501961,.403922,.360784,.9,.439216,.313725,.290196,1,.301961,.164706,.176471]},{ColorSpace:"Lab",Creator:"Francesca Samsel",Name:"Yellow 15",NanColor:[.25,0,0],RGBPoints:[0,1,1,.988235,.002,1,1,.988235,.05,.984314,.988235,.843137,.1,.988235,.988235,.741176,.15,.980392,.968627,.654902,.2,.980392,.945098,.576471,.25,.968627,.905882,.486275,.3,.968627,.862745,.388235,.35,.960784,.803922,.286275,.4,.94902,.741176,.219608,.45,.941176,.678431,.14902,.5,.929412,.607843,.094118,.55,.921569,.545098,.054902,.6,.909804,.486275,.035294,.65,.890196,.411765,.019608,.7,.8,.305882,0,.75,.760784,.239216,0,.8,.678431,.180392,.011765,.85,.6,.121569,.023529,.9,.501961,.054902,.031373,.95,.4,.039216,.058824,1,.301961,.047059,.090196]},{ColorSpace:"Diverging",Name:"Magma (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.001462,466e-6,.013866,.003922,.002258,.001295,.018331,.007843,.003279,.002305,.023708,.011765,.004512,.00349,.029965,.015686,.00595,.004843,.03713,.019608,.007588,.006356,.044973,.023529,.009426,.008022,.052844,.027451,.011465,.009828,.06075,.031373,.013708,.011771,.068667,.035294,.016156,.01384,.076603,.039216,.018815,.016026,.084584,.043137,.021692,.01832,.09261,.047059,.024792,.020715,.100676,.05098,.028123,.023201,.108787,.054902,.031696,.025765,.116965,.058824,.03552,.028397,.125209,.062745,.039608,.03109,.133515,.066667,.04383,.03383,.141886,.070588,.048062,.036607,.150327,.07451,.05232,.039407,.158841,.078431,.056615,.04216,.167446,.082353,.060949,.044794,.176129,.086275,.06533,.047318,.184892,.090196,.069764,.049726,.193735,.094118,.074257,.052017,.20266,.098039,.078815,.054184,.211667,.101961,.083446,.056225,.220755,.105882,.088155,.058133,.229922,.109804,.092949,.059904,.239164,.113725,.097833,.061531,.248477,.117647,.102815,.06301,.257854,.121569,.107899,.064335,.267289,.12549,.113094,.065492,.276784,.129412,.118405,.066479,.286321,.133333,.123833,.067295,.295879,.137255,.12938,.067935,.305443,.141176,.135053,.068391,.315,.145098,.140858,.068654,.324538,.14902,.146785,.068738,.334011,.152941,.152839,.068637,.343404,.156863,.159018,.068354,.352688,.160784,.165308,.067911,.361816,.164706,.171713,.067305,.370771,.168627,.178212,.066576,.379497,.172549,.184801,.065732,.387973,.176471,.19146,.064818,.396152,.180392,.198177,.063862,.404009,.184314,.204935,.062907,.411514,.188235,.211718,.061992,.418647,.192157,.218512,.061158,.425392,.196078,.225302,.060445,.431742,.2,.232077,.059889,.437695,.203922,.238826,.059517,.443256,.207843,.245543,.059352,.448436,.211765,.25222,.059415,.453248,.215686,.258857,.059706,.45771,.219608,.265447,.060237,.46184,.223529,.271994,.060994,.46566,.227451,.278493,.061978,.46919,.231373,.284951,.063168,.472451,.235294,.291366,.064553,.475462,.239216,.29774,.066117,.478243,.243137,.304081,.067835,.480812,.247059,.310382,.069702,.483186,.25098,.316654,.07169,.48538,.254902,.322899,.073782,.487408,.258824,.329114,.075972,.489287,.262745,.335308,.078236,.491024,.266667,.341482,.080564,.492631,.270588,.347636,.082946,.494121,.27451,.353773,.085373,.495501,.278431,.359898,.087831,.496778,.282353,.366012,.090314,.49796,.286275,.372116,.092816,.499053,.290196,.378211,.095332,.500067,.294118,.384299,.097855,.501002,.298039,.390384,.100379,.501864,.301961,.396467,.102902,.502658,.305882,.402548,.10542,.503386,.309804,.408629,.10793,.504052,.313725,.414709,.110431,.504662,.317647,.420791,.11292,.505215,.321569,.426877,.115395,.505714,.32549,.432967,.117855,.50616,.329412,.439062,.120298,.506555,.333333,.445163,.122724,.506901,.337255,.451271,.125132,.507198,.341176,.457386,.127522,.507448,.345098,.463508,.129893,.507652,.34902,.46964,.132245,.507809,.352941,.47578,.134577,.507921,.356863,.481929,.136891,.507989,.360784,.488088,.139186,.508011,.364706,.494258,.141462,.507988,.368627,.500438,.143719,.50792,.372549,.506629,.145958,.507806,.376471,.512831,.148179,.507648,.380392,.519045,.150383,.507443,.384314,.52527,.152569,.507192,.388235,.531507,.154739,.506895,.392157,.537755,.156894,.506551,.396078,.544015,.159033,.506159,.4,.550287,.161158,.505719,.403922,.556571,.163269,.50523,.407843,.562866,.165368,.504692,.411765,.569172,.167454,.504105,.415686,.57549,.16953,.503466,.419608,.581819,.171596,.502777,.423529,.588158,.173652,.502035,.427451,.594508,.175701,.501241,.431373,.600868,.177743,.500394,.435294,.607238,.179779,.499492,.439216,.613617,.181811,.498536,.443137,.620005,.18384,.497524,.447059,.626401,.185867,.496456,.45098,.632805,.187893,.495332,.454902,.639216,.189921,.49415,.458824,.645633,.191952,.49291,.462745,.652056,.193986,.491611,.466667,.658483,.196027,.490253,.470588,.664915,.198075,.488836,.47451,.671349,.200133,.487358,.478431,.677786,.202203,.485819,.482353,.684224,.204286,.484219,.486275,.690661,.206384,.482558,.490196,.697098,.208501,.480835,.494118,.703532,.210638,.479049,.498039,.709962,.212797,.477201,.501961,.716387,.214982,.47529,.505882,.722805,.217194,.473316,.509804,.729216,.219437,.471279,.513725,.735616,.221713,.46918,.517647,.742004,.224025,.467018,.521569,.748378,.226377,.464794,.52549,.754737,.228772,.462509,.529412,.761077,.231214,.460162,.533333,.767398,.233705,.457755,.537255,.773695,.236249,.455289,.541176,.779968,.238851,.452765,.545098,.786212,.241514,.450184,.54902,.792427,.244242,.447543,.552941,.798608,.24704,.444848,.556863,.804752,.249911,.442102,.560784,.810855,.252861,.439305,.564706,.816914,.255895,.436461,.568627,.822926,.259016,.433573,.572549,.828886,.262229,.430644,.576471,.834791,.26554,.427671,.580392,.840636,.268953,.424666,.584314,.846416,.272473,.421631,.588235,.852126,.276106,.418573,.592157,.857763,.279857,.415496,.596078,.86332,.283729,.412403,.6,.868793,.287728,.409303,.603922,.874176,.291859,.406205,.607843,.879464,.296125,.403118,.611765,.884651,.30053,.400047,.615686,.889731,.305079,.397002,.619608,.8947,.309773,.393995,.623529,.899552,.314616,.391037,.627451,.904281,.31961,.388137,.631373,.908884,.324755,.385308,.635294,.913354,.330052,.382563,.639216,.917689,.3355,.379915,.643137,.921884,.341098,.377376,.647059,.925937,.346844,.374959,.65098,.929845,.352734,.372677,.654902,.933606,.358764,.370541,.658824,.937221,.364929,.368567,.662745,.940687,.371224,.366762,.666667,.944006,.377643,.365136,.670588,.94718,.384178,.363701,.67451,.95021,.39082,.362468,.678431,.953099,.397563,.361438,.682353,.955849,.4044,.360619,.686275,.958464,.411324,.360014,.690196,.960949,.418323,.35963,.694118,.96331,.42539,.359469,.698039,.965549,.432519,.359529,.701961,.967671,.439703,.35981,.705882,.96968,.446936,.360311,.709804,.971582,.45421,.36103,.713725,.973381,.46152,.361965,.717647,.975082,.468861,.363111,.721569,.97669,.476226,.364466,.72549,.97821,.483612,.366025,.729412,.979645,.491014,.367783,.733333,.981,.498428,.369734,.737255,.982279,.505851,.371874,.741176,.983485,.51328,.374198,.745098,.984622,.520713,.376698,.74902,.985693,.528148,.379371,.752941,.9867,.535582,.38221,.756863,.987646,.543015,.38521,.760784,.988533,.550446,.388365,.764706,.989363,.557873,.391671,.768627,.990138,.565296,.395122,.772549,.990871,.572706,.398714,.776471,.991558,.580107,.402441,.780392,.992196,.587502,.406299,.784314,.992785,.594891,.410283,.788235,.993326,.602275,.41439,.792157,.993834,.609644,.418613,.796078,.994309,.616999,.42295,.8,.994738,.62435,.427397,.803922,.995122,.631696,.431951,.807843,.99548,.639027,.436607,.811765,.99581,.646344,.441361,.815686,.996096,.653659,.446213,.819608,.996341,.660969,.45116,.823529,.99658,.668256,.456192,.827451,.996775,.675541,.461314,.831373,.996925,.682828,.466526,.835294,.997077,.690088,.471811,.839216,.997186,.697349,.477182,.843137,.997254,.704611,.482635,.847059,.997325,.711848,.488154,.85098,.997351,.719089,.493755,.854902,.997351,.726324,.499428,.858824,.997341,.733545,.505167,.862745,.997285,.740772,.510983,.866667,.997228,.747981,.516859,.870588,.997138,.75519,.522806,.87451,.997019,.762398,.528821,.878431,.996898,.769591,.534892,.882353,.996727,.776795,.541039,.886275,.996571,.783977,.547233,.890196,.996369,.791167,.553499,.894118,.996162,.798348,.55982,.898039,.995932,.805527,.566202,.901961,.99568,.812706,.572645,.905882,.995424,.819875,.57914,.909804,.995131,.827052,.585701,.913725,.994851,.834213,.592307,.917647,.994524,.841387,.598983,.921569,.994222,.84854,.605696,.92549,.993866,.855711,.612482,.929412,.993545,.862859,.619299,.933333,.99317,.870024,.626189,.937255,.992831,.877168,.633109,.941176,.99244,.88433,.640099,.945098,.992089,.89147,.647116,.94902,.991688,.898627,.654202,.952941,.991332,.905763,.661309,.956863,.99093,.912915,.668481,.960784,.99057,.920049,.675675,.964706,.990175,.927196,.682926,.968627,.989815,.934329,.690198,.972549,.989434,.94147,.697519,.976471,.989077,.948604,.704863,.980392,.988717,.955742,.712242,.984314,.988367,.962878,.719649,.988235,.988033,.970012,.727077,.992157,.987691,.977154,.734536,.996078,.987387,.984288,.742002,1,.987053,.991438,.749504]},{ColorSpace:"Diverging",Name:"Inferno (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.001462,466e-6,.013866,.003922,.002267,.00127,.01857,.007843,.003299,.002249,.024239,.011765,.004547,.003392,.030909,.015686,.006006,.004692,.038558,.019608,.007676,.006136,.046836,.023529,.009561,.007713,.055143,.027451,.011663,.009417,.06346,.031373,.013995,.011225,.071862,.035294,.016561,.013136,.080282,.039216,.019373,.015133,.088767,.043137,.022447,.017199,.097327,.047059,.025793,.019331,.10593,.05098,.029432,.021503,.114621,.054902,.033385,.023702,.123397,.058824,.037668,.025921,.132232,.062745,.042253,.028139,.141141,.066667,.046915,.030324,.150164,.070588,.051644,.032474,.159254,.07451,.056449,.034569,.168414,.078431,.06134,.03659,.177642,.082353,.066331,.038504,.186962,.086275,.071429,.040294,.196354,.090196,.076637,.041905,.205799,.094118,.081962,.043328,.215289,.098039,.087411,.044556,.224813,.101961,.09299,.045583,.234358,.105882,.098702,.046402,.243904,.109804,.104551,.047008,.25343,.113725,.110536,.047399,.262912,.117647,.116656,.047574,.272321,.121569,.122908,.047536,.281624,.12549,.129285,.047293,.290788,.129412,.135778,.046856,.299776,.133333,.142378,.046242,.308553,.137255,.149073,.045468,.317085,.141176,.15585,.044559,.325338,.145098,.162689,.043554,.333277,.14902,.169575,.042489,.340874,.152941,.176493,.041402,.348111,.156863,.183429,.040329,.354971,.160784,.190367,.039309,.361447,.164706,.197297,.0384,.367535,.168627,.204209,.037632,.373238,.172549,.211095,.03703,.378563,.176471,.217949,.036615,.383522,.180392,.224763,.036405,.388129,.184314,.231538,.036405,.3924,.188235,.238273,.036621,.396353,.192157,.244967,.037055,.400007,.196078,.25162,.037705,.403378,.2,.258234,.038571,.406485,.203922,.26481,.039647,.409345,.207843,.271347,.040922,.411976,.211765,.27785,.042353,.414392,.215686,.284321,.043933,.416608,.219608,.290763,.045644,.418637,.223529,.297178,.04747,.420491,.227451,.303568,.049396,.422182,.231373,.309935,.051407,.423721,.235294,.316282,.05349,.425116,.239216,.32261,.055634,.426377,.243137,.328921,.057827,.427511,.247059,.335217,.06006,.428524,.25098,.3415,.062325,.429425,.254902,.347771,.064616,.430217,.258824,.354032,.066925,.430906,.262745,.360284,.069247,.431497,.266667,.366529,.071579,.431994,.270588,.372768,.073915,.4324,.27451,.379001,.076253,.432719,.278431,.385228,.078591,.432955,.282353,.391453,.080927,.433109,.286275,.397674,.083257,.433183,.290196,.403894,.08558,.433179,.294118,.410113,.087896,.433098,.298039,.416331,.090203,.432943,.301961,.422549,.092501,.432714,.305882,.428768,.09479,.432412,.309804,.434987,.097069,.432039,.313725,.441207,.099338,.431594,.317647,.447428,.101597,.43108,.321569,.453651,.103848,.430498,.32549,.459875,.106089,.429846,.329412,.4661,.108322,.429125,.333333,.472328,.110547,.428334,.337255,.478558,.112764,.427475,.341176,.484789,.114974,.426548,.345098,.491022,.117179,.425552,.34902,.497257,.119379,.424488,.352941,.503493,.121575,.423356,.356863,.50973,.123769,.422156,.360784,.515967,.12596,.420887,.364706,.522206,.12815,.419549,.368627,.528444,.130341,.418142,.372549,.534683,.132534,.416667,.376471,.54092,.134729,.415123,.380392,.547157,.136929,.413511,.384314,.553392,.139134,.411829,.388235,.559624,.141346,.410078,.392157,.565854,.143567,.408258,.396078,.572081,.145797,.406369,.4,.578304,.148039,.404411,.403922,.584521,.150294,.402385,.407843,.590734,.152563,.40029,.411765,.59694,.154848,.398125,.415686,.603139,.157151,.395891,.419608,.60933,.159474,.393589,.423529,.615513,.161817,.391219,.427451,.621685,.164184,.388781,.431373,.627847,.166575,.386276,.435294,.633998,.168992,.383704,.439216,.640135,.171438,.381065,.443137,.64626,.173914,.378359,.447059,.652369,.176421,.375586,.45098,.658463,.178962,.372748,.454902,.66454,.181539,.369846,.458824,.670599,.184153,.366879,.462745,.676638,.186807,.363849,.466667,.682656,.189501,.360757,.470588,.688653,.192239,.357603,.47451,.694627,.195021,.354388,.478431,.700576,.197851,.351113,.482353,.7065,.200728,.347777,.486275,.712396,.203656,.344383,.490196,.718264,.206636,.340931,.494118,.724103,.20967,.337424,.498039,.729909,.212759,.333861,.501961,.735683,.215906,.330245,.505882,.741423,.219112,.326576,.509804,.747127,.222378,.322856,.513725,.752794,.225706,.319085,.517647,.758422,.229097,.315266,.521569,.76401,.232554,.311399,.52549,.769556,.236077,.307485,.529412,.775059,.239667,.303526,.533333,.780517,.243327,.299523,.537255,.785929,.247056,.295477,.541176,.791293,.250856,.29139,.545098,.796607,.254728,.287264,.54902,.801871,.258674,.283099,.552941,.807082,.262692,.278898,.556863,.812239,.266786,.274661,.560784,.817341,.270954,.27039,.564706,.822386,.275197,.266085,.568627,.827372,.279517,.26175,.572549,.832299,.283913,.257383,.576471,.837165,.288385,.252988,.580392,.841969,.292933,.248564,.584314,.846709,.297559,.244113,.588235,.851384,.30226,.239636,.592157,.855992,.307038,.235133,.596078,.860533,.311892,.230606,.6,.865006,.316822,.226055,.603922,.869409,.321827,.221482,.607843,.873741,.326906,.216886,.611765,.878001,.33206,.212268,.615686,.882188,.337287,.207628,.619608,.886302,.342586,.202968,.623529,.890341,.347957,.198286,.627451,.894305,.353399,.193584,.631373,.898192,.358911,.18886,.635294,.902003,.364492,.184116,.639216,.905735,.37014,.17935,.643137,.90939,.375856,.174563,.647059,.912966,.381636,.169755,.65098,.916462,.387481,.164924,.654902,.919879,.393389,.16007,.658824,.923215,.399359,.155193,.662745,.92647,.405389,.150292,.666667,.929644,.411479,.145367,.670588,.932737,.417627,.140417,.67451,.935747,.423831,.13544,.678431,.938675,.430091,.130438,.682353,.941521,.436405,.125409,.686275,.944285,.442772,.120354,.690196,.946965,.449191,.115272,.694118,.949562,.45566,.110164,.698039,.952075,.462178,.105031,.701961,.954506,.468744,.099874,.705882,.956852,.475356,.094695,.709804,.959114,.482014,.089499,.713725,.961293,.488716,.084289,.717647,.963387,.495462,.079073,.721569,.965397,.502249,.073859,.72549,.967322,.509078,.068659,.729412,.969163,.515946,.063488,.733333,.970919,.522853,.058367,.737255,.97259,.529798,.053324,.741176,.974176,.53678,.048392,.745098,.975677,.543798,.043618,.74902,.977092,.55085,.03905,.752941,.978422,.557937,.034931,.756863,.979666,.565057,.031409,.760784,.980824,.572209,.028508,.764706,.981895,.579392,.02625,.768627,.982881,.586606,.024661,.772549,.983779,.593849,.02377,.776471,.984591,.601122,.023606,.780392,.985315,.608422,.024202,.784314,.985952,.61575,.025592,.788235,.986502,.623105,.027814,.792157,.986964,.630485,.030908,.796078,.987337,.63789,.034916,.8,.987622,.64532,.039886,.803922,.987819,.652773,.045581,.807843,.987926,.66025,.05175,.811765,.987945,.667748,.058329,.815686,.987874,.675267,.065257,.819608,.987714,.682807,.072489,.823529,.987464,.690366,.07999,.827451,.987124,.697944,.087731,.831373,.986694,.70554,.095694,.835294,.986175,.713153,.103863,.839216,.985566,.720782,.112229,.843137,.984865,.728427,.120785,.847059,.984075,.736087,.129527,.85098,.983196,.743758,.138453,.854902,.982228,.751442,.147565,.858824,.981173,.759135,.156863,.862745,.980032,.766837,.166353,.866667,.978806,.774545,.176037,.870588,.977497,.782258,.185923,.87451,.976108,.789974,.196018,.878431,.974638,.797692,.206332,.882353,.973088,.805409,.216877,.886275,.971468,.813122,.227658,.890196,.969783,.820825,.238686,.894118,.968041,.828515,.249972,.898039,.966243,.836191,.261534,.901961,.964394,.843848,.273391,.905882,.962517,.851476,.285546,.909804,.960626,.859069,.29801,.913725,.95872,.866624,.31082,.917647,.956834,.874129,.323974,.921569,.954997,.881569,.337475,.92549,.953215,.888942,.351369,.929412,.951546,.896226,.365627,.933333,.950018,.903409,.380271,.937255,.948683,.910473,.395289,.941176,.947594,.917399,.410665,.945098,.946809,.924168,.426373,.94902,.946392,.930761,.442367,.952941,.946403,.937159,.458592,.956863,.946903,.943348,.47497,.960784,.947937,.949318,.491426,.964706,.949545,.955063,.50786,.968627,.95174,.960587,.524203,.972549,.954529,.965896,.540361,.976471,.957896,.971003,.556275,.980392,.961812,.975924,.571925,.984314,.966249,.980678,.587206,.988235,.971162,.985282,.602154,.992157,.976511,.989753,.61676,.996078,.982257,.994109,.631017,1,.988362,.998364,.644924]},{ColorSpace:"Diverging",Name:"Plasma (matplotlib)",NanColor:[0,1,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Nathaniel J. Smith & Stefan van der Walt",RGBPoints:[0,.050383,.029803,.527975,.003922,.063536,.028426,.533124,.007843,.075353,.027206,.538007,.011765,.086222,.026125,.542658,.015686,.096379,.025165,.547103,.019608,.10598,.024309,.551368,.023529,.115124,.023556,.555468,.027451,.123903,.022878,.559423,.031373,.132381,.022258,.56325,.035294,.140603,.021687,.566959,.039216,.148607,.021154,.570562,.043137,.156421,.020651,.574065,.047059,.16407,.020171,.577478,.05098,.171574,.019706,.580806,.054902,.17895,.019252,.584054,.058824,.186213,.018803,.587228,.062745,.193374,.018354,.59033,.066667,.200445,.017902,.593364,.070588,.207435,.017442,.596333,.07451,.21435,.016973,.599239,.078431,.221197,.016497,.602083,.082353,.227983,.016007,.604867,.086275,.234715,.015502,.607592,.090196,.241396,.014979,.610259,.094118,.248032,.014439,.612868,.098039,.254627,.013882,.615419,.101961,.261183,.013308,.617911,.105882,.267703,.012716,.620346,.109804,.274191,.012109,.622722,.113725,.280648,.011488,.625038,.117647,.287076,.010855,.627295,.121569,.293478,.010213,.62949,.12549,.299855,.009561,.631624,.129412,.30621,.008902,.633694,.133333,.312543,.008239,.6357,.137255,.318856,.007576,.63764,.141176,.32515,.006915,.639512,.145098,.331426,.006261,.641316,.14902,.337683,.005618,.643049,.152941,.343925,.004991,.64471,.156863,.35015,.004382,.646298,.160784,.356359,.003798,.64781,.164706,.362553,.003243,.649245,.168627,.368733,.002724,.650601,.172549,.374897,.002245,.651876,.176471,.381047,.001814,.653068,.180392,.387183,.001434,.654177,.184314,.393304,.001114,.655199,.188235,.399411,859e-6,.656133,.192157,.405503,678e-6,.656977,.196078,.41158,577e-6,.65773,.2,.417642,564e-6,.65839,.203922,.423689,646e-6,.658956,.207843,.429719,831e-6,.659425,.211765,.435734,.001127,.659797,.215686,.441732,.00154,.660069,.219608,.447714,.00208,.66024,.223529,.453677,.002755,.66031,.227451,.459623,.003574,.660277,.231373,.46555,.004545,.660139,.235294,.471457,.005678,.659897,.239216,.477344,.00698,.659549,.243137,.48321,.00846,.659095,.247059,.489055,.010127,.658534,.25098,.494877,.01199,.657865,.254902,.500678,.014055,.657088,.258824,.506454,.016333,.656202,.262745,.512206,.018833,.655209,.266667,.517933,.021563,.654109,.270588,.523633,.024532,.652901,.27451,.529306,.027747,.651586,.278431,.534952,.031217,.650165,.282353,.54057,.03495,.64864,.286275,.546157,.038954,.64701,.290196,.551715,.043136,.645277,.294118,.557243,.047331,.643443,.298039,.562738,.051545,.641509,.301961,.568201,.055778,.639477,.305882,.573632,.060028,.637349,.309804,.579029,.064296,.635126,.313725,.584391,.068579,.632812,.317647,.589719,.072878,.630408,.321569,.595011,.07719,.627917,.32549,.600266,.081516,.625342,.329412,.605485,.085854,.622686,.333333,.610667,.090204,.619951,.337255,.615812,.094564,.61714,.341176,.620919,.098934,.614257,.345098,.625987,.103312,.611305,.34902,.631017,.107699,.608287,.352941,.636008,.112092,.605205,.356863,.640959,.116492,.602065,.360784,.645872,.120898,.598867,.364706,.650746,.125309,.595617,.368627,.65558,.129725,.592317,.372549,.660374,.134144,.588971,.376471,.665129,.138566,.585582,.380392,.669845,.142992,.582154,.384314,.674522,.147419,.578688,.388235,.67916,.151848,.575189,.392157,.683758,.156278,.57166,.396078,.688318,.160709,.568103,.4,.69284,.165141,.564522,.403922,.697324,.169573,.560919,.407843,.701769,.174005,.557296,.411765,.706178,.178437,.553657,.415686,.710549,.182868,.550004,.419608,.714883,.187299,.546338,.423529,.719181,.191729,.542663,.427451,.723444,.196158,.538981,.431373,.72767,.200586,.535293,.435294,.731862,.205013,.531601,.439216,.736019,.209439,.527908,.443137,.740143,.213864,.524216,.447059,.744232,.218288,.520524,.45098,.748289,.222711,.516834,.454902,.752312,.227133,.513149,.458824,.756304,.231555,.509468,.462745,.760264,.235976,.505794,.466667,.764193,.240396,.502126,.470588,.76809,.244817,.498465,.47451,.771958,.249237,.494813,.478431,.775796,.253658,.491171,.482353,.779604,.258078,.487539,.486275,.783383,.2625,.483918,.490196,.787133,.266922,.480307,.494118,.790855,.271345,.476706,.498039,.794549,.27577,.473117,.501961,.798216,.280197,.469538,.505882,.801855,.284626,.465971,.509804,.805467,.289057,.462415,.513725,.809052,.293491,.45887,.517647,.812612,.297928,.455338,.521569,.816144,.302368,.451816,.52549,.819651,.306812,.448306,.529412,.823132,.311261,.444806,.533333,.826588,.315714,.441316,.537255,.830018,.320172,.437836,.541176,.833422,.324635,.434366,.545098,.836801,.329105,.430905,.54902,.840155,.33358,.427455,.552941,.843484,.338062,.424013,.556863,.846788,.342551,.420579,.560784,.850066,.347048,.417153,.564706,.853319,.351553,.413734,.568627,.856547,.356066,.410322,.572549,.85975,.360588,.406917,.576471,.862927,.365119,.403519,.580392,.866078,.36966,.400126,.584314,.869203,.374212,.396738,.588235,.872303,.378774,.393355,.592157,.875376,.383347,.389976,.596078,.878423,.387932,.3866,.6,.881443,.392529,.383229,.603922,.884436,.397139,.37986,.607843,.887402,.401762,.376494,.611765,.89034,.406398,.37313,.615686,.89325,.411048,.369768,.619608,.896131,.415712,.366407,.623529,.898984,.420392,.363047,.627451,.901807,.425087,.359688,.631373,.904601,.429797,.356329,.635294,.907365,.434524,.35297,.639216,.910098,.439268,.34961,.643137,.9128,.444029,.346251,.647059,.915471,.448807,.34289,.65098,.918109,.453603,.339529,.654902,.920714,.458417,.336166,.658824,.923287,.463251,.332801,.662745,.925825,.468103,.329435,.666667,.928329,.472975,.326067,.670588,.930798,.477867,.322697,.67451,.933232,.48278,.319325,.678431,.93563,.487712,.315952,.682353,.93799,.492667,.312575,.686275,.940313,.497642,.309197,.690196,.942598,.502639,.305816,.694118,.944844,.507658,.302433,.698039,.947051,.512699,.299049,.701961,.949217,.517763,.295662,.705882,.951344,.52285,.292275,.709804,.953428,.52796,.288883,.713725,.95547,.533093,.28549,.717647,.957469,.53825,.282096,.721569,.959424,.543431,.278701,.72549,.961336,.548636,.275305,.729412,.963203,.553865,.271909,.733333,.965024,.559118,.268513,.737255,.966798,.564396,.265118,.741176,.968526,.5697,.261721,.745098,.970205,.575028,.258325,.74902,.971835,.580382,.254931,.752941,.973416,.585761,.25154,.756863,.974947,.591165,.248151,.760784,.976428,.596595,.244767,.764706,.977856,.602051,.241387,.768627,.979233,.607532,.238013,.772549,.980556,.613039,.234646,.776471,.981826,.618572,.231287,.780392,.983041,.624131,.227937,.784314,.984199,.629718,.224595,.788235,.985301,.63533,.221265,.792157,.986345,.640969,.217948,.796078,.987332,.646633,.214648,.8,.98826,.652325,.211364,.803922,.989128,.658043,.2081,.807843,.989935,.663787,.204859,.811765,.990681,.669558,.201642,.815686,.991365,.675355,.198453,.819608,.991985,.681179,.195295,.823529,.992541,.68703,.19217,.827451,.993032,.692907,.189084,.831373,.993456,.69881,.186041,.835294,.993814,.704741,.183043,.839216,.994103,.710698,.180097,.843137,.994324,.716681,.177208,.847059,.994474,.722691,.174381,.85098,.994553,.728728,.171622,.854902,.994561,.734791,.168938,.858824,.994495,.74088,.166335,.862745,.994355,.746995,.163821,.866667,.994141,.753137,.161404,.870588,.993851,.759304,.159092,.87451,.993482,.765499,.156891,.878431,.993033,.77172,.154808,.882353,.992505,.777967,.152855,.886275,.991897,.784239,.151042,.890196,.991209,.790537,.149377,.894118,.990439,.796859,.14787,.898039,.989587,.803205,.146529,.901961,.988648,.809579,.145357,.905882,.987621,.815978,.144363,.909804,.986509,.822401,.143557,.913725,.985314,.828846,.142945,.917647,.984031,.835315,.142528,.921569,.982653,.841812,.142303,.92549,.98119,.848329,.142279,.929412,.979644,.854866,.142453,.933333,.977995,.861432,.142808,.937255,.976265,.868016,.143351,.941176,.974443,.874622,.144061,.945098,.97253,.88125,.144923,.94902,.970533,.887896,.145919,.952941,.968443,.894564,.147014,.956863,.966271,.901249,.14818,.960784,.964021,.90795,.14937,.964706,.961681,.914672,.15052,.968627,.959276,.921407,.151566,.972549,.956808,.928152,.152409,.976471,.954287,.934908,.152921,.980392,.951726,.941671,.152925,.984314,.949151,.948435,.152178,.988235,.946602,.95519,.150328,.992157,.944152,.961916,.146861,.996078,.941896,.96859,.140956,1,.940015,.975158,.131326]},{ColorSpace:"Diverging",Name:"Viridis (matplotlib)",NanColor:[1,0,0],Source:"https://github.com/BIDS/colormap/blob/master/colormaps.py",License:"CC0",Creator:"Eric Firing",RGBPoints:[0,.267004,.004874,.329415,.003922,.26851,.009605,.335427,.007843,.269944,.014625,.341379,.011765,.271305,.019942,.347269,.015686,.272594,.025563,.353093,.019608,.273809,.031497,.358853,.023529,.274952,.037752,.364543,.027451,.276022,.044167,.370164,.031373,.277018,.050344,.375715,.035294,.277941,.056324,.381191,.039216,.278791,.062145,.386592,.043137,.279566,.067836,.391917,.047059,.280267,.073417,.397163,.05098,.280894,.078907,.402329,.054902,.281446,.08432,.407414,.058824,.281924,.089666,.412415,.062745,.282327,.094955,.417331,.066667,.282656,.100196,.42216,.070588,.28291,.105393,.426902,.07451,.283091,.110553,.431554,.078431,.283197,.11568,.436115,.082353,.283229,.120777,.440584,.086275,.283187,.125848,.44496,.090196,.283072,.130895,.449241,.094118,.282884,.13592,.453427,.098039,.282623,.140926,.457517,.101961,.28229,.145912,.46151,.105882,.281887,.150881,.465405,.109804,.281412,.155834,.469201,.113725,.280868,.160771,.472899,.117647,.280255,.165693,.476498,.121569,.279574,.170599,.479997,.12549,.278826,.17549,.483397,.129412,.278012,.180367,.486697,.133333,.277134,.185228,.489898,.137255,.276194,.190074,.493001,.141176,.275191,.194905,.496005,.145098,.274128,.199721,.498911,.14902,.273006,.20452,.501721,.152941,.271828,.209303,.504434,.156863,.270595,.214069,.507052,.160784,.269308,.218818,.509577,.164706,.267968,.223549,.512008,.168627,.26658,.228262,.514349,.172549,.265145,.232956,.516599,.176471,.263663,.237631,.518762,.180392,.262138,.242286,.520837,.184314,.260571,.246922,.522828,.188235,.258965,.251537,.524736,.192157,.257322,.25613,.526563,.196078,.255645,.260703,.528312,.2,.253935,.265254,.529983,.203922,.252194,.269783,.531579,.207843,.250425,.27429,.533103,.211765,.248629,.278775,.534556,.215686,.246811,.283237,.535941,.219608,.244972,.287675,.53726,.223529,.243113,.292092,.538516,.227451,.241237,.296485,.539709,.231373,.239346,.300855,.540844,.235294,.237441,.305202,.541921,.239216,.235526,.309527,.542944,.243137,.233603,.313828,.543914,.247059,.231674,.318106,.544834,.25098,.229739,.322361,.545706,.254902,.227802,.326594,.546532,.258824,.225863,.330805,.547314,.262745,.223925,.334994,.548053,.266667,.221989,.339161,.548752,.270588,.220057,.343307,.549413,.27451,.21813,.347432,.550038,.278431,.21621,.351535,.550627,.282353,.214298,.355619,.551184,.286275,.212395,.359683,.55171,.290196,.210503,.363727,.552206,.294118,.208623,.367752,.552675,.298039,.206756,.371758,.553117,.301961,.204903,.375746,.553533,.305882,.203063,.379716,.553925,.309804,.201239,.38367,.554294,.313725,.19943,.387607,.554642,.317647,.197636,.391528,.554969,.321569,.19586,.395433,.555276,.32549,.1941,.399323,.555565,.329412,.192357,.403199,.555836,.333333,.190631,.407061,.556089,.337255,.188923,.41091,.556326,.341176,.187231,.414746,.556547,.345098,.185556,.41857,.556753,.34902,.183898,.422383,.556944,.352941,.182256,.426184,.55712,.356863,.180629,.429975,.557282,.360784,.179019,.433756,.55743,.364706,.177423,.437527,.557565,.368627,.175841,.44129,.557685,.372549,.174274,.445044,.557792,.376471,.172719,.448791,.557885,.380392,.171176,.45253,.557965,.384314,.169646,.456262,.55803,.388235,.168126,.459988,.558082,.392157,.166617,.463708,.558119,.396078,.165117,.467423,.558141,.4,.163625,.471133,.558148,.403922,.162142,.474838,.55814,.407843,.160665,.47854,.558115,.411765,.159194,.482237,.558073,.415686,.157729,.485932,.558013,.419608,.15627,.489624,.557936,.423529,.154815,.493313,.55784,.427451,.153364,.497,.557724,.431373,.151918,.500685,.557587,.435294,.150476,.504369,.55743,.439216,.149039,.508051,.55725,.443137,.147607,.511733,.557049,.447059,.14618,.515413,.556823,.45098,.144759,.519093,.556572,.454902,.143343,.522773,.556295,.458824,.141935,.526453,.555991,.462745,.140536,.530132,.555659,.466667,.139147,.533812,.555298,.470588,.13777,.537492,.554906,.47451,.136408,.541173,.554483,.478431,.135066,.544853,.554029,.482353,.133743,.548535,.553541,.486275,.132444,.552216,.553018,.490196,.131172,.555899,.552459,.494118,.129933,.559582,.551864,.498039,.128729,.563265,.551229,.501961,.127568,.566949,.550556,.505882,.126453,.570633,.549841,.509804,.125394,.574318,.549086,.513725,.124395,.578002,.548287,.517647,.123463,.581687,.547445,.521569,.122606,.585371,.546557,.52549,.121831,.589055,.545623,.529412,.121148,.592739,.544641,.533333,.120565,.596422,.543611,.537255,.120092,.600104,.54253,.541176,.119738,.603785,.5414,.545098,.119512,.607464,.540218,.54902,.119423,.611141,.538982,.552941,.119483,.614817,.537692,.556863,.119699,.61849,.536347,.560784,.120081,.622161,.534946,.564706,.120638,.625828,.533488,.568627,.12138,.629492,.531973,.572549,.122312,.633153,.530398,.576471,.123444,.636809,.528763,.580392,.12478,.640461,.527068,.584314,.126326,.644107,.525311,.588235,.128087,.647749,.523491,.592157,.130067,.651384,.521608,.596078,.132268,.655014,.519661,.6,.134692,.658636,.517649,.603922,.137339,.662252,.515571,.607843,.14021,.665859,.513427,.611765,.143303,.669459,.511215,.615686,.146616,.67305,.508936,.619608,.150148,.676631,.506589,.623529,.153894,.680203,.504172,.627451,.157851,.683765,.501686,.631373,.162016,.687316,.499129,.635294,.166383,.690856,.496502,.639216,.170948,.694384,.493803,.643137,.175707,.6979,.491033,.647059,.180653,.701402,.488189,.65098,.185783,.704891,.485273,.654902,.19109,.708366,.482284,.658824,.196571,.711827,.479221,.662745,.202219,.715272,.476084,.666667,.20803,.718701,.472873,.670588,.214,.722114,.469588,.67451,.220124,.725509,.466226,.678431,.226397,.728888,.462789,.682353,.232815,.732247,.459277,.686275,.239374,.735588,.455688,.690196,.24607,.73891,.452024,.694118,.252899,.742211,.448284,.698039,.259857,.745492,.444467,.701961,.266941,.748751,.440573,.705882,.274149,.751988,.436601,.709804,.281477,.755203,.432552,.713725,.288921,.758394,.428426,.717647,.296479,.761561,.424223,.721569,.304148,.764704,.419943,.72549,.311925,.767822,.415586,.729412,.319809,.770914,.411152,.733333,.327796,.77398,.40664,.737255,.335885,.777018,.402049,.741176,.344074,.780029,.397381,.745098,.35236,.783011,.392636,.74902,.360741,.785964,.387814,.752941,.369214,.788888,.382914,.756863,.377779,.791781,.377939,.760784,.386433,.794644,.372886,.764706,.395174,.797475,.367757,.768627,.404001,.800275,.362552,.772549,.412913,.803041,.357269,.776471,.421908,.805774,.35191,.780392,.430983,.808473,.346476,.784314,.440137,.811138,.340967,.788235,.449368,.813768,.335384,.792157,.458674,.816363,.329727,.796078,.468053,.818921,.323998,.8,.477504,.821444,.318195,.803922,.487026,.823929,.312321,.807843,.496615,.826376,.306377,.811765,.506271,.828786,.300362,.815686,.515992,.831158,.294279,.819608,.525776,.833491,.288127,.823529,.535621,.835785,.281908,.827451,.545524,.838039,.275626,.831373,.555484,.840254,.269281,.835294,.565498,.84243,.262877,.839216,.575563,.844566,.256415,.843137,.585678,.846661,.249897,.847059,.595839,.848717,.243329,.85098,.606045,.850733,.236712,.854902,.616293,.852709,.230052,.858824,.626579,.854645,.223353,.862745,.636902,.856542,.21662,.866667,.647257,.8584,.209861,.870588,.657642,.860219,.203082,.87451,.668054,.861999,.196293,.878431,.678489,.863742,.189503,.882353,.688944,.865448,.182725,.886275,.699415,.867117,.175971,.890196,.709898,.868751,.169257,.894118,.720391,.87035,.162603,.898039,.730889,.871916,.156029,.901961,.741388,.873449,.149561,.905882,.751884,.874951,.143228,.909804,.762373,.876424,.137064,.913725,.772852,.877868,.131109,.917647,.783315,.879285,.125405,.921569,.79376,.880678,.120005,.92549,.804182,.882046,.114965,.929412,.814576,.883393,.110347,.933333,.82494,.88472,.106217,.937255,.83527,.886029,.102646,.941176,.845561,.887322,.099702,.945098,.85581,.888601,.097452,.94902,.866013,.889868,.095953,.952941,.876168,.891125,.09525,.956863,.886271,.892374,.095374,.960784,.89632,.893616,.096335,.964706,.906311,.894855,.098125,.968627,.916242,.896091,.100717,.972549,.926106,.89733,.104071,.976471,.935904,.89857,.108131,.980392,.945636,.899815,.112838,.984314,.9553,.901065,.118128,.988235,.964894,.902323,.123941,.992157,.974417,.90359,.130215,.996078,.983868,.904867,.136897,1,.993248,.906157,.143936]},{ShowIndexedColorActiveValues:1,IndexedColors:[.07,.5,.7,1,1,1,.85,1,1,.8,.5,1,.76,1,0,1,.71,.71,.5,.5,.5,.05,.05,1,1,.05,.05,.7,1,1,.7,.89,.96,.67,.36,.95,.54,1,0,.75,.65,.65,.5,.6,.6,1,.5,0,1,1,.19,.12,.94,.12,.5,.82,.89,.56,.25,.83,.24,1,0,.9,.9,.9,.75,.76,.78,.65,.65,.67,.54,.6,.78,.61,.48,.78,.5,.48,.78,.44,.48,.78,.36,.48,.76,1,.48,.38,.49,.5,.69,.76,.56,.56,.4,.56,.56,.74,.5,.89,1,.63,0,.65,.16,.16,.36,.72,.82,.44,.18,.69,0,1,0,.58,1,1,.58,.88,.88,.45,.76,.79,.33,.71,.71,.23,.62,.62,.14,.56,.56,.04,.49,.55,0,.41,.52,.88,.88,1,1,.85,.56,.65,.46,.45,.4,.5,.5,.62,.39,.71,.83,.48,0,.58,0,.58,.26,.62,.69,.34,.09,.56,0,.79,0,.44,.83,1,1,1,.78,.85,1,.78,.78,1,.78,.64,1,.78,.56,1,.78,.38,1,.78,.27,1,.78,.19,1,.78,.12,1,.78,0,1,.61,0,.9,.46,0,.83,.32,0,.75,.22,0,.67,.14,.3,.76,1,.3,.65,1,.13,.58,.84,.15,.49,.67,.15,.4,.59,.09,.33,.53,.96,.93,.82,.8,.82,.12,.71,.71,.76,.65,.33,.3,.34,.35,.38,.62,.31,.71,.67,.36,0,.46,.31,.27,.26,.51,.59,.26,0,.4,0,.49,0,.44,.67,.98,0,.73,1,0,.63,1,0,.56,1,0,.5,1,0,.42,1,.33,.36,.95,.47,.36,.89,.54,.31,.89,.63,.21,.83,.7,.12,.83,.7,.12,.73,.7,.05,.65,.74,.05,.53,.78,0,.4,.8,0,.35,.82,0,.31,.85,0,.27,.88,0,.22,.9,0,.18,.91,0,.15,.92,0,.14,.93,0,.13,.94,0,.12,.95,0,.11,.96,0,.1,.97,0,.09,.98,0,.08,.99,0,.07,1,0,.06],Annotations:[0,"Xx",1,"H",2,"He",3,"Li",4,"Be",5,"B",6,"C",7,"N",8,"O",9,"F",10,"Ne",11,"Na",12,"Mg",13,"Al",14,"Si",15,"P",16,"S",17,"Cl",18,"Ar",19,"K",20,"Ca",21,"Sc",22,"Ti",23,"V",24,"Cr",25,"Mn",26,"Fe",27,"Co",28,"Ni",29,"Cu",30,"Zn",31,"Ga",32,"Ge",33,"As",34,"Se",35,"Br",36,"Kr",37,"Rb",38,"Sr",39,"Y",40,"Zr",41,"Nb",42,"Mo",43,"Tc",44,"Ru",45,"Rh",46,"Pd",47,"Ag",48,"Cd",49,"In",50,"Sn",51,"Sb",52,"Te",53,"I",54,"Xe",55,"Cs",56,"Ba",57,"La",58,"Ce",59,"Pr",60,"Nd",61,"Pm",62,"Sm",63,"Eu",64,"Gd",65,"Tb",66,"Dy",67,"Ho",68,"Er",69,"Tm",70,"Yb",71,"Lu",72,"Hf",73,"Ta",74,"W",75,"Re",76,"Os",77,"Ir",78,"Pt",79,"Au",80,"Hg",81,"Tl",82,"Pb",83,"Bi",84,"Po",85,"At",86,"Rn",87,"Fr",88,"Ra",89,"Ac",90,"Th",91,"Pa",92,"U",93,"Np",94,"Pu",95,"Am",96,"Cm",97,"Bk",98,"Cf",99,"Es",100,"Fm",101,"Md",102,"No",103,"Lr",104,"Rf",105,"Db",106,"Sg",107,"Bh",108,"Hs",109,"Mt",110,"Ds",111,"Rg",112,"Cn",113,"Uut",114,"Uuq",115,"Uup",116,"Uuh",117,"Uus",118,"Uuo"],Name:"BlueObeliskElements"}].filter((e=>e.RGBPoints)).filter((e=>"CIELAB"!==e.ColorSpace)).forEach((e=>{r[e.Name]=e}));const i=Object.keys(r);i.sort();var o={addPreset:function(e){e.RGBPoints&&"CIELAB"!==e.ColorSpace&&(r[e.Name]||(i.push(e.Name),i.sort()),r[e.Name]=e)},removePresetByName:function(e){const t=i.indexOf(e);t>-1&&i.splice(t,1),delete r[e]},getPresetByName:function(e){return r[e]},rgbPresetNames:i}},94520:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var r={SlicingMode:{NONE:-1,I:0,J:1,K:2,X:3,Y:4,Z:5}}},91732:(e,t,n)=>{"use strict";n.d(t,{A:()=>i,V:()=>r});const r={NEAREST:0,LINEAR:1};var i={InterpolationType:r}},82409:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>D});var r=n(28906),i=n(68076),o=n(42008),a=n(58498),s=n(72879),l=n(16632),c=n(62955),u=n(57285),d=n(33395),p=n(69147),f=n(57703);const{FieldAssociations:h}=p.Ay,{staticOffsetAPI:m,otherStaticMethods:g}=u.Ay,{ColorMode:v,ScalarMode:y,GetArray:b}=d.Ay,{VectorMode:x}=c.Ay,{VtkDataTypes:A}=o.Ay;function C(e){return()=>r.m.vtkErrorMacro(`vtkMapper::${e} - NOT IMPLEMENTED`)}function T(e,t){const n=e[1]%2==0?1:-1;if(e[0]+=n,e[0]>=t[0]||e[0]<0){const r=e[2]%2==0?1:-1;e[0]-=n,e[1]+=r,(e[1]>=t[1]||e[1]<0)&&(e[1]-=r,e[2]++)}}function S(e,t,n){const r=Math.floor(t),i=r%(2*n[0]);let o,a;i<n[0]?(e[0]=i,o=1,a=e[0]===n[0]-1):(e[0]=2*n[0]-1-i,o=-1,a=0===e[0]);const s=Math.floor(r/n[0]),l=s%(2*n[1]);let c,u;l<n[1]?(e[1]=l,c=1,u=e[1]===n[1]-1):(e[1]=2*n[1]-1-l,c=-1,u=0===e[1]),e[2]=Math.floor(s/n[1]);const d=t-r;a?u?e[2]+=d:e[1]+=c*d:e[0]+=o*d,e[0]=(e[0]+.5)/n[0],e[1]=(e[1]+.5)/n[1],e[2]=(e[2]+.5)/n[2]}const w=new WeakMap;function _(e,t){t.classHierarchy.push("vtkMapper"),e.getBounds=()=>{const n=e.getInputData();return n?(t.static||e.update(),t.bounds=n.getBounds()):t.bounds=(0,l.H)(),t.bounds},e.setForceCompileOnly=e=>{t.forceCompileOnly=e},e.setSelectionWebGLIdsToVTKIds=e=>{t.selectionWebGLIdsToVTKIds=e},e.createDefaultLookupTable=()=>{t.lookupTable=s.Ay.newInstance()},e.getColorModeAsString=()=>r.m.enumToString(v,t.colorMode),e.setColorModeToDefault=()=>e.setColorMode(0),e.setColorModeToMapScalars=()=>e.setColorMode(1),e.setColorModeToDirectScalars=()=>e.setColorMode(2),e.getScalarModeAsString=()=>r.m.enumToString(y,t.scalarMode),e.setScalarModeToDefault=()=>e.setScalarMode(0),e.setScalarModeToUsePointData=()=>e.setScalarMode(1),e.setScalarModeToUseCellData=()=>e.setScalarMode(2),e.setScalarModeToUsePointFieldData=()=>e.setScalarMode(3),e.setScalarModeToUseCellFieldData=()=>e.setScalarMode(4),e.setScalarModeToUseFieldData=()=>e.setScalarMode(5),e.getAbstractScalars=(e,n,r,i,o)=>{if(!e||!t.scalarVisibility)return{scalars:null,cellFlag:!1};let a=null,s=!1;if(n===y.DEFAULT)a=e.getPointData().getScalars(),a||(a=e.getCellData().getScalars(),s=!0);else if(n===y.USE_POINT_DATA)a=e.getPointData().getScalars();else if(n===y.USE_CELL_DATA)a=e.getCellData().getScalars(),s=!0;else if(n===y.USE_POINT_FIELD_DATA){const t=e.getPointData();a=r===b.BY_ID?t.getArrayByIndex(i):t.getArrayByName(o)}else if(n===y.USE_CELL_FIELD_DATA){const t=e.getCellData();s=!0,a=r===b.BY_ID?t.getArrayByIndex(i):t.getArrayByName(o)}else if(n===y.USE_FIELD_DATA){const t=e.getFieldData();a=r===b.BY_ID?t.getArrayByIndex(i):t.getArrayByName(o)}return{scalars:a,cellFlag:s}},e.mapScalars=(n,r)=>{const{scalars:i,cellFlag:o}=e.getAbstractScalars(n,t.scalarMode,t.arrayAccessMode,t.arrayId,t.colorByArrayName);if(t.areScalarsMappedFromCells=o,!i)return t.colorCoordinates=null,t.colorTextureMap=null,void(t.colorMapColors=null);const a=`${e.getMTime()}${i.getMTime()}${r}`;if(t.colorBuildString!==a){if(t.useLookupTableScalarRange||e.getLookupTable().setRange(t.scalarRange[0],t.scalarRange[1]),e.canUseTextureMapForColoring(i,o))t.mapScalarsToTexture(i,o,r);else{t.colorCoordinates=null,t.colorTextureMap=null;const n=e.getLookupTable();n&&(n.build(),t.colorMapColors=n.mapScalars(i,t.colorMode,t.fieldDataTupleId))}t.colorBuildString=`${e.getMTime()}${i.getMTime()}${r}`}},t.mapScalarsToTexture=(n,r,i)=>{const c=t.lookupTable.getRange(),u=t.lookupTable.usingLogScale();u&&s.Ay.getLogRange(c,c);const d=t.lookupTable.getAlpha();if(t.colorMapColors=null,null==t.colorTextureMap||e.getMTime()>t.colorTextureMap.getMTime()||t.lookupTable.getMTime()>t.colorTextureMap.getMTime()||t.lookupTable.getAlpha()!==i){t.lookupTable.setAlpha(i),t.colorTextureMap=null,t.lookupTable.build();const e=t.lookupTable.getNumberOfAvailableColors(),n=2048,s=2,l=r?n**3-3:4096-2;t.numberOfColorsInRange=Math.min(Math.max(e,s),l);const h=t.numberOfColorsInRange+3,m=t.numberOfColorsInRange+2,g=r?[Math.min(Math.ceil(h/n**0),n),Math.min(Math.ceil(h/n**1),n),Math.min(Math.ceil(h/n**2),n)]:[m,2,1],v=g[0]*g[1]*g[2],y=new Float64Array(v);y.fill(NaN);const b=t.numberOfColorsInRange,x=b+2,A=[0,0,0],C=c[0],S=c[1]-c[0];for(let e=0;e<x;++e){const t=C+S*(e-1)/(b-1);y[(f=g,(p=A)[0]+f[0]*(p[1]+f[1]*p[2]))]=u?10**t:t,T(A,g)}const w=o.Ay.newInstance({numberOfComponents:1,values:y}),_=t.lookupTable.mapScalars(w,t.colorMode,0);t.colorTextureMap=a.Ay.newInstance(),t.colorTextureMap.setDimensions(g),t.colorTextureMap.getPointData().setScalars(_),t.lookupTable.setAlpha(d)}var p,f;const h=t.lookupTable.getVectorMode()===x.MAGNITUDE&&n.getNumberOfComponents()>1?-1:t.lookupTable.getVectorComponent();t.colorCoordinates=function(e,t,n,r,i,a,c){const u=new Array(arguments.length);for(let e=0;e<arguments.length;++e){const t=arguments[e];u[e]=t.getMTime?.()??t}const d=u.join("/"),p=w.get(e);if(p&&p.stringHash===d)return p.textureCoordinates;const f=(n[1]-n[0])/(r-1),[h,m]=[n[0]-f,n[1]+f],g=h-.5*f,v=1/(m-h+f),y=h,b=(r+1)/(m-h),x=e.getData(),A=e.getNumberOfTuples(),C=e.getNumberOfComponents(),T=t<0||t>=C,_=i[2]<=1?2:3,I=o.Ay.newInstance({numberOfComponents:_,values:new Float32Array(A*_)}),E=I.getData(),D=[0,0,0];S(D,r+2,i);let O=0,P=0;const R=[.5,.5,.5];for(let e=0;e<A;++e){let e;if(T){let t=0;for(let e=0;e<C;++e){const n=x[O+e];t+=n*n}e=Math.sqrt(t)}else e=x[O+t];if(O+=C,a&&(e=s.Ay.applyLogScale(e,n,n)),(0,l.i)(e))R[0]=D[0],R[1]=D[1],R[2]=D[2];else if(c){let t=(e-y)*b;t<1?t=0:t>r&&(t=r+1),S(R,t,i)}else{R[1]=.49;const t=(e-g)*v;R[0]=t>1e3?1e3:t<-1e3?-1e3:t}for(let e=0;e<_;++e)E[P++]=R[e]}return w.set(e,{stringHash:d,textureCoordinates:I}),I}(n,h,c,t.numberOfColorsInRange,t.colorTextureMap.getDimensions(),u,r)},e.getIsOpaque=()=>{const n=e.getInputData(),r=e.getAbstractScalars(n,t.scalarMode,t.arrayAccessMode,t.arrayId,t.colorByArrayName).scalars;if(!t.scalarVisibility||null==r)return!0;const i=e.getLookupTable();return!i||(i.build(),i.areScalarsOpaque(r,t.colorMode,-1))},e.canUseTextureMapForColoring=(e,n)=>!(!n||t.colorMode===v.DIRECT_SCALARS)||!!t.interpolateScalarsBeforeMapping&&((!t.lookupTable||!t.lookupTable.getIndexedLookup())&&(!!e&&((t.colorMode!==v.DEFAULT||e.getDataType()!==A.UNSIGNED_CHAR)&&t.colorMode!==v.DIRECT_SCALARS))),e.clearColorArrays=()=>{t.colorMapColors=null,t.colorCoordinates=null,t.colorTextureMap=null},e.getLookupTable=()=>(t.lookupTable||e.createDefaultLookupTable(),t.lookupTable),e.getMTime=()=>{let e=t.mtime;if(null!==t.lookupTable){const n=t.lookupTable.getMTime();e=n>e?n:e}return e},e.getPrimitiveCount=()=>{const t=e.getInputData();return{points:t.getPoints().getNumberOfValues()/3,verts:t.getVerts().getNumberOfValues()-t.getVerts().getNumberOfCells(),lines:t.getLines().getNumberOfValues()-2*t.getLines().getNumberOfCells(),triangles:t.getPolys().getNumberOfValues()-3*t.getPolys().getNumberOfCells()}},e.acquireInvertibleLookupTable=C("AcquireInvertibleLookupTable"),e.valueToColor=C("ValueToColor"),e.colorToValue=C("ColorToValue"),e.useInvertibleColorFor=C("UseInvertibleColorFor"),e.clearInvertibleColor=C("ClearInvertibleColor"),e.processSelectorPixelBuffers=(e,n)=>{if(!e||!t.selectionWebGLIdsToVTKIds||!t.populateSelectionSettings)return;const r=e.getRawPixelBuffer(f.T.ID_LOW24),i=e.getRawPixelBuffer(f.T.ID_HIGH24),o=e.getCurrentPass(),a=e.getFieldAssociation();let s=null;a===h.FIELD_ASSOCIATION_POINTS?s=t.selectionWebGLIdsToVTKIds.points:a===h.FIELD_ASSOCIATION_CELLS&&(s=t.selectionWebGLIdsToVTKIds.cells),s&&n.forEach((t=>{if(o===f.T.ID_LOW24){let n=0;i&&(n+=i[t],n*=256),n+=r[t+2],n*=256,n+=r[t+1],n*=256,n+=r[t];const o=s[n],a=e.getPixelBuffer(f.T.ID_LOW24);a[t]=255&o,a[t+1]=(65280&o)>>8,a[t+2]=(16711680&o)>>16}else if(o===f.T.ID_HIGH24&&i){let n=0;n+=i[t],n*=256,n+=r[t+2],n*=256,n+=r[t+1],n*=256,n+=r[t];const o=s[n];e.getPixelBuffer(f.T.ID_HIGH24)[t]=(4278190080&o)>>24}}))}}const I={colorMapColors:null,areScalarsMappedFromCells:!1,static:!1,lookupTable:null,scalarVisibility:!0,scalarRange:[0,1],useLookupTableScalarRange:!1,colorMode:0,scalarMode:0,arrayAccessMode:1,renderTime:0,colorByArrayName:null,fieldDataTupleId:-1,populateSelectionSettings:!0,selectionWebGLIdsToVTKIds:null,interpolateScalarsBeforeMapping:!1,colorCoordinates:null,colorTextureMap:null,numberOfColorsInRange:0,forceCompileOnly:0,useInvertibleColors:!1,invertibleScalars:null,customShaderAttributes:[]};function E(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,I,n),i.A.extend(e,t,n),r.m.get(e,t,["areScalarsMappedFromCells","colorCoordinates","colorMapColors","colorTextureMap","numberOfColorsInRange","selectionWebGLIdsToVTKIds"]),r.m.setGet(e,t,["colorByArrayName","arrayAccessMode","colorMode","fieldDataTupleId","interpolateScalarsBeforeMapping","lookupTable","populateSelectionSettings","renderTime","scalarMode","scalarVisibility","static","useLookupTableScalarRange","customShaderAttributes"]),r.m.setGetArray(e,t,["scalarRange"],2),u.Ay.implementCoincidentTopologyMethods(e,t),_(e,t)}var D={newInstance:r.m.newInstance(E,"vtkMapper"),extend:E,...m,...g,...d.Ay}},57285:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>l});var r=n(7698),i=n(28906);function o(e,t,n){n.forEach((n=>{e[`get${n.method}`]=()=>t[n.key],e[`set${n.method}`]=i.m.objectSetterMap.object(e,t,{name:n.key,params:["factor","offset"]})}))}const a=["Polygon","Line","Point"],s={modified:()=>{}};o(s,{Polygon:{factor:2,offset:0},Line:{factor:1,offset:-1},Point:{factor:0,offset:-2}},a.map((e=>({key:e,method:`ResolveCoincidentTopology${e}OffsetParameters`}))));var l={implementCoincidentTopologyMethods:function(e,t){void 0===t.resolveCoincidentTopology&&(t.resolveCoincidentTopology=!1),i.m.setGet(e,t,["resolveCoincidentTopology"]),t.topologyOffset={Polygon:{factor:0,offset:0},Line:{factor:0,offset:0},Point:{factor:0,offset:0}},Object.keys(r.Ay).forEach((t=>{e[t]=r.Ay[t]})),Object.keys(s).filter((e=>"modified"!==e)).forEach((t=>{e[t]=s[t]})),o(e,t.topologyOffset,a.map((e=>({key:e,method:`RelativeCoincidentTopology${e}OffsetParameters`})))),e.getCoincidentTopologyPolygonOffsetParameters=()=>{const t=s.getResolveCoincidentTopologyPolygonOffsetParameters(),n=e.getRelativeCoincidentTopologyPolygonOffsetParameters();return{factor:t.factor+n.factor,offset:t.offset+n.offset}},e.getCoincidentTopologyLineOffsetParameters=()=>{const t=s.getResolveCoincidentTopologyLineOffsetParameters(),n=e.getRelativeCoincidentTopologyLineOffsetParameters();return{factor:t.factor+n.factor,offset:t.offset+n.offset}},e.getCoincidentTopologyPointOffsetParameter=()=>{const t=s.getResolveCoincidentTopologyPointOffsetParameters(),n=e.getRelativeCoincidentTopologyPointOffsetParameters();return{factor:t.factor+n.factor,offset:t.offset+n.offset}}},staticOffsetAPI:s,otherStaticMethods:r.Ay,CATEGORIES:a,Resolve:r.XK}},33395:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>r});var r={ColorMode:{DEFAULT:0,MAP_SCALARS:1,DIRECT_SCALARS:2},GetArray:{BY_ID:0,BY_NAME:1},ScalarMode:{DEFAULT:0,USE_POINT_DATA:1,USE_CELL_DATA:2,USE_POINT_FIELD_DATA:3,USE_CELL_FIELD_DATA:4,USE_FIELD_DATA:5}}},7698:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>l,XK:()=>r});const r={Off:0,PolygonOffset:1};let i=r.PolygonOffset,o=r.Off;const a=["VTK_RESOLVE_OFF","VTK_RESOLVE_POLYGON_OFFSET"];function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=o===e;return o=e,t}var l={Resolve:r,getResolveCoincidentTopologyAsString:function(){return a[o]},getResolveCoincidentTopologyPolygonOffsetFaces:function(){return i},getResolveCoincidentTopology:function(){return o},setResolveCoincidentTopology:s,setResolveCoincidentTopologyPolygonOffsetFaces:function(e){const t=i===e;return i=e,t},setResolveCoincidentTopologyToDefault:function(){return s(r.Off)},setResolveCoincidentTopologyToOff:function(){return s(r.Off)},setResolveCoincidentTopologyToPolygonOffset:function(){return s(r.PolygonOffset)}}},46985:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var r=n(28906);var i={CoordinateSystem:{DISPLAY:0,WORLD:1}};const{CoordinateSystem:o}=i;function a(e){return()=>r.m.vtkErrorMacro(`vtkProp::${e} - NOT IMPLEMENTED`)}const s={allocatedRenderTime:10,coordinateSystem:o.WORLD,dragable:!0,estimatedRenderTime:0,paths:null,pickable:!0,renderTimeMultiplier:1,savedEstimatedRenderTime:0,textures:[],useBounds:!0,visibility:!0};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),r.m.obj(e,t),r.m.get(e,t,["estimatedRenderTime","allocatedRenderTime"]),r.m.setGet(e,t,["_parentProp","coordinateSystem","dragable","pickable","renderTimeMultiplier","useBounds","visibility"]),r.m.moveToProtected(e,t,["parentProp"]),function(e,t){t.classHierarchy.push("vtkProp"),e.getMTime=()=>{let e=t.mtime;for(let n=0;n<t.textures.length;++n){const r=t.textures[n].getMTime();r>e&&(e=r)}return e},e.processSelectorPixelBuffers=(e,t)=>{},e.getNestedProps=()=>null,e.getActors=()=>[],e.getActors2D=()=>[],e.getVolumes=()=>[],e.pick=a("pick"),e.hasKey=a("hasKey"),e.getNestedVisibility=()=>t.visibility&&(!t._parentProp||t._parentProp.getNestedVisibility()),e.getNestedPickable=()=>t.pickable&&(!t._parentProp||t._parentProp.getNestedPickable()),e.getNestedDragable=()=>t.dragable&&(!t._parentProp||t._parentProp.getNestedDragable()),e.getRedrawMTime=()=>t.mtime,e.setEstimatedRenderTime=e=>{t.estimatedRenderTime=e,t.savedEstimatedRenderTime=e},e.restoreEstimatedRenderTime=()=>{t.estimatedRenderTime=t.savedEstimatedRenderTime},e.addEstimatedRenderTime=e=>{t.estimatedRenderTime+=e},e.setAllocatedRenderTime=e=>{t.allocatedRenderTime=e,t.savedEstimatedRenderTime=t.estimatedRenderTime,t.estimatedRenderTime=0},e.getSupportsSelection=()=>!1,e.getTextures=()=>t.textures,e.hasTexture=e=>-1!==t.textures.indexOf(e),e.addTexture=n=>{n&&!e.hasTexture(n)&&(t.textures=t.textures.concat(n),e.modified())},e.removeTexture=n=>{const r=t.textures.filter((e=>e!==n));t.textures.length!==r.length&&(t.textures=r,e.modified())},e.removeAllTextures=()=>{t.textures=[],e.modified()},e.setCoordinateSystemToWorld=()=>e.setCoordinateSystem(o.WORLD),e.setCoordinateSystemToDisplay=()=>e.setCoordinateSystem(o.DISPLAY)}(e,t)}var c={newInstance:r.m.newInstance(l,"vtkProp"),extend:l,...i}},62502:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>d});var r=n(3823),i=n(28906),o=n(21734),a=n(16632),s=n(46985);const l=1e-6;const c={origin:[0,0,0],position:[0,0,0],orientation:[0,0,0],rotation:null,scale:[1,1,1],bounds:[1,-1,1,-1,1,-1],userMatrix:null,userMatrixMTime:null,cachedProp3D:null,isIdentity:!0,matrixMTime:null};function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,c,n),s.Ay.extend(e,t,n),t.matrixMTime={},i.m.obj(t.matrixMTime),i.m.get(e,t,["bounds","isIdentity"]),i.m.getArray(e,t,["orientation"]),i.m.setGetArray(e,t,["origin","position","scale"],3),t.matrix=r.pB.identity(new Float64Array(16)),t.rotation=r.pB.identity(new Float64Array(16)),t.userMatrix=r.pB.identity(new Float64Array(16)),t.transform=null,function(e,t){t.classHierarchy.push("vtkProp3D"),e.addPosition=n=>{t.position=t.position.map(((e,t)=>e+n[t])),e.modified()},e.getOrientationWXYZ=()=>{const e=r.Yu.create();r.pB.getRotation(e,t.rotation);const n=new Float64Array(3),i=r.Yu.getAxisAngle(n,e);return[(0,a.A)(i),n[0],n[1],n[2]]},e.getOrientationQuaternion=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return r.pB.getRotation(e,t.rotation)},e.rotateX=n=>{0!==n&&(r.pB.rotateX(t.rotation,t.rotation,(0,a.r)(n)),e.modified())},e.rotateY=n=>{0!==n&&(r.pB.rotateY(t.rotation,t.rotation,(0,a.r)(n)),e.modified())},e.rotateZ=n=>{0!==n&&(r.pB.rotateZ(t.rotation,t.rotation,(0,a.r)(n)),e.modified())},e.rotateWXYZ=(n,i,o,s)=>{if(0===n||0===i&&0===o&&0===s)return;const l=(0,a.r)(n),c=r.Yu.create();r.Yu.setAxisAngle(c,[i,o,s],l);const u=new Float64Array(16);r.pB.fromQuat(u,c),r.pB.multiply(t.rotation,t.rotation,u),e.modified()},e.rotateQuaternion=n=>{if(Math.abs(n[3])>=1-l)return;const i=r.pB.fromQuat(new Float64Array(16),n);r.pB.multiply(t.rotation,t.rotation,i),e.modified()},e.setOrientation=(n,i,o)=>(n!==t.orientation[0]||i!==t.orientation[1]||o!==t.orientation[2])&&(t.orientation=[n,i,o],r.pB.identity(t.rotation),e.rotateZ(o),e.rotateX(n),e.rotateY(i),e.modified(),!0),e.setUserMatrix=n=>!(0,a.a)(t.userMatrix,n)&&(r.pB.copy(t.userMatrix,n),e.modified(),!0),e.getMatrix=()=>(e.computeMatrix(),t.matrix),e.computeMatrix=()=>{if(e.getMTime()>t.matrixMTime.getMTime()){r.pB.identity(t.matrix),t.userMatrix&&r.pB.multiply(t.matrix,t.matrix,t.userMatrix),r.pB.translate(t.matrix,t.matrix,t.origin),r.pB.translate(t.matrix,t.matrix,t.position),r.pB.multiply(t.matrix,t.matrix,t.rotation),r.pB.scale(t.matrix,t.matrix,t.scale),r.pB.translate(t.matrix,t.matrix,[-t.origin[0],-t.origin[1],-t.origin[2]]),r.pB.transpose(t.matrix,t.matrix),t.isIdentity=!0;for(let e=0;e<4;++e)for(let n=0;n<4;++n)(e===n?1:0)!==t.matrix[e+4*n]&&(t.isIdentity=!1);t.matrixMTime.modified()}},e.getCenter=()=>o.Ay.getCenter(t.bounds),e.getLength=()=>o.Ay.getLength(t.bounds),e.getXRange=()=>o.Ay.getXRange(t.bounds),e.getYRange=()=>o.Ay.getYRange(t.bounds),e.getZRange=()=>o.Ay.getZRange(t.bounds),e.getUserMatrix=()=>t.userMatrix,e.onModified((function(){e.computeMatrix()}))}(e,t)}var d={newInstance:i.m.newInstance(u,"vtkProp3D"),extend:u}},89585:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(28906),i=n(71995);const{Representation:o,Interpolation:a}=i.Ay;function s(e){return()=>r.m.vtkErrorMacro(`vtkProperty::${e} - NOT IMPLEMENTED`)}const l={color:[1,1,1],ambientColor:[1,1,1],diffuseColor:[1,1,1],specularColor:[1,1,1],edgeColor:[0,0,0],ambient:0,diffuse:1,metallic:0,roughness:.6,normalStrength:1,emission:1,baseIOR:1.45,specular:0,specularPower:1,opacity:1,interpolation:a.GOURAUD,representation:o.SURFACE,edgeVisibility:!1,backfaceCulling:!1,frontfaceCulling:!1,pointSize:1,lineWidth:1,lighting:!0,shading:!1,materialName:null};function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,l,n),r.m.obj(e,t),r.m.setGet(e,t,["lighting","interpolation","ambient","diffuse","metallic","roughness","normalStrength","emission","baseIOR","specular","specularPower","opacity","edgeVisibility","lineWidth","pointSize","backfaceCulling","frontfaceCulling","representation","diffuseTexture","metallicTexture","roughnessTexture","normalTexture","ambientOcclusionTexture","emissionTexture"]),r.m.setGetArray(e,t,["ambientColor","specularColor","diffuseColor","edgeColor"],3),function(e,t){t.classHierarchy.push("vtkProperty"),e.setColor=(n,r,i)=>{Array.isArray(n)?t.color[0]===n[0]&&t.color[1]===n[1]&&t.color[2]===n[2]||(t.color[0]=n[0],t.color[1]=n[1],t.color[2]=n[2],e.modified()):t.color[0]===n&&t.color[1]===r&&t.color[2]===i||(t.color[0]=n,t.color[1]=r,t.color[2]=i,e.modified()),e.setDiffuseColor(t.color),e.setAmbientColor(t.color),e.setSpecularColor(t.color)},e.computeCompositeColor=s("ComputeCompositeColor"),e.getColor=()=>{let e=0;t.ambient+t.diffuse+t.specular>0&&(e=1/(t.ambient+t.diffuse+t.specular));for(let n=0;n<3;n++)t.color[n]=e*(t.ambient*t.ambientColor[n]+t.diffuse*t.diffuseColor[n]+t.specular*t.specularColor[n]);return[].concat(t.color)},e.setSpecularPower=n=>{const r=1/Math.max(1,n);t.roughness===r&&t.specularPower===n||(t.specularPower=n,t.roughness=r,e.modified())},e.addShaderVariable=s("AddShaderVariable"),e.setInterpolationToFlat=()=>e.setInterpolation(a.FLAT),e.setInterpolationToGouraud=()=>e.setInterpolation(a.GOURAUD),e.setInterpolationToPhong=()=>e.setInterpolation(a.PHONG),e.getInterpolationAsString=()=>r.m.enumToString(a,t.interpolation),e.setRepresentationToWireframe=()=>e.setRepresentation(o.WIREFRAME),e.setRepresentationToSurface=()=>e.setRepresentation(o.SURFACE),e.setRepresentationToPoints=()=>e.setRepresentation(o.POINTS),e.getRepresentationAsString=()=>r.m.enumToString(o,t.representation)}(e,t)}var u={newInstance:r.m.newInstance(c,"vtkProperty"),extend:c,...i.Ay}},71995:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o,YL:()=>i});const r={FLAT:0,GOURAUD:1,PHONG:2},i={POINTS:0,WIREFRAME:1,SURFACE:2};var o={Shading:r,Representation:i,Interpolation:r}},50036:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>C});var r=n(3823),i=n(28906),o=n(26719),a=n(16632);const s={switch:!0,intensity:1,color:[1,1,1],position:[0,0,1],focalPoint:[0,0,0],positional:!1,exponent:1,coneAngle:30,coneFalloff:5,attenuationValues:[1,0,0],transformMatrix:null,lightType:"SceneLight",shadowAttenuation:1,direction:[0,0,0],directionMTime:0};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),i.m.obj(e,t),i.m.setGet(e,t,["intensity","switch","positional","exponent","coneAngle","coneFalloff","transformMatrix","lightType","shadowAttenuation","attenuationValues"]),i.m.setGetArray(e,t,["color","position","focalPoint","attenuationValues"],3),function(e,t){t.classHierarchy.push("vtkLight");const n=new Float64Array(3);e.getTransformedPosition=()=>(t.transformMatrix?r.eR.transformMat4(n,t.position,t.transformMatrix):r.eR.set(n,t.position[0],t.position[1],t.position[2]),n),e.getTransformedFocalPoint=()=>(t.transformMatrix?r.eR.transformMat4(n,t.focalPoint,t.transformMatrix):r.eR.set(n,t.focalPoint[0],t.focalPoint[1],t.focalPoint[2]),n),e.getDirection=()=>(t.directionMTime<t.mtime&&(r.eR.sub(t.direction,t.focalPoint,t.position),(0,a.l)(t.direction),t.directionMTime=t.mtime),t.direction),e.setDirection=e=>{const n=new Float64Array(3);r.eR.sub(n,t.position,e),t.focalPoint=n},e.setDirectionAngle=(t,n)=>{const r=(0,a.r)(t),i=(0,a.r)(n);e.setPosition(Math.cos(r)*Math.sin(i),Math.sin(r),Math.cos(r)*Math.cos(i)),e.setFocalPoint(0,0,0),e.setPositional(0)},e.setLightTypeToHeadLight=()=>{e.setLightType("HeadLight")},e.setLightTypeToCameraLight=()=>{e.setLightType("CameraLight")},e.setLightTypeToSceneLight=()=>{e.setTransformMatrix(null),e.setLightType("SceneLight")},e.lightTypeIsHeadLight=()=>"HeadLight"===t.lightType,e.lightTypeIsSceneLight=()=>"SceneLight"===t.lightType,e.lightTypeIsCameraLight=()=>"CameraLight"===t.lightType}(e,t)}var c={newInstance:i.m.newInstance(l,"vtkLight"),extend:l,LIGHT_TYPES:["HeadLight","CameraLight","SceneLight"]};const{vtkErrorMacro:u}=i.m;function d(e,t){function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.push(e);const r=e.getNestedProps();if(r&&r.length)for(let e=0;e<r.length;e++)n(r[e],t);return t}var r;t.classHierarchy.push("vtkViewport"),e.getViewProps=()=>t.props,e.hasViewProp=e=>t.props.includes(e),e.addViewProp=n=>{n&&!e.hasViewProp(n)&&t.props.push(n)},e.removeViewProp=e=>{const n=t.props.filter((t=>t!==e));t.props.length!==n.length&&(t.props=n)},e.removeAllViewProps=()=>{t.props=[]},e.getViewPropsWithNestedProps=()=>{const e=[];for(let r=0;r<t.props.length;r++)n(t.props[r],e);return e},e.addActor2D=e.addViewProp,e.removeActor2D=t=>{e.removeViewProp(t)},e.getActors2D=()=>(t.actors2D=[],t.props.forEach((e=>{t.actors2D=t.actors2D.concat(e.getActors2D())})),t.actors2D),e.displayToView=()=>u("call displayToView on your view instead"),e.viewToDisplay=()=>u("callviewtodisplay on your view instead"),e.getSize=()=>u("call getSize on your View instead"),e.normalizedDisplayToProjection=(t,n,r)=>{const i=e.normalizedDisplayToNormalizedViewport(t,n,r);return e.normalizedViewportToProjection(i[0],i[1],i[2])},e.normalizedDisplayToNormalizedViewport=(e,n,r)=>{const i=[t.viewport[2]-t.viewport[0],t.viewport[3]-t.viewport[1]];return[(e-t.viewport[0])/i[0],(n-t.viewport[1])/i[1],r]},e.normalizedViewportToProjection=(e,t,n)=>[2*e-1,2*t-1,2*n-1],e.projectionToNormalizedDisplay=(t,n,r)=>{const i=e.projectionToNormalizedViewport(t,n,r);return e.normalizedViewportToNormalizedDisplay(i[0],i[1],i[2])},e.normalizedViewportToNormalizedDisplay=(e,n,r)=>{const i=[t.viewport[2]-t.viewport[0],t.viewport[3]-t.viewport[1]];return[e*i[0]+t.viewport[0],n*i[1]+t.viewport[1],r]},e.projectionToNormalizedViewport=(e,t,n)=>[.5*(e+1),.5*(t+1),.5*(n+1)],e.PickPropFrom=(r="PickPropFrom",()=>u(`vtkViewport::${r} - NOT IMPLEMENTED`))}const p={background:[0,0,0],background2:[.2,.2,.2],gradientBackground:!1,viewport:[0,0,1,1],aspect:[1,1],pixelAspect:[1,1],props:[],actors2D:[]};function f(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,p,n),i.m.obj(e,t),i.m.event(e,t,"event"),i.m.setGetArray(e,t,["viewport"],4),i.m.setGetArray(e,t,["background","background2"],3),d(e,t)}var h={newInstance:i.m.newInstance(f,"vtkViewport"),extend:f},m=n(21734);const{vtkDebugMacro:g,vtkErrorMacro:v,vtkWarningMacro:y}=i.c;function b(e){return()=>v(`vtkRenderer::${e} - NOT IMPLEMENTED`)}const x={pickedProp:null,activeCamera:null,allBounds:[],ambient:[1,1,1],allocatedRenderTime:100,timeFactor:1,automaticLightCreation:!0,twoSidedLighting:!0,lastRenderTimeInSeconds:-1,renderWindow:null,lights:[],actors:[],volumes:[],lightFollowCamera:!0,numberOfPropsRendered:0,propArray:null,pathArray:null,layer:0,preserveColorBuffer:!1,preserveDepthBuffer:!1,computeVisiblePropBounds:(0,a.H)(),interactive:!0,nearClippingPlaneTolerance:0,clippingRangeExpansion:.05,erase:!0,draw:!0,useShadows:!1,useDepthPeeling:!1,occlusionRatio:0,maximumNumberOfPeels:4,selector:null,delegate:null,texturedBackground:!1,backgroundTexture:null,environmentTexture:null,environmentTextureDiffuseStrength:1,environmentTextureSpecularStrength:1,useEnvironmentTextureAsBackground:!1,pass:0};function A(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(Object.assign(t,x,n),h.extend(e,t,n),t.background||(t.background=[0,0,0,1]);t.background.length<3;)t.background.push(0);3===t.background.length&&t.background.push(1),(0,i.g)(e,t,["_renderWindow","allocatedRenderTime","timeFactor","lastRenderTimeInSeconds","numberOfPropsRendered","lastRenderingUsedDepthPeeling","selector"]),(0,i.e)(e,t,["twoSidedLighting","lightFollowCamera","automaticLightCreation","erase","draw","nearClippingPlaneTolerance","clippingRangeExpansion","backingStore","interactive","layer","preserveColorBuffer","preserveDepthBuffer","useDepthPeeling","occlusionRatio","maximumNumberOfPeels","delegate","backgroundTexture","texturedBackground","environmentTexture","environmentTextureDiffuseStrength","environmentTextureSpecularStrength","useEnvironmentTextureAsBackground","useShadows","pass"]),(0,i.k)(e,t,["actors","volumes","lights"]),(0,i.l)(e,t,["background"],4,1),(0,i.i)(e,t,["renderWindow"]),function(e,t){t.classHierarchy.push("vtkRenderer");const n={type:"ComputeVisiblePropBoundsEvent",renderer:e},i={type:"ResetCameraClippingRangeEvent",renderer:e},s={type:"ResetCameraEvent",renderer:e};e.updateCamera=()=>(t.activeCamera||(g("No cameras are on, creating one."),e.getActiveCameraAndResetIfCreated()),t.activeCamera.render(e),!0),e.updateLightsGeometryToFollowCamera=()=>{const n=e.getActiveCameraAndResetIfCreated();t.lights.forEach((e=>{e.lightTypeIsSceneLight()||(e.lightTypeIsHeadLight()?(e.setPositionFrom(n.getPositionByReference()),e.setFocalPointFrom(n.getFocalPointByReference()),e.modified(n.getMTime())):e.lightTypeIsCameraLight()?e.setTransformMatrix(n.getCameraLightTransformMatrix(r.pB.create())):v("light has unknown light type",e.get()))}))},e.updateLightGeometry=()=>!t.lightFollowCamera||e.updateLightsGeometryToFollowCamera(),e.allocateTime=b("allocateTime"),e.updateGeometry=b("updateGeometry"),e.getVTKWindow=()=>t._renderWindow,e.setLayer=n=>{g(e.getClassName(),e,"setting Layer to ",n),t.layer!==n&&(t.layer=n,e.modified()),e.setPreserveColorBuffer(!!n)},e.setActiveCamera=n=>t.activeCamera!==n&&(t.activeCamera=n,e.modified(),e.invokeEvent({type:"ActiveCameraEvent",camera:n}),!0),e.makeCamera=()=>{const t=o.Ay.newInstance();return e.invokeEvent({type:"CreateCameraEvent",camera:t}),t},e.getActiveCamera=()=>(t.activeCamera||(t.activeCamera=e.makeCamera()),t.activeCamera),e.getActiveCameraAndResetIfCreated=()=>(t.activeCamera||(e.getActiveCamera(),e.resetCamera()),t.activeCamera),e.getActors=()=>(t.actors=[],t.props.forEach((e=>{t.actors=t.actors.concat(e.getActors())})),t.actors),e.addActor=e.addViewProp,e.removeActor=n=>{t.actors=t.actors.filter((e=>e!==n)),e.removeViewProp(n),e.modified()},e.removeAllActors=()=>{e.getActors().forEach((t=>{e.removeViewProp(t)})),t.actors=[],e.modified()},e.getVolumes=()=>(t.volumes=[],t.props.forEach((e=>{t.volumes=t.volumes.concat(e.getVolumes())})),t.volumes),e.addVolume=e.addViewProp,e.removeVolume=n=>{t.volumes=t.volumes.filter((e=>e!==n)),e.removeViewProp(n),e.modified()},e.removeAllVolumes=()=>{e.getVolumes().forEach((t=>{e.removeViewProp(t)})),t.volumes=[],e.modified()},e.hasLight=e=>t.lights.includes(e),e.addLight=n=>{n&&!e.hasLight(n)&&(t.lights.push(n),e.modified())},e.removeLight=n=>{t.lights=t.lights.filter((e=>e!==n)),e.modified()},e.removeAllLights=()=>{t.lights=[],e.modified()},e.setLightCollection=n=>{t.lights=n,e.modified()},e.makeLight=c.newInstance,e.createLight=()=>{t.automaticLightCreation&&(t._createdLight&&(e.removeLight(t._createdLight),t._createdLight.delete(),t._createdLight=null),t._createdLight=e.makeLight(),e.addLight(t._createdLight),t._createdLight.setLightTypeToHeadLight(),t._createdLight.setPosition(e.getActiveCamera().getPosition()),t._createdLight.setFocalPoint(e.getActiveCamera().getFocalPoint()))},e.normalizedDisplayToWorld=(t,n,r,i)=>{let o=e.normalizedDisplayToProjection(t,n,r);return o=e.projectionToView(o[0],o[1],o[2],i),e.viewToWorld(o[0],o[1],o[2])},e.worldToNormalizedDisplay=(t,n,r,i)=>{let o=e.worldToView(t,n,r);return o=e.viewToProjection(o[0],o[1],o[2],i),e.projectionToNormalizedDisplay(o[0],o[1],o[2])},e.viewToWorld=(e,n,i)=>{if(null===t.activeCamera)return v("ViewToWorld: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const o=t.activeCamera.getViewMatrix();r.pB.invert(o,o),r.pB.transpose(o,o);const a=new Float64Array([e,n,i]);return r.eR.transformMat4(a,a,o),a},e.projectionToView=(e,n,i,o)=>{if(null===t.activeCamera)return v("ProjectionToView: no active camera, cannot compute projection to view, returning 0,0,0"),[0,0,0];const a=t.activeCamera.getProjectionMatrix(o,-1,1);r.pB.invert(a,a),r.pB.transpose(a,a);const s=new Float64Array([e,n,i]);return r.eR.transformMat4(s,s,a),s},e.worldToView=(e,n,i)=>{if(null===t.activeCamera)return v("WorldToView: no active camera, cannot compute view to world, returning 0,0,0"),[0,0,0];const o=t.activeCamera.getViewMatrix();r.pB.transpose(o,o);const a=new Float64Array([e,n,i]);return r.eR.transformMat4(a,a,o),a},e.viewToProjection=(e,n,i,o)=>{if(null===t.activeCamera)return v("ViewToProjection: no active camera, cannot compute view to projection, returning 0,0,0"),[0,0,0];const a=t.activeCamera.getProjectionMatrix(o,-1,1);r.pB.transpose(a,a);const s=new Float64Array([e,n,i]);return r.eR.transformMat4(s,s,a),s},e.computeVisiblePropBounds=()=>{t.allBounds[0]=m.Ay.INIT_BOUNDS[0],t.allBounds[1]=m.Ay.INIT_BOUNDS[1],t.allBounds[2]=m.Ay.INIT_BOUNDS[2],t.allBounds[3]=m.Ay.INIT_BOUNDS[3],t.allBounds[4]=m.Ay.INIT_BOUNDS[4],t.allBounds[5]=m.Ay.INIT_BOUNDS[5];let r=!0;e.invokeEvent(n);for(let e=0;e<t.props.length;++e){const n=t.props[e];if(n.getVisibility()&&n.getUseBounds()){const e=n.getBounds();e&&(0,a.U)(e)&&(r=!1,e[0]<t.allBounds[0]&&(t.allBounds[0]=e[0]),e[1]>t.allBounds[1]&&(t.allBounds[1]=e[1]),e[2]<t.allBounds[2]&&(t.allBounds[2]=e[2]),e[3]>t.allBounds[3]&&(t.allBounds[3]=e[3]),e[4]<t.allBounds[4]&&(t.allBounds[4]=e[4]),e[5]>t.allBounds[5]&&(t.allBounds[5]=e[5]))}}return r&&((0,a.u)(t.allBounds),g("Can't compute bounds, no 3D props are visible")),t.allBounds},e.resetCamera=function(){const n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||e.computeVisiblePropBounds(),r=[0,0,0];if(!(0,a.U)(n))return g("Cannot reset camera!"),!1;let i=null;if(!e.getActiveCamera())return v("Trying to reset non-existent camera"),!1;i=t.activeCamera.getViewPlaneNormal(),t.activeCamera.setViewAngle(30),r[0]=(n[0]+n[1])/2,r[1]=(n[2]+n[3])/2,r[2]=(n[4]+n[5])/2;let o=n[1]-n[0],l=n[3]-n[2],c=n[5]-n[4];o*=o,l*=l,c*=c;let u=o+l+c;u=0===u?1:u,u=.5*Math.sqrt(u);const d=(0,a.r)(t.activeCamera.getViewAngle()),p=u,f=u/Math.sin(.5*d),h=t.activeCamera.getViewUp();return Math.abs((0,a.d)(h,i))>.999&&(y("Resetting view-up since view plane normal is parallel"),t.activeCamera.setViewUp(-h[2],h[0],h[1])),t.activeCamera.setFocalPoint(r[0],r[1],r[2]),t.activeCamera.setPosition(r[0]+f*i[0],r[1]+f*i[1],r[2]+f*i[2]),e.resetCameraClippingRange(n),t.activeCamera.setParallelScale(p),t.activeCamera.setPhysicalScale(u),t.activeCamera.setPhysicalTranslation(-r[0],-r[1],-r[2]),e.invokeEvent(s),!0},e.resetCameraClippingRange=function(){const n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||e.computeVisiblePropBounds();if(!(0,a.U)(n))return g("Cannot reset camera clipping range!"),!1;if(e.getActiveCameraAndResetIfCreated(),!t.activeCamera)return v("Trying to reset clipping range of non-existent camera"),!1;const r=t.activeCamera.computeClippingRange(n);let o=0;if(t.activeCamera.getParallelProjection())o=.2*t.activeCamera.getParallelScale();else{const e=(0,a.r)(t.activeCamera.getViewAngle());o=.2*Math.tan(e/2)*r[1]}return r[1]-r[0]<o&&(o=o-r[1]+r[0],r[1]+=o/2,r[0]-=o/2),r[0]<0&&(r[0]=0),r[0]=.99*r[0]-(r[1]-r[0])*t.clippingRangeExpansion,r[1]=1.01*r[1]+(r[1]-r[0])*t.clippingRangeExpansion,r[0]=r[0]>=r[1]?.01*r[1]:r[0],t.nearClippingPlaneTolerance||(t.nearClippingPlaneTolerance=.01),r[0]<t.nearClippingPlaneTolerance*r[1]&&(r[0]=t.nearClippingPlaneTolerance*r[1]),t.activeCamera.setClippingRange(r[0],r[1]),e.invokeEvent(i),!1},e.setRenderWindow=e=>{e!==t._renderWindow&&(t._vtkWindow=e,t._renderWindow=e)},e.visibleActorCount=()=>t.props.filter((e=>e.getVisibility())).length,e.visibleVolumeCount=e.visibleActorCount,e.getMTime=()=>{let e=t.mtime;const n=t.activeCamera?t.activeCamera.getMTime():0;n>e&&(e=n);const r=t._createdLight?t._createdLight.getMTime():0;return r>e&&(e=r),e},e.getTransparent=()=>!!t.preserveColorBuffer,e.isActiveCameraCreated=()=>!!t.activeCamera}(e,t)}var C={newInstance:(0,i.n)(A,"vtkRenderer"),extend:A}},61433:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a});var r=n(28906);const i={image:null,canvas:null,jsImageData:null,imageLoaded:!1,repeat:!1,interpolate:!1,edgeClamp:!1,mipLevel:0,resizable:!1};function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,i,n),r.m.obj(e,t),r.m.algo(e,t,6,0),r.m.get(e,t,["canvas","image","jsImageData","imageLoaded","resizable"]),r.m.setGet(e,t,["repeat","edgeClamp","interpolate","mipLevel"]),function(e,t){t.classHierarchy.push("vtkTexture"),e.imageLoaded=()=>{t.image.removeEventListener("load",e.imageLoaded),t.imageLoaded=!0,e.modified()},e.setJsImageData=n=>{t.jsImageData!==n&&(null!==n&&(e.setInputData(null),e.setInputConnection(null),t.image=null,t.canvas=null),t.jsImageData=n,t.imageLoaded=!0,e.modified())},e.setCanvas=n=>{t.canvas!==n&&(null!==n&&(e.setInputData(null),e.setInputConnection(null),t.image=null,t.jsImageData=null),t.canvas=n,e.modified())},e.setImage=n=>{t.image!==n&&(null!==n&&(e.setInputData(null),e.setInputConnection(null),t.canvas=null,t.jsImageData=null),t.image=n,t.imageLoaded=!1,n.complete?e.imageLoaded():n.addEventListener("load",e.imageLoaded),e.modified())},e.getDimensionality=()=>{let n=0,r=0,i=1;if(e.getInputData()){const t=e.getInputData();n=t.getDimensions()[0],r=t.getDimensions()[1],i=t.getDimensions()[2]}return t.jsImageData&&(n=t.jsImageData.width,r=t.jsImageData.height),t.canvas&&(n=t.canvas.width,r=t.canvas.height),t.image&&(n=t.image.width,r=t.image.height),(n>1)+(r>1)+(i>1)},e.getInputAsJsImageData=()=>{if(!t.imageLoaded||e.getInputData())return null;if(t.jsImageData)return t.jsImageData();if(t.canvas)return t.canvas.getContext("2d").getImageData(0,0,t.canvas.width,t.canvas.height);if(t.image){const e=document.createElement("canvas");e.width=t.image.width,e.height=t.image.height;const n=e.getContext("2d");return n.translate(0,e.height),n.scale(1,-1),n.drawImage(t.image,0,0,t.image.width,t.image.height),n.getImageData(0,0,e.width,e.height)}return null}}(e,t)}var a={newInstance:r.m.newInstance(o,"vtkTexture"),extend:o,...{generateMipmaps:(e,t,n,r)=>{const i=[1,2,1],o=e.length/(t*n);let a=t,s=n,l=e;const c=[l];for(let e=0;e<r;e++){const e=[...l];a/=2,s/=2,l=new Uint8ClampedArray(a*s*o);const t=o*a;let n=0;for(let r=0;r<l.length;r+=o){r%t==0&&(n+=2*o*a);for(let i=0;i<o;i++){let a=e[n+i];a+=e[n+o+i],a+=e[n-2*t+i],a+=e[n-2*t+o+i],a/=4,l[r+i]=a}n+=2*o}let r=[...l];for(let e=0;e<l.length;e+=o)for(let n=0;n<o;n++){let a=-(i.length-1)/2,s=4,c=0;for(let l=0;l<i.length;l++){let u=e+n+a*o;const d=u%t-(e+n)%t;d>o&&(u+=t),d<-o&&(u-=t),r[u]?c+=r[u]*i[l]:s-=i[l],a+=1}l[e+n]=c/s}r=[...l];for(let e=0;e<l.length;e+=o)for(let n=0;n<o;n++){let o=-(i.length-1)/2,a=4,s=0;for(let l=0;l<i.length;l++){const c=e+n+o*t;r[c]?s+=r[c]*i[l]:a-=i[l],o+=1}l[e+n]=s/a}c.push(l)}return c}}}},53387:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>p});var r=n(28906),i=n(16632),o=n(67737),a=n(68076),s=n(99341);const{BlendMode:l,FilterMode:c}=o.Ay;const u={createRadonTransferFunction:function(e,t,n,r,i){let o=null;return i?(o=i,o.removeAllPoints()):o=s.Ay.newInstance(),o.addPointLong(-1024,0,1,1),o.addPoint(e,t),o.addPoint(n,r),o}};function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,(e=>({bounds:[1,-1,1,-1,1,-1],sampleDistance:1,imageSampleDistance:1,maximumSamplesPerRay:1e3,autoAdjustSampleDistances:!0,initialInteractionScale:1,interactionSampleDistanceFactor:1,blendMode:l.COMPOSITE_BLEND,ipScalarRange:[-1e6,1e6],filterMode:c.OFF,preferSizeOverAccuracy:!1,computeNormalFromOpacity:!1,volumetricScatteringBlending:0,globalIlluminationReach:0,volumeShadowSamplingDistFactor:5,anisotropy:0,localAmbientOcclusion:!1,LAOKernelSize:15,LAOKernelRadius:7,updatedExtents:[],...e}))(n)),a.A.extend(e,t,n),r.m.setGet(e,t,["sampleDistance","imageSampleDistance","maximumSamplesPerRay","autoAdjustSampleDistances","initialInteractionScale","interactionSampleDistanceFactor","blendMode","filterMode","preferSizeOverAccuracy","computeNormalFromOpacity","volumetricScatteringBlending","globalIlluminationReach","volumeShadowSamplingDistFactor","anisotropy","localAmbientOcclusion","LAOKernelSize","LAOKernelRadius","updatedExtents"]),r.m.setGetArray(e,t,["ipScalarRange"],2),r.m.event(e,t,"lightingActivated"),function(e,t){t.classHierarchy.push("vtkVolumeMapper");const n={...e};e.getBounds=()=>{const n=e.getInputData();return n?(t.static||e.update(),t.bounds=n.getBounds()):t.bounds=(0,i.H)(),t.bounds},e.update=()=>{e.getInputData()},e.setBlendModeToComposite=()=>{e.setBlendMode(l.COMPOSITE_BLEND)},e.setBlendModeToMaximumIntensity=()=>{e.setBlendMode(l.MAXIMUM_INTENSITY_BLEND)},e.setBlendModeToMinimumIntensity=()=>{e.setBlendMode(l.MINIMUM_INTENSITY_BLEND)},e.setBlendModeToAverageIntensity=()=>{e.setBlendMode(l.AVERAGE_INTENSITY_BLEND)},e.setBlendModeToAdditiveIntensity=()=>{e.setBlendMode(l.ADDITIVE_INTENSITY_BLEND)},e.setBlendModeToRadonTransform=()=>{e.setBlendMode(l.RADON_TRANSFORM_BLEND)},e.getBlendModeAsString=()=>r.m.enumToString(l,t.blendMode),e.setAverageIPScalarRange=(t,n)=>{console.warn("setAverageIPScalarRange is deprecated use setIpScalarRange"),e.setIpScalarRange(t,n)},e.getFilterModeAsString=()=>r.m.enumToString(c,t.filterMode),e.setFilterModeToOff=()=>{e.setFilterMode(c.OFF)},e.setFilterModeToNormalized=()=>{e.setFilterMode(c.NORMALIZED)},e.setFilterModeToRaw=()=>{e.setFilterMode(c.RAW)},e.setGlobalIlluminationReach=e=>n.setGlobalIlluminationReach((0,i.E)(e,0,1)),e.setVolumetricScatteringBlending=e=>n.setVolumetricScatteringBlending((0,i.E)(e,0,1)),e.setVolumeShadowSamplingDistFactor=e=>n.setVolumeShadowSamplingDistFactor(e>=1?e:1),e.setAnisotropy=e=>n.setAnisotropy((0,i.E)(e,-.99,.99)),e.setLAOKernelSize=e=>n.setLAOKernelSize((0,i.K)((0,i.E)(e,1,32))),e.setLAOKernelRadius=e=>n.setLAOKernelRadius(e>=1?e:1)}(e,t)}var p={newInstance:r.m.newInstance(d,"vtkVolumeMapper"),extend:d,...u}},67737:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>i,Nx:()=>r});const r={COMPOSITE_BLEND:0,MAXIMUM_INTENSITY_BLEND:1,MINIMUM_INTENSITY_BLEND:2,AVERAGE_INTENSITY_BLEND:3,ADDITIVE_INTENSITY_BLEND:4,RADON_TRANSFORM_BLEND:5,LABELMAP_EDGE_PROJECTION_BLEND:6};var i={BlendMode:r,FilterMode:{OFF:0,NORMALIZED:1,RAW:2}}},20433:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a,VO:()=>r,dM:()=>o,tE:()=>i});const r={NEAREST:0,LINEAR:1,FAST_LINEAR:2},i={FRACTIONAL:0,PROPORTIONAL:1},o={CUSTOM:0,ADDITIVE:1,COLORIZE:2};var a={InterpolationType:r,OpacityMode:i,ColorMixPreset:o}},80639:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(3823),i=n(28906),o=n(25196),a=n(88691);const s={context:null,keyMatrixTime:null,keyMatrices:null,activeTextures:null};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),o.A.extend(e,t,n),t.keyMatrixTime={},(0,i.o)(t.keyMatrixTime,{mtime:0}),t.keyMatrices={normalMatrix:r.w0.identity(new Float64Array(9)),mcwc:r.pB.identity(new Float64Array(16))},(0,i.e)(e,t,["context"]),(0,i.g)(e,t,["activeTextures"]),function(e,t){t.classHierarchy.push("vtkOpenGLActor"),e.buildPass=n=>{if(n){t._openGLRenderWindow=e.getLastAncestorOfType("vtkOpenGLRenderWindow"),t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.context=t._openGLRenderWindow.getContext(),e.prepareNodes(),e.addMissingNodes(t.renderable.getTextures()),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes(),t.ogltextures=null,t.activeTextures=null;for(let e=0;e<t.children.length;e++){const n=t.children[e];n.isA("vtkOpenGLTexture")?(t.ogltextures||(t.ogltextures=[]),t.ogltextures.push(n)):t.oglmapper=n}}},e.traverseZBufferPass=n=>{t.renderable&&t.renderable.getNestedVisibility()&&(!t._openGLRenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.oglmapper.traverse(n),e.apply(n,!1))},e.traverseOpaqueZBufferPass=t=>e.traverseOpaquePass(t),e.traverseOpaquePass=n=>{t.renderable&&t.renderable.getNestedVisibility()&&t.renderable.getIsOpaque()&&(!t._openGLRenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.oglmapper.traverse(n),e.apply(n,!1))},e.traverseTranslucentPass=n=>{!t.renderable||!t.renderable.getNestedVisibility()||t.renderable.getIsOpaque()||t._openGLRenderer.getSelector()&&!t.renderable.getNestedPickable()||(e.apply(n,!0),t.oglmapper.traverse(n),e.apply(n,!1))},e.activateTextures=()=>{if(t.ogltextures){t.activeTextures=[];for(let e=0;e<t.ogltextures.length;e++){const n=t.ogltextures[e];n.render(),n.getHandle()&&t.activeTextures.push(n)}}},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;t.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},e.zBufferPass=(t,n)=>e.opaquePass(t,n),e.opaqueZBufferPass=(t,n)=>e.opaquePass(t,n),e.opaquePass=(n,r)=>{if(n)t.context.depthMask(!0),e.activateTextures();else if(t.activeTextures)for(let e=0;e<t.activeTextures.length;e++)t.activeTextures[e].deactivate()},e.translucentPass=(n,r)=>{if(n)t.context.depthMask(t._openGLRenderer.getSelector()&&t.renderable.getNestedPickable()),e.activateTextures();else if(t.activeTextures)for(let e=0;e<t.activeTextures.length;e++)t.activeTextures[e].deactivate()},e.getKeyMatrices=()=>(t.renderable.getMTime()>t.keyMatrixTime.getMTime()&&(t.renderable.computeMatrix(),r.pB.copy(t.keyMatrices.mcwc,t.renderable.getMatrix()),r.pB.transpose(t.keyMatrices.mcwc,t.keyMatrices.mcwc),t.renderable.getIsIdentity()?r.w0.identity(t.keyMatrices.normalMatrix):(r.w0.fromMat4(t.keyMatrices.normalMatrix,t.keyMatrices.mcwc),r.w0.invert(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix),r.w0.transpose(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix)),t.keyMatrixTime.modified()),t.keyMatrices)}(e,t)}const c=(0,i.n)(l);var u={newInstance:c,extend:l};(0,a.c9)("vtkActor",c)},58601:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var r=n(28906),i=n(25196),o=n(88691);const a={context:null,activeTextures:null};function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,a,n),i.A.extend(e,t,n),(0,r.e)(e,t,["context"]),(0,r.g)(e,t,["activeTextures"]),function(e,t){t.classHierarchy.push("vtkOpenGLActor2D"),e.buildPass=n=>{if(n){if(!t.renderable)return;t._openGLRenderWindow=e.getLastAncestorOfType("vtkOpenGLRenderWindow"),t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.context=t._openGLRenderWindow.getContext(),e.prepareNodes(),e.addMissingNodes(t.renderable.getTextures()),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes(),t.ogltextures=null,t.activeTextures=null;for(let e=0;e<t.children.length;e++){const n=t.children[e];n.isA("vtkOpenGLTexture")?(t.ogltextures||(t.ogltextures=[]),t.ogltextures.push(n)):t.oglmapper=n}}},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;n.incrementOverlayActorCount()}},e.traverseOpaquePass=n=>{t.oglmapper&&t.renderable&&t.renderable.getNestedVisibility()&&t.renderable.getIsOpaque()&&(!t._openGLRenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.oglmapper.traverse(n),e.apply(n,!1))},e.traverseTranslucentPass=n=>{t.oglmapper&&t.renderable&&t.renderable.getNestedVisibility()&&!t.renderable.getIsOpaque()&&(!t._openGLRenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.oglmapper.traverse(n),e.apply(n,!1))},e.traverseOverlayPass=n=>{t.oglmapper&&t.renderable&&t.renderable.getNestedVisibility()&&(!t._openGLRenderer.getSelector()||t.renderable.getNestedPickable)&&(e.apply(n,!0),t.oglmapper.traverse(n),e.apply(n,!1))},e.activateTextures=()=>{if(t.ogltextures){t.activeTextures=[];for(let e=0;e<t.ogltextures.length;e++){const n=t.ogltextures[e];n.render(),n.getHandle()&&t.activeTextures.push(n)}}},e.opaquePass=(n,r)=>{if(n)t.context.depthMask(!0),e.activateTextures();else if(t.activeTextures)for(let e=0;e<t.activeTextures.length;e++)t.activeTextures[e].deactivate()},e.translucentPass=(n,r)=>{if(n)t.context.depthMask(!1),e.activateTextures();else if(t.activeTextures)for(let e=0;e<t.activeTextures.length;e++)t.activeTextures[e].deactivate()},e.overlayPass=(n,r)=>{if(n)t.context.depthMask(!0),e.activateTextures();else if(t.activeTextures)for(let e=0;e<t.activeTextures.length;e++)t.activeTextures[e].deactivate()}}(e,t)}const l=(0,r.n)(s);var c={newInstance:l,extend:s};(0,o.c9)("vtkActor2D",l)},21081:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>l});var r=n(28906),i=n(60003);const{ObjectType:o}=i.A;const a={objectType:o.ARRAY_BUFFER,context:null,allocatedGPUMemoryInBytes:0};function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,a,n),r.m.obj(e,t),r.m.get(e,t,["_openGLRenderWindow","allocatedGPUMemoryInBytes"]),r.m.moveToProtected(e,t,["openGLRenderWindow"]),function(e,t){function n(e){switch(e){case o.ELEMENT_ARRAY_BUFFER:return t.context.ELEMENT_ARRAY_BUFFER;case o.TEXTURE_BUFFER:if("TEXTURE_BUFFER"in t.context)return t.context.TEXTURE_BUFFER;case o.ARRAY_BUFFER:default:return t.context.ARRAY_BUFFER}}t.classHierarchy.push("vtkOpenGLBufferObject");let r=null,i=null,a=!0,s="";e.getType=()=>r,e.setType=e=>{r=e},e.getHandle=()=>i,e.isReady=()=>!1===a,e.generateBuffer=e=>{const o=n(e);return null===i&&(i=t.context.createBuffer(),r=e),n(r)===o},e.upload=(o,l)=>e.generateBuffer(l)?(t.context.bindBuffer(n(r),i),t.context.bufferData(n(r),o,t.context.STATIC_DRAW),t.allocatedGPUMemoryInBytes=o.length*o.BYTES_PER_ELEMENT,a=!1,!0):(s="Trying to upload array buffer to incompatible buffer.",!1),e.bind=()=>!!i&&(t.context.bindBuffer(n(r),i),!0),e.release=()=>!!i&&(t.context.bindBuffer(n(r),null),!0),e.releaseGraphicsResources=()=>{null!==i&&(t.context.bindBuffer(n(r),null),t.context.deleteBuffer(i),i=null,t.allocatedGPUMemoryInBytes=0)},e.setOpenGLRenderWindow=n=>{t._openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t._openGLRenderWindow=n,t.context=null,n&&(t.context=t._openGLRenderWindow.getContext()))},e.getError=()=>s}(e,t)}var l={newInstance:r.m.newInstance(s),extend:s,...i.A}},60003:(e,t,n)=>{"use strict";n.d(t,{A:()=>i,a:()=>r});const r={ARRAY_BUFFER:0,ELEMENT_ARRAY_BUFFER:1,TEXTURE_BUFFER:2};var i={ObjectType:r}},38475:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(3823),i=n(28906),o=n(25196),a=n(88691);const s={context:null,lastRenderer:null,keyMatrixTime:null,keyMatrices:null};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),o.A.extend(e,t,n),t.keyMatrixTime={},(0,i.o)(t.keyMatrixTime),t.keyMatrices={normalMatrix:new Float64Array(9),vcpc:new Float64Array(16),wcvc:new Float64Array(16),wcpc:new Float64Array(16)},(0,i.e)(e,t,["context","keyMatrixTime"]),function(e,t){t.classHierarchy.push("vtkOpenGLCamera"),e.buildPass=n=>{n&&(t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t._openGLRenderWindow=t._openGLRenderer.getParent(),t.context=t._openGLRenderWindow.getContext())},e.opaquePass=e=>{if(e){const e=t._openGLRenderer.getTiledSizeAndOrigin();t.context.viewport(e.lowerLeftU,e.lowerLeftV,e.usize,e.vsize),t.context.scissor(e.lowerLeftU,e.lowerLeftV,e.usize,e.vsize)}},e.translucentPass=e.opaquePass,e.zBufferPass=e.opaquePass,e.opaqueZBufferPass=e.opaquePass,e.volumePass=e.opaquePass,e.getKeyMatrices=n=>{if(n!==t.lastRenderer||t._openGLRenderWindow.getMTime()>t.keyMatrixTime.getMTime()||e.getMTime()>t.keyMatrixTime.getMTime()||n.getMTime()>t.keyMatrixTime.getMTime()||t.renderable.getMTime()>t.keyMatrixTime.getMTime()){r.pB.copy(t.keyMatrices.wcvc,t.renderable.getViewMatrix()),r.w0.fromMat4(t.keyMatrices.normalMatrix,t.keyMatrices.wcvc),r.w0.invert(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix),r.pB.transpose(t.keyMatrices.wcvc,t.keyMatrices.wcvc);const e=t._openGLRenderer.getAspectRatio();r.pB.copy(t.keyMatrices.vcpc,t.renderable.getProjectionMatrix(e,-1,1)),r.pB.transpose(t.keyMatrices.vcpc,t.keyMatrices.vcpc),r.pB.multiply(t.keyMatrices.wcpc,t.keyMatrices.vcpc,t.keyMatrices.wcvc),t.keyMatrixTime.modified(),t.lastRenderer=n}return t.keyMatrices}}(e,t)}const c=(0,i.n)(l);var u={newInstance:c,extend:l};(0,a.c9)("vtkCamera",c)},32821:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var r=n(28906),i=n(79525),o=n(28914),a=n(52271);const s={glFramebuffer:null,colorBuffers:null,depthTexture:null,previousDrawBinding:0,previousReadBinding:0,previousDrawBuffer:0,previousReadBuffer:0,previousActiveFramebuffer:null};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),(0,r.o)(e,t),t.colorBuffers&&(0,r.r)("you cannot initialize colorBuffers through the constructor. You should call setColorBuffer() instead."),t.colorBuffers=[],(0,r.k)(e,t,["colorBuffers"]),function(e,t){t.classHierarchy.push("vtkFramebuffer"),e.getBothMode=()=>t.context.FRAMEBUFFER,e.saveCurrentBindingsAndBuffers=t=>{const n=void 0!==t?t:e.getBothMode();e.saveCurrentBindings(n),e.saveCurrentBuffers(n)},e.saveCurrentBindings=e=>{if(!t.context)return void(0,r.r)("you must set the OpenGLRenderWindow before calling saveCurrentBindings");const n=t.context;t.previousDrawBinding=n.getParameter(t.context.FRAMEBUFFER_BINDING),t.previousActiveFramebuffer=t._openGLRenderWindow.getActiveFramebuffer()},e.saveCurrentBuffers=e=>{},e.restorePreviousBindingsAndBuffers=t=>{const n=void 0!==t?t:e.getBothMode();e.restorePreviousBindings(n),e.restorePreviousBuffers(n)},e.restorePreviousBindings=e=>{if(!t.context)return void(0,r.r)("you must set the OpenGLRenderWindow before calling restorePreviousBindings");const n=t.context;n.bindFramebuffer(n.FRAMEBUFFER,t.previousDrawBinding),t._openGLRenderWindow.setActiveFramebuffer(t.previousActiveFramebuffer)},e.restorePreviousBuffers=e=>{},e.bind=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===n&&(n=t.context.FRAMEBUFFER),t.context.bindFramebuffer(n,t.glFramebuffer);for(let e=0;e<t.colorBuffers.length;e++)t.colorBuffers[e].bind();t._openGLRenderWindow.setActiveFramebuffer(e)},e.create=(e,n)=>{t.context?(t.glFramebuffer=t.context.createFramebuffer(),t.glFramebuffer.width=e,t.glFramebuffer.height=n):(0,r.r)("you must set the OpenGLRenderWindow before calling create")},e.setColorBuffer=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=t.context;if(!i)return void(0,r.r)("you must set the OpenGLRenderWindow before calling setColorBuffer");let o=i.COLOR_ATTACHMENT0;if(n>0){if(!t._openGLRenderWindow.getWebgl2())return void(0,r.r)("Using multiple framebuffer attachments requires WebGL 2");o+=n}t.colorBuffers[n]=e,i.framebufferTexture2D(i.FRAMEBUFFER,o,i.TEXTURE_2D,e.getHandle(),0)},e.removeColorBuffer=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const n=t.context;if(!n)return void(0,r.r)("you must set the OpenGLRenderWindow before calling removeColorBuffer");let i=n.COLOR_ATTACHMENT0;if(e>0){if(!t._openGLRenderWindow.getWebgl2())return void(0,r.r)("Using multiple framebuffer attachments requires WebGL 2");i+=e}n.framebufferTexture2D(n.FRAMEBUFFER,i,n.TEXTURE_2D,null,0),t.colorBuffers=t.colorBuffers.splice(e,1)},e.setDepthBuffer=e=>{if(t.context)if(t._openGLRenderWindow.getWebgl2()){const n=t.context;n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,e.getHandle(),0)}else(0,r.r)("Attaching depth buffer textures to fbo requires WebGL 2");else(0,r.r)("you must set the OpenGLRenderWindow before calling setDepthBuffer")},e.removeDepthBuffer=()=>{if(t.context)if(t._openGLRenderWindow.getWebgl2()){const e=t.context;e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,null,0)}else(0,r.r)("Attaching depth buffer textures to framebuffers requires WebGL 2");else(0,r.r)("you must set the OpenGLRenderWindow before calling removeDepthBuffer")},e.getGLFramebuffer=()=>t.glFramebuffer,e.setOpenGLRenderWindow=n=>{t._openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t._openGLRenderWindow=n,t.context=null,n&&(t.context=t._openGLRenderWindow.getContext()))},e.releaseGraphicsResources=()=>{t.glFramebuffer&&t.context.deleteFramebuffer(t.glFramebuffer)},e.getSize=()=>null==t.glFramebuffer?null:[t.glFramebuffer.width,t.glFramebuffer.height],e.populateFramebuffer=()=>{if(!t.context)return void(0,r.r)("you must set the OpenGLRenderWindow before calling populateFrameBuffer");e.bind();const n=t.context,s=i.Ay.newInstance();s.setOpenGLRenderWindow(t._openGLRenderWindow),s.setMinificationFilter(a.dJ.LINEAR),s.setMagnificationFilter(a.dJ.LINEAR),s.create2DFromRaw(t.glFramebuffer.width,t.glFramebuffer.height,4,o.JA.UNSIGNED_CHAR,null),e.setColorBuffer(s),t.depthTexture=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,t.depthTexture),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,t.glFramebuffer.width,t.glFramebuffer.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,t.depthTexture)},e.getColorTexture=()=>t.colorBuffers[0]}(e,t)}var c={newInstance:(0,r.n)(l,"vtkFramebuffer"),extend:l}},57703:(e,t,n)=>{"use strict";n.d(t,{A:()=>i,T:()=>r});const r={MIN_KNOWN_PASS:0,ACTOR_PASS:0,COMPOSITE_INDEX_PASS:1,ID_LOW24:2,ID_HIGH24:3,MAX_KNOWN_PASS:3};var i={PassTypes:r}},71650:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>y});var r=n(28906),i=n(3823),o=n(21081),a=n(60003),s=n(71995);const{vtkErrorMacro:l}=r.m;function c(e,t){t.classHierarchy.push("vtkOpenGLCellArrayBufferObject"),e.setType(a.a.ARRAY_BUFFER),e.createVBO=function(n,r,i,l){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!n.getData()||!n.getData().length)return t.elementCount=0,0;t.blockSize=3,t.vertexOffset=0,t.normalOffset=0,t.tCoordOffset=0,t.tCoordComponents=0,t.colorComponents=0,t.colorOffset=0,t.customData=[];const u=l.points.getData();let d=null,p=null,f=null;const h=l.colors?l.colors.getNumberOfComponents():0,m=l.tcoords?l.tcoords.getNumberOfComponents():0;l.normals&&(t.normalOffset=4*t.blockSize,t.blockSize+=3,d=l.normals.getData()),l.customAttributes&&l.customAttributes.forEach((e=>{e&&(t.customData.push({data:e.getData(),offset:4*t.blockSize,components:e.getNumberOfComponents(),name:e.getName()}),t.blockSize+=e.getNumberOfComponents())})),l.tcoords&&(t.tCoordOffset=4*t.blockSize,t.tCoordComponents=m,t.blockSize+=m,p=l.tcoords.getData()),l.colors?(t.colorComponents=l.colors.getNumberOfComponents(),t.colorOffset=0,f=l.colors.getData(),t.colorBO||(t.colorBO=o.Ay.newInstance()),t.colorBO.setOpenGLRenderWindow(t._openGLRenderWindow)):t.colorBO=null,t.stride=4*t.blockSize;let g,v=0,y=0,b=0,x=0,A=0,C=0;const T={anythingToPoints(e,t,n,r){for(let i=0;i<e;++i)g(t[n+i],r)},linesToWireframe(e,t,n,r){for(let i=0;i<e-1;++i)g(t[n+i],r),g(t[n+i+1],r)},polysToWireframe(e,t,n,r){if(e>2)for(let i=0;i<e;++i)g(t[n+i],r),g(t[n+(i+1)%e],r)},stripsToWireframe(e,t,n,r){if(e>2){for(let i=0;i<e-1;++i)g(t[n+i],r),g(t[n+i+1],r);for(let i=0;i<e-2;i++)g(t[n+i],r),g(t[n+i+2],r)}},polysToSurface(e,t,n,r){for(let i=0;i<e-2;i++)g(t[n+0],r),g(t[n+i+1],r),g(t[n+i+2],r)},stripsToSurface(e,t,n,r){for(let i=0;i<e-2;i++)g(t[n+i],r),g(t[n+i+1+i%2],r),g(t[n+i+1+(i+1)%2],r)}},S={anythingToPoints:(e,t)=>e,linesToWireframe:(e,t)=>e>1?2*(e-1):0,polysToWireframe:(e,t)=>e>2?2*e:0,stripsToWireframe:(e,t)=>e>2?4*e-6:0,polysToSurface:(e,t)=>e>2?3*(e-2):0,stripsToSurface:(e,t,n)=>e>2?3*(e-2):0};let w=null,_=null;i===s.YL.POINTS||"verts"===r?(w=T.anythingToPoints,_=S.anythingToPoints):i===s.YL.WIREFRAME||"lines"===r?(w=T[`${r}ToWireframe`],_=S[`${r}ToWireframe`]):(w=T[`${r}ToSurface`],_=S[`${r}ToSurface`]);const I=n.getData(),E=I.length;let D=0;for(let e=0;e<E;)D+=_(I[e],I),e+=I[e]+1;let O=null;const P=new Float32Array(D*t.blockSize);f&&(O=new Uint8Array(4*D));let R=0,N=0,M=0,L=0;for(let e=0;e<3;++e){const t=l.points.getRange(e),n=t[1]-t[0];M+=n*n;const r=.5*(t[1]+t[0]);L+=r*r}if(M>0&&(Math.abs(L)/M>1e6||Math.abs(Math.log10(M))>3||0===M&&L>1e6)){const t=new Float64Array(3),n=new Float64Array(3);for(let e=0;e<3;++e){const r=l.points.getRange(e),i=r[1]-r[0];t[e]=.5*(r[1]+r[0]),n[e]=i>0?1/i:1}e.setCoordShiftAndScale(t,n)}else!0===t.coordShiftAndScaleEnabled&&e.setCoordShiftAndScale(null,null);if(c)if(c.points||c.cells){const e=new Int32Array(D+c.points.length);e.set(c.points),c.points=e;const t=new Int32Array(D+c.cells.length);t.set(c.cells),c.cells=t}else c.points=new Int32Array(D),c.cells=new Int32Array(D);let F=l.vertexOffset;g=function(e,n){if(c&&(c.points[F]=e,c.cells[F]=C+l.cellOffset),++F,v=3*e,t.coordShiftAndScaleEnabled?(P[R++]=(u[v++]-t.coordShift[0])*t.coordScale[0],P[R++]=(u[v++]-t.coordShift[1])*t.coordScale[1],P[R++]=(u[v++]-t.coordShift[2])*t.coordScale[2]):(P[R++]=u[v++],P[R++]=u[v++],P[R++]=u[v++]),null!==d&&(y=l.haveCellNormals?3*(C+l.cellOffset):3*e,P[R++]=d[y++],P[R++]=d[y++],P[R++]=d[y++]),t.customData.forEach((t=>{A=e*t.components;for(let e=0;e<t.components;++e)P[R++]=t.data[A++]})),null!==p){b=l.useTCoordsPerCell?n*m:e*m;for(let e=0;e<m;++e)P[R++]=p[b++]}null!==f&&(x=l.haveCellScalars?(C+l.cellOffset)*h:e*h,O[N++]=f[x++],O[N++]=f[x++],O[N++]=f[x++],O[N++]=4===h?f[x++]:255)};for(let e=0;e<E;e+=I[e]+1,C++)w(I[e],I,e+1,C+l.cellOffset);return t.elementCount=D,e.upload(P,a.a.ARRAY_BUFFER),t.colorBO&&(t.colorBOStride=4,t.colorBO.upload(O,a.a.ARRAY_BUFFER)),C},e.setCoordShiftAndScale=(e,n)=>{null===e||e.constructor===Float64Array&&3===e.length?null===n||n.constructor===Float64Array&&3===n.length?(null!==t.coordShift&&null!==e&&i.eR.equals(e,t.coordShift)||(t.coordShift=e),null!==t.coordScale&&null!==n&&i.eR.equals(n,t.coordScale)||(t.coordScale=n),t.coordShiftAndScaleEnabled=function(e,t){return null!==e&&null!==t&&!(i.eR.exactEquals(e,[0,0,0])&&i.eR.exactEquals(t,[1,1,1]))}(t.coordShift,t.coordScale),t.coordShiftAndScaleEnabled?t.inverseShiftAndScaleMatrix=function(e,t){const n=new Float64Array(3);i.eR.inverse(n,t);const r=new Float64Array(16);return i.pB.fromRotationTranslationScale(r,i.Yu.create(),e,n),r}(t.coordShift,t.coordScale):t.inverseShiftAndScaleMatrix=null):l("Wrong type for coordScale, expected vec3 or null"):l("Wrong type for coordShift, expected vec3 or null")}}const u={elementCount:0,stride:0,colorBOStride:0,vertexOffset:0,normalOffset:0,tCoordOffset:0,tCoordComponents:0,colorOffset:0,colorComponents:0,tcoordBO:null,customData:[],coordShift:null,coordScale:null,coordShiftAndScaleEnabled:!1,inverseShiftAndScaleMatrix:null};function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,u,n),o.Ay.extend(e,t,n),r.m.setGet(e,t,["colorBO","elementCount","stride","colorBOStride","vertexOffset","normalOffset","tCoordOffset","tCoordComponents","colorOffset","colorComponents","customData"]),r.m.get(e,t,["coordShift","coordScale","coordShiftAndScaleEnabled","inverseShiftAndScaleMatrix"]),c(e,t)}var p={newInstance:r.m.newInstance(d),extend:d},f=n(18713),h=n(13926);const m={Start:0,Points:0,Lines:1,Tris:2,TriStrips:3,TrisEdges:4,TriStripsEdges:5,End:6};const g={context:null,program:null,shaderSourceTime:null,VAO:null,attributeUpdateTime:null,CABO:null,primitiveType:0,pointPicking:!1};function v(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,g,n),r.m.obj(e,t),t.shaderSourceTime={},r.m.obj(t.shaderSourceTime),t.attributeUpdateTime={},r.m.obj(t.attributeUpdateTime),r.m.setGet(e,t,["program","shaderSourceTime","VAO","attributeUpdateTime","CABO","primitiveType","pointPicking"]),t.program=f.A.newInstance(),t.VAO=h.Ay.newInstance(),t.CABO=p.newInstance(),function(e,t){t.classHierarchy.push("vtkOpenGLHelper"),e.setOpenGLRenderWindow=e=>{t.context=e.getContext(),t.program.setContext(t.context),t.VAO.setOpenGLRenderWindow(e),t.CABO.setOpenGLRenderWindow(e)},e.releaseGraphicsResources=e=>{t.VAO.releaseGraphicsResources(),t.CABO.releaseGraphicsResources(),t.CABO.setElementCount(0)},e.drawArrays=(n,r,i,o)=>{if(t.CABO.getElementCount()){const a=e.getOpenGLMode(i),s=e.haveWideLines(n,r),l=t.context,c=l.getParameter(l.DEPTH_WRITEMASK);t.pointPicking&&l.depthMask(!1),a===l.LINES&&s?(e.updateShaders(n,r,o),l.drawArraysInstanced(a,0,t.CABO.getElementCount(),2*Math.ceil(r.getProperty().getLineWidth()))):(l.lineWidth(r.getProperty().getLineWidth()),e.updateShaders(n,r,o),l.drawArrays(a,0,t.CABO.getElementCount()),l.lineWidth(1));const u=(a===l.POINTS?1:0)||(a===l.LINES?2:3);return t.pointPicking&&l.depthMask(c),t.CABO.getElementCount()/u}return 0},e.getOpenGLMode=e=>{if(t.pointPicking)return t.context.POINTS;const n=t.primitiveType;return e===s.YL.POINTS||n===m.Points?t.context.POINTS:e===s.YL.WIREFRAME||n===m.Lines||n===m.TrisEdges||n===m.TriStripsEdges?t.context.LINES:t.context.TRIANGLES},e.haveWideLines=(e,n)=>n.getProperty().getLineWidth()>1&&!(t.CABO.getOpenGLRenderWindow()&&t.CABO.getOpenGLRenderWindow().getHardwareMaximumLineWidth()>=n.getProperty().getLineWidth()),e.getNeedToRebuildShaders=(t,n,r)=>!!(r.getNeedToRebuildShaders(e,t,n)||0===e.getProgram()||e.getShaderSourceTime().getMTime()<r.getMTime()||e.getShaderSourceTime().getMTime()<n.getMTime()),e.updateShaders=(n,r,i)=>{if(e.getNeedToRebuildShaders(n,r,i)){const o={Vertex:null,Fragment:null,Geometry:null};i.buildShaders(o,n,r);const a=t.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);a!==e.getProgram()&&(e.setProgram(a),e.getVAO().releaseGraphicsResources()),e.getShaderSourceTime().modified()}else t.CABO.getOpenGLRenderWindow().getShaderCache().readyShaderProgram(e.getProgram());e.getVAO().bind(),i.setMapperShaderParameters(e,n,r),i.setPropertyShaderParameters(e,n,r),i.setCameraShaderParameters(e,n,r),i.setLightingShaderParameters(e,n,r),i.invokeShaderCallbacks(e,n,r)},e.setMapperShaderParameters=(n,r,i)=>{if(e.haveWideLines(n,r)){e.getProgram().setUniform2f("viewportSize",i.usize,i.vsize);const t=parseFloat(r.getProperty().getLineWidth()),n=t/2;e.getProgram().setUniformf("lineWidthStepSize",t/Math.ceil(t)),e.getProgram().setUniformf("halfLineWidth",n)}t.primitiveType===m.Points||r.getProperty().getRepresentation()===s.YL.POINTS?e.getProgram().setUniformf("pointSize",r.getProperty().getPointSize()):t.pointPicking&&e.getProgram().setUniformf("pointSize",e.getPointPickingPrimitiveSize())},e.replaceShaderPositionVC=(n,r,i)=>{let o=n.Vertex;o=f.A.substitute(o,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform float pointSize;"]).result,o=f.A.substitute(o,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl","  gl_PointSize = pointSize;"],!1).result,e.getOpenGLMode(i.getProperty().getRepresentation())===t.context.LINES&&e.haveWideLines(r,i)&&(o=f.A.substitute(o,"//VTK::PositionVC::Dec",["//VTK::PositionVC::Dec","uniform vec2 viewportSize;","uniform float lineWidthStepSize;","uniform float halfLineWidth;"]).result,o=f.A.substitute(o,"//VTK::PositionVC::Impl",["//VTK::PositionVC::Impl"," if (halfLineWidth > 0.0)","   {","   float offset = float(gl_InstanceID / 2) * lineWidthStepSize - halfLineWidth;","   vec4 tmpPos = gl_Position;","   vec3 tmpPos2 = tmpPos.xyz / tmpPos.w;","   tmpPos2.x = tmpPos2.x + 2.0 * mod(float(gl_InstanceID), 2.0) * offset / viewportSize[0];","   tmpPos2.y = tmpPos2.y + 2.0 * mod(float(gl_InstanceID + 1), 2.0) * offset / viewportSize[1];","   gl_Position = vec4(tmpPos2.xyz * tmpPos.w, tmpPos.w);","   }"]).result),n.Vertex=o},e.getPointPickingPrimitiveSize=()=>t.primitiveType===m.Points?2:t.primitiveType===m.Lines?4:6,e.getAllocatedGPUMemoryInBytes=()=>e.getCABO().getAllocatedGPUMemoryInBytes()}(e,t)}var y={newInstance:r.m.newInstance(v),extend:v,primTypes:m}},82967:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>w});var r=n(28906),i=n(3823),o=n(52271),a=n(91732);const s={MAX:0,MIN:1,AVERAGE:2};var l=n(71995),c=n(28914),u=n(42008),d=n(71650),p=n(79525),f=n(83534),h=n(18713),m=n(25196),g=n(90919),v=n(84839),y=n(23159),b=n(88691),x=(n(57285),n(7698));const{vtkErrorMacro:A}=r.m;const C={currentRenderPass:null,volumeTexture:null,colorTexture:null,pwfTexture:null,tris:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0,lastIndependentComponents:0,imagemat:null,imagematinv:null};function T(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,C,n),m.A.extend(e,t,n),f.A.implementReplaceShaderCoincidentOffset(e,t,n),r.m.algo(e,t,2,0),t.tris=d.Ay.newInstance(),t.volumeTexture=null,t.colorTexture=null,t.pwfTexture=null,t.imagemat=i.pB.identity(new Float64Array(16)),t.imagematinv=i.pB.identity(new Float64Array(16)),t.VBOBuildTime={},r.m.obj(t.VBOBuildTime,{mtime:0}),function(e,t){function n(n){[t._scalars,t._colorTransferFunc,t._pwFunc].forEach((t=>n.unregisterGraphicsResourceUser(t,e)))}t.classHierarchy.push("vtkOpenGLImageCPRMapper"),e.buildPass=r=>{if(r){t.currentRenderPass=null,t.openGLImageSlice=e.getFirstAncestorOfType("vtkOpenGLImageSlice"),t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer");const r=t._openGLRenderWindow;t._openGLRenderWindow=t._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),r&&!r.isDeleted()&&r!==t._openGLRenderWindow&&n(r),t.context=t._openGLRenderWindow.getContext(),t.openGLCamera=t._openGLRenderer.getViewNodeFor(t._openGLRenderer.getRenderable().getActiveCamera()),t.tris.setOpenGLRenderWindow(t._openGLRenderWindow)}},e.opaquePass=(n,r)=>{n&&(t.currentRenderPass=r,e.render())},e.opaqueZBufferPass=n=>{n&&(t.haveSeenDepthRequest=!0,t.renderDepth=!0,e.render(),t.renderDepth=!1)},e.getCoincidentParameters=(e,n)=>t.renderable.getResolveCoincidentTopology()===x.XK.PolygonOffset?t.renderable.getCoincidentTopologyPolygonOffsetParameters():null,e.render=()=>{const n=t.openGLImageSlice.getRenderable(),r=t._openGLRenderer.getRenderable();e.renderPiece(r,n)},e.renderPiece=(n,r)=>{e.invokeEvent({type:"StartEvent"}),t.renderable.update(),e.invokeEvent({type:"EndEvent"}),t.renderable.preRenderCheck()&&(t.currentImageDataInput=t.renderable.getInputData(0),t.currentCenterlineInput=t.renderable.getOrientedCenterline(),e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r))},e.renderPieceStart=(t,n)=>{e.updateBufferObjects(t,n)},e.renderPieceDraw=(n,r)=>{const i=t.context;t.volumeTexture.activate(),t.colorTexture.activate(),t.pwfTexture.activate(),t.tris.getCABO().getElementCount()&&(e.updateShaders(t.tris,n,r),i.drawArrays(i.TRIANGLES,0,t.tris.getCABO().getElementCount()),t.tris.getVAO().release()),t.volumeTexture.deactivate(),t.colorTexture.deactivate(),t.pwfTexture.deactivate()},e.renderPieceFinish=(e,t)=>{},e.updateBufferObjects=(n,r)=>{e.getNeedToRebuildBufferObjects(n,r)&&e.buildBufferObjects(n,r),r.getProperty().getInterpolationType()===a.V.NEAREST?(t.volumeTexture.setMinificationFilter(o.dJ.NEAREST),t.volumeTexture.setMagnificationFilter(o.dJ.NEAREST),t.colorTexture.setMinificationFilter(o.dJ.NEAREST),t.colorTexture.setMagnificationFilter(o.dJ.NEAREST),t.pwfTexture.setMinificationFilter(o.dJ.NEAREST),t.pwfTexture.setMagnificationFilter(o.dJ.NEAREST)):(t.volumeTexture.setMinificationFilter(o.dJ.LINEAR),t.volumeTexture.setMagnificationFilter(o.dJ.LINEAR),t.colorTexture.setMinificationFilter(o.dJ.LINEAR),t.colorTexture.setMagnificationFilter(o.dJ.LINEAR),t.pwfTexture.setMinificationFilter(o.dJ.LINEAR),t.pwfTexture.setMagnificationFilter(o.dJ.LINEAR))},e.getNeedToRebuildBufferObjects=(n,r)=>{const i=t.VBOBuildTime.getMTime();return i<e.getMTime()||i<t.renderable.getMTime()||i<r.getMTime()||i<t.currentImageDataInput.getMTime()||i<t.currentCenterlineInput.getMTime()||!t.volumeTexture?.getHandle()},e.buildBufferObjects=(n,r)=>{const i=t.currentImageDataInput,o=t.currentCenterlineInput,a=i?.getPointData()?.getScalars();if(!a)return;const s=t._openGLRenderWindow.getGraphicsResourceForObject(a),d=(0,g.eS)(i,a),f=!s?.oglObject?.getHandle()||s?.hash!==d,h=t.renderable.getUpdatedExtents(),m=!!h.length;if(f){t.volumeTexture=p.Ay.newInstance(),t.volumeTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const n=i.getDimensions();t.volumeTexture.setOglNorm16Ext(t.context.getExtension("EXT_texture_norm16")),t.volumeTexture.resetFormatAndType(),t.volumeTexture.create3DFilterableFromDataArray(n[0],n[1],n[2],a,t.renderable.getPreferSizeOverAccuracy()),t._openGLRenderWindow.setGraphicsResourceForObject(a,t.volumeTexture,d),a!==t._scalars&&(t._openGLRenderWindow.registerGraphicsResourceUser(a,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._scalars,e)),t._scalars=a}else t.volumeTexture=s.oglObject;if(m){t.renderable.setUpdatedExtents([]);const e=i.getDimensions();t.volumeTexture.create3DFilterableFromDataArray(e[0],e[1],e[2],a,!1,h)}const v=a.getNumberOfComponents(),y=r.getProperty(),b=y.getIndependentComponents(),x=b?v:1,A=b?2*x:1,C=y.getRGBTransferFunction(),T=(0,g.gP)(C,b,x),S=t._openGLRenderWindow.getGraphicsResourceForObject(C);if(S?.oglObject?.getHandle()&&S?.hash===T)t.colorTexture=S.oglObject;else{const n=1024,r=new Uint8ClampedArray(n*A*3);if(t.colorTexture=p.Ay.newInstance(),t.colorTexture.setOpenGLRenderWindow(t._openGLRenderWindow),C){const e=new Float32Array(3*n);for(let t=0;t<x;t++){const i=y.getRGBTransferFunction(t),o=i.getRange();if(i.getTable(o[0],o[1],n,e,1),b)for(let i=0;i<3*n;i++)r[t*n*6+i]=255*e[i],r[t*n*6+i+3*n]=255*e[i];else for(let i=0;i<3*n;i++)r[t*n*6+i]=255*e[i]}t.colorTexture.resetFormatAndType(),t.colorTexture.create2DFromRaw(n,A,3,c.JA.UNSIGNED_CHAR,r)}else{for(let e=0;e<3*n;++e)r[e]=255*e/(3*(n-1)),r[e+1]=255*e/(3*(n-1)),r[e+2]=255*e/(3*(n-1));t.colorTexture.resetFormatAndType(),t.colorTexture.create2DFromRaw(n,1,3,c.JA.UNSIGNED_CHAR,r)}C&&(t._openGLRenderWindow.setGraphicsResourceForObject(C,t.colorTexture,T),C!==t._colorTransferFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(C,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._colorTransferFunc,e)),t._colorTransferFunc=C)}const w=y.getPiecewiseFunction(),_=(0,g.gP)(w,b,x),I=t._openGLRenderWindow.getGraphicsResourceForObject(w);if(I?.oglObject?.getHandle()&&I?.hash===_)t.pwfTexture=I.oglObject;else{const n=1024,r=n*A,i=new Uint8ClampedArray(r);if(t.pwfTexture=p.Ay.newInstance(),t.pwfTexture.setOpenGLRenderWindow(t._openGLRenderWindow),w){const e=new Float32Array(r),i=new Float32Array(n);for(let t=0;t<x;++t){const r=y.getPiecewiseFunction(t);if(null===r)e.fill(1);else{const o=r.getRange();if(r.getTable(o[0],o[1],n,i,1),b)for(let r=0;r<n;r++)e[t*n*2+r]=i[r],e[t*n*2+r+n]=i[r];else for(let r=0;r<n;r++)e[t*n*2+r]=i[r]}}t.pwfTexture.resetFormatAndType(),t.pwfTexture.create2DFromRaw(n,A,1,c.JA.FLOAT,e)}else i.fill(255),t.pwfTexture.resetFormatAndType(),t.pwfTexture.create2DFromRaw(n,1,1,c.JA.UNSIGNED_CHAR,i);w&&(t._openGLRenderWindow.setGraphicsResourceForObject(w,t.pwfTexture,_),w!==t._pwFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(w,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._pwFunc,e)),t._pwFunc=w)}if(t.VBOBuildTime.getMTime()<t.renderable.getMTime()||t.VBOBuildTime.getMTime()<o.getMTime()){const e=o.getNumberOfPoints(),n=e<=1?0:e-1,r=o.getDistancesToFirstPoint(),i=t.renderable.getHeight(),a=4*n,s=new Float32Array(3*a),c=t.renderable.getWidth();for(let e=0,t=0;e<n;++e)s.set([0,i-r[e],0],t),t+=3,s.set([c,i-r[e],0],t),t+=3,s.set([c,i-r[e+1],0],t),t+=3,s.set([0,i-r[e+1],0],t),t+=3;const d=u.Ay.newInstance({numberOfComponents:3,values:s});d.setName("points");const p=new Uint16Array(5*n);for(let e=0,t=0,r=0;e<n;++e)p.set([4,r+3,r+2,r+1,r],t),t+=5,r+=4;const f=u.Ay.newInstance({numberOfComponents:1,values:p}),h=o.getPoints(),m=new Float32Array(3*a),g=new Array(3),v=new Array(3);for(let e=0,t=0;e<n;++e)h.getPoint(e,g),h.getPoint(e+1,v),m.set(g,t),t+=3,m.set(g,t),t+=3,m.set(v,t),t+=3,m.set(v,t),t+=3;const y=u.Ay.newInstance({numberOfComponents:3,values:m,name:"centerlinePosition"}),b=new Float32Array(a);for(let e=0,t=0;e<n;++e)b.set([0,1,3,2],t),t+=4;const x=[y,u.Ay.newInstance({numberOfComponents:1,values:b,name:"quadIndex"})];if(!t.renderable.getUseUniformOrientation()){const e=t.renderable.getOrientedCenterline().getOrientations()??[],r=new Float32Array(4*a),i=new Float32Array(4*a);for(let t=0;t<n;++t){const n=e[t],o=e[t+1];for(let e=0;e<4;++e){const a=4*(e+4*t);r.set(n,a),i.set(o,a)}}const o=u.Ay.newInstance({numberOfComponents:4,values:r,name:"centerlineTopOrientation"}),s=u.Ay.newInstance({numberOfComponents:4,values:i,name:"centerlineBotOrientation"});x.push(o,s)}t.tris.getCABO().createVBO(f,"polys",l.YL.SURFACE,{points:d,customAttributes:x}),t.VBOBuildTime.modified()}},e.getNeedToRebuildShaders=(e,n,r)=>{const i=t.volumeTexture.getComponents(),o=r.getProperty().getIndependentComponents(),a=!!t.renderable.getCenterPoint(),s=t.renderable.getUseUniformOrientation(),l=t.renderable.isProjectionEnabled()&&t.renderable.getProjectionMode();return(0===e.getProgram()||t.lastUseCenterPoint!==a||t.lastUseUniformOrientation!==s||t.lastProjectionMode!==l||t.lastHaveSeenDepthRequest!==t.haveSeenDepthRequest||t.lastTextureComponents!==i||t.lastIndependentComponents!==o)&&(t.lastUseCenterPoint=a,t.lastUseUniformOrientation=s,t.lastProjectionMode=l,t.lastHaveSeenDepthRequest=t.haveSeenDepthRequest,t.lastTextureComponents=i,t.lastIndependentComponents=o,!0)},e.buildShaders=(t,n,r)=>{e.getShaderTemplate(t,n,r),e.replaceShaderValues(t,n,r)},e.replaceShaderValues=(n,r,i)=>{let o=n.Vertex,a=n.Fragment;const l=["vec3 applyQuaternionToVec(vec4 q, vec3 v) {","  float uvx = q.y * v.z - q.z * v.y;","  float uvy = q.z * v.x - q.x * v.z;","  float uvz = q.x * v.y - q.y * v.x;","  float uuvx = q.y * uvz - q.z * uvy;","  float uuvy = q.z * uvx - q.x * uvz;","  float uuvz = q.x * uvy - q.y * uvx;","  float w2 = q.w * 2.0;","  uvx *= w2;","  uvy *= w2;","  uvz *= w2;","  uuvx *= 2.0;","  uuvy *= 2.0;","  uuvz *= 2.0;","  return vec3(v.x + uvx + uuvx, v.y + uvy + uuvy, v.z + uvz + uuvz);","}"];o=h.A.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=h.A.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result;const c=["attribute vec3 centerlinePosition;","attribute float quadIndex;","uniform float width;","out vec2 quadOffsetVSOutput;","out vec3 centerlinePosVSOutput;"],u=t.renderable.isProjectionEnabled(),d=t.renderable.getUseUniformOrientation();d?(c.push("out vec3 samplingDirVSOutput;","uniform vec4 centerlineOrientation;","uniform vec3 tangentDirection;",...l),u&&c.push("out vec3 projectionDirVSOutput;","uniform vec3 bitangentDirection;")):c.push("out vec4 centerlineTopOrientationVSOutput;","out vec4 centerlineBotOrientationVSOutput;","attribute vec4 centerlineTopOrientation;","attribute vec4 centerlineBotOrientation;"),o=h.A.substitute(o,"//VTK::Color::Dec",c).result;const p=["quadOffsetVSOutput = vec2(width * (mod(quadIndex, 2.0) == 0.0 ? -0.5 : 0.5), quadIndex > 1.0 ? 0.0 : 1.0);","centerlinePosVSOutput = centerlinePosition;"];d?(p.push("samplingDirVSOutput = applyQuaternionToVec(centerlineOrientation, tangentDirection);"),u&&p.push("projectionDirVSOutput = applyQuaternionToVec(centerlineOrientation, bitangentDirection);")):p.push("centerlineTopOrientationVSOutput = centerlineTopOrientation;","centerlineBotOrientationVSOutput = centerlineBotOrientation;"),o=h.A.substitute(o,"//VTK::Color::Impl",p).result;const f=t.volumeTexture.getComponents(),m=i.getProperty().getIndependentComponents();let g=["uniform mat4 MCTCMatrix; // Model coordinates to texture coordinates","in vec2 quadOffsetVSOutput;","in vec3 centerlinePosVSOutput;","uniform highp sampler3D volumeTexture;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform float opacity;","uniform vec4 backgroundColor;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;"];u&&g.push("uniform vec3 volumeSizeMC;","uniform int projectionSlabNumberOfSamples;","uniform float projectionConstantOffset;","uniform float projectionStepLength;"),d?(g.push("in vec3 samplingDirVSOutput;"),u&&g.push("in vec3 projectionDirVSOutput;")):(g.push("uniform vec3 tangentDirection;","in vec4 centerlineTopOrientationVSOutput;","in vec4 centerlineBotOrientationVSOutput;",...l),u&&g.push("uniform vec3 bitangentDirection;"));const v=t.renderable.getCenterPoint();if(v&&g.push("uniform vec3 globalCenterPoint;"),m){for(let e=1;e<f;e++)g=g.concat([`uniform float cshift${e};`,`uniform float cscale${e};`,`uniform float pwfshift${e};`,`uniform float pwfscale${e};`]);switch(f){case 1:g=g.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:g=g.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:g=g.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:A("Unsupported number of independent coordinates.")}}a=h.A.substitute(a,"//VTK::TCoord::Dec",g).result;let y=[];if(d?(y.push("vec3 samplingDirection = samplingDirVSOutput;"),u&&y.push("vec3 projectionDirection = projectionDirVSOutput;")):(y.push("vec4 q0 = centerlineBotOrientationVSOutput;","vec4 q1 = centerlineTopOrientationVSOutput;","float qCosAngle = dot(q0, q1);","vec4 interpolatedOrientation;","if (qCosAngle > 0.999 || qCosAngle < -0.999) {","  // Use LERP instead of SLERP when the two quaternions are close or opposite","  interpolatedOrientation = normalize(mix(q0, q1, quadOffsetVSOutput.y));","} else {","  float omega = acos(qCosAngle);","  interpolatedOrientation = normalize(sin((1.0 - quadOffsetVSOutput.y) * omega) * q0 + sin(quadOffsetVSOutput.y * omega) * q1);","}","vec3 samplingDirection = applyQuaternionToVec(interpolatedOrientation, tangentDirection);"),u&&y.push("vec3 projectionDirection = applyQuaternionToVec(interpolatedOrientation, bitangentDirection);")),v?y.push("float baseOffset = dot(samplingDirection, globalCenterPoint - centerlinePosVSOutput);","float horizontalOffset = quadOffsetVSOutput.x + baseOffset;"):y.push("float horizontalOffset = quadOffsetVSOutput.x;"),y.push("vec3 volumePosMC = centerlinePosVSOutput + horizontalOffset * samplingDirection;","vec3 volumePosTC = (MCTCMatrix * vec4(volumePosMC, 1.0)).xyz;","if (any(lessThan(volumePosTC, vec3(0.0))) || any(greaterThan(volumePosTC, vec3(1.0))))","{","  // set the background color and exit","  gl_FragData[0] = backgroundColor;","  return;","}"),u){const e=t.renderable.getProjectionMode();switch(e){case s.MIN:y.push("const vec4 initialProjectionTextureValue = vec4(1.0);");break;case s.MAX:case s.AVERAGE:default:y.push("const vec4 initialProjectionTextureValue = vec4(0.0);")}switch(y.push("vec3 projectionScaledDirection = projectionDirection / volumeSizeMC;","vec3 projectionStep = projectionStepLength * projectionScaledDirection;","vec3 projectionStartPosition = volumePosTC + projectionConstantOffset * projectionScaledDirection;","vec4 tvalue = initialProjectionTextureValue;","for (int projectionSampleIdx = 0; projectionSampleIdx < projectionSlabNumberOfSamples; ++projectionSampleIdx) {","  vec3 projectionSamplePosition = projectionStartPosition + float(projectionSampleIdx) * projectionStep;","  vec4 sampledTextureValue = texture(volumeTexture, projectionSamplePosition);"),e){case s.MAX:y.push("  tvalue = max(tvalue, sampledTextureValue);");break;case s.MIN:y.push("  tvalue = min(tvalue, sampledTextureValue);");break;case s.AVERAGE:default:y.push("  tvalue = tvalue + sampledTextureValue;")}y.push("}"),e===s.AVERAGE&&y.push("tvalue = tvalue / float(projectionSlabNumberOfSamples);")}else y.push("vec4 tvalue = texture(volumeTexture, volumePosTC);");if(m){const e=["r","g","b","a"];for(let t=0;t<f;++t)y=y.concat([`vec3 tcolor${t} = mix${t} * texture2D(colorTexture1, vec2(tvalue.${e[t]} * cscale${t} + cshift${t}, height${t})).rgb;`,`float compWeight${t} = mix${t} * texture2D(pwfTexture1, vec2(tvalue.${e[t]} * pwfscale${t} + pwfshift${t}, height${t})).r;`]);switch(f){case 1:y=y.concat(["gl_FragData[0] = vec4(tcolor0.rgb, compWeight0 * opacity);"]);break;case 2:y=y.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:y=y.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:y=y.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:A("Unsupported number of independent coordinates.")}}else switch(f){case 1:y=y.concat(["// Dependent components","float intensity = tvalue.r;","vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;","float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;","gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);"]);break;case 2:y=y.concat(["float intensity = tvalue.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tvalue.g + pwfshift0);"]);break;case 3:y=y.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]);break;default:y=y.concat(["vec4 tcolor = cscale0*tvalue + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"])}a=h.A.substitute(a,"//VTK::TCoord::Impl",y).result,t.haveSeenDepthRequest&&(a=h.A.substitute(a,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,a=h.A.substitute(a,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=o,n.Fragment=a,e.replaceShaderClip(n,r,i),e.replaceShaderCoincidentOffset(n,r,i)},e.replaceShaderClip=(e,n,i)=>{let o=e.Vertex,a=e.Fragment;if(t.renderable.getNumberOfClippingPlanes()){let e=t.renderable.getNumberOfClippingPlanes();e>6&&(r.m.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),e=6),o=h.A.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,o=h.A.substitute(o,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,a=h.A.substitute(a,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,a=h.A.substitute(a,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}e.Vertex=o,e.Fragment=a},e.getShaderTemplate=(e,t,n)=>{e.Vertex=v.v,e.Fragment=y.v,e.Geometry=""},e.setMapperShaderParameters=(n,o,a)=>{const s=n.getProgram(),l=n.getCABO();l.getElementCount()&&(t.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&(s.isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(s,l,"vertexMC",l.getVertexOffset(),l.getStride(),t.context.FLOAT,3,t.context.FALSE)||A("Error setting vertexMC in shader VAO.")),n.getCABO().getCustomData().forEach((e=>{e&&s.isAttributeUsed(e.name)&&!n.getVAO().addAttributeArray(s,l,e.name,e.offset,l.getStride(),t.context.FLOAT,e.components,t.context.FALSE)&&A(`Error setting ${e.name} in shader VAO.`)})),n.getAttributeUpdateTime().modified());const c=t.volumeTexture.getTextureUnit();if(s.setUniformi("volumeTexture",c),s.setUniformf("width",t.renderable.getWidth()),n.getProgram().setUniform4fv("backgroundColor",t.renderable.getBackgroundColor()),s.isUniformUsed("tangentDirection")){const e=t.renderable.getTangentDirection();n.getProgram().setUniform3fArray("tangentDirection",e)}if(s.isUniformUsed("bitangentDirection")){const e=t.renderable.getBitangentDirection();n.getProgram().setUniform3fArray("bitangentDirection",e)}if(s.isUniformUsed("centerlineOrientation")){const e=t.renderable.getUniformOrientation();n.getProgram().setUniform4fv("centerlineOrientation",e)}if(s.isUniformUsed("globalCenterPoint")){const e=t.renderable.getCenterPoint();s.setUniform3fArray("globalCenterPoint",e)}if(t.renderable.isProjectionEnabled()){const e=t.currentImageDataInput,n=e.getSpacing(),r=e.getDimensions(),o=t.renderable.getProjectionSlabThickness(),a=t.renderable.getProjectionSlabNumberOfSamples(),l=i.eR.mul([],n,r);s.setUniform3fArray("volumeSizeMC",l),s.setUniformi("projectionSlabNumberOfSamples",a);const c=-.5*o;s.setUniformf("projectionConstantOffset",c);const u=o/(a-1);s.setUniformf("projectionStepLength",u)}const u=t.currentImageDataInput,d=u.getWorldToIndex(),p=i.pB.fromScaling(new Float32Array(16),i.eR.inverse([],u.getDimensions())),f=i.pB.mul(p,p,d);if(s.setUniformMatrix("MCTCMatrix",f),t.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",t.renderDepth?1:0),t.renderable.getNumberOfClippingPlanes()){let e=t.renderable.getNumberOfClippingPlanes();e>6&&(r.m.vtkErrorMacro("OpenGL has a limit of 6 clipping planes"),e=6);const n=l.getCoordShiftAndScaleEnabled()?l.getInverseShiftAndScaleMatrix():null,o=n?i.pB.copy(t.imagematinv,a.getMatrix()):a.getMatrix();n&&(i.pB.transpose(o,o),i.pB.multiply(o,o,n),i.pB.transpose(o,o)),i.pB.transpose(t.imagemat,t.currentImageDataInput.getIndexToWorld()),i.pB.multiply(t.imagematinv,o,t.imagemat);const c=[];for(let n=0;n<e;n++){const e=[];t.renderable.getClippingPlaneInDataCoords(t.imagematinv,n,e);for(let t=0;t<4;t++)c.push(e[t])}s.setUniformi("numClipPlanes",e),s.setUniform4fv("clipPlanes",c)}if(s.isUniformUsed("coffset")){const t=e.getCoincidentParameters(o,a);s.setUniformf("coffset",t.offset),s.isUniformUsed("cfactor")&&s.setUniformf("cfactor",t.factor)}},e.setCameraShaderParameters=(e,n,r)=>{const o=t.openGLImageSlice.getKeyMatrices().mcwc,a=t.openGLCamera.getKeyMatrices(n).wcpc;if(i.pB.multiply(t.imagemat,a,o),e.getCABO().getCoordShiftAndScaleEnabled()){const n=e.getCABO().getInverseShiftAndScaleMatrix();i.pB.multiply(t.imagemat,t.imagemat,n)}e.getProgram().setUniformMatrix("MCPCMatrix",t.imagemat)},e.setPropertyShaderParameters=(e,n,r)=>{const i=e.getProgram(),o=r.getProperty(),a=o.getOpacity();i.setUniformf("opacity",a);const s=t.volumeTexture.getComponents(),l=o.getIndependentComponents();if(l)for(let e=0;e<s;++e)i.setUniformf(`mix${e}`,o.getComponentWeight(e));const c=t.volumeTexture.getVolumeInfo();for(let e=0;e<s;e++){let t=o.getColorWindow(),n=o.getColorLevel();const r=l?e:0,a=o.getRGBTransferFunction(r);if(a&&o.getUseLookupTableScalarRange()){const e=a.getRange();t=e[1]-e[0],n=.5*(e[1]+e[0])}const s=c.scale[e]/t,u=(c.offset[e]-n)/t+.5;i.setUniformf(`cshift${e}`,u),i.setUniformf(`cscale${e}`,s)}const u=t.colorTexture.getTextureUnit();i.setUniformi("colorTexture1",u);for(let e=0;e<s;e++){let t=1,n=0;const r=l?e:0,a=o.getPiecewiseFunction(r);if(a){const r=a.getRange(),i=r[1]-r[0],o=.5*(r[0]+r[1]);t=c.scale[e]/i,n=(c.offset[e]-o)/i+.5}i.setUniformf(`pwfshift${e}`,n),i.setUniformf(`pwfscale${e}`,t)}const d=t.pwfTexture.getTextureUnit();i.setUniformi("pwfTexture1",d)},e.updateShaders=(n,r,i)=>{if(e.getNeedToRebuildShaders(n,r,i)){const o={Vertex:null,Fragment:null,Geometry:null};e.buildShaders(o,r,i);const a=t._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);a!==n.getProgram()&&(n.setProgram(a),n.getVAO().releaseGraphicsResources()),n.getShaderSourceTime().modified()}else t._openGLRenderWindow.getShaderCache().readyShaderProgram(n.getProgram());n.getVAO().bind(),e.setMapperShaderParameters(n,r,i),e.setCameraShaderParameters(n,r,i),e.setPropertyShaderParameters(n,r,i)},e.delete=r.m.chain((()=>{t._openGLRenderWindow&&n(t._openGLRenderWindow)}),e.delete)}(e,t)}const S=r.m.newInstance(T,"vtkOpenGLImageCPRMapper");var w={newInstance:S,extend:T};(0,b.c9)("vtkImageCPRMapper",S)},6814:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>E});var r=n(3823),i=n(94520),o=n(28906),a=n(42008),s=n(28914),l=n(71650),c=n(16632),u=n(79525),d=n(18713),p=n(25196),f=n(71995),h=n(52271),m=n(91732),g=n(90919),v=n(84839),y=n(23159),b=n(83534),x=(n(57285),n(88691)),A=n(7698);const{vtkErrorMacro:C}=o.c,{SlicingMode:T}=i.A;function S(e){const t=e.split("\n"),n=[];for(let e=0;e<t.length;++e){const r=t[e].trim();r.length>0&&n.push(r)}return n}const w={VBOBuildTime:0,VBOBuildString:null,openGLTexture:null,tris:null,imagemat:null,imagematinv:null,colorTexture:null,pwfTexture:null,labelOutlineThicknessTexture:null,labelOutlineThicknessTextureString:null,lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastTextureComponents:0};function _(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,w,n),p.A.extend(e,t,n),b.A.implementReplaceShaderCoincidentOffset(e,t,n),b.A.implementBuildShadersWithReplacements(e,t,n),t.tris=l.Ay.newInstance(),t.imagemat=r.pB.identity(new Float64Array(16)),t.imagematinv=r.pB.identity(new Float64Array(16)),t.projectionToWorld=r.pB.identity(new Float64Array(16)),t.idxToView=r.pB.identity(new Float64Array(16)),t.idxNormalMatrix=r.w0.identity(new Float64Array(9)),t.modelToView=r.pB.identity(new Float64Array(16)),t.projectionToView=r.pB.identity(new Float64Array(16)),(0,o.e)(e,t,[]),t.VBOBuildTime={},(0,o.o)(t.VBOBuildTime),function(e,t){function n(n){t.openGLTexture.releaseGraphicsResources(n),[t._colorTransferFunc,t._pwFunc,t._labelOutlineThicknessArray].forEach((t=>n.unregisterGraphicsResourceUser(t,e)))}t.classHierarchy.push("vtkOpenGLImageMapper"),e.buildPass=r=>{if(r){t.currentRenderPass=null,t.openGLImageSlice=e.getFirstAncestorOfType("vtkOpenGLImageSlice"),t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer");const r=t._openGLRenderWindow;t._openGLRenderWindow=t._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),r&&!r.isDeleted()&&r!==t._openGLRenderWindow&&n(r),t.context=t._openGLRenderWindow.getContext(),t.tris.setOpenGLRenderWindow(t._openGLRenderWindow);const i=t._openGLRenderer.getRenderable();t.openGLCamera=t._openGLRenderer.getViewNodeFor(i.getActiveCamera()),t.renderable.isA("vtkImageMapper")&&t.renderable.getSliceAtFocalPoint()&&t.renderable.setSliceFromCamera(i.getActiveCamera())}},e.translucentPass=(n,r)=>{n&&(t.currentRenderPass=r,e.render())},e.zBufferPass=n=>{n&&(t.haveSeenDepthRequest=!0,t.renderDepth=!0,e.render(),t.renderDepth=!1)},e.opaqueZBufferPass=t=>e.zBufferPass(t),e.opaquePass=t=>{t&&e.render()},e.getCoincidentParameters=(e,n)=>t.renderable.getResolveCoincidentTopology()==A.XK.PolygonOffset?t.renderable.getCoincidentTopologyPolygonOffsetParameters():null,e.render=()=>{const n=t.openGLImageSlice.getRenderable(),r=t._openGLRenderer.getRenderable();e.renderPiece(r,n)},e.getShaderTemplate=(e,t,n)=>{e.Vertex=v.v,e.Fragment=y.v,e.Geometry=""},e.replaceShaderValues=(n,r,i)=>{let o=n.Vertex,a=n.Fragment;o=d.A.substitute(o,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,o=d.A.substitute(o,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result,o=d.A.substitute(o,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result,o=d.A.substitute(o,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result;const s=t.openGLTexture.getComponents(),l=i.getProperty().getIndependentComponents();let c=["varying vec2 tcoordVCVSOutput;","uniform float cshift0;","uniform float cscale0;","uniform float pwfshift0;","uniform float pwfscale0;","uniform sampler2D texture1;","uniform sampler2D colorTexture1;","uniform sampler2D pwfTexture1;","uniform sampler2D labelOutlineTexture1;","uniform float opacity;","uniform float outlineOpacity;"];if(l){for(let e=1;e<s;e++)c=c.concat([`uniform float cshift${e};`,`uniform float cscale${e};`,`uniform float pwfshift${e};`,`uniform float pwfscale${e};`]);switch(s){case 1:c=c.concat(["uniform float mix0;","#define height0 0.5"]);break;case 2:c=c.concat(["uniform float mix0;","uniform float mix1;","#define height0 0.25","#define height1 0.75"]);break;case 3:c=c.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","#define height0 0.17","#define height1 0.5","#define height2 0.83"]);break;case 4:c=c.concat(["uniform float mix0;","uniform float mix1;","uniform float mix2;","uniform float mix3;","#define height0 0.125","#define height1 0.375","#define height2 0.625","#define height3 0.875"]);break;default:C("Unsupported number of independent coordinates.")}}if(a=d.A.substitute(a,"//VTK::TCoord::Dec",c).result,!0===i.getProperty().getUseLabelOutline()&&(a=d.A.substitute(a,"//VTK::LabelOutline::Dec",["uniform int outlineThickness;","uniform float vpWidth;","uniform float vpHeight;","uniform float vpOffsetX;","uniform float vpOffsetY;","uniform mat4 PCWCMatrix;","uniform mat4 vWCtoIDX;","uniform ivec3 imageDimensions;","uniform int sliceAxis;"]).result,a=d.A.substitute(a,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result,a=d.A.substitute(a,"//VTK::LabelOutlineHelperFunction",["#ifdef vtkImageLabelOutlineOn","vec3 fragCoordToIndexSpace(vec4 fragCoord) {","  vec4 pcPos = vec4(","    (fragCoord.x / vpWidth - vpOffsetX - 0.5) * 2.0,","    (fragCoord.y / vpHeight - vpOffsetY - 0.5) * 2.0,","    (fragCoord.z - 0.5) * 2.0,","    1.0);","","  vec4 worldCoord = PCWCMatrix * pcPos;","  vec4 vertex = (worldCoord/worldCoord.w);","","  vec3 index = (vWCtoIDX * vertex).xyz;","","  // half voxel fix for labelmapOutline","  return (index + vec3(0.5)) / vec3(imageDimensions);","}","vec2 getSliceCoords(vec3 coord, int axis) {","  if (axis == 0) return coord.yz;","  if (axis == 1) return coord.xz;","  if (axis == 2) return coord.xy;","}","#endif"]).result),l){const e=["r","g","b","a"];let t=["vec4 tvalue = texture2D(texture1, tcoordVCVSOutput);"];for(let n=0;n<s;n++)t=t.concat([`vec3 tcolor${n} = mix${n} * texture2D(colorTexture1, vec2(tvalue.${e[n]} * cscale${n} + cshift${n}, height${n})).rgb;`,`float compWeight${n} = mix${n} * texture2D(pwfTexture1, vec2(tvalue.${e[n]} * pwfscale${n} + pwfshift${n}, height${n})).r;`]);switch(s){case 1:t=t.concat(["gl_FragData[0] = vec4(tcolor0.rgb, opacity);"]);break;case 2:t=t.concat(["float weightSum = compWeight0 + compWeight1;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum))), opacity);"]);break;case 3:t=t.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum))), opacity);"]);break;case 4:t=t.concat(["float weightSum = compWeight0 + compWeight1 + compWeight2 + compWeight3;","gl_FragData[0] = vec4(vec3((tcolor0.rgb * (compWeight0 / weightSum)) + (tcolor1.rgb * (compWeight1 / weightSum)) + (tcolor2.rgb * (compWeight2 / weightSum)) + (tcolor3.rgb * (compWeight3 / weightSum))), opacity);"]);break;default:C("Unsupported number of independent coordinates.")}a=d.A.substitute(a,"//VTK::TCoord::Impl",t).result}else switch(s){case 1:a=d.A.substitute(a,"//VTK::TCoord::Impl",[...S("\n                #ifdef vtkImageLabelOutlineOn\n                  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord);\n                  float centerValue = texture2D(texture1, getSliceCoords(centerPosIS, sliceAxis)).r;\n                  bool pixelOnBorder = false;\n                  vec3 tColor = texture2D(colorTexture1, vec2(centerValue * cscale0 + cshift0, 0.5)).rgb;\n                  float scalarOpacity = texture2D(pwfTexture1, vec2(centerValue * pwfscale0 + pwfshift0, 0.5)).r;\n                  float opacityToUse = scalarOpacity * opacity;\n                  int segmentIndex = int(centerValue * 255.0);\n                  float textureCoordinate = float(segmentIndex - 1) / 1024.0;\n                  float textureValue = texture2D(labelOutlineTexture1, vec2(textureCoordinate, 0.5)).r;\n                  int actualThickness = int(textureValue * 255.0);\n\n                  if (segmentIndex == 0){\n                    gl_FragData[0] = vec4(0.0, 0.0, 0.0, 0.0);\n                    return;\n                  }\n\n                  for (int i = -actualThickness; i <= actualThickness; i++) {\n                    for (int j = -actualThickness; j <= actualThickness; j++) {\n                      if (i == 0 || j == 0) {\n                        continue;\n                      }\n                      vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),\n                        gl_FragCoord.y + float(j),\n                        gl_FragCoord.z, gl_FragCoord.w);\n                      vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);\n                      float value = texture2D(texture1, getSliceCoords(neighborPosIS, sliceAxis)).r;\n                      if (value != centerValue) {\n                        pixelOnBorder = true;\n                        break;\n                      }\n                    }\n                    if (pixelOnBorder == true) {\n                      break;\n                    }\n                  }\n                  if (pixelOnBorder == true) {\n                    gl_FragData[0] = vec4(tColor, outlineOpacity);\n                  }\n                  else {\n                    gl_FragData[0] = vec4(tColor, opacityToUse);\n                  }\n                #else\n                  float intensity = texture2D(texture1, tcoordVCVSOutput).r;\n                  vec3 tcolor = texture2D(colorTexture1, vec2(intensity * cscale0 + cshift0, 0.5)).rgb;\n                  float scalarOpacity = texture2D(pwfTexture1, vec2(intensity * pwfscale0 + pwfshift0, 0.5)).r;\n                  gl_FragData[0] = vec4(tcolor, scalarOpacity * opacity);\n                #endif\n                ")]).result;break;case 2:a=d.A.substitute(a,"//VTK::TCoord::Impl",["vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","float intensity = tcolor.r*cscale0 + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(intensity, 0.5)).rgb, pwfscale0*tcolor.g + pwfshift0);"]).result;break;case 3:a=d.A.substitute(a,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, opacity);"]).result;break;default:a=d.A.substitute(a,"//VTK::TCoord::Impl",["vec4 tcolor = cscale0*texture2D(texture1, tcoordVCVSOutput.st) + cshift0;","gl_FragData[0] = vec4(texture2D(colorTexture1, vec2(tcolor.r,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.g,0.5)).r,","  texture2D(colorTexture1, vec2(tcolor.b,0.5)).r, tcolor.a);"]).result}t.haveSeenDepthRequest&&(a=d.A.substitute(a,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,a=d.A.substitute(a,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result),n.Vertex=o,n.Fragment=a,e.replaceShaderClip(n,r,i),e.replaceShaderCoincidentOffset(n,r,i)},e.replaceShaderClip=(e,n,r)=>{let i=e.Vertex,a=e.Fragment;if(t.renderable.getNumberOfClippingPlanes()){let e=t.renderable.getNumberOfClippingPlanes();e>6&&((0,o.r)("OpenGL has a limit of 6 clipping planes"),e=6),i=d.A.substitute(i,"//VTK::Clip::Dec",["uniform int numClipPlanes;","uniform vec4 clipPlanes[6];","varying float clipDistancesVSOutput[6];"]).result,i=d.A.substitute(i,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,a=d.A.substitute(a,"//VTK::Clip::Dec",["uniform int numClipPlanes;","varying float clipDistancesVSOutput[6];"]).result,a=d.A.substitute(a,"//VTK::Clip::Impl",["for (int planeNum = 0; planeNum < 6; planeNum++)","    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}e.Vertex=i,e.Fragment=a},e.getNeedToRebuildShaders=(e,n,r)=>{const i=t.openGLTexture.getComponents(),o=r.getProperty().getIndependentComponents();let a=!1;return(!t.currentRenderPass&&t.lastRenderPassShaderReplacement||t.currentRenderPass&&t.currentRenderPass.getShaderReplacement()!==t.lastRenderPassShaderReplacement)&&(a=!0),!(!a&&t.lastHaveSeenDepthRequest===t.haveSeenDepthRequest&&0!==e.getProgram()?.getHandle()&&t.lastTextureComponents===i&&t.lastIndependentComponents===o||(t.lastHaveSeenDepthRequest=t.haveSeenDepthRequest,t.lastTextureComponents=i,t.lastIndependentComponents=o,0))},e.updateShaders=(n,r,i)=>{if(t.lastBoundBO=n,e.getNeedToRebuildShaders(n,r,i)){const o={Vertex:null,Fragment:null,Geometry:null};e.buildShaders(o,r,i);const a=t._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);a!==n.getProgram()&&(n.setProgram(a),n.getVAO().releaseGraphicsResources()),n.getShaderSourceTime().modified()}else t._openGLRenderWindow.getShaderCache().readyShaderProgram(n.getProgram());n.getVAO().bind(),e.setMapperShaderParameters(n,r,i),e.setCameraShaderParameters(n,r,i),e.setPropertyShaderParameters(n,r,i)},e.setMapperShaderParameters=(n,i,a)=>{n.getCABO().getElementCount()&&(t.VBOBuildTime>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&(n.getProgram().isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexMC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||C("Error setting vertexMC in shader VAO.")),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),t.context.FLOAT,n.getCABO().getTCoordComponents(),t.context.FALSE)||C("Error setting tcoordMC in shader VAO.")),n.getAttributeUpdateTime().modified());const s=t.openGLTexture.getTextureUnit();n.getProgram().setUniformi("texture1",s);const l=t.openGLTexture.getComponents(),c=a.getProperty().getIndependentComponents();if(c)for(let e=0;e<l;e++)n.getProgram().setUniformf(`mix${e}`,a.getProperty().getComponentWeight(e));const u=t.openGLTexture.getShiftAndScale();for(let e=0;e<l;e++){let t=a.getProperty().getColorWindow(),r=a.getProperty().getColorLevel();const i=c?e:0,o=a.getProperty().getRGBTransferFunction(i);if(o&&a.getProperty().getUseLookupTableScalarRange()){const e=o.getRange();t=e[1]-e[0],r=.5*(e[1]+e[0])}const s=u.scale/t,l=(u.shift-r)/t+.5;n.getProgram().setUniformf(`cshift${e}`,l),n.getProgram().setUniformf(`cscale${e}`,s)}for(let e=0;e<l;e++){let t=1,r=0;const i=c?e:0,o=a.getProperty().getPiecewiseFunction(i);if(o){const e=o.getRange(),n=e[1]-e[0],i=.5*(e[0]+e[1]);t=u.scale/n,r=(u.shift-i)/n+.5}n.getProgram().setUniformf(`pwfshift${e}`,r),n.getProgram().setUniformf(`pwfscale${e}`,t)}if(t.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",t.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){const t=e.getCoincidentParameters(i,a);n.getProgram().setUniformf("coffset",t.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",t.factor)}const d=t.colorTexture.getTextureUnit();n.getProgram().setUniformi("colorTexture1",d);const p=t.pwfTexture.getTextureUnit();n.getProgram().setUniformi("pwfTexture1",p);const f=t.labelOutlineThicknessTexture.getTextureUnit();if(n.getProgram().setUniformi("labelOutlineTexture1",f),t.renderable.getNumberOfClippingPlanes()){let e=t.renderable.getNumberOfClippingPlanes();e>6&&((0,o.r)("OpenGL has a limit of 6 clipping planes"),e=6);const i=n.getCABO().getCoordShiftAndScaleEnabled()?n.getCABO().getInverseShiftAndScaleMatrix():null,s=i?r.pB.copy(t.imagematinv,a.getMatrix()):a.getMatrix();i&&(r.pB.transpose(s,s),r.pB.multiply(s,s,i),r.pB.transpose(s,s)),r.pB.transpose(t.imagemat,t.currentInput.getIndexToWorld()),r.pB.multiply(t.imagematinv,s,t.imagemat);const l=[];for(let n=0;n<e;n++){const e=[];t.renderable.getClippingPlaneInDataCoords(t.imagematinv,n,e);for(let t=0;t<4;t++)l.push(e[t])}n.getProgram().setUniformi("numClipPlanes",e),n.getProgram().setUniform4fv("clipPlanes",l)}if(!0===a.getProperty().getUseLabelOutline()){const e=a.getProperty().getLabelOutlineOpacity();n.getProgram().setUniformf("outlineOpacity",e)}},e.setCameraShaderParameters=(n,i,o)=>{const a=n.getProgram(),s=t.openGLImageSlice.getKeyMatrices(),l=t.currentInput,c=l.getIndexToWorld();r.pB.multiply(t.imagemat,s.mcwc,c);const u=t.openGLCamera.getKeyMatrices(i);if(r.pB.multiply(t.imagemat,u.wcpc,t.imagemat),n.getCABO().getCoordShiftAndScaleEnabled()){const e=n.getCABO().getInverseShiftAndScaleMatrix();r.pB.multiply(t.imagemat,t.imagemat,e)}if(a.setUniformMatrix("MCPCMatrix",t.imagemat),!0===o.getProperty().getUseLabelOutline()){const n=l.getWorldToIndex(),o=l.getDimensions();let s=t.renderable.getClosestIJKAxis().ijkMode;s===T.NONE&&(s=T.K),a.setUniform3i("imageDimensions",o[0],o[1],o[2]),a.setUniformi("sliceAxis",s),a.setUniformMatrix("vWCtoIDX",n);const c=t.openGLCamera.getKeyMatrices(i);r.pB.invert(t.projectionToWorld,c.wcpc),t.openGLCamera.getKeyMatrices(i),a.setUniformMatrix("PCWCMatrix",t.projectionToWorld);const u=e.getRenderTargetSize();a.setUniformf("vpWidth",u[0]),a.setUniformf("vpHeight",u[1]);const d=e.getRenderTargetOffset();a.setUniformf("vpOffsetX",d[0]/u[0]),a.setUniformf("vpOffsetY",d[1]/u[1])}},e.setPropertyShaderParameters=(e,t,n)=>{const r=e.getProgram(),i=n.getProperty().getOpacity();r.setUniformf("opacity",i)},e.renderPieceStart=(n,r)=>{e.updateBufferObjects(n,r),t.lastBoundBO=null},e.renderPieceDraw=(n,r)=>{const i=t.context;t.openGLTexture.activate(),t.colorTexture.activate(),t.labelOutlineThicknessTexture.activate(),t.pwfTexture.activate(),t.tris.getCABO().getElementCount()&&(e.updateShaders(t.tris,n,r),i.drawArrays(i.TRIANGLES,0,t.tris.getCABO().getElementCount()),t.tris.getVAO().release()),t.openGLTexture.deactivate(),t.colorTexture.deactivate(),t.labelOutlineThicknessTexture.deactivate(),t.pwfTexture.deactivate()},e.renderPieceFinish=(e,t)=>{},e.renderPiece=(n,r)=>{e.invokeEvent({type:"StartEvent"}),t.renderable.update(),t.currentInput=t.renderable.getCurrentImage(),e.invokeEvent({type:"EndEvent"}),t.currentInput?(e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)):C("No input!")},e.computeBounds=(n,r)=>{e.getInput()?t.bounds=e.getInput().getBounds():(0,c.u)(t.bounds)},e.updateBufferObjects=(t,n)=>{e.getNeedToRebuildBufferObjects(t,n)&&e.buildBufferObjects(t,n)},e.getNeedToRebuildBufferObjects=(n,r)=>t.VBOBuildTime.getMTime()<e.getMTime()||t.VBOBuildTime.getMTime()<r.getMTime()||t.VBOBuildTime.getMTime()<t.renderable.getMTime()||t.VBOBuildTime.getMTime()<r.getProperty().getMTime()||t.VBOBuildTime.getMTime()<t.currentInput.getMTime()||!t.openGLTexture?.getHandle()||!t.colorTexture?.getHandle()||!t.labelOutlineThicknessTexture?.getHandle()||!t.pwfTexture?.getHandle(),e.buildBufferObjects=(n,r)=>{const i=t.currentInput;if(!i)return;const o=i.getPointData()&&i.getPointData().getScalars();if(!o)return;const l=o.getDataType(),c=o.getNumberOfComponents(),d=r.getProperty(),p=d.getInterpolationType(),v=d.getIndependentComponents(),y=v?c:1,b=v?2*y:1,x=d.getRGBTransferFunction(),A=(0,g.gP)(x,v,y),S=t._openGLRenderWindow.getGraphicsResourceForObject(x);if(S?.oglObject?.getHandle()&&S?.hash===A)t.colorTexture=S.oglObject;else{t.colorTexture=u.Ay.newInstance({resizable:!0}),t.colorTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const n=1024,r=new Uint8ClampedArray(n*b*3);if(p===m.V.NEAREST?(t.colorTexture.setMinificationFilter(h.dJ.NEAREST),t.colorTexture.setMagnificationFilter(h.dJ.NEAREST)):(t.colorTexture.setMinificationFilter(h.dJ.LINEAR),t.colorTexture.setMagnificationFilter(h.dJ.LINEAR)),x){const e=new Float32Array(3*n);for(let t=0;t<y;t++){const i=d.getRGBTransferFunction(t),o=i.getRange();if(i.getTable(o[0],o[1],n,e,1),v)for(let i=0;i<3*n;i++)r[t*n*6+i]=255*e[i],r[t*n*6+i+3*n]=255*e[i];else for(let i=0;i<3*n;i++)r[t*n*6+i]=255*e[i]}t.colorTexture.resetFormatAndType(),t.colorTexture.create2DFromRaw(n,b,3,s.JA.UNSIGNED_CHAR,r)}else{for(let e=0;e<3*n;++e)r[e]=255*e/(3*(n-1)),r[e+1]=255*e/(3*(n-1)),r[e+2]=255*e/(3*(n-1));t.colorTexture.create2DFromRaw(n,1,3,s.JA.UNSIGNED_CHAR,r)}x&&(t._openGLRenderWindow.setGraphicsResourceForObject(x,t.colorTexture,A),x!==t._colorTransferFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(x,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._colorTransferFunc,e)),t._colorTransferFunc=x)}const w=d.getPiecewiseFunction(),_=(0,g.gP)(w,v,y),I=t._openGLRenderWindow.getGraphicsResourceForObject(w);if(I?.oglObject?.getHandle()&&I?.hash===_)t.pwfTexture=I.oglObject;else{const n=1024,r=n*b,i=new Uint8ClampedArray(r);if(t.pwfTexture=u.Ay.newInstance({resizable:!0}),t.pwfTexture.setOpenGLRenderWindow(t._openGLRenderWindow),p===m.V.NEAREST?(t.pwfTexture.setMinificationFilter(h.dJ.NEAREST),t.pwfTexture.setMagnificationFilter(h.dJ.NEAREST)):(t.pwfTexture.setMinificationFilter(h.dJ.LINEAR),t.pwfTexture.setMagnificationFilter(h.dJ.LINEAR)),w){const e=new Float32Array(r),i=new Float32Array(n);for(let t=0;t<y;++t){const r=d.getPiecewiseFunction(t);if(null===r)e.fill(1);else{const o=r.getRange();if(r.getTable(o[0],o[1],n,i,1),v)for(let r=0;r<n;r++)e[t*n*2+r]=i[r],e[t*n*2+r+n]=i[r];else for(let r=0;r<n;r++)e[t*n*2+r]=i[r]}}t.pwfTexture.resetFormatAndType(),t.pwfTexture.create2DFromRaw(n,b,1,s.JA.FLOAT,e)}else i.fill(255),t.pwfTexture.create2DFromRaw(n,1,1,s.JA.UNSIGNED_CHAR,i);w&&(t._openGLRenderWindow.setGraphicsResourceForObject(w,t.pwfTexture,_),w!==t._pwFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(w,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._pwFunc,e)),t._pwFunc=w)}e.updatelabelOutlineThicknessTexture(r);const{ijkMode:E}=t.renderable.getClosestIJKAxis();let D=t.renderable.getSlice();E!==t.renderable.getSlicingMode()&&(D=t.renderable.getSliceAtPosition(D));const O=t.renderable.isA("vtkImageArrayMapper")?t.renderable.getSubSlice():Math.round(D),P=i.getExtent();let R;E===T.I&&(R=O-P[0]),E===T.J&&(R=O-P[2]),E!==T.K&&E!==T.NONE||(R=O-P[4]);const N=`${D}A${i.getMTime()}A${o.getMTime()}B${e.getMTime()}C${t.renderable.getSlicingMode()}D${r.getProperty().getInterpolationType()}`;if(t.VBOBuildString!==N){const e=i.getDimensions();t.openGLTexture||(t.openGLTexture=u.Ay.newInstance({resizable:!0})),t.openGLTexture.setOpenGLRenderWindow(t._openGLRenderWindow),t.openGLTexture.setOglNorm16Ext(t.context.getExtension("EXT_texture_norm16")),p===m.V.NEAREST?(new Set([1,3,4]).has(c)&&l===s.JA.UNSIGNED_CHAR&&!v?(t.openGLTexture.setGenerateMipmap(!0),t.openGLTexture.setMinificationFilter(h.dJ.NEAREST)):t.openGLTexture.setMinificationFilter(h.dJ.NEAREST),t.openGLTexture.setMagnificationFilter(h.dJ.NEAREST)):(4!==c||l!==s.JA.UNSIGNED_CHAR||v?t.openGLTexture.setMinificationFilter(h.dJ.LINEAR):(t.openGLTexture.setGenerateMipmap(!0),t.openGLTexture.setMinificationFilter(h.dJ.LINEAR_MIPMAP_LINEAR)),t.openGLTexture.setMagnificationFilter(h.dJ.LINEAR)),t.openGLTexture.setWrapS(h.B_.CLAMP_TO_EDGE),t.openGLTexture.setWrapT(h.B_.CLAMP_TO_EDGE);const n=e[0]*e[1]*c,r=new Float32Array(12),d=new Float32Array(8);for(let e=0;e<4;e++)d[2*e]=e%2?1:0,d[2*e+1]=e>1?1:0;const g=[T.X,T.Y,T.Z].includes(t.renderable.getSlicingMode())?D:O,y=i.getSpatialExtent(),b=o.getData();let x=null;if(E===T.I){x=new b.constructor(e[2]*e[1]*c);let t=0;for(let n=0;n<e[2];n++)for(let r=0;r<e[1];r++){let i=(R+r*e[0]+n*e[0]*e[1])*c;t=(n*e[1]+r)*c;const o=i+c;for(;i<o;)x[t++]=b[i++]}e[0]=e[1],e[1]=e[2],r[0]=g,r[1]=y[2],r[2]=y[4],r[3]=g,r[4]=y[3],r[5]=y[4],r[6]=g,r[7]=y[2],r[8]=y[5],r[9]=g,r[10]=y[3],r[11]=y[5]}else if(E===T.J){x=new b.constructor(e[2]*e[0]*c);let t=0;for(let n=0;n<e[2];n++)for(let r=0;r<e[0];r++){let i=(r+R*e[0]+n*e[0]*e[1])*c;t=(n*e[0]+r)*c;const o=i+c;for(;i<o;)x[t++]=b[i++]}e[1]=e[2],r[0]=y[0],r[1]=g,r[2]=y[4],r[3]=y[1],r[4]=g,r[5]=y[4],r[6]=y[0],r[7]=g,r[8]=y[5],r[9]=y[1],r[10]=g,r[11]=y[5]}else E===T.K||E===T.NONE?(x=b.subarray(R*n,(R+1)*n),r[0]=y[0],r[1]=y[2],r[2]=g,r[3]=y[1],r[4]=y[2],r[5]=g,r[6]=y[0],r[7]=y[3],r[8]=g,r[9]=y[1],r[10]=y[3],r[11]=g):C("Reformat slicing not yet supported.");const A=o.getRanges();t.openGLTexture.resetFormatAndType(),t.openGLTexture.create2DFilterableFromRaw(e[0],e[1],c,o.getDataType(),x,t.renderable.getPreferSizeOverAccuracy?.(),A),t.openGLTexture.activate(),t.openGLTexture.sendParameters(),t.openGLTexture.deactivate();const S=a.Ay.newInstance({numberOfComponents:3,values:r});S.setName("points");const w=a.Ay.newInstance({numberOfComponents:2,values:d});w.setName("tcoords");const _=new Uint16Array(8);_[0]=3,_[1]=0,_[2]=1,_[3]=3,_[4]=3,_[5]=0,_[6]=3,_[7]=2;const I=a.Ay.newInstance({numberOfComponents:1,values:_});t.tris.getCABO().createVBO(I,"polys",f.YL.SURFACE,{points:S,tcoords:w,cellOffset:0}),t.VBOBuildTime.modified(),t.VBOBuildString=N}},e.updatelabelOutlineThicknessTexture=n=>{const r=n.getProperty().getLabelOutlineThicknessByReference(),i=t._openGLRenderWindow.getGraphicsResourceForObject(r),o=`${r.join("-")}`;if(i?.oglObject?.getHandle()&&i?.hash===o)t.labelOutlineThicknessTexture=i.oglObject;else{const n=1024,i=1,a=new Uint8Array(n*i);for(let e=0;e<n;++e){const t=void 0!==r[e]?r[e]:r[0];a[e]=t}t.labelOutlineThicknessTexture=u.Ay.newInstance({resizable:!1}),t.labelOutlineThicknessTexture.setOpenGLRenderWindow(t._openGLRenderWindow),t.labelOutlineThicknessTexture.resetFormatAndType(),t.labelOutlineThicknessTexture.setMinificationFilter(h.dJ.NEAREST),t.labelOutlineThicknessTexture.setMagnificationFilter(h.dJ.NEAREST),t.labelOutlineThicknessTexture.create2DFromRaw(n,i,1,s.JA.UNSIGNED_CHAR,a),r&&(t._openGLRenderWindow.setGraphicsResourceForObject(r,t.labelOutlineThicknessTexture,o),r!==t._labelOutlineThicknessArray&&(t._openGLRenderWindow.registerGraphicsResourceUser(r,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._labelOutlineThicknessArray,e)),t._labelOutlineThicknessArray=r)}},e.getRenderTargetSize=()=>{if(t._useSmallViewport)return[t._smallViewportWidth,t._smallViewportHeight];const{usize:e,vsize:n}=t._openGLRenderer.getTiledSizeAndOrigin();return[e,n]},e.getRenderTargetOffset=()=>{const{lowerLeftU:e,lowerLeftV:n}=t._openGLRenderer.getTiledSizeAndOrigin();return[e,n]},e.delete=(0,o.h)((()=>{t._openGLRenderWindow&&n(t._openGLRenderWindow)}),e.delete)}(e,t)}const I=(0,o.n)(_,"vtkOpenGLImageMapper");var E={newInstance:I,extend:_};(0,x.c9)("vtkAbstractImageMapper",I)},64501:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(3823),i=n(28906),o=n(25196),a=n(88691);const s={context:null,keyMatrixTime:null,keyMatrices:null};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),o.A.extend(e,t,n),t.keyMatrixTime={},(0,i.o)(t.keyMatrixTime,{mtime:0}),t.keyMatrices={mcwc:r.pB.identity(new Float64Array(16))},(0,i.e)(e,t,["context"]),function(e,t){t.classHierarchy.push("vtkOpenGLImageSlice"),e.buildPass=n=>{if(t.renderable&&t.renderable.getVisibility()&&n){if(!t.renderable)return;t._openGLRenderWindow=e.getLastAncestorOfType("vtkOpenGLRenderWindow"),t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.context=t._openGLRenderWindow.getContext(),e.prepareNodes(),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes()}},e.traverseZBufferPass=n=>{t.renderable&&t.renderable.getNestedVisibility()&&(!t._openGLRenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.children.forEach((e=>{e.traverse(n)})),e.apply(n,!1))},e.traverseOpaqueZBufferPass=t=>e.traverseOpaquePass(t),e.traverseOpaquePass=n=>{t.renderable&&t.renderable.getNestedVisibility()&&t.renderable.getIsOpaque()&&(!t._openGLRenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.children.forEach((e=>{e.traverse(n)})),e.apply(n,!1))},e.traverseTranslucentPass=n=>{!t.renderable||!t.renderable.getNestedVisibility()||t.renderable.getIsOpaque()||t._openGLRenderer.getSelector()&&!t.renderable.getNestedPickable()||(e.apply(n,!0),t.children.forEach((e=>{e.traverse(n)})),e.apply(n,!1))},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;t.renderable.getIsOpaque()?n.incrementOpaqueActorCount():n.incrementTranslucentActorCount()}},e.zBufferPass=(t,n)=>e.opaquePass(t,n),e.opaqueZBufferPass=(t,n)=>e.opaquePass(t,n),e.opaquePass=(e,n)=>{e&&t.context.depthMask(!0)},e.translucentPass=(e,n)=>{t.context.depthMask(!e)},e.getKeyMatrices=()=>(t.renderable.getMTime()>t.keyMatrixTime.getMTime()&&(r.pB.copy(t.keyMatrices.mcwc,t.renderable.getMatrix()),r.pB.transpose(t.keyMatrices.mcwc,t.keyMatrices.mcwc),t.keyMatrixTime.modified()),t.keyMatrices)}(e,t)}const c=(0,i.n)(l,"vtkOpenGLImageSlice");var u={newInstance:c,extend:l};(0,a.c9)("vtkImageSlice",c)},68464:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(28906),i=n(25196),o=n(88691);const{vtkDebugMacro:a}=r.c;const s={};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),i.A.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkOpenGLPixelSpaceCallbackMapper"),e.opaquePass=(n,r)=>{t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t._openGLRenderWindow=t._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow");const i=t._openGLRenderer.getAspectRatio(),o=t._openGLRenderer?t._openGLRenderer.getRenderable().getActiveCamera():null,s=t._openGLRenderer.getTiledSizeAndOrigin();let l=null;if(t.renderable.getUseZValues()){const e=r.getZBufferTexture(),n=Math.floor(e.getWidth()),i=Math.floor(e.getHeight()),o=t._openGLRenderWindow.getContext();e.bind();const s=r.getFramebuffer();s?s.saveCurrentBindingsAndBuffers():a("No framebuffer to save/restore");const c=o.createFramebuffer();o.bindFramebuffer(o.FRAMEBUFFER,c),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e.getHandle(),0),o.checkFramebufferStatus(o.FRAMEBUFFER)===o.FRAMEBUFFER_COMPLETE&&(l=new Uint8Array(n*i*4),o.viewport(0,0,n,i),o.readPixels(0,0,n,i,o.RGBA,o.UNSIGNED_BYTE,l)),s&&s.restorePreviousBindingsAndBuffers(),o.deleteFramebuffer(c)}t.renderable.invokeCallback(t.renderable.getInputData(),o,i,s,l)},e.queryPass=(e,n)=>{e&&t.renderable.getUseZValues()&&n.requestDepth()}}(e,t)}const c=(0,r.n)(l,"vtkOpenGLPixelSpaceCallbackMapper");var u={newInstance:c,extend:l};(0,o.c9)("vtkPixelSpaceCallbackMapper",c)},62939:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>L});var r=n(3823),i=n(28906),o=n(71650),a=n(82409),s=n(16632),l=n(79525),c=n(46985),u=n(89585),d=n(18713),p=n(25196),f=n(84839),h=n(23159),m=n(83534),g=n(88691),v=n(57703),y=n(69147),b=(n(57285),n(7698));const{FieldAssociations:x}=y.Ay,{primTypes:A}=o.Ay,{Representation:C,Shading:T}=u.Ay,{ScalarMode:S}=a.Ay,{Filter:w,Wrap:_}=l.Ay,{vtkErrorMacro:I}=i.c,E={type:"StartEvent"},D={type:"EndEvent"},{CoordinateSystem:O}=c.Ay;function P(e,t){function n(e,t,n){return t.identity(n),e.reduce(((e,n,r)=>0===r?n?t.copy(e,n):t.identity(e):n?t.multiply(e,e,n):e),n)}t.classHierarchy.push("vtkOpenGLPolyDataMapper"),e.buildPass=n=>{n&&(t.currentRenderPass=null,t.openGLActor=e.getFirstAncestorOfType("vtkOpenGLActor"),t._openGLRenderer=t.openGLActor.getFirstAncestorOfType("vtkOpenGLRenderer"),t._openGLRenderWindow=t._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow"),t.openGLCamera=t._openGLRenderer.getViewNodeFor(t._openGLRenderer.getRenderable().getActiveCamera()))},e.translucentPass=(n,r)=>{n&&(t.currentRenderPass=r,e.render())},e.zBufferPass=n=>{n&&(t.haveSeenDepthRequest=!0,t.renderDepth=!0,e.render(),t.renderDepth=!1)},e.opaqueZBufferPass=t=>e.zBufferPass(t),e.opaquePass=t=>{t&&e.render()},e.render=()=>{const n=t._openGLRenderWindow.getContext();if(t.context!==n){t.context=n;for(let e=A.Start;e<A.End;e++)t.primitives[e].setOpenGLRenderWindow(t._openGLRenderWindow)}const r=t.openGLActor.getRenderable(),i=t._openGLRenderer.getRenderable();e.renderPiece(i,r)},e.getShaderTemplate=(e,t,n)=>{e.Vertex=f.v,e.Fragment=h.v,e.Geometry=""},e.replaceShaderColor=(e,n,r)=>{let i=e.Vertex,o=e.Geometry,a=e.Fragment;const s=t.lastBoundBO.getReferenceByName("lastLightComplexity");let l=["uniform float ambient;","uniform float diffuse;","uniform float specular;","uniform float opacityUniform; // the fragment opacity","uniform vec3 ambientColorUniform;","uniform vec3 diffuseColorUniform;"];s&&(l=l.concat(["uniform vec3 specularColorUniform;","uniform float specularPowerUniform;"]));let c=["vec3 ambientColor;","  vec3 diffuseColor;","  float opacity;"];s&&(c=c.concat(["  vec3 specularColor;","  float specularPower;"])),c=c.concat(["  ambientColor = ambientColorUniform;","  diffuseColor = diffuseColorUniform;","  opacity = opacityUniform;"]),s&&(c=c.concat(["  specularColor = specularColorUniform;","  specularPower = specularPowerUniform;"])),0===t.lastBoundBO.getCABO().getColorComponents()||t.drawingEdges||(l=l.concat(["varying vec4 vertexColorVSOutput;"]),i=d.A.substitute(i,"//VTK::Color::Dec",["attribute vec4 scalarColor;","varying vec4 vertexColorVSOutput;"]).result,i=d.A.substitute(i,"//VTK::Color::Impl",["vertexColorVSOutput =  scalarColor;"]).result,o=d.A.substitute(o,"//VTK::Color::Dec",["in vec4 vertexColorVSOutput[];","out vec4 vertexColorGSOutput;"]).result,o=d.A.substitute(o,"//VTK::Color::Impl",["vertexColorGSOutput = vertexColorVSOutput[i];"]).result),0===t.lastBoundBO.getCABO().getColorComponents()||t.drawingEdges?(t.renderable.getAreScalarsMappedFromCells()||t.renderable.getInterpolateScalarsBeforeMapping())&&t.renderable.getColorCoordinates()&&!t.drawingEdges?a=d.A.substitute(a,"//VTK::Color::Impl",c.concat(["  vec4 texColor = texture2D(texture1, tcoordVCVSOutput.st);","  diffuseColor = texColor.rgb;","  ambientColor = texColor.rgb;","  opacity = opacity*texColor.a;"])).result:(r.getBackfaceProperty()&&!t.drawingEdges&&(l=l.concat(["uniform float opacityUniformBF; // the fragment opacity","uniform float ambientIntensityBF; // the material ambient","uniform float diffuseIntensityBF; // the material diffuse","uniform vec3 ambientColorUniformBF; // ambient material color","uniform vec3 diffuseColorUniformBF; // diffuse material color"]),s?(l=l.concat(["uniform float specularIntensityBF; // the material specular intensity","uniform vec3 specularColorUniformBF; // intensity weighted color","uniform float specularPowerUniformBF;"]),c=c.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  specularColor = specularIntensityBF * specularColorUniformBF;","  specularPower = specularPowerUniformBF;","  opacity = opacityUniformBF; }"])):c=c.concat(["if (gl_FrontFacing == false) {","  ambientColor = ambientIntensityBF * ambientColorUniformBF;","  diffuseColor = diffuseIntensityBF * diffuseColorUniformBF;","  opacity = opacityUniformBF; }"])),t.haveCellScalars&&!t.drawingEdges&&(l=l.concat(["uniform samplerBuffer texture1;"])),a=d.A.substitute(a,"//VTK::Color::Impl",c).result):a=d.A.substitute(a,"//VTK::Color::Impl",c.concat(["  diffuseColor = vertexColorVSOutput.rgb;","  ambientColor = vertexColorVSOutput.rgb;","  opacity = opacity*vertexColorVSOutput.a;"])).result,a=d.A.substitute(a,"//VTK::Color::Dec",l).result,e.Vertex=i,e.Geometry=o,e.Fragment=a},e.replaceShaderLight=(e,n,r)=>{let i=e.Fragment;const o=t.lastBoundBO.getReferenceByName("lastLightComplexity"),a=t.lastBoundBO.getReferenceByName("lastLightCount");let s=[];switch(o){case 0:i=d.A.substitute(i,"//VTK::Light::Impl",["  gl_FragData[0] = vec4(ambientColor * ambient + diffuseColor * diffuse, opacity);","  //VTK::Light::Impl"],!1).result;break;case 1:i=d.A.substitute(i,"//VTK::Light::Impl",["  float df = max(0.0, normalVCVSOutput.z);","  float sf = pow(df, specularPower);","  vec3 diffuseL = df * diffuseColor;","  vec3 specularL = sf * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"],!1).result;break;case 2:for(let e=0;e<a;++e)s=s.concat([`uniform vec3 lightColor${e};`,`uniform vec3 lightDirectionVC${e}; // normalized`,`uniform vec3 lightHalfAngleVC${e}; // normalized`]);i=d.A.substitute(i,"//VTK::Light::Dec",s).result,s=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  float df;"];for(let e=0;e<a;++e)s=s.concat([`  df = max(0.0, dot(normalVCVSOutput, -lightDirectionVC${e}));`,`  diffuseL += ((df) * lightColor${e});`,`  if (dot(normalVCVSOutput, lightDirectionVC${e}) < 0.0)`,"    {",`    float sf = sign(df)*pow(max(1e-5,\n                                              dot(reflect(lightDirectionVC${e},normalVCVSOutput),\n                                                  normalize(-vertexVC.xyz))),\n                                         specularPower);`,`    specularL += (sf * lightColor${e});`,"    }"]);s=s.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),i=d.A.substitute(i,"//VTK::Light::Impl",s,!1).result;break;case 3:for(let e=0;e<a;++e)s=s.concat([`uniform vec3 lightColor${e};`,`uniform vec3 lightDirectionVC${e}; // normalized`,`uniform vec3 lightHalfAngleVC${e}; // normalized`,`uniform vec3 lightPositionVC${e};`,`uniform vec3 lightAttenuation${e};`,`uniform float lightConeAngle${e};`,`uniform float lightExponent${e};`,`uniform int lightPositional${e};`]);i=d.A.substitute(i,"//VTK::Light::Dec",s).result,s=["vec3 diffuseL = vec3(0,0,0);","  vec3 specularL = vec3(0,0,0);","  vec3 vertLightDirectionVC;","  float attenuation;","  float df;"];for(let e=0;e<a;++e)s=s.concat(["  attenuation = 1.0;",`  if (lightPositional${e} == 0)`,"    {",`      vertLightDirectionVC = lightDirectionVC${e};`,"    }","  else","    {",`    vertLightDirectionVC = vertexVC.xyz - lightPositionVC${e};`,"    float distanceVC = length(vertLightDirectionVC);","    vertLightDirectionVC = normalize(vertLightDirectionVC);","    attenuation = 1.0 /",`      (lightAttenuation${e}.x`,`       + lightAttenuation${e}.y * distanceVC`,`       + lightAttenuation${e}.z * distanceVC * distanceVC);`,"    // per OpenGL standard cone angle is 90 or less for a spot light",`    if (lightConeAngle${e} <= 90.0)`,"      {",`      float coneDot = dot(vertLightDirectionVC, lightDirectionVC${e});`,"      // if inside the cone",`      if (coneDot >= cos(radians(lightConeAngle${e})))`,"        {",`        attenuation = attenuation * pow(coneDot, lightExponent${e});`,"        }","      else","        {","        attenuation = 0.0;","        }","      }","    }","    df = max(0.0, attenuation*dot(normalVCVSOutput, -vertLightDirectionVC));",`    diffuseL += ((df) * lightColor${e});`,"    if (dot(normalVCVSOutput, vertLightDirectionVC) < 0.0)","      {",`      float sf = sign(df)*attenuation*pow(max(1e-5,\n                                                           dot(reflect(lightDirectionVC${e},\n                                                                       normalVCVSOutput),\n                                                               normalize(-vertexVC.xyz))),\n                                                       specularPower);`,`    specularL += ((sf) * lightColor${e});`,"    }"]);s=s.concat(["  diffuseL = diffuseL * diffuseColor;","  specularL = specularL * specularColor;","  gl_FragData[0] = vec4(ambientColor * ambient + diffuseL * diffuse + specularL * specular, opacity);","  //VTK::Light::Impl"]),i=d.A.substitute(i,"//VTK::Light::Impl",s,!1).result;break;default:I("bad light complexity")}e.Fragment=i},e.replaceShaderNormal=(e,n,r)=>{if(t.lastBoundBO.getReferenceByName("lastLightComplexity")>0){let n=e.Vertex,i=e.Geometry,o=e.Fragment;t.lastBoundBO.getCABO().getNormalOffset()?(n=d.A.substitute(n,"//VTK::Normal::Dec",["attribute vec3 normalMC;","uniform mat3 normalMatrix;","varying vec3 normalVCVSOutput;"]).result,n=d.A.substitute(n,"//VTK::Normal::Impl",["normalVCVSOutput = normalMatrix * normalMC;"]).result,i=d.A.substitute(i,"//VTK::Normal::Dec",["in vec3 normalVCVSOutput[];","out vec3 normalVCGSOutput;"]).result,i=d.A.substitute(i,"//VTK::Normal::Impl",["normalVCGSOutput = normalVCVSOutput[i];"]).result,o=d.A.substitute(o,"//VTK::Normal::Dec",["varying vec3 normalVCVSOutput;"]).result,o=d.A.substitute(o,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalVCVSOutput);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):t.haveCellNormals?(o=d.A.substitute(o,"//VTK::Normal::Dec",["uniform mat3 normalMatrix;","uniform samplerBuffer textureN;"]).result,o=d.A.substitute(o,"//VTK::Normal::Impl",["vec3 normalVCVSOutput = normalize(normalMatrix *","    texelFetchBuffer(textureN, gl_PrimitiveID + PrimitiveIDOffset).xyz);","  if (gl_FrontFacing == false) { normalVCVSOutput = -normalVCVSOutput; }"]).result):t.lastBoundBO.getOpenGLMode(r.getProperty().getRepresentation())===t.context.LINES?(o=d.A.substitute(o,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,o=d.A.substitute(o,"//VTK::Normal::Impl",["vec3 normalVCVSOutput;","  if (abs(fdx.x) > 0.0)","    { fdx = normalize(fdx); normalVCVSOutput = normalize(cross(vec3(fdx.y, -fdx.x, 0.0), fdx)); }","  else { fdy = normalize(fdy); normalVCVSOutput = normalize(cross(vec3(fdy.y, -fdy.x, 0.0), fdy));}"]).result):(o=d.A.substitute(o,"//VTK::Normal::Dec",["uniform int cameraParallel;"]).result,o=d.A.substitute(o,"//VTK::UniformFlow::Impl",["  vec3 fdx = dFdx(vertexVC.xyz);","  vec3 fdy = dFdy(vertexVC.xyz);","  //VTK::UniformFlow::Impl"]).result,o=d.A.substitute(o,"//VTK::Normal::Impl",["  fdx = normalize(fdx);","  fdy = normalize(fdy);","  vec3 normalVCVSOutput = normalize(cross(fdx,fdy));","  if (cameraParallel == 1 && normalVCVSOutput.z < 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }","  if (cameraParallel == 0 && dot(normalVCVSOutput,vertexVC.xyz) > 0.0) { normalVCVSOutput = -1.0*normalVCVSOutput; }"]).result),e.Vertex=n,e.Geometry=i,e.Fragment=o}},e.replaceShaderPositionVC=(e,n,r)=>{t.lastBoundBO.replaceShaderPositionVC(e,n,r);let i=e.Vertex,o=e.Geometry,a=e.Fragment;t.lastBoundBO.getReferenceByName("lastLightComplexity")>0?(i=d.A.substitute(i,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,i=d.A.substitute(i,"//VTK::PositionVC::Impl",["vertexVCVSOutput = MCVCMatrix * vertexMC;","  gl_Position = MCPCMatrix * vertexMC;"]).result,i=d.A.substitute(i,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;","uniform mat4 MCVCMatrix;"]).result,o=d.A.substitute(o,"//VTK::PositionVC::Dec",["in vec4 vertexVCVSOutput[];","out vec4 vertexVCGSOutput;"]).result,o=d.A.substitute(o,"//VTK::PositionVC::Impl",["vertexVCGSOutput = vertexVCVSOutput[i];"]).result,a=d.A.substitute(a,"//VTK::PositionVC::Dec",["varying vec4 vertexVCVSOutput;"]).result,a=d.A.substitute(a,"//VTK::PositionVC::Impl",["vec4 vertexVC = vertexVCVSOutput;"]).result):(i=d.A.substitute(i,"//VTK::Camera::Dec",["uniform mat4 MCPCMatrix;"]).result,i=d.A.substitute(i,"//VTK::PositionVC::Impl",["  gl_Position = MCPCMatrix * vertexMC;"]).result),e.Vertex=i,e.Geometry=o,e.Fragment=a},e.replaceShaderTCoord=(e,n,r)=>{if(t.lastBoundBO.getCABO().getTCoordOffset()){let n=e.Vertex,r=e.Geometry,i=e.Fragment;if(t.drawingEdges)return;n=d.A.substitute(n,"//VTK::TCoord::Impl","tcoordVCVSOutput = tcoordMC;").result;const o=t.openGLActor.getActiveTextures();let a=2,s=2;if(o&&o.length>0&&(a=o[0].getComponents(),o[0].getTarget()===t.context.TEXTURE_CUBE_MAP&&(s=3)),t.renderable.getColorTextureMap()&&(a=t.renderable.getColorTextureMap().getPointData().getScalars().getNumberOfComponents(),s=2),2===s){if(n=d.A.substitute(n,"//VTK::TCoord::Dec","attribute vec2 tcoordMC; varying vec2 tcoordVCVSOutput;").result,r=d.A.substitute(r,"//VTK::TCoord::Dec",["in vec2 tcoordVCVSOutput[];","out vec2 tcoordVCGSOutput;"]).result,r=d.A.substitute(r,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,i=d.A.substitute(i,"//VTK::TCoord::Dec",["varying vec2 tcoordVCVSOutput;","uniform sampler2D texture1;"]).result,o&&o.length>=1)switch(a){case 1:i=d.A.substitute(i,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:i=d.A.substitute(i,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:i=d.A.substitute(i,"//VTK::TCoord::Impl",["  vec4 tcolor = texture2D(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}}else switch(n=d.A.substitute(n,"//VTK::TCoord::Dec","attribute vec3 tcoordMC; varying vec3 tcoordVCVSOutput;").result,r=d.A.substitute(r,"//VTK::TCoord::Dec",["in vec3 tcoordVCVSOutput[];","out vec3 tcoordVCGSOutput;"]).result,r=d.A.substitute(r,"//VTK::TCoord::Impl","tcoordVCGSOutput = tcoordVCVSOutput[i];").result,i=d.A.substitute(i,"//VTK::TCoord::Dec",["varying vec3 tcoordVCVSOutput;","uniform samplerCube texture1;"]).result,a){case 1:i=d.A.substitute(i,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;"]).result;break;case 2:i=d.A.substitute(i,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.r;","  diffuseColor = diffuseColor*tcolor.r;","  opacity = opacity * tcolor.g;"]).result;break;default:i=d.A.substitute(i,"//VTK::TCoord::Impl",["  vec4 tcolor = textureCube(texture1, tcoordVCVSOutput);","  ambientColor = ambientColor*tcolor.rgb;","  diffuseColor = diffuseColor*tcolor.rgb;","  opacity = opacity * tcolor.a;"]).result}e.Vertex=n,e.Geometry=r,e.Fragment=i}},e.replaceShaderClip=(e,n,r)=>{let i=e.Vertex,o=e.Fragment;if(t.renderable.getNumberOfClippingPlanes()){const e=t.renderable.getNumberOfClippingPlanes();i=d.A.substitute(i,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`uniform vec4 clipPlanes[${e}];`,`varying float clipDistancesVSOutput[${e}];`]).result,i=d.A.substitute(i,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${e}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    clipDistancesVSOutput[planeNum] = dot(clipPlanes[planeNum], vertexMC);","    }"]).result,o=d.A.substitute(o,"//VTK::Clip::Dec",["uniform int numClipPlanes;",`varying float clipDistancesVSOutput[${e}];`]).result,o=d.A.substitute(o,"//VTK::Clip::Impl",[`for (int planeNum = 0; planeNum < ${e}; planeNum++)`,"    {","    if (planeNum >= numClipPlanes)","        {","        break;","        }","    if (clipDistancesVSOutput[planeNum] < 0.0) discard;","    }"]).result}e.Vertex=i,e.Fragment=o},e.getCoincidentParameters=(e,n)=>{let r={factor:0,offset:0};const i=n.getProperty();if(t.renderable.getResolveCoincidentTopology()==b.XK.PolygonOffset||i.getEdgeVisibility()&&i.getRepresentation()===C.SURFACE){const e=t.lastBoundBO.getPrimitiveType();e===A.Points||i.getRepresentation()===C.POINTS?r=t.renderable.getCoincidentTopologyPointOffsetParameter():e===A.Lines||i.getRepresentation()===C.WIREFRAME?r=t.renderable.getCoincidentTopologyLineOffsetParameters():e!==A.Tris&&e!==A.TriStrips||(r=t.renderable.getCoincidentTopologyPolygonOffsetParameters()),e!==A.TrisEdges&&e!==A.TriStripsEdges||(r=t.renderable.getCoincidentTopologyPolygonOffsetParameters(),r.factor/=2,r.offset/=2)}const o=t._openGLRenderer.getSelector();return o&&o.getFieldAssociation()===x.FIELD_ASSOCIATION_POINTS&&(r.offset-=2),r},e.replaceShaderPicking=(e,n,r)=>{let i=e.Fragment,o=e.Vertex;if(i=d.A.substitute(i,"//VTK::Picking::Dec",["uniform int picking;","//VTK::Picking::Dec"]).result,t._openGLRenderer.getSelector()){switch(t.lastSelectionState!==v.T.ID_LOW24&&t.lastSelectionState!==v.T.ID_HIGH24||(o=d.A.substitute(o,"//VTK::Picking::Dec",["flat out int vertexIDVSOutput;\n","uniform int VertexIDOffset;\n"]).result,o=d.A.substitute(o,"//VTK::Picking::Impl","  vertexIDVSOutput = gl_VertexID + VertexIDOffset;\n").result,i=d.A.substitute(i,"//VTK::Picking::Dec","flat in int vertexIDVSOutput;\n").result,i=d.A.substitute(i,"//VTK::Picking::Impl",["  int idx = vertexIDVSOutput;","//VTK::Picking::Impl"]).result),t.lastSelectionState){case v.T.ID_LOW24:i=d.A.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float(idx%256)/255.0, float((idx/256)%256)/255.0, float((idx/65536)%256)/255.0, 1.0);").result;break;case v.T.ID_HIGH24:i=d.A.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = vec4(float((idx/16777216)%256)/255.0, 0.0, 0.0, 1.0);").result;break;default:i=d.A.substitute(i,"//VTK::Picking::Dec","uniform vec3 mapperIndex;").result,i=d.A.substitute(i,"//VTK::Picking::Impl","  gl_FragData[0] = picking != 0 ? vec4(mapperIndex,1.0) : gl_FragData[0];").result}e.Fragment=i,e.Vertex=o}},e.replaceShaderValues=(n,r,i)=>{if(e.replaceShaderColor(n,r,i),e.replaceShaderNormal(n,r,i),e.replaceShaderLight(n,r,i),e.replaceShaderTCoord(n,r,i),e.replaceShaderPicking(n,r,i),e.replaceShaderClip(n,r,i),e.replaceShaderCoincidentOffset(n,r,i),e.replaceShaderPositionVC(n,r,i),t.haveSeenDepthRequest){let e=n.Fragment;e=d.A.substitute(e,"//VTK::ZBuffer::Dec","uniform int depthRequest;").result,e=d.A.substitute(e,"//VTK::ZBuffer::Impl",["if (depthRequest == 1) {","float iz = floor(gl_FragCoord.z*65535.0 + 0.1);","float rf = floor(iz/256.0)/255.0;","float gf = mod(iz,256.0)/255.0;","gl_FragData[0] = vec4(rf, gf, 0.0, 1.0); }"]).result,n.Fragment=e}},e.getNeedToRebuildShaders=(e,n,r)=>{let i=0,o=0;const a=e.getPrimitiveType(),s=t.currentInput;let l=!1;const c=s.getPointData().getNormals(),u=s.getCellData().getNormals(),d=r.getProperty().getInterpolation()===T.FLAT,p=r.getProperty().getRepresentation(),f=e.getOpenGLMode(p,a);if(f===t.context.TRIANGLES||u&&!c||!d&&c?l=!0:d||f!==t.context.LINES||(l=!0),r.getProperty().getLighting()&&l){i=0;const e=n.getLightsByReference();for(let t=0;t<e.length;++t){const n=e[t];n.getSwitch()>0&&(o++,0===i&&(i=1)),1===i&&(o>1||1!==n.getIntensity()||!n.lightTypeIsHeadLight())&&(i=2),i<3&&n.getPositional()&&(i=3)}}let h=!1;const m=t.lastBoundBO.getReferenceByName("lastLightComplexity"),g=t.lastBoundBO.getReferenceByName("lastLightCount");return m===i&&g===o||(t.lastBoundBO.set({lastLightComplexity:i},!0),t.lastBoundBO.set({lastLightCount:o},!0),h=!0),(!t.currentRenderPass&&t.lastRenderPassShaderReplacement||t.currentRenderPass&&t.currentRenderPass.getShaderReplacement()!==t.lastRenderPassShaderReplacement)&&(h=!0),!!(t.lastHaveSeenDepthRequest!==t.haveSeenDepthRequest||e.getShaderSourceTime().getMTime()<t.renderable.getMTime()||e.getShaderSourceTime().getMTime()<t.currentInput.getMTime()||e.getShaderSourceTime().getMTime()<t.selectionStateChanged.getMTime()||h)&&(t.lastHaveSeenDepthRequest=t.haveSeenDepthRequest,!0)},e.invokeShaderCallbacks=(e,n,r)=>{const i=t.renderable.getViewSpecificProperties().ShadersCallbacks;i&&i.forEach((t=>{t.callback(t.userData,e,n,r)}))},e.setMapperShaderParameters=(n,i,o)=>{if(n.getProgram().isUniformUsed("PrimitiveIDOffset")&&n.getProgram().setUniformi("PrimitiveIDOffset",t.primitiveIDOffset),n.getProgram().isUniformUsed("VertexIDOffset")&&n.getProgram().setUniformi("VertexIDOffset",t.vertexIDOffset),n.getCABO().getElementCount()&&(t.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())){const e=t.lastBoundBO.getReferenceByName("lastLightComplexity");n.getProgram().isAttributeUsed("vertexMC")&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"vertexMC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),t.context.FLOAT,3,!1)||I("Error setting vertexMC in shader VAO.")),n.getProgram().isAttributeUsed("normalMC")&&n.getCABO().getNormalOffset()&&e>0?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"normalMC",n.getCABO().getNormalOffset(),n.getCABO().getStride(),t.context.FLOAT,3,!1)||I("Error setting normalMC in shader VAO."):n.getVAO().removeAttributeArray("normalMC"),t.renderable.getCustomShaderAttributes().forEach(((e,r)=>{n.getProgram().isAttributeUsed(`${e}MC`)&&(n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),`${e}MC`,n.getCABO().getCustomData()[r].offset,n.getCABO().getStride(),t.context.FLOAT,n.getCABO().getCustomData()[r].components,!1)||I(`Error setting ${e}MC in shader VAO.`))})),n.getProgram().isAttributeUsed("tcoordMC")&&n.getCABO().getTCoordOffset()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO(),"tcoordMC",n.getCABO().getTCoordOffset(),n.getCABO().getStride(),t.context.FLOAT,n.getCABO().getTCoordComponents(),!1)||I("Error setting tcoordMC in shader VAO."):n.getVAO().removeAttributeArray("tcoordMC"),n.getProgram().isAttributeUsed("scalarColor")&&n.getCABO().getColorComponents()?n.getVAO().addAttributeArray(n.getProgram(),n.getCABO().getColorBO(),"scalarColor",n.getCABO().getColorOffset(),n.getCABO().getColorBOStride(),t.context.UNSIGNED_BYTE,4,!0)||I("Error setting scalarColor in shader VAO."):n.getVAO().removeAttributeArray("scalarColor"),n.getAttributeUpdateTime().modified()}if(t.renderable.getNumberOfClippingPlanes()){const e=t.renderable.getNumberOfClippingPlanes(),i=[],a=n.getCABO().getCoordShiftAndScaleEnabled()?n.getCABO().getInverseShiftAndScaleMatrix():null,s=a?r.pB.copy(t.tmpMat4,o.getMatrix()):o.getMatrix();a&&(r.pB.transpose(s,s),r.pB.multiply(s,s,a),r.pB.transpose(s,s));for(let n=0;n<e;n++){const e=[];t.renderable.getClippingPlaneInDataCoords(s,n,e);for(let t=0;t<4;t++)i.push(e[t])}n.getProgram().setUniformi("numClipPlanes",e),n.getProgram().setUniform4fv("clipPlanes",i)}t.internalColorTexture&&n.getProgram().isUniformUsed("texture1")&&n.getProgram().setUniformi("texture1",t.internalColorTexture.getTextureUnit());const a=t.openGLActor.getActiveTextures();if(a)for(let e=0;e<a.length;++e){const t=a[e].getTextureUnit(),r=`texture${t+1}`;n.getProgram().isUniformUsed(r)&&n.getProgram().setUniformi(r,t)}if(t.haveSeenDepthRequest&&n.getProgram().setUniformi("depthRequest",t.renderDepth?1:0),n.getProgram().isUniformUsed("coffset")){const t=e.getCoincidentParameters(i,o);n.getProgram().setUniformf("coffset",t.offset),n.getProgram().isUniformUsed("cfactor")&&n.getProgram().setUniformf("cfactor",t.factor)}n.setMapperShaderParameters(i,o,t._openGLRenderer.getTiledSizeAndOrigin());const s=t._openGLRenderer.getSelector();n.getProgram().setUniform3fArray("mapperIndex",s?s.getPropColorValue():[0,0,0]),n.getProgram().setUniformi("picking",s?s.getCurrentPass()+1:0)},e.setLightingShaderParameters=(e,n,i)=>{const o=t.lastBoundBO.getReferenceByName("lastLightComplexity");if(o<2)return;const a=e.getProgram();let l=0;const c=n.getLightsByReference();for(let e=0;e<c.length;++e){const r=c[e];if(r.getSwitch()>0){const e=r.getColorByReference(),i=r.getIntensity();t.lightColor[0]=e[0]*i,t.lightColor[1]=e[1]*i,t.lightColor[2]=e[2]*i;const o=r.getDirection(),c=n.getActiveCamera().getViewMatrix(),u=[...o];r.lightTypeIsSceneLight()&&(u[0]=c[0]*o[0]+c[1]*o[1]+c[2]*o[2],u[1]=c[4]*o[0]+c[5]*o[1]+c[6]*o[2],u[2]=c[8]*o[0]+c[9]*o[1]+c[10]*o[2],(0,s.l)(u)),t.lightDirection[0]=u[0],t.lightDirection[1]=u[1],t.lightDirection[2]=u[2],(0,s.l)(t.lightDirection),a.setUniform3fArray(`lightColor${l}`,t.lightColor),a.setUniform3fArray(`lightDirectionVC${l}`,t.lightDirection),l++}}if(o<3)return;const u=n.getActiveCamera().getViewMatrix();r.pB.transpose(u,u),l=0;for(let e=0;e<c.length;++e){const t=c[e];if(t.getSwitch()>0){const e=t.getTransformedPosition(),n=new Float64Array(3);r.eR.transformMat4(n,e,u),a.setUniform3fArray(`lightAttenuation${l}`,t.getAttenuationValuesByReference()),a.setUniformi(`lightPositional${l}`,t.getPositional()),a.setUniformf(`lightExponent${l}`,t.getExponent()),a.setUniformf(`lightConeAngle${l}`,t.getConeAngle()),a.setUniform3fArray(`lightPositionVC${l}`,[n[0],n[1],n[2]]),l++}}},e.setCameraShaderParameters=(e,i,o)=>{const a=e.getProgram(),s=t.openGLCamera.getKeyMatrices(i),l=i.getActiveCamera(),c=t.openGLCamera.getKeyMatrixTime().getMTime(),u=a.getLastCameraMTime(),d=e.getCABO().getCoordShiftAndScaleEnabled()?e.getCABO().getInverseShiftAndScaleMatrix():null,p=o.getIsIdentity(),f=p?{mcwc:null,normalMatrix:null}:t.openGLActor.getKeyMatrices();if(o.getCoordinateSystem()===O.DISPLAY){const e=t._openGLRenderer.getTiledSizeAndOrigin();r.pB.identity(t.tmpMat4),t.tmpMat4[0]=2/e.usize,t.tmpMat4[12]=-1,t.tmpMat4[5]=2/e.vsize,t.tmpMat4[13]=-1,r.pB.multiply(t.tmpMat4,t.tmpMat4,d),a.setUniformMatrix("MCPCMatrix",t.tmpMat4)}else a.setUniformMatrix("MCPCMatrix",n([s.wcpc,f.mcwc,d],r.pB,t.tmpMat4));a.isUniformUsed("MCVCMatrix")&&a.setUniformMatrix("MCVCMatrix",n([s.wcvc,f.mcwc,d],r.pB,t.tmpMat4)),a.isUniformUsed("normalMatrix")&&a.setUniformMatrix3x3("normalMatrix",n([s.normalMatrix,f.normalMatrix],r.w0,t.tmpMat3)),u!==c&&(a.isUniformUsed("cameraParallel")&&a.setUniformi("cameraParallel",l.getParallelProjection()),a.setLastCameraMTime(c)),p||a.setLastCameraMTime(0)},e.setPropertyShaderParameters=(e,n,r)=>{const i=e.getProgram();let o=r.getProperty(),a=o.getOpacity(),s=t.drawingEdges?o.getEdgeColorByReference():o.getAmbientColorByReference(),l=t.drawingEdges?o.getEdgeColorByReference():o.getDiffuseColorByReference(),c=t.drawingEdges?1:o.getAmbient(),u=t.drawingEdges?0:o.getDiffuse(),d=t.drawingEdges?0:o.getSpecular();const p=o.getSpecularPower();i.setUniformf("opacityUniform",a),i.setUniform3fArray("ambientColorUniform",s),i.setUniform3fArray("diffuseColorUniform",l),i.setUniformf("ambient",c),i.setUniformf("diffuse",u);const f=t.lastBoundBO.getReferenceByName("lastLightComplexity");if(f<1)return;let h=o.getSpecularColorByReference();if(i.setUniform3fArray("specularColorUniform",h),i.setUniformf("specularPowerUniform",p),i.setUniformf("specular",d),i.isUniformUsed("ambientIntensityBF")){if(o=r.getBackfaceProperty(),a=o.getOpacity(),s=o.getAmbientColor(),c=o.getAmbient(),l=o.getDiffuseColor(),u=o.getDiffuse(),h=o.getSpecularColor(),d=o.getSpecular(),i.setUniformf("ambientIntensityBF",c),i.setUniformf("diffuseIntensityBF",u),i.setUniformf("opacityUniformBF",a),i.setUniform3fArray("ambientColorUniformBF",s),i.setUniform3fArray("diffuseColorUniformBF",l),f<1)return;i.setUniformf("specularIntensityBF",d),i.setUniform3fArray("specularColorUniformBF",h),i.setUniformf("specularPowerUniformBF",p)}},e.updateMaximumPointCellIds=(e,n)=>{const r=t._openGLRenderer.getSelector();if(!r)return;if(t.selectionWebGLIdsToVTKIds?.points?.length){const e=t.selectionWebGLIdsToVTKIds.points.length;r.setMaximumPointId(e-1)}if(t.selectionWebGLIdsToVTKIds?.cells?.length){const e=t.selectionWebGLIdsToVTKIds.cells.length;r.setMaximumCellId(e-1)}r.getFieldAssociation()===x.FIELD_ASSOCIATION_POINTS&&(t.pointPicking=!0)},e.renderPieceStart=(n,r)=>{t.primitiveIDOffset=0,t.vertexIDOffset=0;const i=function(e){const t=e.getSelector();return t?t.getCurrentPass():v.T.MIN_KNOWN_PASS-1}(t._openGLRenderer);t.lastSelectionState!==i&&(t.selectionStateChanged.modified(),t.lastSelectionState=i),t._openGLRenderer.getSelector()&&t._openGLRenderer.getSelector().renderProp(r),e.updateBufferObjects(n,r),t.renderable.getColorTextureMap()&&t.internalColorTexture.activate(),t.lastBoundBO=null},e.renderPieceDraw=(n,r)=>{const i=r.getProperty().getRepresentation(),o=r.getProperty().getEdgeVisibility()&&i===C.SURFACE,a=t._openGLRenderer.getSelector(),s=a&&a.getFieldAssociation()===x.FIELD_ASSOCIATION_POINTS&&(t.lastSelectionState===v.T.ID_LOW24||t.lastSelectionState===v.T.ID_HIGH24);for(let a=A.Start;a<A.End;a++){t.primitives[a].setPointPicking(s);t.primitives[a].getCABO().getElementCount()&&(t.drawingEdges=o&&(a===A.TrisEdges||a===A.TriStripsEdges),t.drawingEdges&&(t.renderDepth||t.lastSelectionState>=0)||(t.lastBoundBO=t.primitives[a],t.primitiveIDOffset+=t.primitives[a].drawArrays(n,r,i,e),t.vertexIDOffset+=t.primitives[a].getCABO().getElementCount()))}},e.renderPieceFinish=(e,n)=>{t.LastBoundBO&&t.LastBoundBO.getVAO().release(),t.renderable.getColorTextureMap()&&t.internalColorTexture.deactivate()},e.renderPiece=(n,r)=>{if(e.invokeEvent(E),t.renderable.getStatic()||t.renderable.update(),t.currentInput=t.renderable.getInputData(),e.invokeEvent(D),!t.currentInput)return void I("No input!");if(!t.currentInput.getPoints||!t.currentInput.getPoints().getNumberOfValues())return;const i=t.context,o=r.getProperty().getBackfaceCulling(),a=r.getProperty().getFrontfaceCulling();o||a?a?(t._openGLRenderWindow.enableCullFace(),i.cullFace(i.FRONT)):(t._openGLRenderWindow.enableCullFace(),i.cullFace(i.BACK)):t._openGLRenderWindow.disableCullFace(),e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)},e.computeBounds=(n,r)=>{e.getInput()?t.bounds=e.getInput().getBounds():(0,s.u)(t.bounds)},e.updateBufferObjects=(t,n)=>{e.getNeedToRebuildBufferObjects(t,n)&&e.buildBufferObjects(t,n),e.updateMaximumPointCellIds()},e.getNeedToRebuildBufferObjects=(n,r)=>{const i=t.VBOBuildTime.getMTime();return i<e.getMTime()||i<t.renderable.getMTime()||i<r.getMTime()||i<t.currentInput.getMTime()},e.buildBufferObjects=(e,n)=>{const r=t.currentInput;if(null===r)return;t.renderable.mapScalars(r,1);const i=t.renderable.getColorMapColors();t.haveCellScalars=!1;const o=t.renderable.getScalarMode();t.renderable.getScalarVisibility()&&(o!==S.USE_CELL_DATA&&o!==S.USE_CELL_FIELD_DATA&&o!==S.USE_FIELD_DATA&&r.getPointData().getScalars()||o===S.USE_POINT_FIELD_DATA||!i||(t.haveCellScalars=!0));let a=n.getProperty().getInterpolation()!==T.FLAT?r.getPointData().getNormals():null;null===a&&r.getCellData().getNormals()&&(t.haveCellNormals=!0,a=r.getCellData().getNormals());const s=n.getProperty().getRepresentation();let c=r.getPointData().getTCoords();t.openGLActor.getActiveTextures()||(c=null);let u=!1;if(t.renderable.getColorCoordinates()){c=t.renderable.getColorCoordinates(),u=t.renderable.getAreScalarsMappedFromCells(),t.internalColorTexture||(t.internalColorTexture=l.Ay.newInstance({resizable:!0}));const e=t.internalColorTexture;e.setMinificationFilter(w.NEAREST),e.setMagnificationFilter(w.NEAREST),e.setWrapS(_.CLAMP_TO_EDGE),e.setWrapT(_.CLAMP_TO_EDGE),e.setOpenGLRenderWindow(t._openGLRenderWindow);const n=t.renderable.getColorTextureMap(),r=n.getExtent(),i=n.getPointData().getScalars();e.create2DFromRaw(r[1]-r[0]+1,r[3]-r[2]+1,i.getNumberOfComponents(),i.getDataType(),i.getData()),e.activate(),e.sendParameters(),e.deactivate()}const d=`${r.getMTime()}A${s}B${r.getMTime()}C${a?a.getMTime():1}D${i?i.getMTime():1}E${n.getProperty().getEdgeVisibility()}F${c?c.getMTime():1}`;if(t.VBOBuildString!==d){const e={points:r.getPoints(),normals:a,tcoords:c,colors:i,cellOffset:0,vertexOffset:0,useTCoordsPerCell:u,haveCellScalars:t.haveCellScalars,haveCellNormals:t.haveCellNormals,customAttributes:t.renderable.getCustomShaderAttributes().map((e=>r.getPointData().getArrayByName(e)))};t.renderable.getPopulateSelectionSettings()&&(t.selectionWebGLIdsToVTKIds={points:null,cells:null});const o=[{inRep:"verts",cells:r.getVerts()},{inRep:"lines",cells:r.getLines()},{inRep:"polys",cells:r.getPolys()},{inRep:"strips",cells:r.getStrips()},{inRep:"polys",cells:r.getPolys()},{inRep:"strips",cells:r.getStrips()}],l=n.getProperty().getEdgeVisibility()&&s===C.SURFACE;for(let n=A.Start;n<A.End;n++)n!==A.TrisEdges&&n!==A.TriStripsEdges?(e.cellOffset+=t.primitives[n].getCABO().createVBO(o[n].cells,o[n].inRep,s,e,t.selectionWebGLIdsToVTKIds),e.vertexOffset+=t.primitives[n].getCABO().getElementCount()):l?t.primitives[n].getCABO().createVBO(o[n].cells,o[n].inRep,C.WIREFRAME,{...e,tcoords:null,colors:null,haveCellScalars:!1,haveCellNormals:!1}):t.primitives[n].releaseGraphicsResources();t.renderable.getPopulateSelectionSettings()&&t.renderable.setSelectionWebGLIdsToVTKIds(t.selectionWebGLIdsToVTKIds),t.VBOBuildString=d}t.VBOBuildTime.modified()},e.getAllocatedGPUMemoryInBytes=()=>{let e=0;return t.primitives.forEach((t=>{e+=t.getAllocatedGPUMemoryInBytes()})),e}}const R={context:null,VBOBuildTime:0,VBOBuildString:null,primitives:null,primTypes:null,shaderRebuildString:null,tmpMat4:null,ambientColor:[],diffuseColor:[],specularColor:[],lightColor:[],lightDirection:[],lastHaveSeenDepthRequest:!1,haveSeenDepthRequest:!1,lastSelectionState:v.T.MIN_KNOWN_PASS-1,selectionStateChanged:null,selectionWebGLIdsToVTKIds:null,pointPicking:!1};function N(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,R,n),p.A.extend(e,t,n),m.A.implementReplaceShaderCoincidentOffset(e,t,n),m.A.implementBuildShadersWithReplacements(e,t,n),t.primitives=[],t.primTypes=A,t.tmpMat3=r.w0.identity(new Float64Array(9)),t.tmpMat4=r.pB.identity(new Float64Array(16));for(let e=A.Start;e<A.End;e++)t.primitives[e]=o.Ay.newInstance(),t.primitives[e].setPrimitiveType(e),t.primitives[e].set({lastLightComplexity:0,lastLightCount:0,lastSelectionPass:!1},!0);(0,i.e)(e,t,["context"]),t.VBOBuildTime={},(0,i.o)(t.VBOBuildTime,{mtime:0}),t.selectionStateChanged={},(0,i.o)(t.selectionStateChanged,{mtime:0}),P(e,t)}const M=(0,i.n)(N,"vtkOpenGLPolyDataMapper");var L={newInstance:M,extend:N};(0,g.c9)("vtkMapper",M)},90919:(e,t,n)=>{"use strict";function r(e,t,n){return e?`${e.getMTime()}-${t}-${n}`:"0"}function i(e,t){return`${e.getMTime()}A${t.getMTime()}`}n.d(t,{eS:()=>i,gP:()=>r})},63819:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(28906),i=n(25196),o=n(88691);const{vtkDebugMacro:a}=r.c;const s={context:null,_openGLRenderWindow:null,selector:null};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),i.A.extend(e,t,n),(0,r.g)(e,t,["shaderCache"]),(0,r.e)(e,t,["selector"]),(0,r.i)(e,t,["openGLRenderWindow"]),function(e,t){t.classHierarchy.push("vtkOpenGLRenderer"),e.buildPass=n=>{if(n){if(!t.renderable)return;e.updateLights(),e.prepareNodes(),e.addMissingNode(t.renderable.getActiveCamera()),e.addMissingNodes(t.renderable.getViewPropsWithNestedProps()),e.removeUnusedNodes()}},e.updateLights=()=>{let e=0;const n=t.renderable.getLightsByReference();for(let t=0;t<n.length;++t)n[t].getSwitch()>0&&e++;return e||(a("No lights are on, creating one."),t.renderable.createLight()),e},e.zBufferPass=n=>{if(n){let n=0;const r=t.context;t.renderable.getTransparent()||(t.context.clearColor(1,0,0,1),n|=r.COLOR_BUFFER_BIT),t.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,t.context.depthMask(!0));const i=e.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r.colorMask(!0,!0,!0,!0),n&&r.clear(n),r.enable(r.DEPTH_TEST)}},e.opaqueZBufferPass=t=>e.zBufferPass(t),e.cameraPass=t=>{t&&e.clear()},e.getAspectRatio=()=>{const e=t._parent.getSizeByReference(),n=t.renderable.getViewportByReference();return e[0]*(n[2]-n[0])/((n[3]-n[1])*e[1])},e.getTiledSizeAndOrigin=()=>{const e=t.renderable.getViewportByReference(),n=[0,0,1,1],r=e[0]-n[0],i=e[1]-n[1],o=t._parent.normalizedDisplayToDisplay(r,i),a=Math.round(o[0]),s=Math.round(o[1]),l=e[2]-n[0],c=e[3]-n[1],u=t._parent.normalizedDisplayToDisplay(l,c);let d=Math.round(u[0])-a,p=Math.round(u[1])-s;return d<0&&(d=0),p<0&&(p=0),{usize:d,vsize:p,lowerLeftU:a,lowerLeftV:s}},e.clear=()=>{let n=0;const r=t.context;if(!t.renderable.getTransparent()){const e=t.renderable.getBackgroundByReference();r.clearColor(e[0],e[1],e[2],e[3]),n|=r.COLOR_BUFFER_BIT}t.renderable.getPreserveDepthBuffer()||(r.clearDepth(1),n|=r.DEPTH_BUFFER_BIT,r.depthMask(!0)),r.colorMask(!0,!0,!0,!0);const i=e.getTiledSizeAndOrigin();r.enable(r.SCISSOR_TEST),r.scissor(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),r.viewport(i.lowerLeftU,i.lowerLeftV,i.usize,i.vsize),n&&r.clear(n),r.enable(r.DEPTH_TEST)},e.releaseGraphicsResources=()=>{null!==t.selector&&t.selector.releaseGraphicsResources(),t.renderable&&t.renderable.getViewProps().forEach((e=>{e.modified()}))},e.setOpenGLRenderWindow=n=>{t._openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t._openGLRenderWindow=n,t.context=null,n&&(t.context=t._openGLRenderWindow.getContext()))}}(e,t)}const c=(0,r.n)(l,"vtkOpenGLRenderer");var u={newInstance:c,extend:l};(0,o.c9)("vtkRenderer",c)},83534:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(18713);var i={implementReplaceShaderCoincidentOffset:function(e,t){e.replaceShaderCoincidentOffset=(n,i,o)=>{const a=e.getCoincidentParameters(i,o);if(a&&(0!==a.factor||0!==a.offset)){let e=n.Fragment;e=r.A.substitute(e,"//VTK::Coincident::Dec",["uniform float cfactor;","uniform float coffset;"]).result,t.context.getExtension("EXT_frag_depth")&&(0!==a.factor?(e=r.A.substitute(e,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,e=r.A.substitute(e,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):e=r.A.substitute(e,"//VTK::Depth::Impl","gl_FragDepthEXT = gl_FragCoord.z + 0.000016*coffset;").result),t._openGLRenderWindow.getWebgl2()&&(0!==a.factor?(e=r.A.substitute(e,"//VTK::UniformFlow::Impl",["float cscale = length(vec2(dFdx(gl_FragCoord.z),dFdy(gl_FragCoord.z)));","//VTK::UniformFlow::Impl"],!1).result,e=r.A.substitute(e,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + cfactor*cscale + 0.000016*coffset;").result):e=r.A.substitute(e,"//VTK::Depth::Impl","gl_FragDepth = gl_FragCoord.z + 0.000016*coffset;").result),n.Fragment=e}}},implementBuildShadersWithReplacements:function(e,t){e.applyShaderReplacements=(e,t,n)=>{let i=null;if(t&&(i=t.ShaderReplacements),i)for(let t=0;t<i.length;t++){const o=i[t];if(n&&o.replaceFirst||!n&&!o.replaceFirst){const t=o.shaderType,n=e[t],i=r.A.substitute(n,o.originalValue,o.replacementValue,o.replaceAll);e[t]=i.result}}},e.buildShaders=(n,r,i)=>{e.getReplacedShaderTemplate(n,r,i),t.lastRenderPassShaderReplacement=t.currentRenderPass?t.currentRenderPass.getShaderReplacement():null,t.lastRenderPassShaderReplacement&&t.lastRenderPassShaderReplacement(n);const o=t.renderable.getViewSpecificProperties().OpenGL;e.applyShaderReplacements(n,o,!0),e.replaceShaderValues(n,r,i),e.applyShaderReplacements(n,o)},e.getReplacedShaderTemplate=(n,r,i)=>{const o=t.renderable.getViewSpecificProperties().OpenGL;e.getShaderTemplate(n,r,i);let a=n.Vertex;if(o){const e=o.VertexShaderCode;void 0!==e&&""!==e&&(a=e)}n.Vertex=a;let s=n.Fragment;if(o){const e=o.FragmentShaderCode;void 0!==e&&""!==e&&(s=e)}n.Fragment=s;let l=n.Geometry;if(o){const e=o.GeometryShaderCode;void 0!==e&&(l=e)}n.Geometry=l}}}},18713:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(28906);const{vtkErrorMacro:i}=r.m;const o={shaderType:"Unknown",source:"",error:"",handle:0,dirty:!1,context:null};function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,o,n),r.m.obj(e,t),r.m.setGet(e,t,["shaderType","source","error","handle","context"]),function(e,t){t.classHierarchy.push("vtkShader"),e.compile=()=>{let e=t.context.VERTEX_SHADER;if(!t.source||!t.source.length||"Unknown"===t.shaderType)return!1;if(0!==t.handle&&(t.context.deleteShader(t.handle),t.handle=0),e="Fragment"===t.shaderType?t.context.FRAGMENT_SHADER:t.context.VERTEX_SHADER,t.handle=t.context.createShader(e),t.context.shaderSource(t.handle,t.source),t.context.compileShader(t.handle),!t.context.getShaderParameter(t.handle,t.context.COMPILE_STATUS)){const e=t.context.getShaderInfoLog(t.handle);return i(`Error compiling shader '${t.source}': ${e}`),t.context.deleteShader(t.handle),t.handle=0,!1}return!0},e.cleanup=()=>{"Unknown"!==t.shaderType&&0!==t.handle&&(t.context.deleteShader(t.handle),t.handle=0,t.dirty=!0)}}(e,t)}var s={newInstance:r.m.newInstance(a,"vtkShader"),extend:a};const{vtkErrorMacro:l}=r.m;const c={vertexShaderHandle:0,fragmentShaderHandle:0,geometryShaderHandle:0,vertexShader:null,fragmentShader:null,geometryShader:null,linked:!1,bound:!1,compiled:!1,error:"",handle:0,numberOfOutputs:0,attributesLocs:null,uniformLocs:null,md5Hash:0,context:null,lastCameraMTime:null};function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,c,n),t.attributesLocs={},t.uniformLocs={},t.vertexShader=s.newInstance(),t.vertexShader.setShaderType("Vertex"),t.fragmentShader=s.newInstance(),t.fragmentShader.setShaderType("Fragment"),t.geometryShader=s.newInstance(),t.geometryShader.setShaderType("Geometry"),r.m.obj(e,t),r.m.get(e,t,["lastCameraMTime"]),r.m.setGet(e,t,["error","handle","compiled","bound","md5Hash","vertexShader","fragmentShader","geometryShader","linked"]),function(e,t){t.classHierarchy.push("vtkShaderProgram"),e.compileShader=()=>t.vertexShader.compile()?t.fragmentShader.compile()?e.attachShader(t.vertexShader)&&e.attachShader(t.fragmentShader)?e.link()?(e.setCompiled(!0),1):(l(`Links failed: ${t.error}`),0):(l(t.error),0):(l(t.fragmentShader.getSource().split("\n").map(((e,t)=>`${t}: ${e}`)).join("\n")),l(t.fragmentShader.getError()),0):(l(t.vertexShader.getSource().split("\n").map(((e,t)=>`${t}: ${e}`)).join("\n")),l(t.vertexShader.getError()),0),e.cleanup=()=>{"Unknown"!==t.shaderType&&0!==t.handle&&(e.release(),0!==t.vertexShaderHandle&&(t.context.detachShader(t.handle,t.vertexShaderHandle),t.vertexShaderHandle=0),0!==t.fragmentShaderHandle&&(t.context.detachShader(t.handle,t.fragmentShaderHandle),t.fragmentShaderHandle=0),t.context.deleteProgram(t.handle),t.handle=0,e.setCompiled(!1))},e.bind=()=>!(!t.linked&&!e.link()||(t.context.useProgram(t.handle),e.setBound(!0),0)),e.isBound=()=>!!t.bound,e.release=()=>{t.context.useProgram(null),e.setBound(!1)},e.setContext=e=>{t.vertexShader.setContext(e),t.fragmentShader.setContext(e),t.geometryShader.setContext(e)},e.link=()=>{if(t.linked)return!0;if(0===t.handle)return t.error="Program has not been initialized, and/or does not have shaders.",!1;if(t.uniformLocs={},t.context.linkProgram(t.handle),!t.context.getProgramParameter(t.handle,t.context.LINK_STATUS)){const e=t.context.getProgramInfoLog(t.handle);return l(`Error linking shader ${e}`),t.handle=0,!1}return e.setLinked(!0),t.attributeLocs={},!0},e.setUniformMatrix=(n,r)=>{const i=e.findUniform(n);if(-1===i)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;const o=new Float32Array(r);return t.context.uniformMatrix4fv(i,!1,o),!0},e.setUniformMatrix3x3=(n,r)=>{const i=e.findUniform(n);if(-1===i)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;const o=new Float32Array(r);return t.context.uniformMatrix3fv(i,!1,o),!0},e.setUniformf=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform1f(i,r),!0)},e.setUniformfv=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform1fv(i,r),!0)},e.setUniformi=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform1i(i,r),!0)},e.setUniformiv=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform1iv(i,r),!0)},e.setUniform2f=(n,r,i)=>{const o=e.findUniform(n);if(-1===o)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;if(void 0===i)throw new RangeError("Invalid number of values for array");return t.context.uniform2f(o,r,i),!0},e.setUniform2fv=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform2fv(i,r),!0)},e.setUniform2i=(n,r,i)=>{const o=e.findUniform(n);if(-1===o)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;if(void 0===i)throw new RangeError("Invalid number of values for array");return t.context.uniform2i(o,r,i),!0},e.setUniform2iv=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform2iv(i,r),!0)},e.setUniform3f=(n,r,i,o)=>{const a=e.findUniform(n);if(-1===a)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;if(void 0===o)throw new RangeError("Invalid number of values for array");return t.context.uniform3f(a,r,i,o),!0},e.setUniform3fArray=(n,r)=>{const i=e.findUniform(n);if(-1===i)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;if(!Array.isArray(r)||3!==r.length)throw new RangeError("Invalid number of values for array");return t.context.uniform3f(i,r[0],r[1],r[2]),!0},e.setUniform3fv=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform3fv(i,r),!0)},e.setUniform3i=function(n){const r=e.findUniform(n);if(-1===r)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];let s=o;if(1===s.length&&Array.isArray(s[0])&&(s=s[0]),3!==s.length)throw new RangeError("Invalid number of values for array");return t.context.uniform3i(r,s[0],s[1],s[2]),!0},e.setUniform3iv=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform3iv(i,r),!0)},e.setUniform4f=function(n){const r=e.findUniform(n);if(-1===r)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];let s=o;if(1===s.length&&Array.isArray(s[0])&&(s=s[0]),4!==s.length)throw new RangeError("Invalid number of values for array");return t.context.uniform4f(r,s[0],s[1],s[2],s[3]),!0},e.setUniform4fv=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform4fv(i,r),!0)},e.setUniform4i=function(n){const r=e.findUniform(n);if(-1===r)return t.error=`Could not set uniform ${n} . No such uniform.`,!1;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];let s=o;if(1===s.length&&Array.isArray(s[0])&&(s=s[0]),4!==s.length)throw new RangeError("Invalid number of values for array");return t.context.uniform4i(r,s[0],s[1],s[2],s[3]),!0},e.setUniform4iv=(n,r)=>{const i=e.findUniform(n);return-1===i?(t.error=`Could not set uniform ${n} . No such uniform.`,!1):(t.context.uniform4iv(i,r),!0)},e.findUniform=e=>{if(!e||!t.linked)return-1;let n=t.uniformLocs[e];return void 0!==n?n:(n=t.context.getUniformLocation(t.handle,e),null===n?(t.error=`Uniform ${e} not found in current shader program.`,t.uniformLocs[e]=-1,-1):(t.uniformLocs[e]=n,n))},e.isUniformUsed=e=>{if(!e)return!1;let n=t.uniformLocs[e];return void 0!==n?null!==n:t.linked?(n=t.context.getUniformLocation(t.handle,e),t.uniformLocs[e]=n,null!==n):(l("attempt to find uniform when the shader program is not linked"),!1)},e.isAttributeUsed=e=>{if(!e)return!1;if(e in t.attributeLocs)return!0;if(!t.linked)return l("attempt to find uniform when the shader program is not linked"),!1;const n=t.context.getAttribLocation(t.handle,e);return-1!==n&&(t.attributeLocs[e]=n,!0)},e.attachShader=n=>{if(0===n.getHandle())return t.error="Shader object was not initialized, cannot attach it.",!1;if("Unknown"===n.getShaderType())return t.error="Shader object is of type Unknown and cannot be used.",!1;if(0===t.handle){const e=t.context.createProgram();if(0===e)return t.error="Could not create shader program.",!1;t.handle=e,t.linked=!1}return"Vertex"===n.getShaderType()&&(0!==t.vertexShaderHandle&&t.context.detachShader(t.handle,t.vertexShaderHandle),t.vertexShaderHandle=n.getHandle()),"Fragment"===n.getShaderType()&&(0!==t.fragmentShaderHandle&&t.context.detachShader(t.handle,t.fragmentShaderHandle),t.fragmentShaderHandle=n.getHandle()),t.context.attachShader(t.handle,n.getHandle()),e.setLinked(!1),!0},e.detachShader=e=>{if(0===e.getHandle())return t.error="shader object was not initialized, cannot attach it.",!1;if("Unknown"===e.getShaderType())return t.error="Shader object is of type Unknown and cannot be used.",!1;switch(0===t.handle&&(t.error="This shader program has not been initialized yet."),e.getShaderType()){case"Vertex":return t.vertexShaderHandle!==e.getHandle()?(t.error="The supplied shader was not attached to this program.",!1):(t.context.detachShader(t.handle,e.getHandle()),t.vertexShaderHandle=0,t.linked=!1,!0);case"Fragment":return t.fragmentShaderHandle!==e.getHandle()?(t.error="The supplied shader was not attached to this program.",!1):(t.context.detachShader(t.handle,e.getHandle()),t.fragmentShaderHandle=0,t.linked=!1,!0);default:return!1}},e.setContext=e=>{t.context=e,t.vertexShader.setContext(e),t.fragmentShader.setContext(e),t.geometryShader.setContext(e)},e.setLastCameraMTime=e=>{t.lastCameraMTime=e}}(e,t)}var d={newInstance:r.m.newInstance(u,"vtkShaderProgram"),extend:u,substitute:function(e,t,n,r){const i="string"==typeof n?n:n.join("\n"),o=!1===r?t:new RegExp(t,"g"),a=e.replace(o,i);return{replace:a!==i,result:a}}}},92530:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>m});var r=n(3823),i=n(28906),o=n(42008),a=n(71650),s=n(25196),l=n(79525),c=n(71995),u=n(88691);const{vtkErrorMacro:d}=i.c;const p={context:null};function f(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,p,n),s.A.extend(e,t,n),t.openGLTexture=l.Ay.newInstance(),t.tris=a.Ay.newInstance(),t.keyMatrixTime={},(0,i.o)(t.keyMatrixTime,{mtime:0}),t.keyMatrices={normalMatrix:r.w0.identity(new Float64Array(9)),mcwc:r.pB.identity(new Float64Array(16))},(0,i.e)(e,t,["context"]),(0,i.g)(e,t,["activeTextures"]),function(e,t){t.classHierarchy.push("vtkOpenGLSkybox"),e.buildPass=n=>{if(n){t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t._openGLRenderWindow=t._openGLRenderer.getParent(),t.context=t._openGLRenderWindow.getContext(),t.tris.setOpenGLRenderWindow(t._openGLRenderWindow),t.openGLTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const n=t._openGLRenderer.getRenderable();t.openGLCamera=t._openGLRenderer.getViewNodeFor(n.getActiveCamera())}},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;n.incrementOpaqueActorCount()}},e.opaquePass=(n,i)=>{if(n&&!t._openGLRenderer.getSelector()){e.updateBufferObjects(),t.context.depthMask(!0),t._openGLRenderWindow.getShaderCache().readyShaderProgram(t.tris.getProgram()),t.openGLTexture.render(t._openGLRenderWindow);const n=t.openGLTexture.getTextureUnit();t.tris.getProgram().setUniformi("sbtexture",n);const i=t._openGLRenderer.getRenderable(),o=t.openGLCamera.getKeyMatrices(i),a=new Float64Array(16);if(r.pB.invert(a,o.wcpc),t.tris.getProgram().setUniformMatrix("IMCPCMatrix",a),"box"===t.lastFormat){const e=i.getActiveCamera().getPosition();t.tris.getProgram().setUniform3f("camPos",e[0],e[1],e[2])}t.tris.getVAO().bind(),t.context.drawArrays(t.context.TRIANGLES,0,t.tris.getCABO().getElementCount()),t.tris.getVAO().release(),t.openGLTexture.deactivate()}},e.updateBufferObjects=()=>{if(!t.tris.getCABO().getElementCount()){const e=new Float32Array(12);for(let t=0;t<4;t++)e[3*t]=t%2*2-1,e[3*t+1]=t>1?1:-1,e[3*t+2]=1;const n=o.Ay.newInstance({numberOfComponents:3,values:e});n.setName("points");const r=new Uint16Array(8);r[0]=3,r[1]=0,r[2]=1,r[3]=3,r[4]=3,r[5]=0,r[6]=3,r[7]=2;const i=o.Ay.newInstance({numberOfComponents:1,values:r});t.tris.getCABO().createVBO(i,"polys",c.YL.SURFACE,{points:n,cellOffset:0})}t.renderable.getFormat()!==t.lastFormat&&(t.lastFormat=t.renderable.getFormat(),"box"===t.lastFormat&&t.tris.setProgram(t._openGLRenderWindow.getShaderCache().readyShaderProgramArray("//VTK::System::Dec\n             attribute vec3 vertexMC;\n             uniform mat4 IMCPCMatrix;\n             varying vec3 TexCoords;\n             void main () {\n              gl_Position = vec4(vertexMC.xyz, 1.0);\n              vec4 wpos = IMCPCMatrix * gl_Position;\n              TexCoords = wpos.xyz/wpos.w;\n             }","//VTK::System::Dec\n             //VTK::Output::Dec\n             varying vec3 TexCoords;\n             uniform samplerCube sbtexture;\n             uniform vec3 camPos;\n             void main () {\n               // skybox looks from inside out\n               // which means we have to adjust\n               // our tcoords. Otherwise text would\n               // be flipped\n               vec3 tc = normalize(TexCoords - camPos);\n               if (abs(tc.z) < max(abs(tc.x),abs(tc.y)))\n               {\n                 tc = vec3(1.0, 1.0, -1.0) * tc;\n               }\n               else\n               {\n                 tc = vec3(-1.0, 1.0, 1.0) * tc;\n               }\n               gl_FragData[0] = textureCube(sbtexture, tc);\n             }","")),"background"===t.lastFormat&&t.tris.setProgram(t._openGLRenderWindow.getShaderCache().readyShaderProgramArray("//VTK::System::Dec\n             attribute vec3 vertexMC;\n             uniform mat4 IMCPCMatrix;\n             varying vec2 TexCoords;\n             void main () {\n              gl_Position = vec4(vertexMC.xyz, 1.0);\n              vec4 wpos = IMCPCMatrix * gl_Position;\n              TexCoords = vec2(vertexMC.x, vertexMC.y)*0.5 + 0.5;\n             }","//VTK::System::Dec\n             //VTK::Output::Dec\n             varying vec2 TexCoords;\n             uniform sampler2D sbtexture;\n             void main () {\n               gl_FragData[0] = texture2D(sbtexture, TexCoords);\n             }","")),t.tris.getShaderSourceTime().modified(),t.tris.getVAO().bind(),t.tris.getVAO().addAttributeArray(t.tris.getProgram(),t.tris.getCABO(),"vertexMC",t.tris.getCABO().getVertexOffset(),t.tris.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||d("Error setting vertexMC in shader VAO."));const e=t.renderable.getTextures();e.length||d("vtkSkybox requires a texture map"),t.openGLTexture.getRenderable()!==e[0]&&(t.openGLTexture.releaseGraphicsResources(t._openGLRenderWindow),t.openGLTexture.setRenderable(e[0]))}}(e,t)}const h=(0,i.n)(f);var m={newInstance:h,extend:f};(0,u.c9)("vtkSkybox",h)},79525:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>w});var r=n(45043),i=n.n(r),o=n(52271),a=n(97888),s=n(28906),l=n(42008),c=n(16632),u=n(25196),d=n(88691);let p;function f(){return void 0===p&&(p=function(){try{const e=4,t=2,n=1,r=new Int16Array([0,32767]),i=[1,1],o=document.createElement("canvas");o.width=e,o.height=e;const a=o.getContext("webgl2");if(!a)return!1;const s=a.getExtension("EXT_texture_norm16");if(!s)return!1;const l=`#version 300 es\n    void main() {\n      gl_PointSize = ${e.toFixed(1)};\n      gl_Position = vec4(0, 0, 0, 1);\n    }\n  `,c="#version 300 es\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n\n    uniform sampler2D u_image;\n\n    out vec4 color;\n\n    void main() {\n        vec4 intColor = texture(u_image, gl_PointCoord.xy);\n        color = vec4(vec3(intColor.rrr), 1);\n    }\n    ",u=a.createShader(a.VERTEX_SHADER);if(a.shaderSource(u,l),a.compileShader(u),!a.getShaderParameter(u,a.COMPILE_STATUS))return!1;const d=a.createShader(a.FRAGMENT_SHADER);if(a.shaderSource(d,c),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS))return!1;const p=a.createProgram();if(a.attachShader(p,u),a.attachShader(p,d),a.linkProgram(p),!a.getProgramParameter(p,a.LINK_STATUS))return!1;const f=a.createTexture();a.bindTexture(a.TEXTURE_2D,f),a.texImage2D(a.TEXTURE_2D,0,s.R16_SNORM_EXT,t,n,0,a.RED,a.SHORT,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.useProgram(p),a.drawArrays(a.POINTS,0,1);const h=new Uint8Array(4);a.readPixels(i[0],i[1],1,1,a.RGBA,a.UNSIGNED_BYTE,h);const[m,g,v]=h,y=a.getExtension("WEBGL_lose_context");return y&&y.loseContext(),m===g&&g===v&&0!==m}catch(e){return!1}}()),p}const{Wrap:h,Filter:m}=o.Ay,{VtkDataTypes:g}=l.Ay,{vtkDebugMacro:v,vtkErrorMacro:y,vtkWarningMacro:b}=s.c,{toHalf:x}=a.A;function A(e,t){function n(){return{internalFormat:t.internalFormat,format:t.format,openGLDataType:t.openGLDataType,width:t.width,height:t.height}}t.classHierarchy.push("vtkOpenGLTexture"),e.render=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(n?t._openGLRenderWindow=n:(t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t._openGLRenderWindow=t._openGLRenderer.getLastAncestorOfType("vtkOpenGLRenderWindow")),t.context=t._openGLRenderWindow.getContext(),t.renderable.getInterpolate()?(t.generateMipmap?e.setMinificationFilter(m.LINEAR_MIPMAP_LINEAR):e.setMinificationFilter(m.LINEAR),e.setMagnificationFilter(m.LINEAR)):(e.setMinificationFilter(m.NEAREST),e.setMagnificationFilter(m.NEAREST)),t.renderable.getRepeat()&&(e.setWrapR(h.REPEAT),e.setWrapS(h.REPEAT),e.setWrapT(h.REPEAT)),t.renderable.getInputData()&&t.renderable.setImage(null),!t.handle||t.renderable.getMTime()>t.textureBuildTime.getMTime()){if(null!==t.renderable.getImage()&&(t.renderable.getInterpolate()&&(t.generateMipmap=!0,e.setMinificationFilter(m.LINEAR_MIPMAP_LINEAR)),t.renderable.getImage()&&t.renderable.getImageLoaded()&&(e.create2DFromImage(t.renderable.getImage()),e.activate(),e.sendParameters(),t.textureBuildTime.modified())),null!==t.renderable.getCanvas()){t.renderable.getInterpolate()&&(t.generateMipmap=!0,e.setMinificationFilter(m.LINEAR_MIPMAP_LINEAR));const n=t.renderable.getCanvas();e.create2DFromRaw(n.width,n.height,4,g.UNSIGNED_CHAR,n,!0),e.activate(),e.sendParameters(),t.textureBuildTime.modified()}if(null!==t.renderable.getJsImageData()){const n=t.renderable.getJsImageData();t.renderable.getInterpolate()&&(t.generateMipmap=!0,e.setMinificationFilter(m.LINEAR_MIPMAP_LINEAR)),e.create2DFromRaw(n.width,n.height,4,g.UNSIGNED_CHAR,n.data,!0),e.activate(),e.sendParameters(),t.textureBuildTime.modified()}const n=t.renderable.getInputData(0);if(n&&n.getPointData().getScalars()){const r=n.getExtent(),i=n.getPointData().getScalars(),o=[];for(let e=0;e<t.renderable.getNumberOfInputPorts();++e){const n=t.renderable.getInputData(e),r=n?n.getPointData().getScalars().getData():null;r&&o.push(r)}t.renderable.getInterpolate()&&4===i.getNumberOfComponents()&&(t.generateMipmap=!0,e.setMinificationFilter(m.LINEAR_MIPMAP_LINEAR)),o.length%6==0?e.createCubeFromRaw(r[1]-r[0]+1,r[3]-r[2]+1,i.getNumberOfComponents(),i.getDataType(),o):e.create2DFromRaw(r[1]-r[0]+1,r[3]-r[2]+1,i.getNumberOfComponents(),i.getDataType(),i.getData()),e.activate(),e.sendParameters(),t.textureBuildTime.modified()}}t.handle&&e.activate()};const r=()=>{if(t.minificationFilter!==m.LINEAR&&t.magnificationFilter!==m.LINEAR||f())return t.oglNorm16Ext};function o(e){const[t,n,r,i,o,a]=e;return[n-t+1,i-r+1,a-o+1]}function u(e){const[t,n,r]=o(e);return t*n*r}function d(e,n){const r=new((arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||e.constructor)(n.reduce(((e,t)=>e+u(t)),0)),i=[t.width,t.height,t.depth];let o=0;return n.forEach((t=>{!function(e,t,n,r,i){const[o,a,s,l,c,u]=n,[d,p]=t,f=d*p;let h=i;for(let t=c;t<=u;t++){const n=t*f;for(let t=s;t<=l;t++){const i=n+t*d;for(let t=i+o,n=i+a;t<=n;t++,h++)r[h]=e[t]}}}(e,i,t,r,o),o+=u(t)})),r}function p(e){if(t._openGLRenderWindow.getWebgl2())return e;const n=[],r=t.width,i=t.height,o=t.components;if(e&&(!(0,c.V)(r)||!(0,c.V)(i))){const s=t.context.getExtension("OES_texture_half_float"),l=(0,c.R)(r),u=(0,c.R)(i),d=l*u*t.components;for(let c=0;c<e.length;c++)if(null!==e[c]){let p=null;const f=i/u,h=r/l;let m=!1;t.openGLDataType===t.context.FLOAT?p=new Float32Array(d):s&&t.openGLDataType===s.HALF_FLOAT_OES?(p=new Uint16Array(d),m=!0):p=new Uint8Array(d);for(let t=0;t<u;t++){const n=t*l*o,s=t*f;let u=Math.floor(s),d=Math.ceil(s);d>=i&&(d=i-1);const g=s-u,v=1-g;u=u*r*o,d=d*r*o;for(let t=0;t<l;t++){const i=t*o,s=t*h;let l=Math.floor(s),f=Math.ceil(s);f>=r&&(f=r-1);const y=s-l;l*=o,f*=o;for(let t=0;t<o;t++)p[n+i+t]=m?a.A.toHalf(a.A.fromHalf(e[c][u+l+t])*v*(1-y)+a.A.fromHalf(e[c][u+f+t])*v*y+a.A.fromHalf(e[c][d+l+t])*g*(1-y)+a.A.fromHalf(e[c][d+f+t])*g*y):e[c][u+l+t]*v*(1-y)+e[c][u+f+t]*v*y+e[c][d+l+t]*g*(1-y)+e[c][d+f+t]*g*y}}n.push(p),t.width=l,t.height=u}else n.push(null)}if(0===n.length)for(let t=0;t<e.length;t++)n.push(e[t]);return n}function A(e){if(t._openGLRenderWindow){if(t.resizable||t.renderable?.getResizable())return!1;if(t._openGLRenderWindow.getWebgl2()){return!(t._openGLRenderWindow.getGLInformations().RENDERER.value.match(/WebKit/gi)&&navigator.platform.match(/Mac/gi)&&r())||e!==g.UNSIGNED_SHORT&&e!==g.SHORT}return!1}return!1}function C(n,r){const i=n.getNumberOfComponents(),o=n.getDataType(),a=n.getData(),s=new Array(i),l=new Array(i);for(let e=0;e<i;++e){const[t,r]=n.getRange(e);s[e]=t,l[e]=r}const c=function(e,t,n){const r=new Array(n),i=new Array(n);for(let o=0;o<n;++o)r[o]=e[o],i[o]=t[o]-e[o]||1;return{scale:i,offset:r}}(s,l,i);return function(n,r,i,o){e.getOpenGLDataType(n);const a=function(e,t){for(let n=0;n<e.length;n++){const r=e[n],i=t[n]+r;if(r<-2048||r>2048||i<-2048||i>2048)return!1}return!0}(r,i)||o;let s=!1;if(t._openGLRenderWindow.getWebgl2())s=t.openGLDataType===t.context.FLOAT&&null===t.context.getExtension("OES_texture_float_linear")&&a||t.openGLDataType===t.context.HALF_FLOAT;else{const e=t.context.getExtension("OES_texture_half_float");s=e&&t.openGLDataType===e.HALF_FLOAT_OES}t.canUseHalfFloat=s&&a}(o,c.offset,c.scale,r),e.useHalfFloat()||e.getOpenGLDataType(o,!0),{numComps:i,dataType:o,data:a,scaleOffsets:c}}e.destroyTexture=()=>{e.deactivate(),t.context&&t.handle&&t.context.deleteTexture(t.handle),t._prevTexParams=null,t.handle=0,t.numberOfDimensions=0,t.target=0,t.components=0,t.width=0,t.height=0,t.depth=0,e.resetFormatAndType()},e.createTexture=()=>{t.handle||(t.handle=t.context.createTexture(),t.target&&(t.context.bindTexture(t.target,t.handle),t.context.texParameteri(t.target,t.context.TEXTURE_MIN_FILTER,e.getOpenGLFilterMode(t.minificationFilter)),t.context.texParameteri(t.target,t.context.TEXTURE_MAG_FILTER,e.getOpenGLFilterMode(t.magnificationFilter)),t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_S,e.getOpenGLWrapMode(t.wrapS)),t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_T,e.getOpenGLWrapMode(t.wrapT)),t._openGLRenderWindow.getWebgl2()&&t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_R,e.getOpenGLWrapMode(t.wrapR)),t.context.bindTexture(t.target,null)))},e.getTextureUnit=()=>t._openGLRenderWindow?t._openGLRenderWindow.getTextureUnitForTexture(e):-1,e.activate=()=>{t._openGLRenderWindow.activateTexture(e),e.bind()},e.deactivate=()=>{t._openGLRenderWindow&&t._openGLRenderWindow.deactivateTexture(e)},e.releaseGraphicsResources=n=>{n&&t.handle&&(n.activateTexture(e),n.deactivateTexture(e),t.context.deleteTexture(t.handle),t._prevTexParams=null,t.handle=0,t.numberOfDimensions=0,t.target=0,t.internalFormat=0,t.format=0,t.openGLDataType=0,t.components=0,t.width=0,t.height=0,t.depth=0,t.allocatedGPUMemoryInBytes=0),t.shaderProgram&&(t.shaderProgram.releaseGraphicsResources(n),t.shaderProgram=null)},e.bind=()=>{t.context.bindTexture(t.target,t.handle),t.autoParameters&&e.getMTime()>t.sendParametersTime.getMTime()&&e.sendParameters()},e.isBound=()=>{let e=!1;if(t.context&&t.handle){let n=0;if(t.target===t.context.TEXTURE_2D)n=t.context.TEXTURE_BINDING_2D;else b("impossible case");e=t.context.getIntegerv(n)===t.handle}return e},e.sendParameters=()=>{t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_S,e.getOpenGLWrapMode(t.wrapS)),t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_T,e.getOpenGLWrapMode(t.wrapT)),t._openGLRenderWindow.getWebgl2()&&t.context.texParameteri(t.target,t.context.TEXTURE_WRAP_R,e.getOpenGLWrapMode(t.wrapR)),t.context.texParameteri(t.target,t.context.TEXTURE_MIN_FILTER,e.getOpenGLFilterMode(t.minificationFilter)),t.context.texParameteri(t.target,t.context.TEXTURE_MAG_FILTER,e.getOpenGLFilterMode(t.magnificationFilter)),t._openGLRenderWindow.getWebgl2()&&(t.context.texParameteri(t.target,t.context.TEXTURE_BASE_LEVEL,t.baseLevel),t.context.texParameteri(t.target,t.context.TEXTURE_MAX_LEVEL,t.maxLevel)),t.sendParametersTime.modified()},e.getInternalFormat=(n,r)=>(t._forceInternalFormat||(t.internalFormat=e.getDefaultInternalFormat(n,r)),t.internalFormat||v(`Unable to find suitable internal format for T=${n} NC= ${r}`),[t.context.R32F,t.context.RG32F,t.context.RGB32F,t.context.RGBA32F].includes(t.internalFormat)&&!t.context.getExtension("OES_texture_float_linear")&&b("Failed to load OES_texture_float_linear. Texture filtering is not available for *32F internal formats."),t.internalFormat),e.getDefaultInternalFormat=(n,i)=>{let o=0;return o=t._openGLRenderWindow.getDefaultTextureInternalFormat(n,i,r(),e.useHalfFloat()),o||(o||(v("Unsupported internal texture type!"),v(`Unable to find suitable internal format for T=${n} NC= ${i}`)),o)},e.useHalfFloat=()=>t.enableUseHalfFloat&&t.canUseHalfFloat,e.setInternalFormat=n=>{t._forceInternalFormat=!0,n!==t.internalFormat&&(t.internalFormat=n,e.modified())},e.getFormat=(n,r)=>(t.format=e.getDefaultFormat(n,r),t.format),e.getDefaultFormat=(e,n)=>{if(t._openGLRenderWindow.getWebgl2())switch(n){case 1:return t.context.RED;case 2:return t.context.RG;case 3:default:return t.context.RGB;case 4:return t.context.RGBA}else switch(n){case 1:return t.context.LUMINANCE;case 2:return t.context.LUMINANCE_ALPHA;case 3:default:return t.context.RGB;case 4:return t.context.RGBA}},e.resetFormatAndType=()=>{t._prevTexParams=null,t.format=0,t.internalFormat=0,t._forceInternalFormat=!1,t.openGLDataType=0},e.getDefaultDataType=n=>{const i=e.useHalfFloat();if(t._openGLRenderWindow.getWebgl2())switch(n){case g.UNSIGNED_CHAR:return t.context.UNSIGNED_BYTE;case r()&&!i&&g.SHORT:return t.context.SHORT;case r()&&!i&&g.UNSIGNED_SHORT:return t.context.UNSIGNED_SHORT;case i&&g.SHORT:case i&&g.UNSIGNED_SHORT:return t.context.HALF_FLOAT;case g.FLOAT:case g.VOID:default:return t.context.FLOAT}switch(n){case g.UNSIGNED_CHAR:return t.context.UNSIGNED_BYTE;case g.FLOAT:case g.VOID:default:if(t.context.getExtension("OES_texture_float")&&t.context.getExtension("OES_texture_float_linear"))return t.context.FLOAT;{const e=t.context.getExtension("OES_texture_half_float");if(e&&t.context.getExtension("OES_texture_half_float_linear"))return e.HALF_FLOAT_OES}return t.context.UNSIGNED_BYTE}},e.getOpenGLDataType=function(n){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.openGLDataType&&!r||(t.openGLDataType=e.getDefaultDataType(n)),t.openGLDataType},e.getShiftAndScale=()=>{let e=0,n=1;switch(t.openGLDataType){case t.context.BYTE:n=127.5,e=n-128;break;case t.context.UNSIGNED_BYTE:n=255,e=0;break;case t.context.SHORT:n=32767.5,e=n-32768;break;case t.context.UNSIGNED_SHORT:n=65536,e=0;break;case t.context.INT:n=2147483647.5,e=n-2147483648;break;case t.context.UNSIGNED_INT:n=4294967295,e=0;case t.context.FLOAT:}return{shift:e,scale:n}},e.getOpenGLFilterMode=e=>{switch(e){case m.NEAREST:return t.context.NEAREST;case m.LINEAR:return t.context.LINEAR;case m.NEAREST_MIPMAP_NEAREST:return t.context.NEAREST_MIPMAP_NEAREST;case m.NEAREST_MIPMAP_LINEAR:return t.context.NEAREST_MIPMAP_LINEAR;case m.LINEAR_MIPMAP_NEAREST:return t.context.LINEAR_MIPMAP_NEAREST;case m.LINEAR_MIPMAP_LINEAR:return t.context.LINEAR_MIPMAP_LINEAR;default:return t.context.NEAREST}},e.getOpenGLWrapMode=e=>{switch(e){case h.CLAMP_TO_EDGE:return t.context.CLAMP_TO_EDGE;case h.REPEAT:return t.context.REPEAT;case h.MIRRORED_REPEAT:return t.context.MIRRORED_REPEAT;default:return t.context.CLAMP_TO_EDGE}},e.updateArrayDataTypeForGL=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const o=[];let a=t.width*t.height*t.components;r&&(a*=t.depth);const s=!!i.length;if(e!==g.FLOAT&&t.openGLDataType===t.context.FLOAT)for(let e=0;e<n.length;e++)if(n[e])if(s)o.push(d(n[e],i,Float32Array));else{const t=n[e].length>a?n[e].subarray(0,a):n[e];o.push(new Float32Array(t))}else o.push(null);if(e!==g.UNSIGNED_CHAR&&t.openGLDataType===t.context.UNSIGNED_BYTE)for(let e=0;e<n.length;e++)if(n[e])if(s)o.push(d(n[e],i,Uint8Array));else{const t=n[e].length>a?n[e].subarray(0,a):n[e];o.push(new Uint8Array(t))}else o.push(null);let l=!1;if(t._openGLRenderWindow.getWebgl2())l=t.openGLDataType===t.context.HALF_FLOAT;else{const e=t.context.getExtension("OES_texture_half_float");l=e&&t.openGLDataType===e.HALF_FLOAT_OES}if(l)for(let e=0;e<n.length;e++)if(n[e]){const t=s?d(n[e],i):n[e],r=new Uint16Array(s?t.length:a),l=r.length;for(let e=0;e<l;e++)r[e]=x(t[e]);o.push(r)}else o.push(null);if(0===o.length)for(let e=0;e<n.length;e++)o.push(s&&n[e]?d(n[e],i):n[e]);return o},e.create2DFromRaw=function(n,i,o,a,s){let l=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e.getOpenGLDataType(a,!0),e.getInternalFormat(a,o),e.getFormat(a,o),!t.internalFormat||!t.format||!t.openGLDataType)return y("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_2D,t.components=o,t.width=n,t.height=i,t.depth=1,t.numberOfDimensions=2,t._openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind();const c=[s],u=p(e.updateArrayDataTypeForGL(a,c));return t.context.pixelStorei(t.context.UNPACK_FLIP_Y_WEBGL,l),t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1),A(a)?(t.context.texStorage2D(t.target,1,t.internalFormat,t.width,t.height),null!=u[0]&&t.context.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.openGLDataType,u[0])):t.context.texImage2D(t.target,0,t.internalFormat,t.width,t.height,0,t.format,t.openGLDataType,u[0]),t.generateMipmap&&t.context.generateMipmap(t.target),l&&t.context.pixelStorei(t.context.UNPACK_FLIP_Y_WEBGL,!1),t.allocatedGPUMemoryInBytes=t.width*t.height*t.depth*o*t._openGLRenderWindow.getDefaultTextureByteSize(a,r(),e.useHalfFloat()),e.deactivate(),!0},e.createCubeFromRaw=(n,i,o,a,l)=>{if(e.getOpenGLDataType(a),e.getInternalFormat(a,o),e.getFormat(a,o),!t.internalFormat||!t.format||!t.openGLDataType)return y("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_CUBE_MAP,t.components=o,t.width=n,t.height=i,t.depth=1,t.numberOfDimensions=2,t._openGLRenderWindow.activateTexture(e),t.maxLevel=l.length/6-1,e.createTexture(),e.bind();const c=p(e.updateArrayDataTypeForGL(a,l)),u=[];let d=t.width,f=t.height;for(let e=0;e<c.length;e++){e%6==0&&0!==e&&(d/=2,f/=2),u[e]=(0,s.a)(a,f*d*t.components);for(let n=0;n<f;++n){const r=n*d*t.components,i=(f-n-1)*d*t.components;u[e].set(c[e].slice(i,i+d*t.components),r)}}t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1),A(a)&&t.context.texStorage2D(t.target,6,t.internalFormat,t.width,t.height);for(let e=0;e<6;e++){let n=0,r=t.width,i=t.height;for(;r>=1&&i>=1;){let o=null;n<=t.maxLevel&&(o=u[6*n+e]),A(a)?null!=o&&t.context.texSubImage2D(t.context.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,0,0,r,i,t.format,t.openGLDataType,o):t.context.texImage2D(t.context.TEXTURE_CUBE_MAP_POSITIVE_X+e,n,t.internalFormat,r,i,0,t.format,t.openGLDataType,o),n++,r/=2,i/=2}}return t.allocatedGPUMemoryInBytes=t.width*t.height*t.depth*o*t._openGLRenderWindow.getDefaultTextureByteSize(a,r(),e.useHalfFloat()),e.deactivate(),!0},e.createDepthFromRaw=(n,i,o,a)=>(e.getOpenGLDataType(o),t.format=t.context.DEPTH_COMPONENT,t._openGLRenderWindow.getWebgl2()?o===g.FLOAT?t.internalFormat=t.context.DEPTH_COMPONENT32F:t.internalFormat=t.context.DEPTH_COMPONENT16:t.internalFormat=t.context.DEPTH_COMPONENT,t.internalFormat&&t.format&&t.openGLDataType?(t.target=t.context.TEXTURE_2D,t.components=1,t.width=n,t.height=i,t.depth=1,t.numberOfDimensions=2,t._openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind(),t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1),A(o)?(t.context.texStorage2D(t.target,1,t.internalFormat,t.width,t.height),null!=a&&t.context.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.openGLDataType,a)):t.context.texImage2D(t.target,0,t.internalFormat,t.width,t.height,0,t.format,t.openGLDataType,a),t.generateMipmap&&t.context.generateMipmap(t.target),t.allocatedGPUMemoryInBytes=t.width*t.height*t.depth*t.components*t._openGLRenderWindow.getDefaultTextureByteSize(o,r(),e.useHalfFloat()),e.deactivate(),!0):(y("Failed to determine texture parameters."),!1)),e.create2DFromImage=n=>{if(e.getOpenGLDataType(g.UNSIGNED_CHAR),e.getInternalFormat(g.UNSIGNED_CHAR,4),e.getFormat(g.UNSIGNED_CHAR,4),!t.internalFormat||!t.format||!t.openGLDataType)return y("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_2D,t.components=4,t.depth=1,t.numberOfDimensions=2,t._openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind(),t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1);const i=!(t._openGLRenderWindow.getWebgl2()||(0,c.V)(n.width)&&(0,c.V)(n.height)),o=document.createElement("canvas");o.width=i?(0,c.R)(n.width):n.width,o.height=i?(0,c.R)(n.height):n.height,t.width=o.width,t.height=o.height;const a=o.getContext("2d");a.translate(0,o.height),a.scale(1,-1),a.drawImage(n,0,0,n.width,n.height,0,0,o.width,o.height);const s=o;return A(g.UNSIGNED_CHAR)?(t.context.texStorage2D(t.target,1,t.internalFormat,t.width,t.height),null!=s&&t.context.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.openGLDataType,s)):t.context.texImage2D(t.target,0,t.internalFormat,t.width,t.height,0,t.format,t.openGLDataType,s),t.generateMipmap&&t.context.generateMipmap(t.target),t.allocatedGPUMemoryInBytes=t.width*t.height*t.depth*t.components*t._openGLRenderWindow.getDefaultTextureByteSize(g.UNSIGNED_CHAR,r(),e.useHalfFloat()),e.deactivate(),!0},e.create2DFilterableFromRaw=function(t,n,r,i,o){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;return e.create2DFilterableFromDataArray(t,n,l.Ay.newInstance({numberOfComponents:r,dataType:i,values:o,ranges:s}),a)},e.create2DFilterableFromDataArray=function(t,n,r){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const{numComps:o,dataType:a,data:s}=C(r,i);e.create2DFromRaw(t,n,o,a,s)},e.updateVolumeInfoForGL=(n,i)=>{let o=!1;const a=e.useHalfFloat();t.volumeInfo?.scale&&t.volumeInfo?.offset||(t.volumeInfo={scale:new Array(i),offset:new Array(i)});for(let e=0;e<i;++e)t.volumeInfo.scale[e]=1,t.volumeInfo.offset[e]=0;if(r()&&!a&&n===g.SHORT){for(let e=0;e<i;++e)t.volumeInfo.scale[e]=32767;o=!0}if(r()&&!a&&n===g.UNSIGNED_SHORT){for(let e=0;e<i;++e)t.volumeInfo.scale[e]=65535;o=!0}if(n===g.UNSIGNED_CHAR){for(let e=0;e<i;++e)t.volumeInfo.scale[e]=255;o=!0}return(n===g.FLOAT||a&&(n===g.SHORT||n===g.UNSIGNED_SHORT))&&(o=!0),o},e.create3DFromRaw=function(a,s,l,c,d,f){let h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],m=d,v=f;if(!e.updateVolumeInfoForGL(m,c)&&v){const e=a*s*l,n=structuredClone(t.volumeInfo),r=new Float32Array(e*c);t.volumeInfo.offset=n.offset,t.volumeInfo.scale=n.scale;let i=0;const o=n.scale.map((e=>1/e));for(let t=0;t<e;t++)for(let e=0;e<c;e++)r[i]=(v[i]-n.offset[e])*o[e],i++;m=g.FLOAT,v=r}if(e.getOpenGLDataType(m),e.getInternalFormat(m,c),e.getFormat(m,c),!t.internalFormat||!t.format||!t.openGLDataType)return y("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_3D,t.components=c,t.width=a,t.height=s,t.depth=l,t.numberOfDimensions=3,t._openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind();const b=h.length>0,x=!b||!i()(t._prevTexParams,n()),C=[v],T=p(e.updateArrayDataTypeForGL(m,C,!0,x?[]:h));if(t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1),x)A(m)?(t.context.texStorage3D(t.target,1,t.internalFormat,t.width,t.height,t.depth),null!=T[0]&&t.context.texSubImage3D(t.target,0,0,0,0,t.width,t.height,t.depth,t.format,t.openGLDataType,T[0])):t.context.texImage3D(t.target,0,t.internalFormat,t.width,t.height,t.depth,0,t.format,t.openGLDataType,T[0]),t._prevTexParams=n();else if(b){const e=T[0];let n=0;for(let r=0;r<h.length;r++){const i=h[r],a=o(i),s=u(i),l=new e.constructor(e.buffer,n,s);n+=l.byteLength,t.context.texSubImage3D(t.target,0,i[0],i[2],i[4],a[0],a[1],a[2],t.format,t.openGLDataType,l)}}return t.generateMipmap&&t.context.generateMipmap(t.target),t.allocatedGPUMemoryInBytes=t.width*t.height*t.depth*t.components*t._openGLRenderWindow.getDefaultTextureByteSize(m,r(),e.useHalfFloat()),e.deactivate(),!0},e.create3DFilterableFromRaw=function(t,n,r,i,o,a){let s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[];return e.create3DFilterableFromDataArray(t,n,r,l.Ay.newInstance({numberOfComponents:i,dataType:o,values:a,ranges:c}),s,u)},e.create3DFilterableFromDataArray=function(n,r,i,o){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];const{numComps:l,dataType:u,data:d,scaleOffsets:p}=C(o,a),f=[],h=[];for(let e=0;e<l;++e)f[e]=0,h[e]=1;if(t.volumeInfo={scale:h,offset:f,dataComputedScale:p.scale,dataComputedOffset:p.offset,width:n,height:r,depth:i},t._openGLRenderWindow.getWebgl2())return e.create3DFromRaw(n,r,i,l,u,d,s);const m=n*r*i,v=structuredClone(p);let b=(e,t,n,r,i)=>{e[t]=n},x=g.UNSIGNED_CHAR;if(u===g.UNSIGNED_CHAR)for(let e=0;e<l;++e)v.offset[e]=0,v.scale[e]=255;else t.context.getExtension("OES_texture_float")&&t.context.getExtension("OES_texture_float_linear")?(x=g.FLOAT,b=(e,t,n,r,i)=>{e[t]=(n-r)/i}):(x=g.UNSIGNED_CHAR,b=(e,t,n,r,i)=>{e[t]=255*(n-r)/i});if(e.getOpenGLDataType(x),e.getInternalFormat(x,l),e.getFormat(x,l),!t.internalFormat||!t.format||!t.openGLDataType)return y("Failed to determine texture parameters."),!1;t.target=t.context.TEXTURE_2D,t.components=l,t.depth=1,t.numberOfDimensions=2;let T=t.context.getParameter(t.context.MAX_TEXTURE_SIZE);T>4096&&(x===g.FLOAT||l>=3)&&(T=4096);let S=1,w=1;m>T*T&&(S=Math.ceil(Math.sqrt(m/(T*T))),w=S);let _=Math.sqrt(m)/S;_=(0,c.R)(_);const I=Math.floor(_*S/n),E=Math.ceil(i/I),D=(0,c.R)(r*E/w);let O;t.width=_,t.height=D,t._openGLRenderWindow.activateTexture(e),e.createTexture(),e.bind(),t.volumeInfo.xreps=I,t.volumeInfo.yreps=E,t.volumeInfo.xstride=S,t.volumeInfo.ystride=w,t.volumeInfo.offset=v.offset,t.volumeInfo.scale=v.scale;const P=_*D*l;O=x===g.FLOAT?new Float32Array(P):new Uint8Array(P);let R=0;const N=Math.floor(n/S),M=Math.floor(r/w);for(let e=0;e<E;e++){const o=Math.min(I,i-e*I),a=l*(t.width-o*Math.floor(n/S));for(let t=0;t<M;t++){for(let i=0;i<o;i++){const o=l*((e*I+i)*n*r+w*t*n);for(let e=0;e<N;e++)for(let t=0;t<l;t++)b(O,R,d[o+S*e*l+t],v.offset[t],v.scale[t]),R++}R+=a}}return t.context.pixelStorei(t.context.UNPACK_ALIGNMENT,1),A(x)?(t.context.texStorage2D(t.target,1,t.internalFormat,t.width,t.height),null!=O&&t.context.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.openGLDataType,O)):t.context.texImage2D(t.target,0,t.internalFormat,t.width,t.height,0,t.format,t.openGLDataType,O),e.deactivate(),!0},e.setOpenGLRenderWindow=n=>{t._openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t._openGLRenderWindow=n,t.context=null,n&&(t.context=t._openGLRenderWindow.getContext()))},e.getMaximumTextureSize=e=>e&&e.isCurrent()?e.getIntegerv(e.MAX_TEXTURE_SIZE):-1,e.enableUseHalfFloat=e=>{t.enableUseHalfFloat=e}}const C={_openGLRenderWindow:null,_forceInternalFormat:!1,_prevTexParams:null,context:null,handle:0,sendParametersTime:null,textureBuildTime:null,numberOfDimensions:0,target:0,format:0,openGLDataType:0,components:0,width:0,height:0,depth:0,autoParameters:!0,wrapS:h.CLAMP_TO_EDGE,wrapT:h.CLAMP_TO_EDGE,wrapR:h.CLAMP_TO_EDGE,minificationFilter:m.NEAREST,magnificationFilter:m.NEAREST,minLOD:-1e3,maxLOD:1e3,baseLevel:0,maxLevel:1e3,generateMipmap:!1,oglNorm16Ext:null,allocatedGPUMemoryInBytes:0,enableUseHalfFloat:!0,canUseHalfFloat:!1};function T(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,C,n),u.A.extend(e,t,n),t.sendParametersTime={},(0,s.o)(t.sendParametersTime,{mtime:0}),t.textureBuildTime={},(0,s.o)(t.textureBuildTime,{mtime:0}),(0,s.s)(e,t,["format","openGLDataType"]),(0,s.e)(e,t,["keyMatrixTime","minificationFilter","magnificationFilter","wrapS","wrapT","wrapR","generateMipmap","oglNorm16Ext"]),(0,s.g)(e,t,["width","height","volumeInfo","components","handle","target","allocatedGPUMemoryInBytes"]),(0,s.i)(e,t,["openGLRenderWindow"]),A(e,t)}const S=(0,s.n)(T,"vtkOpenGLTexture");var w={newInstance:S,extend:T,...o.Ay};(0,d.c9)("vtkTexture",S)},52271:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o,B_:()=>r,dJ:()=>i});const r={CLAMP_TO_EDGE:0,REPEAT:1,MIRRORED_REPEAT:2},i={NEAREST:0,LINEAR:1,NEAREST_MIPMAP_NEAREST:2,NEAREST_MIPMAP_LINEAR:3,LINEAR_MIPMAP_NEAREST:4,LINEAR_MIPMAP_LINEAR:5};var o={Wrap:r,Filter:i}},13926:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>s});var r=n(28906),i=n(60003);const o={forceEmulation:!1,handleVAO:0,handleProgram:0,supported:!0,buffers:null,context:null};function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,o,n),t.buffers=[],r.m.obj(e,t),r.m.get(e,t,["supported"]),r.m.setGet(e,t,["forceEmulation"]),function(e,t){t.classHierarchy.push("vtkOpenGLVertexArrayObject"),e.exposedMethod=()=>{},e.initialize=()=>{t.instancingExtension=null,t._openGLRenderWindow.getWebgl2()||(t.instancingExtension=t.context.getExtension("ANGLE_instanced_arrays")),!t.forceEmulation&&t._openGLRenderWindow&&t._openGLRenderWindow.getWebgl2()?(t.extension=null,t.supported=!0,t.handleVAO=t.context.createVertexArray()):(t.extension=t.context.getExtension("OES_vertex_array_object"),!t.forceEmulation&&t.extension?(t.supported=!0,t.handleVAO=t.extension.createVertexArrayOES()):t.supported=!1)},e.isReady=()=>0!==t.handleVAO||!1===t.supported,e.bind=()=>{if(e.isReady()||e.initialize(),e.isReady()&&t.supported)t.extension?t.extension.bindVertexArrayOES(t.handleVAO):t.context.bindVertexArray(t.handleVAO);else if(e.isReady()){const e=t.context;for(let n=0;n<t.buffers.length;++n){const r=t.buffers[n];t.context.bindBuffer(e.ARRAY_BUFFER,r.buffer);for(let n=0;n<r.attributes.length;++n){const i=r.attributes[n],o=i.isMatrix?i.size:1;for(let n=0;n<o;++n)e.enableVertexAttribArray(i.index+n),e.vertexAttribPointer(i.index+n,i.size,i.type,i.normalize,i.stride,i.offset+i.stride*n/i.size),i.divisor>0&&(t.instancingExtension?t.instancingExtension.vertexAttribDivisorANGLE(i.index+n,1):e.vertexAttribDivisor(i.index+n,1))}}}},e.release=()=>{if(e.isReady()&&t.supported)t.extension?t.extension.bindVertexArrayOES(null):t.context.bindVertexArray(null);else if(e.isReady()){const e=t.context;for(let n=0;n<t.buffers.length;++n){const r=t.buffers[n];t.context.bindBuffer(e.ARRAY_BUFFER,r.buffer);for(let n=0;n<r.attributes.length;++n){const i=r.attributes[n],o=i.isMatrix?i.size:1;for(let n=0;n<o;++n)e.enableVertexAttribArray(i.index+n),e.vertexAttribPointer(i.index+n,i.size,i.type,i.normalize,i.stride,i.offset+i.stride*n/i.size),i.divisor>0&&(t.instancingExtension?t.instancingExtension.vertexAttribDivisorANGLE(i.index+n,0):e.vertexAttribDivisor(i.index+n,0)),e.disableVertexAttribArray(i.index+n)}}}},e.shaderProgramChanged=()=>{e.release(),t.handleVAO&&(t.extension?t.extension.deleteVertexArrayOES(t.handleVAO):t.context.deleteVertexArray(t.handleVAO)),t.handleVAO=0,t.handleProgram=0},e.releaseGraphicsResources=()=>{e.shaderProgramChanged(),t.handleVAO&&(t.extension?t.extension.deleteVertexArrayOES(t.handleVAO):t.context.deleteVertexArray(t.handleVAO)),t.handleVAO=0,t.supported=!0,t.handleProgram=0},e.addAttributeArray=(t,n,r,i,o,a,s,l)=>e.addAttributeArrayWithDivisor(t,n,r,i,o,a,s,l,0,!1),e.addAttributeArrayWithDivisor=(n,r,o,a,s,l,c,u,d,p)=>{if(!n)return!1;if(!n.isBound()||0===r.getHandle()||r.getType()!==i.a.ARRAY_BUFFER)return!1;if(0===t.handleProgram&&(t.handleProgram=n.getHandle()),e.isReady()||e.initialize(),!e.isReady()||t.handleProgram!==n.getHandle())return!1;const f=t.context,h={};if(h.name=o,h.index=f.getAttribLocation(t.handleProgram,o),h.offset=a,h.stride=s,h.type=l,h.size=c,h.normalize=u,h.isMatrix=p,h.divisor=d,-1===h.Index)return!1;if(r.bind(),f.enableVertexAttribArray(h.index),f.vertexAttribPointer(h.index,h.size,h.type,h.normalize,h.stride,h.offset),d>0&&(t.instancingExtension?t.instancingExtension.vertexAttribDivisorANGLE(h.index,1):f.vertexAttribDivisor(h.index,1)),h.buffer=r.getHandle(),!t.supported){let e=!1;for(let n=0;n<t.buffers.length;++n){const r=t.buffers[n];if(r.buffer===h.buffer){e=!0;let t=!1;for(let e=0;e<r.attributes.length;++e)r.attributes[e].name===o&&(t=!0,r.attributes[e]=h);t||r.attributes.push(h)}}e||t.buffers.push({buffer:h.buffer,attributes:[h]})}return!0},e.addAttributeMatrixWithDivisor=(n,r,i,o,a,s,l,c,u)=>{const d=e.addAttributeArrayWithDivisor(n,r,i,o,a,s,l,c,u,!0);if(!d)return d;const p=t.context,f=p.getAttribLocation(t.handleProgram,i);for(let e=1;e<l;e++)p.enableVertexAttribArray(f+e),p.vertexAttribPointer(f+e,l,s,c,a,o+a*e/l),u>0&&(t.instancingExtension?t.instancingExtension.vertexAttribDivisorANGLE(f+e,1):p.vertexAttribDivisor(f+e,1));return!0},e.removeAttributeArray=n=>{if(!e.isReady()||0===t.handleProgram)return!1;if(!t.supported)for(let e=0;e<t.buffers.length;++e){const r=t.buffers[e];for(let i=0;i<r.attributes.length;++i)if(r.attributes[i].name===n)return r.attributes.splice(i,1),r.attributes.length||t.buffers.splice(e,1),!0}return!0},e.setOpenGLRenderWindow=n=>{t._openGLRenderWindow!==n&&(e.releaseGraphicsResources(),t._openGLRenderWindow=n,t.context=null,n&&(t.context=t._openGLRenderWindow.getContext()))}}(e,t)}var s={newInstance:r.m.newInstance(a,"vtkOpenGLVertexArrayObject"),extend:a}},88691:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c,c9:()=>a});var r=n(28906),i=n(84784);const o=Object.create(null);function a(e,t){o[e]=t}const s={};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),t.overrides=o,i.Ay.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkOpenGLViewNodeFactory")}(0,t)}var c={newInstance:r.m.newInstance(l,"vtkOpenGLViewNodeFactory"),extend:l}},8126:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(3823),i=n(28906),o=n(25196),a=n(88691);const s={};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),o.A.extend(e,t,n),t.keyMatrixTime={},(0,i.o)(t.keyMatrixTime,{mtime:0}),t.normalMatrix=new Float64Array(9),t.MCWCMatrix=new Float64Array(16),(0,i.e)(e,t,["context"]),function(e,t){t.classHierarchy.push("vtkOpenGLVolume"),e.buildPass=n=>{t.renderable&&t.renderable.getVisibility()&&n&&(t._openGLRenderWindow=e.getLastAncestorOfType("vtkOpenGLRenderWindow"),t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer"),t.context=t._openGLRenderWindow.getContext(),e.prepareNodes(),e.addMissingNode(t.renderable.getMapper()),e.removeUnusedNodes())},e.queryPass=(e,n)=>{if(e){if(!t.renderable||!t.renderable.getVisibility())return;n.incrementVolumeCount()}},e.traverseVolumePass=n=>{t.renderable&&t.renderable.getNestedVisibility()&&(!t._openGLRenderer.getSelector()||t.renderable.getNestedPickable())&&(e.apply(n,!0),t.children[0].traverse(n),e.apply(n,!1))},e.volumePass=e=>{t.renderable&&t.renderable.getVisibility()&&t.context.depthMask(!e)},e.getKeyMatrices=()=>(t.renderable.getMTime()>t.keyMatrixTime.getMTime()&&(t.renderable.computeMatrix(),r.pB.copy(t.MCWCMatrix,t.renderable.getMatrix()),r.pB.transpose(t.MCWCMatrix,t.MCWCMatrix),t.renderable.getIsIdentity()?r.w0.identity(t.normalMatrix):(r.w0.fromMat4(t.normalMatrix,t.MCWCMatrix),r.w0.invert(t.normalMatrix,t.normalMatrix),r.w0.transpose(t.normalMatrix,t.normalMatrix)),t.keyMatrixTime.modified()),{mcwc:t.MCWCMatrix,normalMatrix:t.normalMatrix})}(e,t)}const c=(0,i.n)(l,"vtkOpenGLVolume");var u={newInstance:c,extend:l};(0,a.c9)("vtkVolume",c)},95785:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>P});var r=n(28906),i=n(45043),o=n.n(i),a=n(3823),s=n(42008),l=n(28914),c=n(71650),u=n(16632),d=n(32821),p=n(79525),f=n(83534),h=n(18713),m=n(13926),g=n(25196),v=n(71995),y=n(52271),b=n(20433),x=n(67737),A=n(90919),C="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkPolyDataVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n\nattribute vec4 vertexDC;\n\nvarying vec3 vertexVCVSOutput;\nuniform mat4 PCVCMatrix;\n\nuniform float dcxmin;\nuniform float dcxmax;\nuniform float dcymin;\nuniform float dcymax;\n\nvoid main()\n{\n  // dcsmall is the device coords reduced to the\n  // x y area covered by the volume\n  vec4 dcsmall = vec4(\n    dcxmin + 0.5 * (vertexDC.x + 1.0) * (dcxmax - dcxmin),\n    dcymin + 0.5 * (vertexDC.y + 1.0) * (dcymax - dcymin),\n    vertexDC.z,\n    vertexDC.w);\n  vec4 vcpos = PCVCMatrix * dcsmall;\n  vertexVCVSOutput = vcpos.xyz/vcpos.w;\n  gl_Position = dcsmall;\n}\n",T="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkVolumeFS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// Template for the volume mappers fragment shader\n\n// the output of this shader\n//VTK::Output::Dec\n\nvarying vec3 vertexVCVSOutput;\n\n// first declare the settings from the mapper\n// that impact the code paths in here\n\n// always set vtkNumComponents 1,2,3,4\n//VTK::NumComponents\n\n// possibly define vtkTrilinearOn\n//VTK::TrilinearOn\n\n// possibly define UseIndependentComponents\n//VTK::IndependentComponentsOn\n\n// possibly define vtkCustomComponentsColorMix\n//VTK::CustomComponentsColorMixOn\n\n// possibly define any \"proportional\" components\n//VTK::vtkProportionalComponents\n\n// possibly define any components that are forced to nearest interpolation\n//VTK::vtkForceNearestComponents\n\n// Define the blend mode to use\n#define vtkBlendMode //VTK::BlendMode\n\n// Possibly define vtkImageLabelOutlineOn\n//VTK::ImageLabelOutlineOn\n\n// Possibly define vtkLabelEdgeProjectionOn\n//VTK::LabelEdgeProjectionOn\n\n\n#ifdef vtkImageLabelOutlineOn\n  uniform float outlineOpacity;\n  uniform float vpWidth;\n  uniform float vpHeight;\n  uniform float vpOffsetX;\n  uniform float vpOffsetY;\n  uniform mat4 PCWCMatrix;\n  uniform mat4 vWCtoIDX;\n\n  const int MAX_SEGMENT_INDEX = 256; // Define as per expected maximum\n  // bool seenSegmentsByOriginalPos[MAX_SEGMENT_INDEX];\n  #define MAX_SEGMENTS 256\n  #define UINT_SIZE 32\n  #define BITMASK_SIZE ((MAX_SEGMENTS + UINT_SIZE - 1) / UINT_SIZE)\n\n  uint bitmask[BITMASK_SIZE];\n\n  // Set the corresponding bit in the bitmask\n  void setBit(int segmentIndex) {\n    int index = segmentIndex / UINT_SIZE;\n    int bitIndex = segmentIndex % UINT_SIZE;\n    bitmask[index] |= 1u << bitIndex;\n  }\n\n  // Check if a bit is set in the bitmask\n  bool isBitSet(int segmentIndex) {\n    int index = segmentIndex / UINT_SIZE;\n    int bitIndex = segmentIndex % UINT_SIZE;\n    return ((bitmask[index] & (1u << bitIndex)) != 0u);\n  }\n#endif\n\n// define vtkLightComplexity\n//VTK::LightComplexity\n#if vtkLightComplexity > 0\nuniform float vSpecularPower;\nuniform float vAmbient;\nuniform float vDiffuse;\nuniform float vSpecular;\n//VTK::Light::Dec\n#endif\n\n//VTK::VolumeShadowOn\n//VTK::SurfaceShadowOn\n//VTK::localAmbientOcclusionOn\n//VTK::LAO::Dec\n//VTK::VolumeShadow::Dec\n\n// define vtkComputeNormalFromOpacity\n//VTK::vtkComputeNormalFromOpacity\n\n// possibly define vtkGradientOpacityOn\n//VTK::GradientOpacityOn\n#ifdef vtkGradientOpacityOn\nuniform float goscale0;\nuniform float goshift0;\nuniform float gomin0;\nuniform float gomax0;\n#ifdef UseIndependentComponents\n#if vtkNumComponents > 1\nuniform float goscale1;\nuniform float goshift1;\nuniform float gomin1;\nuniform float gomax1;\n#if vtkNumComponents > 2\nuniform float goscale2;\nuniform float goshift2;\nuniform float gomin2;\nuniform float gomax2;\n#if vtkNumComponents > 3\nuniform float goscale3;\nuniform float goshift3;\nuniform float gomin3;\nuniform float gomax3;\n#endif\n#endif\n#endif\n#endif\n#endif\n\n// if you want to see the raw tiled\n// data in webgl1 uncomment the following line\n// #define debugtile\n\n// camera values\nuniform float camThick;\nuniform float camNear;\nuniform float camFar;\nuniform int cameraParallel;\n\n// values describing the volume geometry\nuniform vec3 vOriginVC;\nuniform vec3 vSpacing;\nuniform ivec3 volumeDimensions; // 3d texture dimensions\nuniform vec3 vPlaneNormal0;\nuniform float vPlaneDistance0;\nuniform vec3 vPlaneNormal1;\nuniform float vPlaneDistance1;\nuniform vec3 vPlaneNormal2;\nuniform float vPlaneDistance2;\nuniform vec3 vPlaneNormal3;\nuniform float vPlaneDistance3;\nuniform vec3 vPlaneNormal4;\nuniform float vPlaneDistance4;\nuniform vec3 vPlaneNormal5;\nuniform float vPlaneDistance5;\n\n//VTK::ClipPlane::Dec\n\n// opacity and color textures\nuniform sampler2D otexture;\nuniform float oshift0;\nuniform float oscale0;\nuniform sampler2D ctexture;\nuniform float cshift0;\nuniform float cscale0;\n\n#if vtkNumComponents >= 2\nuniform float oshift1;\nuniform float oscale1;\nuniform float cshift1;\nuniform float cscale1;\n#endif\n#if vtkNumComponents >= 3\nuniform float oshift2;\nuniform float oscale2;\nuniform float cshift2;\nuniform float cscale2;\n#endif\n#if vtkNumComponents >= 4\nuniform float oshift3;\nuniform float oscale3;\nuniform float cshift3;\nuniform float cscale3;\n#endif\n\n// jitter texture\nuniform sampler2D jtexture;\nuniform sampler2D ttexture;\n\n\n// some 3D texture values\nuniform float sampleDistance;\nuniform vec3 vVCToIJK;\nuniform vec3 volumeSpacings; // spacing in the world coorindates\n\n\n// the heights defined below are the locations\n// for the up to four components of the tfuns\n// the tfuns have a height of 2XnumComps pixels so the\n// values are computed to hit the middle of the two rows\n// for that component\n#ifdef UseIndependentComponents\n#if vtkNumComponents == 1\nuniform float mix0;\n#define height0 0.5\n#endif\n#if vtkNumComponents == 2\nuniform float mix0;\nuniform float mix1;\n#define height0 0.25\n#define height1 0.75\n#endif\n#if vtkNumComponents == 3\nuniform float mix0;\nuniform float mix1;\nuniform float mix2;\n#define height0 0.17\n#define height1 0.5\n#define height2 0.83\n#endif\n#if vtkNumComponents == 4\nuniform float mix0;\nuniform float mix1;\nuniform float mix2;\nuniform float mix3;\n#define height0 0.125\n#define height1 0.375\n#define height2 0.625\n#define height3 0.875\n#endif\n#endif\n\nuniform vec4 ipScalarRangeMin;\nuniform vec4 ipScalarRangeMax;\n\n// declaration for intermixed geometry\n//VTK::ZBuffer::Dec\n\n//=======================================================================\n// global and custom variables (a temporary section before photorealistics rendering module is complete)\nvec3 rayDirVC;\nfloat sampleDistanceISVS;\nfloat sampleDistanceIS;\n\n#define SQRT3    1.7321\n#define INV4PI   0.0796\n#define EPSILON  0.001\n#define PI       3.1415\n#define PI2      9.8696\n\n//=======================================================================\n// Webgl2 specific version of functions\n#if __VERSION__ == 300\n\nuniform highp sampler3D texture1;\n\nvec4 getTextureValue(vec3 pos)\n{\n  vec4 tmp = texture(texture1, pos);\n\n  #if defined(vtkComponent0ForceNearest) || \\\n      defined(vtkComponent1ForceNearest) || \\\n      defined(vtkComponent2ForceNearest) || \\\n      defined(vtkComponent3ForceNearest)\n    vec3 nearestPos = (floor(pos * vec3(volumeDimensions)) + 0.5) / vec3(volumeDimensions);\n    vec4 nearestValue = texture(texture1, nearestPos);\n    #ifdef vtkComponent0ForceNearest\n      tmp[0] = nearestValue[0];\n    #endif\n    #ifdef vtkComponent1ForceNearest\n      tmp[1] = nearestValue[1];\n    #endif\n    #ifdef vtkComponent2ForceNearest\n      tmp[2] = nearestValue[2];\n    #endif\n    #ifdef vtkComponent3ForceNearest\n      tmp[3] = nearestValue[3];\n    #endif\n  #endif\n\n  #ifndef UseIndependentComponents\n    #if vtkNumComponents == 1\n      tmp.a = tmp.r;\n    #endif\n    #if vtkNumComponents == 2\n      tmp.a = tmp.g;\n    #endif\n    #if vtkNumComponents == 3\n      tmp.a = length(tmp.rgb);\n    #endif\n  #endif\n\n  return tmp;\n}\n\n//=======================================================================\n// WebGL1 specific version of functions\n#else\n\nuniform sampler2D texture1;\n\nuniform float texWidth;\nuniform float texHeight;\nuniform int xreps;\nuniform int xstride;\nuniform int ystride;\n\n// if computing trilinear values from multiple z slices\n#ifdef vtkTrilinearOn\nvec4 getTextureValue(vec3 ijk)\n{\n  float zoff = 1.0/float(volumeDimensions.z);\n  vec4 val1 = getOneTextureValue(ijk);\n  vec4 val2 = getOneTextureValue(vec3(ijk.xy, ijk.z + zoff));\n\n  float indexZ = float(volumeDimensions)*ijk.z;\n  float zmix =  indexZ - floor(indexZ);\n\n  return mix(val1, val2, zmix);\n}\n\nvec4 getOneTextureValue(vec3 ijk)\n#else // nearest or fast linear\nvec4 getTextureValue(vec3 ijk)\n#endif\n{\n  vec3 tdims = vec3(volumeDimensions);\n\n#ifdef debugtile\n  vec2 tpos = vec2(ijk.x, ijk.y);\n  vec4 tmp = texture2D(texture1, tpos);\n  tmp.a = 1.0;\n\n#else\n  int z = int(ijk.z * tdims.z);\n  int yz = z / xreps;\n  int xz = z - yz*xreps;\n\n  int tileWidth = volumeDimensions.x/xstride;\n  int tileHeight = volumeDimensions.y/ystride;\n\n  xz *= tileWidth;\n  yz *= tileHeight;\n\n  float ni = float(xz) + (ijk.x*float(tileWidth));\n  float nj = float(yz) + (ijk.y*float(tileHeight));\n\n  vec2 tpos = vec2(ni/texWidth, nj/texHeight);\n\n  vec4 tmp = texture2D(texture1, tpos);\n\n#if vtkNumComponents == 1\n  tmp.a = tmp.r;\n#endif\n#if vtkNumComponents == 2\n  tmp.g = tmp.a;\n#endif\n#if vtkNumComponents == 3\n  tmp.a = length(tmp.rgb);\n#endif\n#endif\n\n  return tmp;\n}\n\n// End of Webgl1 specific code\n//=======================================================================\n#endif\n\n//=======================================================================\n// transformation between VC and IS space\n\n// convert vector position from idx to vc\n#if (vtkLightComplexity > 0) || (defined vtkClippingPlanesOn)\nvec3 IStoVC(vec3 posIS){\n  vec3 posVC = posIS / vVCToIJK;\n  return posVC.x * vPlaneNormal0 +\n         posVC.y * vPlaneNormal2 +\n         posVC.z * vPlaneNormal4 +\n         vOriginVC;\n}\n\n// convert vector position from vc to idx\nvec3 VCtoIS(vec3 posVC){\n  posVC = posVC - vOriginVC;\n  posVC = vec3(\n    dot(posVC, vPlaneNormal0),\n    dot(posVC, vPlaneNormal2),\n    dot(posVC, vPlaneNormal4));\n  return posVC * vVCToIJK;\n}\n#endif\n\n//Rotate vector to view coordinate\n#if (vtkLightComplexity > 0) || (defined vtkGradientOpacityOn)\nvoid rotateToViewCoord(inout vec3 dirIS){\n  dirIS.xyz =\n    dirIS.x * vPlaneNormal0 +\n    dirIS.y * vPlaneNormal2 +\n    dirIS.z * vPlaneNormal4;\n}\n\n//Rotate vector to idx coordinate\nvec3 rotateToIDX(vec3 dirVC){\n  vec3 dirIS;\n  dirIS.xyz = vec3(\n    dot(dirVC, vPlaneNormal0),\n    dot(dirVC, vPlaneNormal2),\n    dot(dirVC, vPlaneNormal4));\n  return dirIS;\n}\n#endif\n\n//=======================================================================\n// Given a normal compute the gradient opacity factors\nfloat computeGradientOpacityFactor(\n  float normalMag, float goscale, float goshift, float gomin, float gomax)\n{\n  return clamp(normalMag * goscale + goshift, gomin, gomax);\n}\n\n//=======================================================================\n// compute the normal and gradient magnitude for a position, uses forward difference\n#if (vtkLightComplexity > 0) || (defined vtkGradientOpacityOn)\n  #ifdef vtkClippingPlanesOn\n    void adjustClippedVoxelValues(vec3 pos, vec3 texPos[3], inout vec3 g1)\n    {\n      vec3 g1VC[3];\n      for (int i = 0; i < 3; ++i)\n      {\n        g1VC[i] = IStoVC(texPos[i]);\n      }\n      vec3 posVC = IStoVC(pos);\n      for (int i = 0; i < clip_numPlanes; ++i)\n      {\n        for (int j = 0; j < 3; ++j)\n        {\n          if(dot(vec3(vClipPlaneOrigins[i] - g1VC[j].xyz), vClipPlaneNormals[i]) > 0.0)\n          {\n            g1[j] = 0.0;\n          }\n        }\n      }\n    }\n  #endif\n\n  #ifdef vtkComputeNormalFromOpacity\n    vec4 computeDensityNormal(vec3 opacityUCoords[2], float opactityTextureHeight, float gradientOpacity) {\n      vec3 opacityG1, opacityG2;\n      opacityG1.x = texture2D(otexture, vec2(opacityUCoords[0].x, opactityTextureHeight)).r;\n      opacityG1.y = texture2D(otexture, vec2(opacityUCoords[0].y, opactityTextureHeight)).r;\n      opacityG1.z = texture2D(otexture, vec2(opacityUCoords[0].z, opactityTextureHeight)).r;\n      opacityG2.x = texture2D(otexture, vec2(opacityUCoords[1].x, opactityTextureHeight)).r;\n      opacityG2.y = texture2D(otexture, vec2(opacityUCoords[1].y, opactityTextureHeight)).r;\n      opacityG2.z = texture2D(otexture, vec2(opacityUCoords[1].z, opactityTextureHeight)).r;\n      opacityG1.xyz *= gradientOpacity;\n      opacityG2.xyz *= gradientOpacity;\n\n      vec4 opacityG = vec4(opacityG1 - opacityG2, 1.0f);\n      // divide by spacing\n      opacityG.xyz /= vSpacing;\n      opacityG.w = length(opacityG.xyz);\n      // rotate to View Coords\n      rotateToViewCoord(opacityG.xyz);\n      if (!all(equal(opacityG.xyz, vec3(0.0)))) {\n        return vec4(normalize(opacityG.xyz),opacityG.w);\n      } else {\n        return vec4(0.0);\n      }\n    }\n\n    vec4 computeNormalForDensity(vec3 pos, vec3 tstep, out vec3 scalarInterp[2], const int opacityComponent)\n    {\n      vec3 xvec = vec3(tstep.x, 0.0, 0.0);\n      vec3 yvec = vec3(0.0, tstep.y, 0.0);\n      vec3 zvec = vec3(0.0, 0.0, tstep.z);\n      vec3 texPosPVec[3];\n      texPosPVec[0] = pos + xvec;\n      texPosPVec[1] = pos + yvec;\n      texPosPVec[2] = pos + zvec;\n      vec3 texPosNVec[3];\n      texPosNVec[0] = pos - xvec;\n      texPosNVec[1] = pos - yvec;\n      texPosNVec[2] = pos - zvec;\n      vec3 g1, g2;\n\n      scalarInterp[0].x = getTextureValue(texPosPVec[0])[opacityComponent];\n      scalarInterp[0].y = getTextureValue(texPosPVec[1])[opacityComponent];\n      scalarInterp[0].z = getTextureValue(texPosPVec[2])[opacityComponent];\n      scalarInterp[1].x = getTextureValue(texPosNVec[0])[opacityComponent];\n      scalarInterp[1].y = getTextureValue(texPosNVec[1])[opacityComponent];\n      scalarInterp[1].z = getTextureValue(texPosNVec[2])[opacityComponent];\n\n      #ifdef vtkClippingPlanesOn\n        adjustClippedVoxelValues(pos, texPosPVec, scalarInterp[0]);\n        adjustClippedVoxelValues(pos, texPosNVec, scalarInterp[1]);\n      #endif\n      vec4 result;\n      result.x = scalarInterp[0].x - scalarInterp[1].x;\n      result.y = scalarInterp[0].y - scalarInterp[1].y;\n      result.z = scalarInterp[0].z - scalarInterp[1].z;\n      // divide by spacing\n      result.xyz /= vSpacing;\n      result.w = length(result.xyz);\n      // rotate to View Coords\n      rotateToViewCoord(result.xyz);\n      if (length(result.xyz) > 0.0) {\n        return vec4(normalize(result.xyz),result.w);\n      } else {\n        return vec4(0.0);\n      }\n    }\n  #endif\n\n  // only works with dependent components\n  vec4 computeNormal(vec3 pos, vec3 tstep)\n  {\n    vec3 xvec = vec3(tstep.x, 0.0, 0.0);\n    vec3 yvec = vec3(0.0, tstep.y, 0.0);\n    vec3 zvec = vec3(0.0, 0.0, tstep.z);\n    vec3 texPosPVec[3];\n    texPosPVec[0] = pos + xvec;\n    texPosPVec[1] = pos + yvec;\n    texPosPVec[2] = pos + zvec;\n    vec3 texPosNVec[3];\n    texPosNVec[0] = pos - xvec;\n    texPosNVec[1] = pos - yvec;\n    texPosNVec[2] = pos - zvec;\n    vec3 g1, g2;\n    g1.x = getTextureValue(texPosPVec[0]).a;\n    g1.y = getTextureValue(texPosPVec[1]).a;\n    g1.z = getTextureValue(texPosPVec[2]).a;\n    g2.x = getTextureValue(texPosNVec[0]).a;\n    g2.y = getTextureValue(texPosNVec[1]).a;\n    g2.z = getTextureValue(texPosNVec[2]).a;\n    #ifdef vtkClippingPlanesOn\n      adjustClippedVoxelValues(pos, texPosPVec, g1);\n      adjustClippedVoxelValues(pos, texPosNVec, g2);\n    #endif\n    vec4 result;\n    result = vec4(g1 - g2, -1.0);\n    // divide by spacing\n    result.xyz /= vSpacing;\n    result.w = length(result.xyz);\n    if (result.w > 0.0){\n      // rotate to View Coords\n      rotateToViewCoord(result.xyz);\n      return vec4(normalize(result.xyz),result.w);\n    } else {\n      return vec4(0.0);\n    }\n  }\n#endif\n\n\n#ifdef vtkImageLabelOutlineOn\n  vec4 fragCoordToPCPos(vec4 fragCoord) {\n    return vec4(\n      (fragCoord.x / vpWidth - vpOffsetX - 0.5) * 2.0,\n      (fragCoord.y / vpHeight - vpOffsetY - 0.5) * 2.0,\n      (fragCoord.z - 0.5) * 2.0,\n      1.0);\n  }\n\n  vec4 pcPosToWorldCoord(vec4 pcPos) {\n    return PCWCMatrix * pcPos;\n  }\n\n  vec3 fragCoordToIndexSpace(vec4 fragCoord) {\n    vec4 pcPos = fragCoordToPCPos(fragCoord);\n    vec4 worldCoord = pcPosToWorldCoord(pcPos);\n    vec4 vertex = (worldCoord / worldCoord.w);\n\n    vec3 index = (vWCtoIDX * vertex).xyz;\n\n    // half voxel fix for labelmapOutline\n    return (index + vec3(0.5)) / vec3(volumeDimensions);\n  }\n\n  vec3 fragCoordToWorld(vec4 fragCoord) {\n    vec4 pcPos = fragCoordToPCPos(fragCoord);\n    vec4 worldCoord = pcPosToWorldCoord(pcPos);\n    return worldCoord.xyz;\n  }\n#endif\n\n//=======================================================================\n// compute the normals and gradient magnitudes for a position\n// for independent components\nmat4 computeMat4Normal(vec3 pos, vec4 tValue, vec3 tstep)\n{\n  mat4 result;\n  vec4 distX = getTextureValue(pos + vec3(tstep.x, 0.0, 0.0)) - tValue;\n  vec4 distY = getTextureValue(pos + vec3(0.0, tstep.y, 0.0)) - tValue;\n  vec4 distZ = getTextureValue(pos + vec3(0.0, 0.0, tstep.z)) - tValue;\n\n  // divide by spacing\n  distX /= vSpacing.x;\n  distY /= vSpacing.y;\n  distZ /= vSpacing.z;\n\n  mat3 rot;\n  rot[0] = vPlaneNormal0;\n  rot[1] = vPlaneNormal2;\n  rot[2] = vPlaneNormal4;\n\n#if !defined(vtkComponent0Proportional)\n  result[0].xyz = vec3(distX.r, distY.r, distZ.r);\n  result[0].a = length(result[0].xyz);\n  result[0].xyz *= rot;\n  if (result[0].w > 0.0)\n  {\n    result[0].xyz /= result[0].w;\n  }\n#endif\n\n// optionally compute the 2nd component\n#if vtkNumComponents >= 2 && !defined(vtkComponent1Proportional)\n  result[1].xyz = vec3(distX.g, distY.g, distZ.g);\n  result[1].a = length(result[1].xyz);\n  result[1].xyz *= rot;\n  if (result[1].w > 0.0)\n  {\n    result[1].xyz /= result[1].w;\n  }\n#endif\n\n// optionally compute the 3rd component\n#if vtkNumComponents >= 3 && !defined(vtkComponent2Proportional)\n  result[2].xyz = vec3(distX.b, distY.b, distZ.b);\n  result[2].a = length(result[2].xyz);\n  result[2].xyz *= rot;\n  if (result[2].w > 0.0)\n  {\n    result[2].xyz /= result[2].w;\n  }\n#endif\n\n// optionally compute the 4th component\n#if vtkNumComponents >= 4 && !defined(vtkComponent3Proportional)\n  result[3].xyz = vec3(distX.a, distY.a, distZ.a);\n  result[3].a = length(result[3].xyz);\n  result[3].xyz *= rot;\n  if (result[3].w > 0.0)\n  {\n    result[3].xyz /= result[3].w;\n  }\n#endif\n\n  return result;\n}\n\n//=======================================================================\n// global shadow - secondary ray\n#if defined(VolumeShadowOn) || defined(localAmbientOcclusionOn)\nfloat random()\n{\n  float rand = fract(sin(dot(gl_FragCoord.xy,vec2(12.9898,78.233)))*43758.5453123);\n  float jitter=texture2D(jtexture,gl_FragCoord.xy/32.).r;\n  uint pcg_state = floatBitsToUint(jitter);\n  uint state = pcg_state;\n  pcg_state = pcg_state * uint(747796405) + uint(2891336453);\n  uint word = ((state >> ((state >> uint(28)) + uint(4))) ^ state) * uint(277803737);\n  return (float((((word >> uint(22)) ^ word) >> 1 ))/float(2147483647) + rand)/2.0;\n}\n#endif\n\n#ifdef VolumeShadowOn\n// henyey greenstein phase function\nfloat phase_function(float cos_angle)\n{\n  // divide by 2.0 instead of 4pi to increase intensity\n  return ((1.0-anisotropy2)/pow(1.0+anisotropy2-2.0*anisotropy*cos_angle, 1.5))/2.0;\n}\n\n// Computes the intersection between a ray and a box\nstruct Hit\n{\n  float tmin;\n  float tmax;\n};\n\nstruct Ray\n{\n  vec3 origin;\n  vec3 dir;\n  vec3 invDir;\n};\n\nbool BBoxIntersect(vec3 boundMin, vec3 boundMax, const Ray r, out Hit hit)\n{\n  vec3 tbot = r.invDir * (boundMin - r.origin);\n  vec3 ttop = r.invDir * (boundMax - r.origin);\n  vec3 tmin = min(ttop, tbot);\n  vec3 tmax = max(ttop, tbot);\n  vec2 t = max(tmin.xx, tmin.yz);\n  float t0 = max(t.x, t.y);\n  t = min(tmax.xx, tmax.yz);\n  float t1 = min(t.x, t.y);\n  hit.tmin = t0;\n  hit.tmax = t1;\n  return t1 > max(t0,0.0);\n}\n\n// As BBoxIntersect requires the inverse of the ray coords,\n// this function is used to avoid numerical issues\nvoid safe_0_vector(inout Ray ray)\n{\n  if(abs(ray.dir.x) < EPSILON) ray.dir.x = sign(ray.dir.x) * EPSILON;\n  if(abs(ray.dir.y) < EPSILON) ray.dir.y = sign(ray.dir.y) * EPSILON;\n  if(abs(ray.dir.z) < EPSILON) ray.dir.z = sign(ray.dir.z) * EPSILON;\n}\n\nfloat volume_shadow(vec3 posIS, vec3 lightDirNormIS)\n{\n  float shadow = 1.0;\n  float opacity = 0.0;\n\n  // modify sample distance with a random number between 1.5 and 3.0\n  float sampleDistanceISVS_jitter = sampleDistanceISVS * mix(1.5, 3.0, random());\n  float opacityPrev = texture2D(otexture, vec2(getTextureValue(posIS).r * oscale0 + oshift0, 0.5)).r;\n\n  // in case the first sample near surface has a very tiled light ray, we need to offset start position\n  posIS += sampleDistanceISVS_jitter * lightDirNormIS;\n\n  // compute the start and end points for the ray\n  Ray ray;\n  Hit hit;\n  ray.origin = posIS;\n  ray.dir = lightDirNormIS;\n  safe_0_vector(ray);\n  ray.invDir = 1.0/ray.dir;\n\n  if(!BBoxIntersect(vec3(0.0),vec3(1.0), ray, hit))\n  {\n    return 1.0;\n  }\n  float maxdist = hit.tmax;\n\n  // interpolate shadow ray length between: 1 unit of sample distance in IS to SQRT3, based on globalIlluminationReach\n  float maxgi = mix(sampleDistanceISVS_jitter,SQRT3,giReach);\n  maxdist = min(maxdist,maxgi);\n  if(maxdist < EPSILON) {\n    return 1.0;\n  }\n\n  float current_dist = 0.0;\n  float current_step = length(sampleDistanceISVS_jitter * lightDirNormIS);\n  float clamped_step = 0.0;\n\n  vec4 scalar = vec4(0.0);\n  while(current_dist < maxdist)\n  {\n#ifdef vtkClippingPlanesOn\n    vec3 posVC = IStoVC(posIS);\n    for (int i = 0; i < clip_numPlanes; ++i)\n    {\n      if (dot(vec3(vClipPlaneOrigins[i] - posVC), vClipPlaneNormals[i]) > 0.0)\n      {\n        current_dist = maxdist;\n      }\n    }\n#endif\n    scalar = getTextureValue(posIS);\n    opacity = texture2D(otexture, vec2(scalar.r * oscale0 + oshift0, 0.5)).r;\n    #if defined(vtkGradientOpacityOn) && !defined(UseIndependentComponents)\n      vec4 normal = computeNormal(posIS, vec3(1.0/vec3(volumeDimensions)));\n      opacity *= computeGradientOpacityFactor(normal.w, goscale0, goshift0, gomin0, gomax0);\n    #endif\n    shadow *= 1.0 - opacity;\n\n    // optimization: early termination\n    if (shadow < EPSILON){\n      return 0.0;\n    }\n\n    clamped_step = min(maxdist - current_dist, current_step);\n    posIS += clamped_step * lightDirNormIS;\n    current_dist += current_step;\n  }\n\n  return shadow;\n}\n\nvec3 applyShadowRay(vec3 tColor, vec3 posIS, vec3 viewDirectionVC)\n{\n  vec3 vertLight = vec3(0.0);\n  vec3 secondary_contrib = vec3(0.0);\n  // here we assume only positional light, no effect of cones\n  for (int i = 0; i < lightNum; i++)\n  {\n    #if(vtkLightComplexity==3)\n      if (lightPositional[i] == 1){\n        vertLight = lightPositionVC[i] - IStoVC(posIS);\n      }else{\n        vertLight = - lightDirectionVC[i];\n      }\n    #else\n      vertLight = - lightDirectionVC[i];\n    #endif\n    // here we assume achromatic light, only intensity\n    float dDotL = dot(viewDirectionVC, normalize(vertLight));\n    // isotropic scatter returns 0.5 instead of 1/4pi to increase intensity\n    float phase_attenuation = 0.5;\n    if (abs(anisotropy) > EPSILON){\n      phase_attenuation = phase_function(dDotL);\n    }\n    float vol_shadow = volume_shadow(posIS, normalize(rotateToIDX(vertLight)));\n    secondary_contrib += tColor * vDiffuse * lightColor[i] * vol_shadow * phase_attenuation;\n    secondary_contrib += tColor * vAmbient;\n  }\n  return secondary_contrib;\n}\n#endif\n\n//=======================================================================\n// local ambient occlusion\n#ifdef localAmbientOcclusionOn\nvec3 sample_direction_uniform(int i)\n{\n  float rand = random() * 0.5;\n  float theta = PI2 * (kernelSample[i][0] + rand);\n  float phi = acos(2.0 * (kernelSample[i][1] + rand) -1.0) / 2.5;\n  return normalize(vec3(cos(theta)*sin(phi), sin(theta)*sin(phi), cos(phi)));\n}\n\n// return a matrix that transform startDir into z axis; startDir should be normalized\nmat3 zBaseRotationalMatrix(vec3 startDir){\n  vec3 axis = cross(startDir, vec3(0.0,0.0,1.0));\n  float cosA = startDir.z;\n  float k = 1.0 / (1.0 + cosA);\n  mat3 matrix = mat3((axis.x * axis.x * k) + cosA, (axis.y * axis.x * k) - axis.z, (axis.z * axis.x * k) + axis.y,\n              (axis.x * axis.y * k) + axis.z, (axis.y * axis.y * k) + cosA, (axis.z * axis.y * k) - axis.x,\n              (axis.x * axis.z * k) - axis.y, (axis.y * axis.z * k) + axis.x, (axis.z * axis.z * k) + cosA);\n  return matrix;\n}\n\nfloat computeLAO(vec3 posIS, float op, vec3 lightDir, vec4 normal){\n  // apply LAO only at selected locations, otherwise return full brightness\n  if (normal.w > 0.0 && op > 0.05){\n    float total_transmittance = 0.0;\n    mat3 inverseRotateBasis = inverse(zBaseRotationalMatrix(normalize(-normal.xyz)));\n    vec3 currPos, randomDirStep;\n    float weight, transmittance, opacity;\n    for (int i = 0; i < kernelSize; i++)\n    {\n      randomDirStep = inverseRotateBasis * sample_direction_uniform(i) * sampleDistanceIS;\n      weight = 1.0 - dot(normalize(lightDir), normalize(randomDirStep));\n      currPos = posIS;\n      transmittance = 1.0;\n      for (int j = 0; j < kernelRadius ; j++){\n        currPos += randomDirStep;\n        // check if it's at clipping plane, if so return full brightness\n        if (all(greaterThan(currPos, vec3(EPSILON))) && all(lessThan(currPos,vec3(1.0-EPSILON)))){\n          opacity = texture2D(otexture, vec2(getTextureValue(currPos).r * oscale0 + oshift0, 0.5)).r;\n          #ifdef vtkGradientOpacityOn\n             opacity *= computeGradientOpacityFactor(normal.w, goscale0, goshift0, gomin0, gomax0);\n          #endif\n          transmittance *= 1.0 - opacity;\n        }\n        else{\n          break;\n        }\n      }\n      total_transmittance += transmittance / float(kernelRadius) * weight;\n\n      // early termination if fully translucent\n      if (total_transmittance > 1.0 - EPSILON){\n        return 1.0;\n      }\n    }\n    // average transmittance and reduce variance\n    return clamp(total_transmittance / float(kernelSize), 0.3, 1.0);\n  } else {\n    return 1.0;\n  }\n}\n#endif\n\n//=======================================================================\n// surface light contribution\n#if vtkLightComplexity > 0\n  void applyLighting(inout vec3 tColor, vec4 normal)\n  {\n    vec3 diffuse = vec3(0.0, 0.0, 0.0);\n    vec3 specular = vec3(0.0, 0.0, 0.0);\n    float df, sf = 0.0;\n    for (int i = 0; i < lightNum; i++){\n        df = abs(dot(normal.rgb, -lightDirectionVC[i]));\n        diffuse += df * lightColor[i];\n        sf = pow( abs(dot(lightHalfAngleVC[i],normal.rgb)), vSpecularPower);\n        specular += sf * lightColor[i];\n    }\n    tColor.rgb = tColor.rgb*(diffuse*vDiffuse + vAmbient) + specular*vSpecular;\n  }\n  #ifdef SurfaceShadowOn\n  #if vtkLightComplexity < 3\n    vec3 applyLightingDirectional(vec3 posIS, vec4 tColor, vec4 normal)\n    {\n      // everything in VC\n      vec3 diffuse = vec3(0.0);\n      vec3 specular = vec3(0.0);\n      #ifdef localAmbientOcclusionOn\n        vec3 ambient = vec3(0.0);\n      #endif\n      vec3 vertLightDirection;\n      for (int i = 0; i < lightNum; i++){\n        float ndotL,vdotR;\n        vertLightDirection = lightDirectionVC[i];\n        ndotL = dot(normal.xyz, vertLightDirection);\n        if (ndotL < 0.0 && twoSidedLighting)\n        {\n          ndotL = -ndotL;\n        }\n        if (ndotL > 0.0)\n        {\n          diffuse += ndotL * lightColor[i];\n          //specular\n          vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));\n          if (vdotR > 0.0)\n          {\n            specular += pow(vdotR, vSpecularPower) * lightColor[i];\n          }\n        }\n        #ifdef localAmbientOcclusionOn\n            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);\n        #endif\n      }\n      #ifdef localAmbientOcclusionOn\n        return tColor.rgb * (diffuse * vDiffuse + vAmbient * ambient) + specular*vSpecular;\n      #else\n        return tColor.rgb * (diffuse * vDiffuse + vAmbient) + specular*vSpecular;\n      #endif\n    }\n  #else\n    vec3 applyLightingPositional(vec3 posIS, vec4 tColor, vec4 normal, vec3 posVC)\n    {\n      // everything in VC\n      vec3 diffuse = vec3(0.0);\n      vec3 specular = vec3(0.0);\n      #ifdef localAmbientOcclusionOn\n        vec3 ambient = vec3(0.0);\n      #endif\n      vec3 vertLightDirection;\n      for (int i = 0; i < lightNum; i++){\n        float distance,attenuation,ndotL,vdotR;\n        vec3 lightDir;\n        if (lightPositional[i] == 1){\n          lightDir = lightDirectionVC[i];\n          vertLightDirection = posVC - lightPositionVC[i];\n          distance = length(vertLightDirection);\n          vertLightDirection = normalize(vertLightDirection);\n          attenuation = 1.0 / (lightAttenuation[i].x\n                              + lightAttenuation[i].y * distance\n                              + lightAttenuation[i].z * distance * distance);\n          // per OpenGL standard cone angle is 90 or less for a spot light\n          if (lightConeAngle[i] <= 90.0){\n            float coneDot = dot(vertLightDirection, lightDir);\n            if (coneDot >= cos(radians(lightConeAngle[i]))){  // if inside cone\n              attenuation = attenuation * pow(coneDot, lightExponent[i]);\n            }\n            else {\n              attenuation = 0.0;\n            }\n          }\n          ndotL = dot(normal.xyz, vertLightDirection);\n          if (ndotL < 0.0 && twoSidedLighting)\n          {\n            ndotL = -ndotL;\n          }\n          if (ndotL > 0.0)\n          {\n            diffuse += ndotL * attenuation * lightColor[i];\n            //specular\n            vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));\n            if (vdotR > 0.0)\n            {\n              specular += pow(vdotR, vSpecularPower) * attenuation * lightColor[i];\n            }\n          }\n          #ifdef localAmbientOcclusionOn\n            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);\n          #endif\n        } else {\n          vertLightDirection = lightDirectionVC[i];\n          ndotL = dot(normal.xyz, vertLightDirection);\n          if (ndotL < 0.0 && twoSidedLighting)\n          {\n            ndotL = -ndotL;\n          }\n          if (ndotL > 0.0)\n          {\n            diffuse += ndotL * lightColor[i];\n            //specular\n            vdotR = dot(-rayDirVC, normalize(2.0 * ndotL * -normal.xyz + vertLightDirection));\n            if (vdotR > 0.0)\n            {\n              specular += pow(vdotR, vSpecularPower) * lightColor[i];\n            }\n          }\n          #ifdef localAmbientOcclusionOn\n            ambient += computeLAO(posIS, tColor.a, vertLightDirection, normal);\n          #endif\n        }\n      }\n      #ifdef localAmbientOcclusionOn\n        return tColor.rgb * (diffuse * vDiffuse + vAmbient * ambient) + specular*vSpecular;\n      #else\n        return tColor.rgb * (diffuse * vDiffuse + vAmbient) + specular*vSpecular;\n      #endif\n    }\n  #endif\n  #endif\n#endif\n\n// LAO of surface shadows and volume shadows only work with dependent components\nvec3 applyAllLightning(vec3 tColor, float alpha, vec3 posIS, vec4 normalLight) {\n  #if vtkLightComplexity > 0\n    // surface shadows if needed\n    #ifdef SurfaceShadowOn\n      #if vtkLightComplexity < 3\n        vec3 tColorS = applyLightingDirectional(posIS, vec4(tColor, alpha), normalLight);\n      #else\n        vec3 tColorS = applyLightingPositional(posIS, vec4(tColor, alpha), normalLight, IStoVC(posIS));\n      #endif\n    #endif\n\n    // volume shadows if needed\n    #ifdef VolumeShadowOn\n      vec3 tColorVS = applyShadowRay(tColor, posIS, rayDirVC);\n    #endif\n\n    // merge\n    #ifdef VolumeShadowOn\n      #ifdef SurfaceShadowOn\n        // surface shadows + volumetric shadows\n        float vol_coef = volumetricScatteringBlending * (1.0 - alpha / 2.0) * (1.0 - atan(normalLight.w) * INV4PI);\n        tColor = (1.0-vol_coef) * tColorS + vol_coef * tColorVS;\n      #else\n        // volumetric shadows only\n        tColor = tColorVS;\n      #endif\n    #else\n      #ifdef SurfaceShadowOn\n        // surface shadows only\n        tColor = tColorS;\n      #else\n        // no shadows\n        applyLighting(tColor, normal3);\n      #endif\n    #endif\n  #endif\n  return tColor;\n}\n\n  \nvec4 getColorForValue(vec4 tValue, vec3 posIS, vec3 tstep)\n{\n\n// If labeloutline and not the edge labelmap, since in the edge labelmap blend\n// we need the underlying data to sample through\n#if defined(vtkImageLabelOutlineOn) && !defined(vtkLabelEdgeProjectionOn)\n  vec3 centerPosIS = fragCoordToIndexSpace(gl_FragCoord); // pos in texture space\n  vec4 centerValue = getTextureValue(centerPosIS);\n  bool pixelOnBorder = false;\n  vec4 tColor = texture2D(ctexture, vec2(centerValue.r * cscale0 + cshift0, 0.5));\n\n  // Get alpha of segment from opacity function.\n  tColor.a = texture2D(otexture, vec2(centerValue.r * oscale0 + oshift0, 0.5)).r;\n\n  int segmentIndex = int(centerValue.r * 255.0);\n  \n  // Use texture sampling for outlineThickness\n  float textureCoordinate = float(segmentIndex - 1) / 1024.0;\n  float textureValue = texture2D(ttexture, vec2(textureCoordinate, 0.5)).r;\n\n  int actualThickness = int(textureValue * 255.0);\n\n\n  // If it is the background (segment index 0), we should quickly bail out. \n  // Previously, this was determined by tColor.a, which was incorrect as it\n  // prevented the outline from appearing when the fill is 0.\n  if (segmentIndex == 0){\n    return vec4(0, 0, 0, 0);\n  }\n\n  // Only perform outline check on fragments rendering voxels that aren't invisible.\n  // Saves a bunch of needless checks on the background.\n  // TODO define epsilon when building shader?\n  for (int i = -actualThickness; i <= actualThickness; i++) {\n    for (int j = -actualThickness; j <= actualThickness; j++) {\n      if (i == 0 || j == 0) {\n        continue;\n      }\n\n      vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i),\n        gl_FragCoord.y + float(j),\n        gl_FragCoord.z, gl_FragCoord.w);\n\n      vec3 neighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);\n      vec4 value = getTextureValue(neighborPosIS);\n\n      // If any of my neighbours are not the same value as I\n      // am, this means I am on the border of the segment.\n      // We can break the loops\n      if (any(notEqual(value, centerValue))) {\n        pixelOnBorder = true;\n        break;\n      }\n    }\n\n    if (pixelOnBorder == true) {\n      break;\n    }\n  }\n\n  // If I am on the border, I am displayed at full opacity\n  if (pixelOnBorder == true) {\n    tColor.a = outlineOpacity;\n  }\n\n  return tColor;\n\n#else\n  // compute the normal and gradient magnitude if needed\n  // We compute it as a vec4 if possible otherwise a mat4\n\n  #ifdef UseIndependentComponents\n\n    // sample textures\n    vec3 tColor0 = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, height0)).rgb;\n    float pwfValue0 = texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, height0)).r;\n\n    #if vtkNumComponents > 1\n      vec3 tColor1 = texture2D(ctexture, vec2(tValue.g * cscale1 + cshift1, height1)).rgb;\n      float pwfValue1 = texture2D(otexture, vec2(tValue.g * oscale1 + oshift1, height1)).r;\n\n      #if vtkNumComponents > 2\n        vec3 tColor2 = texture2D(ctexture, vec2(tValue.b * cscale2 + cshift2, height2)).rgb;\n        float pwfValue2 = texture2D(otexture, vec2(tValue.b * oscale2 + oshift2, height2)).r;\n\n        #if vtkNumComponents > 3\n          vec3 tColor3 = texture2D(ctexture, vec2(tValue.a * cscale3 + cshift3, height3)).rgb;\n          float pwfValue3 = texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, height3)).r;\n        #endif\n      #endif\n    #endif\n\n    #if !defined(vtkCustomComponentsColorMix)\n      // default path for component color mix\n\n      // compute the normal vectors as needed\n      #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)\n        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);\n      #endif\n\n      // compute gradient opacity factors as needed\n      vec4 goFactor = vec4(1.0, 1.0 ,1.0 ,1.0);\n      #if defined(vtkGradientOpacityOn)\n        #if !defined(vtkComponent0Proportional)\n          goFactor.x =\n            computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);\n        #endif\n        #if vtkNumComponents > 1\n          #if !defined(vtkComponent1Proportional)\n            goFactor.y =\n              computeGradientOpacityFactor(normalMat[1].a, goscale1, goshift1, gomin1, gomax1);\n          #endif\n          #if vtkNumComponents > 2\n            #if !defined(vtkComponent2Proportional)\n              goFactor.z =\n                computeGradientOpacityFactor(normalMat[2].a, goscale2, goshift2, gomin2, gomax2);\n            #endif\n            #if vtkNumComponents > 3\n              #if !defined(vtkComponent3Proportional)\n                goFactor.w =\n                  computeGradientOpacityFactor(normalMat[3].a, goscale3, goshift3, gomin3, gomax3);\n              #endif\n            #endif\n          #endif\n        #endif\n      #endif\n\n      // process color and opacity for each component\n      #if !defined(vtkComponent0Proportional)\n        float alpha = goFactor.x*mix0*pwfValue0;\n        #if vtkLightComplexity > 0\n          applyLighting(tColor0, normalMat[0]);\n        #endif\n      #else\n        tColor0 *= pwfValue0;\n        float alpha = mix(pwfValue0, 1.0, (1.0 - mix0));\n      #endif\n\n      #if vtkNumComponents > 1\n        #if !defined(vtkComponent1Proportional)\n          alpha += goFactor.y*mix1*pwfValue1;\n          #if vtkLightComplexity > 0\n            applyLighting(tColor1, normalMat[1]);\n          #endif\n        #else\n          tColor1 *= pwfValue1;\n          alpha *= mix(pwfValue1, 1.0, (1.0 - mix1));\n        #endif\n\n        #if vtkNumComponents > 2\n          #if !defined(vtkComponent2Proportional)\n            alpha += goFactor.z*mix2*pwfValue2;\n            #if vtkLightComplexity > 0\n              applyLighting(tColor2, normalMat[2]);\n            #endif\n          #else\n            tColor2 *= pwfValue2;\n            alpha *= mix(pwfValue2, 1.0, (1.0 - mix2));\n          #endif\n        #endif\n\n        #if vtkNumComponents > 3\n          #if !defined(vtkComponent3Proportional)\n            alpha += goFactor.w*mix3*pwfValue3;\n            #if vtkLightComplexity > 0\n              applyLighting(tColor3, normalMat[3]);\n            #endif\n          #else\n            tColor3 *= pwfValue3;\n            alpha *= mix(pwfValue3, 1.0, (1.0 - mix3));\n          #endif\n        #endif\n      #endif\n\n      // perform final independent blend\n      vec3 tColor = mix0 * tColor0;\n      #if vtkNumComponents > 1\n        tColor += mix1 * tColor1;\n        #if vtkNumComponents > 2\n          tColor += mix2 * tColor2;\n          #if vtkNumComponents > 3\n            tColor += mix3 * tColor3;\n          #endif\n        #endif\n      #endif\n\n      return vec4(tColor, alpha);\n    #else\n      /*\n       * Mix the color information from all the independent components to get a single rgba output\n       * Gradient opactity factors and normals are not computed\n       *\n       * You can compute these using:\n       * - computeMat4Normal: always available, compute normal only for non proportional components, used by default independent component mix\n       * - computeDensityNormal & computeNormalForDensity: available if ((LightComplexity > 0) || GradientOpacityOn) && ComputeNormalFromOpacity),\n       *                                                   used by dependent component color mix, see code for Additive preset in OpenGl/VolumeMapper\n       * - computeGradientOpacityFactor: always available, used in a lot of places\n       *\n       * Using applyAllLightning() is advised for shading but some features don't work well with it (volume shadows, LAO)\n       * mix0, mix1, ... are defined for each component that is used and correspond to the componentWeight\n       */\n      //VTK::CustomComponentsColorMix::Impl\n    #endif\n  #else\n    // dependent components\n\n    // compute normal if needed\n    #if (vtkLightComplexity > 0) || defined(vtkGradientOpacityOn)\n      // use component 3 of the opacity texture as getTextureValue() sets alpha to the opacity value\n      #ifdef vtkComputeNormalFromOpacity\n        vec3 scalarInterp[2];\n        vec4 normal0 = computeNormalForDensity(posIS, tstep, scalarInterp, 3);\n      #else\n        vec4 normal0 = computeNormal(posIS, tstep);\n      #endif\n    #endif\n\n    // compute gradient opacity factor enabled\n    #if defined(vtkGradientOpacityOn)\n      float gradientOpacity = computeGradientOpacityFactor(normal0.a, goscale0, goshift0, gomin0, gomax0);\n    #else\n      const float gradientOpacity = 1.0;\n    #endif\n\n    // get color and opacity\n    #if vtkNumComponents == 1\n      vec3 tColor = texture2D(ctexture, vec2(tValue.r * cscale0 + cshift0, 0.5)).rgb;\n      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;\n      if (alpha < EPSILON){\n        return vec4(0.0);\n      }\n    #endif\n    #if vtkNumComponents == 2\n      vec3 tColor = vec3(tValue.r * cscale0 + cshift0);\n      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale1 + oshift1, 0.5)).r;\n    #endif\n    #if vtkNumComponents == 3\n      vec3 tColor;\n      tColor.r = tValue.r * cscale0 + cshift0;\n      tColor.g = tValue.g * cscale1 + cshift1;\n      tColor.b = tValue.b * cscale2 + cshift2;\n      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale0 + oshift0, 0.5)).r;\n    #endif\n    #if vtkNumComponents == 4\n      vec3 tColor;\n      tColor.r = tValue.r * cscale0 + cshift0;\n      tColor.g = tValue.g * cscale1 + cshift1;\n      tColor.b = tValue.b * cscale2 + cshift2;\n      float alpha = gradientOpacity*texture2D(otexture, vec2(tValue.a * oscale3 + oshift3, 0.5)).r;\n    #endif\n\n    // lighting\n    #if (vtkLightComplexity > 0)\n      #ifdef vtkComputeNormalFromOpacity\n        vec4 normalLight;\n        if (!all(equal(normal0, vec4(0.0)))) {\n          scalarInterp[0] = scalarInterp[0] * oscale0 + oshift0;\n          scalarInterp[1] = scalarInterp[1] * oscale0 + oshift0;\n          normalLight = computeDensityNormal(scalarInterp, 0.5, gradientOpacity);\n          if (all(equal(normalLight, vec4(0.0)))) {\n            normalLight = normal0;\n          }\n        }\n      #else\n        vec4 normalLight = normal0;\n      #endif\n      tColor = applyAllLightning(tColor, alpha, posIS, normalLight);\n    #endif\n\n    return vec4(tColor, alpha);\n  #endif // dependent\n#endif\n}\n\nbool valueWithinScalarRange(vec4 val, vec4 min, vec4 max) {\n  bool withinRange = false;\n  #if vtkNumComponents == 1\n    if (val.r >= min.r && val.r <= max.r) {\n      withinRange = true;\n    }\n  #else\n    #ifdef UseIndependentComponents\n      #if vtkNumComponents == 2\n        if (val.r >= min.r && val.r <= max.r &&\n            val.g >= min.g && val.g <= max.g) {\n          withinRange = true;\n        }\n      #else\n        if (all(greaterThanEqual(val, ipScalarRangeMin)) &&\n            all(lessThanEqual(val, ipScalarRangeMax))) {\n          withinRange = true;\n        }\n      #endif\n    #endif\n  #endif\n  return withinRange;\n}\n\n#if vtkBlendMode == 6 \nbool checkOnEdgeForNeighbor(int i, int j, int s, vec3 stepIS) {\n    vec4 neighborPixelCoord = vec4(gl_FragCoord.x + float(i), gl_FragCoord.y + float(j), gl_FragCoord.z, gl_FragCoord.w);\n    vec3 originalNeighborPosIS = fragCoordToIndexSpace(neighborPixelCoord);\n\n    bool justSawIt = false;\n\n    vec3 neighborPosIS = originalNeighborPosIS;\n\n    float stepsTraveled = 0.0;\n\n\n    // float neighborValue;\n    for (int k = 0; k < //VTK::MaximumSamplesValue /2 ; ++k) {\n        ivec3 texCoord = ivec3(neighborPosIS * vec3(volumeDimensions));\n        vec4 texValue = texelFetch(texture1, texCoord, 0);\n\n        if (int(texValue.g) == s) {\n            justSawIt = true;\n            break;\n        }\n        neighborPosIS += stepIS;\n    }\n\n    if (justSawIt){\n      return false;\n    }\n\n   \n    neighborPosIS = originalNeighborPosIS;\n    for (int k = 0; k < //VTK::MaximumSamplesValue /2 ; ++k) {\n        ivec3 texCoord = ivec3(neighborPosIS * vec3(volumeDimensions));\n        vec4 texValue = texelFetch(texture1, texCoord, 0);\n\n        if (int(texValue.g) == s) {\n            justSawIt = true;\n            break;\n        }\n        neighborPosIS -= stepIS;\n    }\n\n\n    if (!justSawIt) {\n        // onedge\n        vec3 tColorSegment = texture2D(ctexture, vec2(float(s) * cscale1 + cshift1, height1)).rgb;\n        float pwfValueSegment = texture2D(otexture, vec2(float(s) * oscale1 + oshift1, height1)).r;\n        gl_FragData[0] = vec4(tColorSegment, pwfValueSegment);\n        return true;\n    }\n\n    // not on edge\n    return false;\n}\n\n#endif\n\n\n//=======================================================================\n// Apply the specified blend mode operation along the ray's path.\n//\nvoid applyBlend(vec3 posIS, vec3 endIS, vec3 tdims)\n{\n  vec3 tstep = 1.0/tdims;\n\n  // start slightly inside and apply some jitter\n  vec3 delta = endIS - posIS;\n  vec3 stepIS = normalize(delta)*sampleDistanceIS;\n  float raySteps = length(delta)/sampleDistanceIS;\n\n  // Initialize arrays to false\n  // avoid 0.0 jitter\n  float jitter = 0.01 + 0.99*texture2D(jtexture, gl_FragCoord.xy/32.0).r;\n  float stepsTraveled = jitter;\n\n  // local vars for the loop\n  vec4 color = vec4(0.0, 0.0, 0.0, 0.0);\n  vec4 tValue;\n  vec4 tColor;\n\n  // if we have less than one step then pick the middle point\n  // as our value\n  // if (raySteps <= 1.0)\n  // {\n  //   posIS = (posIS + endIS)*0.5;\n  // }\n\n  // Perform initial step at the volume boundary\n  // compute the scalar\n  tValue = getTextureValue(posIS);\n  \n  #if vtkBlendMode == 6 \n    if (raySteps <= 1.0)\n    {\n      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);\n      return;\n    }\n\n    vec4 value = tValue;\n    posIS += (jitter*stepIS);\n    vec3 maxPosIS = posIS; // Store the position of the max value\n    int segmentIndex = int(value.g);\n    bool originalPosHasSeenNonZero = false;\n\n    uint bitmask = 0u;\n\n    if (segmentIndex != 0) {\n      // Tried using the segment index in an boolean array but reading \n      // from the array by dynamic indexing was horrondously slow\n      // so use bit masking instead and assign 1 to the bit corresponding to the segment index\n      // and later check if the bit is set via bit operations\n      setBit(segmentIndex);\n    }\n    \n    // Sample along the ray until MaximumSamplesValue,\n    // ending slightly inside the total distance\n    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)\n    {\n      // If we have reached the last step, break\n      if (stepsTraveled + 1.0 >= raySteps) { break; }\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n      segmentIndex = int(tValue.g);\n\n      if (segmentIndex != 0) {\n        originalPosHasSeenNonZero = true;\n        setBit(segmentIndex);\n      }\n\n      if (tValue.r > value.r) {\n        value =  tValue; // Update the max value\n        maxPosIS = posIS; // Update the position where max occurred\n      }\n\n      // Otherwise, continue along the ray\n      stepsTraveled++;\n      posIS += stepIS;\n    }\n\n    // Perform the last step along the ray using the\n    // residual distance\n    posIS = endIS;\n    tValue = getTextureValue(posIS);\n\n    if (tValue.r > value.r) {\n      value = tValue; // Update the max value\n      maxPosIS = posIS; // Update the position where max occurred\n    }  \n\n    // If we have not seen any non-zero segments, we can return early\n    // and grab color from the actual center value first component (image)\n    if (!originalPosHasSeenNonZero) {\n      gl_FragData[0] = getColorForValue(value, maxPosIS, tstep);\n      return;\n    }\n\n    // probably we can make this configurable but for now we will use the same\n    // sample distance as the original sample distance\n    float neighborSampleDistanceIS = sampleDistanceIS;\n\n    vec3 neighborRayStepsIS = stepIS;\n    float neighborRaySteps = raySteps;\n    bool shouldLookInAllNeighbors = false;\n\n    float minVoxelSpacing = min(volumeSpacings[0], min(volumeSpacings[1], volumeSpacings[2]));\n    vec4 base = vec4(gl_FragCoord.x, gl_FragCoord.y, gl_FragCoord.z, gl_FragCoord.w);\n\n    vec4 baseXPlus = vec4(gl_FragCoord.x + 1.0, gl_FragCoord.y, gl_FragCoord.z, gl_FragCoord.w);\n    vec4 baseYPlus = vec4(gl_FragCoord.x, gl_FragCoord.y + 1.0, gl_FragCoord.z, gl_FragCoord.w);\n\n    vec3 baseWorld = fragCoordToWorld(base);\n    vec3 baseXPlusWorld = fragCoordToWorld(baseXPlus);\n    vec3 baseYPlusWorld = fragCoordToWorld(baseYPlus);\n\n    float XPlusDiff = length(baseXPlusWorld - baseWorld);\n    float YPlusDiff = length(baseYPlusWorld - baseWorld);\n\n    float minFragSpacingWorld = min(XPlusDiff, YPlusDiff);\n\n    for (int s = 1; s < MAX_SEGMENT_INDEX; s++) {\n      // bail out quickly if the segment index has not \n      // been seen by the center segment\n      if (!isBitSet(s)) {\n       continue;\n      }\n\n      // Use texture sampling for outlineThickness so that we can have \n      // per segment thickness\n      float textureCoordinate = float(s - 1) / 1024.0;\n      float textureValue = texture2D(ttexture, vec2(textureCoordinate, 0.5)).r;\n\n      int actualThickness = int(textureValue * 255.0);\n\n      // check the extreme points in the neighborhood since there is a better\n      // chance of finding the edge there, so that we can bail out \n      // faster if we find the edge\n      bool onEdge =\n          checkOnEdgeForNeighbor(-actualThickness, -actualThickness, s, stepIS) ||\n          checkOnEdgeForNeighbor(actualThickness, actualThickness, s, stepIS) ||\n          checkOnEdgeForNeighbor(actualThickness, -actualThickness, s, stepIS) ||\n          checkOnEdgeForNeighbor(-actualThickness, +actualThickness, s, stepIS);\n\n      if (onEdge) {\n        return;\n      }\n\n      // since the next step is computationally expensive, we need to perform\n      // some optimizations to avoid it if possible. One of the optimizations\n      // is to check the whether the minimum of the voxel spacing is greater than \n      // the 2 * the thickness of the outline segment. If that is the case\n      // then we can safely skip the next step since we can be sure that the\n      // the previous 4 checks on the extreme points would caught the entirety \n      // of the all the fragments inside. i.e., this happens when we zoom out, \n      if (minVoxelSpacing > (2.0 * float(actualThickness) - 1.0) * minFragSpacingWorld) {\n        continue;\n      }\n      \n      // Loop through the rest, skipping the processed extremes and the center\n      for (int i = -actualThickness; i <= actualThickness; i++) {\n            for (int j = -actualThickness; j <= actualThickness; j++) {\n                if (i == 0 && j == 0) continue; // Skip the center\n                if (abs(i) == actualThickness && abs(j) == actualThickness) continue; // Skip corners\n                if (checkOnEdgeForNeighbor(i, j, s, stepIS )) {\n                    return;\n                }\n          }\n      }\n    }\n\n    vec3 tColor0 = texture2D(ctexture, vec2(value.r * cscale0 + cshift0, height0)).rgb;\n    float pwfValue0 = texture2D(otexture, vec2(value.r * oscale0 + oshift0, height0)).r;\n    gl_FragData[0] = vec4(tColor0, pwfValue0);\n  #endif\n  #if vtkBlendMode == 0 // COMPOSITE_BLEND\n    // now map through opacity and color\n    tColor = getColorForValue(tValue, posIS, tstep);\n\n    // handle very thin volumes\n    if (raySteps <= 1.0)\n    {\n      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps);\n      gl_FragData[0] = tColor;\n      return;\n    }\n\n    tColor.a = 1.0 - pow(1.0 - tColor.a, jitter);\n    color = vec4(tColor.rgb*tColor.a, tColor.a);\n    posIS += (jitter*stepIS);\n\n    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)\n    {\n      if (stepsTraveled + 1.0 >= raySteps) { break; }\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n\n      // now map through opacity and color\n      tColor = getColorForValue(tValue, posIS, tstep);\n\n      float mix = (1.0 - color.a);\n\n      // this line should not be needed but nvidia seems to not handle\n      // the break correctly on windows/chrome 58 angle\n      //mix = mix * sign(max(raySteps - stepsTraveled - 1.0, 0.0));\n\n      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;\n      stepsTraveled++;\n      posIS += stepIS;\n      if (color.a > 0.99) { color.a = 1.0; break; }\n    }\n\n    if (color.a < 0.99 && (raySteps - stepsTraveled) > 0.0)\n    {\n      posIS = endIS;\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n\n      // now map through opacity and color\n      tColor = getColorForValue(tValue, posIS, tstep);\n      tColor.a = 1.0 - pow(1.0 - tColor.a, raySteps - stepsTraveled);\n\n      float mix = (1.0 - color.a);\n      color = color + vec4(tColor.rgb*tColor.a, tColor.a)*mix;\n    }\n\n    gl_FragData[0] = vec4(color.rgb/color.a, color.a);\n  #endif\n  #if vtkBlendMode == 1 || vtkBlendMode == 2\n    // MAXIMUM_INTENSITY_BLEND || MINIMUM_INTENSITY_BLEND\n    // Find maximum/minimum intensity along the ray.\n\n    // Define the operation we will use (min or max)\n    #if vtkBlendMode == 1\n    #define OP max\n    #else\n    #define OP min\n    #endif\n\n    // If the clipping range is shorter than the sample distance\n    // we can skip the sampling loop along the ray.\n    if (raySteps <= 1.0)\n    {\n      gl_FragData[0] = getColorForValue(tValue, posIS, tstep);\n      return;\n    }\n\n    vec4 value = tValue;\n    posIS += (jitter*stepIS);\n\n    // Sample along the ray until MaximumSamplesValue,\n    // ending slightly inside the total distance\n    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)\n    {\n      // If we have reached the last step, break\n      if (stepsTraveled + 1.0 >= raySteps) { break; }\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n\n      // Update the maximum value if necessary\n      value = OP(tValue, value);\n\n      // Otherwise, continue along the ray\n      stepsTraveled++;\n      posIS += stepIS;\n    }\n\n    // Perform the last step along the ray using the\n    // residual distance\n    posIS = endIS;\n    tValue = getTextureValue(posIS);\n    value = OP(tValue, value);\n\n    // Now map through opacity and color\n    gl_FragData[0] = getColorForValue(value, posIS, tstep);\n  #endif\n  #if vtkBlendMode == 3 || vtkBlendMode == 4 //AVERAGE_INTENSITY_BLEND || ADDITIVE_BLEND\n    vec4 sum = vec4(0.);\n\n    if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {\n      sum += tValue;\n    }\n\n    if (raySteps <= 1.0) {\n      gl_FragData[0] = getColorForValue(sum, posIS, tstep);\n      return;\n    }\n\n    posIS += (jitter*stepIS);\n\n    // Sample along the ray until MaximumSamplesValue,\n    // ending slightly inside the total distance\n    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)\n    {\n      // If we have reached the last step, break\n      if (stepsTraveled + 1.0 >= raySteps) { break; }\n\n      // compute the scalar\n      tValue = getTextureValue(posIS);\n\n      // One can control the scalar range by setting the AverageIPScalarRange to disregard scalar values, not in the range of interest, from the average computation.\n      // Notes:\n      // - We are comparing all values in the texture to see if any of them\n      //   are outside of the scalar range. In the future we might want to allow\n      //   scalar ranges for each component.\n      if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {\n        // Sum the values across each step in the path\n        sum += tValue;\n      }\n      stepsTraveled++;\n      posIS += stepIS;\n    }\n\n    // Perform the last step along the ray using the\n    // residual distance\n    posIS = endIS;\n\n    // compute the scalar\n    tValue = getTextureValue(posIS);\n\n    // One can control the scalar range by setting the IPScalarRange to disregard scalar values, not in the range of interest, from the average computation\n    if (valueWithinScalarRange(tValue, ipScalarRangeMin, ipScalarRangeMax)) {\n      sum += tValue;\n\n      stepsTraveled++;\n    }\n\n    #if vtkBlendMode == 3 // Average\n      sum /= vec4(stepsTraveled, stepsTraveled, stepsTraveled, 1.0);\n    #endif\n\n    gl_FragData[0] = getColorForValue(sum, posIS, tstep);\n  #endif\n  #if vtkBlendMode == 5 // RADON\n    float normalizedRayIntensity = 1.0;\n\n    // handle very thin volumes\n    if (raySteps <= 1.0)\n    {\n      tValue = getTextureValue(posIS);\n      normalizedRayIntensity = normalizedRayIntensity - sampleDistance*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;\n      gl_FragData[0] = texture2D(ctexture, vec2(normalizedRayIntensity, 0.5));\n      return;\n    }\n\n    posIS += (jitter*stepIS);\n\n    for (int i = 0; i < //VTK::MaximumSamplesValue ; ++i)\n    {\n      if (stepsTraveled + 1.0 >= raySteps) { break; }\n\n      // compute the scalar value\n      tValue = getTextureValue(posIS);\n\n      // Convert scalar value to normalizedRayIntensity coefficient and accumulate normalizedRayIntensity\n      normalizedRayIntensity = normalizedRayIntensity - sampleDistance*texture2D(otexture, vec2(tValue.r * oscale0 + oshift0, 0.5)).r;\n\n      posIS += stepIS;\n      stepsTraveled++;\n    }\n\n    // map normalizedRayIntensity to color\n    gl_FragData[0] = texture2D(ctexture, vec2(normalizedRayIntensity , 0.5));\n\n  #endif\n}\n\n//=======================================================================\n// Compute a new start and end point for a given ray based\n// on the provided bounded clipping plane (aka a rectangle)\nvoid getRayPointIntersectionBounds(\n  vec3 rayPos, vec3 rayDir,\n  vec3 planeDir, float planeDist,\n  inout vec2 tbounds, vec3 vPlaneX, vec3 vPlaneY,\n  float vSize1, float vSize2)\n{\n  float result = dot(rayDir, planeDir);\n  if (abs(result) < 1e-6)\n  {\n    return;\n  }\n  result = -1.0 * (dot(rayPos, planeDir) + planeDist) / result;\n  vec3 xposVC = rayPos + rayDir*result;\n  vec3 vxpos = xposVC - vOriginVC;\n  vec2 vpos = vec2(\n    dot(vxpos, vPlaneX),\n    dot(vxpos, vPlaneY));\n\n  // on some apple nvidia systems this does not work\n  // if (vpos.x < 0.0 || vpos.x > vSize1 ||\n  //     vpos.y < 0.0 || vpos.y > vSize2)\n  // even just\n  // if (vpos.x < 0.0 || vpos.y < 0.0)\n  // fails\n  // so instead we compute a value that represents in and out\n  //and then compute the return using this value\n  float xcheck = max(0.0, vpos.x * (vpos.x - vSize1)); //  0 means in bounds\n  float check = sign(max(xcheck, vpos.y * (vpos.y - vSize2))); //  0 means in bounds, 1 = out\n\n  tbounds = mix(\n   vec2(min(tbounds.x, result), max(tbounds.y, result)), // in value\n   tbounds, // out value\n   check);  // 0 in 1 out\n}\n\n//=======================================================================\n// given a\n// - ray direction (rayDir)\n// - starting point (vertexVCVSOutput)\n// - bounding planes of the volume\n// - optionally depth buffer values\n// - far clipping plane\n// compute the start/end distances of the ray we need to cast\nvec2 computeRayDistances(vec3 rayDir, vec3 tdims)\n{\n  vec2 dists = vec2(100.0*camFar, -1.0);\n\n  vec3 vSize = vSpacing*tdims;\n\n  // all this is in View Coordinates\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal0, vPlaneDistance0, dists, vPlaneNormal2, vPlaneNormal4,\n    vSize.y, vSize.z);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal1, vPlaneDistance1, dists, vPlaneNormal2, vPlaneNormal4,\n    vSize.y, vSize.z);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal2, vPlaneDistance2, dists, vPlaneNormal0, vPlaneNormal4,\n    vSize.x, vSize.z);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal3, vPlaneDistance3, dists, vPlaneNormal0, vPlaneNormal4,\n    vSize.x, vSize.z);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal4, vPlaneDistance4, dists, vPlaneNormal0, vPlaneNormal2,\n    vSize.x, vSize.y);\n  getRayPointIntersectionBounds(vertexVCVSOutput, rayDir,\n    vPlaneNormal5, vPlaneDistance5, dists, vPlaneNormal0, vPlaneNormal2,\n    vSize.x, vSize.y);\n\n  //VTK::ClipPlane::Impl\n\n  // do not go behind front clipping plane\n  dists.x = max(0.0,dists.x);\n\n  // do not go PAST far clipping plane\n  float farDist = -camThick/rayDir.z;\n  dists.y = min(farDist,dists.y);\n\n  // Do not go past the zbuffer value if set\n  // This is used for intermixing opaque geometry\n  //VTK::ZBuffer::Impl\n\n  return dists;\n}\n\n//=======================================================================\n// Compute the index space starting position (pos) and end\n// position\n//\nvoid computeIndexSpaceValues(out vec3 pos, out vec3 endPos, vec3 rayDir, vec2 dists)\n{\n  // compute starting and ending values in volume space\n  pos = vertexVCVSOutput + dists.x*rayDir;\n  pos = pos - vOriginVC;\n  // convert to volume basis and origin\n  pos = vec3(\n    dot(pos, vPlaneNormal0),\n    dot(pos, vPlaneNormal2),\n    dot(pos, vPlaneNormal4));\n\n  endPos = vertexVCVSOutput + dists.y*rayDir;\n  endPos = endPos - vOriginVC;\n  endPos = vec3(\n    dot(endPos, vPlaneNormal0),\n    dot(endPos, vPlaneNormal2),\n    dot(endPos, vPlaneNormal4));\n\n  float delta = length(endPos - pos);\n\n  pos *= vVCToIJK;\n  endPos *= vVCToIJK;\n\n  float delta2 = length(endPos - pos);\n  sampleDistanceIS = sampleDistance*delta2/delta;\n  #ifdef VolumeShadowOn\n    sampleDistanceISVS = sampleDistanceIS * volumeShadowSamplingDistFactor;\n  #endif\n}\n\nvoid main()\n{\n\n  if (cameraParallel == 1)\n  {\n    // Camera is parallel, so the rayDir is just the direction of the camera.\n    rayDirVC = vec3(0.0, 0.0, -1.0);\n  } else {\n    // camera is at 0,0,0 so rayDir for perspective is just the vc coord\n    rayDirVC = normalize(vertexVCVSOutput);\n  }\n\n  vec3 tdims = vec3(volumeDimensions);\n\n  // compute the start and end points for the ray\n  vec2 rayStartEndDistancesVC = computeRayDistances(rayDirVC, tdims);\n\n  // do we need to composite? aka does the ray have any length\n  // If not, bail out early\n  if (rayStartEndDistancesVC.y <= rayStartEndDistancesVC.x)\n  {\n    discard;\n  }\n\n  // IS = Index Space\n  vec3 posIS;\n  vec3 endIS;\n  computeIndexSpaceValues(posIS, endIS, rayDirVC, rayStartEndDistancesVC);\n\n  // Perform the blending operation along the ray\n  applyBlend(posIS, endIS, tdims);\n}\n",S=n(88691);const{vtkWarningMacro:w,vtkErrorMacro:_}=r.c;function I(e,t){function n(n){[t._scalars,t._scalarOpacityFunc,t._colorTransferFunc,t._labelOutlineThicknessArray].forEach((t=>n.unregisterGraphicsResourceUser(t,e)))}t.classHierarchy.push("vtkOpenGLVolumeMapper"),e.buildPass=()=>{t.zBufferTexture=null},e.zBufferPass=(e,n)=>{if(e){const e=n.getZBufferTexture();e!==t.zBufferTexture&&(t.zBufferTexture=e)}},e.opaqueZBufferPass=(t,n)=>e.zBufferPass(t,n),e.volumePass=(r,i)=>{if(r){const r=t._openGLRenderWindow;t._openGLRenderWindow=e.getLastAncestorOfType("vtkOpenGLRenderWindow"),r&&!r.isDeleted()&&r!==t._openGLRenderWindow&&n(r),t.context=t._openGLRenderWindow.getContext(),t.tris.setOpenGLRenderWindow(t._openGLRenderWindow),t.jitterTexture.setOpenGLRenderWindow(t._openGLRenderWindow),t.framebuffer.setOpenGLRenderWindow(t._openGLRenderWindow),t.openGLVolume=e.getFirstAncestorOfType("vtkOpenGLVolume");const i=t.openGLVolume.getRenderable();t._openGLRenderer=e.getFirstAncestorOfType("vtkOpenGLRenderer");const o=t._openGLRenderer.getRenderable();t.openGLCamera=t._openGLRenderer.getViewNodeFor(o.getActiveCamera()),e.renderPiece(o,i)}},e.getShaderTemplate=(e,t,n)=>{e.Vertex=C,e.Fragment=T,e.Geometry=""},e.useIndependentComponents=e=>{const n=e.getIndependentComponents(),r=t.currentInput,i=r?.getPointData()?.getScalars()?.getNumberOfComponents(),o=e.getColorMixPreset();return n&&i>=2||!!o},e.replaceShaderValues=(n,r,i)=>{const o=i.getProperty();let s=n.Fragment;o.getInterpolationType()===b.VO.LINEAR&&(s=h.A.substitute(s,"//VTK::TrilinearOn","#define vtkTrilinearOn").result);!0===e.isLabelmapOutlineRequired(i)&&(s=h.A.substitute(s,"//VTK::ImageLabelOutlineOn","#define vtkImageLabelOutlineOn").result);t.renderable.getBlendMode()===x.Nx.LABELMAP_EDGE_PROJECTION_BLEND&&(s=h.A.substitute(s,"//VTK::LabelEdgeProjectionOn","#define vtkLabelEdgeProjectionOn").result);const l=t.scalarTexture.getComponents();s=h.A.substitute(s,"//VTK::NumComponents",`#define vtkNumComponents ${l}`).result;const c=e.useIndependentComponents(o);c&&(s=h.A.substitute(s,"//VTK::IndependentComponentsOn","#define UseIndependentComponents").result);const u=[],d=[];for(let e=0;e<l;e++)o.getOpacityMode(e)===b.tE.PROPORTIONAL&&u.push(`#define vtkComponent${e}Proportional`),o.getForceNearestInterpolation(e)&&d.push(`#define vtkComponent${e}ForceNearest`);s=h.A.substitute(s,"//VTK::vtkProportionalComponents",u.join("\n")).result,s=h.A.substitute(s,"//VTK::vtkForceNearestComponents",d.join("\n")).result;const p=function(e){switch(e){case b.dM.CUSTOM:return"//VTK::CustomColorMix";case b.dM.ADDITIVE:return"\n        // compute normals\n        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);\n        #if (vtkLightComplexity > 0) && defined(vtkComputeNormalFromOpacity)\n          vec3 scalarInterp0[2];\n          vec4 normalLight0 = computeNormalForDensity(posIS, tstep, scalarInterp0, 0);\n          scalarInterp0[0] = scalarInterp0[0] * oscale0 + oshift0;\n          scalarInterp0[1] = scalarInterp0[1] * oscale0 + oshift0;\n          normalLight0 = computeDensityNormal(scalarInterp0, height0, 1.0);\n\n          vec3 scalarInterp1[2];\n          vec4 normalLight1 = computeNormalForDensity(posIS, tstep, scalarInterp1, 1);\n          scalarInterp1[0] = scalarInterp1[0] * oscale1 + oshift1;\n          scalarInterp1[1] = scalarInterp1[1] * oscale1 + oshift1;\n          normalLight1 = computeDensityNormal(scalarInterp1, height1, 1.0);\n        #else\n          vec4 normalLight0 = normalMat[0];\n          vec4 normalLight1 = normalMat[1];\n        #endif\n\n        // compute opacities\n        float opacity0 = pwfValue0;\n        float opacity1 = pwfValue1;\n        #ifdef vtkGradientOpacityOn\n          float gof0 = computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);\n          opacity0 *= gof0;\n          float gof1 = computeGradientOpacityFactor(normalMat[1].a, goscale1, goshift1, gomin1, gomax1);\n          opacity1 *= gof1;\n        #endif\n        float opacitySum = opacity0 + opacity1;\n        if (opacitySum <= 0.0) {\n          return vec4(0.0);\n        }\n\n        // mix the colors and opacities\n        tColor0 = applyAllLightning(tColor0, opacity0, posIS, normalLight0);\n        tColor1 = applyAllLightning(tColor1, opacity1, posIS, normalLight1);\n        vec3 mixedColor = (opacity0 * tColor0 + opacity1 * tColor1) / opacitySum;\n        return vec4(mixedColor, min(1.0, opacitySum));\n";case b.dM.COLORIZE:return"\n        // compute normals\n        mat4 normalMat = computeMat4Normal(posIS, tValue, tstep);\n        #if (vtkLightComplexity > 0) && defined(vtkComputeNormalFromOpacity)\n          vec3 scalarInterp0[2];\n          vec4 normalLight0 = computeNormalForDensity(posIS, tstep, scalarInterp0, 0);\n          scalarInterp0[0] = scalarInterp0[0] * oscale0 + oshift0;\n          scalarInterp0[1] = scalarInterp0[1] * oscale0 + oshift0;\n          normalLight0 = computeDensityNormal(scalarInterp0, height0, 1.0);\n        #else\n          vec4 normalLight0 = normalMat[0];\n        #endif\n\n        // compute opacities\n        float opacity0 = pwfValue0;\n        #ifdef vtkGradientOpacityOn\n          float gof0 = computeGradientOpacityFactor(normalMat[0].a, goscale0, goshift0, gomin0, gomax0);\n          opacity0 *= gof0;\n        #endif\n\n        // mix the colors and opacities\n        vec3 color = tColor0 * mix(vec3(1.0), tColor1, pwfValue1);\n        color = applyAllLightning(color, opacity0, posIS, normalLight0);\n        return vec4(color, opacity0);\n";default:return null}}(o.getColorMixPreset());p&&(s=h.A.substitute(s,"//VTK::CustomComponentsColorMixOn","#define vtkCustomComponentsColorMix").result,s=h.A.substitute(s,"//VTK::CustomComponentsColorMix::Impl",p).result);const f=t.currentInput.getSpatialExtent(),m=t.currentInput.getSpacing(),g=new Float64Array(3);a.eR.set(g,(f[1]-f[0])*m[0],(f[3]-f[2])*m[1],(f[5]-f[4])*m[2]);const v=a.eR.length(g)/e.getCurrentSampleDistance(r);s=h.A.substitute(s,"//VTK::MaximumSamplesValue",`${Math.ceil(v)}`).result,s=h.A.substitute(s,"//VTK::LightComplexity",`#define vtkLightComplexity ${t.lightComplexity}`).result,t.lightComplexity>0&&(t.renderable.getVolumetricScatteringBlending()>0&&(s=h.A.substitute(s,"//VTK::VolumeShadowOn","#define VolumeShadowOn").result),t.renderable.getVolumetricScatteringBlending()<1&&(s=h.A.substitute(s,"//VTK::SurfaceShadowOn","#define SurfaceShadowOn").result),t.renderable.getLocalAmbientOcclusion()&&o.getAmbient()>0&&(s=h.A.substitute(s,"//VTK::localAmbientOcclusionOn","#define localAmbientOcclusionOn").result));const y=c?l:1;t.gopacity=!1;for(let e=0;!t.gopacity&&e<y;++e)t.gopacity||=o.getUseGradientOpacity(e);t.gopacity&&(s=h.A.substitute(s,"//VTK::GradientOpacityOn","#define vtkGradientOpacityOn").result),t.renderable.getComputeNormalFromOpacity()&&(s=h.A.substitute(s,"//VTK::vtkComputeNormalFromOpacity","#define vtkComputeNormalFromOpacity").result),null!==t.zBufferTexture&&(s=h.A.substitute(s,"//VTK::ZBuffer::Dec",["uniform sampler2D zBufferTexture;","uniform float vpZWidth;","uniform float vpZHeight;"]).result,s=h.A.substitute(s,"//VTK::ZBuffer::Impl",["vec4 depthVec = texture2D(zBufferTexture, vec2(gl_FragCoord.x / vpZWidth, gl_FragCoord.y/vpZHeight));","float zdepth = (depthVec.r*256.0 + depthVec.g)/257.0;","zdepth = zdepth * 2.0 - 1.0;","if (cameraParallel == 0) {","zdepth = -2.0 * camFar * camNear / (zdepth*(camFar-camNear)-(camFar+camNear)) - camNear;}","else {","zdepth = (zdepth + 1.0) * 0.5 * (camFar - camNear);}\n","zdepth = -zdepth/rayDir.z;","dists.y = min(zdepth,dists.y);"]).result),s=h.A.substitute(s,"//VTK::BlendMode",`${t.renderable.getBlendMode()}`).result,n.Fragment=s,e.replaceShaderLight(n,r,i),e.replaceShaderClippingPlane(n,r,i)},e.replaceShaderLight=(e,n,r)=>{if(0===t.lightComplexity)return;let i=e.Fragment,o=0;n.getLights().forEach((e=>{e.getSwitch()&&(o+=1)})),i=h.A.substitute(i,"//VTK::Light::Dec",["uniform int lightNum;","uniform bool twoSidedLighting;",`uniform vec3 lightColor[${o}];`,`uniform vec3 lightDirectionVC[${o}]; // normalized`,`uniform vec3 lightHalfAngleVC[${o}];`,"//VTK::Light::Dec"],!1).result,3===t.lightComplexity&&(i=h.A.substitute(i,"//VTK::Light::Dec",[`uniform vec3 lightPositionVC[${o}];`,`uniform vec3 lightAttenuation[${o}];`,`uniform float lightConeAngle[${o}];`,`uniform float lightExponent[${o}];`,`uniform int lightPositional[${o}];`],!1).result),t.renderable.getVolumetricScatteringBlending()>0&&(i=h.A.substitute(i,"//VTK::VolumeShadow::Dec",["uniform float volumetricScatteringBlending;","uniform float giReach;","uniform float volumeShadowSamplingDistFactor;","uniform float anisotropy;","uniform float anisotropy2;"],!1).result),t.renderable.getLocalAmbientOcclusion()&&r.getProperty().getAmbient()>0&&(i=h.A.substitute(i,"//VTK::LAO::Dec",["uniform int kernelRadius;",`uniform vec2 kernelSample[${t.renderable.getLAOKernelRadius()}];`,"uniform int kernelSize;"],!1).result),e.Fragment=i},e.replaceShaderClippingPlane=(e,n,r)=>{let i=e.Fragment;if(t.renderable.getClippingPlanes().length>0){const e=t.renderable.getClippingPlanes().length;i=h.A.substitute(i,"//VTK::ClipPlane::Dec",["uniform vec3 vClipPlaneNormals[6];","uniform float vClipPlaneDistances[6];","uniform vec3 vClipPlaneOrigins[6];","uniform int clip_numPlanes;","//VTK::ClipPlane::Dec","#define vtkClippingPlanesOn"],!1).result,i=h.A.substitute(i,"//VTK::ClipPlane::Impl",[`for(int i = 0; i < ${e}; i++) {`,"  float rayDirRatio = dot(rayDir, vClipPlaneNormals[i]);","  float equationResult = dot(vertexVCVSOutput, vClipPlaneNormals[i]) + vClipPlaneDistances[i];","  if (rayDirRatio == 0.0)","  {","    if (equationResult < 0.0) dists.x = dists.y;","    continue;","  }","  float result = -1.0 * equationResult / rayDirRatio;","  if (rayDirRatio < 0.0) dists.y = min(dists.y, result);","  else dists.x = max(dists.x, result);","}","//VTK::ClipPlane::Impl"],!1).result}e.Fragment=i};e.getNeedToRebuildShaders=(n,r,i)=>{const s=i.getProperty();((n,r)=>{let i=0;n.getProperty().getShade()&&t.renderable.getBlendMode()===x.Nx.COMPOSITE_BLEND&&(i=0,t.numberOfLights=0,r.forEach((e=>{e.getSwitch()>0&&(t.numberOfLights++,0===i&&(i=1)),1===i&&(t.numberOfLights>1||1!==e.getIntensity()||!e.lightTypeIsHeadLight())&&(i=2),i<3&&e.getPositional()&&(i=3)}))),i!==t.lightComplexity&&(t.lightComplexity=i,e.modified())})(i,r.getLights());const l=t.scalarTexture.getComponents(),c=[],u=[];for(let e=0;e<l;e++)c.push(s.getOpacityMode(e)),u.push(s.getForceNearestInterpolation(e));const d=t.currentInput.getSpatialExtent(),p=t.currentInput.getSpacing(),f=new Float64Array(3);a.eR.set(f,(d[1]-d[0])*p[0],(d[3]-d[2])*p[1],(d[5]-d[4])*p[2]);const h=a.eR.length(f)/e.getCurrentSampleDistance(r),m=!!t.zBufferTexture,g={iComps:s.getIndependentComponents(),colorMixPreset:s.getColorMixPreset(),interpolationType:s.getInterpolationType(),useLabelOutline:e.isLabelmapOutlineRequired(i),numComp:l,maxSamples:h,useGradientOpacity:s.getUseGradientOpacity(0),blendMode:t.renderable.getBlendMode(),hasZBufferTexture:m,opacityModes:c,forceNearestInterps:u};return(0===n.getProgram()?.getHandle()||n.getShaderSourceTime().getMTime()<e.getMTime()||n.getShaderSourceTime().getMTime()<t.renderable.getMTime()||!t.previousState||!o()(t.previousState,g))&&(t.previousState=g,!0)},e.updateShaders=(n,r,i)=>{if(e.getNeedToRebuildShaders(n,r,i)){const o={Vertex:null,Fragment:null,Geometry:null};e.buildShaders(o,r,i);const a=t._openGLRenderWindow.getShaderCache().readyShaderProgramArray(o.Vertex,o.Fragment,o.Geometry);a!==n.getProgram()&&(n.setProgram(a),n.getVAO().releaseGraphicsResources()),n.getShaderSourceTime().modified()}else t._openGLRenderWindow.getShaderCache().readyShaderProgram(n.getProgram());n.getVAO().bind(),e.setMapperShaderParameters(n,r,i),e.setCameraShaderParameters(n,r,i),e.setPropertyShaderParameters(n,r,i),e.getClippingPlaneShaderParameters(n,r,i)},e.setMapperShaderParameters=(n,r,i)=>{const o=n.getProgram();n.getCABO().getElementCount()&&(t.VBOBuildTime.getMTime()>n.getAttributeUpdateTime().getMTime()||n.getShaderSourceTime().getMTime()>n.getAttributeUpdateTime().getMTime())&&(o.isAttributeUsed("vertexDC")&&(n.getVAO().addAttributeArray(o,n.getCABO(),"vertexDC",n.getCABO().getVertexOffset(),n.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||_("Error setting vertexDC in shader VAO.")),n.getAttributeUpdateTime().modified()),o.setUniformi("texture1",t.scalarTexture.getTextureUnit()),o.setUniformf("sampleDistance",e.getCurrentSampleDistance(r));const a=t.scalarTexture.getVolumeInfo(),s=t.renderable.getIpScalarRange();if(a?.dataComputedScale?.length){const e=[],t=[];for(let n=0;n<4;n++)e[n]=s[0]*a.dataComputedScale[n]+a.dataComputedOffset[n],t[n]=s[1]*a.dataComputedScale[n]+a.dataComputedOffset[n],e[n]=(e[n]-a.offset[n])/a.scale[n],t[n]=(t[n]-a.offset[n])/a.scale[n];o.setUniform4f("ipScalarRangeMin",e[0],e[1],e[2],e[3]),o.setUniform4f("ipScalarRangeMax",t[0],t[1],t[2],t[3])}if(null!==t.zBufferTexture){o.setUniformi("zBufferTexture",t.zBufferTexture.getTextureUnit());const e=t._useSmallViewport?[t._smallViewportWidth,t._smallViewportHeight]:t._openGLRenderWindow.getFramebufferSize();o.setUniformf("vpZWidth",e[0]),o.setUniformf("vpZHeight",e[1])}},e.setCameraShaderParameters=(n,r,i)=>{const o=t.openGLCamera.getKeyMatrices(r),s=t.openGLVolume.getKeyMatrices();a.pB.multiply(t.modelToView,o.wcvc,s.mcwc);const l=n.getProgram(),c=t.openGLCamera.getRenderable(),u=c.getClippingRange();l.setUniformf("camThick",u[1]-u[0]),l.setUniformf("camNear",u[0]),l.setUniformf("camFar",u[1]);const d=t.currentInput.getBounds(),p=t.currentInput.getDimensions(),f=new Float64Array(3),h=new Float64Array(3);let m=1,g=-1,v=1,y=-1;for(let e=0;e<8;++e){if(a.eR.set(f,d[e%2],d[2+Math.floor(e/2)%2],d[4+Math.floor(e/4)]),a.eR.transformMat4(f,f,t.modelToView),!c.getParallelProjection()){a.eR.normalize(h,f);const e=-u[0]/f[2];a.eR.scale(f,h,e)}a.eR.transformMat4(f,f,o.vcpc),m=Math.min(f[0],m),g=Math.max(f[0],g),v=Math.min(f[1],v),y=Math.max(f[1],y)}l.setUniformf("dcxmin",m),l.setUniformf("dcxmax",g),l.setUniformf("dcymin",v),l.setUniformf("dcymax",y),l.isUniformUsed("cameraParallel")&&l.setUniformi("cameraParallel",c.getParallelProjection());const b=t.currentInput.getSpatialExtent(),x=t.currentInput.getSpacing(),A=new Float64Array(3);a.eR.set(A,(b[1]-b[0])*x[0],(b[3]-b[2])*x[1],(b[5]-b[4])*x[2]),l.setUniform3f("vSpacing",x[0],x[1],x[2]),a.eR.set(f,b[0],b[2],b[4]),t.currentInput.indexToWorldVec3(f,f),a.eR.transformMat4(f,f,t.modelToView),l.setUniform3f("vOriginVC",f[0],f[1],f[2]);const C=t.currentInput.getIndexToWorld();a.pB.multiply(t.idxToView,t.modelToView,C),a.w0.multiply(t.idxNormalMatrix,o.normalMatrix,s.normalMatrix),a.w0.multiply(t.idxNormalMatrix,t.idxNormalMatrix,t.currentInput.getDirectionByReference());const T=a.eR.length(A)/e.getCurrentSampleDistance(r);T>t.renderable.getMaximumSamplesPerRay()&&w(`The number of steps required ${Math.ceil(T)} is larger than the\n        specified maximum number of steps ${t.renderable.getMaximumSamplesPerRay()}.\n        Please either change the\n        volumeMapper sampleDistance or its maximum number of samples.`);const S=new Float64Array(3);if(a.eR.set(S,1,1,1),a.eR.divide(S,S,A),l.setUniform3f("vVCToIJK",S[0],S[1],S[2]),l.setUniform3i("volumeDimensions",p[0],p[1],p[2]),l.setUniform3f("volumeSpacings",x[0],x[1],x[2]),!t._openGLRenderWindow.getWebgl2()){const e=t.scalarTexture.getVolumeInfo();l.setUniformf("texWidth",t.scalarTexture.getWidth()),l.setUniformf("texHeight",t.scalarTexture.getHeight()),l.setUniformi("xreps",e.xreps),l.setUniformi("xstride",e.xstride),l.setUniformi("ystride",e.ystride)}const _=new Float64Array(3),I=new Float64Array(3);for(let e=0;e<6;++e){switch(e){case 1:a.eR.set(_,-1,0,0),a.eR.set(I,b[0],b[2],b[4]);break;case 2:a.eR.set(_,0,1,0),a.eR.set(I,b[1],b[3],b[5]);break;case 3:a.eR.set(_,0,-1,0),a.eR.set(I,b[0],b[2],b[4]);break;case 4:a.eR.set(_,0,0,1),a.eR.set(I,b[1],b[3],b[5]);break;case 5:a.eR.set(_,0,0,-1),a.eR.set(I,b[0],b[2],b[4]);break;default:a.eR.set(_,1,0,0),a.eR.set(I,b[1],b[3],b[5])}a.eR.transformMat3(_,_,t.idxNormalMatrix),a.eR.transformMat4(I,I,t.idxToView);const n=-1*a.eR.dot(I,_);l.setUniform3f(`vPlaneNormal${e}`,_[0],_[1],_[2]),l.setUniformf(`vPlaneDistance${e}`,n)}if(e.isLabelmapOutlineRequired(i)){const n=t.currentInput.getWorldToIndex();l.setUniformMatrix("vWCtoIDX",n);const i=r.getActiveCamera(),[o,s]=i.getClippingRange(),c=i.getDistance();i.setClippingRange(c,c+.1);const u=t.openGLCamera.getKeyMatrices(r);a.pB.invert(t.projectionToWorld,u.wcpc),i.setClippingRange(o,s),t.openGLCamera.getKeyMatrices(r),l.setUniformMatrix("PCWCMatrix",t.projectionToWorld);const d=e.getRenderTargetSize();l.setUniformf("vpWidth",d[0]),l.setUniformf("vpHeight",d[1]);const p=e.getRenderTargetOffset();l.setUniformf("vpOffsetX",p[0]/d[0]),l.setUniformf("vpOffsetY",p[1]/d[1])}if(a.pB.invert(t.projectionToView,o.vcpc),l.setUniformMatrix("PCVCMatrix",t.projectionToView),0===t.lightComplexity)return;let E=0;const D=[],O=[],P=[];if(r.getLights().forEach((e=>{if(e.getSwitch()>0){const t=e.getColor(),n=e.getIntensity();D[0+3*E]=t[0]*n,D[1+3*E]=t[1]*n,D[2+3*E]=t[2]*n;const r=e.getDirection();a.eR.set(_,r[0],r[1],r[2]),a.eR.transformMat3(_,_,o.normalMatrix),a.eR.normalize(_,_),O[0+3*E]=_[0],O[1+3*E]=_[1],O[2+3*E]=_[2],P[0+3*E]=-.5*_[0],P[1+3*E]=-.5*_[1],P[2+3*E]=-.5*(_[2]-1),E++}})),l.setUniformi("twoSidedLighting",r.getTwoSidedLighting()),l.setUniformi("lightNum",E),l.setUniform3fv("lightColor",D),l.setUniform3fv("lightDirectionVC",O),l.setUniform3fv("lightHalfAngleVC",P),3===t.lightComplexity){E=0;const e=[],n=[],i=[],o=[],s=[];r.getLights().forEach((r=>{if(r.getSwitch()>0){const l=r.getAttenuationValues();n[0+3*E]=l[0],n[1+3*E]=l[1],n[2+3*E]=l[2],o[E]=r.getExponent(),i[E]=r.getConeAngle(),s[E]=r.getPositional();const c=r.getTransformedPosition();a.eR.transformMat4(c,c,t.modelToView),e[0+3*E]=c[0],e[1+3*E]=c[1],e[2+3*E]=c[2],E+=1}})),l.setUniform3fv("lightPositionVC",e),l.setUniform3fv("lightAttenuation",n),l.setUniformfv("lightConeAngle",i),l.setUniformfv("lightExponent",o),l.setUniformiv("lightPositional",s)}if(t.renderable.getVolumetricScatteringBlending()>0&&(l.setUniformf("giReach",t.renderable.getGlobalIlluminationReach()),l.setUniformf("volumetricScatteringBlending",t.renderable.getVolumetricScatteringBlending()),l.setUniformf("volumeShadowSamplingDistFactor",t.renderable.getVolumeShadowSamplingDistFactor()),l.setUniformf("anisotropy",t.renderable.getAnisotropy()),l.setUniformf("anisotropy2",t.renderable.getAnisotropy()**2)),t.renderable.getLocalAmbientOcclusion()&&i.getProperty().getAmbient()>0){const e=t.renderable.getLAOKernelSize();l.setUniformi("kernelSize",e);const n=[];for(let t=0;t<e;t++)n[2*t]=.5*Math.random(),n[2*t+1]=.5*Math.random();l.setUniform2fv("kernelSample",n),l.setUniformi("kernelRadius",t.renderable.getLAOKernelRadius())}},e.setPropertyShaderParameters=(n,r,i)=>{const o=n.getProgram();o.setUniformi("ctexture",t.colorTexture.getTextureUnit()),o.setUniformi("otexture",t.opacityTexture.getTextureUnit()),o.setUniformi("jtexture",t.jitterTexture.getTextureUnit()),o.setUniformi("ttexture",t.labelOutlineThicknessTexture.getTextureUnit());const a=t.scalarTexture.getVolumeInfo(),s=i.getProperty(),l=t.scalarTexture.getComponents(),c=e.useIndependentComponents(s);if(c)for(let e=0;e<l;e++)o.setUniformf(`mix${e}`,i.getProperty().getComponentWeight(e));for(let e=0;e<l;e++){const t=c?e:0,n=a.scale[e],r=s.getScalarOpacity(t).getRange(),i=n/(r[1]-r[0]),l=(a.offset[e]-r[0])/(r[1]-r[0]);o.setUniformf(`oshift${e}`,l),o.setUniformf(`oscale${e}`,i);const u=s.getRGBTransferFunction(t).getRange(),d=(a.offset[e]-u[0])/(u[1]-u[0]),p=n/(u[1]-u[0]);o.setUniformf(`cshift${e}`,d),o.setUniformf(`cscale${e}`,p)}if(t.gopacity)if(c)for(let e=0;e<l;++e){const t=a.scale[e];if(s.getUseGradientOpacity(e)){const n=s.getGradientOpacityMinimumOpacity(e),r=s.getGradientOpacityMaximumOpacity(e);o.setUniformf(`gomin${e}`,n),o.setUniformf(`gomax${e}`,r);const i=[s.getGradientOpacityMinimumValue(e),s.getGradientOpacityMaximumValue(e)];o.setUniformf(`goscale${e}`,t*(r-n)/(i[1]-i[0])),o.setUniformf(`goshift${e}`,-i[0]*(r-n)/(i[1]-i[0])+n)}else o.setUniformf(`gomin${e}`,1),o.setUniformf(`gomax${e}`,1),o.setUniformf(`goscale${e}`,0),o.setUniformf(`goshift${e}`,1)}else{const e=a.scale[l-1],t=s.getGradientOpacityMinimumOpacity(0),n=s.getGradientOpacityMaximumOpacity(0);o.setUniformf("gomin0",t),o.setUniformf("gomax0",n);const r=[s.getGradientOpacityMinimumValue(0),s.getGradientOpacityMaximumValue(0)];o.setUniformf("goscale0",e*(n-t)/(r[1]-r[0])),o.setUniformf("goshift0",-r[0]*(n-t)/(r[1]-r[0])+t)}if(!0===e.isLabelmapOutlineRequired(i)){const e=i.getProperty().getLabelOutlineOpacity();o.setUniformf("outlineOpacity",e)}t.lightComplexity>0&&(o.setUniformf("vAmbient",s.getAmbient()),o.setUniformf("vDiffuse",s.getDiffuse()),o.setUniformf("vSpecular",s.getSpecular()),o.setUniformf("vSpecularPower",s.getSpecularPower()))},e.getClippingPlaneShaderParameters=(e,n,r)=>{if(t.renderable.getClippingPlanes().length>0){const r=t.openGLCamera.getKeyMatrices(n),i=[],o=[],s=[],l=t.renderable.getClippingPlanes(),c=l.length;for(let e=0;e<c;++e){const t=l[e].getNormal(),n=l[e].getOrigin();a.eR.transformMat3(t,t,r.normalMatrix),a.eR.transformMat4(n,n,r.wcvc);const c=-1*a.eR.dot(n,t);i.push(t[0]),i.push(t[1]),i.push(t[2]),o.push(c),s.push(n[0]),s.push(n[1]),s.push(n[2])}const u=e.getProgram();u.setUniform3fv("vClipPlaneNormals",i),u.setUniformfv("vClipPlaneDistances",o),u.setUniform3fv("vClipPlaneOrigins",s),u.setUniformi("clip_numPlanes",c)}},e.delete=(0,r.h)((()=>{t._animationRateSubscription&&(t._animationRateSubscription.unsubscribe(),t._animationRateSubscription=null)}),(()=>{t._openGLRenderWindow&&n(t._openGLRenderWindow)}),e.delete),e.getRenderTargetSize=()=>{if(t._useSmallViewport)return[t._smallViewportWidth,t._smallViewportHeight];const{usize:e,vsize:n}=t._openGLRenderer.getTiledSizeAndOrigin();return[e,n]},e.getRenderTargetOffset=()=>{const{lowerLeftU:e,lowerLeftV:n}=t._openGLRenderer.getTiledSizeAndOrigin();return[e,n]},e.getCurrentSampleDistance=e=>{const n=e.getVTKWindow().getInteractor(),r=t.renderable.getSampleDistance();if(n.isAnimating()){return r*t.renderable.getInteractionSampleDistanceFactor()}return r},e.renderPieceStart=(n,r)=>{const i=n.getVTKWindow().getInteractor();if(t._lastScale||(t._lastScale=t.renderable.getInitialInteractionScale()),t._useSmallViewport=!1,i.isAnimating()&&t._lastScale>1.5&&(t._useSmallViewport=!0),t._animationRateSubscription||(t._animationRateSubscription=i.onAnimationFrameRateUpdate((()=>{if(t.renderable.getAutoAdjustSampleDistances()){const e=i.getRecentAnimationFrameRate(),n=i.getDesiredUpdateRate()/e;(n>1.15||n<.85)&&(t._lastScale*=n),t._lastScale>400&&(t._lastScale=400),t._lastScale<1.5&&(t._lastScale=1.5)}else t._lastScale=t.renderable.getImageSampleDistance()*t.renderable.getImageSampleDistance()}))),t._useSmallViewport){const e=t._openGLRenderWindow.getFramebufferSize(),n=1/Math.sqrt(t._lastScale);if(t._smallViewportWidth=Math.ceil(n*e[0]),t._smallViewportHeight=Math.ceil(n*e[1]),t._smallViewportHeight>e[1]&&(t._smallViewportHeight=e[1]),t._smallViewportWidth>e[0]&&(t._smallViewportWidth=e[0]),t.framebuffer.saveCurrentBindingsAndBuffers(),null===t.framebuffer.getGLFramebuffer())t.framebuffer.create(e[0],e[1]),t.framebuffer.populateFramebuffer();else{const n=t.framebuffer.getSize();n&&n[0]===e[0]&&n[1]===e[1]||(t.framebuffer.create(e[0],e[1]),t.framebuffer.populateFramebuffer())}t.framebuffer.bind();const r=t.context;r.clearColor(0,0,0,0),r.colorMask(!0,!0,!0,!0),r.clear(r.COLOR_BUFFER_BIT),r.viewport(0,0,t._smallViewportWidth,t._smallViewportHeight),t.fvp=[t._smallViewportWidth/e[0],t._smallViewportHeight/e[1]]}t.context.disable(t.context.DEPTH_TEST),e.updateBufferObjects(n,r);r.getProperty().getInterpolationType()===b.VO.NEAREST?(t.scalarTexture.setMinificationFilter(y.dJ.NEAREST),t.scalarTexture.setMagnificationFilter(y.dJ.NEAREST)):(t.scalarTexture.setMinificationFilter(y.dJ.LINEAR),t.scalarTexture.setMagnificationFilter(y.dJ.LINEAR)),null!==t.zBufferTexture&&t.zBufferTexture.activate()},e.renderPieceDraw=(n,r)=>{const i=t.context;t.scalarTexture.activate(),t.opacityTexture.activate(),t.labelOutlineThicknessTexture.activate(),t.colorTexture.activate(),t.jitterTexture.activate(),e.updateShaders(t.tris,n,r),i.drawArrays(i.TRIANGLES,0,t.tris.getCABO().getElementCount()),t.tris.getVAO().release(),t.scalarTexture.deactivate(),t.colorTexture.deactivate(),t.opacityTexture.deactivate(),t.labelOutlineThicknessTexture.deactivate(),t.jitterTexture.deactivate()},e.renderPieceFinish=(e,n)=>{if(null!==t.zBufferTexture&&t.zBufferTexture.deactivate(),t._useSmallViewport){if(t.framebuffer.restorePreviousBindingsAndBuffers(),null===t.copyShader){t.copyShader=t._openGLRenderWindow.getShaderCache().readyShaderProgramArray(["//VTK::System::Dec","attribute vec4 vertexDC;","uniform vec2 tfactor;","varying vec2 tcoord;","void main() { tcoord = vec2(vertexDC.x*0.5 + 0.5, vertexDC.y*0.5 + 0.5) * tfactor; gl_Position = vertexDC; }"].join("\n"),["//VTK::System::Dec","//VTK::Output::Dec","uniform sampler2D texture1;","varying vec2 tcoord;","void main() { gl_FragData[0] = texture2D(texture1,tcoord); }"].join("\n"),"");const e=t.copyShader;t.copyVAO=m.Ay.newInstance(),t.copyVAO.setOpenGLRenderWindow(t._openGLRenderWindow),t.tris.getCABO().bind(),t.copyVAO.addAttributeArray(e,t.tris.getCABO(),"vertexDC",t.tris.getCABO().getVertexOffset(),t.tris.getCABO().getStride(),t.context.FLOAT,3,t.context.FALSE)||_("Error setting vertexDC in copy shader VAO.")}else t._openGLRenderWindow.getShaderCache().readyShaderProgram(t.copyShader);const e=t._openGLRenderWindow.getFramebufferSize();t.context.viewport(0,0,e[0],e[1]);const n=t.framebuffer.getColorTexture();n.activate(),t.copyShader.setUniformi("texture",n.getTextureUnit()),t.copyShader.setUniform2f("tfactor",t.fvp[0],t.fvp[1]);const r=t.context;r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA),t.context.drawArrays(t.context.TRIANGLES,0,t.tris.getCABO().getElementCount()),n.deactivate(),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA)}},e.renderPiece=(n,r)=>{e.invokeEvent({type:"StartEvent"}),t.renderable.update(),t.currentInput=t.renderable.getInputData(),e.invokeEvent({type:"EndEvent"}),t.currentInput?(e.renderPieceStart(n,r),e.renderPieceDraw(n,r),e.renderPieceFinish(n,r)):_("No input!")},e.computeBounds=(n,r)=>{e.getInput()?t.bounds=e.getInput().getBounds():(0,u.u)(t.Bounds)},e.updateBufferObjects=(t,n)=>{e.getNeedToRebuildBufferObjects(t,n)&&e.buildBufferObjects(t,n)},e.getNeedToRebuildBufferObjects=(n,r)=>t.VBOBuildTime.getMTime()<e.getMTime()||t.VBOBuildTime.getMTime()<r.getMTime()||t.VBOBuildTime.getMTime()<t.renderable.getMTime()||t.VBOBuildTime.getMTime()<r.getProperty().getMTime()||t.VBOBuildTime.getMTime()<t.currentInput.getMTime()||!t.scalarTexture?.getHandle()||!t.colorTexture?.getHandle()||!t.labelOutlineThicknessTexture?.getHandle(),e.buildBufferObjects=(n,r)=>{const i=t.currentInput;if(!i)return;const o=i.getPointData()&&i.getPointData().getScalars();if(!o)return;const a=r.getProperty();if(!t.jitterTexture.getHandle()){const e=new Uint8Array(1024);for(let t=0;t<1024;++t)e[t]=255*Math.random();t.jitterTexture.setMinificationFilter(y.dJ.LINEAR),t.jitterTexture.setMagnificationFilter(y.dJ.LINEAR),t.jitterTexture.create2DFromRaw(32,32,1,l.JA.UNSIGNED_CHAR,e)}const c=o.getNumberOfComponents(),u=e.useIndependentComponents(a),d=u?c:1,f=a.getScalarOpacity(),h=t._openGLRenderWindow.getGraphicsResourceForObject(f);let m=(0,A.gP)(f,u,d);if(!h?.oglObject||h.hash!==m){t.opacityTexture=p.Ay.newInstance(),t.opacityTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const r=1024,i=2*r*d,o=new Float32Array(i),s=new Float32Array(r);for(let t=0;t<d;++t){const i=a.getScalarOpacity(t),l=e.getCurrentSampleDistance(n)/a.getScalarOpacityUnitDistance(t),c=i.getRange();i.getTable(c[0],c[1],r,s,1);for(let e=0;e<r;++e)o[t*r*2+e]=1-(1-s[e])**l,o[t*r*2+e+r]=o[t*r*2+e]}if(t.opacityTexture.resetFormatAndType(),t.opacityTexture.setMinificationFilter(y.dJ.LINEAR),t.opacityTexture.setMagnificationFilter(y.dJ.LINEAR),t._openGLRenderWindow.getWebgl2()||t.context.getExtension("OES_texture_float")&&t.context.getExtension("OES_texture_float_linear"))t.opacityTexture.create2DFromRaw(r,2*d,1,l.JA.FLOAT,o);else{const e=new Uint8ClampedArray(i);for(let t=0;t<i;++t)e[t]=255*o[t];t.opacityTexture.create2DFromRaw(r,2*d,1,l.JA.UNSIGNED_CHAR,e)}f&&(t._openGLRenderWindow.setGraphicsResourceForObject(f,t.opacityTexture,m),f!==t._scalarOpacityFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(f,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._scalarOpacityFunc,e)),t._scalarOpacityFunc=f)}else t.opacityTexture=h.oglObject;const g=a.getRGBTransferFunction();m=(0,A.gP)(g,u,d);const b=t._openGLRenderWindow.getGraphicsResourceForObject(g);if(!b?.oglObject?.getHandle()||b?.hash!==m){t.colorTexture=p.Ay.newInstance(),t.colorTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const n=1024,r=new Uint8ClampedArray(2*n*d*3),i=new Float32Array(3*n);for(let e=0;e<d;++e){const t=a.getRGBTransferFunction(e),o=t.getRange();t.getTable(o[0],o[1],n,i,1);for(let t=0;t<3*n;++t)r[e*n*6+t]=255*i[t],r[e*n*6+t+3*n]=255*i[t]}t.colorTexture.resetFormatAndType(),t.colorTexture.setMinificationFilter(y.dJ.LINEAR),t.colorTexture.setMagnificationFilter(y.dJ.LINEAR),t.colorTexture.create2DFromRaw(n,2*d,3,l.JA.UNSIGNED_CHAR,r),g&&(t._openGLRenderWindow.setGraphicsResourceForObject(g,t.colorTexture,m),g!==t._colorTransferFunc&&(t._openGLRenderWindow.registerGraphicsResourceUser(g,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._colorTransferFunc,e)),t._colorTransferFunc=g)}else t.colorTexture=b.oglObject;e.updateLabelOutlineThicknessTexture(r);const x=t._openGLRenderWindow.getGraphicsResourceForObject(o);m=(0,A.eS)(i,o);const C=!x?.oglObject?.getHandle()||x?.hash!==m,T=t.renderable.getUpdatedExtents(),S=!!T.length;if(C&&!S){t.scalarTexture=p.Ay.newInstance(),t.scalarTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const n=i.getDimensions();t.scalarTexture.setOglNorm16Ext(t.context.getExtension("EXT_texture_norm16")),t.scalarTexture.resetFormatAndType(),t.scalarTexture.create3DFilterableFromDataArray(n[0],n[1],n[2],o),o&&(t._openGLRenderWindow.setGraphicsResourceForObject(o,t.scalarTexture,m),o!==t._scalars&&(t._openGLRenderWindow.registerGraphicsResourceUser(o,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._scalars,e)),t._scalars=o)}else t.scalarTexture=x.oglObject;if(S){t.renderable.setUpdatedExtents([]);const e=i.getDimensions();t.scalarTexture.create3DFilterableFromDataArray(e[0],e[1],e[2],o,!1,T)}if(!t.tris.getCABO().getElementCount()){const e=new Float32Array(12);for(let t=0;t<4;t++)e[3*t]=t%2*2-1,e[3*t+1]=t>1?1:-1,e[3*t+2]=-1;const n=new Uint16Array(8);n[0]=3,n[1]=0,n[2]=1,n[3]=3,n[4]=3,n[5]=0,n[6]=3,n[7]=2;const r=s.Ay.newInstance({numberOfComponents:3,values:e});r.setName("points");const i=s.Ay.newInstance({numberOfComponents:1,values:n});t.tris.getCABO().createVBO(i,"polys",v.YL.SURFACE,{points:r,cellOffset:0})}t.VBOBuildTime.modified()},e.updateLabelOutlineThicknessTexture=n=>{const r=n.getProperty().getLabelOutlineThickness(),i=t._openGLRenderWindow.getGraphicsResourceForObject(r),o=`${r.join("-")}`;if(!i?.oglObject?.getHandle()||i?.hash!==o){t.labelOutlineThicknessTexture=p.Ay.newInstance(),t.labelOutlineThicknessTexture.setOpenGLRenderWindow(t._openGLRenderWindow);const n=1024,i=1,a=new Uint8Array(n*i);for(let e=0;e<n;++e){const t=void 0!==r[e]?r[e]:r[0];a[e]=t}t.labelOutlineThicknessTexture.resetFormatAndType(),t.labelOutlineThicknessTexture.setMinificationFilter(y.dJ.NEAREST),t.labelOutlineThicknessTexture.setMagnificationFilter(y.dJ.NEAREST),t.labelOutlineThicknessTexture.create2DFromRaw(n,i,1,l.JA.UNSIGNED_CHAR,a),r&&(t._openGLRenderWindow.setGraphicsResourceForObject(r,t.labelOutlineThicknessTexture,o),r!==t._labelOutlineThicknessArray&&(t._openGLRenderWindow.registerGraphicsResourceUser(r,e),t._openGLRenderWindow.unregisterGraphicsResourceUser(t._labelOutlineThicknessArray,e)),t._labelOutlineThicknessArray=r)}else t.labelOutlineThicknessTexture=i.oglObject},e.isLabelmapOutlineRequired=e=>{const n=e.getProperty(),r=t.renderable;return n.getUseLabelOutline()||r.getBlendMode()===x.Nx.LABELMAP_EDGE_PROJECTION_BLEND}}const E={context:null,VBOBuildTime:null,scalarTexture:null,opacityTexture:null,opacityTextureString:null,colorTexture:null,colorTextureString:null,jitterTexture:null,labelOutlineThicknessTexture:null,labelOutlineThicknessTextureString:null,tris:null,framebuffer:null,copyShader:null,copyVAO:null,lastXYF:1,targetXYF:1,zBufferTexture:null,lastZBufferTexture:null,lightComplexity:0,fullViewportTime:1,idxToView:null,idxNormalMatrix:null,modelToView:null,projectionToView:null,avgWindowArea:0,avgFrameTime:0};function D(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,E,n),g.A.extend(e,t,n),f.A.implementBuildShadersWithReplacements(e,t,n),t.VBOBuildTime={},(0,r.o)(t.VBOBuildTime,{mtime:0}),t.tris=c.Ay.newInstance(),t.jitterTexture=p.Ay.newInstance(),t.jitterTexture.setWrapS(y.B_.REPEAT),t.jitterTexture.setWrapT(y.B_.REPEAT),t.framebuffer=d.Ay.newInstance(),t.idxToView=a.pB.identity(new Float64Array(16)),t.idxNormalMatrix=a.w0.identity(new Float64Array(9)),t.modelToView=a.pB.identity(new Float64Array(16)),t.projectionToView=a.pB.identity(new Float64Array(16)),t.projectionToWorld=a.pB.identity(new Float64Array(16)),(0,r.e)(e,t,["context"]),I(e,t)}const O=(0,r.n)(D,"vtkOpenGLVolumeMapper");var P={newInstance:O,extend:D};(0,S.c9)("vtkVolumeMapper",O)},23159:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var r="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkPolyDataFS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n// Template for the polydata mappers fragment shader\n\nuniform int PrimitiveIDOffset;\n\n// VC position of this fragment\n//VTK::PositionVC::Dec\n\n// optional color passed in from the vertex shader, vertexColor\n//VTK::Color::Dec\n\n// optional surface normal declaration\n//VTK::Normal::Dec\n\n// extra lighting parameters\n//VTK::Light::Dec\n\n// define vtkImageLabelOutlineOn\n//VTK::ImageLabelOutlineOn\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\n// picking support\n//VTK::Picking::Dec\n\n// Depth Peeling Support\n//VTK::DepthPeeling::Dec\n\n// clipping plane vars\n//VTK::Clip::Dec\n\n// label outline \n//VTK::LabelOutline::Dec\n\n// the output of this shader\n//VTK::Output::Dec\n\n// Apple Bug\n//VTK::PrimID::Dec\n\n// handle coincident offsets\n//VTK::Coincident::Dec\n\n//VTK::ZBuffer::Dec\n\n//VTK::LabelOutlineHelperFunction\n\nvoid main()\n{\n  // VC position of this fragment. This should not branch/return/discard.\n  //VTK::PositionVC::Impl\n\n  // Place any calls that require uniform flow (e.g. dFdx) here.\n  //VTK::UniformFlow::Impl\n\n  // Set gl_FragDepth here (gl_FragCoord.z by default)\n  //VTK::Depth::Impl\n\n  // Early depth peeling abort:\n  //VTK::DepthPeeling::PreColor\n\n  // Apple Bug\n  //VTK::PrimID::Impl\n\n  //VTK::Clip::Impl\n\n  //VTK::Color::Impl\n\n  // Generate the normal if we are not passed in one\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Light::Impl\n\n  if (gl_FragData[0].a <= 0.0)\n    {\n    discard;\n    }\n\n  //VTK::DepthPeeling::Impl\n\n  //VTK::Picking::Impl\n\n  // handle coincident offsets\n  //VTK::Coincident::Impl\n\n  //VTK::ZBuffer::Impl\n\n  //VTK::RenderPassFragmentShader::Impl\n}\n"},84839:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var r="//VTK::System::Dec\n\n/*=========================================================================\n\n  Program:   Visualization Toolkit\n  Module:    vtkPolyDataVS.glsl\n\n  Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n  All rights reserved.\n  See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n     This software is distributed WITHOUT ANY WARRANTY; without even\n     the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n     PURPOSE.  See the above copyright notice for more information.\n\n=========================================================================*/\n\nattribute vec4 vertexMC;\n\n// frag position in VC\n//VTK::PositionVC::Dec\n\n// optional normal declaration\n//VTK::Normal::Dec\n\n// extra lighting parameters\n//VTK::Light::Dec\n\n// Texture coordinates\n//VTK::TCoord::Dec\n\n// material property values\n//VTK::Color::Dec\n\n// clipping plane vars\n//VTK::Clip::Dec\n\n// camera and actor matrix values\n//VTK::Camera::Dec\n\n// Apple Bug\n//VTK::PrimID::Dec\n\n// picking support\n//VTK::Picking::Dec\n\nvoid main()\n{\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Clip::Impl\n\n  //VTK::PrimID::Impl\n\n  //VTK::PositionVC::Impl\n\n  //VTK::Light::Impl\n\n  //VTK::Picking::Impl\n}\n"},25196:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(28906);const{vtkErrorMacro:i}=r.m;const o={renderable:null,myFactory:null,children:[],visited:!1};function a(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,o,n),r.m.obj(e,t),r.m.event(e,t,"event"),t._renderableChildMap=new Map,r.m.get(e,t,["visited"]),r.m.setGet(e,t,["_parent","renderable","myFactory"]),r.m.getArray(e,t,["children"]),r.m.moveToProtected(e,t,["parent"]),function(e,t){t.classHierarchy.push("vtkViewNode"),e.build=e=>{},e.render=e=>{},e.traverse=n=>{const r=n.getTraverseOperation(),i=e[r];if(i)i(n);else{e.apply(n,!0);for(let e=0;e<t.children.length;e++)t.children[e].traverse(n);e.apply(n,!1)}},e.apply=(t,n)=>{const r=e[t.getOperation()];r&&r(n,t)},e.getViewNodeFor=n=>{if(t.renderable===n)return e;for(let e=0;e<t.children.length;++e){const r=t.children[e].getViewNodeFor(n);if(r)return r}},e.getFirstAncestorOfType=e=>t._parent?t._parent.isA(e)?t._parent:t._parent.getFirstAncestorOfType(e):null,e.getLastAncestorOfType=e=>{if(!t._parent)return null;return t._parent.getLastAncestorOfType(e)||(t._parent.isA(e)?t._parent:null)},e.addMissingNode=n=>{if(!n)return;const r=t._renderableChildMap.get(n);if(void 0!==r)return r.setVisited(!0),r;const i=e.createViewNode(n);return i?(i.setParent(e),i.setVisited(!0),t._renderableChildMap.set(n,i),t.children.push(i),i):void 0},e.addMissingNodes=t=>{if(t&&t.length)for(let n=0;n<t.length;++n){const r=t[n];e.addMissingNode(r)}},e.addMissingChildren=n=>{if(n&&n.length)for(let r=0;r<n.length;++r){const i=n[r];if(-1===t.children.indexOf(i)){i.setParent(e),t.children.push(i);const n=i.getRenderable();n&&t._renderableChildMap.set(n,i)}i.setVisited(!0)}},e.removeNode=e=>{const n=t.children.findIndex((t=>t===e));if(n<0)return!1;const r=e.getRenderable();return r&&t._renderableChildMap.delete(r),e.delete(),t.children.splice(n,1),!0},e.prepareNodes=()=>{for(let e=0;e<t.children.length;++e)t.children[e].setVisited(!1)},e.setVisited=e=>{t.visited=e},e.removeUnusedNodes=()=>{let e=0;for(let n=0;n<t.children.length;++n){const r=t.children[n];if(r.getVisited())t.children[e++]=r,r.setVisited(!1);else{const e=r.getRenderable();e&&t._renderableChildMap.delete(e),r.delete()}}t.children.length=e},e.createViewNode=e=>{if(!t.myFactory)return i("Cannot create view nodes without my own factory"),null;const n=t.myFactory.createNode(e);return n&&n.setRenderable(e),n};const n=e.delete;e.delete=()=>{for(let e=0;e<t.children.length;e++)t.children[e].delete();n()}}(e,t)}var s={newInstance:r.m.newInstance(a,"vtkViewNode"),extend:a,PASS_TYPES:["Build","Render"]}},84784:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a});var r=n(28906);const i={};function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,i,n),r.m.obj(e,t),function(e,t){t.overrides||(t.overrides={}),t.classHierarchy.push("vtkViewNodeFactory"),e.createNode=n=>{if(n.isDeleted())return null;let r=0,i=n.getClassName(r++),o=!1;const a=Object.keys(t.overrides);for(;i&&!o;)-1!==a.indexOf(i)?o=!0:i=n.getClassName(r++);if(!o)return null;const s=t.overrides[i]();return s.setMyFactory(e),s}}(e,t)}var a={newInstance:r.m.newInstance(o,"vtkViewNodeFactory"),extend:o}},10299:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a});var r=n(28906);const i={device:null,handle:null,label:null};function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,i,n),r.m.obj(e,t),t.bindables=[],t.bindGroupTime={},r.m.obj(t.bindGroupTime,{mtime:0}),r.m.get(e,t,["bindGroupTime","handle","sizeInBytes","usage"]),r.m.setGet(e,t,["label","device","arrayInformation"]),function(e,t){t.classHierarchy.push("vtkWebGPUBindGroup"),e.setBindables=n=>{if(t.bindables.length===n.length){let e=!0;for(let r=0;r<t.bindables.length;r++)t.bindables[r]!==n[r]&&(e=!1);if(e)return}t.bindables=n,e.modified()},e.getBindGroupLayout=e=>{const n=[];for(let e=0;e<t.bindables.length;e++){const r=t.bindables[e].getBindGroupLayoutEntry();r.binding=e,n.push(r)}return e.getBindGroupLayout({entries:n})},e.getBindGroup=n=>{let r=e.getMTime();for(let e=0;e<t.bindables.length;e++){const n=t.bindables[e].getBindGroupTime().getMTime();r=n>r?n:r}if(r<t.bindGroupTime.getMTime())return t.bindGroup;const i=[];for(let e=0;e<t.bindables.length;e++){const n=t.bindables[e].getBindGroupEntry();n.binding=e,i.push(n)}return t.bindGroup=n.getHandle().createBindGroup({layout:e.getBindGroupLayout(n),entries:i,label:t.label}),t.bindGroupTime.modified(),t.bindGroup},e.getShaderCode=e=>{const n=[],r=e.getBindGroupLayoutCount(t.label);for(let e=0;e<t.bindables.length;e++)n.push(t.bindables[e].getShaderCode(e,r));return n.join("\n")}}(e,t)}var a={newInstance:r.m.newInstance(o),extend:o}},49767:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>B});var r=n(28906),i=n(16632),o=n(42008);var a={BufferUsage:{Verts:0,Lines:1,Triangles:2,Strips:3,LinesFromStrips:4,LinesFromTriangles:5,Points:6,UniformArray:7,PointArray:8,NormalsFromPoints:9,Texture:10,RawVertex:11,Storage:12,Index:13},PrimitiveTypes:{Start:0,Points:0,Lines:1,Triangles:2,TriangleStrips:3,TriangleEdges:4,TriangleStripEdges:5,End:6}};const s=["getMappedRange","mapAsync","unmap"];function l(e,t){t.classHierarchy.push("vtkWebGPUBuffer"),e.create=(e,n)=>{t.handle=t.device.getHandle().createBuffer({size:e,usage:n,label:t.label}),t.sizeInBytes=e,t.usage=n},e.write=e=>{!function(e,t,n,r){const i=r.byteLength,o=e.createBuffer({size:i,usage:GPUBufferUsage.COPY_SRC,mappedAtCreation:!0}),a=o.getMappedRange(0,i);new Uint8Array(a).set(new Uint8Array(r)),o.unmap();const s=e.createCommandEncoder();s.copyBufferToBuffer(o,0,t,n,i);const l=s.finish();e.queue.submit([l]),o.destroy()}(t.device.getHandle(),t.handle,0,e.buffer)},e.createAndWrite=(e,n)=>{t.handle=t.device.getHandle().createBuffer({size:e.byteLength,usage:n,mappedAtCreation:!0,label:t.label}),t.sizeInBytes=e.byteLength,t.usage=n,new Uint8Array(t.handle.getMappedRange()).set(new Uint8Array(e.buffer)),t.handle.unmap()};for(let n=0;n<s.length;n++)e[s[n]]=function(){return t.handle[s[n]](...arguments)}}const c={device:null,handle:null,sizeInBytes:0,strideInBytes:0,arrayInformation:null,usage:null,label:null,sourceTime:null};function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,c,n),r.m.obj(e,t),r.m.get(e,t,["handle","sizeInBytes","usage"]),r.m.setGet(e,t,["strideInBytes","device","arrayInformation","label","sourceTime"]),l(e,t)}var d={newInstance:r.m.newInstance(u),extend:u,...a},p=n(89585);const{Representation:f}=p.Ay,{PrimitiveTypes:h}=a;class m{constructor(){this.keys=new Uint32Array(10),this.values=new Uint32Array(10),this.count=0}clear(){this.count=0}has(e){for(let t=0;t<this.count;t++)if(this.keys[t]===e)return!0}get(e){for(let t=0;t<this.count;t++)if(this.keys[t]===e)return this.values[t]}set(e,t){this.count<9&&(this.keys[this.count]=e,this.values[this.count++]=t)}}function g(e,t,n){let r=e.pointIdToFlatId[t];return r<0&&(r=e.flatId,e.pointIdToFlatId[t]=r,e.flatIdToPointId[e.flatId]=t,e.flatIdToCellId[e.flatId]=n,e.flatId++),r}function v(e,t,n){const r=e.length;for(let i=0;i<r;i++){let o=e[i];if(n.cellProvokedMap.has(o)){n.ibo[n.iboId++]=n.cellProvokedMap.get(o);for(let a=i+1;a<i+r;a++){o=e[a%r];const i=g(n,o,t);n.ibo[n.iboId++]=i}return}}for(let i=0;i<r;i++){let o=e[i];if(!n.provokedPointIds[o]){let a=g(n,o,t);n.provokedPointIds[o]=1,n.cellProvokedMap.set(o,a),n.flatIdToCellId[a]=t,n.ibo[n.iboId++]=a;for(let s=i+1;s<i+r;s++)o=e[s%r],a=g(n,o,t),n.ibo[n.iboId++]=a;return}}let i=e[0],o=n.flatId;n.cellProvokedMap.set(i,o),n.flatIdToPointId[n.flatId]=i,n.flatIdToCellId[n.flatId]=t,n.flatId++,n.ibo[n.iboId++]=o;for(let a=1;a<r;a++)i=e[a],o=g(n,i,t),n.ibo[n.iboId++]=o}function y(e,t,n){const r=e.length;n.iboSize+=r;for(let t=0;t<r;t++){const r=e[t];if(n.cellProvokedMap.has(r))return}for(let t=0;t<r;t++){const r=e[t];if(!n.provokedPointIds[r])return n.provokedPointIds[r]=1,void n.cellProvokedMap.set(r,1)}n.cellProvokedMap.set(e[0],1),n.extraPoints++}let b;const x=new Uint32Array(1),A=new Uint32Array(2),C=new Uint32Array(3),T={anythingToPoints(e,t,n,r,i){for(let o=0;o<e;++o)x[0]=t[n+o],b(x,r,i)},linesToWireframe(e,t,n,r,i){for(let o=0;o<e-1;++o)A[0]=t[n+o],A[1]=t[n+o+1],b(A,r,i)},polysToWireframe(e,t,n,r,i){if(e>2)for(let o=0;o<e;++o)A[0]=t[n+o],A[1]=t[n+(o+1)%e],b(A,r,i)},stripsToWireframe(e,t,n,r,i){if(e>2){for(let o=0;o<e-1;++o)A[0]=t[n+o],A[1]=t[n+o+1],b(A,r,i);for(let o=0;o<e-2;o++)A[0]=t[n+o],A[1]=t[n+o+2],b(A,r,i)}},polysToSurface(e,t,n,r,i){for(let o=0;o<e-2;o++)C[0]=t[n],C[1]=t[n+o+1],C[2]=t[n+o+2],b(C,r,i)},stripsToSurface(e,t,n,r,i){for(let o=0;o<e-2;o++)C[0]=t[n+o],C[1]=t[n+o+1+o%2],C[2]=t[n+o+1+(o+1)%2],b(C,r,i)}};function S(e,t){t.classHierarchy.push("vtkWebGPUIndexBuffer"),e.buildIndexBuffer=e=>{const n=e.cells,r=e.primitiveType,i=e.representation,o=e.cellOffset,a=n.getData(),s=a.length,l=function(e){switch(e){case h.Points:return"points";case h.Lines:return"lines";case h.Triangles:case h.TriangleEdges:return"polys";case h.TriangleStripEdges:case h.TriangleStrips:return"strips";default:return""}}(r),c=e.numberOfPoints,u={provokedPointIds:new Uint8Array(c),extraPoints:0,iboSize:0,flatId:0,iboId:0,cellProvokedMap:new m};let d=null;d=i===f.POINTS||r===h.Points?T.anythingToPoints:i===f.WIREFRAME||r===h.Lines?T[`${l}ToWireframe`]:T[`${l}ToSurface`],b=y;let p=o||0;for(let e=0;e<s;)u.cellProvokedMap.clear(),d(a[e],a,e+1,p,u),e+=a[e]+1,p++;u.flatIdToPointId=c<=65535?new Uint16Array(c+u.extraPoints):new Uint32Array(c+u.extraPoints),c+u.extraPoints<36863?u.pointIdToFlatId=new Int16Array(c):u.pointIdToFlatId=new Int32Array(c),c+u.extraPoints<=65535?(u.ibo=new Uint16Array(u.iboSize),e.format="uint16"):(u.ibo=new Uint32Array(u.iboSize),e.format="uint32"),u.flatIdToCellId=p<=65535?new Uint16Array(c+u.extraPoints):new Uint32Array(c+u.extraPoints),u.pointIdToFlatId.fill(-1),u.provokedPointIds.fill(0),b=v,p=o||0;for(let e=0;e<s;)u.cellProvokedMap.clear(),d(a[e],a,e+1,p,u),e+=a[e]+1,p++;delete u.provokedPointIds,delete u.pointIdToFlatId,e.nativeArray=u.ibo,t.flatIdToPointId=u.flatIdToPointId,t.flatIdToCellId=u.flatIdToCellId,t.flatSize=u.flatId,t.indexCount=u.iboId}}const w={flatIdToPointId:null,flatIdToCellId:null,flatSize:0,indexCount:0};function _(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,w,n),d.extend(e,t,n),r.m.setGet(e,t,["flatIdToPointId","flatIdToCellId","flatSize","indexCount"]),S(e,t)}var I={newInstance:r.m.newInstance(_),extend:_,...a},E=n(57372);const{BufferUsage:D}=a,{vtkErrorMacro:O}=r.c,{VtkDataTypes:P}=o.Ay;function R(e,t,n,i,o){const a={},s=e.getFlatSize();if(!s)return a;let l=[0,0,0,0];o.shift&&(o.shift.length?l=o.shift:l.fill(o.shift));let c=[1,1,1,1];o.scale&&(o.scale.length?c=o.scale:c.fill(o.scale));const u=!!Object.prototype.hasOwnProperty.call(o,"packExtra")&&o.packExtra;let d,p=0;const f=n+(u?1:0),h=(0,r.a)(i,s*f);let m=e.getFlatIdToPointId();o.cellData&&(m=e.getFlatIdToCellId()),1===n?d=function(e){h[p++]=c[0]*t[e]+l[0]}:2===n?d=function(e){h[p++]=c[0]*t[e]+l[0],h[p++]=c[1]*t[e+1]+l[1]}:3!==n||u?3===n&&u?d=function(e){h[p++]=c[0]*t[e]+l[0],h[p++]=c[1]*t[e+1]+l[1],h[p++]=c[2]*t[e+2]+l[2],h[p++]=1*c[3]+l[3]}:4===n&&(d=function(e){h[p++]=c[0]*t[e]+l[0],h[p++]=c[1]*t[e+1]+l[1],h[p++]=c[2]*t[e+2]+l[2],h[p++]=c[3]*t[e+3]+l[3]}):d=function(e){h[p++]=c[0]*t[e]+l[0],h[p++]=c[1]*t[e+1]+l[1],h[p++]=c[2]*t[e+2]+l[2]};for(let e=0;e<s;e++){d(n*m[e])}return a.nativeArray=h,a}function N(e,t,n,r){const o=[e[3*r]-e[3*n],e[3*r+1]-e[3*n+1],e[3*r+2]-e[3*n+2]],a=[e[3*t]-e[3*n],e[3*t+1]-e[3*n+1],e[3*t+2]-e[3*n+2]],s=[];return(0,i.j)(o,a,s),(0,i.l)(s),s}function M(e,t){function n(e){let n,r;if(e.dataArray&&!e.nativeArray&&(e.nativeArray=e.dataArray.getData()),e.usage===D.Index&&(n=I.newInstance({label:e.label}),n.setDevice(t.device),r=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,n.buildIndexBuffer(e),n.createAndWrite(e.nativeArray,r),n.setArrayInformation([{format:e.format}])),n||(n=d.newInstance({label:e.label}),n.setDevice(t.device)),e.usage===D.UniformArray&&(r=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,n.createAndWrite(e.nativeArray,r)),e.usage===D.Storage&&(r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,n.createAndWrite(e.nativeArray,r)),e.usage===D.Texture&&(r=GPUBufferUsage.COPY_SRC,n.createAndWrite(e.nativeArray,r)),e.usage===D.PointArray){r=GPUBufferUsage.VERTEX;const t=E.A.getNativeTypeFromBufferFormat(e.format),i=R(e.indexBuffer,e.dataArray.getData(),e.dataArray.getNumberOfComponents(),t,{packExtra:e.packExtra,shift:e.shift,scale:e.scale,cellData:e.cellData,cellOffset:e.cellOffset});n.createAndWrite(i.nativeArray,r),n.setStrideInBytes(E.A.getByteStrideFromBufferFormat(e.format)),n.setArrayInformation([{offset:0,format:e.format,interpolation:e.cellData?"flat":"perspective"}])}if(e.usage===D.NormalsFromPoints){r=GPUBufferUsage.VERTEX;const t=E.A.getNativeTypeFromBufferFormat(e.format),i=function(e,t){const n=t.getData(),r=e.getData();if(!r||!n)return null;const i=new Int8Array(4*e.getNumberOfCells()),o=r.length;let a=0;for(let e=0;e<o;){const t=N(n,r[e+1],r[e+2],r[e+3]);i[a++]=127*t[0],i[a++]=127*t[1],i[a++]=127*t[2],i[a++]=127,e+=r[e]+1}return i}(e.cells,e.dataArray),o=R(e.indexBuffer,i,4,t,{cellData:!0});n.createAndWrite(o.nativeArray,r),n.setStrideInBytes(E.A.getByteStrideFromBufferFormat(e.format)),n.setArrayInformation([{offset:0,format:e.format,interpolation:"flat"}])}return e.usage===D.RawVertex&&(r=GPUBufferUsage.VERTEX,n.createAndWrite(e.nativeArray,r),n.setStrideInBytes(E.A.getByteStrideFromBufferFormat(e.format)),n.setArrayInformation([{offset:0,format:e.format}])),n.setSourceTime(e.time),n}t.classHierarchy.push("vtkWebGPUBufferManager"),e.hasBuffer=e=>t.device.hasCachedObject(e),e.getBuffer=e=>e.hash?t.device.getCachedObject(e.hash,n,e):n(e),e.getBufferForPointArray=(t,n)=>{const r=function(e){let t;switch(e.getDataType()){case P.UNSIGNED_CHAR:t="uint8";break;case P.FLOAT:t="float32";break;case P.UNSIGNED_INT:t="uint32";break;case P.INT:t="sint32";break;case P.DOUBLE:t="float32";break;case P.UNSIGNED_SHORT:t="uint16";break;case P.SHORT:t="sin16";break;default:t="float32"}switch(e.getNumberOfComponents()){case 2:t+="x2";break;case 3:t.includes("32")||O(`unsupported x3 type for ${t}`),t+="x3";break;case 4:t+="x4"}return t}(t),i={hash:`${t.getMTime()}I${n.getMTime()}${r}`,usage:D.PointArray,format:r,dataArray:t,indexBuffer:n};return e.getBuffer(i)},e.getFullScreenQuadBuffer=()=>{if(t.fullScreenQuadBuffer)return t.fullScreenQuadBuffer;t.fullScreenQuadBuffer=d.newInstance(),t.fullScreenQuadBuffer.setDevice(t.device);const e=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]);return t.fullScreenQuadBuffer.createAndWrite(e,GPUBufferUsage.VERTEX),t.fullScreenQuadBuffer.setStrideInBytes(12),t.fullScreenQuadBuffer.setArrayInformation([{offset:0,format:"float32x3"}]),t.fullScreenQuadBuffer}}const L={device:null,fullScreenQuadBuffer:null};function F(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,L,n),(0,r.o)(e,t),(0,r.e)(e,t,["device"]),M(e,t)}var B={newInstance:(0,r.n)(F),extend:F,...a}},26910:(e,t,n)=>{"use strict";var r=n(3823),i=n(28906),o=n(25196),a=n(50440);const s={keyMatrixTime:null,keyMatrices:null};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),o.A.extend(e,t,n),t.keyMatrixTime={},i.m.obj(t.keyMatrixTime),t.keyMatrices={normalMatrix:new Float64Array(16),vcpc:new Float64Array(16),pcsc:new Float64Array(16),wcvc:new Float64Array(16),scpc:new Float64Array(16),scvc:new Float64Array(16)},i.m.setGet(e,t,["keyMatrixTime"]),function(e,t){t.classHierarchy.push("vtkWebGPUCamera"),e.getProjectionMatrix=(e,n,i,o)=>{if(r.pB.identity(e),t.renderable.getParallelProjection()){const r=t.renderable.getParallelScale(),a=r*n,s=r,l=(o[0]-1)*a,c=(o[0]+1)*a,u=(o[1]-1)*s,d=(o[1]+1)*s,p=1/(c-l),f=1/(d-u);e[0]=2*p,e[5]=2*f,e[10]=1/(i[1]-i[0]),e[12]=(c+l)*p,e[13]=(d+u)*f,e[14]=i[1]/(i[1]-i[0])}else{const r=Math.tan(Math.PI*t.renderable.getViewAngle()/360);let a,s;!0===t.renderable.getUseHorizontalViewAngle()?(a=i[0]*r,s=i[0]*r/n):(a=i[0]*r*n,s=i[0]*r);const l=(o[0]-1)*a,c=(o[0]+1)*a,u=(o[1]-1)*s,d=(o[1]+1)*s;e[0]=2*i[0]/(c-l),e[5]=2*i[0]/(d-u),e[12]=(l+c)/(c-l),e[13]=(u+d)/(d-u),e[10]=0,e[14]=i[0],e[11]=-1,e[15]=0}},e.convertToOpenGLDepth=e=>{if(t.renderable.getParallelProjection())return 1-e;const n=t.renderable.getClippingRangeByReference();let r=-n[0]/e;return r=(n[0]+n[1])/(n[1]-n[0])+2*n[0]*n[1]/(r*(n[1]-n[0])),.5*r+.5},e.getKeyMatrices=n=>{const i=n.getRenderable(),o=n.getParent();if(Math.max(o.getMTime(),e.getMTime(),i.getMTime(),t.renderable.getMTime(),n.getStabilizedTime())>t.keyMatrixTime.getMTime()){const i=t.renderable.getViewMatrix();r.pB.copy(t.keyMatrices.normalMatrix,i),t.keyMatrices.normalMatrix[3]=0,t.keyMatrices.normalMatrix[7]=0,t.keyMatrices.normalMatrix[11]=0,r.pB.invert(t.keyMatrices.normalMatrix,t.keyMatrices.normalMatrix),r.pB.transpose(t.keyMatrices.wcvc,i);const o=n.getStabilizedCenterByReference();r.pB.translate(t.keyMatrices.scvc,t.keyMatrices.wcvc,o);const a=n.getAspectRatio(),s=t.renderable.getClippingRangeByReference();e.getProjectionMatrix(t.keyMatrices.vcpc,a,s,t.renderable.getWindowCenterByReference()),r.pB.multiply(t.keyMatrices.scpc,t.keyMatrices.vcpc,t.keyMatrices.scvc),r.pB.invert(t.keyMatrices.pcsc,t.keyMatrices.scpc),t.keyMatrixTime.modified()}return t.keyMatrices}}(e,t)}const c=i.m.newInstance(l);(0,a.c9)("vtkCamera",c)},94363:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>l});var r=n(28906),i=n(9806),o=n(32603);const a={};function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,a,n),o.Ay.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkWebGPUFullScreenQuad"),e.replaceShaderPosition=(e,t,n)=>{const r=t.getShaderDescription("vertex");r.addBuiltinOutput("vec4<f32>","@builtin(position) Position"),r.addOutput("vec4<f32>","vertexVC");let o=r.getCode();o=i.Ay.substitute(o,"//VTK::Position::Impl",["output.tcoordVS = vec2<f32>(vertexBC.x * 0.5 + 0.5, 1.0 - vertexBC.y * 0.5 - 0.5);","output.Position = vec4<f32>(vertexBC, 1.0);","output.vertexVC = vec4<f32>(vertexBC, 1);"]).result,r.setCode(o)},t.shaderReplacements.set("replaceShaderPosition",e.replaceShaderPosition),e.updateBuffers=()=>{const e=t.device.getBufferManager().getFullScreenQuadBuffer();t.vertexInput.addBuffer(e,["vertexBC"]),t.numberOfVertices=6}}(e,t)}var l={newInstance:r.m.newInstance(s,"vtkWebGPUFullScreenQuad"),extend:s}},77489:(e,t,n)=>{"use strict";var r=n(28906),i=n(25196),o=n(50440);const a={};function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,a,n),i.A.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkWebGPUPixelSpaceCallbackMapper"),e.opaquePass=(n,r)=>{t.WebGPURenderer=e.getFirstAncestorOfType("vtkWebGPURenderer"),t.WebGPURenderWindow=t.WebGPURenderer.getParent();const i=t.WebGPURenderer.getAspectRatio(),o=t.WebGPURenderer?t.WebGPURenderer.getRenderable().getActiveCamera():null,a=t.WebGPURenderer.getTiledSizeAndOrigin();t.renderable.getUseZValues(),t.renderable.invokeCallback(t.renderable.getInputData(),o,i,a,null)}}(e,t)}const l=r.m.newInstance(s,"vtkWebGPUPixelSpaceCallbackMapper");(0,o.c9)("vtkPixelSpaceCallbackMapper",l)},24210:(e,t,n)=>{"use strict";var r=n(3823),i=n(28906),o=n(16632),a=n(25196),s=n(10299),l=n(94363),c=n(49767),u=n(57372);const{BufferUsage:d}=c.Ay,{vtkErrorMacro:p}=i.m;const f={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,numberOfInstances:1};function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,f,n),i.m.obj(e,t),t._bufferEntryNames=new Map,t.bufferEntries=[],t._sendTime={},i.m.obj(t._sendTime,{mtime:0}),t.bindGroupTime={},i.m.obj(t.bindGroupTime,{mtime:0}),t.bindGroupLayoutEntry=t.bindGroupLayoutEntry||{buffer:{type:"read-only-storage"}},i.m.get(e,t,["bindGroupTime"]),i.m.setGet(e,t,["device","bindGroupLayoutEntry","label","numberOfInstances","sizeInBytes"]),function(e,t){t.classHierarchy.push("vtkWebGPUStorageBuffer"),e.addEntry=(e,n)=>{if(t._bufferEntryNames.has(e))return void p(`entry named ${e} already exists`);t._bufferEntryNames.set(e,t.bufferEntries.length);const r=u.A.getByteStrideFromShaderFormat(n);t.bufferEntries.push({name:e,type:n,sizeInBytes:r,offset:t.sizeInBytes,nativeType:u.A.getNativeTypeFromShaderFormat(n)}),t.sizeInBytes+=r},e.send=e=>{if(!t._buffer){const n={nativeArray:t.Float32Array,usage:d.Storage,label:t.label};return t._buffer=e.getBufferManager().getBuffer(n),t.bindGroupTime.modified(),void t._sendTime.modified()}e.getHandle().queue.writeBuffer(t._buffer.getHandle(),0,t.arrayBuffer,0,t.sizeInBytes*t.numberOfInstances),t._sendTime.modified()},e.createView=e=>{e in t==0&&(t.arrayBuffer||(t.arrayBuffer=new ArrayBuffer(t.sizeInBytes*t.numberOfInstances)),t[e]=i.m.newTypedArray(e,t.arrayBuffer))},e.setValue=(n,r,i)=>{const o=t._bufferEntryNames.get(n);if(void 0===o)return void p(`entry named ${n} not found in UBO`);const a=t.bufferEntries[o];e.createView(a.nativeType);const s=t[a.nativeType];s[(a.offset+r*t.sizeInBytes)/s.BYTES_PER_ELEMENT]=i},e.setArray=(n,r,i)=>{const o=t._bufferEntryNames.get(n);if(void 0===o)return void p(`entry named ${n} not found in UBO`);const a=t.bufferEntries[o];e.createView(a.nativeType);const s=t[a.nativeType],l=(a.offset+r*t.sizeInBytes)/s.BYTES_PER_ELEMENT;for(let e=0;e<i.length;e++)s[l+e]=i[e]},e.setAllInstancesFromArray=(n,r)=>{const i=t._bufferEntryNames.get(n);if(void 0===i)return void p(`entry named ${n} not found in UBO`);const o=t.bufferEntries[i];e.createView(o.nativeType);const a=t[o.nativeType],s=r.length/t.numberOfInstances;for(let e=0;e<t.numberOfInstances;e++){const n=(o.offset+e*t.sizeInBytes)/a.BYTES_PER_ELEMENT;for(let t=0;t<s;t++)a[n+t]=r[e*s+t]}},e.setAllInstancesFromArrayColorToFloat=(n,r)=>{const i=t._bufferEntryNames.get(n);if(void 0===i)return void p(`entry named ${n} not found in UBO`);const o=t.bufferEntries[i];e.createView(o.nativeType);const a=t[o.nativeType],s=r.length/t.numberOfInstances;for(let e=0;e<t.numberOfInstances;e++){const n=(o.offset+e*t.sizeInBytes)/a.BYTES_PER_ELEMENT;for(let t=0;t<s;t++)a[n+t]=r[e*s+t]/255}},e.setAllInstancesFromArray3x3To4x4=(n,r)=>{const i=t._bufferEntryNames.get(n);if(void 0===i)return void p(`entry named ${n} not found in UBO`);const o=t.bufferEntries[i];e.createView(o.nativeType);const a=t[o.nativeType];for(let e=0;e<t.numberOfInstances;e++){const n=(o.offset+e*t.sizeInBytes)/a.BYTES_PER_ELEMENT;for(let t=0;t<3;t++)for(let i=0;i<3;i++)a[n+4*t+i]=r[9*e+3*t+i]}},e.getSendTime=()=>t._sendTime.getMTime(),e.getShaderCode=(e,n)=>{const r=[`struct ${t.label}StructEntry\n{`];for(let e=0;e<t.bufferEntries.length;e++){const n=t.bufferEntries[e];r.push(`  ${n.name}: ${n.type},`)}return r.push(`\n};\nstruct ${t.label}Struct\n{\n  values: array<${t.label}StructEntry>,\n};\n@binding(${e}) @group(${n}) var<storage, read> ${t.label}: ${t.label}Struct;\n`),r.join("\n")},e.getBindGroupEntry=()=>({resource:{buffer:t._buffer.getHandle()}}),e.clearData=()=>{t.numberOfInstances=0,t.sizeInBytes=0,t.bufferEntries=[],t._bufferEntryNames=new Map,t._buffer=null,delete t.arrayBuffer,delete t.Float32Array}}(e,t)}var m={newInstance:i.m.newInstance(h,"vtkWebGPUStorageBuffer"),extend:h},g=n(83259),v=n(50440);const{vtkDebugMacro:y}=i.c,b="\n//VTK::Renderer::Dec\n\n//VTK::Mapper::Dec\n\n//VTK::TCoord::Dec\n\n//VTK::RenderEncoder::Dec\n\n//VTK::IOStructs::Dec\n\n@fragment\nfn main(\n//VTK::IOStructs::Input\n)\n//VTK::IOStructs::Output\n{\n  var output: fragmentOutput;\n\n  var computedColor: vec4<f32> = mapperUBO.BackgroundColor;\n\n  //VTK::RenderEncoder::Impl\n  return output;\n}\n",x="\nfn vecToRectCoord(dir: vec3<f32>) -> vec2<f32> {\n  var tau: f32 = 6.28318530718;\n  var pi: f32 = 3.14159265359;\n  var out: vec2<f32> = vec2<f32>(0.0);\n\n  out.x = atan2(dir.z, dir.x) / tau;\n  out.x += 0.5;\n\n  var phix: f32 = length(vec2(dir.x, dir.z));\n  out.y = atan2(dir.y, phix) / pi + 0.5;\n\n  return out;\n}\n\n//VTK::Renderer::Dec\n\n//VTK::Mapper::Dec\n\n//VTK::TCoord::Dec\n\n//VTK::RenderEncoder::Dec\n\n//VTK::IOStructs::Dec\n\n@fragment\nfn main(\n//VTK::IOStructs::Input\n)\n//VTK::IOStructs::Output\n{\n  var output: fragmentOutput;\n\n  var tcoord: vec4<f32> = vec4<f32>(input.vertexVC.xy, -1, 1);\n  var V: vec4<f32> = normalize(mapperUBO.FSQMatrix * tcoord); // vec2<f32>((input.tcoordVS.x - 0.5) * 2, -(input.tcoordVS.y - 0.5) * 2);\n  // textureSampleLevel gets rid of some ugly artifacts\n  var background = textureSampleLevel(EnvironmentTexture, EnvironmentTextureSampler, vecToRectCoord(V.xyz), 0.0);\n  var computedColor: vec4<f32> = vec4<f32>(background.rgb, 1);\n\n  //VTK::RenderEncoder::Impl\n  return output;\n}\n",A=new Float64Array(16),C=new Float64Array(16);const T={bindGroup:null,selector:null,renderEncoder:null,recenterThreshold:20,suppressClear:!1,stabilizedCenter:[0,0,0]};function S(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,T,n),a.A.extend(e,t,n),t.UBO=g.Ay.newInstance({label:"rendererUBO"}),t.UBO.addEntry("WCVCMatrix","mat4x4<f32>"),t.UBO.addEntry("SCPCMatrix","mat4x4<f32>"),t.UBO.addEntry("PCSCMatrix","mat4x4<f32>"),t.UBO.addEntry("SCVCMatrix","mat4x4<f32>"),t.UBO.addEntry("VCPCMatrix","mat4x4<f32>"),t.UBO.addEntry("WCVCNormals","mat4x4<f32>"),t.UBO.addEntry("viewportSize","vec2<f32>"),t.UBO.addEntry("LightCount","i32"),t.UBO.addEntry("MaxEnvironmentMipLevel","f32"),t.UBO.addEntry("BackgroundDiffuseStrength","f32"),t.UBO.addEntry("BackgroundSpecularStrength","f32"),t.UBO.addEntry("cameraParallel","u32"),t.SSBO=m.newInstance({label:"rendererLightSSBO"}),t.lightTimeString="",t.bindGroup=s.Ay.newInstance({label:"rendererBG"}),t.bindGroup.setBindables([t.UBO,t.SSBO]),t.tmpMat4=r.pB.identity(new Float64Array(16)),t.stabilizedTime={},(0,i.o)(t.stabilizedTime,{mtime:0}),(0,i.g)(e,t,["bindGroup","stabilizedTime"]),(0,i.k)(e,t,["stabilizedCenter"]),(0,i.e)(e,t,["renderEncoder","selector","suppressClear","UBO"]),function(e,t){t.classHierarchy.push("vtkWebGPURenderer"),e.buildPass=n=>{if(n){if(!t.renderable)return;t.camera=t.renderable.getActiveCamera(),e.updateLights(),e.prepareNodes(),e.addMissingNode(t.camera),e.addMissingNodes(t.renderable.getViewPropsWithNestedProps()),e.removeUnusedNodes(),t.webgpuCamera=e.getViewNodeFor(t.camera),e.updateStabilizedMatrix()}},e.updateStabilizedMatrix=()=>{const e=t.camera.getClippingRange(),n=t.camera.getPositionByReference(),i=t.camera.getDirectionOfProjectionByReference(),o=[],a=[];r.eR.scale(a,i,.5*(e[0]+e[1])),r.eR.add(o,n,a),r.eR.sub(a,o,t.stabilizedCenter),r.eR.len(a)/(e[1]-e[0])>t.recenterThreshold&&(t.stabilizedCenter=o,t.stabilizedTime.modified())},e.updateLights=()=>{let e=0;const n=t.renderable.getLightsByReference();for(let t=0;t<n.length;++t)n[t].getSwitch()>0&&e++;return e||(y("No lights are on, creating one."),t.renderable.createLight()),e},e.updateUBO=()=>{const n=t.UBO.getSendTime();if(t._parent.getMTime()>n||e.getMTime()>n||t.camera.getMTime()>n||t.renderable.getMTime()>n){const n=t.webgpuCamera.getKeyMatrices(e);t.UBO.setArray("WCVCMatrix",n.wcvc),t.UBO.setArray("SCPCMatrix",n.scpc),t.UBO.setArray("PCSCMatrix",n.pcsc),t.UBO.setArray("SCVCMatrix",n.scvc),t.UBO.setArray("VCPCMatrix",n.vcpc),t.UBO.setArray("WCVCNormals",n.normalMatrix),t.UBO.setValue("LightCount",t.renderable.getLights().length),t.UBO.setValue("MaxEnvironmentMipLevel",t.renderable.getEnvironmentTexture()?.getMipLevel()),t.UBO.setValue("BackgroundDiffuseStrength",t.renderable.getEnvironmentTextureDiffuseStrength()),t.UBO.setValue("BackgroundSpecularStrength",t.renderable.getEnvironmentTextureSpecularStrength());const r=e.getYInvertedTiledSizeAndOrigin();t.UBO.setArray("viewportSize",[r.usize,r.vsize]),t.UBO.setValue("cameraParallel",t.camera.getParallelProjection());const i=t._parent.getDevice();t.UBO.sendIfNeeded(i)}},e.updateSSBO=()=>{const n=t.renderable.getLights(),i=t.webgpuCamera.getKeyMatrices(e);let a=`${t.renderable.getMTime()}`;for(let e=0;e<n.length;e++)a+=n[e].getMTime();if(a!==t.lightTimeString){const e=new Float32Array(4*n.length),a=new Float32Array(4*n.length),l=new Float32Array(4*n.length),c=new Float32Array(4*n.length);for(let t=0;t<n.length;t++){const u=4*t,d=n[t].getPosition();r.eR.transformMat4(d,d,i.wcvc),e[u]=d[0],e[u+1]=d[1],e[u+2]=d[2],e[u+3]=0,a[u]=-n[t].getDirection()[0],a[u+1]=-n[t].getDirection()[1],a[u+2]=-n[t].getDirection()[2],a[u+3]=0,l[u]=n[t].getColor()[0],l[u+1]=n[t].getColor()[1],l[u+2]=n[t].getColor()[2],l[u+3]=5*n[t].getIntensity(),c[u]=(s=n[t]).getPositional()?s.getConeAngle()>=90?0:2:1,c[u+1]=Math.cos((0,o.r)(n[t].getConeAngle())),c[u+2]=Math.cos((0,o.r)(n[t].getConeAngle()+n[t].getConeFalloff())),c[u+3]=0}t.SSBO.clearData(),t.SSBO.setNumberOfInstances(n.length),t.SSBO.addEntry("LightPos","vec4<f32>"),t.SSBO.addEntry("LightDir","vec4<f32>"),t.SSBO.addEntry("LightColor","vec4<f32>"),t.SSBO.addEntry("LightData","vec4<f32>"),t.SSBO.setAllInstancesFromArray("LightPos",e),t.SSBO.setAllInstancesFromArray("LightDir",a),t.SSBO.setAllInstancesFromArray("LightColor",l),t.SSBO.setAllInstancesFromArray("LightData",c);const u=t._parent.getDevice();t.SSBO.send(u)}var s;t.lightTimeString=a},e.scissorAndViewport=t=>{const n=e.getYInvertedTiledSizeAndOrigin();t.getHandle().setViewport(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize,0,1),t.getHandle().setScissorRect(n.lowerLeftU,n.lowerLeftV,n.usize,n.vsize)},e.bindUBO=e=>{e.activateBindGroup(t.bindGroup)},e.opaquePass=n=>{n?(t.renderEncoder.begin(t._parent.getCommandEncoder()),e.updateUBO(),e.updateSSBO()):(e.scissorAndViewport(t.renderEncoder),e.clear(),t.renderEncoder.end())},e.clear=()=>{if(t.renderable.getTransparent()||t.suppressClear)return;const n=t._parent.getDevice();if(!t.clearFSQ){t.clearFSQ=l.Ay.newInstance(),t.clearFSQ.setDevice(n),t.clearFSQ.setPipelineHash("clearfsq"),t.clearFSQ.setFragmentShaderTemplate(b);const e=g.Ay.newInstance({label:"mapperUBO"});e.addEntry("FSQMatrix","mat4x4<f32>"),e.addEntry("BackgroundColor","vec4<f32>"),t.clearFSQ.setUBO(e),t.backgroundTex=t.renderable.getEnvironmentTexture()}if("clearfsqwithtexture"!==t.clearFSQ.getPipelineHash()&&t.renderable.getUseEnvironmentTextureAsBackground()&&t.backgroundTex?.getImageLoaded()){t.clearFSQ.setFragmentShaderTemplate(x);const e=g.Ay.newInstance({label:"mapperUBO"});e.addEntry("FSQMatrix","mat4x4<f32>"),e.addEntry("BackgroundColor","vec4<f32>"),t.clearFSQ.setUBO(e);const r=n.getTextureManager().getTextureForVTKTexture(t.backgroundTex);if(r.getReady()){const e=r.createView("EnvironmentTexture");t.clearFSQ.setTextureViews([e]),t.backgroundTexLoaded=!0;const i=t.backgroundTex.getInterpolate()?"linear":"nearest";e.addSampler(n,{addressModeU:"repeat",addressModeV:"clamp-to-edge",addressModeW:"repeat",minFilter:i,magFilter:i,mipmapFilter:"linear"})}t.clearFSQ.setPipelineHash("clearfsqwithtexture")}else if("clearfsqwithtexture"===t.clearFSQ.getPipelineHash()&&!t.renderable.getUseEnvironmentTextureAsBackground()){t.clearFSQ=l.Ay.newInstance(),t.clearFSQ.setDevice(n),t.clearFSQ.setPipelineHash("clearfsq"),t.clearFSQ.setFragmentShaderTemplate(b);const e=g.Ay.newInstance({label:"mapperUBO"});e.addEntry("FSQMatrix","mat4x4<f32>"),e.addEntry("BackgroundColor","vec4<f32>"),t.clearFSQ.setUBO(e)}const i=t.webgpuCamera.getKeyMatrices(e),o=t.renderable.getBackgroundByReference();t.clearFSQ.getUBO().setArray("BackgroundColor",o),r.pB.transpose(C,i.normalMatrix),r.pB.mul(A,i.scvc,i.pcsc),r.pB.mul(A,C,A),t.clearFSQ.getUBO().setArray("FSQMatrix",A),t.clearFSQ.getUBO().sendIfNeeded(n),t.clearFSQ.prepareAndDraw(t.renderEncoder)},e.translucentPass=n=>{n?t.renderEncoder.begin(t._parent.getCommandEncoder()):(e.scissorAndViewport(t.renderEncoder),t.renderEncoder.end())},e.volumeDepthRangePass=n=>{n?t.renderEncoder.begin(t._parent.getCommandEncoder()):(e.scissorAndViewport(t.renderEncoder),t.renderEncoder.end())},e.getAspectRatio=()=>{const e=t._parent.getSizeByReference(),n=t.renderable.getViewportByReference();return e[0]*(n[2]-n[0])/((n[3]-n[1])*e[1])},e.convertToOpenGLDepth=e=>t.webgpuCamera.convertToOpenGLDepth(e),e.getYInvertedTiledSizeAndOrigin=()=>{const n=e.getTiledSizeAndOrigin(),r=t._parent.getSizeByReference();return n.lowerLeftV=r[1]-n.vsize-n.lowerLeftV,n},e.getTiledSizeAndOrigin=()=>{const e=t.renderable.getViewportByReference(),n=[0,0,1,1],r=e[0]-n[0],i=e[1]-n[1],o=t._parent.normalizedDisplayToDisplay(r,i),a=Math.round(o[0]),s=Math.round(o[1]),l=e[2]-n[0],c=e[3]-n[1],u=t._parent.normalizedDisplayToDisplay(l,c);let d=Math.round(u[0])-a,p=Math.round(u[1])-s;return d<0&&(d=0),p<0&&(p=0),{usize:d,vsize:p,lowerLeftU:a,lowerLeftV:s}},e.getPropFromID=e=>{for(let n=0;n<t.children.length;n++)if((t.children[n].getPropID?t.children[n].getPropID():-1)===e)return t.children[n];return null},e.getStabilizedTime=()=>t.stabilizedTime.getMTime(),e.releaseGraphicsResources=()=>{null!==t.selector&&t.selector.releaseGraphicsResources()}}(e,t)}const w=(0,i.n)(S,"vtkWebGPURenderer");(0,v.c9)("vtkRenderer",w)},20461:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>a});var r=n(28906);const i={device:null,handle:null,label:null,options:null};function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,i,n),r.m.obj(e,t),t.options={},t.bindGroupLayoutEntry={visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,sampler:{}},t.bindGroupTime={},r.m.obj(t.bindGroupTime,{mtime:0}),r.m.get(e,t,["bindGroupTime","handle","options"]),r.m.setGet(e,t,["bindGroupLayoutEntry","device","label"]),function(e,t){t.classHierarchy.push("vtkWebGPUSampler"),e.create=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.device=e,t.options.addressModeU=n.addressModeU?n.addressModeU:"clamp-to-edge",t.options.addressModeV=n.addressModeV?n.addressModeV:"clamp-to-edge",t.options.addressModeW=n.addressModeW?n.addressModeW:"clamp-to-edge",t.options.magFilter=n.magFilter?n.magFilter:"nearest",t.options.minFilter=n.minFilter?n.minFilter:"nearest",t.options.mipmapFilter=n.mipmapFilter?n.mipmapFilter:"nearest",t.options.label=t.label,t.handle=t.device.getHandle().createSampler(t.options),t.bindGroupTime.modified()},e.getShaderCode=(e,n)=>`@binding(${e}) @group(${n}) var ${t.label}: sampler;`,e.getBindGroupEntry=()=>({resource:t.handle})}(e,t)}var a={newInstance:r.m.newInstance(o),extend:o}},9806:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var r=n(28906);const i={device:null,handle:null};function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,i,n),r.m.obj(e,t),r.m.get(e,t,["lastCameraMTime"]),r.m.setGet(e,t,["device","handle"]),function(e,t){t.classHierarchy.push("vtkWebGPUShaderModule"),e.initialize=(e,n)=>{t.device=e,t.handle=t.device.getHandle().createShaderModule({code:n.getCode()})}}(e,t)}var a={newInstance:r.m.newInstance(o,"vtkWebGPUShaderModule"),extend:o};const s={shaderModules:null,device:null,window:null};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),t._shaderModules=new Map,r.m.obj(e,t),r.m.setGet(e,t,["device","window"]),function(e,t){t.classHierarchy.push("vtkWebGPUShaderCache"),e.getShaderModule=e=>{const n=e.getType(),r=e.getHash(),i=t._shaderModules.keys();for(let e=0;e<i.length;e++){const o=i[e];if(o.getHash()===r&&o.getType()===n)return t._shaderModules.get(o)}const o=a.newInstance();return o.initialize(t.device,e),t._shaderModules.set(e,o),o}}(e,t)}var c={newInstance:r.m.newInstance(l,"vtkWebGPUShaderCache"),extend:l,substitute:function(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=Array.isArray(n)?n.join("\n"):n;let o=!1;-1!==e.search(t)&&(o=!0);let a="";r&&(a="g");const s=new RegExp(t,a);return{replace:o,result:e.replace(s,i)}}}},32603:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>x});var r=n(28906),i=n(25196),o=n(10299);const a={handle:null,layouts:null,renderEncoder:null,shaderDescriptions:null,vertexState:null,topology:null,pipelineDescription:null};function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,a,n),(0,r.o)(e,t),t.layouts=[],t.shaderDescriptions=[],(0,r.g)(e,t,["handle","pipelineDescription"]),(0,r.e)(e,t,["device","renderEncoder","topology","vertexState"]),function(e,t){t.classHierarchy.push("vtkWebGPUPipeline"),e.getShaderDescriptions=()=>t.shaderDescriptions,e.initialize=(e,n)=>{t.pipelineDescription=t.renderEncoder.getPipelineSettings(),t.pipelineDescription.primitive.topology=t.topology,t.pipelineDescription.vertex=t.vertexState,t.pipelineDescription.label=n;const r=[];for(let e=0;e<t.layouts.length;e++)r.push(t.layouts[e].layout);t.pipelineLayout=e.getHandle().createPipelineLayout({bindGroupLayouts:r}),t.pipelineDescription.layout=t.pipelineLayout;for(let n=0;n<t.shaderDescriptions.length;n++){const r=t.shaderDescriptions[n],i=e.getShaderModule(r);"vertex"===r.getType()&&(t.pipelineDescription.vertex.module=i.getHandle(),t.pipelineDescription.vertex.entryPoint="main"),"fragment"===r.getType()&&(t.pipelineDescription.fragment.module=i.getHandle(),t.pipelineDescription.fragment.entryPoint="main")}t.handle=e.getHandle().createRenderPipeline(t.pipelineDescription)},e.getShaderDescription=e=>{for(let n=0;n<t.shaderDescriptions.length;n++)if(t.shaderDescriptions[n].getType()===e)return t.shaderDescriptions[n];return null},e.addBindGroupLayout=e=>{e&&t.layouts.push({layout:e.getBindGroupLayout(t.device),label:e.getLabel()})},e.getBindGroupLayout=e=>t.layouts[e].layout,e.getBindGroupLayoutCount=e=>{for(let n=0;n<t.layouts.length;n++)if(t.layouts[n].label===e)return n;return 0},e.bindVertexInput=(e,t)=>{t.bindBuffers(e)}}(e,t)}var l={newInstance:(0,r.n)(s,"vtkWebGPUPipeline"),extend:s},c=n(9806);const u={type:null,hash:null,code:null,outputNames:null,outputTypes:null};function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,u,n),t.outputNames=[],t.outputTypes=[],t.outputInterpolations=[],t.builtinOutputNames=[],t.builtinOutputTypes=[],t.builtinInputNames=[],t.builtinInputTypes=[],r.m.obj(e,t),r.m.setGet(e,t,["type","hash","code"]),r.m.getArray(e,t,["outputTypes","outputNames","outputInterpolations"]),function(e,t){t.classHierarchy.push("vtkWebGPUShaderDescription"),e.hasOutput=e=>t.outputNames.includes(e),e.addOutput=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;t.outputTypes.push(e),t.outputNames.push(n),t.outputInterpolations.push(r)},e.addBuiltinOutput=(e,n)=>{t.builtinOutputTypes.push(e),t.builtinOutputNames.push(n)},e.addBuiltinInput=(e,n)=>{t.builtinInputTypes.push(e),t.builtinInputNames.push(n)},e.replaceShaderCode=(e,n)=>{const r=[];let i=[];if(n&&r.push(n.getShaderCode()),e||t.builtinInputNames.length){const n=[];if(n.push(`struct ${t.type}Input\n{`),e){const t=e.getOutputNamesByReference(),r=e.getOutputTypesByReference(),i=e.getOutputInterpolationsByReference();for(let e=0;e<t.length;e++)void 0!==i[e]?n.push(`  @location(${e}) @interpolate(${i[e]}) ${t[e]} : ${r[e]},`):n.push(`  @location(${e}) ${t[e]} : ${r[e]},`)}for(let e=0;e<t.builtinInputNames.length;e++)n.push(`  ${t.builtinInputNames[e]} : ${t.builtinInputTypes[e]},`);n.length>1&&(n.push("};"),i=n,r[r.length-1]+=",",r.push(`input: ${t.type}Input`))}if(r.length&&(t.code=c.Ay.substitute(t.code,"//VTK::IOStructs::Input",r).result),t.outputNames.length+t.builtinOutputNames.length){const e=[`struct ${t.type}Output\n{`];for(let n=0;n<t.outputNames.length;n++)void 0!==t.outputInterpolations[n]?e.push(`  @location(${n}) @interpolate(${t.outputInterpolations[n]}) ${t.outputNames[n]} : ${t.outputTypes[n]},`):e.push(`  @location(${n}) ${t.outputNames[n]} : ${t.outputTypes[n]},`);for(let n=0;n<t.builtinOutputNames.length;n++)e.push(`  ${t.builtinOutputNames[n]} : ${t.builtinOutputTypes[n]},`);e.push("};"),i=i.concat(e),t.code=c.Ay.substitute(t.code,"//VTK::IOStructs::Output",[`-> ${t.type}Output`]).result}t.code=c.Ay.substitute(t.code,"//VTK::IOStructs::Dec",i).result}}(e,t)}var p={newInstance:r.m.newInstance(d,"vtkWebGPUShaderDescription"),extend:d},f=n(57372);function h(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!t.includes(e[n]))return!1;return!0}const m={inputs:null,bindingDescriptions:!1,attributeDescriptions:null,indexBuffer:null};function g(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,m,n),(0,r.o)(e,t),t.bindingDescriptions=[],t.attributeDescriptions=[],t.inputs=[],(0,r.e)(e,t,["created","device","handle","indexBuffer"]),function(e,t){t.classHierarchy.push("vtkWebGPUVertexInput"),e.addBuffer=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vertex",i=n;Array.isArray(i)||(i=[i]);for(let n=0;n<t.inputs.length;n++)if(h(t.inputs[n].names,i)){if(t.inputs[n].buffer===e)return;return void(t.inputs[n].buffer=e)}t.inputs.push({buffer:e,stepMode:r,names:i}),t.inputs=t.inputs.sort(((e,t)=>e.names[0]<t.names[0]?-1:e.names[0]>t.names[0]?1:0))},e.removeBufferIfPresent=e=>{for(let n=0;n<t.inputs.length;n++)t.inputs[n].names.includes(e)&&t.inputs.splice(n,1)},e.getBuffer=e=>{for(let n=0;n<t.inputs.length;n++)if(t.inputs[n].names.includes(e))return t.inputs[n].buffer;return null},e.hasAttribute=e=>{for(let n=0;n<t.inputs.length;n++)if(t.inputs[n].names.includes(e))return!0;return!1},e.getAttributeTime=e=>{for(let n=0;n<t.inputs.length;n++)if(t.inputs[n].names.includes(e))return t.inputs[n].buffer.getSourceTime();return 0},e.getShaderCode=()=>{let e="",n=0;for(let r=0;r<t.inputs.length;r++)for(let i=0;i<t.inputs[r].names.length;i++){const o=t.inputs[r].buffer.getArrayInformation()[i],a=f.A.getShaderTypeFromBufferFormat(o.format);n>0&&(e+=",\n"),e=`${e}  @location(${n}) ${t.inputs[r].names[i]} : ${a}`,n++}return e},e.getVertexInputInformation=()=>{const e={};if(t.inputs.length){const n=[];let r=0;for(let e=0;e<t.inputs.length;e++){const i=t.inputs[e].buffer,o={arrayStride:i.getStrideInBytes(),stepMode:t.inputs[e].stepMode,attributes:[]},a=i.getArrayInformation();for(let n=0;n<t.inputs[e].names.length;n++)o.attributes.push({shaderLocation:r,offset:a[n].offset,format:a[n].format}),r++;n.push(o)}e.buffers=n}return e},e.bindBuffers=e=>{for(let n=0;n<t.inputs.length;n++)e.setVertexBuffer(n,t.inputs[n].buffer.getHandle());t.indexBuffer&&e.setIndexBuffer(t.indexBuffer.getHandle(),t.indexBuffer.getArrayInformation()[0].format)},e.getReady=()=>{},e.releaseGraphicsResources=()=>{t.created&&(t.inputs=[],t.bindingDescriptions=[],t.attributeDescriptions=[])}}(e,t)}var v={newInstance:(0,r.n)(g,"vtkWebGPUVertexInput"),extend:g};const y={additionalBindables:void 0,bindGroup:null,device:null,fragmentShaderTemplate:null,numberOfInstances:1,numberOfVertices:0,pipelineHash:null,shaderReplacements:null,SSBO:null,textureViews:null,topology:"triangle-list",UBO:null,vertexShaderTemplate:null,WebGPURenderer:null};function b(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,y,n),i.A.extend(e,t,n),t.textureViews=[],t.vertexInput=v.newInstance(),t.bindGroup=o.Ay.newInstance({label:"mapperBG"}),t.additionalBindables=[],t.fragmentShaderTemplate=t.fragmentShaderTemplate||"\n//VTK::Renderer::Dec\n\n//VTK::Color::Dec\n\n//VTK::Normal::Dec\n\n//VTK::TCoord::Dec\n\n//VTK::Select::Dec\n\n//VTK::RenderEncoder::Dec\n\n//VTK::Mapper::Dec\n\n//VTK::IOStructs::Dec\n\n@fragment\nfn main(\n//VTK::IOStructs::Input\n)\n//VTK::IOStructs::Output\n{\n  var output : fragmentOutput;\n\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::Light::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Select::Impl\n\n  // var computedColor:vec4<f32> = vec4<f32>(1.0,0.5,0.5,1.0);\n\n  //VTK::RenderEncoder::Impl\n  return output;\n}\n",t.vertexShaderTemplate=t.vertexShaderTemplate||"\n//VTK::Renderer::Dec\n\n//VTK::Color::Dec\n\n//VTK::Normal::Dec\n\n//VTK::TCoord::Dec\n\n//VTK::Select::Dec\n\n//VTK::Mapper::Dec\n\n//VTK::IOStructs::Dec\n\n@vertex\nfn main(\n//VTK::IOStructs::Input\n)\n//VTK::IOStructs::Output\n{\n  var output : vertexOutput;\n\n  // var vertex: vec4<f32> = vertexBC;\n\n  //VTK::Color::Impl\n\n  //VTK::Normal::Impl\n\n  //VTK::TCoord::Impl\n\n  //VTK::Select::Impl\n\n  //VTK::Position::Impl\n\n  return output;\n}\n",t.shaderReplacements=new Map,r.m.get(e,t,["pipeline","vertexInput"]),r.m.setGet(e,t,["additionalBindables","device","fragmentShaderTemplate","interpolate","numberOfInstances","numberOfVertices","pipelineHash","shaderReplacements","SSBO","textureViews","topology","UBO","vertexShaderTemplate","WebGPURenderer"]),function(e,t){t.classHierarchy.push("vtkWebGPUSimpleMapper"),e.generateShaderDescriptions=(n,r,i)=>{const o=p.newInstance({type:"vertex",hash:n,code:t.vertexShaderTemplate}),a=p.newInstance({type:"fragment",hash:n,code:t.fragmentShaderTemplate}),s=r.getShaderDescriptions();s.push(o),s.push(a);const l=t.vertexShaderTemplate+t.fragmentShaderTemplate,c=new RegExp("//VTK::[^:]*::","g"),u=l.match(c).filter(((e,t,n)=>n.indexOf(e)===t)).map((e=>`replaceShader${e.substring(7,e.length-2)}`));for(let e=0;e<u.length;e++){const o=u[e];"replaceShaderIOStructs"!==o&&t.shaderReplacements.has(o)&&t.shaderReplacements.get(o)(n,r,i)}e.replaceShaderIOStructs(n,r,i)},e.replaceShaderIOStructs=(e,t,n)=>{const r=t.getShaderDescription("vertex");r.replaceShaderCode(null,n),t.getShaderDescription("fragment").replaceShaderCode(r)},e.replaceShaderRenderEncoder=(e,n,r)=>{t.renderEncoder.replaceShaderCode(n)},t.shaderReplacements.set("replaceShaderRenderEncoder",e.replaceShaderRenderEncoder),e.replaceShaderRenderer=(e,n,r)=>{if(!t.WebGPURenderer)return;const i=t.WebGPURenderer.getBindGroup().getShaderCode(n),o=n.getShaderDescription("vertex");let a=o.getCode();a=c.Ay.substitute(a,"//VTK::Renderer::Dec",[i]).result,o.setCode(a);const s=n.getShaderDescription("fragment");a=s.getCode(),a=c.Ay.substitute(a,"//VTK::Renderer::Dec",[i]).result,s.setCode(a)},t.shaderReplacements.set("replaceShaderRenderer",e.replaceShaderRenderer),e.replaceShaderMapper=(e,n,r)=>{const i=t.bindGroup.getShaderCode(n),o=n.getShaderDescription("vertex");let a=o.getCode();a=c.Ay.substitute(a,"//VTK::Mapper::Dec",[i]).result,o.setCode(a);const s=n.getShaderDescription("fragment");s.addBuiltinInput("bool","@builtin(front_facing) frontFacing"),a=s.getCode(),a=c.Ay.substitute(a,"//VTK::Mapper::Dec",[i]).result,s.setCode(a)},t.shaderReplacements.set("replaceShaderMapper",e.replaceShaderMapper),e.replaceShaderPosition=(e,t,n)=>{const r=t.getShaderDescription("vertex");r.addBuiltinOutput("vec4<f32>","@builtin(position) Position");let i=r.getCode();i=c.Ay.substitute(i,"//VTK::Position::Impl",["    output.Position = rendererUBO.SCPCMatrix*vertexBC;"]).result,r.setCode(i)},t.shaderReplacements.set("replaceShaderPosition",e.replaceShaderPosition),e.replaceShaderTCoord=(e,t,n)=>{t.getShaderDescription("vertex").addOutput("vec2<f32>","tcoordVS")},t.shaderReplacements.set("replaceShaderTCoord",e.replaceShaderTCoord),e.addTextureView=e=>{t.textureViews.includes(e)||t.textureViews.push(e)},e.prepareToDraw=n=>{t.renderEncoder=n,e.updateInput(),e.updateBuffers(),e.updateBindings(),e.updatePipeline()},e.updateInput=()=>{},e.updateBuffers=()=>{},e.updateBindings=()=>{t.bindGroup.setBindables(e.getBindables())},e.computePipelineHash=()=>{},e.registerDrawCallback=n=>{n.registerDrawCallback(t.pipeline,e.draw)},e.prepareAndDraw=n=>{e.prepareToDraw(n),n.setPipeline(t.pipeline),e.draw(n)},e.draw=e=>{const n=e.getBoundPipeline();e.activateBindGroup(t.bindGroup),t.WebGPURenderer&&t.WebGPURenderer.bindUBO(e),n.bindVertexInput(e,t.vertexInput);const r=t.vertexInput.getIndexBuffer();r?e.drawIndexed(r.getIndexCount(),t.numberOfInstances,0,0,0):e.draw(t.numberOfVertices,t.numberOfInstances,0,0)},e.getBindables=()=>{const e=[...t.additionalBindables];t.UBO&&e.push(t.UBO),t.SSBO&&e.push(t.SSBO);for(let n=0;n<t.textureViews.length;n++){e.push(t.textureViews[n]);const r=t.textureViews[n].getSampler();r&&e.push(r)}return e},e.updatePipeline=()=>{e.computePipelineHash(),t.pipeline=t.device.getPipeline(t.pipelineHash),t.pipeline||(t.pipeline=l.newInstance(),t.pipeline.setDevice(t.device),t.WebGPURenderer&&t.pipeline.addBindGroupLayout(t.WebGPURenderer.getBindGroup()),t.pipeline.addBindGroupLayout(t.bindGroup),e.generateShaderDescriptions(t.pipelineHash,t.pipeline,t.vertexInput),t.pipeline.setTopology(t.topology),t.pipeline.setRenderEncoder(t.renderEncoder),t.pipeline.setVertexState(t.vertexInput.getVertexInputInformation()),t.device.createPipeline(t.pipelineHash,t.pipeline))}}(e,t)}var x={newInstance:r.m.newInstance(b,"vtkWebGPUSimpleMapper"),extend:b}},57372:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(28906);const i={r8unorm:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"float"},r8snorm:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"float"},r8uint:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},r8sint:{numComponents:1,nativeType:Int8Array,stride:1,elementSize:1,sampleType:"sint"},r16uint:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"uint"},r16sint:{numComponents:1,nativeType:Int16Array,stride:2,elementSize:2,sampleType:"sint"},r16float:{numComponents:1,nativeType:Float32Array,stride:2,elementSize:2,sampleType:"float"},rg8unorm:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"float"},rg8snorm:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"float"},rg8uint:{numComponents:2,nativeType:Uint8Array,stride:2,elementSize:1,sampleType:"uint"},rg8sint:{numComponents:2,nativeType:Int8Array,stride:2,elementSize:1,sampleType:"sint"},r32uint:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:4,sampleType:"uint"},r32sint:{numComponents:1,nativeType:Int32Array,stride:4,elementSize:4,sampleType:"sint"},r32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"unfilterable-float"},rg16uint:{numComponents:2,nativeType:Uint16Array,stride:4,elementSize:2,sampleType:"uint"},rg16sint:{numComponents:2,nativeType:Int16Array,stride:4,elementSize:2,sampleType:"sint"},rg16float:{numComponents:2,nativeType:Float32Array,stride:4,elementSize:2,sampleType:"float"},rgba8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"rgba8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgba8snorm:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"float"},rgba8uint:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"uint"},rgba8sint:{numComponents:4,nativeType:Int8Array,stride:4,elementSize:1,sampleType:"sint"},bgra8unorm:{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},"bgra8unorm-srgb":{numComponents:4,nativeType:Uint8Array,stride:4,elementSize:1,sampleType:"float"},rgb9e5ufloat:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rgb10a2unorm:{numComponents:4,nativeType:Uint32Array,stride:4,sampleType:"float"},rg11b10ufloat:{numComponents:4,nativeType:Float32Array,stride:4,sampleType:"float"},rg32uint:{numComponents:2,nativeType:Uint32Array,stride:8,elementSize:4,sampleType:"uint"},rg32sint:{numComponents:2,nativeType:Int32Array,stride:8,elementSize:4,sampleType:"sint"},rg32float:{numComponents:2,nativeType:Float32Array,stride:8,elementSize:4,sampleType:"unfilterable-float"},rgba16uint:{numComponents:4,nativeType:Uint16Array,stride:8,elementSize:2,sampleType:"uint"},rgba16sint:{numComponents:4,nativeType:Int16Array,stride:8,elementSize:2,sampleType:"sint"},rgba16float:{numComponents:4,nativeType:Float32Array,stride:8,elementSize:2,sampleType:"float"},rgba32uint:{numComponents:4,nativeType:Uint32Array,stride:16,elementSize:4,sampleType:"uint"},rgba32sint:{numComponents:4,nativeType:Int32Array,stride:16,elementSize:4,sampleType:"sint"},rgba32float:{numComponents:4,nativeType:Float32Array,stride:16,elementSize:4,sampleType:"unfilterable-float"},stencil8:{numComponents:1,nativeType:Uint8Array,stride:1,elementSize:1,sampleType:"uint"},depth16unorm:{numComponents:1,nativeType:Uint16Array,stride:2,elementSize:2,sampleType:"depth"},depth24plus:{numComponents:1,nativeType:Uint32Array,stride:4,elementSize:3,sampleType:"depth"},"depth24plus-stencil8":{numComponents:2,nativeType:Uint32Array,stride:4,sampleType:"mixed"},depth32float:{numComponents:1,nativeType:Float32Array,stride:4,elementSize:4,sampleType:"depth"}};var o={getDetailsFromTextureFormat:function(e){return!e||e.length<6?0:e in i==!0?i[e]:((0,r.r)(`unknown format ${e}`),null)},getByteStrideFromBufferFormat:function(e){if(!e||e.length<5)return 0;let t=1;"x"===e[e.length-2]&&(t=Number(e[e.length-1]));const n=1===t?e.length-1:e.length-3,i=Number(e[n]);return Number.isNaN(i)?((0,r.r)(`unknown format ${e}`),0):t*(5-i/2)},getNumberOfComponentsFromBufferFormat:function(e){if(!e||e.length<5)return 0;let t=1;return"x"===e[e.length-2]&&(t=Number(e[e.length-1])),t},getNativeTypeFromBufferFormat:function(e){if(!e||e.length<5)return 0;let t;if("f"===e[0])t="Float";else if("s"===e[0])t="Int";else{if("u"!==e[0])return void(0,r.r)(`unknown format ${e}`);t="Uint"}const n=e.split("x")[0],i=Number(n[n.length-1]);if(!Number.isNaN(i))return t+=8*(5-i/2),t+="Array",t;(0,r.r)(`unknown format ${e}`)},getShaderTypeFromBufferFormat:function(e){let t;if("f"===e[0]||"n"===e[1])t="f32";else if("s"===e[0]&&"i"===e[1])t="i32";else{if("u"!==e[0]||"i"!==e[1])return void(0,r.r)(`unknown format ${e}`);t="u32"}let n=1;return"x"===e[e.length-2]&&(n=Number(e[e.length-1])),4===n?`vec4<${t}>`:3===n?`vec3<${t}>`:2===n?`vec2<${t}>`:t},getByteStrideFromShaderFormat:function(e){if(!e)return 0;let t=1;return"vec"===e.substring(0,3)?t=Number(e[3]):"mat"===e.substring(0,3)&&(t=e[3]*e[5]),4*t},getNativeTypeFromShaderFormat:function(e){if(e)return e.includes("f32")?"Float32Array":e.includes("i32")?"Int32Array":e.includes("u32")?"Uint32Array":void(0,r.r)(`unknown format ${e}`)}}},83259:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>u});var r=n(28906),i=n(49767),o=n(57372);const{BufferUsage:a}=i.Ay,{vtkErrorMacro:s}=r.m;const l={bufferEntries:null,bufferEntryNames:null,sizeInBytes:0,label:null,bindGroupLayoutEntry:null,bindGroupEntry:null};function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,l,n),r.m.obj(e,t),t._bufferEntryNames=new Map,t.bufferEntries=[],t.bindGroupLayoutEntry=t.bindGroupLayoutEntry||{buffer:{type:"uniform"}},t.sendTime={},r.m.obj(t.sendTime,{mtime:0}),t.bindGroupTime={},r.m.obj(t.bindGroupTime,{mtime:0}),t.sendDirty=!0,t.sortDirty=!0,r.m.get(e,t,["binding","bindGroupTime"]),r.m.setGet(e,t,["bindGroupLayoutEntry","device","label","sizeInBytes"]),function(e,t){t.classHierarchy.push("vtkWebGPUUniformBuffer"),e.addEntry=(e,n)=>{t._bufferEntryNames.has(e)?s(`entry named ${e} already exists`):(t.sortDirty=!0,t._bufferEntryNames.set(e,t.bufferEntries.length),t.bufferEntries.push({name:e,type:n,sizeInBytes:o.A.getByteStrideFromShaderFormat(n),offset:-1,nativeType:o.A.getNativeTypeFromShaderFormat(n),packed:!1}))},e.sortBufferEntries=()=>{if(!t.sortDirty)return;let e=0;const n=[];let r=4;for(let e=0;e<t.bufferEntries.length;e++){const n=t.bufferEntries[e];n.sizeInBytes%16==0&&(r=Math.max(16,r)),n.sizeInBytes%8==0&&(r=Math.max(8,r))}for(let r=0;r<t.bufferEntries.length;r++){const i=t.bufferEntries[r];!1===i.packed&&i.sizeInBytes%16==0&&(i.packed=!0,i.offset=e,n.push(i),e+=i.sizeInBytes)}for(let r=0;r<t.bufferEntries.length;r++){const i=t.bufferEntries[r];if(!1===i.packed&&12===i.sizeInBytes)for(let r=0;r<t.bufferEntries.length;r++){const o=t.bufferEntries[r];if(!1===o.packed&&4===o.sizeInBytes){i.packed=!0,i.offset=e,n.push(i),e+=i.sizeInBytes,o.packed=!0,o.offset=e,n.push(o),e+=o.sizeInBytes;break}}}for(let r=0;r<t.bufferEntries.length;r++){const i=t.bufferEntries[r];if(!i.packed&&i.sizeInBytes%8==0)for(let o=r+1;o<t.bufferEntries.length;o++){const r=t.bufferEntries[o];if(!r.packed&&r.sizeInBytes%8==0){i.packed=!0,i.offset=e,n.push(i),e+=i.sizeInBytes,r.packed=!0,r.offset=e,n.push(r),e+=r.sizeInBytes;break}}}for(let r=0;r<t.bufferEntries.length;r++){const i=t.bufferEntries[r];if(!i.packed&&i.sizeInBytes%8==0){let r=!1;for(let o=0;!r&&o<t.bufferEntries.length;o++){const a=t.bufferEntries[o];if(!a.packed&&4===a.sizeInBytes)for(let s=o+1;s<t.bufferEntries.length;s++){const o=t.bufferEntries[s];if(!o.packed&&4===o.sizeInBytes){i.packed=!0,i.offset=e,n.push(i),e+=i.sizeInBytes,a.packed=!0,a.offset=e,n.push(a),e+=a.sizeInBytes,o.packed=!0,o.offset=e,n.push(o),e+=o.sizeInBytes,r=!0;break}}}}}for(let r=0;r<t.bufferEntries.length;r++){const i=t.bufferEntries[r];!i.packed&&i.sizeInBytes>4&&(i.packed=!0,i.offset=e,n.push(i),e+=i.sizeInBytes)}for(let r=0;r<t.bufferEntries.length;r++){const i=t.bufferEntries[r];i.packed||(i.packed=!0,i.offset=e,n.push(i),e+=i.sizeInBytes)}t.bufferEntries=n,t._bufferEntryNames.clear();for(let e=0;e<t.bufferEntries.length;e++)t._bufferEntryNames.set(t.bufferEntries[e].name,e);t.sizeInBytes=e,t.sizeInBytes=r*Math.ceil(t.sizeInBytes/r),t.sortDirty=!1},e.sendIfNeeded=e=>{if(!t.UBO){const n={nativeArray:t.Float32Array,usage:a.UniformArray,label:t.label};t.UBO=e.getBufferManager().getBuffer(n),t.bindGroupTime.modified(),t.sendDirty=!1}t.sendDirty&&(e.getHandle().queue.writeBuffer(t.UBO.getHandle(),0,t.arrayBuffer,0,t.sizeInBytes),t.sendDirty=!1),t.sendTime.modified()},e.createView=e=>{e in t==0&&(t.arrayBuffer||(t.arrayBuffer=new ArrayBuffer(t.sizeInBytes)),t[e]=r.m.newTypedArray(e,t.arrayBuffer))},e.setValue=(n,r)=>{e.sortBufferEntries();const i=t._bufferEntryNames.get(n);if(void 0===i)return void s(`entry named ${n} not found in UBO`);const o=t.bufferEntries[i];e.createView(o.nativeType);const a=t[o.nativeType];o.lastValue!==r&&(a[o.offset/a.BYTES_PER_ELEMENT]=r,t.sendDirty=!0),o.lastValue=r},e.setArray=(n,r)=>{e.sortBufferEntries();const i=t._bufferEntryNames.get(n);if(void 0===i)return void s(`entry named ${n} not found in UBO`);const o=t.bufferEntries[i];e.createView(o.nativeType);const a=t[o.nativeType];let l=!1;for(let e=0;e<r.length;e++)o.lastValue&&o.lastValue[e]===r[e]||(a[o.offset/a.BYTES_PER_ELEMENT+e]=r[e],l=!0);l&&(t.sendDirty=!0,o.lastValue=[...r])},e.getBindGroupEntry=()=>({resource:{buffer:t.UBO.getHandle()}}),e.getSendTime=()=>t.sendTime.getMTime(),e.getShaderCode=(n,r)=>{e.sortBufferEntries();const i=[`struct ${t.label}Struct\n{`];for(let e=0;e<t.bufferEntries.length;e++){const n=t.bufferEntries[e];i.push(`  ${n.name}: ${n.type},`)}return i.push(`};\n@binding(${n}) @group(${r}) var<uniform> ${t.label}: ${t.label}Struct;`),i.join("\n")}}(e,t)}var u={newInstance:r.m.newInstance(c,"vtkWebGPUUniformBuffer"),extend:c}},50440:(e,t,n)=>{"use strict";n.d(t,{c9:()=>a});var r=n(28906),i=n(84784);const o=Object.create(null);function a(e,t){o[e]=t}const s={};function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),t.overrides=o,i.Ay.extend(e,t,n),function(e,t){t.classHierarchy.push("vtkWebGPUViewNodeFactory")}(0,t)}r.m.newInstance(l,"vtkWebGPUViewNodeFactory")},37290:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>r.m});n(45043),n(42852),n(44302);var r=n(28906)},28906:(e,t,n)=>{"use strict";n.d(t,{a:()=>A,b:()=>C,c:()=>ae,d:()=>W,e:()=>V,f:()=>H,g:()=>M,h:()=>q,i:()=>z,k:()=>k,l:()=>G,m:()=>oe,n:()=>K,o:()=>R,r:()=>g,s:()=>B});var r=n(45043),i=n.n(r),o=n(42852),a=n(44302);let s=0;const l=Symbol("void");const c={};function u(){}["log","debug","info","warn","error","time","timeEnd","group","groupEnd"].forEach((e=>{c[e]=u})),o.n.console=console.hasOwnProperty("log")?console:c;const d={debug:u,error:o.n.console.error||u,info:o.n.console.info||u,log:o.n.console.log||u,warn:o.n.console.warn||u};function p(e,t){d[e]&&(d[e]=t||u)}function f(){d.log(...arguments)}function h(){d.info(...arguments)}function m(){d.debug(...arguments)}function g(){d.error(...arguments)}function v(){d.warn(...arguments)}const y={};function b(e){y[e]||(d.error(e),y[e]=!0)}const x=Object.create(null);x.Float32Array=Float32Array,x.Float64Array=Float64Array,x.Uint8Array=Uint8Array,x.Int8Array=Int8Array,x.Uint16Array=Uint16Array,x.Int16Array=Int16Array,x.Uint32Array=Uint32Array,x.Int32Array=Int32Array,x.Uint8ClampedArray=Uint8ClampedArray;try{x.BigInt64Array=BigInt64Array,x.BigUint64Array=BigUint64Array}catch{}function A(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new(x[e]||Float64Array)(...n)}function C(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(x[e]||Float64Array).from(...n)}function T(e){return e.charAt(0).toUpperCase()+e.slice(1)}function S(e){return T("_"===e[0]?e.slice(1):e)}function w(e){return e.charAt(0).toLowerCase()+e.slice(1)}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let i=Number(e),o="B";for(;i>n;)i/=n,o=r.pop();return`${i.toFixed(t)} ${o}`}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";const n=[];let r=e;for(;r>1e3;)n.push(("000"+r%1e3).slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(t)}function E(e){Object.keys(e).forEach((t=>{Array.isArray(e[t])&&(e[t]=[].concat(e[t]))}))}function D(e){return e&&e.isA?e.getState():e}function O(e){setTimeout(e,0)}function P(e,t){const n=performance.now();e.finally((()=>{const e=performance.now()-n;t(e)}))}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};E(t);const n=[];if(Number.isInteger(t.mtime)||(t.mtime=++s),"classHierarchy"in t){if(!(t.classHierarchy instanceof a.A)){const e=new a.A;for(let n=0;n<t.classHierarchy.length;n++)e.push(t.classHierarchy[n]);t.classHierarchy=e}}else t.classHierarchy=new a.A("vtkObject");function r(e){n[e]=null}return e.isDeleted=()=>!!t.deleted,e.modified=r=>{t.deleted?g("instance deleted - cannot call any method"):r&&r<e.getMTime()||(t.mtime=++s,n.forEach((t=>t&&t(e))))},e.onModified=e=>{if(t.deleted)return g("instance deleted - cannot call any method"),null;const i=n.length;return n.push(e),function(e){return Object.freeze({unsubscribe:function(){r(e)}})}(i)},e.getMTime=()=>t.mtime,e.isA=e=>{let n=t.classHierarchy.length;for(;n--;)if(t.classHierarchy[n]===e)return!0;return!1},e.getClassName=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.classHierarchy[t.classHierarchy.length-1-e]},e.set=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1;return Object.keys(n).forEach((a=>{const s=i?null:e[`set${T(a)}`];s&&Array.isArray(n[a])&&s.length>1?o=s(...n[a])||o:s?o=s(n[a])||o:(-1!==["mtime"].indexOf(a)||r||v(`Warning: Set value to model directly ${a}, ${n[a]}`),o=t[a]!==n[a]||o,t[a]=n[a])})),o},e.get=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length)return t;const i={};return n.forEach((e=>{i[e]=t[e]})),i},e.getReferenceByName=e=>t[e],e.delete=()=>{Object.keys(t).forEach((e=>delete t[e])),n.forEach(((e,t)=>r(t))),t.deleted=!0},e.getState=()=>{if(t.deleted)return null;const n={...t,vtkClass:e.getClassName()};Object.keys(n).forEach((e=>{null===n[e]||void 0===n[e]||"_"===e[0]?delete n[e]:n[e].isA?n[e]=n[e].getState():Array.isArray(n[e])?n[e]=n[e].map(D):function(e){return Object.values(x).some((t=>e instanceof t))}(n[e])&&(n[e]=Array.from(n[e]))}));const r={};return Object.keys(n).sort().forEach((e=>{r[e]=n[e]})),r.mtime&&delete r.mtime,r},e.shallowCopy=function(n){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n.getClassName()!==e.getClassName())throw new Error(`Cannot ShallowCopy ${n.getClassName()} into ${e.getClassName()}`);const i=n.get(),o=Object.keys(t).sort();Object.keys(i).sort().forEach((e=>{const n=o.indexOf(e);-1===n?r&&m(`add ${e} in shallowCopy`):o.splice(n,1),t[e]=i[e]})),o.length&&r&&m(`Untouched keys: ${o.join(", ")}`),e.modified()},e.toJSON=function(){return e.getState()},e}const N={object:(e,t,n)=>function(){return{...t[n.name]}}};function M(e,t,n){n.forEach((n=>{if("object"==typeof n){const r=N[n.type];e[`get${S(n.name)}`]=r?r(e,t,n):()=>t[n.name]}else e[`get${S(n)}`]=()=>t[n]}))}const L={enum(e,t,n){const r=`_on${S(n.name)}Changed`;return i=>{if("string"==typeof i){if(void 0!==n.enum[i])return t[n.name]!==n.enum[i]&&(t[n.name]=n.enum[i],e.modified(),!0);throw g(`Set Enum with invalid argument ${n}, ${i}`),new RangeError("Set Enum with invalid string argument")}if("number"==typeof i){if(t[n.name]!==i){if(-1!==Object.keys(n.enum).map((e=>n.enum[e])).indexOf(i)){const o=t[n.name];return t[n.name]=i,t[r]?.(e,t,i,o),e.modified(),!0}throw g(`Set Enum outside numeric range ${n}, ${i}`),new RangeError("Set Enum outside numeric range")}return!1}throw g(`Set Enum with invalid argument (String/Number) ${n}, ${i}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(e,t,n){1===n.params?.length&&v('Setter of type "object" with a single "param" field is not supported');const r=`_on${S(n.name)}Changed`;return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];let l;if(l=a.length>1&&n.params?.length?n.params.reduce(((e,t,n)=>Object.assign(e,{[t]:a[n]})),{}):a[0],!i()(t[n.name],l)){const i=t[n.name];return t[n.name]=l,t[r]?.(e,t,l,i),e.modified(),!0}return!1}}};function F(e){if("object"==typeof e){const t=L[e.type];if(t)return(n,r)=>t(n,r,e);throw g(`No setter for field ${e}`),new TypeError("No setter for field")}return function(t,n){const r=`_on${S(e)}Changed`;return function(i){if(n.deleted)return g("instance deleted - cannot call any method"),!1;if(n[e]!==i){const o=n[e.name];return n[e]=i,n[r]?.(t,n,i,o),t.modified(),!0}return!1}}}function B(e,t,n){n.forEach((n=>{"object"==typeof n?e[`set${S(n.name)}`]=F(n)(e,t):e[`set${S(n)}`]=F(n)(e,t)}))}function V(e,t,n){M(e,t,n),B(e,t,n)}function k(e,t,n){n.forEach((n=>{e[`get${S(n)}`]=()=>t[n]?Array.from(t[n]):t[n],e[`get${S(n)}ByReference`]=()=>t[n]}))}function U(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;n.forEach((n=>{if(t[n]&&r&&t[n].length!==r)throw new RangeError(`Invalid initial number of values for array (${n})`);const o=`_on${S(n)}Changed`;e[`set${S(n)}`]=function(){if(t.deleted)return g("instance deleted - cannot call any method"),!1;for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];let c,u=s,d=!1;if(1===u.length&&(null==u[0]||u[0].length>=0)&&(u=u[0],d=!0),null==u)c=t[n]!==u;else{if(r&&u.length!==r){if(!(u.length<r&&void 0!==i))throw new RangeError(`Invalid number of values for array setter (${n})`);for(u=Array.from(u),d=!1;u.length<r;)u.push(i)}c=null==t[n]||t[n].length!==u.length;for(let e=0;!c&&e<u.length;++e)c=t[n][e]!==u[e];c&&d&&(u=Array.from(u))}if(c){const r=t[n.name];t[n]=u,t[o]?.(e,t,u,r),e.modified()}return c},e[`set${S(n)}From`]=e=>{const r=t[n];e.forEach(((e,t)=>{r[t]=e}))}}))}function G(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;k(e,t,n),U(e,t,n,r,i)}function z(e,t,n){for(let e=0;e<n.length;e++){const r=n[e];void 0!==t[r]&&(t[`_${r}`]=t[r],delete t[r])}}function W(e,t,n,r){function i(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.deleted?g("instance deleted - cannot call any method"):r>=t.numberOfInputs?g(`algorithm ${e.getClassName()} only has ${t.numberOfInputs} input ports. To add more input ports, use addInputData()`):(t.inputData[r]!==n||t.inputConnection[r])&&(t.inputData[r]=n,t.inputConnection[r]=null,e.modified&&e.modified())}function a(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t.deleted)g("instance deleted - cannot call any method");else{if(r>=t.numberOfInputs){let n=`algorithm ${e.getClassName()} only has `;return n+=`${t.numberOfInputs}`,n+=" input ports. To add more input ports, use addInputConnection()",void g(n)}t.inputData[r]=null,t.inputConnection[r]=n}}function s(){let e=t.numberOfInputs;for(;e&&!t.inputData[e-1]&&!t.inputConnection[e-1];)e--;return e===t.numberOfInputs&&t.numberOfInputs++,e}function l(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.deleted?(g("instance deleted - cannot call any method"),null):(e.shouldUpdate()&&e.update(),t.output[n])}if(t.inputData?t.inputData=t.inputData.map(o.A):t.inputData=[],t.inputConnection?t.inputConnection=t.inputConnection.map(o.A):t.inputConnection=[],t.output?t.output=t.output.map(o.A):t.output=[],t.inputArrayToProcess?t.inputArrayToProcess=t.inputArrayToProcess.map(o.A):t.inputArrayToProcess=[],t.numberOfInputs=n,e.shouldUpdate=()=>{const n=e.getMTime();let i=1/0,o=r;for(;o--;){if(!t.output[o]||t.output[o].isDeleted())return!0;const e=t.output[o].getMTime();if(e<n)return!0;e<i&&(i=e)}for(o=t.numberOfInputs;o--;)if(t.inputConnection[o]?.filter.shouldUpdate()||e.getInputData(o)?.getMTime()>i)return!0;return!1},t.numberOfInputs){let n=t.numberOfInputs;for(;n--;)t.inputData.push(null),t.inputConnection.push(null);e.setInputData=i,e.setInputConnection=a,e.addInputData=function(e){t.deleted?g("instance deleted - cannot call any method"):i(e,s())},e.addInputConnection=function(e){t.deleted?g("instance deleted - cannot call any method"):a(e,s())},e.getInputData=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.inputConnection[e]&&(t.inputData[e]=t.inputConnection[e]()),t.inputData[e]},e.getInputConnection=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.inputConnection[e]}}r&&(e.getOutputData=l,e.getOutputPort=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const n=()=>l(t);return n.filter=e,n}),e.update=()=>{const n=[];if(t.numberOfInputs){let r=0;for(;r<t.numberOfInputs;)n[r]=e.getInputData(r),r++}e.shouldUpdate()&&e.requestData&&e.requestData(n,t.output)},e.getNumberOfInputPorts=()=>t.numberOfInputs,e.getNumberOfOutputPorts=()=>r||t.output.length,e.getInputArrayToProcess=e=>{const n=t.inputArrayToProcess[e],r=t.inputData[e];return n&&r?r[`get${n.fieldAssociation}`]().getArray(n.arrayName):null},e.setInputArrayToProcess=function(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Scalars";for(;t.inputArrayToProcess.length<e;)t.inputArrayToProcess.push(null);t.inputArrayToProcess[e]={arrayName:n,fieldAssociation:r,attributeType:i}}}const j=Symbol("Event abort");function H(e,t,n){const r=[],i=e.delete;let o=1;function a(e){for(let t=0;t<r.length;++t){const[n]=r[t];if(n===e)return void r.splice(t,1)}}e[`invoke${S(n)}`]=function(){if(t.deleted)return void g("instance deleted - cannot call any method");const n=r.slice();for(let t=0;t<n.length;++t){const[,r,i]=n[t];if(r)if(i<0)setTimeout((()=>r.apply(e,arguments)),1-i);else{if(r.apply(e,arguments)===j)break}}},e[`on${S(n)}`]=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e.apply)return console.error(`Invalid callback for event ${n}`),null;if(t.deleted)return g("instance deleted - cannot call any method"),null;const s=o++;return r.push([s,e,i]),r.sort(((e,t)=>t[2]-e[2])),function(e){return Object.freeze({unsubscribe:function(){a(e)}})}(s)},e.delete=()=>{i(),r.forEach((e=>{let[t]=e;return a(t)}))}}function K(e,t){const n=function(){const t={};return e(t,{},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Object.freeze(t)};return t&&o.A.register(t,n),n}function q(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.filter((e=>!!e)).map((e=>e(...n)))}}function $(e){return e&&e.isA&&e.isA("vtkObject")}function X(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if($(e)){if(r.indexOf(e)>=0)return n;r.push(e);const i=t(e);void 0!==i&&n.push(i);const o=e.get();Object.keys(o).forEach((e=>{const i=o[e];Array.isArray(i)?i.forEach((e=>{X(e,t,n,r)})):X(i,t,n,r)}))}return n}function Y(e,t,n){var r=this;let i;const o=function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];const l=r,c=n&&!i;clearTimeout(i),i=setTimeout((()=>{i=null,n||e.apply(l,a)}),t),c&&e.apply(l,a)};return o.cancel=()=>clearTimeout(i),o}function J(e,t){let n=!1,r=null;function i(){n=!1,null!==r&&(o(...r),r=null)}function o(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];n?r=a:(n=!0,e(...a),setTimeout(i,t))}return o}function Z(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t.keystore=Object.assign(t.keystore||{},n),e.setKey=(e,n)=>{t.keystore[e]=n},e.getKey=e=>t.keystore[e],e.getAllKeys=()=>Object.keys(t.keystore),e.deleteKey=e=>delete t.keystore[e],e.clearKeystore=()=>e.getAllKeys().forEach((e=>delete t.keystore[e]))}let Q=1;const ee="__root__";function te(e,t){Z(e,t);const n=e.delete;t.proxyId=""+Q++,t.ui=JSON.parse(JSON.stringify(t.ui||[])),M(e,t,["proxyId","proxyGroup","proxyName"]),V(e,t,["proxyManager"]);const r={},i={};function o(e,t){i[t]||(i[t]=[]);const n=i[t];for(let t=0;t<e.length;t++)n.push(e[t].name),r[e[t].name]=e[t],e[t].children&&e[t].children.length&&o(e[t].children,e[t].name)}function a(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee;const r=[],o=t.proxyId,s=function(){return i[arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee]}(n)||[];for(let t=0;t<s.length;t++){const n=s[t],i=e[`get${S(n)}`],l={id:o,name:n,value:i?i():void 0},c=a(n);c.length&&(l.children=c),r.push(l)}return r}o(t.ui,ee),e.updateUI=n=>{t.ui=JSON.parse(JSON.stringify(n||[])),Object.keys(r).forEach((e=>delete r[e])),Object.keys(i).forEach((e=>delete i[e])),o(t.ui,ee),e.modified()},e.updateProxyProperty=(e,t)=>{const n=r[e];n?Object.assign(n,t):r[e]={...t}},e.activate=()=>{if(t.proxyManager){const n=`setActive${S(e.getProxyGroup().slice(0,-1))}`;t.proxyManager[n]&&t.proxyManager[n](e)}},t.propertyLinkSubscribers={},e.registerPropertyLinkForGC=(e,n)=>{n in t.propertyLinkSubscribers||(t.propertyLinkSubscribers[n]=[]),t.propertyLinkSubscribers[n].push(e)},e.gcPropertyLinks=n=>{const r=t.propertyLinkSubscribers[n]||[];for(;r.length;)r.pop().unbind(e)},t.propertyLinkMap={},e.getPropertyLink=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.propertyLinkMap[e])return t.propertyLinkMap[e];let r=null;const i=[];let o=0,a=!1;function s(n){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(a)return null;const l=[];let c=null;for(o=i.length;o--;){const e=i[o];e.instance===n?c=e:l.push(e)}if(!c)return null;const u=c.instance[`get${S(c.propertyName)}`]();if(!function(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}(u,r)||s){for(r=u,a=!0;l.length;){const e=l.pop();e.instance.set({[e.propertyName]:r})}a=!1}return t.propertyLinkMap[e].persistent&&(t.propertyLinkMap[e].value=u),u}function l(e,t){const n=[];for(o=i.length;o--;){const r=i[o];r.instance!==e||r.propertyName!==t&&void 0!==t||(r.subscription.unsubscribe(),n.push(o))}for(;n.length;)i.splice(n.pop(),1)}const c={bind:function(n,r){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=n.onModified(s),c=i[0];return i.push({instance:n,propertyName:r,subscription:a}),o&&(t.propertyLinkMap[e].persistent&&void 0!==t.propertyLinkMap[e].value?n.set({[r]:t.propertyLinkMap[e].value}):c&&s(c.instance,!0)),{unsubscribe:()=>l(n,r)}},unbind:l,unsubscribe:function(){for(;i.length;)i.pop().subscription.unsubscribe()},persistent:n};return t.propertyLinkMap[e]=c,c},e.listPropertyNames=()=>a().map((e=>e.name)),e.getPropertyByName=e=>a().find((t=>t.name===e)),e.getPropertyDomainByName=e=>(r[e]||{}).domain,e.getProxySection=()=>({id:t.proxyId,name:t.proxyGroup,ui:t.ui,properties:a()}),e.delete=()=>{const r=Object.keys(t.propertyLinkMap);let i=r.length;for(;i--;)t.propertyLinkMap[r[i]].unsubscribe();Object.keys(t.propertyLinkSubscribers).forEach(e.gcPropertyLinks),n()},e.getState=()=>null,O((function(){if(t.links)for(let n=0;n<t.links.length;n++){const{link:r,property:i,persistent:o,updateOnBind:a,type:s}=t.links[n];if("application"===s){const n=t.proxyManager.getPropertyLink(r,o);e.registerPropertyLinkForGC(n,"application"),n.bind(e,i,a)}}}))}function ne(e,t,n){const r=e.delete,i=[],o=Object.keys(n);let a=o.length;for(;a--;){const r=o[a],{modelKey:s,property:l,modified:c=!0}=n[r],u=S(l),d=S(r);e[`get${d}`]=t[s][`get${u}`],e[`set${d}`]=t[s][`set${u}`],c&&i.push(t[s].onModified(e.modified))}e.delete=()=>{for(;i.length;)i.pop().unsubscribe();r()}}function re(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};function i(e){const n=Object.keys(e);let r=n.length;for(;r--;){const i=n[r];t[i].set(e[i])}}t.this=e;const o=Object.keys(r);let a=o.length;for(;a--;){const s=o[a];t[s]=r[s];const l=n[s];e[`set${S(s)}`]=n=>{if(n!==t[s]){t[s]=n;i(l[n]),e.modified()}}}o.length&&M(e,t,o)}function ie(e){let t=0,n=0,r=0,i=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),r=10*t,i=10*n,"deltaY"in e&&(i=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||i)&&e.deltaMode&&(1===e.deltaMode?(r*=40,i*=40):(r*=800,i*=800)),r&&!t&&(t=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:t,spinY:n||t,pixelX:r,pixelY:i||r}}var oe={algo:W,capitalize:T,chain:q,debounce:Y,enumToString:function(e,t){return Object.keys(e).find((n=>e[n]===t))},event:H,EVENT_ABORT:j,formatBytesToProperUnit:_,formatNumbersWithThousandSeparator:I,get:M,getArray:k,getCurrentGlobalMTime:function(){return s},getStateArrayMapFunc:D,isVtkObject:$,keystore:Z,measurePromiseExecution:P,moveToProtected:z,newInstance:K,newTypedArray:A,newTypedArrayFrom:C,normalizeWheel:ie,obj:R,proxy:te,proxyPropertyMapping:ne,proxyPropertyState:re,safeArrays:E,set:B,setArray:U,setGet:V,setGetArray:G,setImmediate:O,setLoggerFunction:p,throttle:J,traverseInstanceTree:X,TYPED_ARRAYS:x,uncapitalize:w,VOID:l,vtkDebugMacro:m,vtkErrorMacro:g,vtkInfoMacro:h,vtkLogMacro:f,vtkOnceErrorMacro:b,vtkWarningMacro:v,objectSetterMap:L},ae=Object.freeze({__proto__:null,VOID:l,setLoggerFunction:p,vtkLogMacro:f,vtkInfoMacro:h,vtkDebugMacro:m,vtkErrorMacro:g,vtkWarningMacro:v,vtkOnceErrorMacro:b,TYPED_ARRAYS:x,newTypedArray:A,newTypedArrayFrom:C,capitalize:T,_capitalize:S,uncapitalize:w,formatBytesToProperUnit:_,formatNumbersWithThousandSeparator:I,setImmediateVTK:O,measurePromiseExecution:P,obj:R,get:M,set:B,setGet:V,getArray:k,setArray:U,setGetArray:G,moveToProtected:z,algo:W,EVENT_ABORT:j,event:H,newInstance:K,chain:q,isVtkObject:$,traverseInstanceTree:X,debounce:Y,throttle:J,keystore:Z,proxy:te,proxyPropertyMapping:ne,proxyPropertyState:re,normalizeWheel:ie,default:oe})},42852:(e,t,n)=>{"use strict";n.d(t,{A:()=>a,n:()=>i});var r=n(5744);const i=n.n(r)()(),o={vtkObject:()=>null};function a(e){if(null==e)return e;if(e.isA)return e;if(!e.vtkClass)return i.console&&i.console.error&&i.console.error("Invalid VTK object"),null;const t=o[e.vtkClass];if(!t)return i.console&&i.console.error&&i.console.error(`No vtk class found for Object of type ${e.vtkClass}`),null;const n={...e};Object.keys(n).forEach((e=>{n[e]&&"object"==typeof n[e]&&n[e].vtkClass&&(n[e]=a(n[e]))}));const r=t(n);return r&&r.modified&&r.modified(),r}a.register=function(e,t){o[e]=t}},45043:e=>{"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!e(t[a],n[a]))return!1}return!0}return t!=t&&n!=n}},24457:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ARRAY_TYPE:()=>i,EPSILON:()=>r,RANDOM:()=>o,equals:()=>c,setMatrixArrayType:()=>a,toRadian:()=>l});var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,o=Math.random;function a(e){i=e}var s=Math.PI/180;function l(e){return e*s}function c(e,t){return Math.abs(e-t)<=r*Math.max(1,Math.abs(e),Math.abs(t))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})},3823:(e,t,n)=>{"use strict";n.d(t,{Fd:()=>i,w0:()=>o,pB:()=>a,Yu:()=>s,Zc:()=>r,eR:()=>ee,ln:()=>te});var r={};n.r(r),n.d(r,{add:()=>f,angle:()=>U,ceil:()=>v,clone:()=>c,copy:()=>d,create:()=>l,cross:()=>R,dist:()=>Y,distance:()=>S,div:()=>X,divide:()=>g,dot:()=>P,equals:()=>j,exactEquals:()=>W,floor:()=>y,forEach:()=>Q,fromValues:()=>u,inverse:()=>D,len:()=>K,length:()=>_,lerp:()=>N,max:()=>x,min:()=>b,mul:()=>$,multiply:()=>m,negate:()=>E,normalize:()=>O,random:()=>M,rotate:()=>k,round:()=>A,scale:()=>C,scaleAndAdd:()=>T,set:()=>p,sqrDist:()=>J,sqrLen:()=>Z,squaredDistance:()=>w,squaredLength:()=>I,str:()=>z,sub:()=>q,subtract:()=>h,transformMat2:()=>L,transformMat2d:()=>F,transformMat3:()=>B,transformMat4:()=>V,zero:()=>G});var i=n(24457),o=(n(98232),n(72918),n(32591)),a=n(28910),s=n(50095);n(16953);function l(){var e=new i.ARRAY_TYPE(2);return i.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function c(e){var t=new i.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t}function u(e,t){var n=new i.ARRAY_TYPE(2);return n[0]=e,n[1]=t,n}function d(e,t){return e[0]=t[0],e[1]=t[1],e}function p(e,t,n){return e[0]=t,e[1]=n,e}function f(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function h(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function m(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function g(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function v(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function y(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function b(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function x(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function A(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function C(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function T(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function S(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function w(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function _(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function I(e){var t=e[0],n=e[1];return t*t+n*n}function E(e,t){return e[0]=-t[0],e[1]=-t[1],e}function D(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function O(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function P(e,t){return e[0]*t[0]+e[1]*t[1]}function R(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function N(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e}function M(e,t){t=t||1;var n=2*i.RANDOM()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function L(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e}function F(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}function B(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}function V(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}function k(e,t,n,r){var i=t[0]-n[0],o=t[1]-n[1],a=Math.sin(r),s=Math.cos(r);return e[0]=i*s-o*a+n[0],e[1]=i*a+o*s+n[1],e}function U(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),s=a&&(n*i+r*o)/a;return Math.acos(Math.min(Math.max(s,-1),1))}function G(e){return e[0]=0,e[1]=0,e}function z(e){return"vec2("+e[0]+", "+e[1]+")"}function W(e,t){return e[0]===t[0]&&e[1]===t[1]}function j(e,t){var n=e[0],r=e[1],o=t[0],a=t[1];return Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))}var H,K=_,q=h,$=m,X=g,Y=S,J=w,Z=I,Q=(H=l(),function(e,t,n,r,i,o){var a,s;for(t||(t=2),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,a=n;a<s;a+=t)H[0]=e[a],H[1]=e[a+1],i(H,H,o),e[a]=H[0],e[a+1]=H[1];return e}),ee=n(9175),te=n(15958)},32591:(e,t,n)=>{"use strict";n.r(t),n.d(t,{add:()=>E,adjoint:()=>f,clone:()=>a,copy:()=>s,create:()=>i,determinant:()=>h,equals:()=>N,exactEquals:()=>R,frob:()=>I,fromMat2d:()=>C,fromMat4:()=>o,fromQuat:()=>T,fromRotation:()=>x,fromScaling:()=>A,fromTranslation:()=>b,fromValues:()=>l,identity:()=>u,invert:()=>p,mul:()=>M,multiply:()=>m,multiplyScalar:()=>O,multiplyScalarAndAdd:()=>P,normalFromMat4:()=>S,projection:()=>w,rotate:()=>v,scale:()=>y,set:()=>c,str:()=>_,sub:()=>L,subtract:()=>D,translate:()=>g,transpose:()=>d});var r=n(24457);function i(){var e=new r.ARRAY_TYPE(9);return r.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function a(e){var t=new r.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function l(e,t,n,i,o,a,s,l,c){var u=new r.ARRAY_TYPE(9);return u[0]=e,u[1]=t,u[2]=n,u[3]=i,u[4]=o,u[5]=a,u[6]=s,u[7]=l,u[8]=c,u}function c(e,t,n,r,i,o,a,s,l,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=c,e}function u(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function d(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function p(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=u*a-s*c,p=-u*o+s*l,f=c*o-a*l,h=n*d+r*p+i*f;return h?(h=1/h,e[0]=d*h,e[1]=(-u*r+i*c)*h,e[2]=(s*r-i*a)*h,e[3]=p*h,e[4]=(u*n-i*l)*h,e[5]=(-s*n+i*o)*h,e[6]=f*h,e[7]=(-c*n+r*l)*h,e[8]=(a*n-r*o)*h,e):null}function f(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8];return e[0]=a*u-s*c,e[1]=i*c-r*u,e[2]=r*s-i*a,e[3]=s*l-o*u,e[4]=n*u-i*l,e[5]=i*o-n*s,e[6]=o*c-a*l,e[7]=r*l-n*c,e[8]=n*a-r*o,e}function h(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8];return t*(c*o-a*l)+n*(-c*i+a*s)+r*(l*i-o*s)}function m(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],p=n[0],f=n[1],h=n[2],m=n[3],g=n[4],v=n[5],y=n[6],b=n[7],x=n[8];return e[0]=p*r+f*a+h*c,e[1]=p*i+f*s+h*u,e[2]=p*o+f*l+h*d,e[3]=m*r+g*a+v*c,e[4]=m*i+g*s+v*u,e[5]=m*o+g*l+v*d,e[6]=y*r+b*a+x*c,e[7]=y*i+b*s+x*u,e[8]=y*o+b*l+x*d,e}function g(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],p=n[0],f=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=p*r+f*a+c,e[7]=p*i+f*s+u,e[8]=p*o+f*l+d,e}function v(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],p=Math.sin(n),f=Math.cos(n);return e[0]=f*r+p*a,e[1]=f*i+p*s,e[2]=f*o+p*l,e[3]=f*a-p*r,e[4]=f*s-p*i,e[5]=f*l-p*o,e[6]=c,e[7]=u,e[8]=d,e}function y(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function b(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function x(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function A(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function C(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function T(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,l=i+i,c=n*a,u=r*a,d=r*s,p=i*a,f=i*s,h=i*l,m=o*a,g=o*s,v=o*l;return e[0]=1-d-h,e[3]=u-v,e[6]=p+g,e[1]=u+v,e[4]=1-c-h,e[7]=f-m,e[2]=p-g,e[5]=f+m,e[8]=1-c-d,e}function S(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],p=t[10],f=t[11],h=t[12],m=t[13],g=t[14],v=t[15],y=n*s-r*a,b=n*l-i*a,x=n*c-o*a,A=r*l-i*s,C=r*c-o*s,T=i*c-o*l,S=u*m-d*h,w=u*g-p*h,_=u*v-f*h,I=d*g-p*m,E=d*v-f*m,D=p*v-f*g,O=y*D-b*E+x*I+A*_-C*w+T*S;return O?(O=1/O,e[0]=(s*D-l*E+c*I)*O,e[1]=(l*_-a*D-c*w)*O,e[2]=(a*E-s*_+c*S)*O,e[3]=(i*E-r*D-o*I)*O,e[4]=(n*D-i*_+o*w)*O,e[5]=(r*_-n*E-o*S)*O,e[6]=(m*T-g*C+v*A)*O,e[7]=(g*x-h*T-v*b)*O,e[8]=(h*C-m*x+v*y)*O,e):null}function w(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function _(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function I(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function E(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function D(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function O(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function P(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function R(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function N(e,t){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],d=e[8],p=t[0],f=t[1],h=t[2],m=t[3],g=t[4],v=t[5],y=t[6],b=t[7],x=t[8];return Math.abs(n-p)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(i-f)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-h)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-m)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-g)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(l-v)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(c-y)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-b)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(d-x)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))}var M=m,L=D},50095:(e,t,n)=>{"use strict";n.r(t),n.d(t,{add:()=>B,calculateW:()=>g,clone:()=>N,conjugate:()=>T,copy:()=>L,create:()=>s,dot:()=>U,equals:()=>$,exactEquals:()=>q,exp:()=>v,fromEuler:()=>w,fromMat3:()=>S,fromValues:()=>M,getAngle:()=>d,getAxisAngle:()=>u,identity:()=>l,invert:()=>C,len:()=>W,length:()=>z,lerp:()=>G,ln:()=>y,mul:()=>V,multiply:()=>p,normalize:()=>K,pow:()=>b,random:()=>A,rotateX:()=>f,rotateY:()=>h,rotateZ:()=>m,rotationTo:()=>X,scale:()=>k,set:()=>F,setAxes:()=>J,setAxisAngle:()=>c,slerp:()=>x,sqlerp:()=>Y,sqrLen:()=>H,squaredLength:()=>j,str:()=>_});var r=n(24457),i=n(32591),o=n(9175),a=n(15958);function s(){var e=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function l(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function c(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function u(e,t){var n=2*Math.acos(t[3]),i=Math.sin(n/2);return i>r.EPSILON?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),n}function d(e,t){var n=U(e,t);return Math.acos(2*n*n-1)}function p(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],l=n[1],c=n[2],u=n[3];return e[0]=r*u+a*s+i*c-o*l,e[1]=i*u+a*l+o*s-r*c,e[2]=o*u+a*c+r*l-i*s,e[3]=a*u-r*s-i*l-o*c,e}function f(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+a*s,e[1]=i*l+o*s,e[2]=o*l-i*s,e[3]=a*l-r*s,e}function h(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l-o*s,e[1]=i*l+a*s,e[2]=o*l+r*s,e[3]=a*l-i*s,e}function m(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+i*s,e[1]=i*l-r*s,e[2]=o*l+a*s,e[3]=a*l-o*s,e}function g(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function v(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=Math.sqrt(n*n+r*r+i*i),s=Math.exp(o),l=a>0?s*Math.sin(a)/a:0;return e[0]=n*l,e[1]=r*l,e[2]=i*l,e[3]=s*Math.cos(a),e}function y(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=Math.sqrt(n*n+r*r+i*i),s=a>0?Math.atan2(a,o)/a:0;return e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=.5*Math.log(n*n+r*r+i*i+o*o),e}function b(e,t,n){return y(e,t),k(e,e,n),v(e,e),e}function x(e,t,n,i){var o,a,s,l,c,u=t[0],d=t[1],p=t[2],f=t[3],h=n[0],m=n[1],g=n[2],v=n[3];return(a=u*h+d*m+p*g+f*v)<0&&(a=-a,h=-h,m=-m,g=-g,v=-v),1-a>r.EPSILON?(o=Math.acos(a),s=Math.sin(o),l=Math.sin((1-i)*o)/s,c=Math.sin(i*o)/s):(l=1-i,c=i),e[0]=l*u+c*h,e[1]=l*d+c*m,e[2]=l*p+c*g,e[3]=l*f+c*v,e}function A(e){var t=r.RANDOM(),n=r.RANDOM(),i=r.RANDOM(),o=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=o*Math.sin(2*Math.PI*n),e[1]=o*Math.cos(2*Math.PI*n),e[2]=a*Math.sin(2*Math.PI*i),e[3]=a*Math.cos(2*Math.PI*i),e}function C(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function S(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+a]-t[3*a+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e}function w(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var o=Math.sin(t),a=Math.cos(t),s=Math.sin(n),l=Math.cos(n),c=Math.sin(r),u=Math.cos(r);return e[0]=o*l*u-a*s*c,e[1]=a*s*u+o*l*c,e[2]=a*l*c-o*s*u,e[3]=a*l*u+o*s*c,e}function _(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var I,E,D,O,P,R,N=a.clone,M=a.fromValues,L=a.copy,F=a.set,B=a.add,V=p,k=a.scale,U=a.dot,G=a.lerp,z=a.length,W=z,j=a.squaredLength,H=j,K=a.normalize,q=a.exactEquals,$=a.equals,X=(I=o.create(),E=o.fromValues(1,0,0),D=o.fromValues(0,1,0),function(e,t,n){var r=o.dot(t,n);return r<-.999999?(o.cross(I,E,t),o.len(I)<1e-6&&o.cross(I,D,t),o.normalize(I,I),c(e,I,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(o.cross(I,t,n),e[0]=I[0],e[1]=I[1],e[2]=I[2],e[3]=1+r,K(e,e))}),Y=(O=s(),P=s(),function(e,t,n,r,i,o){return x(O,t,i,o),x(P,n,r,o),x(e,O,P,2*o*(1-o)),e}),J=(R=i.create(),function(e,t,n,r){return R[0]=n[0],R[3]=n[1],R[6]=n[2],R[1]=r[0],R[4]=r[1],R[7]=r[2],R[2]=-t[0],R[5]=-t[1],R[8]=-t[2],K(e,S(e,R))})},15958:(e,t,n)=>{"use strict";n.r(t),n.d(t,{add:()=>c,ceil:()=>f,clone:()=>o,copy:()=>s,create:()=>i,cross:()=>E,dist:()=>G,distance:()=>x,div:()=>U,divide:()=>p,dot:()=>I,equals:()=>F,exactEquals:()=>L,floor:()=>h,forEach:()=>H,fromValues:()=>a,inverse:()=>w,len:()=>W,length:()=>C,lerp:()=>D,max:()=>g,min:()=>m,mul:()=>k,multiply:()=>d,negate:()=>S,normalize:()=>_,random:()=>O,round:()=>v,scale:()=>y,scaleAndAdd:()=>b,set:()=>l,sqrDist:()=>z,sqrLen:()=>j,squaredDistance:()=>A,squaredLength:()=>T,str:()=>M,sub:()=>V,subtract:()=>u,transformMat4:()=>P,transformQuat:()=>R,zero:()=>N});var r=n(24457);function i(){var e=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function o(e){var t=new r.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=i,o}function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function l(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function c(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function u(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function d(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function p(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function f(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function h(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function m(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function g(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function v(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function y(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function b(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function x(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.hypot(n,r,i,o)}function A(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o}function C(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)}function T(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function S(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function w(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function _(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a,e}function I(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function E(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],l=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],u=t[0],d=t[1],p=t[2],f=t[3];return e[0]=d*c-p*l+f*s,e[1]=-u*c+p*a-f*o,e[2]=u*l-d*a+f*i,e[3]=-u*s+d*o-p*i,e}function D(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e}function O(e,t){var n,i,o,a,s,l;t=t||1;do{s=(n=2*r.RANDOM()-1)*n+(i=2*r.RANDOM()-1)*i}while(s>=1);do{l=(o=2*r.RANDOM()-1)*o+(a=2*r.RANDOM()-1)*a}while(l>=1);var c=Math.sqrt((1-s)/l);return e[0]=t*n,e[1]=t*i,e[2]=t*o*c,e[3]=t*a*c,e}function P(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e}function R(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],l=n[2],c=n[3],u=c*r+s*o-l*i,d=c*i+l*r-a*o,p=c*o+a*i-s*r,f=-a*r-s*i-l*o;return e[0]=u*c+f*-a+d*-l-p*-s,e[1]=d*c+f*-s+p*-a-u*-l,e[2]=p*c+f*-l+u*-s-d*-a,e[3]=t[3],e}function N(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function M(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function L(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function F(e,t){var n=e[0],i=e[1],o=e[2],a=e[3],s=t[0],l=t[1],c=t[2],u=t[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-u)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))}var B,V=u,k=d,U=p,G=x,z=A,W=C,j=T,H=(B=i(),function(e,t,n,r,i,o){var a,s;for(t||(t=4),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,a=n;a<s;a+=t)B[0]=e[a],B[1]=e[a+1],B[2]=e[a+2],B[3]=e[a+3],i(B,B,o),e[a]=B[0],e[a+1]=B[1],e[a+2]=B[2],e[a+3]=B[3];return e})},93008:(e,t,n)=>{var r="__lodash_hash_undefined__",i=1/0,o="[object Function]",a="[object GeneratorFunction]",s="[object Symbol]",l=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,c=/^\w*$/,u=/^\./,d=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,p=/\\(\\)?/g,f=/^\[object .+?Constructor\]$/,h="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,m="object"==typeof self&&self&&self.Object===Object&&self,g=h||m||Function("return this")();var v,y=Array.prototype,b=Function.prototype,x=Object.prototype,A=g["__core-js_shared__"],C=(v=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",T=b.toString,S=x.hasOwnProperty,w=x.toString,_=RegExp("^"+T.call(S).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),I=g.Symbol,E=y.splice,D=U(g,"Map"),O=U(Object,"create"),P=I?I.prototype:void 0,R=P?P.toString:void 0;function N(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function M(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function L(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function F(e,t){for(var n=e.length;n--;)if(j(e[n][0],t))return n;return-1}function B(e,t){t=function(e,t){if(H(e))return!1;var n=typeof e;if("number"==n||"symbol"==n||"boolean"==n||null==e||q(e))return!0;return c.test(e)||!l.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:function(e){return H(e)?e:G(e)}(t);for(var n=0,r=t.length;null!=e&&n<r;)e=e[z(t[n++])];return n&&n==r?e:void 0}function V(e){if(!K(e)||(t=e,C&&C in t))return!1;var t,n=function(e){var t=K(e)?w.call(e):"";return t==o||t==a}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?_:f;return n.test(function(e){if(null!=e){try{return T.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function k(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function U(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return V(n)?n:void 0}N.prototype.clear=function(){this.__data__=O?O(null):{}},N.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},N.prototype.get=function(e){var t=this.__data__;if(O){var n=t[e];return n===r?void 0:n}return S.call(t,e)?t[e]:void 0},N.prototype.has=function(e){var t=this.__data__;return O?void 0!==t[e]:S.call(t,e)},N.prototype.set=function(e,t){return this.__data__[e]=O&&void 0===t?r:t,this},M.prototype.clear=function(){this.__data__=[]},M.prototype.delete=function(e){var t=this.__data__,n=F(t,e);return!(n<0)&&(n==t.length-1?t.pop():E.call(t,n,1),!0)},M.prototype.get=function(e){var t=this.__data__,n=F(t,e);return n<0?void 0:t[n][1]},M.prototype.has=function(e){return F(this.__data__,e)>-1},M.prototype.set=function(e,t){var n=this.__data__,r=F(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},L.prototype.clear=function(){this.__data__={hash:new N,map:new(D||M),string:new N}},L.prototype.delete=function(e){return k(this,e).delete(e)},L.prototype.get=function(e){return k(this,e).get(e)},L.prototype.has=function(e){return k(this,e).has(e)},L.prototype.set=function(e,t){return k(this,e).set(e,t),this};var G=W((function(e){e=function(e){return null==e?"":function(e){if("string"==typeof e)return e;if(q(e))return R?R.call(e):"";var t=e+"";return"0"==t&&1/e==-i?"-0":t}(e)}(e);var t=[];return u.test(e)&&t.push(""),e.replace(d,(function(e,n,r,i){t.push(r?i.replace(p,"$1"):n||e)})),t}));function z(e){if("string"==typeof e||q(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function W(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a),a};return n.cache=new(W.Cache||L),n}function j(e,t){return e===t||e!=e&&t!=t}W.Cache=L;var H=Array.isArray;function K(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function q(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&w.call(e)==s}e.exports=function(e,t,n){var r=null==e?void 0:B(e,t);return void 0===r?n:r}},4367:function(e,t,n){var r,i;!function(o,a){"use strict";r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],i={},o=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?s:void 0!==console[r]?a(console,r):void 0!==console.log?a(console,"log"):e)}function c(){for(var n=this.getLevel(),i=0;i<r.length;i++){var o=r[i];this[o]=i<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function u(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function d(e,t,n){return l(e)||u.apply(this,arguments)}function p(e,n){var a,s,l,u=this,p="loglevel";function f(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&p){try{return void(window.localStorage[p]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(p)+"="+n+";"}catch(e){}}}function h(){var e;if(typeof window!==t&&p){try{e=window.localStorage[p]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=encodeURIComponent(p),i=n.indexOf(r+"=");-1!==i&&(e=/^([^;]+)/.exec(n.slice(i+r.length+1))[1])}catch(e){}return void 0===u.levels[e]&&(e=void 0),e}}function m(){if(typeof window!==t&&p){try{window.localStorage.removeItem(p)}catch(e){}try{window.document.cookie=encodeURIComponent(p)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}function g(e){var t=e;if("string"==typeof t&&void 0!==u.levels[t.toUpperCase()]&&(t=u.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=u.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?p+=":"+e:"symbol"==typeof e&&(p=void 0),u.name=e,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=n||d,u.getLevel=function(){return null!=l?l:null!=s?s:a},u.setLevel=function(e,t){return l=g(e),!1!==t&&f(l),c.call(u)},u.setDefaultLevel=function(e){s=g(e),h()||u.setLevel(e,!1)},u.resetLevel=function(){l=null,m(),c.call(u)},u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)},u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)},u.rebuild=function(){if(o!==u&&(a=g(o.getLevel())),c.call(u),o===u)for(var e in i)i[e].rebuild()},a=g(o?o.getLevel():"WARN");var v=h();null!=v&&(l=g(v)),c.call(u)}(o=new p).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=i[e];return t||(t=i[e]=new p(e,o.methodFactory)),t};var f=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=f),o},o.getLoggers=function(){return i},o.default=o,o},void 0===(i="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=i)}()},56037:(e,t,n)=>{var r=n(89738),i=n(81327),o=n(21897),a=n(49329),s=n(95967),l=n(68415),c=n(17663);c.alea=r,c.xor128=i,c.xorwow=o,c.xorshift7=a,c.xor4096=s,c.tychei=l,e.exports=c},10989:e=>{e.exports=function(e){"use strict";var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(e,t){var n=e[0],r=e[1],i=e[2],o=e[3];r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&i)+t[1]-389564586|0)<<12|o>>>20)+n|0)&n|~o&r)+t[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&n)+t[3]-1044525330|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&i)+t[5]+1200080426|0)<<12|o>>>20)+n|0)&n|~o&r)+t[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&n)+t[7]-45705983|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&i)+t[9]-1958414417|0)<<12|o>>>20)+n|0)&n|~o&r)+t[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&n)+t[11]-1990404162|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&i)+t[13]-40341101|0)<<12|o>>>20)+n|0)&n|~o&r)+t[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&n)+t[15]+1236535329|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[1]-165796510|0)<<5|n>>>27)+r|0)&i|r&~i)+t[6]-1069501632|0)<<9|o>>>23)+n|0)&r|n&~r)+t[11]+643717713|0)<<14|i>>>18)+o|0)&n|o&~n)+t[0]-373897302|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[5]-701558691|0)<<5|n>>>27)+r|0)&i|r&~i)+t[10]+38016083|0)<<9|o>>>23)+n|0)&r|n&~r)+t[15]-660478335|0)<<14|i>>>18)+o|0)&n|o&~n)+t[4]-405537848|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[9]+568446438|0)<<5|n>>>27)+r|0)&i|r&~i)+t[14]-1019803690|0)<<9|o>>>23)+n|0)&r|n&~r)+t[3]-187363961|0)<<14|i>>>18)+o|0)&n|o&~n)+t[8]+1163531501|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[13]-1444681467|0)<<5|n>>>27)+r|0)&i|r&~i)+t[2]-51403784|0)<<9|o>>>23)+n|0)&r|n&~r)+t[7]+1735328473|0)<<14|i>>>18)+o|0)&n|o&~n)+t[12]-1926607734|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[5]-378558|0)<<4|n>>>28)+r|0)^r^i)+t[8]-2022574463|0)<<11|o>>>21)+n|0)^n^r)+t[11]+1839030562|0)<<16|i>>>16)+o|0)^o^n)+t[14]-35309556|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[1]-1530992060|0)<<4|n>>>28)+r|0)^r^i)+t[4]+1272893353|0)<<11|o>>>21)+n|0)^n^r)+t[7]-155497632|0)<<16|i>>>16)+o|0)^o^n)+t[10]-1094730640|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[13]+681279174|0)<<4|n>>>28)+r|0)^r^i)+t[0]-358537222|0)<<11|o>>>21)+n|0)^n^r)+t[3]-722521979|0)<<16|i>>>16)+o|0)^o^n)+t[6]+76029189|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[9]-640364487|0)<<4|n>>>28)+r|0)^r^i)+t[12]-421815835|0)<<11|o>>>21)+n|0)^n^r)+t[15]+530742520|0)<<16|i>>>16)+o|0)^o^n)+t[2]-995338651|0)<<23|r>>>9)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[0]-198630844|0)<<6|n>>>26)+r|0)|~i))+t[7]+1126891415|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[14]-1416354905|0)<<15|i>>>17)+o|0)|~n))+t[5]-57434055|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[12]+1700485571|0)<<6|n>>>26)+r|0)|~i))+t[3]-1894986606|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[10]-1051523|0)<<15|i>>>17)+o|0)|~n))+t[1]-2054922799|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[8]+1873313359|0)<<6|n>>>26)+r|0)|~i))+t[15]-30611744|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[6]-1560198380|0)<<15|i>>>17)+o|0)|~n))+t[13]+1309151649|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[4]-145523070|0)<<6|n>>>26)+r|0)|~i))+t[11]-1120210379|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[2]+718787259|0)<<15|i>>>17)+o|0)|~n))+t[9]-343485551|0)<<21|r>>>11)+i|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}function r(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function i(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function o(e){var t,i,o,a,s,l,c=e.length,u=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)n(u,r(e.substring(t-64,t)));for(i=(e=e.substring(t-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(n(u,o),t=0;t<16;t+=1)o[t]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),l=parseInt(a[1],16)||0,o[14]=s,o[15]=l,n(u,o),u}function a(e){var t,r,o,a,s,l,c=e.length,u=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)n(u,i(e.subarray(t-64,t)));for(r=(e=t-64<c?e.subarray(t-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<r;t+=1)o[t>>2]|=e[t]<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(n(u,o),t=0;t<16;t+=1)o[t]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),l=parseInt(a[1],16)||0,o[14]=s,o[15]=l,n(u,o),u}function s(e){var n,r="";for(n=0;n<4;n+=1)r+=t[e>>8*n+4&15]+t[e>>8*n&15];return r}function l(e){var t;for(t=0;t<e.length;t+=1)e[t]=s(e[t]);return e.join("")}function c(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function u(e,t){var n,r=e.length,i=new ArrayBuffer(r),o=new Uint8Array(i);for(n=0;n<r;n+=1)o[n]=e.charCodeAt(n);return t?o:i}function d(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function p(e,t,n){var r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e)),r.set(new Uint8Array(t),e.byteLength),n?r:r.buffer}function f(e){var t,n=[],r=e.length;for(t=0;t<r-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function h(){this.reset()}return l(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(n,r){var i,o,a,s,l=this.byteLength,c=t(n,l),u=l;return r!==e&&(u=t(r,l)),c>u?new ArrayBuffer(0):(i=u-c,o=new ArrayBuffer(i),a=new Uint8Array(o),s=new Uint8Array(this,c,i),a.set(s),o)}}(),h.prototype.append=function(e){return this.appendBinary(c(e)),this},h.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)n(this._hash,r(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},h.prototype.end=function(e){var t,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(o,i),n=l(this._hash),e&&(n=f(n)),this.reset(),n},h.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},h.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},h.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},h.prototype._finish=function(e,t){var r,i,o,a=t;if(e[a>>2]|=128<<(a%4<<3),a>55)for(n(this._hash,e),a=0;a<16;a+=1)e[a]=0;r=(r=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(r[2],16),o=parseInt(r[1],16)||0,e[14]=i,e[15]=o,n(this._hash,e)},h.hash=function(e,t){return h.hashBinary(c(e),t)},h.hashBinary=function(e,t){var n=l(o(e));return t?f(n):n},h.ArrayBuffer=function(){this.reset()},h.ArrayBuffer.prototype.append=function(e){var t,r=p(this._buff.buffer,e,!0),o=r.length;for(this._length+=e.byteLength,t=64;t<=o;t+=64)n(this._hash,i(r.subarray(t-64,t)));return this._buff=t-64<o?new Uint8Array(r.buffer.slice(t-64)):new Uint8Array(0),this},h.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=r[t]<<(t%4<<3);return this._finish(o,i),n=l(this._hash),e&&(n=f(n)),this.reset(),n},h.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},h.ArrayBuffer.prototype.getState=function(){var e=h.prototype.getState.call(this);return e.buff=d(e.buff),e},h.ArrayBuffer.prototype.setState=function(e){return e.buff=u(e.buff,!0),h.prototype.setState.call(this,e)},h.ArrayBuffer.prototype.destroy=h.prototype.destroy,h.ArrayBuffer.prototype._finish=h.prototype._finish,h.ArrayBuffer.hash=function(e,t){var n=l(a(new Uint8Array(e)));return t?f(n):n},h}()},14235:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=184)}([function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(240)),r(n(251)),r(n(175)),r(n(107)),r(n(29)),r(n(73)),r(n(106)),r(n(30)),r(n(252)),r(n(52)),r(n(97)),r(n(253)),r(n(37)),r(n(51)),r(n(173)),r(n(176)),r(n(172)),r(n(108)),r(n(254)),r(n(255)),r(n(256)),r(n(72)),r(n(177)),r(n(105)),r(n(17)),r(n(257)),r(n(12)),r(n(174))},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(212);t.FixedSizeSet=i.FixedSizeSet;var o=n(213);t.ObjectCache=o.ObjectCache;var a=n(214);t.CompareCache=a.CompareCache;var s=n(215);t.Lazy=s.Lazy;var l=n(216);function c(e,t,n){if(m(e))e.forEach((function(e,r){return t.call(n,r,e)}));else for(var r in e)e.hasOwnProperty(r)&&t.call(n,r,e[r])}function u(e){var t,n;if(d(e))return e;if(f(e)){var i=[];try{for(var o=r(e),a=o.next();!a.done;a=o.next()){var s=a.value;i.push(u(s))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i}if(p(e)){for(var l in i={},e)if(e.hasOwnProperty(l)){var c=e[l];i[l]=u(c)}return i}return e}function d(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)}function p(e){var t=typeof e;return!!e&&("function"===t||"object"===t)}function f(e){return Array.isArray(e)}function h(e){return e instanceof Set}function m(e){return e instanceof Map}function g(e){if(p(e)){var t=Object.getPrototypeOf(e),n=t.constructor;return t&&n&&"function"==typeof n&&n instanceof n&&Function.prototype.toString.call(n)===Function.prototype.toString.call(Object)}return!1}t.StringWalker=l.StringWalker,t.applyMixin=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];Object.getOwnPropertyNames(t.prototype).forEach((function(r){if("constructor"!==r){if(-1!==n.indexOf(r)){var i=Object.getOwnPropertyDescriptor(e.prototype,r);i&&Object.defineProperty(e.prototype,"_"+r,i)}var o=Object.getOwnPropertyDescriptor(t.prototype,r);o&&Object.defineProperty(e.prototype,r,o)}}))},t.applyDefaults=function e(t,n,r){void 0===r&&(r=!1);var i=u(t||{});return c(n,(function(t,n){g(n)?i[t]=e(i[t],n,r):(r||void 0===i[t])&&(i[t]=n)})),i},t.forEachArray=function(e,t,n){e.forEach(t,n)},t.forEachObject=c,t.arrayLength=function(e){return h(e)?e.size:e.length},t.objectLength=function(e){return m(e)?e.size:Object.keys(e).length},t.getObjectValue=function(e,t){return m(e)?e.get(t):e[t]},t.removeObjectValue=function(e,t){m(e)?e.delete(t):delete e[t]},t.clone=u,t.isBoolean=function(e){return"boolean"==typeof e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isFunction=d,t.isObject=p,t.isArray=f,t.isSet=h,t.isMap=m,t.isEmpty=function(e){if(f(e))return!e.length;if(h(e))return!e.size;if(m(e))return!e.size;if(p(e)){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}return!1},t.isPlainObject=g,t.isIterable=function(e){return e&&"function"==typeof e[Symbol.iterator]},t.getValue=function(e){return d(e.valueOf)?e.valueOf():e},t.utf8Encode=function(e){for(var t=new Uint8Array(4*e.length),n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i<128)t[n++]=i;else{if(i<2048)t[n++]=i>>6|192;else{if(i>55295&&i<56320){if(++r>=e.length)throw new Error("Incomplete surrogate pair.");var o=e.charCodeAt(r);if(o<56320||o>57343)throw new Error("Invalid surrogate character.");i=65536+((1023&i)<<10)+(1023&o),t[n++]=i>>18|240,t[n++]=i>>12&63|128}else t[n++]=i>>12|224;t[n++]=i>>6&63|128}t[n++]=63&i|128}}return t.subarray(0,n)},t.utf8Decode=function(e){for(var t="",n=0;n<e.length;){var r=e[n++];if(r>127)if(r>191&&r<224){if(n>=e.length)throw new Error("Incomplete 2-byte sequence.");r=(31&r)<<6|63&e[n++]}else if(r>223&&r<240){if(n+1>=e.length)throw new Error("Incomplete 3-byte sequence.");r=(15&r)<<12|(63&e[n++])<<6|63&e[n++]}else{if(!(r>239&&r<248))throw new Error("Unknown multi-byte start.");if(n+2>=e.length)throw new Error("Incomplete 4-byte sequence.");r=(7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++]}if(r<=65535)t+=String.fromCharCode(r);else{if(!(r<=1114111))throw new Error("Code point exceeds UTF-16 limit.");r-=65536,t+=String.fromCharCode(r>>10|55296),t+=String.fromCharCode(1023&r|56320)}}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Before=0]="Before",e[e.Equal=1]="Equal",e[e.After=2]="After"}(t.BoundaryPosition||(t.BoundaryPosition={})),function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"}(t.EventPhase||(t.EventPhase={})),function(e){e[e.Element=1]="Element",e[e.Attribute=2]="Attribute",e[e.Text=3]="Text",e[e.CData=4]="CData",e[e.EntityReference=5]="EntityReference",e[e.Entity=6]="Entity",e[e.ProcessingInstruction=7]="ProcessingInstruction",e[e.Comment=8]="Comment",e[e.Document=9]="Document",e[e.DocumentType=10]="DocumentType",e[e.DocumentFragment=11]="DocumentFragment",e[e.Notation=12]="Notation"}(t.NodeType||(t.NodeType={})),function(e){e[e.Disconnected=1]="Disconnected",e[e.Preceding=2]="Preceding",e[e.Following=4]="Following",e[e.Contains=8]="Contains",e[e.ContainedBy=16]="ContainedBy",e[e.ImplementationSpecific=32]="ImplementationSpecific"}(t.Position||(t.Position={})),function(e){e[e.Accept=1]="Accept",e[e.Reject=2]="Reject",e[e.Skip=3]="Skip"}(t.FilterResult||(t.FilterResult={})),function(e){e[e.All=4294967295]="All",e[e.Element=1]="Element",e[e.Attribute=2]="Attribute",e[e.Text=4]="Text",e[e.CDataSection=8]="CDataSection",e[e.EntityReference=16]="EntityReference",e[e.Entity=32]="Entity",e[e.ProcessingInstruction=64]="ProcessingInstruction",e[e.Comment=128]="Comment",e[e.Document=256]="Document",e[e.DocumentType=512]="DocumentType",e[e.DocumentFragment=1024]="DocumentFragment",e[e.Notation=2048]="Notation"}(t.WhatToShow||(t.WhatToShow={})),function(e){e[e.StartToStart=0]="StartToStart",e[e.StartToEnd=1]="StartToEnd",e[e.EndToEnd=2]="EndToEnd",e[e.EndToStart=3]="EndToStart"}(t.HowToCompare||(t.HowToCompare={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(241);t.Cast=r.Cast;var i=n(150);t.Guard=i.Guard;var o=n(242);t.EmptySet=o.EmptySet},function(e,t,n){var r=n(11),i=n(55).f,o=n(21),a=n(25),s=n(80),l=n(119),c=n(123);e.exports=function(e,t){var n,u,d,p,f,h=e.target,m=e.global,g=e.stat;if(n=m?r:g?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in t){if(p=t[u],d=e.noTargetGet?(f=i(n,u))&&f.value:n[u],!c(m?u:h+(g?".":"#")+u,e.forced)&&void 0!==d){if(typeof p==typeof d)continue;l(p,d)}(e.sham||d&&d.sham)&&o(p,"sham",!0),a(n,u,p,e)}}},function(e,t,n){var r=n(11),i=n(81),o=n(14),a=n(58),s=n(86),l=n(124),c=i("wks"),u=r.Symbol,d=l?u:u&&u.withoutSetter||a;e.exports=function(e){return o(c,e)||(s&&o(u,e)?c[e]=u[e]:c[e]=d("Symbol."+e)),c[e]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(29),o=function(){function e(){this._features={mutationObservers:!0,customElements:!0,slots:!0,steps:!0},this._window=null,this._compareCache=new r.CompareCache,this._rangeList=new r.FixedSizeSet}return e.prototype.setFeatures=function(e){if(void 0===e&&(e=!0),r.isObject(e))for(var t in e)this._features[t]=e[t]||!1;else for(var t in this._features)this._features[t]=e},Object.defineProperty(e.prototype,"features",{get:function(){return this._features},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return null===this._window&&(this._window=i.create_window()),this._window},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compareCache",{get:function(){return this._compareCache},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rangeList",{get:function(){return this._rangeList},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}();t.dom=o.instance},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(228));t.base64=i;var o=r(n(146));t.byte=o;var a=r(n(147));t.byteSequence=a;var s=r(n(96));t.codePoint=s;var l=r(n(232));t.json=l;var c=r(n(233));t.list=c;var u=r(n(234));t.map=u;var d=r(n(235));t.namespace=d;var p=r(n(236));t.queue=p;var f=r(n(237));t.set=f;var h=r(n(238));t.stack=h;var m=r(n(239));t.string=m},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){void 0===n&&(n="");var r=e.call(this,n)||this;return r.name=t,r}return i(t,e),t}(Error);t.DOMException=o;var a=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"DOMStringSizeError",t)||this}return i(t,e),t}(o);t.DOMStringSizeError=a;var s=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"WrongDocumentError","The object is in the wrong document. "+t)||this}return i(t,e),t}(o);t.WrongDocumentError=s;var l=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"NoDataAllowedError",t)||this}return i(t,e),t}(o);t.NoDataAllowedError=l;var c=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"NoModificationAllowedError","The object can not be modified. "+t)||this}return i(t,e),t}(o);t.NoModificationAllowedError=c;var u=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"NotSupportedError","The operation is not supported. "+t)||this}return i(t,e),t}(o);t.NotSupportedError=u;var d=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"InUseAttributeError",t)||this}return i(t,e),t}(o);t.InUseAttributeError=d;var p=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"InvalidStateError","The object is in an invalid state. "+t)||this}return i(t,e),t}(o);t.InvalidStateError=p;var f=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"InvalidModificationError","The object can not be modified in this way. "+t)||this}return i(t,e),t}(o);t.InvalidModificationError=f;var h=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"NamespaceError","The operation is not allowed by Namespaces in XML. [XMLNS] "+t)||this}return i(t,e),t}(o);t.NamespaceError=h;var m=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"InvalidAccessError","The object does not support the operation or argument. "+t)||this}return i(t,e),t}(o);t.InvalidAccessError=m;var g=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"ValidationError",t)||this}return i(t,e),t}(o);t.ValidationError=g;var v=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"TypeMismatchError",t)||this}return i(t,e),t}(o);t.TypeMismatchError=v;var y=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"SecurityError","The operation is insecure. "+t)||this}return i(t,e),t}(o);t.SecurityError=y;var b=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"NetworkError","A network error occurred. "+t)||this}return i(t,e),t}(o);t.NetworkError=b;var x=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"AbortError","The operation was aborted. "+t)||this}return i(t,e),t}(o);t.AbortError=x;var A=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"URLMismatchError","The given URL does not match another URL. "+t)||this}return i(t,e),t}(o);t.URLMismatchError=A;var C=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"QuotaExceededError","The quota has been exceeded. "+t)||this}return i(t,e),t}(o);t.QuotaExceededError=C;var T=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"TimeoutError","The operation timed out. "+t)||this}return i(t,e),t}(o);t.TimeoutError=T;var S=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"InvalidNodeTypeError","The supplied node is incorrect or has an incorrect ancestor for this operation. "+t)||this}return i(t,e),t}(o);t.InvalidNodeTypeError=S;var w=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"DataCloneError","The object can not be cloned. "+t)||this}return i(t,e),t}(o);t.DataCloneError=w;var _=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"NotImplementedError","The DOM method is not implemented by this module. "+t)||this}return i(t,e),t}(o);t.NotImplementedError=_;var I=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"HierarchyRequestError","The operation would yield an incorrect node tree. "+t)||this}return i(t,e),t}(o);t.HierarchyRequestError=I;var E=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"NotFoundError","The object can not be found here. "+t)||this}return i(t,e),t}(o);t.NotFoundError=E;var D=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"IndexSizeError","The index is not in the allowed range. "+t)||this}return i(t,e),t}(o);t.IndexSizeError=D;var O=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"SyntaxError","The string did not match the expected pattern. "+t)||this}return i(t,e),t}(o);t.SyntaxError=O;var P=function(e){function t(t){return void 0===t&&(t=""),e.call(this,"InvalidCharacterError","The string contains invalid characters. "+t)||this}return i(t,e),t}(o);t.InvalidCharacterError=P},function(e,t,n){"use strict";var r=n(53),i=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],o=["scalar","sequence","mapping"];e.exports=function(e,t){var n,a;if(t=t||{},Object.keys(t).forEach((function(t){if(-1===i.indexOf(t))throw new r('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.defaultStyle=t.defaultStyle||null,this.styleAliases=(n=t.styleAliases||null,a={},null!==n&&Object.keys(n).forEach((function(e){n[e].forEach((function(t){a[String(t)]=e}))})),a),-1===o.indexOf(this.kind))throw new r('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}},function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")()}).call(this,n(78))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idl_defineConst=function(e,t,n){Object.defineProperty(e,t,{writable:!1,enumerable:!0,configurable:!1,value:n})}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(16),i=n(115),o=n(18),a=n(56),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(8);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),o=n(2);function a(e,t,n){if(void 0===n&&(n=!1),n&&i.Guard.isElementNode(t)&&i.Guard.isShadowRoot(t.shadowRoot)&&t.shadowRoot._firstChild)return t.shadowRoot._firstChild;if(t._firstChild)return t._firstChild;if(t===e)return null;if(t._nextSibling)return t._nextSibling;for(var r=t._parent;r&&r!==e;){if(r._nextSibling)return r._nextSibling;r=r._parent}return null}function s(){var e;return(e={})[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:null}}}},e}function l(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);for(var i=t?e:a(e,e,n);i&&r&&!r(i);)i=a(e,i,n);return i}function c(e,t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1);for(var o=a(e,t,r);o&&i&&!i(o);)o=a(e,o,r);return o}function u(e,t,n,r){var i;return void 0===t&&(t=!1),void 0===n&&(n=!1),t||0!==e._children.size?((i={})[Symbol.iterator]=function(){var i=t?e:a(e,e,n);return{next:function(){for(;i&&r&&!r(i);)i=a(e,i,n);if(null===i)return{done:!0,value:null};var t={done:!1,value:i};return i=a(e,i,n),t}}},i):s()}function d(e,t,n){void 0===t&&(t=!1);for(var r=t?e:e._parent;r&&n&&!n(r);)r=r._parent;return r}function p(e,t,n,r){void 0===n&&(n=!1);for(var i=t._parent;i&&r&&!r(i);)i=i._parent;return i}function f(e){return i.Guard.isDocumentTypeNode(e)?0:i.Guard.isCharacterDataNode(e)?e._data.length:e._children.size}function h(e,t){if(void 0===t&&(t=!1),t){var n=h(e,!1);return i.Guard.isShadowRoot(n)?h(n._host,!0):n}return e._parent?h(e._parent):e}function m(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1);for(var o=n?e:r&&i.Guard.isShadowRoot(e)?e._host:e._parent;null!==o;){if(o===t)return!0;o=r&&i.Guard.isShadowRoot(o)?o._host:o._parent}return!1}function g(e){for(var t=h(e),n=0,r=l(t);null!==r;){if(n++,r===e)return n;r=c(t,r)}return-1}t.tree_getFirstDescendantNode=l,t.tree_getNextDescendantNode=c,t.tree_getDescendantNodes=u,t.tree_getDescendantElements=function(e,t,n,r){var o;return void 0===t&&(t=!1),void 0===n&&(n=!1),t||0!==e._children.size?((o={})[Symbol.iterator]=function(){var o=u(e,t,n,(function(e){return i.Guard.isElementNode(e)}))[Symbol.iterator](),a=o.next().value;return{next:function(){for(;a&&r&&!r(a);)a=o.next().value;if(null===a)return{done:!0,value:null};var e={done:!1,value:a};return a=o.next().value,e}}},o):s()},t.tree_getSiblingNodes=function(e,t,n){var r;return void 0===t&&(t=!1),e._parent&&0!==e._parent._children.size?((r={})[Symbol.iterator]=function(){var r=e._parent?e._parent._firstChild:null;return{next:function(){for(;r&&(n&&!n(r)||!t&&r===e);)r=r._nextSibling;if(null===r)return{done:!0,value:null};var i={done:!1,value:r};return r=r._nextSibling,i}}},r):s()},t.tree_getFirstAncestorNode=d,t.tree_getNextAncestorNode=p,t.tree_getAncestorNodes=function(e,t,n){var r;return void 0===t&&(t=!1),t||e._parent?((r={})[Symbol.iterator]=function(){var r=d(e,t,n);return{next:function(){if(null===r)return{done:!0,value:null};var e={done:!1,value:r};return r=p(0,r,t,n),e}}},r):s()},t.tree_getCommonAncestor=function(e,t){if(e===t)return e._parent;for(var n=[],r=[],i=d(e,!0);null!==i;)n.push(i),i=p(0,i,!0);for(var o=d(t,!0);null!==o;)r.push(o),o=p(0,o,!0);for(var a=n.length,s=r.length,l=null,c=Math.min(a,s);c>0;c--){var u=n[--a];if(u!==r[--s])break;l=u}return l},t.tree_getFollowingNode=function(e,t){if(t._firstChild)return t._firstChild;if(t._nextSibling)return t._nextSibling;for(;;){var n=t._parent;if(null===n||n===e)return null;if(n._nextSibling)return n._nextSibling;t=n}},t.tree_getPrecedingNode=function(e,t){return t===e?null:t._previousSibling?(t=t._previousSibling)._lastChild?t._lastChild:t:t._parent},t.tree_isConstrained=function e(t){var n,i,a,s,l,c;switch(t._nodeType){case o.NodeType.Document:var u=!1,d=!1;try{for(var p=r(t._children),f=p.next();!f.done;f=p.next())switch(f.value._nodeType){case o.NodeType.ProcessingInstruction:case o.NodeType.Comment:break;case o.NodeType.DocumentType:if(u||d)return!1;u=!0;break;case o.NodeType.Element:if(d)return!1;d=!0;break;default:return!1}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}break;case o.NodeType.DocumentFragment:case o.NodeType.Element:try{for(var h=r(t._children),m=h.next();!m.done;m=h.next())switch(m.value._nodeType){case o.NodeType.Element:case o.NodeType.Text:case o.NodeType.ProcessingInstruction:case o.NodeType.CData:case o.NodeType.Comment:break;default:return!1}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}break;case o.NodeType.DocumentType:case o.NodeType.Text:case o.NodeType.ProcessingInstruction:case o.NodeType.CData:case o.NodeType.Comment:return!t.hasChildNodes()}try{for(var g=r(t._children),v=g.next();!v.done;v=g.next())if(!e(v.value))return!1}catch(e){l={error:e}}finally{try{v&&!v.done&&(c=g.return)&&c.call(g)}finally{if(l)throw l.error}}return!0},t.tree_nodeLength=f,t.tree_isEmpty=function(e){return 0===f(e)},t.tree_rootNode=h,t.tree_isDescendantOf=function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1);for(var i=l(e,n,r);null!==i;){if(i===t)return!0;i=c(e,i,n,r)}return!1},t.tree_isAncestorOf=m,t.tree_isHostIncludingAncestorOf=function e(t,n,r){if(void 0===r&&(r=!1),m(t,n,r))return!0;var o=h(t);return!(!i.Guard.isDocumentFragmentNode(o)||null===o._host||!e(o._host,n,r))},t.tree_isSiblingOf=function(e,t,n){return void 0===n&&(n=!1),e!==t?null!==e._parent&&e._parent===t._parent:!!n},t.tree_isPreceding=function(e,t){var n=g(e),r=g(t);return-1!==n&&-1!==r&&h(e)===h(t)&&r<n},t.tree_isFollowing=function(e,t){var n=g(e),r=g(t);return-1!==n&&-1!==r&&h(e)===h(t)&&r>n},t.tree_isParentOf=function(e,t){return e._parent===t},t.tree_isChildOf=function(e,t){return t._parent===e},t.tree_previousSibling=function(e){return e._previousSibling},t.tree_nextSibling=function(e){return e._nextSibling},t.tree_firstChild=function(e){return e._firstChild},t.tree_lastChild=function(e){return e._lastChild},t.tree_treePosition=g,t.tree_index=function(e){for(var t=0;null!==e._previousSibling;)t++,e=e._previousSibling;return t},t.tree_retarget=function(e,t){for(;;){if(!e||!i.Guard.isNode(e))return e;var n=h(e);if(!i.Guard.isShadowRoot(n))return e;if(t&&i.Guard.isNode(t)&&m(n,t,!0,!0))return e;e=n.host}}},function(e,t,n){var r=n(13);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){"use strict";var r=n(24),i=n(130),o=n(49),a=n(43),s=n(88),l=a.set,c=a.getterFor("Array Iterator");e.exports=s(Array,"Array",(function(e,t){l(this,{type:"Array Iterator",target:r(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,n){var r=n(90),i=n(25),o=n(202);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(e,t,n){var r=n(16),i=n(15),o=n(40);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";var r=n(137).charAt,i=n(43),o=n(88),a=i.set,s=i.getterFor("String Iterator");o(String,"String",(function(e){a(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=s(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t,n){var r=n(11),i=n(203),o=n(19),a=n(21),s=n(5),l=s("iterator"),c=s("toStringTag"),u=o.values;for(var d in i){var p=r[d],f=p&&p.prototype;if(f){if(f[l]!==u)try{a(f,l,u)}catch(e){f[l]=u}if(f[c]||a(f,c,d),i[d])for(var h in o)if(f[h]!==o[h])try{a(f,h,o[h])}catch(e){f[h]=o[h]}}}},function(e,t,n){var r=n(41),i=n(35);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(11),i=n(21),o=n(14),a=n(80),s=n(117),l=n(43),c=l.get,u=l.enforce,d=String(String).split("String");(e.exports=function(e,t,n,s){var l=!!s&&!!s.unsafe,c=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||o(n,"name")||i(n,"name",t),u(n).source=d.join("string"==typeof t?t:"")),e!==r?(l?!p&&e[t]&&(c=!0):delete e[t],c?e[t]=n:i(e,t,n)):c?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},function(e,t,n){var r=n(47),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(35);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(16),i=n(8),o=n(14),a=Object.defineProperty,s={},l=function(e){throw e};e.exports=function(e,t){if(o(s,e))return s[e];t||(t={});var n=[][e],c=!!o(t,"ACCESSORS")&&t.ACCESSORS,u=o(t,0)?t[0]:l,d=o(t,1)?t[1]:void 0;return s[e]=!!n&&!i((function(){if(c&&!r)return!0;var e={length:-1};c?a(e,1,{enumerable:!0,get:l}):e[1]=1,n.call(e,u,d)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(148),i=n(149),o=n(151),a=n(98),s=n(153),l=n(154),c=n(155),u=n(99),d=n(100),p=n(156),f=n(157),h=n(101),m=n(158),g=n(159),v=n(160),y=n(161),b=n(162),x=n(163),A=n(164),C=n(165),T=n(166),S=n(167),w=n(168),_=n(169),I=n(170);t.create_domImplementation=function(e){return r.DOMImplementationImpl._create(e)},t.create_window=function(){return i.WindowImpl._create()},t.create_xmlDocument=function(){return new o.XMLDocumentImpl},t.create_document=function(){return new a.DocumentImpl},t.create_abortController=function(){return new s.AbortControllerImpl},t.create_abortSignal=function(){return l.AbortSignalImpl._create()},t.create_documentType=function(e,t,n,r){return c.DocumentTypeImpl._create(e,t,n,r)},t.create_element=function(e,t,n,r){return u.ElementImpl._create(e,t,n,r)},t.create_htmlElement=function(e,t,n,r){return u.ElementImpl._create(e,t,n,r)},t.create_htmlUnknownElement=function(e,t,n,r){return u.ElementImpl._create(e,t,n,r)},t.create_documentFragment=function(e){return d.DocumentFragmentImpl._create(e)},t.create_shadowRoot=function(e,t){return p.ShadowRootImpl._create(e,t)},t.create_attr=function(e,t){return f.AttrImpl._create(e,t)},t.create_text=function(e,t){return h.TextImpl._create(e,t)},t.create_cdataSection=function(e,t){return m.CDATASectionImpl._create(e,t)},t.create_comment=function(e,t){return g.CommentImpl._create(e,t)},t.create_processingInstruction=function(e,t,n){return v.ProcessingInstructionImpl._create(e,t,n)},t.create_htmlCollection=function(e,t){return void 0===t&&(t=function(){return!0}),y.HTMLCollectionImpl._create(e,t)},t.create_nodeList=function(e){return b.NodeListImpl._create(e)},t.create_nodeListStatic=function(e,t){return x.NodeListStaticImpl._create(e,t)},t.create_namedNodeMap=function(e){return A.NamedNodeMapImpl._create(e)},t.create_range=function(e,t){return C.RangeImpl._create(e,t)},t.create_nodeIterator=function(e,t,n){return T.NodeIteratorImpl._create(e,t,n)},t.create_treeWalker=function(e,t){return S.TreeWalkerImpl._create(e,t)},t.create_nodeFilter=function(){return w.NodeFilterImpl._create()},t.create_mutationRecord=function(e,t,n,r,i,o,a,s,l){return _.MutationRecordImpl._create(e,t,n,r,i,o,a,s,l)},t.create_domTokenList=function(e,t){return I.DOMTokenListImpl._create(e,t)}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(17),a=n(3),s=n(72),l=new Map;function c(e,t){if(t!==e._root&&o.tree_isAncestorOf(e._reference,t,!0)){if(e._pointerBeforeReference)for(;;){var n=o.tree_getFollowingNode(e._root,t);if(null!==n&&o.tree_isDescendantOf(e._root,n,!0)&&!o.tree_isDescendantOf(t,n,!0))return void(e._reference=n);if(null===n)return void(e._pointerBeforeReference=!1)}if(null===t._previousSibling)null!==t._parent&&(e._reference=t._parent);else{for(var r=t._previousSibling,i=o.tree_getFirstDescendantNode(t._previousSibling,!0,!1);null!==i;)null!==i&&(r=i),i=o.tree_getNextDescendantNode(t._previousSibling,i,!0,!1);e._reference=r}}}function u(e,t,n,r,i){if(a.Guard.isSlot(e)&&"name"===t&&null===i){if(r===n)return;if(null===r&&""===n)return;if(""===r&&null===n)return;e._name=null===r||""===r?"":r,s.shadowTree_assignSlotablesForATree(o.tree_rootNode(e))}}function d(e,t,n,r,i){if(a.Guard.isSlotable(e)&&"slot"===t&&null===i){if(r===n)return;if(null===r&&""===n)return;if(""===r&&null===n)return;e._name=null===r||""===r?"":r,s.shadowTree_isAssigned(e)&&s.shadowTree_assignSlotables(e._assignedSlot),s.shadowTree_assignASlot(e)}}function p(e,t,n,r){"id"===t&&null===r&&(e._uniqueIdentifier=n||void 0)}t.dom_runRemovingSteps=function(e,t){},t.dom_runCloningSteps=function(e,t,n,r){},t.dom_runAdoptingSteps=function(e,t){},t.dom_runAttributeChangeSteps=function(e,t,n,o,a){var s,l;i.dom.features.slots&&(d.call(e,e,t,n,o,a),u.call(e,e,t,n,o,a)),p.call(e,e,t,o,a);try{for(var c=r(e._attributeChangeSteps),f=c.next();!f.done;f=c.next())f.value.call(e,e,t,n,o,a)}catch(e){s={error:e}}finally{try{f&&!f.done&&(l=c.return)&&l.call(c)}finally{if(s)throw s.error}}},t.dom_runInsertionSteps=function(e){},t.dom_runNodeIteratorPreRemovingSteps=function(e,t){c.call(e,e,t)},t.dom_hasSupportedTokens=function(e){return l.has(e)},t.dom_getSupportedTokens=function(e){return l.get(e)||new Set},t.dom_runEventConstructingSteps=function(e){},t.dom_runChildTextContentChangeSteps=function(e){}},function(e,t,n){"use strict";var r=n(4),i=n(11),o=n(46),a=n(44),s=n(16),l=n(86),c=n(124),u=n(8),d=n(14),p=n(59),f=n(13),h=n(18),m=n(27),g=n(24),v=n(56),y=n(40),b=n(60),x=n(61),A=n(82),C=n(190),T=n(85),S=n(55),w=n(15),_=n(79),I=n(21),E=n(25),D=n(81),O=n(57),P=n(45),R=n(58),N=n(5),M=n(125),L=n(126),F=n(62),B=n(43),V=n(36).forEach,k=O("hidden"),U=N("toPrimitive"),G=B.set,z=B.getterFor("Symbol"),W=Object.prototype,j=i.Symbol,H=o("JSON","stringify"),K=S.f,q=w.f,$=C.f,X=_.f,Y=D("symbols"),J=D("op-symbols"),Z=D("string-to-symbol-registry"),Q=D("symbol-to-string-registry"),ee=D("wks"),te=i.QObject,ne=!te||!te.prototype||!te.prototype.findChild,re=s&&u((function(){return 7!=b(q({},"a",{get:function(){return q(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=K(W,t);r&&delete W[t],q(e,t,n),r&&e!==W&&q(W,t,r)}:q,ie=function(e,t){var n=Y[e]=b(j.prototype);return G(n,{type:"Symbol",tag:e,description:t}),s||(n.description=t),n},oe=c?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof j},ae=function(e,t,n){e===W&&ae(J,t,n),h(e);var r=v(t,!0);return h(n),d(Y,r)?(n.enumerable?(d(e,k)&&e[k][r]&&(e[k][r]=!1),n=b(n,{enumerable:y(0,!1)})):(d(e,k)||q(e,k,y(1,{})),e[k][r]=!0),re(e,r,n)):q(e,r,n)},se=function(e,t){h(e);var n=g(t),r=x(n).concat(de(n));return V(r,(function(t){s&&!le.call(n,t)||ae(e,t,n[t])})),e},le=function(e){var t=v(e,!0),n=X.call(this,t);return!(this===W&&d(Y,t)&&!d(J,t))&&(!(n||!d(this,t)||!d(Y,t)||d(this,k)&&this[k][t])||n)},ce=function(e,t){var n=g(e),r=v(t,!0);if(n!==W||!d(Y,r)||d(J,r)){var i=K(n,r);return!i||!d(Y,r)||d(n,k)&&n[k][r]||(i.enumerable=!0),i}},ue=function(e){var t=$(g(e)),n=[];return V(t,(function(e){d(Y,e)||d(P,e)||n.push(e)})),n},de=function(e){var t=e===W,n=$(t?J:g(e)),r=[];return V(n,(function(e){!d(Y,e)||t&&!d(W,e)||r.push(Y[e])})),r};l||(E((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=R(e),n=function(e){this===W&&n.call(J,e),d(this,k)&&d(this[k],t)&&(this[k][t]=!1),re(this,t,y(1,e))};return s&&ne&&re(W,t,{configurable:!0,set:n}),ie(t,e)}).prototype,"toString",(function(){return z(this).tag})),E(j,"withoutSetter",(function(e){return ie(R(e),e)})),_.f=le,w.f=ae,S.f=ce,A.f=C.f=ue,T.f=de,M.f=function(e){return ie(N(e),e)},s&&(q(j.prototype,"description",{configurable:!0,get:function(){return z(this).description}}),a||E(W,"propertyIsEnumerable",le,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:j}),V(x(ee),(function(e){L(e)})),r({target:"Symbol",stat:!0,forced:!l},{for:function(e){var t=String(e);if(d(Z,t))return Z[t];var n=j(t);return Z[t]=n,Q[n]=t,n},keyFor:function(e){if(!oe(e))throw TypeError(e+" is not a symbol");if(d(Q,e))return Q[e]},useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!s},{create:function(e,t){return void 0===t?b(e):se(b(e),t)},defineProperty:ae,defineProperties:se,getOwnPropertyDescriptor:ce}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:ue,getOwnPropertySymbols:de}),r({target:"Object",stat:!0,forced:u((function(){T.f(1)}))},{getOwnPropertySymbols:function(e){return T.f(m(e))}}),H&&r({target:"JSON",stat:!0,forced:!l||u((function(){var e=j();return"[null]"!=H([e])||"{}"!=H({a:e})||"{}"!=H(Object(e))}))},{stringify:function(e,t,n){for(var r,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);if(r=t,(f(t)||void 0!==e)&&!oe(e))return p(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!oe(t))return t}),i[1]=t,H.apply(null,i)}}),j.prototype[U]||I(j.prototype,U,j.prototype.valueOf),F(j,"Symbol"),P[k]=!0},function(e,t,n){"use strict";var r=n(4),i=n(16),o=n(11),a=n(14),s=n(13),l=n(15).f,c=n(119),u=o.Symbol;if(i&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var d={},p=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof p?new u(e):void 0===e?u():u(e);return""===e&&(d[t]=!0),t};c(p,u);var f=p.prototype=u.prototype;f.constructor=p;var h=f.toString,m="Symbol(test)"==String(u("test")),g=/^Symbol\((.*)\)[^)]+$/;l(f,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=h.call(e);if(a(d,e))return"";var n=m?t.slice(7,-1):t.replace(g,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:p})}},function(e,t,n){n(126)("iterator")},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),s=n(2),l=n(70),c=n(3),u=n(9),d=n(0),p=n(152),f=n(12),h=function(e){function t(){var t=e.call(this)||this;return t._parent=null,t._firstChild=null,t._lastChild=null,t._previousSibling=null,t._nextSibling=null,t}return i(t,e),Object.defineProperty(t.prototype,"_childNodes",{get:function(){return this.__childNodes||(this.__childNodes=d.create_nodeList(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_nodeDocument",{get:function(){return this._nodeDocumentOverride||a.dom.window._associatedDocument},set:function(e){this._nodeDocumentOverride=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_registeredObserverList",{get:function(){return this.__registeredObserverList||(this.__registeredObserverList=[])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this._nodeType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodeName",{get:function(){return c.Guard.isElementNode(this)?this._htmlUppercasedQualifiedName:c.Guard.isAttrNode(this)?this._qualifiedName:c.Guard.isExclusiveTextNode(this)?"#text":c.Guard.isCDATASectionNode(this)?"#cdata-section":c.Guard.isProcessingInstructionNode(this)?this._target:c.Guard.isCommentNode(this)?"#comment":c.Guard.isDocumentNode(this)?"#document":c.Guard.isDocumentTypeNode(this)?this._name:c.Guard.isDocumentFragmentNode(this)?"#document-fragment":""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baseURI",{get:function(){return p.urlSerializer(this._nodeDocument._URL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isConnected",{get:function(){return c.Guard.isElementNode(this)&&d.shadowTree_isConnected(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this._nodeType===s.NodeType.Document?null:this._nodeDocument},enumerable:!0,configurable:!0}),t.prototype.getRootNode=function(e){return d.tree_rootNode(this,!!e&&e.composed)},Object.defineProperty(t.prototype,"parentNode",{get:function(){return this._nodeType===s.NodeType.Attribute?null:this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){return this._parent&&c.Guard.isElementNode(this._parent)?this._parent:null},enumerable:!0,configurable:!0}),t.prototype.hasChildNodes=function(){return null!==this._firstChild},Object.defineProperty(t.prototype,"childNodes",{get:function(){return this._childNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this._firstChild},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this._lastChild},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){return this._previousSibling},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){return this._nextSibling},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return c.Guard.isAttrNode(this)?this._value:c.Guard.isCharacterDataNode(this)?this._data:null},set:function(e){null===e&&(e=""),c.Guard.isAttrNode(this)?d.attr_setAnExistingAttributeValue(this,e):c.Guard.isCharacterDataNode(this)&&d.characterData_replaceData(this,0,this._data.length,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textContent",{get:function(){return c.Guard.isDocumentFragmentNode(this)||c.Guard.isElementNode(this)?d.text_descendantTextContent(this):c.Guard.isAttrNode(this)?this._value:c.Guard.isCharacterDataNode(this)?this._data:null},set:function(e){null===e&&(e=""),c.Guard.isDocumentFragmentNode(this)||c.Guard.isElementNode(this)?d.node_stringReplaceAll(e,this):c.Guard.isAttrNode(this)?d.attr_setAnExistingAttributeValue(this,e):c.Guard.isCharacterDataNode(this)&&d.characterData_replaceData(this,0,d.tree_nodeLength(this),e)},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){for(var e,t,n,r,i=[],s=d.tree_getFirstDescendantNode(this,!1,!1,(function(e){return c.Guard.isExclusiveTextNode(e)}));null!==s;)i.push(s),s=d.tree_getNextDescendantNode(this,s,!1,!1,(function(e){return c.Guard.isExclusiveTextNode(e)}));for(var l=0;l<i.length;l++){var u=i[l];if(null!==u._parent){var p=d.tree_nodeLength(u);if(0!==p){var f=[],h="";try{for(var m=(e=void 0,o(d.text_contiguousExclusiveTextNodes(u))),g=m.next();!g.done;g=m.next()){var v=g.value;f.push(v),h+=v._data}}catch(t){e={error:t}}finally{try{g&&!g.done&&(t=m.return)&&t.call(m)}finally{if(e)throw e.error}}if(d.characterData_replaceData(u,p,0,h),0!==a.dom.rangeList.size)for(var y=u._nextSibling;null!==y&&c.Guard.isExclusiveTextNode(y);){var b=y,x=d.tree_index(b);try{for(var A=(n=void 0,o(a.dom.rangeList)),C=A.next();!C.done;C=A.next()){var T=C.value;T._start[0]===b&&(T._start[0]=u,T._start[1]+=p),T._end[0]===b&&(T._end[0]=u,T._end[1]+=p),T._start[0]===b._parent&&T._start[1]===x&&(T._start[0]=u,T._start[1]=p),T._end[0]===b._parent&&T._end[1]===x&&(T._end[0]=u,T._end[1]=p)}}catch(e){n={error:e}}finally{try{C&&!C.done&&(r=A.return)&&r.call(A)}finally{if(n)throw n.error}}p+=d.tree_nodeLength(y),y=y._nextSibling}for(var S=0;S<f.length;S++)null!==(v=f[S])._parent&&d.mutation_remove(v,v._parent)}else d.mutation_remove(u,u._parent)}}},t.prototype.cloneNode=function(e){if(void 0===e&&(e=!1),c.Guard.isShadowRoot(this))throw new u.NotSupportedError;return d.node_clone(this,null,e)},t.prototype.isEqualNode=function(e){return void 0===e&&(e=null),null!==e&&d.node_equals(this,e)},t.prototype.isSameNode=function(e){return void 0===e&&(e=null),this===e},t.prototype.compareDocumentPosition=function(e){if(e===this)return 0;var t=e,n=this,r=null,i=null;if(c.Guard.isAttrNode(t)&&(t=(r=t)._element),c.Guard.isAttrNode(n)&&(n=(i=n)._element,r&&t&&t===n))for(var o=0;o<n._attributeList.length;o++){var l=n._attributeList[o];if(d.node_equals(l,r))return s.Position.ImplementationSpecific|s.Position.Preceding;if(d.node_equals(l,i))return s.Position.ImplementationSpecific|s.Position.Following}return null===t||null===n||d.tree_rootNode(t)!==d.tree_rootNode(n)?s.Position.Disconnected|s.Position.ImplementationSpecific|(a.dom.compareCache.check(this,e)?s.Position.Preceding:s.Position.Following):!r&&d.tree_isAncestorOf(n,t)||i&&t===n?s.Position.Contains|s.Position.Preceding:!i&&d.tree_isDescendantOf(n,t)||r&&t===n?s.Position.ContainedBy|s.Position.Following:d.tree_isPreceding(n,t)?s.Position.Preceding:s.Position.Following},t.prototype.contains=function(e){return null!==e&&d.tree_isDescendantOf(this,e,!0)},t.prototype.lookupPrefix=function(e){return e?c.Guard.isElementNode(this)?d.node_locateANamespacePrefix(this,e):c.Guard.isDocumentNode(this)?null===this.documentElement?null:d.node_locateANamespacePrefix(this.documentElement,e):c.Guard.isDocumentTypeNode(this)||c.Guard.isDocumentFragmentNode(this)?null:c.Guard.isAttrNode(this)?null===this._element?null:d.node_locateANamespacePrefix(this._element,e):null!==this._parent&&c.Guard.isElementNode(this._parent)?d.node_locateANamespacePrefix(this._parent,e):null:null},t.prototype.lookupNamespaceURI=function(e){return d.node_locateANamespace(this,e||null)},t.prototype.isDefaultNamespace=function(e){return e||(e=null),d.node_locateANamespace(this,null)===e},t.prototype.insertBefore=function(e,t){return d.mutation_preInsert(e,this,t)},t.prototype.appendChild=function(e){return d.mutation_append(e,this)},t.prototype.replaceChild=function(e,t){return d.mutation_replace(t,e,this)},t.prototype.removeChild=function(e){return d.mutation_preRemove(e,this)},t.prototype._getTheParent=function(e){return c.Guard.isSlotable(this)&&d.shadowTree_isAssigned(this)?this._assignedSlot:this._parent},t.ELEMENT_NODE=1,t.ATTRIBUTE_NODE=2,t.TEXT_NODE=3,t.CDATA_SECTION_NODE=4,t.ENTITY_REFERENCE_NODE=5,t.ENTITY_NODE=6,t.PROCESSING_INSTRUCTION_NODE=7,t.COMMENT_NODE=8,t.DOCUMENT_NODE=9,t.DOCUMENT_TYPE_NODE=10,t.DOCUMENT_FRAGMENT_NODE=11,t.NOTATION_NODE=12,t.DOCUMENT_POSITION_DISCONNECTED=1,t.DOCUMENT_POSITION_PRECEDING=2,t.DOCUMENT_POSITION_FOLLOWING=4,t.DOCUMENT_POSITION_CONTAINS=8,t.DOCUMENT_POSITION_CONTAINED_BY=16,t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,t}(l.EventTargetImpl);t.NodeImpl=h,h.prototype._children=new c.EmptySet,f.idl_defineConst(h.prototype,"ELEMENT_NODE",1),f.idl_defineConst(h.prototype,"ATTRIBUTE_NODE",2),f.idl_defineConst(h.prototype,"TEXT_NODE",3),f.idl_defineConst(h.prototype,"CDATA_SECTION_NODE",4),f.idl_defineConst(h.prototype,"ENTITY_REFERENCE_NODE",5),f.idl_defineConst(h.prototype,"ENTITY_NODE",6),f.idl_defineConst(h.prototype,"PROCESSING_INSTRUCTION_NODE",7),f.idl_defineConst(h.prototype,"COMMENT_NODE",8),f.idl_defineConst(h.prototype,"DOCUMENT_NODE",9),f.idl_defineConst(h.prototype,"DOCUMENT_TYPE_NODE",10),f.idl_defineConst(h.prototype,"DOCUMENT_FRAGMENT_NODE",11),f.idl_defineConst(h.prototype,"NOTATION_NODE",12),f.idl_defineConst(h.prototype,"DOCUMENT_POSITION_DISCONNECTED",1),f.idl_defineConst(h.prototype,"DOCUMENT_POSITION_PRECEDING",2),f.idl_defineConst(h.prototype,"DOCUMENT_POSITION_FOLLOWING",4),f.idl_defineConst(h.prototype,"DOCUMENT_POSITION_CONTAINS",8),f.idl_defineConst(h.prototype,"DOCUMENT_POSITION_CONTAINED_BY",16),f.idl_defineConst(h.prototype,"DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC",32)},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){var r=n(87),i=n(41),o=n(27),a=n(26),s=n(128),l=[].push,c=function(e){var t=1==e,n=2==e,c=3==e,u=4==e,d=6==e,p=5==e||d;return function(f,h,m,g){for(var v,y,b=o(f),x=i(b),A=r(h,m,3),C=a(x.length),T=0,S=g||s,w=t?S(f,C):n?S(f,0):void 0;C>T;T++)if((p||T in x)&&(y=A(v=x[T],T,b),e))if(t)w[T]=y;else if(y)switch(e){case 3:return!0;case 5:return v;case 6:return T;case 2:l.call(w,v)}else if(u)return!1;return d?-1:c||u?u:w}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),s=n(9),l=n(2),c=n(3),u=n(1),d=n(7),p=n(73),f=n(17),h=n(172),m=n(72),g=n(51),v=n(30),y=n(106);function b(e,t,n){var i,o,a,c,u,d,p,h,m=t._nodeType,g=e._nodeType,v=n?n._nodeType:null;if(m!==l.NodeType.Document&&m!==l.NodeType.DocumentFragment&&m!==l.NodeType.Element)throw new s.HierarchyRequestError("Only document, document fragment and element nodes can contain child nodes. Parent node is "+t.nodeName+".");if(f.tree_isHostIncludingAncestorOf(t,e,!0))throw new s.HierarchyRequestError("The node to be inserted cannot be an inclusive ancestor of parent node. Node is "+e.nodeName+", parent node is "+t.nodeName+".");if(null!==n&&n._parent!==t)throw new s.NotFoundError("The reference child node cannot be found under parent node. Child node is "+n.nodeName+", parent node is "+t.nodeName+".");if(g!==l.NodeType.DocumentFragment&&g!==l.NodeType.DocumentType&&g!==l.NodeType.Element&&g!==l.NodeType.Text&&g!==l.NodeType.ProcessingInstruction&&g!==l.NodeType.CData&&g!==l.NodeType.Comment)throw new s.HierarchyRequestError("Only document fragment, document type, element, text, processing instruction, cdata section or comment nodes can be inserted. Node is "+e.nodeName+".");if(g===l.NodeType.Text&&m===l.NodeType.Document)throw new s.HierarchyRequestError("Cannot insert a text node as a child of a document node. Node is "+e.nodeName+".");if(g===l.NodeType.DocumentType&&m!==l.NodeType.Document)throw new s.HierarchyRequestError("A document type node can only be inserted under a document node. Parent node is "+t.nodeName+".");if(m===l.NodeType.Document)if(g===l.NodeType.DocumentFragment){var y=0;try{for(var b=r(e._children),x=b.next();!x.done;x=b.next()){var A=x.value;if(A._nodeType===l.NodeType.Element)y++;else if(A._nodeType===l.NodeType.Text)throw new s.HierarchyRequestError("Cannot insert text a node as a child of a document node. Node is "+A.nodeName+".")}}catch(e){i={error:e}}finally{try{x&&!x.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}if(y>1)throw new s.HierarchyRequestError("A document node can only have one document element node. Document fragment to be inserted has "+y+" element nodes.");if(1===y){try{for(var C=r(t._children),T=C.next();!T.done;T=C.next())if(T.value._nodeType===l.NodeType.Element)throw new s.HierarchyRequestError("The document node already has a document element node.")}catch(e){a={error:e}}finally{try{T&&!T.done&&(c=C.return)&&c.call(C)}finally{if(a)throw a.error}}if(n){if(v===l.NodeType.DocumentType)throw new s.HierarchyRequestError("Cannot insert an element node before a document type node.");for(var S=n._nextSibling;S;){if(S._nodeType===l.NodeType.DocumentType)throw new s.HierarchyRequestError("Cannot insert an element node before a document type node.");S=S._nextSibling}}}}else if(g===l.NodeType.Element){try{for(var w=r(t._children),_=w.next();!_.done;_=w.next())if(_.value._nodeType===l.NodeType.Element)throw new s.HierarchyRequestError("Document already has a document element node. Node is "+e.nodeName+".")}catch(e){u={error:e}}finally{try{_&&!_.done&&(d=w.return)&&d.call(w)}finally{if(u)throw u.error}}if(n){if(v===l.NodeType.DocumentType)throw new s.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+e.nodeName+".");for(S=n._nextSibling;S;){if(S._nodeType===l.NodeType.DocumentType)throw new s.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+e.nodeName+".");S=S._nextSibling}}}else if(g===l.NodeType.DocumentType){try{for(var I=r(t._children),E=I.next();!E.done;E=I.next())if(E.value._nodeType===l.NodeType.DocumentType)throw new s.HierarchyRequestError("Document already has a document type node. Node is "+e.nodeName+".")}catch(e){p={error:e}}finally{try{E&&!E.done&&(h=I.return)&&h.call(I)}finally{if(p)throw p.error}}if(n)for(var D=n._previousSibling;D;){if(D._nodeType===l.NodeType.Element)throw new s.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+e.nodeName+".");D=D._previousSibling}else for(D=t._firstChild;D;){if(D._nodeType===l.NodeType.Element)throw new s.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+e.nodeName+".");D=D._nextSibling}}}function x(e,t,n){b(e,t,n);var r=n;return r===e&&(r=e._nextSibling),y.document_adopt(e,t._nodeDocument),A(e,t,r),e}function A(e,t,n,i){var s,h;if(null!==n||e._nodeType===l.NodeType.DocumentFragment){var y=e._nodeType===l.NodeType.DocumentFragment?e._children.size:1;if(null!==n&&0!==a.dom.rangeList.size){var b=f.tree_index(n);try{for(var x=r(a.dom.rangeList),A=x.next();!A.done;A=x.next()){var T=A.value;T._start[0]===t&&T._start[1]>b&&(T._start[1]+=y),T._end[0]===t&&T._end[1]>b&&(T._end[1]+=y)}}catch(e){s={error:e}}finally{try{A&&!A.done&&(h=x.return)&&h.call(x)}finally{if(s)throw s.error}}}var S=e._nodeType===l.NodeType.DocumentFragment?new(Array.bind.apply(Array,o([void 0],e._children))):[e];if(e._nodeType===l.NodeType.DocumentFragment)for(;e._firstChild;)C(e._firstChild,e,!0);a.dom.features.mutationObservers&&e._nodeType===l.NodeType.DocumentFragment&&g.observer_queueTreeMutationRecord(e,[],S,null,null);for(var w=n?n._previousSibling:t._lastChild,_=null===n?-1:f.tree_index(n),I=0;I<S.length;I++){var E=S[I];if(c.Guard.isElementNode(E)&&(c.Guard.isDocumentNode(t)&&(t._documentElement=E),E._nodeDocument._hasNamespaces||null===E._namespace&&null===E._namespacePrefix||(E._nodeDocument._hasNamespaces=!0)),E._parent=t,null===n?d.set.append(t._children,E):(d.set.insert(t._children,E,_),_++),null===t._firstChild)E._previousSibling=null,E._nextSibling=null,t._firstChild=E,t._lastChild=E;else{var D=n?n._previousSibling:t._lastChild,O=n||null;E._previousSibling=D,E._nextSibling=O,D&&(D._nextSibling=E),O&&(O._previousSibling=E),D||(t._firstChild=E),O||(t._lastChild=E)}a.dom.features.slots&&null!==t._shadowRoot&&c.Guard.isSlotable(E)&&m.shadowTree_assignASlot(E),a.dom.features.steps&&c.Guard.isTextNode(E)&&v.dom_runChildTextContentChangeSteps(t),a.dom.features.slots&&c.Guard.isShadowRoot(f.tree_rootNode(t))&&c.Guard.isSlot(t)&&u.isEmpty(t._assignedNodes)&&m.shadowTree_signalASlotChange(t),a.dom.features.slots&&m.shadowTree_assignSlotablesForATree(f.tree_rootNode(E));for(var P=f.tree_getFirstDescendantNode(E,!0,!0);null!==P;)a.dom.features.steps&&v.dom_runInsertionSteps(P),a.dom.features.customElements&&c.Guard.isElementNode(P)&&m.shadowTree_isConnected(P)&&(c.Guard.isCustomElementNode(P)?p.customElement_enqueueACustomElementCallbackReaction(P,"connectedCallback",[]):p.customElement_tryToUpgrade(P)),P=f.tree_getNextDescendantNode(E,P,!0,!0)}a.dom.features.mutationObservers&&(i||g.observer_queueTreeMutationRecord(t,S,[],w,n))}else!function(e,t,n){var r=t._lastChild;if(c.Guard.isElementNode(e)&&(c.Guard.isDocumentNode(t)&&(t._documentElement=e),e._nodeDocument._hasNamespaces||null===e._namespace&&null===e._namespacePrefix||(e._nodeDocument._hasNamespaces=!0)),e._parent=t,t._children.add(e),null===t._firstChild)e._previousSibling=null,e._nextSibling=null,t._firstChild=e,t._lastChild=e;else{var i=t._lastChild;e._previousSibling=i,e._nextSibling=null,i&&(i._nextSibling=e),i||(t._firstChild=e),t._lastChild=e}a.dom.features.slots&&null!==t._shadowRoot&&c.Guard.isSlotable(e)&&m.shadowTree_assignASlot(e),a.dom.features.steps&&c.Guard.isTextNode(e)&&v.dom_runChildTextContentChangeSteps(t),a.dom.features.slots&&c.Guard.isShadowRoot(f.tree_rootNode(t))&&c.Guard.isSlot(t)&&u.isEmpty(t._assignedNodes)&&m.shadowTree_signalASlotChange(t),a.dom.features.slots&&m.shadowTree_assignSlotablesForATree(f.tree_rootNode(e)),a.dom.features.steps&&v.dom_runInsertionSteps(e),a.dom.features.customElements&&c.Guard.isElementNode(e)&&m.shadowTree_isConnected(e)&&(c.Guard.isCustomElementNode(e)?p.customElement_enqueueACustomElementCallbackReaction(e,"connectedCallback",[]):p.customElement_tryToUpgrade(e)),a.dom.features.mutationObservers&&(n||g.observer_queueTreeMutationRecord(t,[e],[],r,null))}(e,t,i)}function C(e,t,n){var i,o,s,l,d,y,b,x;if(0!==a.dom.rangeList.size){var A=f.tree_index(e);try{for(var C=r(a.dom.rangeList),T=C.next();!T.done;T=C.next()){var S=T.value;f.tree_isDescendantOf(e,S._start[0],!0)&&(S._start=[t,A]),f.tree_isDescendantOf(e,S._end[0],!0)&&(S._end=[t,A]),S._start[0]===t&&S._start[1]>A&&S._start[1]--,S._end[0]===t&&S._end[1]>A&&S._end[1]--}}catch(e){i={error:e}}finally{try{T&&!T.done&&(o=C.return)&&o.call(C)}finally{if(i)throw i.error}}try{for(var w=r(a.dom.rangeList),_=w.next();!_.done;_=w.next())(S=_.value)._start[0]===t&&S._start[1]>A&&(S._start[1]-=1),S._end[0]===t&&S._end[1]>A&&(S._end[1]-=1)}catch(e){s={error:e}}finally{try{_&&!_.done&&(l=w.return)&&l.call(w)}finally{if(s)throw s.error}}}if(a.dom.features.steps)try{for(var I=r(h.nodeIterator_iteratorList()),E=I.next();!E.done;E=I.next()){var D=E.value;D._root._nodeDocument===e._nodeDocument&&v.dom_runNodeIteratorPreRemovingSteps(D,e)}}catch(e){d={error:e}}finally{try{E&&!E.done&&(y=I.return)&&y.call(I)}finally{if(d)throw d.error}}var O=e._previousSibling,P=e._nextSibling;c.Guard.isDocumentNode(t)&&c.Guard.isElementNode(e)&&(t._documentElement=null),e._parent=null,t._children.delete(e);var R=e._previousSibling,N=e._nextSibling;e._previousSibling=null,e._nextSibling=null,R&&(R._nextSibling=N),N&&(N._previousSibling=R),R||(t._firstChild=N),N||(t._lastChild=R),a.dom.features.slots&&c.Guard.isSlotable(e)&&null!==e._assignedSlot&&m.shadowTree_isAssigned(e)&&m.shadowTree_assignSlotables(e._assignedSlot),a.dom.features.slots&&c.Guard.isShadowRoot(f.tree_rootNode(t))&&c.Guard.isSlot(t)&&u.isEmpty(t._assignedNodes)&&m.shadowTree_signalASlotChange(t),a.dom.features.slots&&null!==f.tree_getFirstDescendantNode(e,!0,!1,(function(e){return c.Guard.isSlot(e)}))&&(m.shadowTree_assignSlotablesForATree(f.tree_rootNode(t)),m.shadowTree_assignSlotablesForATree(e)),a.dom.features.steps&&v.dom_runRemovingSteps(e,t),a.dom.features.customElements&&c.Guard.isCustomElementNode(e)&&p.customElement_enqueueACustomElementCallbackReaction(e,"disconnectedCallback",[]);for(var M=f.tree_getFirstDescendantNode(e,!1,!0);null!==M;)a.dom.features.steps&&v.dom_runRemovingSteps(M,e),a.dom.features.customElements&&c.Guard.isCustomElementNode(M)&&p.customElement_enqueueACustomElementCallbackReaction(M,"disconnectedCallback",[]),M=f.tree_getNextDescendantNode(e,M,!1,!0);if(a.dom.features.mutationObservers)for(var L=f.tree_getFirstAncestorNode(t,!0);null!==L;){try{for(var F=(b=void 0,r(L._registeredObserverList)),B=F.next();!B.done;B=F.next()){var V=B.value;V.options.subtree&&e._registeredObserverList.push({observer:V.observer,options:V.options,source:V})}}catch(e){b={error:e}}finally{try{B&&!B.done&&(x=F.return)&&x.call(F)}finally{if(b)throw b.error}}L=f.tree_getNextAncestorNode(t,L,!0)}a.dom.features.mutationObservers&&(n||g.observer_queueTreeMutationRecord(t,[],[e],O,P)),a.dom.features.steps&&c.Guard.isTextNode(e)&&v.dom_runChildTextContentChangeSteps(t)}t.mutation_ensurePreInsertionValidity=b,t.mutation_preInsert=x,t.mutation_insert=A,t.mutation_append=function(e,t){return x(e,t,null)},t.mutation_replace=function(e,t,n){var i,o,c,u,d,p,h,m;if(n._nodeType!==l.NodeType.Document&&n._nodeType!==l.NodeType.DocumentFragment&&n._nodeType!==l.NodeType.Element)throw new s.HierarchyRequestError("Only document, document fragment and element nodes can contain child nodes. Parent node is "+n.nodeName+".");if(f.tree_isHostIncludingAncestorOf(n,t,!0))throw new s.HierarchyRequestError("The node to be inserted cannot be an ancestor of parent node. Node is "+t.nodeName+", parent node is "+n.nodeName+".");if(e._parent!==n)throw new s.NotFoundError("The reference child node cannot be found under parent node. Child node is "+e.nodeName+", parent node is "+n.nodeName+".");if(t._nodeType!==l.NodeType.DocumentFragment&&t._nodeType!==l.NodeType.DocumentType&&t._nodeType!==l.NodeType.Element&&t._nodeType!==l.NodeType.Text&&t._nodeType!==l.NodeType.ProcessingInstruction&&t._nodeType!==l.NodeType.CData&&t._nodeType!==l.NodeType.Comment)throw new s.HierarchyRequestError("Only document fragment, document type, element, text, processing instruction, cdata section or comment nodes can be inserted. Node is "+t.nodeName+".");if(t._nodeType===l.NodeType.Text&&n._nodeType===l.NodeType.Document)throw new s.HierarchyRequestError("Cannot insert a text node as a child of a document node. Node is "+t.nodeName+".");if(t._nodeType===l.NodeType.DocumentType&&n._nodeType!==l.NodeType.Document)throw new s.HierarchyRequestError("A document type node can only be inserted under a document node. Parent node is "+n.nodeName+".");if(n._nodeType===l.NodeType.Document)if(t._nodeType===l.NodeType.DocumentFragment){var v=0;try{for(var b=r(t._children),x=b.next();!x.done;x=b.next()){var T=x.value;if(T._nodeType===l.NodeType.Element)v++;else if(T._nodeType===l.NodeType.Text)throw new s.HierarchyRequestError("Cannot insert text a node as a child of a document node. Node is "+T.nodeName+".")}}catch(e){i={error:e}}finally{try{x&&!x.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}if(v>1)throw new s.HierarchyRequestError("A document node can only have one document element node. Document fragment to be inserted has "+v+" element nodes.");if(1===v){try{for(var S=r(n._children),w=S.next();!w.done;w=S.next())if((P=w.value)._nodeType===l.NodeType.Element&&P!==e)throw new s.HierarchyRequestError("The document node already has a document element node.")}catch(e){c={error:e}}finally{try{w&&!w.done&&(u=S.return)&&u.call(S)}finally{if(c)throw c.error}}for(var _=e._nextSibling;_;){if(_._nodeType===l.NodeType.DocumentType)throw new s.HierarchyRequestError("Cannot insert an element node before a document type node.");_=_._nextSibling}}}else if(t._nodeType===l.NodeType.Element){try{for(var I=r(n._children),E=I.next();!E.done;E=I.next())if((P=E.value)._nodeType===l.NodeType.Element&&P!==e)throw new s.HierarchyRequestError("Document already has a document element node. Node is "+t.nodeName+".")}catch(e){d={error:e}}finally{try{E&&!E.done&&(p=I.return)&&p.call(I)}finally{if(d)throw d.error}}for(_=e._nextSibling;_;){if(_._nodeType===l.NodeType.DocumentType)throw new s.HierarchyRequestError("Cannot insert an element node before a document type node. Node is "+t.nodeName+".");_=_._nextSibling}}else if(t._nodeType===l.NodeType.DocumentType){try{for(var D=r(n._children),O=D.next();!O.done;O=D.next()){var P;if((P=O.value)._nodeType===l.NodeType.DocumentType&&P!==e)throw new s.HierarchyRequestError("Document already has a document type node. Node is "+t.nodeName+".")}}catch(e){h={error:e}}finally{try{O&&!O.done&&(m=D.return)&&m.call(D)}finally{if(h)throw h.error}}for(var R=e._previousSibling;R;){if(R._nodeType===l.NodeType.Element)throw new s.HierarchyRequestError("Cannot insert a document type node before an element node. Node is "+t.nodeName+".");R=R._previousSibling}}var N=e._nextSibling;N===t&&(N=t._nextSibling);var M=e._previousSibling;y.document_adopt(t,n._nodeDocument);var L=[];null!==e._parent&&(L.push(e),C(e,e._parent,!0));var F=[];return t._nodeType===l.NodeType.DocumentFragment?F=Array.from(t._children):F.push(t),A(t,n,N,!0),a.dom.features.mutationObservers&&g.observer_queueTreeMutationRecord(n,F,L,M,N),e},t.mutation_replaceAll=function(e,t){var n,i;null!==e&&y.document_adopt(e,t._nodeDocument);var o=Array.from(t._children),s=[];e&&e._nodeType===l.NodeType.DocumentFragment?s=Array.from(e._children):null!==e&&s.push(e);try{for(var c=r(o),u=c.next();!u.done;u=c.next())C(u.value,t,!0)}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}null!==e&&A(e,t,null,!0),a.dom.features.mutationObservers&&g.observer_queueTreeMutationRecord(t,s,o,null,null)},t.mutation_preRemove=function(e,t){if(e._parent!==t)throw new s.NotFoundError("The child node cannot be found under parent node. Child node is "+e.nodeName+", parent node is "+t.nodeName+".");return C(e,t),e},t.mutation_remove=C},function(e,t,n){"use strict";function r(e){return null==e}e.exports.isNothing=r,e.exports.isObject=function(e){return"object"==typeof e&&null!==e},e.exports.toArray=function(e){return Array.isArray(e)?e:r(e)?[]:[e]},e.exports.repeat=function(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r},e.exports.isNegativeZero=function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},e.exports.extend=function(e,t){var n,r,i,o;if(t)for(n=0,r=(o=Object.keys(t)).length;n<r;n+=1)e[i=o[n]]=t[i];return e}},function(e,t,n){"use strict";var r=n(38),i=n(53),o=n(10);function a(e,t,n){var r=[];return e.include.forEach((function(e){n=a(e,t,n)})),e[t].forEach((function(e){n.forEach((function(t,n){t.tag===e.tag&&t.kind===e.kind&&r.push(n)})),n.push(e)})),n.filter((function(e,t){return-1===r.indexOf(t)}))}function s(e){this.include=e.include||[],this.implicit=e.implicit||[],this.explicit=e.explicit||[],this.implicit.forEach((function(e){if(e.loadKind&&"scalar"!==e.loadKind)throw new i("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")})),this.compiledImplicit=a(this,"implicit",[]),this.compiledExplicit=a(this,"explicit",[]),this.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{}};function r(e){n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}(this.compiledImplicit,this.compiledExplicit)}s.DEFAULT=null,s.create=function(){var e,t;switch(arguments.length){case 1:e=s.DEFAULT,t=arguments[0];break;case 2:e=arguments[0],t=arguments[1];break;default:throw new i("Wrong number of arguments for Schema.create function")}if(e=r.toArray(e),t=r.toArray(t),!e.every((function(e){return e instanceof s})))throw new i("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!t.every((function(e){return e instanceof o})))throw new i("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new s({include:e,explicit:t})},e.exports=s},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(8),i=n(42),o="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r,i,o,a=n(186),s=n(11),l=n(13),c=n(21),u=n(14),d=n(57),p=n(45),f=s.WeakMap;if(a){var h=new f,m=h.get,g=h.has,v=h.set;r=function(e,t){return v.call(h,e,t),t},i=function(e){return m.call(h,e)||{}},o=function(e){return g.call(h,e)}}else{var y=d("state");p[y]=!0,r=function(e,t){return c(e,y,t),t},i=function(e){return u(e,y)?e[y]:{}},o=function(e){return u(e,y)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t){e.exports=!1},function(e,t){e.exports={}},function(e,t,n){var r=n(120),i=n(11),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e])||o(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){"use strict";var r=n(8);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},function(e,t){e.exports={}},function(e,t,n){"use strict";n(31),n(32),n(33),n(220),n(64),n(19),n(65),n(20),n(68),n(66),n(92),n(144),n(22),n(94),n(23);var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),s=n(69),l=n(95),c=n(7),u=n(0),d=function(){function e(e){this.level=0,this._builderOptions=e}return e.prototype.declaration=function(e,t,n){},e.prototype.docType=function(e,t,n){},e.prototype.comment=function(e){},e.prototype.text=function(e){},e.prototype.instruction=function(e,t){},e.prototype.cdata=function(e){},e.prototype.openTagBegin=function(e){},e.prototype.openTagEnd=function(e,t,n){},e.prototype.closeTag=function(e){},e.prototype.attributes=function(e){var t,n;try{for(var i=r(e),o=i.next();!o.done;o=i.next()){var a=o.value;this.attribute(null===a[1]?a[2]:a[1]+":"+a[2],a[3])}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.attribute=function(e,t){},e.prototype.beginElement=function(e){},e.prototype.endElement=function(e){},e.prototype.serializeNode=function(e,t){var n=void 0!==e._nodeDocument&&e._nodeDocument._hasNamespaces;if(this.level=0,this.currentNode=e,n){var r=new l.NamespacePrefixMap;r.set("xml",c.namespace.XML),this._serializeNodeNS(e,null,r,{value:1},t)}else this._serializeNode(e,t)},e.prototype._serializeNodeNS=function(e,t,n,r,i){switch(this.currentNode=e,e.nodeType){case a.NodeType.Element:this._serializeElementNS(e,t,n,r,i);break;case a.NodeType.Document:this._serializeDocumentNS(e,t,n,r,i);break;case a.NodeType.Comment:this._serializeComment(e,i);break;case a.NodeType.Text:this._serializeText(e,i);break;case a.NodeType.DocumentFragment:this._serializeDocumentFragmentNS(e,t,n,r,i);break;case a.NodeType.DocumentType:this._serializeDocumentType(e,i);break;case a.NodeType.ProcessingInstruction:this._serializeProcessingInstruction(e,i);break;case a.NodeType.CData:this._serializeCData(e,i);break;default:throw new Error("Unknown node type: "+e.nodeType)}},e.prototype._serializeNode=function(e,t){switch(this.currentNode=e,e.nodeType){case a.NodeType.Element:this._serializeElement(e,t);break;case a.NodeType.Document:this._serializeDocument(e,t);break;case a.NodeType.Comment:this._serializeComment(e,t);break;case a.NodeType.Text:this._serializeText(e,t);break;case a.NodeType.DocumentFragment:this._serializeDocumentFragment(e,t);break;case a.NodeType.DocumentType:this._serializeDocumentType(e,t);break;case a.NodeType.ProcessingInstruction:this._serializeProcessingInstruction(e,t);break;case a.NodeType.CData:this._serializeCData(e,t);break;default:throw new Error("Unknown node type: "+e.nodeType)}},e.prototype._serializeElementNS=function(t,n,i,a,s){var l,d,p=[];if(s&&(-1!==t.localName.indexOf(":")||!u.xml_isName(t.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var f="",h=!1,m=!1,g=i.copy(),v={},y=this._recordNamespaceInformation(t,g,v),b=n,x=t.namespaceURI;if(b===x)null!==y&&(m=!0),f=x===c.namespace.XML?"xml:"+t.localName:t.localName,this.beginElement(f),this.openTagBegin(f);else{var A=t.prefix,C=null;if(null===A&&x===y||(C=g.get(A,x)),"xmlns"===A){if(s)throw new Error("An element cannot have the 'xmlns' prefix (well-formed required).");C=A}null!==C?(f=C+":"+t.localName,null!==y&&y!==c.namespace.XML&&(b=y||null),this.beginElement(f),this.openTagBegin(f)):null!==A?(A in v&&(A=this._generatePrefix(x,g,a)),g.set(A,x),f+=A+":"+t.localName,this.beginElement(f),this.openTagBegin(f),p.push([null,"xmlns",A,this._serializeAttributeValue(x,s)]),null!==y&&(b=y||null)):null===y||null!==y&&y!==x?(m=!0,f+=t.localName,b=x,this.beginElement(f),this.openTagBegin(f),p.push([null,null,"xmlns",this._serializeAttributeValue(x,s)])):(f+=t.localName,b=x,this.beginElement(f),this.openTagBegin(f))}p.push.apply(p,o(this._serializeAttributesNS(t,g,a,v,m,s))),this.attributes(p);var T=x===c.namespace.HTML;if(T&&0===t.childNodes.length&&e._VoidElementNames.has(t.localName)?(this.openTagEnd(f,!0,!0),this.endElement(f),h=!0):T||0!==t.childNodes.length?this.openTagEnd(f,!1,!1):(this.openTagEnd(f,!0,!1),this.endElement(f),h=!0),!h){if(T&&"template"===t.localName);else try{for(var S=r(t.childNodes),w=S.next();!w.done;w=S.next()){var _=w.value;this.level++,this._serializeNodeNS(_,b,g,a,s),this.level--}}catch(e){l={error:e}}finally{try{w&&!w.done&&(d=S.return)&&d.call(S)}finally{if(l)throw l.error}}this.closeTag(f),this.endElement(f)}},e.prototype._serializeElement=function(e,t){var n,i;if(t&&(-1!==e.localName.indexOf(":")||!u.xml_isName(e.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var o=!1,a=e.localName;this.beginElement(a),this.openTagBegin(a);var s=this._serializeAttributes(e,t);if(this.attributes(s),e.hasChildNodes()?this.openTagEnd(a,!1,!1):(this.openTagEnd(a,!0,!1),this.endElement(a),o=!0),!o){try{for(var l=r(e._children),c=l.next();!c.done;c=l.next()){var d=c.value;this.level++,this._serializeNode(d,t),this.level--}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}this.closeTag(a),this.endElement(a)}},e.prototype._serializeDocumentNS=function(e,t,n,i,o){var a,s;if(o&&null===e.documentElement)throw new Error("Missing document element (well-formed required).");try{for(var l=r(e.childNodes),c=l.next();!c.done;c=l.next()){var u=c.value;this._serializeNodeNS(u,t,n,i,o)}}catch(e){a={error:e}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}},e.prototype._serializeDocument=function(e,t){var n,i;if(t&&null===e.documentElement)throw new Error("Missing document element (well-formed required).");try{for(var o=r(e._children),a=o.next();!a.done;a=o.next()){var s=a.value;this._serializeNode(s,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype._serializeComment=function(e,t){if(t&&(!u.xml_isLegalChar(e.data)||-1!==e.data.indexOf("--")||e.data.endsWith("-")))throw new Error("Comment data contains invalid characters (well-formed required).");this.comment(e.data)},e.prototype._serializeText=function(e,t){if(t&&!u.xml_isLegalChar(e.data))throw new Error("Text data contains invalid characters (well-formed required).");var n=e.data.replace(/(?!&([^&;]*);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");this.text(n)},e.prototype._serializeDocumentFragmentNS=function(e,t,n,i,o){var a,s;try{for(var l=r(e.childNodes),c=l.next();!c.done;c=l.next()){var u=c.value;this._serializeNodeNS(u,t,n,i,o)}}catch(e){a={error:e}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}},e.prototype._serializeDocumentFragment=function(e,t){var n,i;try{for(var o=r(e._children),a=o.next();!a.done;a=o.next()){var s=a.value;this._serializeNode(s,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype._serializeDocumentType=function(e,t){if(t&&!u.xml_isPubidChar(e.publicId))throw new Error("DocType public identifier does not match PubidChar construct (well-formed required).");if(t&&(!u.xml_isLegalChar(e.systemId)||-1!==e.systemId.indexOf('"')&&-1!==e.systemId.indexOf("'")))throw new Error("DocType system identifier contains invalid characters (well-formed required).");this.docType(e.name,e.publicId,e.systemId)},e.prototype._serializeProcessingInstruction=function(e,t){if(t&&(-1!==e.target.indexOf(":")||/^xml$/i.test(e.target)))throw new Error("Processing instruction target contains invalid characters (well-formed required).");if(t&&(!u.xml_isLegalChar(e.data)||-1!==e.data.indexOf("?>")))throw new Error("Processing instruction data contains invalid characters (well-formed required).");this.instruction(e.target,e.data)},e.prototype._serializeCData=function(e,t){if(t&&-1!==e.data.indexOf("]]>"))throw new Error("CDATA contains invalid characters (well-formed required).");this.cdata(e.data)},e.prototype._serializeAttributesNS=function(e,t,n,i,o,a){var l,d,p=[],f=a?new s.LocalNameSet:void 0;try{for(var h=r(e.attributes),m=h.next();!m.done;m=h.next()){var g=m.value;if(a||o||null!==g.namespaceURI){if(a&&f&&f.has(g.namespaceURI,g.localName))throw new Error("Element contains duplicate attributes (well-formed required).");a&&f&&f.set(g.namespaceURI,g.localName);var v=g.namespaceURI,y=null;if(null!==v)if(y=t.get(g.prefix,v),v===c.namespace.XMLNS){if(g.value===c.namespace.XML||null===g.prefix&&o||null!==g.prefix&&(!(g.localName in i)||i[g.localName]!==g.value)&&t.has(g.localName,g.value))continue;if(a&&g.value===c.namespace.XMLNS)throw new Error("XMLNS namespace is reserved (well-formed required).");if(a&&""===g.value)throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required).");"xmlns"===g.prefix&&(y="xmlns")}else null===y&&(y=null===g.prefix||t.hasPrefix(g.prefix)&&!t.has(g.prefix,v)?this._generatePrefix(v,t,n):g.prefix,p.push([null,"xmlns",y,this._serializeAttributeValue(v,a)]));if(a&&(-1!==g.localName.indexOf(":")||!u.xml_isName(g.localName)||"xmlns"===g.localName&&null===v))throw new Error("Attribute local name contains invalid characters (well-formed required).");p.push([v,y,g.localName,this._serializeAttributeValue(g.value,a)])}else p.push([null,null,g.localName,this._serializeAttributeValue(g.value,a)])}}catch(e){l={error:e}}finally{try{m&&!m.done&&(d=h.return)&&d.call(h)}finally{if(l)throw l.error}}return p},e.prototype._serializeAttributes=function(e,t){var n,i,o=[],a=t?{}:void 0;try{for(var s=r(e.attributes),l=s.next();!l.done;l=s.next()){var c=l.value;if(t){if(t&&a&&c.localName in a)throw new Error("Element contains duplicate attributes (well-formed required).");if(t&&a&&(a[c.localName]=!0),t&&(-1!==c.localName.indexOf(":")||!u.xml_isName(c.localName)))throw new Error("Attribute local name contains invalid characters (well-formed required).");o.push([null,null,c.localName,this._serializeAttributeValue(c.value,t)])}else o.push([null,null,c.localName,this._serializeAttributeValue(c.value,t)])}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o},e.prototype._recordNamespaceInformation=function(e,t,n){var i,o,a=null;try{for(var s=r(e.attributes),l=s.next();!l.done;l=s.next()){var u=l.value,d=u.namespaceURI,p=u.prefix;if(d===c.namespace.XMLNS){if(null===p){a=u.value;continue}var f=u.localName,h=u.value;if(h===c.namespace.XML)continue;if(""===h&&(h=null),t.has(f,h))continue;t.set(f,h),n[f]=h||""}}}catch(e){i={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}return a},e.prototype._generatePrefix=function(e,t,n){var r="ns"+n.value.toString();return n.value++,t.set(r,e),r},e.prototype._serializeAttributeValue=function(e,t){if(t&&null!==e&&!u.xml_isLegalChar(e))throw new Error("Invalid characters in attribute value.");return null===e?"":e.replace(/(?!&([^&;]*);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),e}();t.BaseWriter=d},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),a=n(3),s=n(7),l=n(29),c=n(17),u=n(97);function d(){var e=o.dom.window;e._mutationObserverMicrotaskQueued||(e._mutationObserverMicrotaskQueued=!0,Promise.resolve().then((function(){p()})))}function p(){var e,t,n,i,l=o.dom.window;l._mutationObserverMicrotaskQueued=!1;var c=s.set.clone(l._mutationObservers),d=s.set.clone(l._signalSlots);s.set.empty(l._signalSlots);var p=function(e){var t=s.list.clone(e._recordQueue);s.list.empty(e._recordQueue);for(var n=0;n<e._nodeList.length;n++){var r=e._nodeList[n];s.list.remove(r._registeredObserverList,(function(t){return a.Guard.isTransientRegisteredObserver(t)&&t.observer===e}))}if(!s.list.isEmpty(t))try{e._callback.call(e,t,e)}catch(e){}};try{for(var f=r(c),h=f.next();!h.done;h=f.next())p(h.value)}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=f.return)&&t.call(f)}finally{if(e)throw e.error}}if(o.dom.features.slots)try{for(var m=r(d),g=m.next();!g.done;g=m.next()){var v=g.value;u.event_fireAnEvent("slotchange",v,void 0,{bubbles:!0})}}catch(e){n={error:e}}finally{try{g&&!g.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}}function f(e,t,n,o,a,s,u,p,f){for(var h,m,g=new Map,v=c.tree_getFirstAncestorNode(t,!0);null!==v;){for(var y=0;y<v._registeredObserverList.length;y++){var b=v._registeredObserverList[y],x=b.options;if((v===t||x.subtree)&&("attributes"!==e||x.attributes)&&("attributes"!==e||!x.attributeFilter||x.attributeFilter.indexOf(n||"")&&null===o)&&("characterData"!==e||x.characterData)&&("childList"!==e||x.childList)){var A=b.observer;g.has(A)||g.set(A,null),("attributes"===e&&x.attributeOldValue||"characterData"===e&&x.characterDataOldValue)&&g.set(A,a)}}v=c.tree_getNextAncestorNode(t,v,!0)}try{for(var C=r(g),T=C.next();!T.done;T=C.next()){var S=i(T.value,2),w=S[0],_=S[1],I=l.create_mutationRecord(e,t,l.create_nodeListStatic(t,s),l.create_nodeListStatic(t,u),p,f,n,o,_);w._recordQueue.push(I)}}catch(e){h={error:e}}finally{try{T&&!T.done&&(m=C.return)&&m.call(C)}finally{if(h)throw h.error}}d()}t.observer_queueAMutationObserverMicrotask=d,t.observer_notifyMutationObservers=p,t.observer_queueMutationRecord=f,t.observer_queueTreeMutationRecord=function(e,t,n,r,i){f("childList",e,null,null,null,t,n,r,i)},t.observer_queueAttributeMutationRecord=function(e,t,n,r){f("attributes",e,t,n,r,[],[],null,null)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(7),o=n(3),a=n(9),s=n(29),l=n(73),c=n(51),u=n(30),d=n(37),p=n(106);function f(e,t,n){r.dom.features.mutationObservers&&c.observer_queueAttributeMutationRecord(t,e._localName,e._namespace,e._value),r.dom.features.customElements&&o.Guard.isCustomElementNode(t)&&l.customElement_enqueueACustomElementCallbackReaction(t,"attributeChangedCallback",[e._localName,e._value,n,e._namespace]),r.dom.features.steps&&u.dom_runAttributeChangeSteps(t,e._localName,e._value,n,e._namespace),e._value=n}function h(e,t){r.dom.features.mutationObservers&&c.observer_queueAttributeMutationRecord(t,e._localName,e._namespace,null),r.dom.features.customElements&&o.Guard.isCustomElementNode(t)&&l.customElement_enqueueACustomElementCallbackReaction(t,"attributeChangedCallback",[e._localName,null,e._value,e._namespace]),r.dom.features.steps&&u.dom_runAttributeChangeSteps(t,e._localName,null,e._value,e._namespace),t._attributeList._asArray().push(e),e._element=t,t._nodeDocument._hasNamespaces||null===e._namespace&&null===e._namespacePrefix&&"xmlns"!==e._localName||(t._nodeDocument._hasNamespaces=!0)}function m(e,t){r.dom.features.mutationObservers&&c.observer_queueAttributeMutationRecord(t,e._localName,e._namespace,e._value),r.dom.features.customElements&&o.Guard.isCustomElementNode(t)&&l.customElement_enqueueACustomElementCallbackReaction(t,"attributeChangedCallback",[e._localName,e._value,null,e._namespace]),r.dom.features.steps&&u.dom_runAttributeChangeSteps(t,e._localName,e._value,null,e._namespace);var n=t._attributeList._asArray().indexOf(e);t._attributeList._asArray().splice(n,1),e._element=null}function g(e,t,n){r.dom.features.mutationObservers&&c.observer_queueAttributeMutationRecord(n,e._localName,e._namespace,e._value),r.dom.features.customElements&&o.Guard.isCustomElementNode(n)&&l.customElement_enqueueACustomElementCallbackReaction(n,"attributeChangedCallback",[e._localName,e._value,t._value,e._namespace]),r.dom.features.steps&&u.dom_runAttributeChangeSteps(n,e._localName,e._value,t._value,e._namespace);var i=n._attributeList._asArray().indexOf(e);-1!==i&&(n._attributeList._asArray()[i]=t),e._element=null,t._element=n,n._nodeDocument._hasNamespaces||null===t._namespace&&null===t._namespacePrefix&&"xmlns"!==t._localName||(n._nodeDocument._hasNamespaces=!0)}function v(e,t){return t._namespace===i.namespace.HTML&&"html"===t._nodeDocument._type&&(e=e.toLowerCase()),t._attributeList._asArray().find((function(t){return t._qualifiedName===e}))||null}function y(e,t,n){var r=e||null;return n._attributeList._asArray().find((function(e){return e._namespace===r&&e._localName===t}))||null}t.element_has=function(e,t){return-1!==t._attributeList._asArray().indexOf(e)},t.element_change=f,t.element_append=h,t.element_remove=m,t.element_replace=g,t.element_getAnAttributeByName=v,t.element_getAnAttributeByNamespaceAndLocalName=y,t.element_getAnAttributeValue=function(e,t,n){void 0===n&&(n="");var r=y(n,t,e);return null===r?"":r._value},t.element_setAnAttribute=function(e,t){if(null!==e._element&&e._element!==t)throw new a.InUseAttributeError("This attribute already exists in the document: "+e._qualifiedName+" as a child of "+e._element._qualifiedName+".");var n=y(e._namespace||"",e._localName,t);return n===e?e:(null!==n?g(n,e,t):h(e,t),n)},t.element_setAnAttributeValue=function(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var o=y(i||"",t,e);if(null===o){var a=s.create_attr(e._nodeDocument,t);return a._namespace=i,a._namespacePrefix=r,a._value=n,void h(a,e)}f(o,e,n)},t.element_removeAnAttributeByName=function(e,t){var n=v(e,t);return null!==n&&m(n,t),n},t.element_removeAnAttributeByNamespaceAndLocalName=function(e,t,n){var r=y(e,t,n);return null!==r&&m(r,n),r},t.element_createAnElement=function(e,t,n,o,c,u){void 0===o&&(o=null),void 0===c&&(c=null),void 0===u&&(u=!1);var d=null;if(!r.dom.features.customElements)return(d=s.create_element(e,t,n,o))._customElementState="uncustomized",d._customElementDefinition=null,d._is=c,d;var f=l.customElement_lookUpACustomElementDefinition(e,n,t,c);if(null!==f&&f.name!==f.localName)(d=new(p.document_elementInterface(t,i.namespace.HTML)))._localName=t,d._namespace=i.namespace.HTML,d._namespacePrefix=o,d._customElementState="undefined",d._customElementDefinition=null,d._is=c,d._nodeDocument=e,u?l.customElement_upgrade(f,d):l.customElement_enqueueACustomElementUpgradeReaction(d,f);else if(null!==f)if(u)try{var h=new(0,f.constructor);if(console.assert(void 0!==h._customElementState),console.assert(void 0!==h._customElementDefinition),console.assert(h._namespace===i.namespace.HTML),0!==h._attributeList.length)throw new a.NotSupportedError("Custom element already has attributes.");if(0!==h._children.size)throw new a.NotSupportedError("Custom element already has child nodes.");if(null!==h._parent)throw new a.NotSupportedError("Custom element already has a parent node.");if(h._nodeDocument!==e)throw new a.NotSupportedError("Custom element is already in a document.");if(h._localName!==t)throw new a.NotSupportedError("Custom element has a different local name.");h._namespacePrefix=o,h._is=null}catch(n){(d=s.create_htmlUnknownElement(e,t,i.namespace.HTML,o))._customElementState="failed",d._customElementDefinition=null,d._is=null}else(d=s.create_htmlElement(e,t,i.namespace.HTML,o))._customElementState="undefined",d._customElementDefinition=null,d._is=null,l.customElement_enqueueACustomElementUpgradeReaction(d,f);else(d=new(p.document_elementInterface(t,n)))._localName=t,d._namespace=n,d._namespacePrefix=o,d._customElementState="uncustomized",d._customElementDefinition=null,d._is=c,d._nodeDocument=e,n!==i.namespace.HTML||null===c&&!l.customElement_isValidCustomElementName(t)||(d._customElementState="undefined");if(null===d)throw new Error("Unable to create element.");return d},t.element_insertAdjacent=function(e,t,n){switch(t.toLowerCase()){case"beforebegin":return null===e._parent?null:d.mutation_preInsert(n,e._parent,e);case"afterbegin":return d.mutation_preInsert(n,e,e._firstChild);case"beforeend":return d.mutation_preInsert(n,e,null);case"afterend":return null===e._parent?null:d.mutation_preInsert(n,e._parent,e._nextSibling);default:throw new a.SyntaxError('Invalid \'where\' argument. "beforebegin", "afterbegin", "beforeend" or "afterend" expected')}}},function(e,t,n){"use strict";function r(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():""),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r.prototype.toString=function(e){var t=this.name+": ";return t+=this.reason||"(unknown reason)",!e&&this.mark&&(t+=" "+this.mark.toString()),t},e.exports=r},function(e,t,n){"use strict";var r=n(39);e.exports=new r({include:[n(181)],implicit:[n(293),n(294)],explicit:[n(295),n(296),n(297),n(298)]})},function(e,t,n){var r=n(16),i=n(79),o=n(40),a=n(24),s=n(56),l=n(14),c=n(115),u=Object.getOwnPropertyDescriptor;t.f=r?u:function(e,t){if(e=a(e),t=s(t,!0),c)try{return u(e,t)}catch(e){}if(l(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t,n){var r=n(13);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(81),i=n(58),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t,n){var r=n(42);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r,i=n(18),o=n(188),a=n(84),s=n(45),l=n(189),c=n(116),u=n(57)("IE_PROTO"),d=function(){},p=function(e){return"<script>"+e+"<\/script>"},f=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;f=r?function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t}(r):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F);for(var n=a.length;n--;)delete f.prototype[a[n]];return f()};s[u]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=i(e),n=new d,d.prototype=null,n[u]=e):n=f(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(121),i=n(84);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(15).f,i=n(14),o=n(5)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r=n(8),i=n(5),o=n(129),a=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){"use strict";var r=n(4),i=n(122).indexOf,o=n(48),a=n(28),s=[].indexOf,l=!!s&&1/[1].indexOf(1,-0)<0,c=o("indexOf"),u=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:l||!c||!u},{indexOf:function(e){return l?s.apply(this,arguments)||0:i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(16),i=n(15).f,o=Function.prototype,a=o.toString,s=/^\s*function ([^ (]*)/;r&&!("name"in o)&&i(o,"name",{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(25),i=n(18),o=n(8),a=n(136),s=RegExp.prototype,l=s.toString,c=o((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),u="toString"!=l.name;(c||u)&&r(RegExp.prototype,"toString",(function(){var e=i(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in s)?a.call(e):n)}),{unsafe:!0})},function(e,t,n){"use strict";n(31),n(32),n(33),n(19),n(138),n(20),n(66),n(22),n(23);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(2),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r._writerOptions=a.applyDefaults(n,{format:"object",wellFormed:!1,group:!1,verbose:!1}),r}return i(t,e),t.prototype.serialize=function(e){return this._currentList=[],this._currentIndex=0,this._listRegister=[this._currentList],this.serializeNode(e,this._writerOptions.wellFormed),this._process(this._currentList,this._writerOptions)},t.prototype._process=function(e,t){var n,r,i,o,l,c,u;if(0===e.length)return{};for(var d={},p=!1,f=0,h=0,m=0,g=0,v=0;v<e.length;v++){var y=e[v];switch(M=Object.keys(y)[0]){case"@":continue;case"#":f++;break;case"!":h++;break;case"?":m++;break;case"$":g++;break;default:d[M]?p=!0:d[M]=!0}}var b=this._getAttrKey(),x=this._getNodeKey(s.NodeType.Text),A=this._getNodeKey(s.NodeType.Comment),C=this._getNodeKey(s.NodeType.ProcessingInstruction),T=this._getNodeKey(s.NodeType.CData);if(1===f&&1===e.length&&a.isString(e[0]["#"]))return e[0]["#"];if(p){var S={};for(v=0;v<e.length;v++)if(y=e[v],"@"===(M=Object.keys(y)[0])){var w=y["@"];1===(L=Object.keys(w)).length?S[b+L[0]]=w[L[0]]:S[b]=y["@"]}var _=[];for(v=0;v<e.length;v++)switch(y=e[v],M=Object.keys(y)[0]){case"@":break;case"#":_.push(((n={})[x]=y["#"],n));break;case"!":_.push(((r={})[A]=y["!"],r));break;case"?":_.push(((i={})[C]=y["?"],i));break;case"$":_.push(((o={})[T]=y.$,o));break;default:if(0!==(B=y)[M].length&&a.isArray(B[M][0])){for(var I=[],E=B[M],D=0;D<E.length;D++)I.push(this._process(E[D],t));_.push(((l={})[M]=I,l))}else t.verbose?_.push(((c={})[M]=[this._process(B[M],t)],c)):_.push(((u={})[M]=this._process(B[M],t),u))}return S[x]=_,S}var O=1,P=1,R=1,N=1;for(S={},v=0;v<e.length;v++){var M;switch(y=e[v],M=Object.keys(y)[0]){case"@":w=y["@"];var L=Object.keys(w);if(t.group&&1!==L.length)S[b]=w;else for(var F in w)S[b+F]=w[F];break;case"#":O=this._processSpecItem(y["#"],S,t.group,x,f,O);break;case"!":P=this._processSpecItem(y["!"],S,t.group,A,h,P);break;case"?":R=this._processSpecItem(y["?"],S,t.group,C,m,R);break;case"$":N=this._processSpecItem(y.$,S,t.group,T,g,N);break;default:var B;if(0!==(B=y)[M].length&&a.isArray(B[M][0])){I=[],E=B[M];for(var V=0;V<E.length;V++)I.push(this._process(E[V],t));S[M]=I}else t.verbose?S[M]=[this._process(B[M],t)]:S[M]=this._process(B[M],t)}}return S},t.prototype._processSpecItem=function(e,t,n,r,i,s){var l,c;if(!n&&a.isArray(e)&&i+e.length>2)try{for(var u=o(e),d=u.next();!d.done;d=u.next()){var p=d.value;t[r+(s++).toString()]=p}}catch(e){l={error:e}}finally{try{d&&!d.done&&(c=u.return)&&c.call(u)}finally{if(l)throw l.error}}else t[i>1?r+(s++).toString():r]=e;return s},t.prototype.beginElement=function(e){var t,n,r=[];if(0===this._currentList.length)this._currentList.push(((t={})[e]=r,t));else{var i=this._currentList[this._currentList.length-1];this._isElementNode(i,e)?0!==i[e].length&&a.isArray(i[e][0])?i[e].push(r):i[e]=[i[e],r]:this._currentList.push(((n={})[e]=r,n))}this._currentIndex++,this._listRegister.length>this._currentIndex?this._listRegister[this._currentIndex]=r:this._listRegister.push(r),this._currentList=r},t.prototype.endElement=function(){this._currentList=this._listRegister[--this._currentIndex]},t.prototype.attribute=function(e,t){var n,r;if(0===this._currentList.length)this._currentList.push({"@":(n={},n[e]=t,n)});else{var i=this._currentList[this._currentList.length-1];this._isAttrNode(i)?i["@"][e]=t:this._currentList.push({"@":(r={},r[e]=t,r)})}},t.prototype.comment=function(e){if(0===this._currentList.length)this._currentList.push({"!":e});else{var t=this._currentList[this._currentList.length-1];this._isCommentNode(t)?a.isArray(t["!"])?t["!"].push(e):t["!"]=[t["!"],e]:this._currentList.push({"!":e})}},t.prototype.text=function(e){if(0===this._currentList.length)this._currentList.push({"#":e});else{var t=this._currentList[this._currentList.length-1];this._isTextNode(t)?a.isArray(t["#"])?t["#"].push(e):t["#"]=[t["#"],e]:this._currentList.push({"#":e})}},t.prototype.instruction=function(e,t){var n=""===t?e:e+" "+t;if(0===this._currentList.length)this._currentList.push({"?":n});else{var r=this._currentList[this._currentList.length-1];this._isInstructionNode(r)?a.isArray(r["?"])?r["?"].push(n):r["?"]=[r["?"],n]:this._currentList.push({"?":n})}},t.prototype.cdata=function(e){if(0===this._currentList.length)this._currentList.push({$:e});else{var t=this._currentList[this._currentList.length-1];this._isCDATANode(t)?a.isArray(t.$)?t.$.push(e):t.$=[t.$,e]:this._currentList.push({$:e})}},t.prototype._isAttrNode=function(e){return"@"in e},t.prototype._isTextNode=function(e){return"#"in e},t.prototype._isCommentNode=function(e){return"!"in e},t.prototype._isInstructionNode=function(e){return"?"in e},t.prototype._isCDATANode=function(e){return"$"in e},t.prototype._isElementNode=function(e,t){return t in e},t.prototype._getAttrKey=function(){return this._builderOptions.convert.att},t.prototype._getNodeKey=function(e){switch(e){case s.NodeType.Comment:return this._builderOptions.convert.comment;case s.NodeType.Text:return this._builderOptions.convert.text;case s.NodeType.ProcessingInstruction:return this._builderOptions.convert.ins;case s.NodeType.CData:return this._builderOptions.convert.cdata;default:throw new Error("Invalid node type.")}},t}(n(50).BaseWriter);t.ObjectWriter=l},function(e,t,n){"use strict";var r=n(4),i=n(93);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._items={},this._nullItems={}}return e.prototype.set=function(e,t){null===e?this._nullItems[t]=!0:(this._items[e]||(this._items[e]={}),this._items[e][t]=!0)},e.prototype.has=function(e,t){return null===e?!0===this._nullItems[t]:!!this._items[e]&&!0===this._items[e][t]},e}();t.LocalNameSet=r},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),o=n(3),a=n(0),s=function(){function e(){}return Object.defineProperty(e.prototype,"_eventListenerList",{get:function(){return this.__eventListenerList||(this.__eventListenerList=[])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_eventHandlerMap",{get:function(){return this.__eventHandlerMap||(this.__eventHandlerMap={})},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(e,t,n){void 0===n&&(n={passive:!1,once:!1,capture:!1});var i,s=r(a.eventTarget_flattenMore(n),3),l=s[0],c=s[1],u=s[2];t&&(i=o.Guard.isEventListener(t)?t:{handleEvent:t},a.eventTarget_addEventListener(this,{type:e,callback:i,capture:l,passive:c,once:u,removed:!1}))},e.prototype.removeEventListener=function(e,t,n){void 0===n&&(n={capture:!1});var r=a.eventTarget_flatten(n);if(t)for(var i=0;i<this._eventListenerList.length;i++){var s=this._eventListenerList[i];if(s.type===e&&s.capture===r){if(o.Guard.isEventListener(t)&&s.callback===t){a.eventTarget_removeEventListener(this,s,i);break}if(t&&s.callback.handleEvent===t){a.eventTarget_removeEventListener(this,s,i);break}}}},e.prototype.dispatchEvent=function(e){if(e._dispatchFlag||!e._initializedFlag)throw new i.InvalidStateError;return e._isTrusted=!1,a.event_dispatch(e,this)},e.prototype._getTheParent=function(e){return null},e}();t.EventTargetImpl=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(34),a=n(0),s=function(e){function t(t){var n=e.call(this)||this;return n._data=t,n}return i(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){a.characterData_replaceData(this,0,this._data.length,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._data.length},enumerable:!0,configurable:!0}),t.prototype.substringData=function(e,t){return a.characterData_substringData(this,e,t)},t.prototype.appendData=function(e){return a.characterData_replaceData(this,this._data.length,0,e)},t.prototype.insertData=function(e,t){a.characterData_replaceData(this,e,0,t)},t.prototype.deleteData=function(e,t){a.characterData_replaceData(this,e,t,"")},t.prototype.replaceData=function(e,t,n){a.characterData_replaceData(this,e,t,n)},Object.defineProperty(t.prototype,"previousElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),t.prototype.before=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.after=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.replaceWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},t}(o.NodeImpl);t.CharacterDataImpl=s},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),s=n(3),l=n(1),c=n(17),u=n(51);function d(e){a.dom.window._signalSlots.add(e),u.observer_queueAMutationObserverMicrotask()}function p(e,t){void 0===t&&(t=!1);var n=s.Cast.asNode(e)._parent;if(null===n)return null;var r=n._shadowRoot||null;if(null===r)return null;if(t&&"open"!==r._mode)return null;for(var i=c.tree_getFirstDescendantNode(r,!1,!0,(function(e){return s.Guard.isSlot(e)}));null!==i;){if(i._name===e._name)return i;i=c.tree_getNextDescendantNode(r,i,!1,!0,(function(e){return s.Guard.isSlot(e)}))}return null}function f(e){var t,n,i=[],o=c.tree_rootNode(e);if(!s.Guard.isShadowRoot(o))return i;var a=o._host;try{for(var l=r(a._children),u=l.next();!u.done;u=l.next()){var d=u.value;s.Guard.isSlotable(d)&&p(d)===e&&i.push(d)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return i}function h(e){var t,n,i=f(e);if(i.length===e._assignedNodes.length){for(var o=!0,a=0;a<i.length;a++)if(i[a]!==e._assignedNodes[a]){o=!1;break}o||d(e)}e._assignedNodes=i;try{for(var s=r(i),l=s.next();!l.done;l=s.next())l.value._assignedSlot=e}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}t.shadowTree_signalASlotChange=d,t.shadowTree_isConnected=function(e){return s.Guard.isDocumentNode(c.tree_rootNode(e,!0))},t.shadowTree_isAssigned=function(e){return null!==e._assignedSlot},t.shadowTree_findASlot=p,t.shadowTree_findSlotables=f,t.shadowTree_findFlattenedSlotables=function e(t){var n,i,a,u,d=[],p=c.tree_rootNode(t);if(!s.Guard.isShadowRoot(p))return d;var h=f(t);if(l.isEmpty(h))try{for(var m=r(t._children),g=m.next();!g.done;g=m.next()){var v=g.value;s.Guard.isSlotable(v)&&h.push(v)}}catch(e){n={error:e}}finally{try{g&&!g.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}try{for(var y=r(h),b=y.next();!b.done;b=y.next()){var x=b.value;if(s.Guard.isSlot(x)&&s.Guard.isShadowRoot(c.tree_rootNode(x))){var A=e(x);d.push.apply(d,o(A))}else d.push(x)}}catch(e){a={error:e}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(a)throw a.error}}return d},t.shadowTree_assignSlotables=h,t.shadowTree_assignSlotablesForATree=function(e){for(var t=c.tree_getFirstDescendantNode(e,!0,!1,(function(e){return s.Guard.isSlot(e)}));null!==t;)h(t),t=c.tree_getNextDescendantNode(e,t,!0,!1,(function(e){return s.Guard.isSlot(e)}))},t.shadowTree_assignASlot=function(e){var t=p(e);null!==t&&h(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/[a-z]([\0-\t\x2D\._a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*-([\0-\t\x2D\._a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*/,i=new Set(["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"]),o=new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]),a=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),s=new Set(["article","aside","blockquote","body","div","footer","h1","h2","h3","h4","h5","h6","header","main","nav","p","section","span"]);t.customElement_isValidCustomElementName=function(e){return!!r.test(e)&&!i.has(e)},t.customElement_isValidElementName=function(e){return o.has(e)},t.customElement_isVoidElementName=function(e){return a.has(e)},t.customElement_isValidShadowHostName=function(e){return s.has(e)},t.customElement_enqueueACustomElementUpgradeReaction=function(e,t){},t.customElement_enqueueACustomElementCallbackReaction=function(e,t,n){},t.customElement_upgrade=function(e,t){},t.customElement_tryToUpgrade=function(e){},t.customElement_lookUpACustomElementDefinition=function(e,t,n,r){return null}},function(e,t,n){n(4)({target:"String",proto:!0},{repeat:n(259)})},function(e,t,n){"use strict";n(278),n(68),n(179),n(94),Object.defineProperty(t,"__esModule",{value:!0});var r=n(109),i=function(){function e(e){this._builderOptions=e,e.parser&&Object.assign(this,e.parser)}return e.prototype._docType=function(e,t,n,r){return e.dtd({name:t,pubID:n,sysID:r})},e.prototype._comment=function(e,t){return e.com(t)},e.prototype._text=function(e,t){return e.txt(t)},e.prototype._instruction=function(e,t,n){return e.ins(t,n)},e.prototype._cdata=function(e,t){return e.dat(t)},e.prototype._element=function(e,t,n){return void 0===t?e.ele(n):e.ele(t,n)},e.prototype._attribute=function(e,t,n,r){return void 0===t?e.att(n,r):e.att(t,n,r)},e.prototype._sanitize=function(e){return r.sanitizeInput(e,this._builderOptions.invalidCharReplacement)},e.prototype._decodeText=function(t){return null==t?t:t.replace(/&(quot|amp|apos|lt|gt);/g,(function(t,n){return e._entityTable[n]})).replace(/&#(?:x([a-fA-F0-9]+)|([0-9]+));/g,(function(e,t,n){return String.fromCodePoint(parseInt(t||n,t?16:10))}))},e.prototype._decodeAttributeValue=function(e){return this._decodeText(e)},e.prototype.parse=function(e,t){return this._parse(e,t)},e.prototype.docType=function(e,t,n,r){return this._docType(e,t,n,r)},e.prototype.comment=function(e,t){return this._comment(e,t)},e.prototype.text=function(e,t){return this._text(e,t)},e.prototype.instruction=function(e,t,n){return this._instruction(e,t,n)},e.prototype.cdata=function(e,t){return this._cdata(e,t)},e.prototype.element=function(e,t,n){return this._element(e,t,n)},e.prototype.attribute=function(e,t,n,r){return this._attribute(e,t,n,r)},e.prototype.sanitize=function(e){return this._sanitize(e)},e._entityTable={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},e}();t.BaseReader=i},function(e,t,n){"use strict";var r=n(39);e.exports=r.DEFAULT=new r({include:[n(54)],explicit:[n(299),n(300),n(301)]})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(185);t.XMLBuilderImpl=r.XMLBuilderImpl;var i=n(304);t.XMLBuilderCBImpl=i.XMLBuilderCBImpl;var o=n(183);t.builder=o.builder,t.create=o.create,t.fragment=o.fragment,t.convert=o.convert;var a=n(309);t.createCB=a.createCB,t.fragmentCB=a.fragmentCB},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(11),i=n(21);e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},function(e,t,n){var r=n(44),i=n(118);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(121),i=n(84).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(47),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(8);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(e,t,n){var r=n(127);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){"use strict";var r=n(4),i=n(195),o=n(132),a=n(133),s=n(62),l=n(21),c=n(25),u=n(5),d=n(44),p=n(49),f=n(131),h=f.IteratorPrototype,m=f.BUGGY_SAFARI_ITERATORS,g=u("iterator"),v=function(){return this};e.exports=function(e,t,n,u,f,y,b){i(n,t,u);var x,A,C,T=function(e){if(e===f&&E)return E;if(!m&&e in _)return _[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},S=t+" Iterator",w=!1,_=e.prototype,I=_[g]||_["@@iterator"]||f&&_[f],E=!m&&I||T(f),D="Array"==t&&_.entries||I;if(D&&(x=o(D.call(new e)),h!==Object.prototype&&x.next&&(d||o(x)===h||(a?a(x,h):"function"!=typeof x[g]&&l(x,g,v)),s(x,S,!0,!0),d&&(p[S]=v))),"values"==f&&I&&"values"!==I.name&&(w=!0,E=function(){return I.call(this)}),d&&!b||_[g]===E||l(_,g,E),p[t]=E,f)if(A={values:T("values"),keys:y?E:T("keys"),entries:T("entries")},b)for(C in A)(m||w||!(C in _))&&c(_,C,A[C]);else r({target:t,proto:!0,forced:m||w},A);return A}},function(e,t,n){"use strict";var r=n(4),i=n(13),o=n(59),a=n(83),s=n(26),l=n(24),c=n(134),u=n(5),d=n(63),p=n(28),f=d("slice"),h=p("slice",{ACCESSORS:!0,0:0,1:2}),m=u("species"),g=[].slice,v=Math.max;r({target:"Array",proto:!0,forced:!f||!h},{slice:function(e,t){var n,r,u,d=l(this),p=s(d.length),f=a(e,p),h=a(void 0===t?p:t,p);if(o(d)&&("function"!=typeof(n=d.constructor)||n!==Array&&!o(n.prototype)?i(n)&&null===(n=n[m])&&(n=void 0):n=void 0,n===Array||void 0===n))return g.call(d,f,h);for(r=new(void 0===n?Array:n)(v(h-f,0)),u=0;f<h;f++,u++)f in d&&c(r,u,d[f]);return r.length=u,r}})},function(e,t,n){var r={};r[n(5)("toStringTag")]="z",e.exports="[object z]"===String(r)},function(e,t,n){"use strict";n(19),n(138),n(20),n(92),n(22),n(23),Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultBuilderOptions={version:"1.0",encoding:void 0,standalone:void 0,keepNullNodes:!1,keepNullAttributes:!1,ignoreConverters:!1,convert:{att:"@",ins:"?",text:"#",cdata:"$",comment:"!"},defaultNamespace:{ele:void 0,att:void 0},namespaceAlias:{html:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},invalidCharReplacement:void 0,parser:void 0},t.XMLBuilderOptionKeys=new Set(Object.keys(t.DefaultBuilderOptions)),t.DefaultXMLBuilderCBOptions={format:"xml",wellFormed:!1,prettyPrint:!1,indent:"  ",newline:"\n",offset:0,width:0,allowEmptyTags:!1,spaceBeforeSlash:!1,keepNullNodes:!1,keepNullAttributes:!1,ignoreConverters:!1,convert:{att:"@",ins:"?",text:"#",cdata:"$",comment:"!"},defaultNamespace:{ele:void 0,att:void 0},namespaceAlias:{html:"http://www.w3.org/1999/xhtml",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"}}},function(e,t,n){"use strict";var r=n(139),i=n(143);e.exports=r("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,n){"use strict";var r,i,o=n(136),a=n(221),s=RegExp.prototype.exec,l=String.prototype.replace,c=s,u=(r=/a/,i=/b*/g,s.call(r,"a"),s.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),d=a.UNSUPPORTED_Y||a.BROKEN_CARET,p=void 0!==/()??/.exec("")[1];(u||p||d)&&(c=function(e){var t,n,r,i,a=this,c=d&&a.sticky,f=o.call(a),h=a.source,m=0,g=e;return c&&(-1===(f=f.replace("y","")).indexOf("g")&&(f+="g"),g=String(e).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(h="(?: "+h+")",g=" "+g,m++),n=new RegExp("^(?:"+h+")",f)),p&&(n=new RegExp("^"+h+"$(?!\\s)",f)),u&&(t=a.lastIndex),r=s.call(c?n:a,g),c?r?(r.input=r.input.slice(m),r[0]=r[0].slice(m),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:u&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),p&&r&&r.length>1&&l.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=c},function(e,t,n){"use strict";var r=n(225),i=n(18),o=n(27),a=n(26),s=n(47),l=n(35),c=n(226),u=n(227),d=Math.max,p=Math.min,f=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g;r("replace",2,(function(e,t,n,r){var g=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,v=r.REPLACE_KEEPS_$0,y=g?"$":"$0";return[function(n,r){var i=l(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):t.call(String(i),n,r)},function(e,r){if(!g&&v||"string"==typeof r&&-1===r.indexOf(y)){var o=n(t,e,this,r);if(o.done)return o.value}var l=i(e),f=String(this),h="function"==typeof r;h||(r=String(r));var m=l.global;if(m){var x=l.unicode;l.lastIndex=0}for(var A=[];;){var C=u(l,f);if(null===C)break;if(A.push(C),!m)break;""===String(C[0])&&(l.lastIndex=c(f,a(l.lastIndex),x))}for(var T,S="",w=0,_=0;_<A.length;_++){C=A[_];for(var I=String(C[0]),E=d(p(s(C.index),f.length),0),D=[],O=1;O<C.length;O++)D.push(void 0===(T=C[O])?T:String(T));var P=C.groups;if(h){var R=[I].concat(D,E,f);void 0!==P&&R.push(P);var N=String(r.apply(void 0,R))}else N=b(I,f,E,D,P,r);E>=w&&(S+=f.slice(w,E)+N,w=E+I.length)}return S+f.slice(w)}];function b(e,n,r,i,a,s){var l=r+e.length,c=i.length,u=m;return void 0!==a&&(a=o(a),u=h),t.call(s,u,(function(t,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,r);case"'":return n.slice(l);case"<":s=a[o.slice(1,-1)];break;default:var u=+o;if(0===u)return t;if(u>c){var d=f(u/10);return 0===d?t:d<=c?void 0===i[d-1]?o.charAt(1):i[d-1]+o.charAt(1):t}s=i[u-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._items={},this._nullItems=[]}return e.prototype.copy=function(){var t=new e;for(var n in this._items)t._items[n]=this._items[n].slice(0);return t._nullItems=this._nullItems.slice(0),t},e.prototype.get=function(e,t){var n=null===t?this._nullItems:this._items[t]||null;if(null===n)return null;for(var r=null,i=0;i<n.length;i++)if((r=n[i])===e)return r;return r},e.prototype.has=function(e,t){var n=null===t?this._nullItems:this._items[t]||null;return null!==n&&-1!==n.indexOf(e)},e.prototype.hasPrefix=function(e){if(-1!==this._nullItems.indexOf(e))return!0;for(var t in this._items)if(-1!==this._items[t].indexOf(e))return!0;return!1},e.prototype.set=function(e,t){var n=null===t?this._nullItems:this._items[t]||null;null!==t&&null===n?this._items[t]=[e]:n.push(e)},e}();t.NamespacePrefixMap=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Surrogate=/[\uD800-\uDFFF]/,t.ScalarValue=/[\uD800-\uDFFF]/,t.NonCharacter=/[\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]/,t.ASCIICodePoint=/[\u0000-\u007F]/,t.ASCIITabOrNewLine=/[\t\n\r]/,t.ASCIIWhiteSpace=/[\t\n\f\r ]/,t.C0Control=/[\u0000-\u001F]/,t.C0ControlOrSpace=/[\u0000-\u001F ]/,t.Control=/[\u0000-\u001F\u007F-\u009F]/,t.ASCIIDigit=/[0-9]/,t.ASCIIUpperHexDigit=/[0-9A-F]/,t.ASCIILowerHexDigit=/[0-9a-f]/,t.ASCIIHexDigit=/[0-9A-Fa-f]/,t.ASCIIUpperAlpha=/[A-Z]/,t.ASCIILowerAlpha=/[a-z]/,t.ASCIIAlpha=/[A-Za-z]/,t.ASCIIAlphanumeric=/[0-9A-Za-z]/},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),s=n(2),l=n(3),c=n(171),u=n(104),d=n(9),p=n(17),f=n(72),h=n(30);function m(e,t){void 0===t&&(t=void 0),void 0===t&&(t=null);var n=g(e,t,new Date,{});return n._isTrusted=!0,n}function g(e,t,n,r){var i=new e("");return i._initializedFlag=!0,i._timeStamp=n.getTime(),Object.assign(i,r),a.dom.features.steps&&h.dom_runEventConstructingSteps(i),i}function v(e,t,n,i){var o,a,c,u;void 0===n&&(n=!1),void 0===i&&(i={value:!1});var d=!1;e._dispatchFlag=!0;var h=t;if(n){var m=t._associatedDocument;l.Guard.isDocumentNode(m)&&(h=m)}var g=null,v=p.tree_retarget(e._relatedTarget,t);if(t!==v||t===e._relatedTarget){var x=[];try{for(var A=r(e._touchTargetList),C=A.next();!C.done;C=A.next()){var T=C.value;x.push(p.tree_retarget(T,t))}}catch(e){o={error:e}}finally{try{C&&!C.done&&(a=A.return)&&a.call(A)}finally{if(o)throw o.error}}y(e,t,h,v,x,!1);var S=l.Guard.isMouseEvent(e)&&"click"===e._type;S&&void 0!==t._activationBehavior&&(g=t);for(var w=l.Guard.isSlotable(t)&&f.shadowTree_isAssigned(t)?t:null,_=!1,I=t._getTheParent(e);null!==I&&l.Guard.isNode(I);){if(null!==w){if(!l.Guard.isSlot(I))throw new Error("Parent node of a slotable should be a slot.");w=null;var E=p.tree_rootNode(I,!0);l.Guard.isShadowRoot(E)&&"closed"===E._mode&&(_=!0)}l.Guard.isSlotable(I)&&f.shadowTree_isAssigned(I)&&(w=I),v=p.tree_retarget(e._relatedTarget,I),x=[];try{for(var D=(c=void 0,r(e._touchTargetList)),O=D.next();!O.done;O=D.next())T=O.value,x.push(p.tree_retarget(T,I))}catch(e){c={error:e}}finally{try{O&&!O.done&&(u=D.return)&&u.call(D)}finally{if(c)throw c.error}}l.Guard.isWindow(I)||l.Guard.isNode(I)&&l.Guard.isNode(t)&&p.tree_isAncestorOf(p.tree_rootNode(t,!0),I,!0,!0)?(S&&e._bubbles&&null===g&&I._activationBehavior&&(g=I),y(e,I,null,v,x,_)):I===v?I=null:(t=I,S&&null===g&&t._activationBehavior&&(g=t),y(e,I,t,v,x,_)),null!==I&&(I=I._getTheParent(e)),_=!1}for(var P=null,R=e._path,N=R.length-1;N>=0;N--)if(null!==(L=R[N]).shadowAdjustedTarget){P=L;break}if(null!==P)if(l.Guard.isNode(P.shadowAdjustedTarget)&&l.Guard.isShadowRoot(p.tree_rootNode(P.shadowAdjustedTarget,!0)))d=!0;else if(l.Guard.isNode(P.relatedTarget)&&l.Guard.isShadowRoot(p.tree_rootNode(P.relatedTarget,!0)))d=!0;else for(var M=0;M<P.touchTargetList.length;M++){var L=P.touchTargetList[M];if(l.Guard.isNode(L)&&l.Guard.isShadowRoot(p.tree_rootNode(L,!0))){d=!0;break}}for(null!==g&&void 0!==g._legacyPreActivationBehavior&&g._legacyPreActivationBehavior(e),N=R.length-1;N>=0;N--)null!==(L=R[N]).shadowAdjustedTarget?e._eventPhase=s.EventPhase.AtTarget:e._eventPhase=s.EventPhase.Capturing,b(L,e,"capturing",i);for(N=0;N<R.length;N++){if(null!==(L=R[N]).shadowAdjustedTarget)e._eventPhase=s.EventPhase.AtTarget;else{if(!e._bubbles)continue;e._eventPhase=s.EventPhase.Bubbling}b(L,e,"bubbling",i)}}return e._eventPhase=s.EventPhase.None,e._currentTarget=null,e._path=[],e._dispatchFlag=!1,e._stopPropagationFlag=!1,e._stopImmediatePropagationFlag=!1,d&&(e._target=null,e._relatedTarget=null,e._touchTargetList=[]),null!==g&&(e._canceledFlag||void 0===g._activationBehavior?void 0!==g._legacyCanceledActivationBehavior&&g._legacyCanceledActivationBehavior(e):g._activationBehavior(e)),!e._canceledFlag}function y(e,t,n,r,i,o){var a=!1;l.Guard.isNode(t)&&l.Guard.isShadowRoot(p.tree_rootNode(t))&&(a=!0);var s=!1;l.Guard.isShadowRoot(t)&&"closed"===t._mode&&(s=!0),e._path.push({invocationTarget:t,invocationTargetInShadowTree:a,shadowAdjustedTarget:n,relatedTarget:r,touchTargetList:i,rootOfClosedTree:s,slotInClosedTree:o})}function b(e,t,n,r){void 0===r&&(r={value:!1});for(var i=t._path,a=-1,s=0;s<i.length;s++)if(i[s]===e){a=s;break}if(-1!==a){var l=i[a];(null!==l.shadowAdjustedTarget||a>0&&null!==(l=i[a-1]).shadowAdjustedTarget)&&(t._target=l.shadowAdjustedTarget)}if(t._relatedTarget=e.relatedTarget,t._touchTargetList=e.touchTargetList,!t._stopPropagationFlag){t._currentTarget=e.invocationTarget;var c=t._currentTarget._eventListenerList,u=new(Array.bind.apply(Array,o([void 0],c)));if(!x(t,u,n,e,r)&&t._isTrusted){var d=t._type;"animationend"===d?t._type="webkitAnimationEnd":"animationiteration"===d?t._type="webkitAnimationIteration":"animationstart"===d?t._type="webkitAnimationStart":"transitionend"===d&&(t._type="webkitTransitionEnd"),x(t,u,n,e,r),t._type=d}}}function x(e,t,n,r,i){void 0===i&&(i={value:!1});for(var o=!1,a=0;a<t.length;a++){var s=t[a];if(!s.removed){if(e._type!==s.type)continue;if(o=!0,"capturing"===n&&!s.capture)continue;if("bubbling"===n&&s.capture)continue;if(s.once&&null!==e._currentTarget){for(var c=e._currentTarget,u=-1,d=0;d<c._eventListenerList.length;d++)if(c._eventListenerList[d]===s){u=d;break}-1!==u&&c._eventListenerList.splice(u,1)}var p=void 0,f=void 0;l.Guard.isWindow(p)&&(f=p._currentEvent,!1===r.invocationTargetInShadowTree&&(p._currentEvent=e)),s.passive&&(e._inPassiveListenerFlag=!0);try{s.callback.handleEvent.call(e._currentTarget,e)}catch(e){i.value=!0}if(s.passive&&(e._inPassiveListenerFlag=!1),l.Guard.isWindow(p)&&(p._currentEvent=f),e._stopImmediatePropagationFlag)return o}}return o}function A(e,t){return null}function C(e,t){return null}function T(e,t){}function S(e,t){}t.event_setTheCanceledFlag=function(e){e._cancelable&&!e._inPassiveListenerFlag&&(e._canceledFlag=!0)},t.event_initialize=function(e,t,n,r){e._initializedFlag=!0,e._stopPropagationFlag=!1,e._stopImmediatePropagationFlag=!1,e._canceledFlag=!1,e._isTrusted=!1,e._target=null,e._type=t,e._bubbles=n,e._cancelable=r},t.event_createAnEvent=m,t.event_innerEventCreationSteps=g,t.event_dispatch=v,t.event_appendToAnEventPath=y,t.event_invoke=b,t.event_innerInvoke=x,t.event_fireAnEvent=function(e,t,n,r,i){void 0===n&&(n=u.EventImpl);var o=m(n);if(o._type=e,r)for(var a in r)o[a]=r[a];return v(o,t,i)},t.event_createLegacyEvent=function(e){var t=null;switch(e.toLowerCase()){case"beforeunloadevent":case"compositionevent":case"devicemotionevent":case"deviceorientationevent":case"dragevent":break;case"customevent":t=c.CustomEventImpl;break;case"event":case"events":t=u.EventImpl}if(null===t)throw new d.NotSupportedError("Event constructor not found for interface "+e+".");var n=new t("");return n._type="",n._timeStamp=(new Date).getTime(),n._isTrusted=!1,n._initializedFlag=!1,n},t.event_getterEventHandlerIDLAttribute=function(e,t){return null},t.event_setterEventHandlerIDLAttribute=function(e,t,n){},t.event_determineTheTargetOfAnEventHandler=A,t.event_getTheCurrentValueOfAnEventHandler=C,t.event_activateAnEventHandler=T,t.event_deactivateAnEventHandler=S},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),l=n(2),c=n(9),u=n(34),d=n(3),p=n(1),f=n(7),h=n(152),m=n(0),g=n(12),v=function(e){function t(){var t=e.call(this)||this;return t._children=new Set,t._encoding={name:"UTF-8",labels:["unicode-1-1-utf-8","utf-8","utf8"]},t._contentType="application/xml",t._URL={scheme:"about",username:"",password:"",host:null,port:null,path:["blank"],query:null,fragment:null,_cannotBeABaseURLFlag:!0,_blobURLEntry:null},t._origin=null,t._type="xml",t._mode="no-quirks",t._documentElement=null,t._hasNamespaces=!1,t._nodeDocumentOverwrite=null,t}return i(t,e),Object.defineProperty(t.prototype,"_nodeDocument",{get:function(){return this._nodeDocumentOverwrite||this},set:function(e){this._nodeDocumentOverwrite=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this._implementation||(this._implementation=m.create_domImplementation(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"URL",{get:function(){return h.urlSerializer(this._URL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentURI",{get:function(){return this.URL},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"origin",{get:function(){return"null"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"compatMode",{get:function(){return"quirks"===this._mode?"BackCompat":"CSS1Compat"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"characterSet",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"charset",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputEncoding",{get:function(){return this._encoding.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return this._contentType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"doctype",{get:function(){var e,t;try{for(var n=o(this._children),r=n.next();!r.done;r=n.next()){var i=r.value;if(d.Guard.isDocumentTypeNode(i))return i}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentElement",{get:function(){return this._documentElement},enumerable:!0,configurable:!0}),t.prototype.getElementsByTagName=function(e){return m.node_listOfElementsWithQualifiedName(e,this)},t.prototype.getElementsByTagNameNS=function(e,t){return m.node_listOfElementsWithNamespace(e,t,this)},t.prototype.getElementsByClassName=function(e){return m.node_listOfElementsWithClassNames(e,this)},t.prototype.createElement=function(e,t){if(!m.xml_isName(e))throw new c.InvalidCharacterError;"html"===this._type&&(e=e.toLowerCase());var n=null;void 0!==t&&(n=p.isString(t)?t:t.is);var r="html"===this._type||"application/xhtml+xml"===this._contentType?f.namespace.HTML:null;return m.element_createAnElement(this,e,r,null,n,!0)},t.prototype.createElementNS=function(e,t,n){return m.document_internalCreateElementNS(this,e,t,n)},t.prototype.createDocumentFragment=function(){return m.create_documentFragment(this)},t.prototype.createTextNode=function(e){return m.create_text(this,e)},t.prototype.createCDATASection=function(e){if("html"===this._type)throw new c.NotSupportedError;if(-1!==e.indexOf("]]>"))throw new c.InvalidCharacterError;return m.create_cdataSection(this,e)},t.prototype.createComment=function(e){return m.create_comment(this,e)},t.prototype.createProcessingInstruction=function(e,t){if(!m.xml_isName(e))throw new c.InvalidCharacterError;if(-1!==t.indexOf("?>"))throw new c.InvalidCharacterError;return m.create_processingInstruction(this,e,t)},t.prototype.importNode=function(e,t){if(void 0===t&&(t=!1),d.Guard.isDocumentNode(e)||d.Guard.isShadowRoot(e))throw new c.NotSupportedError;return m.node_clone(e,this,t)},t.prototype.adoptNode=function(e){if(d.Guard.isDocumentNode(e))throw new c.NotSupportedError;if(d.Guard.isShadowRoot(e))throw new c.HierarchyRequestError;return m.document_adopt(e,this),e},t.prototype.createAttribute=function(e){if(!m.xml_isName(e))throw new c.InvalidCharacterError;return"html"===this._type&&(e=e.toLowerCase()),m.create_attr(this,e)},t.prototype.createAttributeNS=function(e,t){var n=a(m.namespace_validateAndExtract(e,t),3),r=n[0],i=n[1],o=n[2],s=m.create_attr(this,o);return s._namespace=r,s._namespacePrefix=i,s},t.prototype.createEvent=function(e){return m.event_createLegacyEvent(e)},t.prototype.createRange=function(){var e=m.create_range();return e._start=[this,0],e._end=[this,0],e},t.prototype.createNodeIterator=function(e,t,n){void 0===t&&(t=l.WhatToShow.All),void 0===n&&(n=null);var r=m.create_nodeIterator(e,e,!0);return r._whatToShow=t,r._iteratorCollection=m.create_nodeList(e),p.isFunction(n)?(r._filter=m.create_nodeFilter(),r._filter.acceptNode=n):r._filter=n,r},t.prototype.createTreeWalker=function(e,t,n){void 0===t&&(t=l.WhatToShow.All),void 0===n&&(n=null);var r=m.create_treeWalker(e,e);return r._whatToShow=t,p.isFunction(n)?(r._filter=m.create_nodeFilter(),r._filter.acceptNode=n):r._filter=n,r},t.prototype._getTheParent=function(e){return"load"===e._type?null:s.dom.window},t.prototype.getElementById=function(e){throw new Error("Mixin: NonElementParentNode not implemented.")},Object.defineProperty(t.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),t.prototype.prepend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ParentNode not implemented.")},t.prototype.append=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ParentNode not implemented.")},t.prototype.querySelector=function(e){throw new Error("Mixin: ParentNode not implemented.")},t.prototype.querySelectorAll=function(e){throw new Error("Mixin: ParentNode not implemented.")},t}(u.NodeImpl);t.DocumentImpl=v,g.idl_defineConst(v.prototype,"_nodeType",l.NodeType.Document)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),l=n(34),c=n(9),u=n(7),d=n(0),p=n(12),f=function(e){function t(){var t=e.call(this)||this;return t._children=new Set,t._namespace=null,t._namespacePrefix=null,t._localName="",t._customElementState="undefined",t._customElementDefinition=null,t._is=null,t._shadowRoot=null,t._attributeList=d.create_namedNodeMap(t),t._attributeChangeSteps=[],t._name="",t._assignedSlot=null,t}return i(t,e),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prefix",{get:function(){return this._namespacePrefix},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localName",{get:function(){return this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this._htmlUppercasedQualifiedName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return d.element_getAnAttributeValue(this,"id")},set:function(e){d.element_setAnAttributeValue(this,"id",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return d.element_getAnAttributeValue(this,"class")},set:function(e){d.element_setAnAttributeValue(this,"class",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classList",{get:function(){var e=d.element_getAnAttributeByName("class",this);return null===e&&(e=d.create_attr(this._nodeDocument,"class")),d.create_domTokenList(this,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"slot",{get:function(){return d.element_getAnAttributeValue(this,"slot")},set:function(e){d.element_setAnAttributeValue(this,"slot",e)},enumerable:!0,configurable:!0}),t.prototype.hasAttributes=function(){return 0!==this._attributeList.length},Object.defineProperty(t.prototype,"attributes",{get:function(){return this._attributeList},enumerable:!0,configurable:!0}),t.prototype.getAttributeNames=function(){var e,t,n=[];try{for(var r=o(this._attributeList),i=r.next();!i.done;i=r.next()){var a=i.value;n.push(a._qualifiedName)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},t.prototype.getAttribute=function(e){var t=d.element_getAnAttributeByName(e,this);return t?t._value:null},t.prototype.getAttributeNS=function(e,t){var n=d.element_getAnAttributeByNamespaceAndLocalName(e,t,this);return n?n._value:null},t.prototype.setAttribute=function(e,t){if(!d.xml_isName(e))throw new c.InvalidCharacterError;this._namespace===u.namespace.HTML&&"html"===this._nodeDocument._type&&(e=e.toLowerCase());for(var n=null,r=0;r<this._attributeList.length;r++){var i=this._attributeList[r];if(i._qualifiedName===e){n=i;break}}if(null===n)return(n=d.create_attr(this._nodeDocument,e))._value=t,void d.element_append(n,this);d.element_change(n,this,t)},t.prototype.setAttributeNS=function(e,t,n){var r=a(d.namespace_validateAndExtract(e,t),3),i=r[0],o=r[1],s=r[2];d.element_setAnAttributeValue(this,s,n,o,i)},t.prototype.removeAttribute=function(e){d.element_removeAnAttributeByName(e,this)},t.prototype.removeAttributeNS=function(e,t){d.element_removeAnAttributeByNamespaceAndLocalName(e,t,this)},t.prototype.hasAttribute=function(e){this._namespace===u.namespace.HTML&&"html"===this._nodeDocument._type&&(e=e.toLowerCase());for(var t=0;t<this._attributeList.length;t++)if(this._attributeList[t]._qualifiedName===e)return!0;return!1},t.prototype.toggleAttribute=function(e,t){if(!d.xml_isName(e))throw new c.InvalidCharacterError;this._namespace===u.namespace.HTML&&"html"===this._nodeDocument._type&&(e=e.toLowerCase());for(var n=null,r=0;r<this._attributeList.length;r++){var i=this._attributeList[r];if(i._qualifiedName===e){n=i;break}}return null===n?(void 0===t||!0===t)&&((n=d.create_attr(this._nodeDocument,e))._value="",d.element_append(n,this),!0):void 0!==t&&!1!==t||(d.element_removeAnAttributeByName(e,this),!1)},t.prototype.hasAttributeNS=function(e,t){for(var n=e||null,r=0;r<this._attributeList.length;r++){var i=this._attributeList[r];if(i._namespace===n&&i._localName===t)return!0}return!1},t.prototype.getAttributeNode=function(e){return d.element_getAnAttributeByName(e,this)},t.prototype.getAttributeNodeNS=function(e,t){return d.element_getAnAttributeByNamespaceAndLocalName(e,t,this)},t.prototype.setAttributeNode=function(e){return d.element_setAnAttribute(e,this)},t.prototype.setAttributeNodeNS=function(e){return d.element_setAnAttribute(e,this)},t.prototype.removeAttributeNode=function(e){for(var t=!1,n=0;n<this._attributeList.length;n++)if(this._attributeList[n]===e){t=!0;break}if(!t)throw new c.NotFoundError;return d.element_remove(e,this),e},t.prototype.attachShadow=function(e){if(this._namespace!==u.namespace.HTML)throw new c.NotSupportedError;if(!d.customElement_isValidCustomElementName(this._localName)&&!d.customElement_isValidShadowHostName(this._localName))throw new c.NotSupportedError;if(d.customElement_isValidCustomElementName(this._localName)||null!==this._is){var t=d.customElement_lookUpACustomElementDefinition(this._nodeDocument,this._namespace,this._localName,this._is);if(null!==t&&!0===t.disableShadow)throw new c.NotSupportedError}if(null!==this._shadowRoot)throw new c.NotSupportedError;var n=d.create_shadowRoot(this._nodeDocument,this);return n._mode=e.mode,this._shadowRoot=n,n},Object.defineProperty(t.prototype,"shadowRoot",{get:function(){var e=this._shadowRoot;return null===e||"closed"===e.mode?null:e},enumerable:!0,configurable:!0}),t.prototype.closest=function(e){throw new c.NotImplementedError},t.prototype.matches=function(e){throw new c.NotImplementedError},t.prototype.webkitMatchesSelector=function(e){return this.matches(e)},t.prototype.getElementsByTagName=function(e){return d.node_listOfElementsWithQualifiedName(e,this)},t.prototype.getElementsByTagNameNS=function(e,t){return d.node_listOfElementsWithNamespace(e,t,this)},t.prototype.getElementsByClassName=function(e){return d.node_listOfElementsWithClassNames(e,this)},t.prototype.insertAdjacentElement=function(e,t){return d.element_insertAdjacent(this,e,t)},t.prototype.insertAdjacentText=function(e,t){var n=d.create_text(this._nodeDocument,t);d.element_insertAdjacent(this,e,n)},Object.defineProperty(t.prototype,"_qualifiedName",{get:function(){return this._namespacePrefix?this._namespacePrefix+":"+this._localName:this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_htmlUppercasedQualifiedName",{get:function(){var e=this._qualifiedName;return this._namespace===u.namespace.HTML&&"html"===this._nodeDocument._type&&(e=e.toUpperCase()),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),t.prototype.prepend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ParentNode not implemented.")},t.prototype.append=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ParentNode not implemented.")},t.prototype.querySelector=function(e){throw new Error("Mixin: ParentNode not implemented.")},t.prototype.querySelectorAll=function(e){throw new Error("Mixin: ParentNode not implemented.")},Object.defineProperty(t.prototype,"previousElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextElementSibling",{get:function(){throw new Error("Mixin: NonDocumentTypeChildNode not implemented.")},enumerable:!0,configurable:!0}),t.prototype.before=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.after=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.replaceWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},Object.defineProperty(t.prototype,"assignedSlot",{get:function(){throw new Error("Mixin: Slotable not implemented.")},enumerable:!0,configurable:!0}),t._create=function(e,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var o=new t;return o._localName=n,o._namespace=r,o._namespacePrefix=i,o._nodeDocument=e,o},t}(l.NodeImpl);t.ElementImpl=f,p.idl_defineConst(f.prototype,"_nodeType",s.NodeType.Element)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(34),s=n(12),l=function(e){function t(t){void 0===t&&(t=null);var n=e.call(this)||this;return n._children=new Set,n._host=t,n}return i(t,e),t.prototype.getElementById=function(e){throw new Error("Mixin: NonElementParentNode not implemented.")},Object.defineProperty(t.prototype,"children",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){throw new Error("Mixin: ParentNode not implemented.")},enumerable:!0,configurable:!0}),t.prototype.prepend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ParentNode not implemented.")},t.prototype.append=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ParentNode not implemented.")},t.prototype.querySelector=function(e){throw new Error("Mixin: ParentNode not implemented.")},t.prototype.querySelectorAll=function(e){throw new Error("Mixin: ParentNode not implemented.")},t._create=function(e,n){void 0===n&&(n=null);var r=new t(n);return r._nodeDocument=e,r},t}(a.NodeImpl);t.DocumentFragmentImpl=l,s.idl_defineConst(l.prototype,"_nodeType",o.NodeType.DocumentFragment)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),s=n(71),l=n(0),c=n(12),u=function(e){function t(t){void 0===t&&(t="");var n=e.call(this,t)||this;return n._name="",n._assignedSlot=null,n}return i(t,e),Object.defineProperty(t.prototype,"wholeText",{get:function(){var e,t,n="";try{for(var r=o(l.text_contiguousTextNodes(this,!0)),i=r.next();!i.done;i=r.next())n+=i.value._data}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),t.prototype.splitText=function(e){return l.text_split(this,e)},Object.defineProperty(t.prototype,"assignedSlot",{get:function(){throw new Error("Mixin: Slotable not implemented.")},enumerable:!0,configurable:!0}),t._create=function(e,n){void 0===n&&(n="");var r=new t(n);return r._nodeDocument=e,r},t}(s.CharacterDataImpl);t.TextImpl=u,c.idl_defineConst(u.prototype,"_nodeType",a.NodeType.Text)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e.prototype,"_startNode",{get:function(){return this._start[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_startOffset",{get:function(){return this._start[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_endNode",{get:function(){return this._end[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_endOffset",{get:function(){return this._end[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_collapsed",{get:function(){return this._start[0]===this._end[0]&&this._start[1]===this._end[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startContainer",{get:function(){return this._startNode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startOffset",{get:function(){return this._startOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endContainer",{get:function(){return this._endNode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endOffset",{get:function(){return this._endOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collapsed",{get:function(){return this._collapsed},enumerable:!0,configurable:!0}),e}();t.AbstractRangeImpl=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(){function e(e){this._activeFlag=!1,this._root=e,this._whatToShow=r.WhatToShow.All,this._filter=null}return Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"whatToShow",{get:function(){return this._whatToShow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),e}();t.TraverserImpl=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0),o=n(12),a=function(){function e(e,t){this._target=null,this._relatedTarget=null,this._touchTargetList=[],this._path=[],this._currentTarget=null,this._eventPhase=r.EventPhase.None,this._stopPropagationFlag=!1,this._stopImmediatePropagationFlag=!1,this._canceledFlag=!1,this._inPassiveListenerFlag=!1,this._composedFlag=!1,this._initializedFlag=!1,this._dispatchFlag=!1,this._isTrusted=!1,this._bubbles=!1,this._cancelable=!1,this._type=e,t&&(this._bubbles=t.bubbles||!1,this._cancelable=t.cancelable||!1,this._composedFlag=t.composed||!1),this._initializedFlag=!0,this._timeStamp=(new Date).getTime()}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"srcElement",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this._currentTarget},enumerable:!0,configurable:!0}),e.prototype.composedPath=function(){var e=[],t=this._path;if(0===t.length)return e;var n=this._currentTarget;if(null===n)throw new Error("Event currentTarget is null.");e.push(n);for(var r=0,i=0,o=t.length-1;o>=0;){if(t[o].rootOfClosedTree&&i++,t[o].invocationTarget===n){r=o;break}t[o].slotInClosedTree&&i--,o--}var a=i,s=i;for(o=r-1;o>=0;)t[o].rootOfClosedTree&&a++,a<=s&&e.unshift(t[o].invocationTarget),t[o].slotInClosedTree&&--a<s&&(s=a),o--;for(a=i,s=i,o=r+1;o<t.length;)t[o].slotInClosedTree&&a++,a<=s&&e.push(t[o].invocationTarget),t[o].rootOfClosedTree&&--a<s&&(s=a),o++;return e},Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this._eventPhase},enumerable:!0,configurable:!0}),e.prototype.stopPropagation=function(){this._stopPropagationFlag=!0},Object.defineProperty(e.prototype,"cancelBubble",{get:function(){return this._stopPropagationFlag},set:function(e){e&&this.stopPropagation()},enumerable:!0,configurable:!0}),e.prototype.stopImmediatePropagation=function(){this._stopPropagationFlag=!0,this._stopImmediatePropagationFlag=!0},Object.defineProperty(e.prototype,"bubbles",{get:function(){return this._bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this._cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"returnValue",{get:function(){return!this._canceledFlag},set:function(e){e||i.event_setTheCanceledFlag(this)},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){i.event_setTheCanceledFlag(this)},Object.defineProperty(e.prototype,"defaultPrevented",{get:function(){return this._canceledFlag},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"composed",{get:function(){return this._composedFlag},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTrusted",{get:function(){return this._isTrusted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeStamp",{get:function(){return this._timeStamp},enumerable:!0,configurable:!0}),e.prototype.initEvent=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this._dispatchFlag||i.event_initialize(this,e,t,n)},e.NONE=0,e.CAPTURING_PHASE=1,e.AT_TARGET=2,e.BUBBLING_PHASE=3,e}();t.EventImpl=a,o.idl_defineConst(a.prototype,"NONE",0),o.idl_defineConst(a.prototype,"CAPTURING_PHASE",1),o.idl_defineConst(a.prototype,"AT_TARGET",2),o.idl_defineConst(a.prototype,"BUBBLING_PHASE",3)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(9);t.traversal_filter=function(e,t){if(e._activeFlag)throw new i.InvalidStateError;var n=1<<t._nodeType-1;if(!(e.whatToShow&n))return r.FilterResult.Skip;if(!e.filter)return r.FilterResult.Accept;e._activeFlag=!0;var o=r.FilterResult.Reject;try{o=e.filter.acceptNode(t)}catch(t){throw e._activeFlag=!1,t}return e._activeFlag=!1,o}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),a=n(3),s=n(1),l=n(99),c=n(73),u=n(17),d=n(173),p=n(30),f=n(52),h=n(37);t.document_elementInterface=function(e,t){return l.ElementImpl},t.document_internalCreateElementNS=function(e,t,n,i){var o=r(d.namespace_validateAndExtract(t,n),3),a=o[0],l=o[1],c=o[2],u=null;return void 0!==i&&(u=s.isString(i)?i:i.is),f.element_createAnElement(e,c,a,l,u,!0)},t.document_adopt=function(e,t){var n,r;if(e._nodeDocument!==t||null!==e._parent){var s=e._nodeDocument;if(e._parent&&h.mutation_remove(e,e._parent),t!==s)for(var l=u.tree_getFirstDescendantNode(e,!0,!0);null!==l;){if(l._nodeDocument=t,a.Guard.isElementNode(l))try{for(var d=(n=void 0,i(l._attributeList._asArray())),f=d.next();!f.done;f=d.next())f.value._nodeDocument=t}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}o.dom.features.customElements&&a.Guard.isElementNode(l)&&"custom"===l._customElementState&&c.customElement_enqueueACustomElementCallbackReaction(l,"adoptedCallback",[s,t]),o.dom.features.steps&&p.dom_runAdoptingSteps(l,s),l=u.tree_getNextDescendantNode(e,l,!0,!0)}}}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(3),a=n(9),s=n(17),l=n(51),c=n(30);t.characterData_replaceData=function(e,t,n,u){var d,p,f=s.tree_nodeLength(e);if(t>f)throw new a.IndexSizeError("Offset exceeds character data length. Offset: "+t+", Length: "+f+", Node is "+e.nodeName+".");t+n>f&&(n=f-t),i.dom.features.mutationObservers&&l.observer_queueMutationRecord("characterData",e,null,null,e._data,[],[],null,null);var h=e._data.substring(0,t)+u+e._data.substring(t+n);e._data=h;try{for(var m=r(i.dom.rangeList),g=m.next();!g.done;g=m.next()){var v=g.value;v._start[0]===e&&v._start[1]>t&&v._start[1]<=t+n&&(v._start[1]=t),v._end[0]===e&&v._end[1]>t&&v._end[1]<=t+n&&(v._end[1]=t),v._start[0]===e&&v._start[1]>t+n&&(v._start[1]+=u.length-n),v._end[0]===e&&v._end[1]>t+n&&(v._end[1]+=u.length-n)}}catch(e){d={error:e}}finally{try{g&&!g.done&&(p=m.return)&&p.call(m)}finally{if(d)throw d.error}}i.dom.features.steps&&o.Guard.isTextNode(e)&&null!==e._parent&&c.dom_runChildTextContentChangeSteps(e._parent)},t.characterData_substringData=function(e,t,n){var r=s.tree_nodeLength(e);if(t>r)throw new a.IndexSizeError("Offset exceeds character data length. Offset: "+t+", Length: "+r+", Node is "+e.nodeName+".");return t+n>r?e._data.substr(t):e._data.substr(t,n)}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=n(7);function s(e){var t=a.string.splitAStringOnASCIIWhitespace(e);return new Set(t)}function l(e){return i(e).join(" ")}t.orderedSet_parse=s,t.orderedSet_serialize=l,t.orderedSet_sanitize=function(e){return l(s(e))},t.orderedSet_contains=function(e,t,n){var r,i,a,s;try{for(var l=o(t),c=l.next();!c.done;c=l.next()){var u=c.value,d=!1;try{for(var p=(a=void 0,o(e)),f=p.next();!f.done;f=p.next()){var h=f.value;if(n){if(h===u){d=!0;break}}else if(h.toUpperCase()===u.toUpperCase()){d=!0;break}}}catch(e){a={error:e}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}if(!d)return!1}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return!0}},function(e,t,n){"use strict";n(179),Object.defineProperty(t,"__esModule",{value:!0});var r=n(262),i=n(110),o=n(1);i.dom.setFeatures(!1),t.createDocument=function(){var e=(new r.DOMImplementation).createDocument(null,"root",null);return e.documentElement&&e.removeChild(e.documentElement),e},t.sanitizeInput=function(e,t){if(null==e)return e;if(void 0===t)return e+"";var n="";e+="";for(var r=0;r<e.length;r++){var i=e.charCodeAt(r);if(9===i||10===i||13===i||i>=32&&i<=55295||i>=57344&&i<=65533)n+=e.charAt(r);else if(i>=55296&&i<=56319&&r<e.length-1){var a=e.charCodeAt(r+1);a>=56320&&a<=57343?(i=1024*(i-55296)+a-56320+65536,n+=String.fromCodePoint(i),r++):n+=o.isString(t)?t:t(e.charAt(r),r,e)}else n+=o.isString(t)?t:t(e.charAt(r),r,e)}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(153);t.AbortController=i.AbortControllerImpl;var o=n(154);t.AbortSignal=o.AbortSignalImpl;var a=n(102);t.AbstractRange=a.AbstractRangeImpl;var s=n(157);t.Attr=s.AttrImpl;var l=n(158);t.CDATASection=l.CDATASectionImpl;var c=n(71);t.CharacterData=c.CharacterDataImpl;var u=n(263),d=n(159);t.Comment=d.CommentImpl;var p=n(171);t.CustomEvent=p.CustomEventImpl;var f=n(100);t.DocumentFragment=f.DocumentFragmentImpl;var h=n(98);t.Document=h.DocumentImpl;var m=n(264),g=n(155);t.DocumentType=g.DocumentTypeImpl;var v=n(6);t.dom=v.dom;var y=n(148);t.DOMImplementation=y.DOMImplementationImpl;var b=n(170);t.DOMTokenList=b.DOMTokenListImpl;var x=n(99);t.Element=x.ElementImpl;var A=n(104);t.Event=A.EventImpl;var C=n(70);t.EventTarget=C.EventTargetImpl;var T=n(161);t.HTMLCollection=T.HTMLCollectionImpl;var S=n(265);t.MutationObserver=S.MutationObserverImpl;var w=n(169);t.MutationRecord=w.MutationRecordImpl;var _=n(164);t.NamedNodeMap=_.NamedNodeMapImpl;var I=n(168);t.NodeFilter=I.NodeFilterImpl;var E=n(34);t.Node=E.NodeImpl;var D=n(166);t.NodeIterator=D.NodeIteratorImpl;var O=n(162);t.NodeList=O.NodeListImpl;var P=n(163);t.NodeListStatic=P.NodeListStaticImpl;var R=n(266),N=n(267),M=n(268),L=n(160);t.ProcessingInstruction=L.ProcessingInstructionImpl;var F=n(165);t.Range=F.RangeImpl;var B=n(156);t.ShadowRoot=B.ShadowRootImpl;var V=n(269),k=n(270);t.StaticRange=k.StaticRangeImpl;var U=n(101);t.Text=U.TextImpl;var G=n(103);t.Traverser=G.TraverserImpl;var z=n(167);t.TreeWalker=z.TreeWalkerImpl;var W=n(149);t.Window=W.WindowImpl;var j=n(151);t.XMLDocument=j.XMLDocumentImpl,r.applyMixin(x.ElementImpl,u.ChildNodeImpl),r.applyMixin(c.CharacterDataImpl,u.ChildNodeImpl),r.applyMixin(g.DocumentTypeImpl,u.ChildNodeImpl),r.applyMixin(h.DocumentImpl,m.DocumentOrShadowRootImpl),r.applyMixin(B.ShadowRootImpl,m.DocumentOrShadowRootImpl),r.applyMixin(x.ElementImpl,R.NonDocumentTypeChildNodeImpl),r.applyMixin(c.CharacterDataImpl,R.NonDocumentTypeChildNodeImpl),r.applyMixin(h.DocumentImpl,N.NonElementParentNodeImpl),r.applyMixin(f.DocumentFragmentImpl,N.NonElementParentNodeImpl),r.applyMixin(h.DocumentImpl,M.ParentNodeImpl),r.applyMixin(f.DocumentFragmentImpl,M.ParentNodeImpl),r.applyMixin(x.ElementImpl,M.ParentNodeImpl),r.applyMixin(U.TextImpl,V.SlotableImpl),r.applyMixin(x.ElementImpl,V.SlotableImpl)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.EOF=0]="EOF",e[e.Declaration=1]="Declaration",e[e.DocType=2]="DocType",e[e.Element=3]="Element",e[e.Text=4]="Text",e[e.CDATA=5]="CDATA",e[e.PI=6]="PI",e[e.Comment=7]="Comment",e[e.ClosingTag=8]="ClosingTag"}(t.TokenType||(t.TokenType={}))},function(e,t,n){"use strict";n(64),n(20),n(66);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._parse=function(e,t){var n=this,r=this._builderOptions,i=null;return o.isFunction(t)?i=this.parse(e,t.apply(this)):o.isArray(t)||o.isSet(t)?o.forEachArray(t,(function(t){return i=n.parse(e,t)}),this):o.isMap(t)||o.isObject(t)?o.forEachObject(t,(function(t,a){if(o.isFunction(a)&&(a=a.apply(n)),r.ignoreConverters||0!==t.indexOf(r.convert.att))if(r.ignoreConverters||0!==t.indexOf(r.convert.text))if(r.ignoreConverters||0!==t.indexOf(r.convert.cdata))if(r.ignoreConverters||0!==t.indexOf(r.convert.comment))if(r.ignoreConverters||0!==t.indexOf(r.convert.ins)){if((o.isArray(a)||o.isSet(a))&&o.isEmpty(a));else if((o.isMap(a)||o.isObject(a))&&o.isEmpty(a))i=n.element(e,void 0,n.sanitize(t))||i;else if(r.keepNullNodes||null!=a)if(o.isArray(a)||o.isSet(a))o.forEachArray(a,(function(r){var o={};o[t]=r,i=n.parse(e,o)}),n);else if(o.isMap(a)||o.isObject(a))(s=n.element(e,void 0,n.sanitize(t)))&&(i=s,n.parse(s,a));else if(null!=a&&""!==a){var s;(s=n.element(e,void 0,n.sanitize(t)))&&(i=s,n.text(s,n._decodeText(n.sanitize(a))))}else i=n.element(e,void 0,n.sanitize(t))||i}else if(o.isString(a)){var l=a.indexOf(" "),c=-1===l?a:a.substr(0,l),u=-1===l?"":a.substr(l+1);i=n.instruction(e,n.sanitize(c),n.sanitize(u))||i}else o.isArray(a)||o.isSet(a)?o.forEachArray(a,(function(t){var r=t.indexOf(" "),o=-1===r?t:t.substr(0,r),a=-1===r?"":t.substr(r+1);i=n.instruction(e,n.sanitize(o),n.sanitize(a))||i}),n):o.forEachObject(a,(function(t,r){return i=n.instruction(e,n.sanitize(t),n.sanitize(r))||i}),n);else o.isArray(a)||o.isSet(a)?o.forEachArray(a,(function(t){return i=n.comment(e,n.sanitize(t))||i}),n):i=n.comment(e,n.sanitize(a))||i;else o.isArray(a)||o.isSet(a)?o.forEachArray(a,(function(t){return i=n.cdata(e,n.sanitize(t))||i}),n):i=n.cdata(e,n.sanitize(a))||i;else i=o.isMap(a)||o.isObject(a)?n.parse(e,a):n.text(e,n._decodeText(n.sanitize(a)))||i;else if(t===r.convert.att){if(o.isArray(a)||o.isSet(a))throw new Error("Invalid attribute: "+a.toString()+". "+e._debugInfo());o.forEachObject(a,(function(t,r){i=n.attribute(e,void 0,n.sanitize(t),n._decodeAttributeValue(n.sanitize(r)))||i}))}else i=n.attribute(e,void 0,n.sanitize(t.substr(r.convert.att.length)),n._decodeAttributeValue(n.sanitize(a)))||i}),this):(r.keepNullNodes||null!=t)&&(i=this.text(e,this._decodeText(this.sanitize(t)))||i),i||e},t}(n(75).BaseReader);t.ObjectReader=a},function(e,t,n){"use strict";var r=n(39);e.exports=new r({explicit:[n(286),n(287),n(288)]})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.level=0,this._builderOptions=e,this._writerOptions=e};t.BaseCBWriter=r},function(e,t,n){var r=n(16),i=n(8),o=n(116);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(11),i=n(13),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(118),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},function(e,t,n){var r=n(11),i=n(80),o=r["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=o},function(e,t,n){var r=n(14),i=n(187),o=n(55),a=n(15);e.exports=function(e,t){for(var n=i(t),s=a.f,l=o.f,c=0;c<n.length;c++){var u=n[c];r(e,u)||s(e,u,l(t,u))}}},function(e,t,n){var r=n(11);e.exports=r},function(e,t,n){var r=n(14),i=n(24),o=n(122).indexOf,a=n(45);e.exports=function(e,t){var n,s=i(e),l=0,c=[];for(n in s)!r(a,n)&&r(s,n)&&c.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){var r=n(24),i=n(26),o=n(83),a=function(e){return function(t,n,a){var s,l=r(t),c=i(l.length),u=o(a,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var r=n(8),i=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==c||n!=l&&("function"==typeof t?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=o.data={},l=o.NATIVE="N",c=o.POLYFILL="P";e.exports=o},function(e,t,n){var r=n(86);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(5);t.f=r},function(e,t,n){var r=n(120),i=n(14),o=n(125),a=n(15).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||a(t,e,{value:o.f(e)})}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var r=n(13),i=n(59),o=n(5)("species");e.exports=function(e,t){var n;return i(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!i(n.prototype)?r(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t,n){var r,i,o=n(11),a=n(193),s=o.process,l=s&&s.versions,c=l&&l.v8;c?i=(r=c.split("."))[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=r[1]),e.exports=i&&+i},function(e,t,n){var r=n(5),i=n(60),o=n(15),a=r("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},function(e,t,n){"use strict";var r,i,o,a=n(132),s=n(21),l=n(14),c=n(5),u=n(44),d=c("iterator"),p=!1;[].keys&&("next"in(o=[].keys())?(i=a(a(o)))!==Object.prototype&&(r=i):p=!0),null==r&&(r={}),u||l(r,d)||s(r,d,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},function(e,t,n){var r=n(14),i=n(27),o=n(57),a=n(196),s=o("IE_PROTO"),l=Object.prototype;e.exports=a?Object.getPrototypeOf:function(e){return e=i(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},function(e,t,n){var r=n(18),i=n(197);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,o){return r(n),i(o),t?e.call(n,o):n.__proto__=o,n}}():void 0)},function(e,t,n){"use strict";var r=n(56),i=n(15),o=n(40);e.exports=function(e,t,n){var a=r(t);a in e?i.f(e,a,o(0,n)):e[a]=n}},function(e,t,n){var r=n(90),i=n(42),o=n(5)("toStringTag"),a="Arguments"==i(function(){return arguments}());e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:a?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},function(e,t,n){"use strict";var r=n(18);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var r=n(47),i=n(35),o=function(e){return function(t,n){var o,a,s=String(i(t)),l=r(n),c=s.length;return l<0||l>=c?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e,t,n){var r=n(4),i=n(27),o=n(61);r({target:"Object",stat:!0,forced:n(8)((function(){o(1)}))},{keys:function(e){return o(i(e))}})},function(e,t,n){"use strict";var r=n(4),i=n(11),o=n(123),a=n(25),s=n(140),l=n(141),c=n(142),u=n(13),d=n(8),p=n(208),f=n(62),h=n(209);e.exports=function(e,t,n){var m=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),v=m?"set":"add",y=i[e],b=y&&y.prototype,x=y,A={},C=function(e){var t=b[e];a(b,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(o(e,"function"!=typeof y||!(g||b.forEach&&!d((function(){(new y).entries().next()})))))x=n.getConstructor(t,e,m,v),s.REQUIRED=!0;else if(o(e,!0)){var T=new x,S=T[v](g?{}:-0,1)!=T,w=d((function(){T.has(1)})),_=p((function(e){new y(e)})),I=!g&&d((function(){for(var e=new y,t=5;t--;)e[v](t,t);return!e.has(-0)}));_||((x=t((function(t,n){c(t,x,e);var r=h(new y,t,x);return null!=n&&l(n,r[v],r,m),r}))).prototype=b,b.constructor=x),(w||I)&&(C("delete"),C("has"),m&&C("get")),(I||S)&&C(v),g&&b.clear&&delete b.clear}return A[e]=x,r({global:!0,forced:x!=y},A),f(x,e),g||n.setStrong(x,e,m),x}},function(e,t,n){var r=n(45),i=n(13),o=n(14),a=n(15).f,s=n(58),l=n(204),c=s("meta"),u=0,d=Object.isExtensible||function(){return!0},p=function(e){a(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},f=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,c)){if(!d(e))return"F";if(!t)return"E";p(e)}return e[c].objectID},getWeakData:function(e,t){if(!o(e,c)){if(!d(e))return!0;if(!t)return!1;p(e)}return e[c].weakData},onFreeze:function(e){return l&&f.REQUIRED&&d(e)&&!o(e,c)&&p(e),e}};r[c]=!0},function(e,t,n){var r=n(18),i=n(205),o=n(26),a=n(87),s=n(206),l=n(207),c=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,n,u,d){var p,f,h,m,g,v,y,b=a(t,n,u?2:1);if(d)p=e;else{if("function"!=typeof(f=s(e)))throw TypeError("Target is not iterable");if(i(f)){for(h=0,m=o(e.length);m>h;h++)if((g=u?b(r(y=e[h])[0],y[1]):b(e[h]))&&g instanceof c)return g;return new c(!1)}p=f.call(e)}for(v=p.next;!(y=v.call(p)).done;)if("object"==typeof(g=l(p,b,y.value,u))&&g&&g instanceof c)return g;return new c(!1)}).stop=function(e){return new c(!0,e)}},function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},function(e,t,n){"use strict";var r=n(15).f,i=n(60),o=n(210),a=n(87),s=n(142),l=n(141),c=n(88),u=n(211),d=n(16),p=n(140).fastKey,f=n(43),h=f.set,m=f.getterFor;e.exports={getConstructor:function(e,t,n,c){var u=e((function(e,r){s(e,u,t),h(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),null!=r&&l(r,e[c],e,n)})),f=m(t),g=function(e,t,n){var r,i,o=f(e),a=v(e,t);return a?a.value=n:(o.last=a={index:i=p(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),d?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},v=function(e,t){var n,r=f(e),i=p(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(u.prototype,{clear:function(){for(var e=f(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,d?e.size=0:this.size=0},delete:function(e){var t=f(this),n=v(this,e);if(n){var r=n.next,i=n.previous;delete t.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),t.first==n&&(t.first=r),t.last==n&&(t.last=i),d?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=f(this),r=a(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!v(this,e)}}),o(u.prototype,n?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),d&&r(u.prototype,"size",{get:function(){return f(this).size}}),u},setStrong:function(e,t,n){var r=t+" Iterator",i=m(t),o=m(r);c(e,t,(function(e,t){h(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(t)}}},function(e,t,n){"use strict";var r,i=n(4),o=n(55).f,a=n(26),s=n(222),l=n(35),c=n(224),u=n(44),d="".endsWith,p=Math.min,f=c("endsWith");i({target:"String",proto:!0,forced:!(!u&&!f&&(r=o(String.prototype,"endsWith"),r&&!r.writable)||f)},{endsWith:function(e){var t=String(l(this));s(e);var n=arguments.length>1?arguments[1]:void 0,r=a(t.length),i=void 0===n?r:p(a(n),r),o=String(e);return d?d.call(t,o,i):t.slice(i-o.length,i)===o}})},function(e,t,n){"use strict";(function(e){var r=n(229),i=n(230),o=n(231);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=p(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n),i=(e=s(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):p(e,t);if("Buffer"===t.type&&o(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=s(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return D(this,t,n);case"utf8":case"utf-8":return _(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return E(this,t,n);case"base64":return w(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var u=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var d=!0,p=0;p<l;p++)if(c(e,o+p)!==c(t,p)){d=!1;break}if(d)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function x(e,t,n,r){return z(U(t,e.length-n),e,n,r)}function A(e,t,n,r){return z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function C(e,t,n,r){return A(e,t,n,r)}function T(e,t,n,r){return z(G(t),e,n,r)}function S(e,t,n,r){return z(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function w(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function _(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,l,c=e[i],u=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function D(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=k(e[o]);return i}function O(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function N(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function M(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function L(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,o){return o||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,o){return o||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},l.byteLength=h,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?_(this,0,e):m.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(r,i),u=e.slice(t,n),d=0;d<s;++d)if(c[d]!==u[d]){o=c[d],a=u[d];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return x(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return C(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;n=new l(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a|0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=l.isBuffer(e)?e:U(new l(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function k(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(78))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isASCIIByte=function(e){return e>=0&&e<=127}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.length=function(e){return e.length},t.byteLowercase=function(e){for(var t=0;t<e.length;t++){var n=e[t];n>=65&&n<=90&&(e[t]=n+32)}},t.byteUppercase=function(e){for(var t=0;t<e.length;t++){var n=e[t];n>=97&&n<=122&&(e[t]=n-32)}},t.byteCaseInsensitiveMatch=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var r=e[n],i=t[n];if(r>=65&&r<=90&&(r+=32),i>=65&&i<=90&&(i+=32),r!==i)return!1}return!0},t.startsWith=function(e,t){for(var n=0;;){if(n>=e.length)return!1;if(n>=t.length)return!0;if(e[n]!==t[n])return!1;n++}},t.byteLessThan=function(e,t){for(var n=0;;){if(n>=e.length)return!1;if(n>=t.length)return!0;var r=e[n],i=t[n];if(r<i)return!0;if(r>i)return!1;n++}},t.isomorphicDecode=function(e){return String.fromCodePoint.apply(String,i(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(7),o=n(0),a=n(12),s=function(){function e(e){this._associatedDocument=e||r.dom.window.document}return e.prototype.createDocumentType=function(e,t,n){return o.namespace_validate(e),o.create_documentType(this._associatedDocument,e,t,n)},e.prototype.createDocument=function(e,t,n){void 0===n&&(n=null);var r=o.create_xmlDocument(),a=null;return t&&(a=o.document_internalCreateElementNS(r,e,t)),n&&r.appendChild(n),a&&r.appendChild(a),r._origin=this._associatedDocument._origin,e===i.namespace.HTML?r._contentType="application/xhtml+xml":e===i.namespace.SVG?r._contentType="image/svg+xml":r._contentType="application/xml",r},e.prototype.createHTMLDocument=function(e){var t=o.create_document();t._type="html",t._contentType="text/html",t.appendChild(o.create_documentType(t,"html","",""));var n=o.element_createAnElement(t,"html",i.namespace.HTML);t.appendChild(n);var r=o.element_createAnElement(t,"head",i.namespace.HTML);if(n.appendChild(r),void 0!==e){var a=o.element_createAnElement(t,"title",i.namespace.HTML);r.appendChild(a);var s=o.create_text(t,e);a.appendChild(s)}var l=o.element_createAnElement(t,"body",i.namespace.HTML);return n.appendChild(l),t._origin=this._associatedDocument._origin,t},e.prototype.hasFeature=function(){return!0},e._create=function(t){return new e(t)},e}();t.DOMImplementationImpl=s,a.idl_defineConst(s.prototype,"_ID","@oozcitak/dom")},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(70),a=n(1),s=n(0),l=function(e){function t(){var t=e.call(this)||this;return t._signalSlots=new Set,t._mutationObserverMicrotaskQueued=!1,t._mutationObservers=new Set,t._iteratorList=new a.FixedSizeSet,t._associatedDocument=s.create_document(),t}return i(t,e),Object.defineProperty(t.prototype,"document",{get:function(){return this._associatedDocument},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"event",{get:function(){return this._currentEvent},enumerable:!0,configurable:!0}),t._create=function(){return new t},t}(o.EventTargetImpl);t.WindowImpl=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(){function e(){}return e.isNode=function(e){return!!e&&void 0!==e._nodeType},e.isDocumentNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.Document},e.isDocumentTypeNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.DocumentType},e.isDocumentFragmentNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.DocumentFragment},e.isAttrNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.Attribute},e.isCharacterDataNode=function(t){if(!e.isNode(t))return!1;var n=t._nodeType;return n===r.NodeType.Text||n===r.NodeType.ProcessingInstruction||n===r.NodeType.Comment||n===r.NodeType.CData},e.isTextNode=function(t){return e.isNode(t)&&(t._nodeType===r.NodeType.Text||t._nodeType===r.NodeType.CData)},e.isExclusiveTextNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.Text},e.isCDATASectionNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.CData},e.isCommentNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.Comment},e.isProcessingInstructionNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.ProcessingInstruction},e.isElementNode=function(t){return e.isNode(t)&&t._nodeType===r.NodeType.Element},e.isCustomElementNode=function(t){return e.isElementNode(t)&&"custom"===t._customElementState},e.isShadowRoot=function(e){return!!e&&void 0!==e.host},e.isMouseEvent=function(e){return!!e&&void 0!==e.screenX&&null!=e.screenY},e.isSlotable=function(t){return!!t&&void 0!==t._name&&void 0!==t._assignedSlot&&(e.isTextNode(t)||e.isElementNode(t))},e.isSlot=function(t){return!!t&&void 0!==t._name&&void 0!==t._assignedNodes&&e.isElementNode(t)},e.isWindow=function(e){return!!e&&void 0!==e.navigator},e.isEventListener=function(e){return!!e&&void 0!==e.handleEvent},e.isRegisteredObserver=function(e){return!!e&&void 0!==e.observer&&void 0!==e.options},e.isTransientRegisteredObserver=function(t){return!!t&&void 0!==t.source&&e.isRegisteredObserver(t)},e}();t.Guard=i},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this)||this}return i(t,e),t}(n(98).DocumentImpl);t.XMLDocumentImpl=o},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(1),s=n(243),l=n(7),c=n(244),u={ftp:21,file:null,http:80,https:443,ws:80,wss:443},d=/[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,p=/[ "<>`]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,f=/[ "<>`#?{}]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,h=/[ "<>`#?{}/:;=@\[\]\\\^\|]|[\0-\x1F\x7F-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,m=/[0-9A-Za-z!\$&-\/:;=\?@_~\xA0-\uD7FF\uE000-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uD83E\uD840-\uD87E\uD880-\uD8BE\uD8C0-\uD8FE\uD900-\uD93E\uD940-\uD97E\uD980-\uD9BE\uD9C0-\uD9FE\uDA00-\uDA3E\uDA40-\uDA7E\uDA80-\uDABE\uDAC0-\uDAFE\uDB00-\uDB3E\uDB40-\uDB7E\uDB80-\uDBBE\uDBC0-\uDBFE][\uDC00-\uDFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDC00-\uDFFD]/,g=/[\0\t\f\r #%/:?@\[\\\]]/;function v(e){void 0!==o&&o.call(null,"Validation Error: "+e)}function y(){return{scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,_cannotBeABaseURLFlag:!1,_blobURLEntry:null}}function b(e){return e in u}function x(e){return b(e.scheme)}function A(e){return u[e]||null}function C(e){return""!==e.username||""!==e.password}function T(e,t){var n,i;void 0===t&&(t=!1);var o=e.scheme+":";if(null!==e.host?(o+="//",C(e)&&(o+=e.username,""!==e.password&&(o+=":"+e.password),o+="@"),o+=S(e.host),null!==e.port&&(o+=":"+e.port)):null===e.host&&"file"===e.scheme&&(o+="//"),e._cannotBeABaseURLFlag)o+=e.path[0];else try{for(var a=r(e.path),s=a.next();!s.done;s=a.next())o+="/"+s.value}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return null!==e.query&&(o+="?"+e.query),t||null===e.fragment||(o+="#"+e.fragment),o}function S(e){return a.isNumber(e)?w(e):a.isArray(e)?"["+_(e)+"]":e}function w(e){for(var t="",n=e,r=1;r<=4;r++)t=(n%256).toString()+t,4!==r&&(t="."+t),n=Math.floor(n/256);return t}function _(e){for(var t="",n=null,r=-1,i=0,o=0,a=0;a<8;a++)if(0===e[a]){i=1;for(var s=a+1;s<8&&0===e[s];s++)i++;i>o&&(o=i,r=a)}o>1&&(n=r);for(var l=!1,c=0;c<8;c++)l&&0===e[c]||(l&&(l=!1),n!==c?(t+=e[c].toString(16),7!==c&&(t+=":")):(t+=0===c?"::":":",l=!0));return t}function I(e,t,n,i,o){var c,u,g,y;if(void 0===i){i={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,_cannotBeABaseURLFlag:!1,_blobURLEntry:null};var T=/^[\u0000-\u001F\u0020]+/,S=/[\u0000-\u001F\u0020]+$/;(T.test(e)||S.test(e))&&v("Input string contains leading or trailing control characters or space."),e=(e=e.replace(T,"")).replace(S,"")}var w=/[\u0009\u000A\u000D]/g;w.test(e)&&v("Input string contains tab or newline characters."),e=e.replace(w,"");var _=void 0===o?s.ParserState.SchemeStart:o;void 0===t&&(t=null);for(var I=void 0===n||"replacement"===n||"UTF-16BE"===n||"UTF-16LE"===n?"UTF-8":n,L="",F=!1,B=!1,V=!1,k=new a.StringWalker(e);;){switch(_){case s.ParserState.SchemeStart:if(l.codePoint.ASCIIAlpha.test(k.c()))L+=k.c().toLowerCase(),_=s.ParserState.Scheme;else{if(void 0!==o)return v("Invalid scheme start character."),null;_=s.ParserState.NoScheme,k.pointer--}break;case s.ParserState.Scheme:if(l.codePoint.ASCIIAlphanumeric.test(k.c())||"+"===k.c()||"-"===k.c()||"."===k.c())L+=k.c().toLowerCase();else{if(":"!==k.c()){if(void 0===o){L="",_=s.ParserState.NoScheme,k.pointer=0;continue}return v("Invalid input string."),null}if(void 0!==o){if(b(i.scheme)&&!b(L))return i;if(!b(i.scheme)&&b(L))return i;if((C(i)||null!==i.port)&&"file"===L)return i;if("file"===i.scheme&&(""===i.host||null===i.host))return i}if(i.scheme=L,void 0!==o)return i.port===A(i.scheme)&&(i.port=null),i;L="","file"===i.scheme?(k.remaining().startsWith("//")||v("Invalid file URL scheme, '//' expected."),_=s.ParserState.File):x(i)&&null!==t&&t.scheme===i.scheme?_=s.ParserState.SpecialRelativeOrAuthority:x(i)?_=s.ParserState.SpecialAuthoritySlashes:k.remaining().startsWith("/")?(_=s.ParserState.PathOrAuthority,k.pointer++):(i._cannotBeABaseURLFlag=!0,i.path.push(""),_=s.ParserState.CannotBeABaseURLPath)}break;case s.ParserState.NoScheme:if(null===t||t._cannotBeABaseURLFlag&&"#"!==k.c())return v("Invalid input string."),null;t._cannotBeABaseURLFlag&&"#"===k.c()?(i.scheme=t.scheme,i.path=l.list.clone(t.path),i.query=t.query,i.fragment="",i._cannotBeABaseURLFlag=!0,_=s.ParserState.Fragment):"file"!==t.scheme?(_=s.ParserState.Relative,k.pointer--):(_=s.ParserState.File,k.pointer--);break;case s.ParserState.SpecialRelativeOrAuthority:"/"===k.c()&&k.remaining().startsWith("/")?(_=s.ParserState.SpecialAuthorityIgnoreSlashes,k.pointer++):(v("Invalid input string."),_=s.ParserState.Relative,k.pointer--);break;case s.ParserState.PathOrAuthority:"/"===k.c()?_=s.ParserState.Authority:(_=s.ParserState.Path,k.pointer--);break;case s.ParserState.Relative:if(null===t)throw new Error("Invalid parser state. Base URL is null.");switch(i.scheme=t.scheme,k.c()){case"":i.username=t.username,i.password=t.password,i.host=t.host,i.port=t.port,i.path=l.list.clone(t.path),i.query=t.query;break;case"/":_=s.ParserState.RelativeSlash;break;case"?":i.username=t.username,i.password=t.password,i.host=t.host,i.port=t.port,i.path=l.list.clone(t.path),i.query="",_=s.ParserState.Query;break;case"#":i.username=t.username,i.password=t.password,i.host=t.host,i.port=t.port,i.path=l.list.clone(t.path),i.query=t.query,i.fragment="",_=s.ParserState.Fragment;break;default:x(i)&&"\\"===k.c()?(v("Invalid input string."),_=s.ParserState.RelativeSlash):(i.username=t.username,i.password=t.password,i.host=t.host,i.port=t.port,i.path=l.list.clone(t.path),0!==i.path.length&&i.path.splice(i.path.length-1,1),_=s.ParserState.Path,k.pointer--)}break;case s.ParserState.RelativeSlash:if(!x(i)||"/"!==k.c()&&"\\"!==k.c())if("/"===k.c())_=s.ParserState.Authority;else{if(null===t)throw new Error("Invalid parser state. Base URL is null.");i.username=t.username,i.password=t.password,i.host=t.host,i.port=t.port,_=s.ParserState.Path,k.pointer--}else"\\"===k.c()&&v("Invalid input string."),_=s.ParserState.SpecialAuthorityIgnoreSlashes;break;case s.ParserState.SpecialAuthoritySlashes:"/"===k.c()&&k.remaining().startsWith("/")?(_=s.ParserState.SpecialAuthorityIgnoreSlashes,k.pointer++):(v("Expected '//'."),_=s.ParserState.SpecialAuthorityIgnoreSlashes,k.pointer--);break;case s.ParserState.SpecialAuthorityIgnoreSlashes:"/"!==k.c()&&"\\"!==k.c()?(_=s.ParserState.Authority,k.pointer--):v("Unexpected '/' or '\\'.");break;case s.ParserState.Authority:if("@"===k.c()){v("Unexpected '@'."),F&&(L="%40"+L),F=!0;try{for(var G=(c=void 0,r(L)),z=G.next();!z.done;z=G.next()){var j=z.value;if(":"!==j||V){var H=W(j,h);V?i.password+=H:i.username+=H}else V=!0}}catch(e){c={error:e}}finally{try{z&&!z.done&&(u=G.return)&&u.call(G)}finally{if(c)throw c.error}}L=""}else if(""===k.c()||"/"===k.c()||"?"===k.c()||"#"===k.c()||x(i)&&"\\"===k.c()){if(F&&""===L)return v("Invalid input string."),null;k.pointer-=L.length+1,L="",_=s.ParserState.Host}else L+=k.c();break;case s.ParserState.Host:case s.ParserState.Hostname:if(void 0!==o&&"file"===i.scheme)k.pointer--,_=s.ParserState.FileHost;else if(":"!==k.c()||B)if(""===k.c()||"/"===k.c()||"?"===k.c()||"#"===k.c()||x(i)&&"\\"===k.c()){if(k.pointer--,x(i)&&""===L)return v("Invalid input string."),null;if(void 0!==o&&""===L&&(C(i)||null!==i.port))return v("Invalid input string."),i;if(null===(q=M(L,!x(i))))return null;if(i.host=q,L="",_=s.ParserState.PathStart,void 0!==o)return i}else"["===k.c()&&(B=!0),"]"===k.c()&&(B=!1),L+=k.c();else{if(""===L)return v("Invalid input string."),null;if(null===(q=M(L,!x(i))))return null;if(i.host=q,L="",_=s.ParserState.Port,o===s.ParserState.Hostname)return i}break;case s.ParserState.Port:if(l.codePoint.ASCIIDigit.test(k.c()))L+=k.c();else{if(!(""===k.c()||"/"===k.c()||"?"===k.c()||"#"===k.c()||x(i)&&"\\"===k.c()||o))return v("Invalid input string."),null;if(""!==L&&""!==L){var K=parseInt(L,10);if(K>Math.pow(2,16)-1)return v("Invalid port number."),null;i.port=K===A(i.scheme)?null:K,L=""}if(void 0!==o)return i;_=s.ParserState.PathStart,k.pointer--}break;case s.ParserState.File:if(i.scheme="file","/"===k.c()||"\\"===k.c())"\\"===k.c()&&v("Invalid input string."),_=s.ParserState.FileSlash;else if(null!==t&&"file"===t.scheme)switch(k.c()){case"":i.host=t.host,i.path=l.list.clone(t.path),i.query=t.query;break;case"?":i.host=t.host,i.path=l.list.clone(t.path),i.query="",_=s.ParserState.Query;break;case"#":i.host=t.host,i.path=l.list.clone(t.path),i.query=t.query,i.fragment="",_=s.ParserState.Fragment;break;default:N(k.substring())?v("Unexpected windows drive letter in input string."):(i.host=t.host,i.path=l.list.clone(t.path),O(i)),_=s.ParserState.Path,k.pointer--}else _=s.ParserState.Path,k.pointer--;break;case s.ParserState.FileSlash:"/"===k.c()||"\\"===k.c()?("\\"===k.c()&&v("Invalid input string."),_=s.ParserState.FileHost):(null===t||"file"!==t.scheme||N(k.substring())||(P(t.path[0])?i.path.push(t.path[0]):i.host=t.host),_=s.ParserState.Path,k.pointer--);break;case s.ParserState.FileHost:if(""===k.c()||"/"===k.c()||"\\"===k.c()||"?"===k.c()||"#"===k.c())if(k.pointer--,void 0===o&&R(L))v("Unexpected windows drive letter in input string."),_=s.ParserState.Path;else if(""===L){if(i.host="",void 0!==o)return i;_=s.ParserState.PathStart}else{var q;if(null===(q=M(L,!x(i))))return null;if("localhost"===q&&(q=""),i.host=q,void 0!==o)return i;L="",_=s.ParserState.PathStart}else L+=k.c();break;case s.ParserState.PathStart:x(i)?("\\"===k.c()&&v("Invalid input string."),_=s.ParserState.Path,"/"!==k.c()&&"\\"!==k.c()&&k.pointer--):void 0===o&&"?"===k.c()?(i.query="",_=s.ParserState.Query):void 0===o&&"#"===k.c()?(i.fragment="",_=s.ParserState.Fragment):""!==k.c()&&(_=s.ParserState.Path,"/"!==k.c()&&k.pointer--);break;case s.ParserState.Path:if(""===k.c()||"/"===k.c()||x(i)&&"\\"===k.c()||void 0===o&&("?"===k.c()||"#"===k.c())){if(x(i)&&"\\"===k.c()&&v("Invalid input string."),D(L))O(i),"/"===k.c()||x(i)&&"\\"===k.c()||i.path.push("");else if(!E(L)||"/"===k.c()||x(i)&&"\\"===k.c()){if(!E(L)){if("file"===i.scheme&&0===i.path.length&&R(L)){null!==i.host&&""!==i.host&&(v("Invalid input string."),i.host="");var $=Array.from(L);L=$.slice(0,1)+":"+$.slice(2)}i.path.push(L)}}else i.path.push("");if(L="","file"===i.scheme&&(""===k.c()||"?"===k.c()||"#"===k.c()))for(;i.path.length>1&&""===i.path[0];)v("Invalid input string."),i.path.splice(0,1);"?"===k.c()&&(i.query="",_=s.ParserState.Query),"#"===k.c()&&(i.fragment="",_=s.ParserState.Fragment)}else m.test(k.c())||"%"===k.c()||v("Character is not a URL code point or a percent encoded character."),"%"!==k.c()||/^[0-9a-fA-F][0-9a-fA-F]/.test(k.remaining())||v("Percent encoded character must be followed by two hex digits."),L+=W(k.c(),f);break;case s.ParserState.CannotBeABaseURLPath:"?"===k.c()?(i.query="",_=s.ParserState.Query):"#"===k.c()?(i.fragment="",_=s.ParserState.Fragment):(""===k.c()||m.test(k.c())||"%"===k.c()||v("Character is not a URL code point or a percent encoded character."),"%"!==k.c()||/^[0-9a-fA-F][0-9a-fA-F]/.test(k.remaining())||v("Percent encoded character must be followed by two hex digits."),""!==k.c()&&(i.path[0]+=W(k.c(),d)));break;case s.ParserState.Query:if("UTF-8"===I||x(i)&&"ws"!==i.scheme&&"wss"!==i.scheme||(I="UTF-8"),void 0===o&&"#"===k.c())i.fragment="",_=s.ParserState.Fragment;else if(""!==k.c()){if(m.test(k.c())||"%"===k.c()||v("Character is not a URL code point or a percent encoded character."),"%"!==k.c()||/^[0-9a-fA-F][0-9a-fA-F]/.test(k.remaining())||v("Percent encoded character must be followed by two hex digits."),"UTF-8"!==I.toUpperCase())throw new Error("Only UTF-8 encoding is supported.");var X=a.utf8Encode(k.c());if(X.length>=3&&38===X[0]&&35===X[1]&&59===X[X.length-1])X=X.subarray(2,X.length-1),i.query+="%26%23"+l.byteSequence.isomorphicDecode(X)+"%3B";else try{for(var Y=(g=void 0,r(X)),J=Y.next();!J.done;J=Y.next()){var Z=J.value;Z<33||Z>126||34===Z||35===Z||60===Z||62===Z||39===Z&&x(i)?i.query+=U(Z):i.query+=String.fromCharCode(Z)}}catch(e){g={error:e}}finally{try{J&&!J.done&&(y=Y.return)&&y.call(Y)}finally{if(g)throw g.error}}}break;case s.ParserState.Fragment:""===k.c()||("\0"===k.c()?v("NULL character in input string."):(m.test(k.c())||"%"===k.c()||v("Unexpected character in fragment string."),"%"!==k.c()||/^[A-Za-z0-9][A-Za-z0-9]/.test(k.remaining())||v("Unexpected character in fragment string."),i.fragment+=W(k.c(),p)))}if(k.eof)break;k.pointer++}return i}function E(e){return"."===e||"%2e"===e.toLowerCase()}function D(e){var t=e.toLowerCase();return".."===t||".%2e"===t||"%2e."===t||"%2e%2e"===t}function O(e){var t=e.path;0!==t.length&&("file"===e.scheme&&1===t.length&&P(t[0])||e.path.splice(e.path.length-1,1))}function P(e){return e.length>=2&&l.codePoint.ASCIIAlpha.test(e[0])&&":"===e[1]}function R(e){return e.length>=2&&l.codePoint.ASCIIAlpha.test(e[0])&&(":"===e[1]||"|"===e[1])}function N(e){return e.length>=2&&R(e)&&(2===e.length||"/"===e[2]||"\\"===e[2]||"?"===e[2]||"#"===e[2])}function M(e,t){if(void 0===t&&(t=!1),e.startsWith("["))return e.endsWith("]")?B(e.substring(1,e.length-1)):(v("Expected ']' after '['."),null);if(t)return V(e);var n=K(a.utf8Decode(z(e)));if(null===n)return v("Invalid domain."),null;if(g.test(n))return v("Invalid domain."),null;var r=F(n);return null===r||a.isNumber(r)?r:n}function L(e,t){void 0===t&&(t={value:!1});var n=10;return e.startsWith("0x")||e.startsWith("0X")?(t.value=!0,e=e.substr(2),n=16):e.length>=2&&"0"===e[0]&&(t.value=!0,e=e.substr(1),n=8),""===e?0:(10===n?/^[0-9]+$/:16===n?/^[0-9A-Fa-f]+$/:/^[0-7]+$/).test(e)?parseInt(e,n):null}function F(e){var t,n,i,o,a={value:!1},s=e.split(".");if(""===s[s.length-1]&&(a.value=!0,s.length>1&&s.pop()),s.length>4)return e;var l=[];try{for(var c=r(s),u=c.next();!u.done;u=c.next()){var d=u.value;if(""===d)return e;if(null===(y=L(d,a)))return e;l.push(y)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}a.value&&v("Invalid IP v4 address.");for(var p=0;p<l.length;p++)if(l[p]>255&&(v("Invalid IP v4 address."),p<l.length-1))return null;if(l[l.length-1]>=Math.pow(256,5-l.length))return v("Invalid IP v4 address."),null;var f=l[l.length-1];l.pop();var h=0;try{for(var m=r(l),g=m.next();!g.done;g=m.next()){var y;f+=(y=g.value)*Math.pow(256,3-h),h++}}catch(e){i={error:e}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}return f}function B(e){var t,n=[0,0,0,0,0,0,0,0],r=0,o=null,s=new a.StringWalker(e);if(":"===s.c()){if(!s.remaining().startsWith(":"))return v("Invalid IP v6 address."),null;s.pointer+=2,o=r+=1}for(;""!==s.c();){if(8===r)return v("Invalid IP v6 address."),null;if(":"!==s.c()){for(var c=0,u=0;u<4&&l.codePoint.ASCIIHexDigit.test(s.c());)c=16*c+parseInt(s.c(),16),s.pointer++,u++;if("."===s.c()){if(0===u)return v("Invalid IP v6 address."),null;if(s.pointer-=u,r>6)return v("Invalid IP v6 address."),null;for(var d=0;""!==s.c();){var p=null;if(d>0){if(!("."===s.c()&&d<4))return v("Invalid IP v6 address."),null;s.pointer++}if(!l.codePoint.ASCIIDigit.test(s.c()))return v("Invalid IP v6 address."),null;for(;l.codePoint.ASCIIDigit.test(s.c());){var f=parseInt(s.c(),10);if(null===p)p=f;else{if(0===p)return v("Invalid IP v6 address."),null;p=10*p+f}if(p>255)return v("Invalid IP v6 address."),null;s.pointer++}if(null===p)return v("Invalid IP v6 address."),null;n[r]=256*n[r]+p,2!=++d&&4!==d||r++}if(4!==d)return v("Invalid IP v6 address."),null;break}if(":"===s.c()){if(s.pointer++,""===s.c())return v("Invalid IP v6 address."),null}else if(""!==s.c())return v("Invalid IP v6 address."),null;n[r]=c,r++}else{if(null!==o)return v("Invalid IP v6 address."),null;s.pointer++,o=++r}}if(null!==o){var h=r-o;for(r=7;0!==r&&h>0;)t=i([n[o+h-1],n[r]],2),n[r]=t[0],n[o+h-1]=t[1],r--,h--}else if(null===o&&8!==r)return v("Invalid IP v6 address."),null;return n}function V(e){var t,n;if(/[\x00\t\f\r #/:?@\[\\\]]/.test(e))return v("Invalid host string."),null;var i="";try{for(var o=r(e),a=o.next();!a.done;a=o.next())i+=W(a.value,d)}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i}function k(e){return null}function U(e){return"%"+("00"+e.toString(16).toUpperCase()).slice(-2)}function G(e){for(var t=function(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102},n=new Uint8Array(e.length),r=0,i=0;i<e.length;i++){var o=e[i];if(37!==o)n[r]=o,r++;else if(37===o&&i>=e.length-2)n[r]=o,r++;else if(37!==o||t(e[i+1])&&t(e[i+2])){var s=parseInt(a.utf8Decode(Uint8Array.of(e[i+1],e[i+2])),16);n[r]=s,r++,i+=2}else n[r]=o,r++}return n.subarray(0,r)}function z(e){return G(a.utf8Encode(e))}function W(e,t){var n,i;if(!t.test(e))return e;var o=a.utf8Encode(e),s="";try{for(var l=r(o),c=l.next();!c.done;c=l.next())s+=U(c.value)}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return s}function j(e){var t,n,i,o,s=[],l=[];try{for(var c=r(e),u=c.next();!u.done;u=c.next()){var d=u.value;38===d?(s.push(Uint8Array.from(l)),l=[]):l.push(d)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}0!==l.length&&s.push(Uint8Array.from(l));var p=[];try{for(var f=r(s),h=f.next();!h.done;h=f.next()){var m=h.value;if(0!==m.length){for(var g=m.indexOf(61),v=-1!==g?m.slice(0,g):m,y=-1!==g?m.slice(g+1):new Uint8Array,b=0;b<v.length;b++)43===v[b]&&(v[b]=32);for(b=0;b<y.length;b++)43===y[b]&&(y[b]=32);var x=a.utf8Decode(v),A=a.utf8Decode(y);p.push([x,A])}}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}return p}function H(e){var t,n,i="";try{for(var o=r(e),a=o.next();!a.done;a=o.next()){var s=a.value;i+=32===s?"+":42===s||45===s||46===s||s>=48&&s<=57||s>=65&&s<=90||95===s||s>=97&&s<=122?String.fromCodePoint(s):U(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i}function K(e,t){void 0===t&&(t=!1);var n=c.domainToASCII(e);return""===n?(v("Invalid domain name."),null):n}t.setValidationErrorCallback=function(e){o=e},t.newURL=y,t.isSpecialScheme=b,t.isSpecial=x,t.defaultPort=A,t.includesCredentials=C,t.cannotHaveAUsernamePasswordPort=function(e){return null===e.host||""===e.host||e._cannotBeABaseURLFlag||"file"===e.scheme},t.urlSerializer=T,t.hostSerializer=S,t.iPv4Serializer=w,t.iPv6Serializer=_,t.urlParser=function(e,t,n){var r=I(e,t,n);return null===r?null:("blob"!==r.scheme||(r._blobURLEntry=null),r)},t.basicURLParser=I,t.setTheUsername=function(e,t){var n,i,o="";try{for(var a=r(t),s=a.next();!s.done;s=a.next())o+=W(s.value,h)}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}e.username=o},t.setThePassword=function(e,t){var n,i,o="";try{for(var a=r(t),s=a.next();!s.done;s=a.next())o+=W(s.value,h)}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}e.password=o},t.isSingleDotPathSegment=E,t.isDoubleDotPathSegment=D,t.shorten=O,t.isNormalizedWindowsDriveLetter=P,t.isWindowsDriveLetter=R,t.startsWithAWindowsDriveLetter=N,t.hostParser=M,t.iPv4NumberParser=L,t.iPv4Parser=F,t.iPv6Parser=B,t.opaqueHostParser=V,t.resolveABlobURL=k,t.percentEncode=U,t.percentDecode=G,t.stringPercentDecode=z,t.utf8PercentEncode=W,t.hostEquals=function(e,t){return e===t},t.urlEquals=function(e,t,n){return void 0===n&&(n=!1),T(e,n)===T(t,n)},t.urlEncodedStringParser=function(e){return j(a.utf8Encode(e))},t.urlEncodedParser=j,t.urlEncodedByteSerializer=H,t.urlEncodedSerializer=function(e,t){var n,i;if("UTF-8"!==(void 0===t||"replacement"===t||"UTF-16BE"===t||"UTF-16LE"===t?"UTF-8":t).toUpperCase())throw new Error("Only UTF-8 encoding is supported.");var o="";try{for(var s=r(e),l=s.next();!l.done;l=s.next()){var c=l.value,u=H(a.utf8Encode(c[0])),d=c[1];d=H(a.utf8Encode(d)),""!==o&&(o+="&"),o+=u+"="+d}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o},t.origin=function e(t){switch(t.scheme){case"blob":t._blobURLEntry;var n=I(t.path[0]);return null===n?s.OpaqueOrigin:e(n);case"ftp":case"http":case"https":case"ws":case"wss":return[t.scheme,null===t.host?"":t.host,t.port,null];default:return s.OpaqueOrigin}},t.domainToASCII=K,t.domainToUnicode=function(e,t){void 0===t&&(t=!1);var n=c.domainToUnicode(e);return""===n&&v("Invalid domain name."),n},t.asciiSerializationOfAnOrigin=function(e){if(""===e[0]&&""===e[1]&&null===e[2]&&null===e[3])return"null";var t=e[0]+"://"+S(e[1]);return null!==e[2]&&(t+=":"+e[2].toString()),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){this._signal=r.create_abortSignal()}return Object.defineProperty(e.prototype,"signal",{get:function(){return this._signal},enumerable:!0,configurable:!0}),e.prototype.abort=function(){r.abort_signalAbort(this._signal)},e}();t.AbortControllerImpl=i},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(70),a=n(0),s=function(e){function t(){var t=e.call(this)||this;return t._abortedFlag=!1,t._abortAlgorithms=new Set,t}return i(t,e),Object.defineProperty(t.prototype,"aborted",{get:function(){return this._abortedFlag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onabort",{get:function(){return a.event_getterEventHandlerIDLAttribute(this,"onabort")},set:function(e){a.event_setterEventHandlerIDLAttribute(this,"onabort",e)},enumerable:!0,configurable:!0}),t._create=function(){return new t},t}(o.EventTargetImpl);t.AbortSignalImpl=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(34),s=n(12),l=function(e){function t(t,n,r){var i=e.call(this)||this;return i._name="",i._publicId="",i._systemId="",i._name=t,i._publicId=n,i._systemId=r,i}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"publicId",{get:function(){return this._publicId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this._systemId},enumerable:!0,configurable:!0}),t.prototype.before=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.after=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.replaceWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Mixin: ChildNode not implemented.")},t.prototype.remove=function(){throw new Error("Mixin: ChildNode not implemented.")},t._create=function(e,n,r,i){void 0===r&&(r=""),void 0===i&&(i="");var o=new t(n,r,i);return o._nodeDocument=e,o},t}(a.NodeImpl);t.DocumentTypeImpl=l,s.idl_defineConst(l.prototype,"_nodeType",o.NodeType.DocumentType)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(100),a=n(1),s=n(0),l=function(e){function t(t,n){var r=e.call(this)||this;return r._host=t,r._mode=n,r}return i(t,e),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),t.prototype._getTheParent=function(e){return e._composedFlag||a.isEmpty(e._path)||s.tree_rootNode(e._path[0].invocationTarget)!==this?this._host:null},t._create=function(e,n){return new t(n,"closed")},t}(o.DocumentFragmentImpl);t.ShadowRootImpl=l},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(34),s=n(0),l=n(12),c=function(e){function t(t){var n=e.call(this)||this;return n._namespace=null,n._namespacePrefix=null,n._element=null,n._value="",n._localName=t,n}return i(t,e),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prefix",{get:function(){return this._namespacePrefix},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localName",{get:function(){return this._localName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._qualifiedName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){s.attr_setAnExistingAttributeValue(this,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_qualifiedName",{get:function(){return null!==this._namespacePrefix?this._namespacePrefix+":"+this._localName:this._localName},enumerable:!0,configurable:!0}),t._create=function(e,n){var r=new t(n);return r._nodeDocument=e,r},t}(a.NodeImpl);t.AttrImpl=c,l.idl_defineConst(c.prototype,"_nodeType",o.NodeType.Attribute),l.idl_defineConst(c.prototype,"specified",!0)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(101),a=n(2),s=n(12),l=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t._create=function(e,n){void 0===n&&(n="");var r=new t(n);return r._nodeDocument=e,r},t}(o.TextImpl);t.CDATASectionImpl=l,s.idl_defineConst(l.prototype,"_nodeType",a.NodeType.CData)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(71),s=n(12),l=function(e){function t(t){return void 0===t&&(t=""),e.call(this,t)||this}return i(t,e),t._create=function(e,n){void 0===n&&(n="");var r=new t(n);return r._nodeDocument=e,r},t}(a.CharacterDataImpl);t.CommentImpl=l,s.idl_defineConst(l.prototype,"_nodeType",o.NodeType.Comment)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(71),s=n(12),l=function(e){function t(t,n){var r=e.call(this,n)||this;return r._target=t,r}return i(t,e),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),t._create=function(e,n,r){var i=new t(n,r);return i._nodeDocument=e,i},t}(a.CharacterDataImpl);t.ProcessingInstructionImpl=l,s.idl_defineConst(l.prototype,"_nodeType",o.NodeType.ProcessingInstruction)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(0),o=n(3),a=n(1),s=function(){function e(e,t){return this._live=!0,this._root=e,this._filter=t,new Proxy(this,this)}return Object.defineProperty(e.prototype,"length",{get:function(){for(var e=this,t=0,n=i.tree_getFirstDescendantNode(this._root,!1,!1,(function(t){return o.Guard.isElementNode(t)&&e._filter(t)}));null!==n;)t++,n=i.tree_getNextDescendantNode(this._root,n,!1,!1,(function(t){return o.Guard.isElementNode(t)&&e._filter(t)}));return t},enumerable:!0,configurable:!0}),e.prototype.item=function(e){for(var t=this,n=0,r=i.tree_getFirstDescendantNode(this._root,!1,!1,(function(e){return o.Guard.isElementNode(e)&&t._filter(e)}));null!==r;){if(n===e)return r;n++,r=i.tree_getNextDescendantNode(this._root,r,!1,!1,(function(e){return o.Guard.isElementNode(e)&&t._filter(e)}))}return null},e.prototype.namedItem=function(e){var t=this;if(""===e)return null;for(var n=i.tree_getFirstDescendantNode(this._root,!1,!1,(function(e){return o.Guard.isElementNode(e)&&t._filter(e)}));null!=n;){if(n._uniqueIdentifier===e)return n;if(n._namespace===r.namespace.HTML)for(var a=0;a<n._attributeList.length;a++){var s=n._attributeList[a];if("name"===s._localName&&null===s._namespace&&null===s._namespacePrefix&&s._value===e)return n}n=i.tree_getNextDescendantNode(this._root,n,!1,!1,(function(e){return o.Guard.isElementNode(e)&&t._filter(e)}))}return null},e.prototype[Symbol.iterator]=function(){var e=this._root,t=this._filter,n=i.tree_getFirstDescendantNode(e,!1,!1,(function(e){return o.Guard.isElementNode(e)&&t(e)}));return{next:function(){if(null===n)return{done:!0,value:null};var r={done:!1,value:n};return n=i.tree_getNextDescendantNode(e,n,!1,!1,(function(e){return o.Guard.isElementNode(e)&&t(e)})),r}}},e.prototype.get=function(t,n,r){if(!a.isString(n)||-1!==e.reservedNames.indexOf(n))return Reflect.get(t,n,r);var i=Number(n);return isNaN(i)?t.namedItem(n)||void 0:t.item(i)||void 0},e.prototype.set=function(t,n,r,o){if(!a.isString(n)||-1!==e.reservedNames.indexOf(n))return Reflect.set(t,n,r,o);var s=Number(n),l=isNaN(s)?t.namedItem(n)||void 0:t.item(s)||void 0;return!(!l||!l._parent||(i.mutation_replace(l,r,l._parent),0))},e._create=function(t,n){return void 0===n&&(n=function(){return!0}),new e(t,n)},e.reservedNames=["_root","_live","_filter","length","item","namedItem","get","set"],e}();t.HTMLCollectionImpl=s},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(1),a=n(0),s=function(){function e(e){return this._live=!0,this._filter=null,this._length=0,this._root=e,new Proxy(this,this)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._root._children.size},enumerable:!0,configurable:!0}),e.prototype.item=function(e){if(e<0||e>this.length-1)return null;if(e<this.length/2){for(var t=0,n=this._root._firstChild;null!==n&&t!==e;)n=n._nextSibling,t++;return n}for(t=this.length-1,n=this._root._lastChild;null!==n&&t!==e;)n=n._previousSibling,t--;return n},e.prototype.keys=function(){var e;return(e={})[Symbol.iterator]=function(){var e=0;return{next:function(){return e===this.length?{done:!0,value:null}:{done:!1,value:e++}}.bind(this)}}.bind(this),e},e.prototype.values=function(){var e;return(e={})[Symbol.iterator]=function(){var e=this[Symbol.iterator]();return{next:function(){return e.next()}}}.bind(this),e},e.prototype.entries=function(){var e;return(e={})[Symbol.iterator]=function(){var e=this[Symbol.iterator](),t=0;return{next:function(){var n=e.next();return n.done?{done:!0,value:null}:{done:!1,value:[t++,n.value]}}}}.bind(this),e},e.prototype[Symbol.iterator]=function(){return this._root._children[Symbol.iterator]()},e.prototype.forEach=function(e,t){var n,o;void 0===t&&(t=i.dom.window);var a=0;try{for(var s=r(this._root._children),l=s.next();!l.done;l=s.next()){var c=l.value;e.call(t,c,a++,this)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},e.prototype.get=function(e,t,n){if(!o.isString(t))return Reflect.get(e,t,n);var r=Number(t);return isNaN(r)?Reflect.get(e,t,n):e.item(r)||void 0},e.prototype.set=function(e,t,n,r){if(!o.isString(t))return Reflect.set(e,t,n,r);var i=Number(t);if(isNaN(i))return Reflect.set(e,t,n,r);var s=e.item(i)||void 0;return!!s&&!!s._parent&&(a.mutation_replace(s,n,s._parent),!0)},e._create=function(t){return new e(t)},e}();t.NodeListImpl=s},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(1),a=function(){function e(e){return this._live=!1,this._items=[],this._length=0,this._root=e,this._items=[],this._filter=function(e){return!0},new Proxy(this,this)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),e.prototype.item=function(e){return e<0||e>this.length-1?null:this._items[e]},e.prototype.keys=function(){var e;return(e={})[Symbol.iterator]=function(){var e=0;return{next:function(){return e===this.length?{done:!0,value:null}:{done:!1,value:e++}}.bind(this)}}.bind(this),e},e.prototype.values=function(){var e;return(e={})[Symbol.iterator]=function(){var e=this[Symbol.iterator]();return{next:function(){return e.next()}}}.bind(this),e},e.prototype.entries=function(){var e;return(e={})[Symbol.iterator]=function(){var e=this[Symbol.iterator](),t=0;return{next:function(){var n=e.next();return n.done?{done:!0,value:null}:{done:!1,value:[t++,n.value]}}}}.bind(this),e},e.prototype[Symbol.iterator]=function(){var e=this._items[Symbol.iterator]();return{next:function(){return e.next()}}},e.prototype.forEach=function(e,t){var n,o;void 0===t&&(t=i.dom.window);var a=0;try{for(var s=r(this._items),l=s.next();!l.done;l=s.next()){var c=l.value;e.call(t,c,a++,this)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},e.prototype.get=function(e,t,n){if(!o.isString(t))return Reflect.get(e,t,n);var r=Number(t);return isNaN(r)?Reflect.get(e,t,n):e._items[r]||void 0},e.prototype.set=function(e,t,n,r){if(!o.isString(t))return Reflect.set(e,t,n,r);var i=Number(t);return isNaN(i)?Reflect.set(e,t,n,r):i>=0&&i<e._items.length&&(e._items[i]=n,!0)},e._create=function(t,n){var r=new e(t);return r._items=n,r},e}();t.NodeListStaticImpl=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(0),s=function(e){function t(n){var r=e.call(this)||this;return r._element=n,Object.setPrototypeOf(r,t.prototype),r}return i(t,e),t.prototype._asArray=function(){return this},t.prototype.item=function(e){return this[e]||null},t.prototype.getNamedItem=function(e){return a.element_getAnAttributeByName(e,this._element)},t.prototype.getNamedItemNS=function(e,t){return a.element_getAnAttributeByNamespaceAndLocalName(e||"",t,this._element)},t.prototype.setNamedItem=function(e){return a.element_setAnAttribute(e,this._element)},t.prototype.setNamedItemNS=function(e){return a.element_setAnAttribute(e,this._element)},t.prototype.removeNamedItem=function(e){var t=a.element_removeAnAttributeByName(e,this._element);if(null===t)throw new o.NotFoundError;return t},t.prototype.removeNamedItemNS=function(e,t){var n=a.element_removeAnAttributeByNamespaceAndLocalName(e||"",t,this._element);if(null===n)throw new o.NotFoundError;return n},t._create=function(e){return new t(e)},t}(Array);t.NamedNodeMapImpl=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),s=n(2),l=n(102),c=n(9),u=n(0),d=n(12),p=n(3),f=function(e){function t(){var t=e.call(this)||this,n=a.dom.window._associatedDocument;return t._start=[n,0],t._end=[n,0],a.dom.rangeList.add(t),t}return i(t,e),Object.defineProperty(t.prototype,"commonAncestorContainer",{get:function(){for(var e=this._start[0];!u.tree_isAncestorOf(this._end[0],e,!0);){if(null===e._parent)throw new Error("Parent node  is null.");e=e._parent}return e},enumerable:!0,configurable:!0}),t.prototype.setStart=function(e,t){u.range_setTheStart(this,e,t)},t.prototype.setEnd=function(e,t){u.range_setTheEnd(this,e,t)},t.prototype.setStartBefore=function(e){var t=e._parent;if(null===t)throw new c.InvalidNodeTypeError;u.range_setTheStart(this,t,u.tree_index(e))},t.prototype.setStartAfter=function(e){var t=e._parent;if(null===t)throw new c.InvalidNodeTypeError;u.range_setTheStart(this,t,u.tree_index(e)+1)},t.prototype.setEndBefore=function(e){var t=e._parent;if(null===t)throw new c.InvalidNodeTypeError;u.range_setTheEnd(this,t,u.tree_index(e))},t.prototype.setEndAfter=function(e){var t=e._parent;if(null===t)throw new c.InvalidNodeTypeError;u.range_setTheEnd(this,t,u.tree_index(e)+1)},t.prototype.collapse=function(e){e?this._end=this._start:this._start=this._end},t.prototype.selectNode=function(e){u.range_select(e,this)},t.prototype.selectNodeContents=function(e){if(p.Guard.isDocumentTypeNode(e))throw new c.InvalidNodeTypeError;var t=u.tree_nodeLength(e);this._start=[e,0],this._end=[e,t]},t.prototype.compareBoundaryPoints=function(e,t){if(e!==s.HowToCompare.StartToStart&&e!==s.HowToCompare.StartToEnd&&e!==s.HowToCompare.EndToEnd&&e!==s.HowToCompare.EndToStart)throw new c.NotSupportedError;if(u.range_root(this)!==u.range_root(t))throw new c.WrongDocumentError;var n,r;switch(e){case s.HowToCompare.StartToStart:n=this._start,r=t._start;break;case s.HowToCompare.StartToEnd:n=this._end,r=t._start;break;case s.HowToCompare.EndToEnd:n=this._end,r=t._end;break;case s.HowToCompare.EndToStart:n=this._start,r=t._end;break;default:throw new c.NotSupportedError}var i=u.boundaryPoint_position(n,r);return i===s.BoundaryPosition.Before?-1:i===s.BoundaryPosition.After?1:0},t.prototype.deleteContents=function(){var e,t,n,r;if(!u.range_collapsed(this)){var i=this._startNode,a=this._startOffset,s=this._endNode,l=this._endOffset;if(i===s&&p.Guard.isCharacterDataNode(i))u.characterData_replaceData(i,a,l-a,"");else{var c,d,f=[];try{for(var h=o(u.range_getContainedNodes(this)),m=h.next();!m.done;m=h.next()){var g=(x=m.value)._parent;null!==g&&u.range_isContained(g,this)||f.push(x)}}catch(t){e={error:t}}finally{try{m&&!m.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}if(u.tree_isAncestorOf(s,i,!0))c=i,d=a;else{for(var v=i;null!==v._parent&&!u.tree_isAncestorOf(s,v._parent,!0);)v=v._parent;if(null===v._parent)throw new Error("Parent node is null.");c=v._parent,d=u.tree_index(v)+1}p.Guard.isCharacterDataNode(i)&&u.characterData_replaceData(i,a,u.tree_nodeLength(i)-a,"");try{for(var y=o(f),b=y.next();!b.done;b=y.next()){var x;(x=b.value)._parent&&u.mutation_remove(x,x._parent)}}catch(e){n={error:e}}finally{try{b&&!b.done&&(r=y.return)&&r.call(y)}finally{if(n)throw n.error}}p.Guard.isCharacterDataNode(s)&&u.characterData_replaceData(s,0,l,""),this._start=[c,d],this._end=[c,d]}}},t.prototype.extractContents=function(){return u.range_extract(this)},t.prototype.cloneContents=function(){return u.range_cloneTheContents(this)},t.prototype.insertNode=function(e){return u.range_insert(e,this)},t.prototype.surroundContents=function(e){var t,n;try{for(var r=o(u.range_getPartiallyContainedNodes(this)),i=r.next();!i.done;i=r.next()){var a=i.value;if(!p.Guard.isTextNode(a))throw new c.InvalidStateError}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}if(p.Guard.isDocumentNode(e)||p.Guard.isDocumentTypeNode(e)||p.Guard.isDocumentFragmentNode(e))throw new c.InvalidNodeTypeError;var s=u.range_extract(this);0!==e._children.size&&u.mutation_replaceAll(null,e),u.range_insert(e,this),u.mutation_append(s,e),u.range_select(e,this)},t.prototype.cloneRange=function(){return u.create_range(this._start,this._end)},t.prototype.detach=function(){a.dom.rangeList.delete(this)},t.prototype.isPointInRange=function(e,t){if(u.tree_rootNode(e)!==u.range_root(this))return!1;if(p.Guard.isDocumentTypeNode(e))throw new c.InvalidNodeTypeError;if(t>u.tree_nodeLength(e))throw new c.IndexSizeError;var n=[e,t];return u.boundaryPoint_position(n,this._start)!==s.BoundaryPosition.Before&&u.boundaryPoint_position(n,this._end)!==s.BoundaryPosition.After},t.prototype.comparePoint=function(e,t){if(u.tree_rootNode(e)!==u.range_root(this))throw new c.WrongDocumentError;if(p.Guard.isDocumentTypeNode(e))throw new c.InvalidNodeTypeError;if(t>u.tree_nodeLength(e))throw new c.IndexSizeError;var n=[e,t];return u.boundaryPoint_position(n,this._start)===s.BoundaryPosition.Before?-1:u.boundaryPoint_position(n,this._end)===s.BoundaryPosition.After?1:0},t.prototype.intersectsNode=function(e){if(u.tree_rootNode(e)!==u.range_root(this))return!1;var t=e._parent;if(null===t)return!0;var n=u.tree_index(e);return u.boundaryPoint_position([t,n],this._end)===s.BoundaryPosition.Before&&u.boundaryPoint_position([t,n+1],this._start)===s.BoundaryPosition.After},t.prototype.toString=function(){var e,t,n="";if(this._startNode===this._endNode&&p.Guard.isTextNode(this._startNode))return this._startNode._data.substring(this._startOffset,this._endOffset);p.Guard.isTextNode(this._startNode)&&(n+=this._startNode._data.substring(this._startOffset));try{for(var r=o(u.range_getContainedNodes(this)),i=r.next();!i.done;i=r.next()){var a=i.value;p.Guard.isTextNode(a)&&(n+=a._data)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return p.Guard.isTextNode(this._endNode)&&(n+=this._endNode._data.substring(0,this._endOffset)),n},t._create=function(e,n){var r=new t;return e&&(r._start=e),n&&(r._end=n),r},t.START_TO_START=0,t.START_TO_END=1,t.END_TO_END=2,t.END_TO_START=3,t}(l.AbstractRangeImpl);t.RangeImpl=f,d.idl_defineConst(f.prototype,"START_TO_START",0),d.idl_defineConst(f.prototype,"START_TO_END",1),d.idl_defineConst(f.prototype,"END_TO_END",2),d.idl_defineConst(f.prototype,"END_TO_START",3)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(103),a=n(0),s=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i._iteratorCollection=void 0,i._reference=n,i._pointerBeforeReference=r,a.nodeIterator_iteratorList().add(i),i}return i(t,e),Object.defineProperty(t.prototype,"referenceNode",{get:function(){return this._reference},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pointerBeforeReferenceNode",{get:function(){return this._pointerBeforeReference},enumerable:!0,configurable:!0}),t.prototype.nextNode=function(){return a.nodeIterator_traverse(this,!0)},t.prototype.previousNode=function(){return a.nodeIterator_traverse(this,!1)},t.prototype.detach=function(){a.nodeIterator_iteratorList().delete(this)},t._create=function(e,n,r){return new t(e,n,r)},t}(o.TraverserImpl);t.NodeIteratorImpl=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(103),s=n(0),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r._current=n,r}return i(t,e),Object.defineProperty(t.prototype,"currentNode",{get:function(){return this._current},set:function(e){this._current=e},enumerable:!0,configurable:!0}),t.prototype.parentNode=function(){for(var e=this._current;null!==e&&e!==this._root;)if(null!==(e=e._parent)&&s.traversal_filter(this,e)===o.FilterResult.Accept)return this._current=e,e;return null},t.prototype.firstChild=function(){return s.treeWalker_traverseChildren(this,!0)},t.prototype.lastChild=function(){return s.treeWalker_traverseChildren(this,!1)},t.prototype.nextSibling=function(){return s.treeWalker_traverseSiblings(this,!0)},t.prototype.previousNode=function(){for(var e=this._current;e!==this._root;){for(var t=e._previousSibling;t;){e=t;for(var n=s.traversal_filter(this,e);n!==o.FilterResult.Reject&&e._lastChild;)e=e._lastChild,n=s.traversal_filter(this,e);if(n===o.FilterResult.Accept)return this._current=e,e;t=e._previousSibling}if(e===this._root||null===e._parent)return null;if(e=e._parent,s.traversal_filter(this,e)===o.FilterResult.Accept)return this._current=e,e}return null},t.prototype.previousSibling=function(){return s.treeWalker_traverseSiblings(this,!1)},t.prototype.nextNode=function(){for(var e=this._current,t=o.FilterResult.Accept;;){for(;t!==o.FilterResult.Reject&&e._firstChild;)if(e=e._firstChild,(t=s.traversal_filter(this,e))===o.FilterResult.Accept)return this._current=e,e;for(var n=null,r=e;null!==r;){if(r===this._root)return null;if(null!==(n=r._nextSibling)){e=n;break}r=r._parent}if((t=s.traversal_filter(this,e))===o.FilterResult.Accept)return this._current=e,e}},t._create=function(e,n){return new t(e,n)},t}(a.TraverserImpl);t.TreeWalkerImpl=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(12),o=function(){function e(){}return e.prototype.acceptNode=function(e){return r.FilterResult.Accept},e._create=function(){return new e},e.FILTER_ACCEPT=1,e.FILTER_REJECT=2,e.FILTER_SKIP=3,e.SHOW_ALL=4294967295,e.SHOW_ELEMENT=1,e.SHOW_ATTRIBUTE=2,e.SHOW_TEXT=4,e.SHOW_CDATA_SECTION=8,e.SHOW_ENTITY_REFERENCE=16,e.SHOW_ENTITY=32,e.SHOW_PROCESSING_INSTRUCTION=64,e.SHOW_COMMENT=128,e.SHOW_DOCUMENT=256,e.SHOW_DOCUMENT_TYPE=512,e.SHOW_DOCUMENT_FRAGMENT=1024,e.SHOW_NOTATION=2048,e}();t.NodeFilterImpl=o,i.idl_defineConst(o.prototype,"FILTER_ACCEPT",1),i.idl_defineConst(o.prototype,"FILTER_REJECT",2),i.idl_defineConst(o.prototype,"FILTER_SKIP",3),i.idl_defineConst(o.prototype,"SHOW_ALL",4294967295),i.idl_defineConst(o.prototype,"SHOW_ELEMENT",1),i.idl_defineConst(o.prototype,"SHOW_ATTRIBUTE",2),i.idl_defineConst(o.prototype,"SHOW_TEXT",4),i.idl_defineConst(o.prototype,"SHOW_CDATA_SECTION",8),i.idl_defineConst(o.prototype,"SHOW_ENTITY_REFERENCE",16),i.idl_defineConst(o.prototype,"SHOW_ENTITY",32),i.idl_defineConst(o.prototype,"SHOW_PROCESSING_INSTRUCTION",64),i.idl_defineConst(o.prototype,"SHOW_COMMENT",128),i.idl_defineConst(o.prototype,"SHOW_DOCUMENT",256),i.idl_defineConst(o.prototype,"SHOW_DOCUMENT_TYPE",512),i.idl_defineConst(o.prototype,"SHOW_DOCUMENT_FRAGMENT",1024),i.idl_defineConst(o.prototype,"SHOW_NOTATION",2048)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r,i,o,a,s,l){this._type=e,this._target=t,this._addedNodes=n,this._removedNodes=r,this._previousSibling=i,this._nextSibling=o,this._attributeName=a,this._attributeNamespace=s,this._oldValue=l}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"addedNodes",{get:function(){return this._addedNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removedNodes",{get:function(){return this._removedNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return this._previousSibling},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return this._nextSibling},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this._attributeName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributeNamespace",{get:function(){return this._attributeNamespace},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oldValue",{get:function(){return this._oldValue},enumerable:!0,configurable:!0}),e._create=function(t,n,r,i,o,a,s,l,c){return new e(t,n,r,i,o,a,s,l,c)},e}();t.MutationRecordImpl=r},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(9),a=n(7),s=n(0),l=function(){function e(e,t){this._element=e,this._attribute=t,this._tokenSet=new Set;var n=t._localName,r=s.element_getAnAttributeValue(e,n),o=this;this._element._attributeChangeSteps.push((function(e,t,n,r,i){t===o._attribute._localName&&null===i&&(r?o._tokenSet=s.orderedSet_parse(r):o._tokenSet.clear())})),i.dom.features.steps&&s.dom_runAttributeChangeSteps(e,n,r,r,null)}return Object.defineProperty(e.prototype,"length",{get:function(){return this._tokenSet.size},enumerable:!0,configurable:!0}),e.prototype.item=function(e){var t,n,i=0;try{for(var o=r(this._tokenSet),a=o.next();!a.done;a=o.next()){var s=a.value;if(i===e)return s;i++}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return null},e.prototype.contains=function(e){return this._tokenSet.has(e)},e.prototype.add=function(){for(var e,t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{for(var l=r(n),c=l.next();!c.done;c=l.next()){var u=c.value;if(""===u)throw new o.SyntaxError("Cannot add an empty token.");if(a.codePoint.ASCIIWhiteSpace.test(u))throw new o.InvalidCharacterError("Token cannot contain whitespace.");this._tokenSet.add(u)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}s.tokenList_updateSteps(this)},e.prototype.remove=function(){for(var e,t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];try{for(var l=r(n),c=l.next();!c.done;c=l.next()){var u=c.value;if(""===u)throw new o.SyntaxError("Cannot remove an empty token.");if(a.codePoint.ASCIIWhiteSpace.test(u))throw new o.InvalidCharacterError("Token cannot contain whitespace.");this._tokenSet.delete(u)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}s.tokenList_updateSteps(this)},e.prototype.toggle=function(e,t){if(void 0===t&&(t=void 0),""===e)throw new o.SyntaxError("Cannot toggle an empty token.");if(a.codePoint.ASCIIWhiteSpace.test(e))throw new o.InvalidCharacterError("Token cannot contain whitespace.");return this._tokenSet.has(e)?void 0!==t&&!1!==t||(this._tokenSet.delete(e),s.tokenList_updateSteps(this),!1):(void 0===t||!0===t)&&(this._tokenSet.add(e),s.tokenList_updateSteps(this),!0)},e.prototype.replace=function(e,t){if(""===e||""===t)throw new o.SyntaxError("Cannot replace an empty token.");if(a.codePoint.ASCIIWhiteSpace.test(e)||a.codePoint.ASCIIWhiteSpace.test(t))throw new o.InvalidCharacterError("Token cannot contain whitespace.");return!!this._tokenSet.has(e)&&(a.set.replace(this._tokenSet,e,t),s.tokenList_updateSteps(this),!0)},e.prototype.supports=function(e){return s.tokenList_validationSteps(this,e)},Object.defineProperty(e.prototype,"value",{get:function(){return s.tokenList_serializeSteps(this)},set:function(e){s.element_setAnAttributeValue(this._element,this._attribute._localName,e)},enumerable:!0,configurable:!0}),e.prototype[Symbol.iterator]=function(){var e=this._tokenSet[Symbol.iterator]();return{next:function(){return e.next()}}},e._create=function(t,n){return new e(t,n)},e}();t.DOMTokenListImpl=l},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(104),a=n(0),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._detail=null,r._detail=n&&n.detail||null,r}return i(t,e),Object.defineProperty(t.prototype,"detail",{get:function(){return this._detail},enumerable:!0,configurable:!0}),t.prototype.initCustomEvent=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=null),this._dispatchFlag||(a.event_initialize(this,e,t,n),this._detail=r)},t}(o.EventImpl);t.CustomEventImpl=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(2),o=n(105),a=n(17);t.nodeIterator_traverse=function(e,t){for(var n=e._reference,r=e._pointerBeforeReference;;){if(t)if(r)r=!1;else{var s=a.tree_getFollowingNode(e._root,n);if(!s)return null;n=s}else if(r){var l=a.tree_getPrecedingNode(e.root,n);if(!l)return null;n=l}else r=!0;if(o.traversal_filter(e,n)===i.FilterResult.Accept)break}return e._reference=n,e._pointerBeforeReference=r,n},t.nodeIterator_iteratorList=function(){return r.dom.window._iteratorList}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=n(7),o=n(174);function a(e){if(!o.xml_isName(e))throw new r.InvalidCharacterError("Invalid XML name: "+e);if(!o.xml_isQName(e))throw new r.InvalidCharacterError("Invalid XML qualified name: "+e+".")}t.namespace_validate=a,t.namespace_validateAndExtract=function(e,t){e||(e=null),a(t);var n=t.split(":"),o=2===n.length?n[0]:null,s=2===n.length?n[1]:t;if(o&&null===e)throw new r.NamespaceError("Qualified name includes a prefix but the namespace is null.");if("xml"===o&&e!==i.namespace.XML)throw new r.NamespaceError('Qualified name includes the "xml" prefix but the namespace is not the XML namespace.');if(e!==i.namespace.XMLNS&&("xmlns"===o||"xmlns"===t))throw new r.NamespaceError('Qualified name includes the "xmlns" prefix but the namespace is not the XMLNS namespace.');if(e===i.namespace.XMLNS&&"xmlns"!==o&&"xmlns"!==t)throw new r.NamespaceError('Qualified name does not include the "xmlns" prefix but the namespace is the XMLNS namespace.');return[e,o,s]},t.namespace_extractQName=function(e){a(e);var t=e.split(":");return[2===t.length?t[0]:null,2===t.length?t[1]:e]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xml_isName=function(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(!(n>=97&&n<=122||n>=65&&n<=90||58===n||95===n||n>=192&&n<=214||n>=216&&n<=246||n>=248&&n<=767||n>=880&&n<=893||n>=895&&n<=8191||n>=8204&&n<=8205||n>=8304&&n<=8591||n>=11264&&n<=12271||n>=12289&&n<=55295||n>=63744&&n<=64975||n>=65008&&n<=65533||0!==t&&(45===n||46===n||n>=48&&n<=57||183===n||n>=768&&n<=879||n>=8255&&n<=8256))){if(n>=55296&&n<=56319&&t<e.length-1){var r=e.charCodeAt(t+1);if(r>=56320&&r<=57343&&(t++,(n=1024*(n-55296)+r-56320+65536)>=65536&&n<=983039))continue}return!1}}return!0},t.xml_isQName=function(e){for(var t=!1,n=0;n<e.length;n++){var r=e.charCodeAt(n);if(!(r>=97&&r<=122||r>=65&&r<=90||95===r||r>=192&&r<=214||r>=216&&r<=246||r>=248&&r<=767||r>=880&&r<=893||r>=895&&r<=8191||r>=8204&&r<=8205||r>=8304&&r<=8591||r>=11264&&r<=12271||r>=12289&&r<=55295||r>=63744&&r<=64975||r>=65008&&r<=65533||0!==n&&(45===r||46===r||r>=48&&r<=57||183===r||r>=768&&r<=879||r>=8255&&r<=8256))){if(0===n||58!==r){if(r>=55296&&r<=56319&&n<e.length-1){var i=e.charCodeAt(n+1);if(i>=56320&&i<=57343&&(n++,(r=1024*(r-55296)+i-56320+65536)>=65536&&r<=983039))continue}return!1}if(t)return!1;if(n===e.length-1)return!1;t=!0}}return!0},t.xml_isLegalChar=function(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(!(9===n||10===n||13===n||n>=32&&n<=55295||n>=57344&&n<=65533)){if(n>=55296&&n<=56319&&t<e.length-1){var r=e.charCodeAt(t+1);if(r>=56320&&r<=57343&&(t++,(n=1024*(n-55296)+r-56320+65536)>=65536&&n<=1114111))continue}return!1}}return!0},t.xml_isPubidChar=function(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(!(n>=97&&n<=122||n>=65&&n<=90||n>=39&&n<=59||32===n||13===n||10===n||n>=35&&n<=37||33===n||61===n||63===n||64===n||95===n))return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(17);t.boundaryPoint_position=function e(t,n){var o=t[0],a=t[1],s=n[0],l=n[1];if(console.assert(i.tree_rootNode(o)===i.tree_rootNode(s),"Boundary points must share the same root node."),o===s)return a===l?r.BoundaryPosition.Equal:a<l?r.BoundaryPosition.Before:r.BoundaryPosition.After;if(i.tree_isFollowing(s,o)){var c=e([s,l],[o,a]);if(c===r.BoundaryPosition.Before)return r.BoundaryPosition.After;if(c===r.BoundaryPosition.After)return r.BoundaryPosition.Before}if(i.tree_isAncestorOf(s,o)){for(var u=s;!i.tree_isChildOf(o,u);)null!==u._parent&&(u=u._parent);if(i.tree_index(u)<a)return r.BoundaryPosition.After}return r.BoundaryPosition.Before}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(3),a=n(7),s=n(29),l=n(108),c=n(30),u=n(37),d=n(52);t.node_stringReplaceAll=function(e,t){var n=null;""!==e&&(n=s.create_text(t._nodeDocument,e)),u.mutation_replaceAll(n,t)},t.node_clone=function e(t,n,a){var l,p,f,h,m;if(void 0===n&&(n=null),void 0===a&&(a=!1),null===n&&(n=t._nodeDocument),o.Guard.isElementNode(t)){m=d.element_createAnElement(n,t._localName,t._namespace,t._namespacePrefix,t._is,!1);try{for(var g=r(t._attributeList),v=g.next();!v.done;v=g.next()){var y=e(v.value,n);d.element_append(y,m)}}catch(e){l={error:e}}finally{try{v&&!v.done&&(p=g.return)&&p.call(g)}finally{if(l)throw l.error}}}else if(o.Guard.isDocumentNode(t)){var b=s.create_document();b._encoding=t._encoding,b._contentType=t._contentType,b._URL=t._URL,b._origin=t._origin,b._type=t._type,b._mode=t._mode,m=b}else if(o.Guard.isDocumentTypeNode(t))m=s.create_documentType(n,t._name,t._publicId,t._systemId);else if(o.Guard.isAttrNode(t)){var x=s.create_attr(n,t.localName);x._namespace=t._namespace,x._namespacePrefix=t._namespacePrefix,x._value=t._value,m=x}else m=o.Guard.isExclusiveTextNode(t)?s.create_text(n,t._data):o.Guard.isCDATASectionNode(t)?s.create_cdataSection(n,t._data):o.Guard.isCommentNode(t)?s.create_comment(n,t._data):o.Guard.isProcessingInstructionNode(t)?s.create_processingInstruction(n,t._target,t._data):o.Guard.isDocumentFragmentNode(t)?s.create_documentFragment(n):Object.create(t);if(o.Guard.isDocumentNode(m)?(m._nodeDocument=m,n=m):m._nodeDocument=n,i.dom.features.steps&&c.dom_runCloningSteps(m,t,n,a),a)try{for(var A=r(t._children),C=A.next();!C.done;C=A.next()){var T=e(C.value,n,!0);u.mutation_append(T,m)}}catch(e){f={error:e}}finally{try{C&&!C.done&&(h=A.return)&&h.call(A)}finally{if(f)throw f.error}}return m},t.node_equals=function e(t,n){var i,a,s,l;if(t._nodeType!==n._nodeType)return!1;if(o.Guard.isDocumentTypeNode(t)&&o.Guard.isDocumentTypeNode(n)){if(t._name!==n._name||t._publicId!==n._publicId||t._systemId!==n._systemId)return!1}else if(o.Guard.isElementNode(t)&&o.Guard.isElementNode(n)){if(t._namespace!==n._namespace||t._namespacePrefix!==n._namespacePrefix||t._localName!==n._localName||t._attributeList.length!==n._attributeList.length)return!1}else if(o.Guard.isAttrNode(t)&&o.Guard.isAttrNode(n)){if(t._namespace!==n._namespace||t._localName!==n._localName||t._value!==n._value)return!1}else if(o.Guard.isProcessingInstructionNode(t)&&o.Guard.isProcessingInstructionNode(n)){if(t._target!==n._target||t._data!==n._data)return!1}else if(o.Guard.isCharacterDataNode(t)&&o.Guard.isCharacterDataNode(n)&&t._data!==n._data)return!1;if(o.Guard.isElementNode(t)&&o.Guard.isElementNode(n)){var c={};try{for(var u=r(t._attributeList),d=u.next();!d.done;d=u.next())c[(h=d.value)._localName]=h}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}try{for(var p=r(n._attributeList),f=p.next();!f.done;f=p.next()){var h,m=f.value;if(!(h=c[m._localName]))return!1;if(!e(h,m))return!1}}catch(e){s={error:e}}finally{try{f&&!f.done&&(l=p.return)&&l.call(p)}finally{if(s)throw s.error}}}if(t._children.size!==n._children.size)return!1;for(var g=t._children[Symbol.iterator](),v=n._children[Symbol.iterator](),y=g.next(),b=v.next();!y.done&&!b.done;){if(!e(y.value,b.value))return!1;y=g.next(),b=v.next()}return!0},t.node_listOfElementsWithQualifiedName=function(e,t){return"*"===e?s.create_htmlCollection(t):"html"===t._nodeDocument._type?s.create_htmlCollection(t,(function(t){return t._namespace===a.namespace.HTML&&t._qualifiedName===e.toLowerCase()||t._namespace!==a.namespace.HTML&&t._qualifiedName===e})):s.create_htmlCollection(t,(function(t){return t._qualifiedName===e}))},t.node_listOfElementsWithNamespace=function(e,t,n){return""===e&&(e=null),"*"===e&&"*"===t?s.create_htmlCollection(n):"*"===e?s.create_htmlCollection(n,(function(e){return e._localName===t})):"*"===t?s.create_htmlCollection(n,(function(t){return t._namespace===e})):s.create_htmlCollection(n,(function(n){return n._localName===t&&n._namespace===e}))},t.node_listOfElementsWithClassNames=function(e,t){var n=l.orderedSet_parse(e);if(0===n.size)return s.create_htmlCollection(t,(function(){return!1}));var r="quirks"!==t._nodeDocument._mode;return s.create_htmlCollection(t,(function(e){var t=e.classList;return l.orderedSet_contains(t._tokenSet,n,r)}))},t.node_locateANamespacePrefix=function e(t,n){if(t._namespace===n&&null!==t._namespacePrefix)return t._namespacePrefix;for(var r=0;r<t._attributeList.length;r++){var i=t._attributeList[r];if("xmlns"===i._namespacePrefix&&i._value===n)return i._localName}return t._parent&&o.Guard.isElementNode(t._parent)?e(t._parent,n):null},t.node_locateANamespace=function e(t,n){if(o.Guard.isElementNode(t)){if(null!==t._namespace&&t._namespacePrefix===n)return t._namespace;for(var r=0;r<t._attributeList.length;r++){var i=t._attributeList[r];if(i._namespace===a.namespace.XMLNS&&"xmlns"===i._namespacePrefix&&i._localName===n)return i._value||null;if(null===n&&i._namespace===a.namespace.XMLNS&&null===i._namespacePrefix&&"xmlns"===i._localName)return i._value||null}return null===t.parentElement?null:e(t.parentElement,n)}return o.Guard.isDocumentNode(t)?null===t.documentElement?null:e(t.documentElement,n):o.Guard.isDocumentTypeNode(t)||o.Guard.isDocumentFragmentNode(t)?null:o.Guard.isAttrNode(t)?null===t._element?null:e(t._element,n):t._parent&&o.Guard.isElementNode(t._parent)?e(t._parent,n):null}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(3),a=n(9),s=n(29),l=n(17),c=n(107),u=n(37);t.text_contiguousTextNodes=function(e,t){var n;return void 0===t&&(t=!1),(n={})[Symbol.iterator]=function(){for(var n=e;n&&o.Guard.isTextNode(n._previousSibling);)n=n._previousSibling;return{next:function(){if(n&&!t&&n===e&&(n=o.Guard.isTextNode(n._nextSibling)?n._nextSibling:null),null===n)return{done:!0,value:null};var r={done:!1,value:n};return n=o.Guard.isTextNode(n._nextSibling)?n._nextSibling:null,r}}},n},t.text_contiguousExclusiveTextNodes=function(e,t){var n;return void 0===t&&(t=!1),(n={})[Symbol.iterator]=function(){for(var n=e;n&&o.Guard.isExclusiveTextNode(n._previousSibling);)n=n._previousSibling;return{next:function(){if(n&&!t&&n===e&&(n=o.Guard.isExclusiveTextNode(n._nextSibling)?n._nextSibling:null),null===n)return{done:!0,value:null};var r={done:!1,value:n};return n=o.Guard.isExclusiveTextNode(n._nextSibling)?n._nextSibling:null,r}}},n},t.text_descendantTextContent=function(e){for(var t="",n=l.tree_getFirstDescendantNode(e,!1,!1,(function(e){return o.Guard.isTextNode(e)}));null!==n;)t+=n._data,n=l.tree_getNextDescendantNode(e,n,!1,!1,(function(e){return o.Guard.isTextNode(e)}));return t},t.text_split=function(e,t){var n,o,d=e._data.length;if(t>d)throw new a.IndexSizeError;var p=d-t,f=c.characterData_substringData(e,t,p),h=s.create_text(e._nodeDocument,f),m=e._parent;if(null!==m){u.mutation_insert(h,m,e._nextSibling);try{for(var g=r(i.dom.rangeList),v=g.next();!v.done;v=g.next()){var y=v.value;y._start[0]===e&&y._start[1]>t&&(y._start[0]=h,y._start[1]-=t),y._end[0]===e&&y._end[1]>t&&(y._end[0]=h,y._end[1]-=t);var b=l.tree_index(e);y._start[0]===m&&y._start[1]===b+1&&y._start[1]++,y._end[0]===m&&y._end[1]===b+1&&y._end[1]++}}catch(e){n={error:e}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(n)throw n.error}}}return c.characterData_replaceData(e,t,p,""),h}},function(e,t,n){"use strict";var r=n(4),i=n(41),o=n(24),a=n(48),s=[].join,l=i!=Object,c=a("join",",");r({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(o(this),void 0===e?",":e)}})},function(e,t,n){var r=n(4),i=n(83),o=String.fromCharCode,a=String.fromCodePoint;r({target:"String",stat:!0,forced:!!a&&1!=a.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var i=n(111),o=function(){function e(e,t){this._options={skipWhitespaceOnlyText:!1},this.err={line:-1,col:-1,index:-1,str:""},this._str=e,this._index=0,this._length=e.length,t&&(this._options.skipWhitespaceOnlyText=t.skipWhitespaceOnlyText||!1)}return e.prototype.nextToken=function(){if(this.eof())return{type:i.TokenType.EOF};var t=this.skipIfStartsWith("<")?this.openBracket():this.text();return this._options.skipWhitespaceOnlyText&&t.type===i.TokenType.Text&&e.isWhiteSpaceToken(t)&&(t=this.nextToken()),t},e.prototype.openBracket=function(){return this.skipIfStartsWith("?")?this.skipIfStartsWith("xml")?e.isSpace(this._str[this._index])?this.declaration():(this.seek(-3),this.pi()):this.pi():this.skipIfStartsWith("!")?this.skipIfStartsWith("--")?this.comment():this.skipIfStartsWith("[CDATA[")?this.cdata():this.skipIfStartsWith("DOCTYPE")?this.doctype():void this.throwError("Invalid '!' in opening tag."):this.skipIfStartsWith("/")?this.closeTag():this.openTag()},e.prototype.declaration=function(){for(var e="",t="",n="";!this.eof();){if(this.skipSpace(),this.skipIfStartsWith("?>"))return{type:i.TokenType.Declaration,version:e,encoding:t,standalone:n};var o=r(this.attribute(),2),a=o[0],s=o[1];"version"===a?e=s:"encoding"===a?t=s:"standalone"===a?n=s:this.throwError("Invalid attribute name: "+a)}this.throwError("Missing declaration end symbol `?>`")},e.prototype.doctype=function(){var e="",t="";this.skipSpace();var n=this.takeUntil2("[",">",!0);return this.skipSpace(),this.skipIfStartsWith("PUBLIC")?(e=this.quotedString(),t=this.quotedString()):this.skipIfStartsWith("SYSTEM")&&(t=this.quotedString()),this.skipSpace(),this.skipIfStartsWith("[")&&(this.skipUntil("]"),this.skipIfStartsWith("]")||this.throwError("Missing end bracket of DTD internal subset")),this.skipSpace(),this.skipIfStartsWith(">")||this.throwError("Missing doctype end symbol `>`"),{type:i.TokenType.DocType,name:n,pubId:e,sysId:t}},e.prototype.pi=function(){var e=this.takeUntilStartsWith("?>",!0);if(this.eof()&&this.throwError("Missing processing instruction end symbol `?>`"),this.skipSpace(),this.skipIfStartsWith("?>"))return{type:i.TokenType.PI,target:e,data:""};var t=this.takeUntilStartsWith("?>");return this.eof()&&this.throwError("Missing processing instruction end symbol `?>`"),this.seek(2),{type:i.TokenType.PI,target:e,data:t}},e.prototype.text=function(){var e=this.takeUntil("<");return{type:i.TokenType.Text,data:e}},e.prototype.comment=function(){var e=this.takeUntilStartsWith("--\x3e");return this.eof()&&this.throwError("Missing comment end symbol `--\x3e`"),this.seek(3),{type:i.TokenType.Comment,data:e}},e.prototype.cdata=function(){var e=this.takeUntilStartsWith("]]>");return this.eof()&&this.throwError("Missing CDATA end symbol `]>`"),this.seek(3),{type:i.TokenType.CDATA,data:e}},e.prototype.openTag=function(){this.skipSpace();var e=this.takeUntil2(">","/",!0);if(this.skipSpace(),this.skipIfStartsWith(">"))return{type:i.TokenType.Element,name:e,attributes:[],selfClosing:!1};if(this.skipIfStartsWith("/>"))return{type:i.TokenType.Element,name:e,attributes:[],selfClosing:!0};for(var t=[];!this.eof();){if(this.skipSpace(),this.skipIfStartsWith(">"))return{type:i.TokenType.Element,name:e,attributes:t,selfClosing:!1};if(this.skipIfStartsWith("/>"))return{type:i.TokenType.Element,name:e,attributes:t,selfClosing:!0};var n=this.attribute();t.push(n)}this.throwError("Missing opening element tag end symbol `>`")},e.prototype.closeTag=function(){this.skipSpace();var e=this.takeUntil(">",!0);return this.skipSpace(),this.skipIfStartsWith(">")||this.throwError("Missing closing element tag end symbol `>`"),{type:i.TokenType.ClosingTag,name:e}},e.prototype.attribute=function(){this.skipSpace();var e=this.takeUntil("=",!0);return this.skipSpace(),this.skipIfStartsWith("=")||this.throwError("Missing equals sign before attribute value"),[e,this.quotedString()]},e.prototype.quotedString=function(){this.skipSpace();var t=this.take(1);e.isQuote(t)||this.throwError("Missing start quote character before quoted value");var n=this.takeUntil(t);return this.skipIfStartsWith(t)||this.throwError("Missing end quote character after quoted value"),n},e.prototype.eof=function(){return this._index>=this._length},e.prototype.skipIfStartsWith=function(e){var t=e.length;if(1===t)return this._str[this._index]===e&&(this._index++,!0);for(var n=0;n<t;n++)if(this._str[this._index+n]!==e[n])return!1;return this._index+=t,!0},e.prototype.seek=function(e){this._index+=e,this._index<0&&(this._index=0),this._index>this._length&&(this._index=this._length)},e.prototype.skipSpace=function(){for(;!this.eof()&&e.isSpace(this._str[this._index]);)this._index++},e.prototype.take=function(e){if(1===e)return this._str[this._index++];var t=this._index;return this.seek(e),this._str.slice(t,this._index)},e.prototype.takeUntil=function(t,n){void 0===n&&(n=!1);for(var r=this._index;this._index<this._length;){var i=this._str[this._index];if(i===t||n&&e.isSpace(i))break;this._index++}return this._str.slice(r,this._index)},e.prototype.takeUntil2=function(t,n,r){void 0===r&&(r=!1);for(var i=this._index;this._index<this._length;){var o=this._str[this._index];if(o===t||o===n||r&&e.isSpace(o))break;this._index++}return this._str.slice(i,this._index)},e.prototype.takeUntilStartsWith=function(t,n){void 0===n&&(n=!1);for(var r=this._index,i=t.length;this._index<this._length;){for(var o=!0,a=0;a<i;a++){var s=this._str[this._index+a],l=t[a];if(n&&e.isSpace(s))return this._str.slice(r,this._index);if(s!==l){this._index++,o=!1;break}}if(o)return this._str.slice(r,this._index)}return this._index=this._length,this._str.slice(r)},e.prototype.skipUntil=function(e){for(;this._index<this._length&&this._str[this._index]!==e;)this._index++},e.isWhiteSpaceToken=function(e){for(var t=e.data,n=0;n<t.length;n++){var r=t[n];if(" "!==r&&"\n"!==r&&"\r"!==r&&"\t"!==r&&"\f"!==r)return!1}return!0},e.isSpace=function(e){return" "===e||"\n"===e||"\r"===e||"\t"===e},e.isQuote=function(e){return'"'===e||"'"===e},e.prototype.throwError=function(e){for(var t=/\r\n|\r|\n/g,n=null,r=0,i=0,o=this._str.length;null!==(n=t.exec(this._str))&&null!==n;)if(r++,n.index<this._index&&(i=t.lastIndex),n.index>this._index){o=n.index;break}throw this.err={line:r,col:this._index-i,index:this._index,str:this._str.substring(i,o)},new Error(e+"\nIndex: "+this.err.index+"\nLn: "+this.err.line+", Col: "+this.err.col+"\nInput: "+this.err.str)},e.prototype[Symbol.iterator]=function(){return this._index=0,{next:function(){var e=this.nextToken();return e.type===i.TokenType.EOF?{done:!0,value:null}:{done:!1,value:e}}.bind(this)}},e}();t.XMLStringLexer=o},function(e,t,n){"use strict";var r=n(39);e.exports=new r({include:[n(182)]})},function(e,t,n){"use strict";var r=n(39);e.exports=new r({include:[n(113)],implicit:[n(289),n(290),n(291),n(292)]})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(91),i=n(1),o=n(3),a=n(77),s=n(109);function l(e,t){var n=u(void 0===e||c(e)?e:r.DefaultBuilderOptions),i=c(e)?t:e,o=s.createDocument();d(o,n);var l=new a.XMLBuilderImpl(o);return void 0!==i&&l.ele(i),l}function c(e){if(!i.isPlainObject(e))return!1;for(var t in e)if(e.hasOwnProperty(t)&&!r.XMLBuilderOptionKeys.has(t))return!1;return!0}function u(e){void 0===e&&(e={});var t=i.applyDefaults(e,r.DefaultBuilderOptions);if(0===t.convert.att.length||0===t.convert.ins.length||0===t.convert.text.length||0===t.convert.cdata.length||0===t.convert.comment.length)throw new Error("JS object converter strings cannot be zero length.");return t}function d(e,t,n){var r=e;r._xmlBuilderOptions=t,r._isFragment=n}t.builder=function(e,t){var n=u(c(e)?e:r.DefaultBuilderOptions),s=o.Guard.isNode(e)||i.isArray(e)?e:t;if(void 0===s)throw new Error("Invalid arguments.");if(i.isArray(s)){for(var l=[],d=0;d<s.length;d++){var p=new a.XMLBuilderImpl(s[d]);p.set(n),l.push(p)}return l}var f=new a.XMLBuilderImpl(s);return f.set(n),f},t.create=l,t.fragment=function(e,t){var n=u(void 0===e||c(e)?e:r.DefaultBuilderOptions),i=c(e)?t:e,o=s.createDocument();d(o,n,!0);var l=new a.XMLBuilderImpl(o.createDocumentFragment());return void 0!==i&&l.ele(i),l},t.convert=function(e,t,n){var i,o,a;return c(e)&&void 0!==t?(i=e,o=t,a=n):(i=r.DefaultBuilderOptions,o=e,a=t||void 0),l(i,o).end(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77);t.builder=r.builder,t.create=r.create,t.fragment=r.fragment,t.convert=r.convert,t.createCB=r.createCB,t.fragmentCB=r.fragmentCB},function(e,t,n){"use strict";n(31),n(32),n(33),n(191),n(192),n(194),n(64),n(19),n(198),n(199),n(89),n(201),n(65),n(20),n(66),n(22),n(23);var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=n(91),a=n(1),s=n(217),l=n(2),c=n(3),u=n(0),d=n(109),p=n(7),f=n(276),h=function(){function e(e){this._domNode=e}return Object.defineProperty(e.prototype,"node",{get:function(){return this._domNode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),e.prototype.set=function(e){return this._options=a.applyDefaults(a.applyDefaults(this._options,e,!0),o.DefaultBuilderOptions),this},e.prototype.ele=function(t,n,i){var o,s,l,c,p,h;if(a.isObject(t))return new f.ObjectReader(this._options).parse(this,t);if(null!==t&&/^\s*</.test(t))return new f.XMLReader(this._options).parse(this,t);if(null!==t&&/^\s*[\{\[]/.test(t))return new f.JSONReader(this._options).parse(this,t);if(null!==t&&/^(\s*|(#.*)|(%.*))*---/.test(t))return new f.YAMLReader(this._options).parse(this,t);if((null===t||a.isString(t))&&a.isString(n))c=(o=r([t,n,i],3))[0],p=o[1],h=o[2];else{if(null===t)throw new Error("Element name cannot be null. "+this._debugInfo());c=(s=r([void 0,t,a.isObject(n)?n:void 0],3))[0],p=s[1],h=s[2]}if(h&&(h=a.getValue(h)),c=(l=r(this._extractNamespace(d.sanitizeInput(c,this._options.invalidCharReplacement),d.sanitizeInput(p,this._options.invalidCharReplacement),!0),2))[0],p=l[1],void 0===c){var m=r(u.namespace_extractQName(p),1)[0];c=this.node.lookupNamespaceURI(m)}var g=null!=c?this._doc.createElementNS(c,p):this._doc.createElement(p);this.node.appendChild(g);var v=new e(g),y=this._doc.doctype;if(g===this._doc.documentElement&&null!==y){var b=this._doc.implementation.createDocumentType(this._doc.documentElement.tagName,y.publicId,y.systemId);this._doc.replaceChild(b,y)}return h&&!a.isEmpty(h)&&v.att(h),v},e.prototype.remove=function(){var e=this.up();return e.node.removeChild(this.node),e},e.prototype.att=function(e,t,n){var i,o,s,l,f,h,m=this;if(a.isMap(e)||a.isObject(e))return a.forEachObject(e,(function(e,t){return m.att(e,t)}),this),this;if(null!=e&&(e=a.getValue(e+"")),null!=t&&(t=a.getValue(t+"")),null!=n&&(n=a.getValue(n+"")),null!==e&&!a.isString(e)||!a.isString(t)||null!==n&&!a.isString(n)){if(!a.isString(e)||null!=t&&!a.isString(t))throw new Error("Attribute name and value not specified. "+this._debugInfo());l=(o=r([void 0,e,t],3))[0],f=o[1],h=o[2]}else l=(i=r([e,t,n],3))[0],f=i[1],h=i[2];if(this._options.keepNullAttributes&&null==h)h="";else if(null==h)return this;if(!c.Guard.isElementNode(this.node))throw new Error("An attribute can only be assigned to an element node.");var g=this.node;l=(s=r(this._extractNamespace(l,f,!1),2))[0],f=s[1],f=d.sanitizeInput(f,this._options.invalidCharReplacement),l=d.sanitizeInput(l,this._options.invalidCharReplacement),h=d.sanitizeInput(h,this._options.invalidCharReplacement);var v=r(u.namespace_extractQName(f),2),y=v[0],b=v[1],x=r(u.namespace_extractQName(g.prefix?g.prefix+":"+g.localName:g.localName),1)[0],A=null;return"xmlns"===y?(l=p.namespace.XMLNS,null===g.namespaceURI&&x===b&&(A=h)):null===y&&"xmlns"===b&&null===x&&(l=p.namespace.XMLNS,A=h),null!==A&&(this._updateNamespace(A),g=this.node),void 0!==l?g.setAttributeNS(l,f,h):g.setAttribute(f,h),this},e.prototype.removeAtt=function(e,t){var n,r,i=this;if(!c.Guard.isElementNode(this.node))throw new Error("An attribute can only be removed from an element node.");if(e=a.getValue(e),void 0!==t&&(t=a.getValue(t)),null!==e&&void 0===t)r=e;else{if(null!==e&&!a.isString(e)||void 0===t)throw new Error("Attribute namespace must be a string. "+this._debugInfo());n=e,r=t}return a.isArray(r)||a.isSet(r)?a.forEachArray(r,(function(e){return void 0===n?i.removeAtt(e):i.removeAtt(n,e)}),this):void 0!==n?(r=d.sanitizeInput(r,this._options.invalidCharReplacement),n=d.sanitizeInput(n,this._options.invalidCharReplacement),this.node.removeAttributeNS(n,r)):(r=d.sanitizeInput(r,this._options.invalidCharReplacement),this.node.removeAttribute(r)),this},e.prototype.txt=function(e){if(null==e){if(!this._options.keepNullNodes)return this;e=""}var t=this._doc.createTextNode(d.sanitizeInput(e,this._options.invalidCharReplacement));return this.node.appendChild(t),this},e.prototype.com=function(e){if(null==e){if(!this._options.keepNullNodes)return this;e=""}var t=this._doc.createComment(d.sanitizeInput(e,this._options.invalidCharReplacement));return this.node.appendChild(t),this},e.prototype.dat=function(e){if(null==e){if(!this._options.keepNullNodes)return this;e=""}var t=this._doc.createCDATASection(d.sanitizeInput(e,this._options.invalidCharReplacement));return this.node.appendChild(t),this},e.prototype.ins=function(e,t){var n=this;if(void 0===t&&(t=""),null==t){if(!this._options.keepNullNodes)return this;t=""}if(a.isArray(e)||a.isSet(e))a.forEachArray(e,(function(e){var t=(e+="").indexOf(" "),r=-1===t?e:e.substr(0,t),i=-1===t?"":e.substr(t+1);n.ins(r,i)}),this);else if(a.isMap(e)||a.isObject(e))a.forEachObject(e,(function(e,t){return n.ins(e,t)}),this);else{var r=this._doc.createProcessingInstruction(d.sanitizeInput(e,this._options.invalidCharReplacement),d.sanitizeInput(t,this._options.invalidCharReplacement));this.node.appendChild(r)}return this},e.prototype.dec=function(e){return this._options.version=e.version||"1.0",this._options.encoding=e.encoding,this._options.standalone=e.standalone,this},e.prototype.dtd=function(e){var t=d.sanitizeInput(e&&e.name||(this._doc.documentElement?this._doc.documentElement.tagName:"ROOT"),this._options.invalidCharReplacement),n=d.sanitizeInput(e&&e.pubID||"",this._options.invalidCharReplacement),r=d.sanitizeInput(e&&e.sysID||"",this._options.invalidCharReplacement);if(null!==this._doc.documentElement&&t!==this._doc.documentElement.tagName)throw new Error("DocType name does not match document element name.");var i=this._doc.implementation.createDocumentType(t,n,r);return null!==this._doc.doctype?this._doc.replaceChild(i,this._doc.doctype):this._doc.insertBefore(i,this._doc.documentElement),this},e.prototype.import=function(t){var n,o,a=this._domNode,s=this._doc,l=t.node;if(c.Guard.isDocumentNode(l)){var d=l.documentElement;if(null===d)throw new Error("Imported document has no document element node. "+this._debugInfo());var p=s.importNode(d,!0);a.appendChild(p);var f=r(u.namespace_extractQName(p.prefix?p.prefix+":"+p.localName:p.localName),1)[0],h=a.lookupNamespaceURI(f);new e(p)._updateNamespace(h)}else if(c.Guard.isDocumentFragmentNode(l))try{for(var m=i(l.childNodes),g=m.next();!g.done;g=m.next()){var v=g.value;p=s.importNode(v,!0),a.appendChild(p),c.Guard.isElementNode(p)&&(f=r(u.namespace_extractQName(p.prefix?p.prefix+":"+p.localName:p.localName),1)[0],h=a.lookupNamespaceURI(f),new e(p)._updateNamespace(h))}}catch(e){n={error:e}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(n)throw n.error}}else p=s.importNode(l,!0),a.appendChild(p),c.Guard.isElementNode(p)&&(f=r(u.namespace_extractQName(p.prefix?p.prefix+":"+p.localName:p.localName),1)[0],h=a.lookupNamespaceURI(f),new e(p)._updateNamespace(h));return this},e.prototype.doc=function(){if(this._doc._isFragment){for(var t=this.node;t&&t.nodeType!==l.NodeType.DocumentFragment;)t=t.parentNode;if(null===t)throw new Error("Node has no parent node while searching for document fragment ancestor. "+this._debugInfo());return new e(t)}return new e(this._doc)},e.prototype.root=function(){var t=this._doc.documentElement;if(!t)throw new Error("Document root element is null. "+this._debugInfo());return new e(t)},e.prototype.up=function(){var t=this._domNode.parentNode;if(!t)throw new Error("Parent node is null. "+this._debugInfo());return new e(t)},e.prototype.prev=function(){var t=this._domNode.previousSibling;if(!t)throw new Error("Previous sibling node is null. "+this._debugInfo());return new e(t)},e.prototype.next=function(){var t=this._domNode.nextSibling;if(!t)throw new Error("Next sibling node is null. "+this._debugInfo());return new e(t)},e.prototype.first=function(){var t=this._domNode.firstChild;if(!t)throw new Error("First child node is null. "+this._debugInfo());return new e(t)},e.prototype.last=function(){var t=this._domNode.lastChild;if(!t)throw new Error("Last child node is null. "+this._debugInfo());return new e(t)},e.prototype.each=function(t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1);for(var o=this._getFirstDescendantNode(this._domNode,n,r);o[0];){var a=this._getNextDescendantNode(this._domNode,o[0],r,o[1],o[2]);t.call(i,new e(o[0]),o[1],o[2]),o=a}return this},e.prototype.map=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=[];return this.each((function(t,n,o){return i.push(e.call(r,t,n,o))}),t,n),i},e.prototype.reduce=function(e,t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1);var o=t;return this.each((function(t,n,r){return o=e.call(i,o,t,n,r)}),n,r),o},e.prototype.find=function(t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1);for(var o=this._getFirstDescendantNode(this._domNode,n,r);o[0];){var a=new e(o[0]);if(t.call(i,a,o[1],o[2]))return a;o=this._getNextDescendantNode(this._domNode,o[0],r,o[1],o[2])}},e.prototype.filter=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=[];return this.each((function(t,n,o){e.call(r,t,n,o)&&i.push(t)}),t,n),i},e.prototype.every=function(t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1);for(var o=this._getFirstDescendantNode(this._domNode,n,r);o[0];){var a=new e(o[0]);if(!t.call(i,a,o[1],o[2]))return!1;o=this._getNextDescendantNode(this._domNode,o[0],r,o[1],o[2])}return!0},e.prototype.some=function(t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1);for(var o=this._getFirstDescendantNode(this._domNode,n,r);o[0];){var a=new e(o[0]);if(t.call(i,a,o[1],o[2]))return!0;o=this._getNextDescendantNode(this._domNode,o[0],r,o[1],o[2])}return!1},e.prototype.toArray=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var n=[];return this.each((function(e){return n.push(e)}),e,t),n},e.prototype.toString=function(e){return void 0===(e=e||{}).format&&(e.format="xml"),this._serialize(e)},e.prototype.toObject=function(e){return void 0===(e=e||{}).format&&(e.format="object"),this._serialize(e)},e.prototype.end=function(e){return void 0===(e=e||{}).format&&(e.format="xml"),this.doc()._serialize(e)},e.prototype._getFirstDescendantNode=function(e,t,n){return t?[this._domNode,0,0]:n?this._getNextDescendantNode(e,e,n,0,0):[this._domNode.firstChild,0,1]},e.prototype._getNextDescendantNode=function(e,t,n,r,i){if(!n)return e===t?[t.firstChild,0,i+1]:[t.nextSibling,r+1,i];if(t.firstChild)return[t.firstChild,0,i+1];if(t===e)return[null,-1,-1];if(t.nextSibling)return[t.nextSibling,r+1,i];for(var o=t.parentNode;o&&o!==e;){if(o.nextSibling)return[o.nextSibling,u.tree_index(o.nextSibling),i-1];o=o.parentNode,i--}return[null,-1,-1]},e.prototype._serialize=function(e){if("xml"===e.format)return new s.XMLWriter(this._options,e).serialize(this.node);if("map"===e.format)return new s.MapWriter(this._options,e).serialize(this.node);if("object"===e.format)return new s.ObjectWriter(this._options,e).serialize(this.node);if("json"===e.format)return new s.JSONWriter(this._options,e).serialize(this.node);if("yaml"===e.format)return new s.YAMLWriter(this._options,e).serialize(this.node);throw new Error("Invalid writer format: "+e.format+". "+this._debugInfo())},e.prototype._extractNamespace=function(e,t,n){var r=t.indexOf("@");if(r>0&&(void 0===e&&(e=t.slice(r+1)),t=t.slice(0,r)),void 0===e)e=n?this._options.defaultNamespace.ele:this._options.defaultNamespace.att;else if(null!==e&&"@"===e[0]){var i=e.slice(1);if(void 0===(e=this._options.namespaceAlias[i]))throw new Error("Namespace alias `"+i+"` is not defined. "+this._debugInfo())}return[e,t]},e.prototype._updateNamespace=function(t){var n,o,a,s,l=this._domNode;if(c.Guard.isElementNode(l)&&null!==t&&l.namespaceURI!==t){var d=r(u.namespace_extractQName(l.prefix?l.prefix+":"+l.localName:l.localName),2),p=d[0],f=d[1],h=u.create_element(this._doc,f,t,p);try{for(var m=i(l.attributes),g=m.next();!g.done;g=m.next()){var v=g.value,y=v.prefix?v.prefix+":"+v.localName:v.localName,b=r(u.namespace_extractQName(y),1)[0],x=v.namespaceURI;null===x&&null!==b&&(x=l.lookupNamespaceURI(b)),null===x?h.setAttribute(y,v.value):h.setAttributeNS(x,y,v.value)}}catch(e){n={error:e}}finally{try{g&&!g.done&&(o=m.return)&&o.call(m)}finally{if(n)throw n.error}}var A=l.parentNode;if(null===A)throw new Error("Parent node is null."+this._debugInfo());A.replaceChild(h,l),this._domNode=h;try{for(var C=i(l.childNodes),T=C.next();!T.done;T=C.next()){var S=T.value.cloneNode(!0);if(h.appendChild(S),c.Guard.isElementNode(S)){var w=r(u.namespace_extractQName(S.prefix?S.prefix+":"+S.localName:S.localName),1)[0],_=h.lookupNamespaceURI(w);new e(S)._updateNamespace(_)}}}catch(e){a={error:e}}finally{try{T&&!T.done&&(s=C.return)&&s.call(C)}finally{if(a)throw a.error}}}},Object.defineProperty(e.prototype,"_doc",{get:function(){var e=this.node;if(c.Guard.isDocumentNode(e))return e;var t=e.ownerDocument;if(!t)throw new Error("Owner document is null. "+this._debugInfo());return t},enumerable:!0,configurable:!0}),e.prototype._debugInfo=function(e){var t=this.node,n=t.parentNode;e=e||t.nodeName;var r=n?n.nodeName:"";return r?"node: <"+e+">, parent: <"+r+">":"node: <"+e+">"},Object.defineProperty(e.prototype,"_options",{get:function(){var e=this._doc;if(void 0===e._xmlBuilderOptions)throw new Error("Builder options is not set.");return e._xmlBuilderOptions},set:function(e){this._doc._xmlBuilderOptions=e},enumerable:!0,configurable:!0}),e}();t.XMLBuilderImpl=h},function(e,t,n){var r=n(11),i=n(117),o=r.WeakMap;e.exports="function"==typeof o&&/native code/.test(i(o))},function(e,t,n){var r=n(46),i=n(82),o=n(85),a=n(18);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(16),i=n(15),o=n(18),a=n(61);e.exports=r?Object.defineProperties:function(e,t){o(e);for(var n,r=a(t),s=r.length,l=0;s>l;)i.f(e,n=r[l++],t[n]);return e}},function(e,t,n){var r=n(46);e.exports=r("document","documentElement")},function(e,t,n){var r=n(24),i=n(82).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){"use strict";var r=n(4),i=n(36).every,o=n(48),a=n(28),s=o("every"),l=a("every");r({target:"Array",proto:!0,forced:!s||!l},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(4),i=n(36).filter,o=n(63),a=n(28),s=o("filter"),l=a("filter");r({target:"Array",proto:!0,forced:!s||!l},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(46);e.exports=r("navigator","userAgent")||""},function(e,t,n){"use strict";var r=n(4),i=n(36).find,o=n(130),a=n(28),s=!0,l=a("find");"find"in[]&&Array(1).find((function(){s=!1})),r({target:"Array",proto:!0,forced:s||!l},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("find")},function(e,t,n){"use strict";var r=n(131).IteratorPrototype,i=n(60),o=n(40),a=n(62),s=n(49),l=function(){return this};e.exports=function(e,t,n){var c=t+" Iterator";return e.prototype=i(r,{next:o(1,n)}),a(e,c,!1,!0),s[c]=l,e}},function(e,t,n){var r=n(8);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){var r=n(13);e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},function(e,t,n){"use strict";var r=n(4),i=n(36).map,o=n(63),a=n(28),s=o("map"),l=a("map");r({target:"Array",proto:!0,forced:!s||!l},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(4),i=n(200).left,o=n(48),a=n(28),s=o("reduce"),l=a("reduce",{1:0});r({target:"Array",proto:!0,forced:!s||!l},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(127),i=n(27),o=n(41),a=n(26),s=function(e){return function(t,n,s,l){r(n);var c=i(t),u=o(c),d=a(c.length),p=e?d-1:0,f=e?-1:1;if(s<2)for(;;){if(p in u){l=u[p],p+=f;break}if(p+=f,e?p<0:d<=p)throw TypeError("Reduce of empty array with no initial value")}for(;e?p>=0:d>p;p+=f)p in u&&(l=n(l,u[p],p,c));return l}};e.exports={left:s(!1),right:s(!0)}},function(e,t,n){"use strict";var r=n(4),i=n(36).some,o=n(48),a=n(28),s=o("some"),l=a("some");r({target:"Array",proto:!0,forced:!s||!l},{some:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(90),i=n(135);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,n){var r=n(8);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,n){var r=n(5),i=n(49),o=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},function(e,t,n){var r=n(135),i=n(49),o=n(5)("iterator");e.exports=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(18);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(5)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},function(e,t,n){var r=n(13),i=n(133);e.exports=function(e,t,n){var o,a;return i&&"function"==typeof(o=t.constructor)&&o!==n&&r(a=o.prototype)&&a!==n.prototype&&i(e,a),e}},function(e,t,n){var r=n(25);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var r=n(46),i=n(15),o=n(5),a=n(16),s=o("species");e.exports=function(e){var t=r(e),n=i.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){void 0===e&&(e=1e3),this._items=new Set,this._limit=e}return e.prototype.add=function(e){if(this._items.add(e),this._items.size>this._limit){var t=this._items.values().next();t.done||this._items.delete(t.value)}return this},e.prototype.delete=function(e){return this._items.delete(e)},e.prototype.has=function(e){return this._items.has(e)},e.prototype.clear=function(){this._items.clear()},Object.defineProperty(e.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;this._items.forEach((function(r){return e.call(t,r,r,n)}))},e.prototype.keys=function(){return r(this,(function(e){switch(e.label){case 0:return[5,i(this._items.keys())];case 1:return e.sent(),[2]}}))},e.prototype.values=function(){return r(this,(function(e){switch(e.label){case 0:return[5,i(this._items.values())];case 1:return e.sent(),[2]}}))},e.prototype.entries=function(){return r(this,(function(e){switch(e.label){case 0:return[5,i(this._items.entries())];case 1:return e.sent(),[2]}}))},e.prototype[Symbol.iterator]=function(){return r(this,(function(e){switch(e.label){case 0:return[5,i(this._items)];case 1:return e.sent(),[2]}}))},Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"FixedSizeSet"},enumerable:!0,configurable:!0}),e}();t.FixedSizeSet=o},function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){void 0===e&&(e=1e3),this._items=new Map,this._limit=e}return e.prototype.get=function(e){return this._items.get(e)},e.prototype.set=function(e,t){if(this._items.set(e,t),this._items.size>this._limit){var n=this._items.keys().next();n.done||this._items.delete(n.value)}},e.prototype.delete=function(e){return this._items.delete(e)},e.prototype.has=function(e){return this._items.has(e)},e.prototype.clear=function(){this._items.clear()},Object.defineProperty(e.prototype,"size",{get:function(){return this._items.size},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e,t){this._items.forEach((function(n,r){return e.call(t,r,n)}))},e.prototype.keys=function(){return r(this,(function(e){switch(e.label){case 0:return[5,i(this._items.keys())];case 1:return e.sent(),[2]}}))},e.prototype.values=function(){return r(this,(function(e){switch(e.label){case 0:return[5,i(this._items.values())];case 1:return e.sent(),[2]}}))},e.prototype.entries=function(){return r(this,(function(e){switch(e.label){case 0:return[5,i(this._items.entries())];case 1:return e.sent(),[2]}}))},e.prototype[Symbol.iterator]=function(){return r(this,(function(e){switch(e.label){case 0:return[5,i(this._items)];case 1:return e.sent(),[2]}}))},Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"ObjectCache"},enumerable:!0,configurable:!0}),e}();t.ObjectCache=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=1e3),this._items=new Map,this._limit=e}return e.prototype.check=function(e,t){if(this._items.get(e)===t)return!0;if(this._items.get(t)===e)return!1;var n=Math.random()<.5;if(n?this._items.set(e,t):this._items.set(t,e),this._items.size>this._limit){var r=this._items.keys().next();r.done||this._items.delete(r.value)}return n},e}();t.CompareCache=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._initialized=!1,this._value=void 0,this._initFunc=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._initialized||(this._value=this._initFunc(),this._initialized=!0),this._value},enumerable:!0,configurable:!0}),e}();t.Lazy=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._pointer=0,this._chars=Array.from(e),this._length=this._chars.length}return Object.defineProperty(e.prototype,"eof",{get:function(){return this._pointer>=this._length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),e.prototype.codePoint=function(){if(void 0===this._codePoint)if(this.eof)this._codePoint=-1;else{var e=this._chars[this._pointer].codePointAt(0);this._codePoint=void 0!==e?e:-1}return this._codePoint},e.prototype.c=function(){return void 0===this._c&&(this._c=this.eof?"":this._chars[this._pointer]),this._c},e.prototype.remaining=function(){return void 0===this._remaining&&(this._remaining=this.eof?"":this._chars.slice(this._pointer+1).join("")),this._remaining},e.prototype.substring=function(){return void 0===this._substring&&(this._substring=this.eof?"":this._chars.slice(this._pointer).join("")),this._substring},Object.defineProperty(e.prototype,"pointer",{get:function(){return this._pointer},set:function(e){e!==this._pointer&&(this._pointer=e,this._codePoint=void 0,this._c=void 0,this._remaining=void 0,this._substring=void 0)},enumerable:!0,configurable:!0}),e}();t.StringWalker=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(218);t.MapWriter=r.MapWriter;var i=n(258);t.XMLWriter=i.XMLWriter;var o=n(67);t.ObjectWriter=o.ObjectWriter;var a=n(260);t.JSONWriter=a.JSONWriter;var s=n(261);t.YAMLWriter=s.YAMLWriter},function(e,t,n){"use strict";n(19),n(219),n(20),n(22),n(23);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(67),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r._writerOptions=o.applyDefaults(n,{format:"map",wellFormed:!1,group:!1,verbose:!1}),r}return i(t,e),t.prototype.serialize=function(e){var t=o.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1,verbose:!1}),n=new a.ObjectWriter(this._builderOptions,t).serialize(e);return this._convertObject(n)},t.prototype._convertObject=function(e){if(o.isArray(e)){for(var t=0;t<e.length;t++)e[t]=this._convertObject(e[t]);return e}if(o.isObject(e)){var n=new Map;for(var r in e)n.set(r,this._convertObject(e[r]));return n}return e},t}(n(50).BaseWriter);t.MapWriter=s},function(e,t,n){"use strict";var r=n(139),i=n(143);e.exports=r("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},function(e,t,n){"use strict";var r=n(4),i=n(8),o=n(59),a=n(13),s=n(27),l=n(26),c=n(134),u=n(128),d=n(63),p=n(5),f=n(129),h=p("isConcatSpreadable"),m=f>=51||!i((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),g=d("concat"),v=function(e){if(!a(e))return!1;var t=e[h];return void 0!==t?!!t:o(e)};r({target:"Array",proto:!0,forced:!m||!g},{concat:function(e){var t,n,r,i,o,a=s(this),d=u(a,0),p=0;for(t=-1,r=arguments.length;t<r;t++)if(v(o=-1===t?a:arguments[t])){if(p+(i=l(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,p++)n in o&&c(d,p,o[n])}else{if(p>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(d,p++,o)}return d.length=p,d}})},function(e,t,n){"use strict";var r=n(8);function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},function(e,t,n){var r=n(223);e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},function(e,t,n){var r=n(13),i=n(42),o=n(5)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(5)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,n){"use strict";n(68);var r=n(25),i=n(8),o=n(5),a=n(93),s=n(21),l=o("species"),c=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u="$0"==="a".replace(/./,"$0"),d=o("replace"),p=!!/./[d]&&""===/./[d]("a","$0"),f=!i((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,d){var h=o(e),m=!i((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),g=m&&!i((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!m||!g||"replace"===e&&(!c||!u||p)||"split"===e&&!f){var v=/./[h],y=n(h,""[e],(function(e,t,n,r,i){return t.exec===a?m&&!i?{done:!0,value:v.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:p}),b=y[0],x=y[1];r(String.prototype,e,b),r(RegExp.prototype,h,2==t?function(e,t){return x.call(e,this,t)}:function(e){return x.call(e,this)})}d&&s(RegExp.prototype[h],"sham",!0)}},function(e,t,n){"use strict";var r=n(137).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r=n(42),i=n(93);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n(96);t.forgivingBase64Encode=function(t){return e.from(t).toString("base64")},t.forgivingBase64Decode=function(t){return""===t?"":((t=t.replace(r.ASCIIWhiteSpace,"")).length%4==0&&(t.endsWith("==")?t=t.substr(0,t.length-2):t.endsWith("=")&&(t=t.substr(0,t.length-1))),t.length%4==1?null:/[0-9A-Za-z+/]/.test(t)?e.from(t,"base64").toString("utf8"):null)}}).call(this,n(145).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),a=r[0],s=r[1],l=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),u=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,l[u++]=255&t),1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(u(e,a,a+16383>s?s:a+16383));return 1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?i-1:0,p=n?-1:1,f=e[t+d];for(d+=p,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=p,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+e[t+d],d+=p,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=c}return(f?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+f]=255&s,f+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+f]=255&a,f+=h,a/=256,c-=8);e[n+f-h]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);function o(e){var t,n;if(null===e||i.isString(e)||i.isNumber(e))return e;if(i.isArray(e)){var a=new Array;try{for(var s=r(e),l=s.next();!l.done;l=s.next()){var c=l.value;a.push(o(c))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return a}if(i.isObject(e)){for(var u in a=new Map,e)if(e.hasOwnProperty(u)){var d=e[u];a.set(u,o(d))}return a}return e}t.parseJSONFromBytes=function(e){var t=i.utf8Decode(e);return JSON.parse.call(void 0,t)},t.serializeJSONToBytes=function(e){var t=JSON.stringify.call(void 0,e);return i.utf8Encode(t)},t.parseJSONIntoInfraValues=function(e){return o(JSON.parse.call(void 0,e))},t.convertAJSONDerivedJavaScriptValueToAnInfraValue=o},function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1);t.append=function(e,t){e.push(t)},t.extend=function(e,t){e.push.apply(e,o(t))},t.prepend=function(e,t){e.unshift(t)},t.replace=function(e,t,n){var r,i,o=0;try{for(var l=a(e),c=l.next();!c.done;c=l.next()){var u=c.value;if(s.isFunction(t))t.call(null,u)&&(e[o]=n);else if(u===t)return void(e[o]=n);o++}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}},t.insert=function(e,t,n){e.splice(n,0,t)},t.remove=function(e,t){for(var n=e.length;n--;){var r=e[n];if(s.isFunction(t))t.call(null,r)&&e.splice(n,1);else if(r===t)return void e.splice(n,1)}},t.empty=function(e){e.length=0},t.contains=function(e,t){var n,r;try{for(var i=a(e),o=i.next();!o.done;o=i.next()){var l=o.value;if(s.isFunction(t)){if(t.call(null,l))return!0}else if(l===t)return!0}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1},t.size=function(e,t){var n,r;if(void 0===t)return e.length;var i=0;try{for(var o=a(e),s=o.next();!s.done;s=o.next()){var l=s.value;t.call(null,l)&&i++}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},t.isEmpty=function(e){return 0===e.length},t.forEach=function(e,t){var n,i,o,s,l,c;return r(this,(function(r){switch(r.label){case 0:return void 0!==t?[3,2]:[5,a(e)];case 1:return r.sent(),[3,9];case 2:r.trys.push([2,7,8,9]),n=a(e),i=n.next(),r.label=3;case 3:return i.done?[3,6]:(o=i.value,t.call(null,o)?[4,o]:[3,5]);case 4:r.sent(),r.label=5;case 5:return i=n.next(),[3,3];case 6:return[3,9];case 7:return s=r.sent(),l={error:s},[3,9];case 8:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(l)throw l.error}return[7];case 9:return[2]}}))},t.clone=function(e){return new(Array.bind.apply(Array,o([void 0],e)))},t.sortInAscendingOrder=function(e,t){return e.sort((function(e,n){return t.call(null,e,n)?-1:1}))},t.sortInDescendingOrder=function(e,t){return e.sort((function(e,n){return t.call(null,e,n)?1:-1}))}},function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1);t.get=function(e,t){return e.get(t)},t.set=function(e,t,n){e.set(t,n)},t.remove=function(e,t){var n,r,o,a;if(s.isFunction(t)){var l=[];try{for(var c=i(e),u=c.next();!u.done;u=c.next()){var d=u.value;t.call(null,d)&&l.push(d[0])}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}try{for(var p=i(l),f=p.next();!f.done;f=p.next()){var h=f.value;e.delete(h)}}catch(e){o={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}}else e.delete(t)},t.contains=function(e,t){var n,r;if(s.isFunction(t)){try{for(var o=i(e),a=o.next();!a.done;a=o.next()){var l=a.value;if(t.call(null,l))return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1}return e.has(t)},t.keys=function(e){return new Set(e.keys())},t.values=function(e){return a(e.values())},t.size=function(e,t){var n,r;if(void 0===t)return e.size;var o=0;try{for(var a=i(e),s=a.next();!s.done;s=a.next()){var l=s.value;t.call(null,l)&&o++}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},t.isEmpty=function(e){return 0===e.size},t.forEach=function(e,t){var n,o,a,s,l,c;return r(this,(function(r){switch(r.label){case 0:return void 0!==t?[3,2]:[5,i(e)];case 1:return r.sent(),[3,9];case 2:r.trys.push([2,7,8,9]),n=i(e),o=n.next(),r.label=3;case 3:return o.done?[3,6]:(a=o.value,t.call(null,a)?[4,a]:[3,5]);case 4:r.sent(),r.label=5;case 5:return o=n.next(),[3,3];case 6:return[3,9];case 7:return s=r.sent(),l={error:s},[3,9];case 8:try{o&&!o.done&&(c=n.return)&&c.call(n)}finally{if(l)throw l.error}return[7];case 9:return[2]}}))},t.clone=function(e){return new Map(e)},t.sortInAscendingOrder=function(e,t){var n=new(Array.bind.apply(Array,a([void 0],e)));return n.sort((function(e,n){return t.call(null,e,n)?-1:1})),new Map(n)},t.sortInDescendingOrder=function(e,t){var n=new(Array.bind.apply(Array,a([void 0],e)));return n.sort((function(e,n){return t.call(null,e,n)?1:-1})),new Map(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTML="http://www.w3.org/1999/xhtml",t.XML="http://www.w3.org/XML/1998/namespace",t.XMLNS="http://www.w3.org/2000/xmlns/",t.MathML="http://www.w3.org/1998/Math/MathML",t.SVG="http://www.w3.org/2000/svg",t.XLink="http://www.w3.org/1999/xlink"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enqueue=function(e,t){e.push(t)},t.dequeue=function(e){return e.shift()||null}},function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1);function l(e,t){var n,r;try{for(var o=i(e),a=o.next();!a.done;a=o.next()){var s=a.value;if(!t.has(s))return!1}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0}t.append=function(e,t){e.add(t)},t.extend=function(e,t){t.forEach(e.add,e)},t.prepend=function(e,t){var n=new Set(e);e.clear(),e.add(t),n.forEach(e.add,e)},t.replace=function(e,t,n){var r,o,a=new Set;try{for(var l=i(e),c=l.next();!c.done;c=l.next()){var u=c.value;s.isFunction(t)?t.call(null,u)?a.add(n):a.add(u):u===t?a.add(n):a.add(u)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}e.clear(),a.forEach(e.add,e)},t.insert=function(e,t,n){var r,o,a=new Set,s=0;try{for(var l=i(e),c=l.next();!c.done;c=l.next()){var u=c.value;s===n&&a.add(t),a.add(u),s++}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}e.clear(),a.forEach(e.add,e)},t.remove=function(e,t){var n,r,o,a;if(s.isFunction(t)){var l=[];try{for(var c=i(e),u=c.next();!u.done;u=c.next()){var d=u.value;t.call(null,d)&&l.push(d)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}try{for(var p=i(l),f=p.next();!f.done;f=p.next()){var h=f.value;e.delete(h)}}catch(e){o={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}}else e.delete(t)},t.empty=function(e){e.clear()},t.contains=function(e,t){var n,r;if(!s.isFunction(t))return e.has(t);try{for(var o=i(e),a=o.next();!a.done;a=o.next()){var l=a.value;if(t.call(null,l))return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1},t.size=function(e,t){var n,r;if(void 0===t)return e.size;var o=0;try{for(var a=i(e),s=a.next();!s.done;s=a.next()){var l=s.value;t.call(null,l)&&o++}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},t.isEmpty=function(e){return 0===e.size},t.forEach=function(e,t){var n,o,a,s,l,c;return r(this,(function(r){switch(r.label){case 0:return void 0!==t?[3,2]:[5,i(e)];case 1:return r.sent(),[3,9];case 2:r.trys.push([2,7,8,9]),n=i(e),o=n.next(),r.label=3;case 3:return o.done?[3,6]:(a=o.value,t.call(null,a)?[4,a]:[3,5]);case 4:r.sent(),r.label=5;case 5:return o=n.next(),[3,3];case 6:return[3,9];case 7:return s=r.sent(),l={error:s},[3,9];case 8:try{o&&!o.done&&(c=n.return)&&c.call(n)}finally{if(l)throw l.error}return[7];case 9:return[2]}}))},t.clone=function(e){return new Set(e)},t.sortInAscendingOrder=function(e,t){var n=new(Array.bind.apply(Array,a([void 0],e)));return n.sort((function(e,n){return t.call(null,e,n)?-1:1})),new Set(n)},t.sortInDescendingOrder=function(e,t){var n=new(Array.bind.apply(Array,a([void 0],e)));return n.sort((function(e,n){return t.call(null,e,n)?1:-1})),new Set(n)},t.isSubsetOf=l,t.isSupersetOf=function(e,t){return l(t,e)},t.intersection=function(e,t){var n,r,o=new Set;try{for(var a=i(e),s=a.next();!s.done;s=a.next()){var l=s.value;t.has(l)&&o.add(l)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o},t.union=function(e,t){var n=new Set(e);return t.forEach(n.add,n),n},t.range=function(e,t){for(var n=new Set,r=e;r<=t;r++)n.add(r);return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.push=function(e,t){e.push(t)},t.pop=function(e){return e.pop()||null}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(96),o=n(147),a=n(146),s=n(1);function l(e,t){for(var n=0;;){var r=n<e.length?e.charCodeAt(n):null,i=n<t.length?t.charCodeAt(n):null;if(null===r)return!0;if(r!==i)return!1;n++}}function c(e){var t,n,i=Array.from(e),o=new Uint8Array(i.length),a=0;try{for(var s=r(e),l=s.next();!l.done;l=s.next()){var c=l.value.codePointAt(0);console.assert(void 0!==c&&c<=255,"isomorphicEncode requires string bytes to be less than or equal to 0x00FF."),void 0!==c&&c<=255&&(o[a++]=c)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o}function u(e){return/^[\u0000-\u007F]*$/.test(e)}function d(e){var t,n,i="";try{for(var o=r(e),a=o.next();!a.done;a=o.next()){var s=a.value,l=s.codePointAt(0);i+=void 0!==l&&l>=65&&l<=90?String.fromCodePoint(l+32):s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i}function p(e){return e.replace(/^[\t\n\f\r ]+/,"").replace(/[\t\n\f\r ]+$/,"")}function f(e,t,n){if(!s.isArray(t))return f(e,Array.from(t),n);for(var r="";n.position<t.length&&e.call(null,t[n.position]);)r+=t[n.position],n.position++;return r}function h(e,t){f((function(e){return i.ASCIIWhiteSpace.test(e)}),e,t)}t.isCodeUnitPrefix=l,t.isCodeUnitLessThan=function(e,t){if(l(t,e))return!1;if(l(e,t))return!0;for(var n=0;n<Math.min(e.length,t.length);n++){var r=e.charCodeAt(n),i=t.charCodeAt(n);if(r!==i)return r<i}return!1},t.isomorphicEncode=c,t.isASCIIString=u,t.asciiLowercase=d,t.asciiUppercase=function(e){var t,n,i="";try{for(var o=r(e),a=o.next();!a.done;a=o.next()){var s=a.value,l=s.codePointAt(0);i+=void 0!==l&&l>=97&&l<=122?String.fromCodePoint(l-32):s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i},t.asciiCaseInsensitiveMatch=function(e,t){return d(e)===d(t)},t.asciiEncode=function(e){return console.assert(u(e),"asciiEncode requires an ASCII string."),c(e)},t.asciiDecode=function(e){var t,n;try{for(var i=r(e),s=i.next();!s.done;s=i.next()){var l=s.value;console.assert(a.isASCIIByte(l),"asciiDecode requires an ASCII byte sequence.")}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return o.isomorphicDecode(e)},t.stripNewlines=function(e){return e.replace(/[\n\r]/g,"")},t.normalizeNewlines=function(e){return e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")},t.stripLeadingAndTrailingASCIIWhitespace=p,t.stripAndCollapseASCIIWhitespace=function(e){return p(e.replace(/[\t\n\f\r ]{2,}/g," "))},t.collectASequenceOfCodePoints=f,t.skipASCIIWhitespace=h,t.strictlySplit=function e(t,n){if(!s.isArray(t))return e(Array.from(t),n);var r={position:0},i=[],o=f((function(e){return n!==e}),t,r);for(i.push(o);r.position<t.length;)console.assert(t[r.position]===n,"strictlySplit found no delimiter in input string."),r.position++,o=f((function(e){return n!==e}),t,r),i.push(o);return i},t.splitAStringOnASCIIWhitespace=function e(t){if(!s.isArray(t))return e(Array.from(t));var n={position:0},r=[];for(h(t,n);n.position<t.length;){var o=f((function(e){return!i.ASCIIWhiteSpace.test(e)}),t,n);r.push(o),h(t,n)}return r},t.splitAStringOnCommas=function e(t){if(!s.isArray(t))return e(Array.from(t));for(var n={position:0},r=[];n.position<t.length;){var i=f((function(e){return","!==e}),t,n);r.push(p(i)),n.position<t.length&&(console.assert(","===t[n.position],"splitAStringOnCommas found no delimiter in input string."),n.position++)}return r},t.concatenate=function(e,t){return void 0===t&&(t=""),0===e.length?"":e.join(t)}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(97);t.abort_add=function(e,t){t._abortedFlag||t._abortAlgorithms.add(e)},t.abort_remove=function(e,t){t._abortAlgorithms.delete(e)},t.abort_signalAbort=function(e){var t,n;if(!e._abortedFlag){e._abortedFlag=!0;try{for(var o=r(e._abortAlgorithms),a=o.next();!a.done;a=o.next())a.value.call(e)}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}e._abortAlgorithms.clear(),i.event_fireAnEvent("abort",e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(150),i=function(){function e(){}return e.asNode=function(e){if(r.Guard.isNode(e))return e;throw new Error("Invalid object. Node expected.")},e}();t.Cast=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return Object.defineProperty(e.prototype,"size",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.add=function(e){throw new Error("Cannot add to an empty set.")},e.prototype.clear=function(){},e.prototype.delete=function(e){return!1},e.prototype.forEach=function(e,t){},e.prototype.has=function(e){return!1},e.prototype[Symbol.iterator]=function(){return new i},e.prototype.entries=function(){return new i},e.prototype.keys=function(){return new i},e.prototype.values=function(){return new i},Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"EmptySet"},enumerable:!0,configurable:!0}),e}();t.EmptySet=r;var i=function(){function e(){}return e.prototype[Symbol.iterator]=function(){return this},e.prototype.next=function(){return{done:!0,value:null}},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SchemeStart=0]="SchemeStart",e[e.Scheme=1]="Scheme",e[e.NoScheme=2]="NoScheme",e[e.SpecialRelativeOrAuthority=3]="SpecialRelativeOrAuthority",e[e.PathOrAuthority=4]="PathOrAuthority",e[e.Relative=5]="Relative",e[e.RelativeSlash=6]="RelativeSlash",e[e.SpecialAuthoritySlashes=7]="SpecialAuthoritySlashes",e[e.SpecialAuthorityIgnoreSlashes=8]="SpecialAuthorityIgnoreSlashes",e[e.Authority=9]="Authority",e[e.Host=10]="Host",e[e.Hostname=11]="Hostname",e[e.Port=12]="Port",e[e.File=13]="File",e[e.FileSlash=14]="FileSlash",e[e.FileHost=15]="FileHost",e[e.PathStart=16]="PathStart",e[e.Path=17]="Path",e[e.CannotBeABaseURLPath=18]="CannotBeABaseURLPath",e[e.Query=19]="Query",e[e.Fragment=20]="Fragment"}(t.ParserState||(t.ParserState={})),t.OpaqueOrigin=["","",null,null]},function(e,t,n){"use strict";var r=n(245),i=n(247);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){return i.isString(e)&&(e=b(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),d=["%","/","?",";","#"].concat(u),p=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(248);function b(e,t,n){if(e&&i.isObject(e)&&e instanceof o)return e;var r=new o;return r.parse(e,t,n),r}o.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),s=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var b=e=c.join(s);if(b=b.trim(),!n&&1===e.split("#").length){var x=l.exec(b);if(x)return this.path=b,this.href=b,this.pathname=x[1],x[2]?(this.search=x[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var A=a.exec(b);if(A){var C=(A=A[0]).toLowerCase();this.protocol=C,b=b.substr(A.length)}if(n||A||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===b.substr(0,2);!T||A&&g[A]||(b=b.substr(2),this.slashes=!0)}if(!g[A]&&(T||A&&!v[A])){for(var S,w,_=-1,I=0;I<p.length;I++)-1!==(E=b.indexOf(p[I]))&&(-1===_||E<_)&&(_=E);for(-1!==(w=-1===_?b.lastIndexOf("@"):b.lastIndexOf("@",_))&&(S=b.slice(0,w),b=b.slice(w+1),this.auth=decodeURIComponent(S)),_=-1,I=0;I<d.length;I++){var E;-1!==(E=b.indexOf(d[I]))&&(-1===_||E<_)&&(_=E)}-1===_&&(_=b.length),this.host=b.slice(0,_),b=b.slice(_),this.parseHost(),this.hostname=this.hostname||"";var D="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!D)for(var O=this.hostname.split(/\./),P=(I=0,O.length);I<P;I++){var R=O[I];if(R&&!R.match(f)){for(var N="",M=0,L=R.length;M<L;M++)R.charCodeAt(M)>127?N+="x":N+=R[M];if(!N.match(f)){var F=O.slice(0,I),B=O.slice(I+1),V=R.match(h);V&&(F.push(V[1]),B.unshift(V[2])),B.length&&(b="/"+B.join(".")+b),this.hostname=F.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),D||(this.hostname=r.toASCII(this.hostname));var k=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+k,this.href+=this.host,D&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!m[C])for(I=0,P=u.length;I<P;I++){var G=u[I];if(-1!==b.indexOf(G)){var z=encodeURIComponent(G);z===G&&(z=escape(G)),b=b.split(G).join(z)}}var W=b.indexOf("#");-1!==W&&(this.hash=b.substr(W),b=b.slice(0,W));var j=b.indexOf("?");if(-1!==j?(this.search=b.substr(j),this.query=b.substr(j+1),t&&(this.query=y.parse(this.query)),b=b.slice(0,j)):t&&(this.search="",this.query={}),b&&(this.pathname=b),v[C]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){k=this.pathname||"";var H=this.search||"";this.path=k+H}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,a="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+r},o.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,r=Object.keys(this),a=0;a<r.length;a++){var s=r[a];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),c=0;c<l.length;c++){var u=l[c];"protocol"!==u&&(n[u]=e[u])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var d=Object.keys(e),p=0;p<d.length;p++){var f=d[p];n[f]=e[f]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),n.pathname=h.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),x=e.host||e.pathname&&"/"===e.pathname.charAt(0),A=x||b||n.host&&e.pathname,C=A,T=n.pathname&&n.pathname.split("/")||[],S=(h=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===T[0]?T[0]=n.host:T.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),A=A&&(""===h[0]||""===T[0])),x)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,T=h;else if(h.length)T||(T=[]),T.pop(),T=T.concat(h),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search))return S&&(n.hostname=n.host=T.shift(),(D=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=D.shift(),n.host=n.hostname=D.shift())),n.search=e.search,n.query=e.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!T.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var w=T.slice(-1)[0],_=(n.host||e.host||T.length>1)&&("."===w||".."===w)||""===w,I=0,E=T.length;E>=0;E--)"."===(w=T[E])?T.splice(E,1):".."===w?(T.splice(E,1),I++):I&&(T.splice(E,1),I--);if(!A&&!C)for(;I--;I)T.unshift("..");!A||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),_&&"/"!==T.join("/").substr(-1)&&T.push("");var D,O=""===T[0]||T[0]&&"/"===T[0].charAt(0);return S&&(n.hostname=n.host=O?"":T.length?T.shift():"",(D=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=D.shift(),n.host=n.hostname=D.shift())),(A=A||n.host&&T.length)&&!O&&T.unshift(""),T.length?n.pathname=T.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,r){var i;!function(o){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof r&&r;a.global!==a&&a.window!==a&&a.self;var s,l=2147483647,c=/^xn--/,u=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,h=String.fromCharCode;function m(e){throw new RangeError(p[e])}function g(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function v(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+g((e=e.replace(d,".")).split("."),t).join(".")}function y(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=h((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+h(e)})).join("")}function x(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function A(e,t,n){var r=0;for(e=n?f(e/700):e>>1,e+=f(e/t);e>455;r+=36)e=f(e/35);return f(r+36*e/(e+38))}function C(e){var t,n,r,i,o,a,s,c,u,d,p,h=[],g=e.length,v=0,y=128,x=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&m("not-basic"),h.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<g;){for(o=v,a=1,s=36;i>=g&&m("invalid-input"),((c=(p=e.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:36)>=36||c>f((l-v)/a))&&m("overflow"),v+=c*a,!(c<(u=s<=x?1:s>=x+26?26:s-x));s+=36)a>f(l/(d=36-u))&&m("overflow"),a*=d;x=A(v-o,t=h.length+1,0==o),f(v/t)>l-y&&m("overflow"),y+=f(v/t),v%=t,h.splice(v++,0,y)}return b(h)}function T(e){var t,n,r,i,o,a,s,c,u,d,p,g,v,b,C,T=[];for(g=(e=y(e)).length,t=128,n=0,o=72,a=0;a<g;++a)(p=e[a])<128&&T.push(h(p));for(r=i=T.length,i&&T.push("-");r<g;){for(s=l,a=0;a<g;++a)(p=e[a])>=t&&p<s&&(s=p);for(s-t>f((l-n)/(v=r+1))&&m("overflow"),n+=(s-t)*v,t=s,a=0;a<g;++a)if((p=e[a])<t&&++n>l&&m("overflow"),p==t){for(c=n,u=36;!(c<(d=u<=o?1:u>=o+26?26:u-o));u+=36)C=c-d,b=36-d,T.push(h(x(d+C%b,0))),c=f(C/b);T.push(h(x(c,0))),o=A(n,v,r==i),n=0,++r}++n,++t}return T.join("")}s={version:"1.4.1",ucs2:{decode:y,encode:b},decode:C,encode:T,toASCII:function(e){return v(e,(function(e){return u.test(e)?"xn--"+T(e):e}))},toUnicode:function(e){return v(e,(function(e){return c.test(e)?C(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return s}.call(t,n,t,e))||(e.exports=i)}()}).call(this,n(246)(e),n(78))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(249),t.encode=t.stringify=n(250)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var d,p,f,h,m=e[u].replace(s,"%20"),g=m.indexOf(n);g>=0?(d=m.substr(0,g),p=m.substr(g+1)):(d=m,p=""),f=decodeURIComponent(d),h=decodeURIComponent(p),r(a,f)?i(a[f])?a[f].push(h):a[f]=[a[f],h]:a[f]=h}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(a(e),(function(a){var s=encodeURIComponent(r(a))+n;return i(e[a])?o(e[a],(function(e){return s+encodeURIComponent(r(e))})).join(t):s+encodeURIComponent(r(e[a]))})).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(52);t.attr_setAnExistingAttributeValue=function(e,t){null===e._element?e._value=t:r.element_change(e,e._element,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(108),i=n(30),o=n(52);t.tokenList_validationSteps=function(e,t){if(!i.dom_hasSupportedTokens(e._attribute._localName))throw new TypeError("There are no supported tokens defined for attribute name: '"+e._attribute._localName+"'.");return i.dom_getSupportedTokens(e._attribute._localName).has(t.toLowerCase())},t.tokenList_updateSteps=function(e){(e._element.hasAttribute(e._attribute._localName)||0!==e._tokenSet.size)&&o.element_setAnAttributeValue(e._element,e._attribute._localName,r.orderedSet_serialize(e._tokenSet))},t.tokenList_serializeSteps=function(e){return o.element_getAnAttributeValue(e._element,e._attribute._localName)}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);function o(e){return i.isBoolean(e)?e:e.capture||!1}t.eventTarget_flatten=o,t.eventTarget_flattenMore=function(e){var t=o(e),n=!1,r=!1;return i.isBoolean(e)||(n=e.once||!1,r=e.passive||!1),[t,r,n]},t.eventTarget_addEventListener=function(e,t){if(null!==t.callback){for(var n=0;n<e._eventListenerList.length;n++){var r=e._eventListenerList[n];if(r.type===t.type&&r.callback.handleEvent===t.callback.handleEvent&&r.capture===t.capture)return}e._eventListenerList.push(t)}},t.eventTarget_removeEventListener=function(e,t,n){t.removed=!0,e._eventListenerList.splice(n,1)},t.eventTarget_removeAllEventListeners=function(e){var t,n;try{for(var i=r(e._eventListenerList),o=i.next();!o.done;o=i.next())o.value.removed=!0}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e._eventListenerList.length=0}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(29);t.parentNode_convertNodesIntoANode=function(e,t){for(var n,a,s=null,l=0;l<e.length;l++){var c=e[l];if(i.isString(c)){var u=o.create_text(t,c);e[l]=u}}if(1===e.length)s=e[0];else{var d=s=o.create_documentFragment(t);try{for(var p=r(e),f=p.next();!f.done;f=p.next())c=f.value,d.appendChild(c)}catch(e){n={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(n)throw n.error}}}return s}},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),s=n(9),l=n(3),c=n(29),u=n(17),d=n(175),p=n(107),f=n(176),h=n(37),m=n(177);function g(e){return e._startNode===e._endNode&&e._startOffset===e._endOffset}function v(e){return u.tree_rootNode(e._startNode)}function y(e,t){return u.tree_rootNode(e)===v(t)&&d.boundaryPoint_position([e,0],t._start)===a.BoundaryPosition.After&&d.boundaryPoint_position([e,u.tree_nodeLength(e)],t._end)===a.BoundaryPosition.Before}function b(e,t){var n=u.tree_isAncestorOf(t._startNode,e,!0),r=u.tree_isAncestorOf(t._endNode,e,!0);return n&&!r||!n&&r}function x(e){var t,n,i,a,d,m,v=c.create_documentFragment(e._startNode._nodeDocument);if(g(e))return v;var A=e._startNode,C=e._startOffset,T=e._endNode,S=e._endOffset;if(A===T&&l.Guard.isCharacterDataNode(A))return(k=f.node_clone(A))._data=p.characterData_substringData(A,C,S-C),h.mutation_append(k,v),p.characterData_replaceData(A,C,S-C,""),v;for(var w=A;!u.tree_isAncestorOf(T,w,!0);){if(null===w._parent)throw new Error("Parent node  is null.");w=w._parent}var _=null;if(!u.tree_isAncestorOf(T,A,!0))try{for(var I=r(w._children),E=I.next();!E.done;E=I.next())if(b(R=E.value,e)){_=R;break}}catch(e){t={error:e}}finally{try{E&&!E.done&&(n=I.return)&&n.call(I)}finally{if(t)throw t.error}}var D=null;if(!u.tree_isAncestorOf(A,T,!0))for(var O=o(w._children),P=O.length-1;P>0;P--){var R;if(b(R=O[P],e)){D=R;break}}var N,M,L=[];try{for(var F=r(w._children),B=F.next();!B.done;B=F.next())if(y(W=B.value,e)){if(l.Guard.isDocumentTypeNode(W))throw new s.HierarchyRequestError;L.push(W)}}catch(e){i={error:e}}finally{try{B&&!B.done&&(a=F.return)&&a.call(F)}finally{if(i)throw i.error}}if(u.tree_isAncestorOf(T,A,!0))N=A,M=C;else{for(var V=A;null!==V._parent&&!u.tree_isAncestorOf(T,V._parent);)V=V._parent;if(null===V._parent)throw new Error("Parent node is null.");N=V._parent,M=1+u.tree_index(V)}if(l.Guard.isCharacterDataNode(_))(k=f.node_clone(A))._data=p.characterData_substringData(A,C,u.tree_nodeLength(A)-C),h.mutation_append(k,v),p.characterData_replaceData(A,C,u.tree_nodeLength(A)-C,"");else if(null!==_){var k=f.node_clone(_);h.mutation_append(k,v);var U=x(c.create_range([A,C],[_,u.tree_nodeLength(_)]));h.mutation_append(U,k)}try{for(var G=r(L),z=G.next();!z.done;z=G.next()){var W=z.value;h.mutation_append(W,v)}}catch(e){d={error:e}}finally{try{z&&!z.done&&(m=G.return)&&m.call(G)}finally{if(d)throw d.error}}return l.Guard.isCharacterDataNode(D)?((k=f.node_clone(T))._data=p.characterData_substringData(T,0,S),h.mutation_append(k,v),p.characterData_replaceData(T,0,S,"")):null!==D&&(k=f.node_clone(D),h.mutation_append(k,v),U=x(c.create_range([D,0],[T,S])),h.mutation_append(U,k)),e._start=[N,M],e._end=[N,M],v}t.range_collapsed=g,t.range_root=v,t.range_isContained=y,t.range_isPartiallyContained=b,t.range_setTheStart=function(e,t,n){if(l.Guard.isDocumentTypeNode(t))throw new s.InvalidNodeTypeError;if(n>u.tree_nodeLength(t))throw new s.IndexSizeError;var r=[t,n];v(e)===u.tree_rootNode(t)&&d.boundaryPoint_position(r,e._end)!==a.BoundaryPosition.After||(e._end=r),e._start=r},t.range_setTheEnd=function(e,t,n){if(l.Guard.isDocumentTypeNode(t))throw new s.InvalidNodeTypeError;if(n>u.tree_nodeLength(t))throw new s.IndexSizeError;var r=[t,n];v(e)===u.tree_rootNode(t)&&d.boundaryPoint_position(r,e._start)!==a.BoundaryPosition.Before||(e._start=r),e._end=r},t.range_select=function(e,t){var n=e._parent;if(null===n)throw new s.InvalidNodeTypeError;var r=u.tree_index(e);t._start=[n,r],t._end=[n,r+1]},t.range_extract=x,t.range_cloneTheContents=function e(t){var n,i,a,d,m,v,A=c.create_documentFragment(t._startNode._nodeDocument);if(g(t))return A;var C=t._startNode,T=t._startOffset,S=t._endNode,w=t._endOffset;C===S&&l.Guard.isCharacterDataNode(C)&&((B=f.node_clone(C))._data=p.characterData_substringData(C,T,w-T),h.mutation_append(B,A));for(var _=C;!u.tree_isAncestorOf(S,_,!0);){if(null===_._parent)throw new Error("Parent node  is null.");_=_._parent}var I=null;if(!u.tree_isAncestorOf(S,C,!0))try{for(var E=r(_._children),D=E.next();!D.done;D=E.next())if(b(N=D.value,t)){I=N;break}}catch(e){n={error:e}}finally{try{D&&!D.done&&(i=E.return)&&i.call(E)}finally{if(n)throw n.error}}var O=null;if(!u.tree_isAncestorOf(C,S,!0))for(var P=o(_._children),R=P.length-1;R>0;R--){var N;if(b(N=P[R],t)){O=N;break}}var M=[];try{for(var L=r(_._children),F=L.next();!F.done;F=L.next())if(y(G=F.value,t)){if(l.Guard.isDocumentTypeNode(G))throw new s.HierarchyRequestError;M.push(G)}}catch(e){a={error:e}}finally{try{F&&!F.done&&(d=L.return)&&d.call(L)}finally{if(a)throw a.error}}if(l.Guard.isCharacterDataNode(I))(B=f.node_clone(C))._data=p.characterData_substringData(C,T,u.tree_nodeLength(C)-T),h.mutation_append(B,A);else if(null!==I){var B=f.node_clone(I);h.mutation_append(B,A);var V=e(c.create_range([C,T],[I,u.tree_nodeLength(I)]));h.mutation_append(V,B)}try{for(var k=r(M),U=k.next();!U.done;U=k.next()){var G=U.value;B=f.node_clone(G),h.mutation_append(B,A)}}catch(e){m={error:e}}finally{try{U&&!U.done&&(v=k.return)&&v.call(k)}finally{if(m)throw m.error}}return l.Guard.isCharacterDataNode(O)?((B=f.node_clone(S))._data=p.characterData_substringData(S,0,w),h.mutation_append(B,A)):null!==O&&(B=f.node_clone(O),A.append(B),V=x(c.create_range([O,0],[S,w])),h.mutation_append(V,B)),A},t.range_insert=function(e,t){var n,i;if(l.Guard.isProcessingInstructionNode(t._startNode)||l.Guard.isCommentNode(t._startNode)||l.Guard.isTextNode(t._startNode)&&null===t._startNode._parent||t._startNode===e)throw new s.HierarchyRequestError;var o,a=null;if(l.Guard.isTextNode(t._startNode))a=t._startNode;else{var c=0;try{for(var d=r(t._startNode._children),p=d.next();!p.done;p=d.next()){var f=p.value;if(c===t._startOffset){a=f;break}c++}}catch(e){n={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}if(null===a)o=t._startNode;else{if(null===a._parent)throw new Error("Parent node is null.");o=a._parent}h.mutation_ensurePreInsertionValidity(e,o,a),l.Guard.isTextNode(t._startNode)&&(a=m.text_split(t._startNode,t._startOffset)),e===a&&(a=e._nextSibling),null!==e._parent&&h.mutation_remove(e,e._parent);var v=null===a?u.tree_nodeLength(o):u.tree_index(a);l.Guard.isDocumentFragmentNode(e)?v+=u.tree_nodeLength(e):v++,h.mutation_preInsert(e,o,a),g(t)&&(t._end=[o,v])},t.range_getContainedNodes=function(e){var t;return(t={})[Symbol.iterator]=function(){var t=e.commonAncestorContainer,n=u.tree_getFirstDescendantNode(t);return{next:function(){for(;n&&!y(n,e);)n=u.tree_getNextDescendantNode(t,n);if(null===n)return{done:!0,value:null};var r={done:!1,value:n};return n=u.tree_getNextDescendantNode(t,n),r}}},t},t.range_getPartiallyContainedNodes=function(e){var t;return(t={})[Symbol.iterator]=function(){var t=e.commonAncestorContainer,n=u.tree_getFirstDescendantNode(t);return{next:function(){for(;n&&!b(n,e);)n=u.tree_getNextDescendantNode(t,n);if(null===n)return{done:!0,value:null};var r={done:!1,value:n};return n=u.tree_getNextDescendantNode(t,n),r}}},t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.selectors_scopeMatchASelectorsString=function(e,t){throw new r.NotSupportedError}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(105);t.treeWalker_traverseChildren=function(e,t){for(var n=t?e._current._firstChild:e._current._lastChild;null!==n;){var o=i.traversal_filter(e,n);if(o===r.FilterResult.Accept)return e._current=n,n;if(o===r.FilterResult.Skip){var a=t?n._firstChild:n._lastChild;if(null!==a){n=a;continue}}for(;null!==n;){var s=t?n._nextSibling:n._previousSibling;if(null!==s){n=s;break}var l=n._parent;if(null===l||l===e._root||l===e._current)return null;n=l}}return null},t.treeWalker_traverseSiblings=function(e,t){var n=e._current;if(n===e._root)return null;for(;;){for(var o=t?n._nextSibling:n._previousSibling;null!==o;){n=o;var a=i.traversal_filter(e,n);if(a===r.FilterResult.Accept)return e._current=n,n;o=t?n._firstChild:n._lastChild,a!==r.FilterResult.Reject&&null!==o||(o=t?n._nextSibling:n._previousSibling)}if(null===(n=n._parent)||n===e._root)return null;if(i.traversal_filter(e,n)===r.FilterResult.Accept)return null}}},function(e,t,n){"use strict";n(89),n(74);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(2),s=n(50),l=n(3),c=function(e){function t(t,n){var r=e.call(this,t)||this;return r._indentation={},r._lengthToLastNewline=0,r._writerOptions=o.applyDefaults(n,{wellFormed:!1,headless:!1,prettyPrint:!1,indent:"  ",newline:"\n",offset:0,width:0,allowEmptyTags:!1,indentTextOnlyNodes:!1,spaceBeforeSlash:!1}),r}return i(t,e),t.prototype.serialize=function(e){return this._refs={suppressPretty:!1,emptyNode:!1,markup:""},e.nodeType!==a.NodeType.Document||this._writerOptions.headless||this.declaration(this._builderOptions.version,this._builderOptions.encoding,this._builderOptions.standalone),this.serializeNode(e,this._writerOptions.wellFormed),this._writerOptions.prettyPrint&&this._refs.markup.slice(-this._writerOptions.newline.length)===this._writerOptions.newline&&(this._refs.markup=this._refs.markup.slice(0,-this._writerOptions.newline.length)),this._refs.markup},t.prototype.declaration=function(e,t,n){this._beginLine(),this._refs.markup+='<?xml version="'+e+'"',void 0!==t&&(this._refs.markup+=' encoding="'+t+'"'),void 0!==n&&(this._refs.markup+=' standalone="'+(n?"yes":"no")+'"'),this._refs.markup+="?>",this._endLine()},t.prototype.docType=function(e,t,n){this._beginLine(),this._refs.markup+=t&&n?"<!DOCTYPE "+e+' PUBLIC "'+t+'" "'+n+'">':t?"<!DOCTYPE "+e+' PUBLIC "'+t+'">':n?"<!DOCTYPE "+e+' SYSTEM "'+n+'">':"<!DOCTYPE "+e+">",this._endLine()},t.prototype.openTagBegin=function(e){this._beginLine(),this._refs.markup+="<"+e},t.prototype.openTagEnd=function(e,t,n){if(this._refs.suppressPretty=!1,this._refs.emptyNode=!1,this._writerOptions.prettyPrint&&!t&&!n){for(var r=!0,i=!0,o=this.currentNode.firstChild,a=0,s=0;o;){if(l.Guard.isExclusiveTextNode(o))s++;else{if(!l.Guard.isCDATASectionNode(o)){r=!1,i=!1;break}a++}""!==o.data&&(i=!1),o=o.nextSibling}this._refs.suppressPretty=!this._writerOptions.indentTextOnlyNodes&&r&&(a<=1&&0===s||0===a),this._refs.emptyNode=i}(n||t||this._refs.emptyNode)&&this._writerOptions.allowEmptyTags?this._refs.markup+="></"+e+">":this._refs.markup+=n?" />":t||this._refs.emptyNode?this._writerOptions.spaceBeforeSlash?" />":"/>":">",this._endLine()},t.prototype.closeTag=function(e){this._refs.emptyNode||(this._beginLine(),this._refs.markup+="</"+e+">"),this._refs.suppressPretty=!1,this._refs.emptyNode=!1,this._endLine()},t.prototype.attribute=function(e,t){var n=e+'="'+t+'"';this._writerOptions.prettyPrint&&this._writerOptions.width>0&&this._refs.markup.length-this._lengthToLastNewline+1+n.length>this._writerOptions.width?(this._endLine(),this._beginLine(),this._refs.markup+=this._indent(1)+n):this._refs.markup+=" "+n},t.prototype.text=function(e){""!==e&&(this._beginLine(),this._refs.markup+=e,this._endLine())},t.prototype.cdata=function(e){""!==e&&(this._beginLine(),this._refs.markup+="<![CDATA["+e+"]]>",this._endLine())},t.prototype.comment=function(e){this._beginLine(),this._refs.markup+="\x3c!--"+e+"--\x3e",this._endLine()},t.prototype.instruction=function(e,t){this._beginLine(),this._refs.markup+="<?"+(""===t?e:e+" "+t)+"?>",this._endLine()},t.prototype._beginLine=function(){this._writerOptions.prettyPrint&&!this._refs.suppressPretty&&(this._refs.markup+=this._indent(this._writerOptions.offset+this.level))},t.prototype._endLine=function(){this._writerOptions.prettyPrint&&!this._refs.suppressPretty&&(this._refs.markup+=this._writerOptions.newline,this._lengthToLastNewline=this._refs.markup.length)},t.prototype._indent=function(e){if(e<=0)return"";if(void 0!==this._indentation[e])return this._indentation[e];var t=this._writerOptions.indent.repeat(e);return this._indentation[e]=t,t},t}(s.BaseWriter);t.XMLWriter=c},function(e,t,n){"use strict";var r=n(47),i=n(35);e.exports="".repeat||function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t,n){"use strict";n(31),n(32),n(33),n(19),n(178),n(20),n(22),n(23);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=n(67),s=n(1),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r._writerOptions=s.applyDefaults(n,{wellFormed:!1,prettyPrint:!1,indent:"  ",newline:"\n",offset:0,group:!1,verbose:!1}),r}return i(t,e),t.prototype.serialize=function(e){var t=s.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1}),n=new a.ObjectWriter(this._builderOptions,t).serialize(e);return this._beginLine(this._writerOptions,0)+this._convertObject(n,this._writerOptions)},t.prototype._convertObject=function(e,t,n){var r,i,a=this;void 0===n&&(n=0);var l="",c=this._isLeafNode(e);if(s.isArray(e)){l+="[";var u=e.length,d=0;try{for(var p=o(e),f=p.next();!f.done;f=p.next()){var h=f.value;l+=this._endLine(t,n+1)+this._beginLine(t,n+1)+this._convertObject(h,t,n+1),d<u-1&&(l+=","),d++}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}l+=this._endLine(t,n)+this._beginLine(t,n),l+="]"}else if(s.isObject(e)){l+="{";var m=s.objectLength(e),g=0;s.forEachObject(e,(function(e,r){c&&t.prettyPrint?l+=" ":l+=a._endLine(t,n+1)+a._beginLine(t,n+1),l+=a._key(e),t.prettyPrint&&(l+=" "),l+=a._convertObject(r,t,n+1),g<m-1&&(l+=","),g++}),this),c&&t.prettyPrint?l+=" ":l+=this._endLine(t,n)+this._beginLine(t,n),l+="}"}else l+=this._val(e);return l},t.prototype._beginLine=function(e,t){if(!e.prettyPrint)return"";var n=e.offset+t+1;return n>0?new Array(n).join(e.indent):""},t.prototype._endLine=function(e,t){return e.prettyPrint?e.newline:""},t.prototype._key=function(e){return'"'+e+'":'},t.prototype._val=function(e){return JSON.stringify(e)},t.prototype._isLeafNode=function(e){return this._descendantCount(e)<=1},t.prototype._descendantCount=function(e,t){var n=this;return void 0===t&&(t=0),s.isArray(e)?s.forEachArray(e,(function(e){return t+=n._descendantCount(e,t)}),this):s.isObject(e)?s.forEachObject(e,(function(e,r){return t+=n._descendantCount(r,t)}),this):t++,t},t}(n(50).BaseWriter);t.JSONWriter=l},function(e,t,n){"use strict";n(31),n(32),n(33),n(19),n(178),n(89),n(20),n(22),n(23);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var a=n(67),s=n(1),l=function(e){function t(t,n){var r=e.call(this,t)||this;if(r._writerOptions=s.applyDefaults(n,{wellFormed:!1,indent:"  ",newline:"\n",offset:0,group:!1,verbose:!1}),r._writerOptions.indent.length<2)throw new Error("YAML indententation string must be at least two characters long.");if(r._writerOptions.offset<0)throw new Error("YAML offset should be zero or a positive number.");return r}return i(t,e),t.prototype.serialize=function(e){var t=s.applyDefaults(this._writerOptions,{format:"object",wellFormed:!1}),n=new a.ObjectWriter(this._builderOptions,t).serialize(e),r=this._beginLine(this._writerOptions,0)+"---"+this._endLine(this._writerOptions)+this._convertObject(n,this._writerOptions,0);return r.slice(-this._writerOptions.newline.length)===this._writerOptions.newline&&(r=r.slice(0,-this._writerOptions.newline.length)),r},t.prototype._convertObject=function(e,t,n,r){var i,a,l=this;void 0===r&&(r=!1);var c="";if(s.isArray(e))try{for(var u=o(e),d=u.next();!d.done;d=u.next()){var p=d.value;c+=this._beginLine(t,n,!0),s.isObject(p)?s.isEmpty(p)?c+='""'+this._endLine(t):c+=this._convertObject(p,t,n,!0):c+=this._val(p)+this._endLine(t)}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}else s.forEachObject(e,(function(e,i){r?(c+=l._key(e),r=!1):c+=l._beginLine(t,n)+l._key(e),s.isObject(i)?s.isEmpty(i)?c+=' ""'+l._endLine(t):c+=l._endLine(t)+l._convertObject(i,t,n+1):c+=" "+l._val(i)+l._endLine(t)}),this);return c},t.prototype._beginLine=function(e,t,n){void 0===n&&(n=!1);var r=e.offset+t+1,i=new Array(r).join(e.indent);return n?i.substr(0,i.length-2)+"-"+i.substr(-1,1):i},t.prototype._endLine=function(e){return e.newline},t.prototype._key=function(e){return'"'+e+'":'},t.prototype._val=function(e){return JSON.stringify(e)},t}(n(50).BaseWriter);t.YAMLWriter=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(110).dom.setFeatures(!0);var r=n(110);t.DOMImplementation=r.DOMImplementation;var i=n(271);t.DOMParser=i.DOMParser;var o=n(274);t.XMLSerializer=o.XMLSerializer},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0),o=function(){function e(){}return e.prototype.before=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.Cast.asNode(this),o=n._parent;if(null!==o){for(var a=n._previousSibling,s=!0;s&&a;){s=!1;for(var l=0;l<e.length;l++)if(e[l]===a){a=a._previousSibling,s=!0;break}}var c=i.parentNode_convertNodesIntoANode(e,n._nodeDocument);a=null===a?o._firstChild:a._nextSibling,i.mutation_preInsert(c,o,a)}},e.prototype.after=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.Cast.asNode(this),o=n._parent;if(o){for(var a=n._nextSibling,s=!0;s&&a;){s=!1;for(var l=0;l<e.length;l++)if(e[l]===a){a=a._nextSibling,s=!0;break}}var c=i.parentNode_convertNodesIntoANode(e,n._nodeDocument);i.mutation_preInsert(c,o,a)}},e.prototype.replaceWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.Cast.asNode(this),o=n._parent;if(o){for(var a=n._nextSibling,s=!0;s&&a;){s=!1;for(var l=0;l<e.length;l++)if(e[l]===a){a=a._nextSibling,s=!0;break}}var c=i.parentNode_convertNodesIntoANode(e,n._nodeDocument);n._parent===o?i.mutation_replace(n,c,o):i.mutation_preInsert(c,o,a)}},e.prototype.remove=function(){var e=r.Cast.asNode(this),t=e._parent;t&&i.mutation_remove(e,t)},e}();t.ChildNodeImpl=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){};t.DocumentOrShadowRootImpl=r},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(3),a=n(7),s=function(){function e(e){this._nodeList=[],this._recordQueue=[],this._callback=e;var t=i.dom.window;a.set.append(t._mutationObservers,this)}return e.prototype.observe=function(e,t){var n,i;if(void 0===(t=t||{childList:!1,subtree:!1}).attributeOldValue&&void 0===t.attributeFilter||void 0!==t.attributes||(t.attributes=!0),void 0!==t.characterDataOldValue&&void 0===t.characterData&&(t.characterData=!0),!t.childList&&!t.attributes&&!t.characterData)throw new TypeError;if(t.attributeOldValue&&!t.attributes)throw new TypeError;if(void 0!==t.attributeFilter&&!t.attributes)throw new TypeError;if(t.characterDataOldValue&&!t.characterData)throw new TypeError;var s=!1,l=t,c=function(e){var t,n;if(e.observer===u){s=!0;try{for(var i=(t=void 0,r(u._nodeList)),c=i.next();!c.done;c=i.next()){var d=c.value;a.list.remove(d._registeredObserverList,(function(t){return o.Guard.isTransientRegisteredObserver(t)&&t.source===e}))}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e.options=l}},u=this;try{for(var d=r(e._registeredObserverList),p=d.next();!p.done;p=d.next())c(p.value)}catch(e){n={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}s||(e._registeredObserverList.push({observer:this,options:t}),this._nodeList.push(e))},e.prototype.disconnect=function(){var e,t,n=this;try{for(var i=r(this._nodeList),o=i.next();!o.done;o=i.next()){var s=o.value;a.list.remove(s._registeredObserverList,(function(e){return e.observer===n}))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this._recordQueue=[]},e.prototype.takeRecords=function(){var e=this._recordQueue;return this._recordQueue=[],e},e}();t.MutationObserverImpl=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=function(){function e(){}return Object.defineProperty(e.prototype,"previousElementSibling",{get:function(){for(var e=r.Cast.asNode(this)._previousSibling;e;){if(r.Guard.isElementNode(e))return e;e=e._previousSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextElementSibling",{get:function(){for(var e=r.Cast.asNode(this)._nextSibling;e;){if(r.Guard.isElementNode(e))return e;e=e._nextSibling}return null},enumerable:!0,configurable:!0}),e}();t.NonDocumentTypeChildNodeImpl=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(0),o=function(){function e(){}return e.prototype.getElementById=function(e){for(var t=i.tree_getFirstDescendantNode(r.Cast.asNode(this),!1,!1,(function(e){return r.Guard.isElementNode(e)}));null!==t;){if(t._uniqueIdentifier===e)return t;t=i.tree_getNextDescendantNode(r.Cast.asNode(this),t,!1,!1,(function(e){return r.Guard.isElementNode(e)}))}return null},e}();t.NonElementParentNodeImpl=o},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),o=n(0),a=function(){function e(){}return Object.defineProperty(e.prototype,"children",{get:function(){return o.create_htmlCollection(i.Cast.asNode(this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){for(var e=i.Cast.asNode(this)._firstChild;e;){if(i.Guard.isElementNode(e))return e;e=e._nextSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){for(var e=i.Cast.asNode(this)._lastChild;e;){if(i.Guard.isElementNode(e))return e;e=e._previousSibling}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){var e,t,n=0;try{for(var o=r(i.Cast.asNode(this)._children),a=o.next();!a.done;a=o.next()){var s=a.value;i.Guard.isElementNode(s)&&n++}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),e.prototype.prepend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.Cast.asNode(this),r=o.parentNode_convertNodesIntoANode(e,n._nodeDocument);o.mutation_preInsert(r,n,n._firstChild)},e.prototype.append=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.Cast.asNode(this),r=o.parentNode_convertNodesIntoANode(e,n._nodeDocument);o.mutation_append(r,n)},e.prototype.querySelector=function(e){var t=i.Cast.asNode(this),n=o.selectors_scopeMatchASelectorsString(e,t);return 0===n.length?null:n[0]},e.prototype.querySelectorAll=function(e){var t=i.Cast.asNode(this),n=o.selectors_scopeMatchASelectorsString(e,t);return o.create_nodeListStatic(t,n)},e}();t.ParentNodeImpl=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(){function e(){}return Object.defineProperty(e.prototype,"_name",{get:function(){return this.__name||""},set:function(e){this.__name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_assignedSlot",{get:function(){return this.__assignedSlot||null},set:function(e){this.__assignedSlot=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assignedSlot",{get:function(){return r.shadowTree_findASlot(this,!0)},enumerable:!0,configurable:!0}),e}();t.SlotableImpl=i},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(102),a=n(9),s=n(3),l=function(e){function t(t){var n=e.call(this)||this;if(s.Guard.isDocumentTypeNode(t.startContainer)||s.Guard.isAttrNode(t.startContainer)||s.Guard.isDocumentTypeNode(t.endContainer)||s.Guard.isAttrNode(t.endContainer))throw new a.InvalidNodeTypeError;return n._start=[t.startContainer,t.startOffset],n._end=[t.endContainer,t.endOffset],n}return i(t,e),t}(o.AbstractRangeImpl);t.StaticRangeImpl=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(272);t.DOMParser=r.DOMParserImpl},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(273),o=function(){function e(){}return e.prototype.parseFromString=function(e,t){if("text/html"===t)throw new Error("HTML parser not implemented.");try{return(n=(new i.XMLParserImpl).parse(e))._contentType=t,n}catch(e){var n,o="http://www.mozilla.org/newlayout/xml/parsererror.xml",a=(n=r.create_xmlDocument()).createElementNS(o,"parsererror"),s=n.createElementNS(o,"error");return s.setAttribute("message",e.message),a.appendChild(s),n.appendChild(a),n}},e}();t.DOMParserImpl=o},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var o=n(180),a=n(111),s=n(7),l=n(0),c=n(69),u=function(){function e(){}return e.prototype.parse=function(e){for(var t,n,u,d,p=new o.XMLStringLexer(e,{skipWhitespaceOnlyText:!0}),f=l.create_document(),h=f,m=p.nextToken();m.type!==a.TokenType.EOF;){switch(m.type){case a.TokenType.Declaration:var g=m;if("1.0"!==g.version)throw new Error("Invalid xml version: "+g.version);break;case a.TokenType.DocType:var v=m;if(!l.xml_isPubidChar(v.pubId))throw new Error("DocType public identifier does not match PubidChar construct.");if(!l.xml_isLegalChar(v.sysId)||-1!==v.sysId.indexOf('"')&&-1!==v.sysId.indexOf("'"))throw new Error("DocType system identifier contains invalid characters.");h.appendChild(f.implementation.createDocumentType(v.name,v.pubId,v.sysId));break;case a.TokenType.CDATA:var y=m;if(!l.xml_isLegalChar(y.data)||-1!==y.data.indexOf("]]>"))throw new Error("CDATA contains invalid characters.");h.appendChild(f.createCDATASection(y.data));break;case a.TokenType.Comment:var b=m;if(!l.xml_isLegalChar(b.data)||-1!==b.data.indexOf("--")||b.data.endsWith("-"))throw new Error("Comment data contains invalid characters.");h.appendChild(f.createComment(b.data));break;case a.TokenType.PI:var x=m;if(-1!==x.target.indexOf(":")||/^xml$/i.test(x.target))throw new Error("Processing instruction target contains invalid characters.");if(!l.xml_isLegalChar(x.data)||-1!==x.data.indexOf("?>"))throw new Error("Processing instruction data contains invalid characters.");h.appendChild(f.createProcessingInstruction(x.target,x.data));break;case a.TokenType.Text:var A=m;if(!l.xml_isLegalChar(A.data))throw new Error("Text data contains invalid characters.");h.appendChild(f.createTextNode(this._decodeText(A.data)));break;case a.TokenType.Element:var C=m,T=r(l.namespace_extractQName(C.name),2),S=T[0],w=T[1];if(-1!==w.indexOf(":")||!l.xml_isName(w))throw new Error("Node local name contains invalid characters.");if("xmlns"===S)throw new Error("An element cannot have the 'xmlns' prefix.");var _=h.lookupNamespaceURI(S),I={};try{for(var E=(t=void 0,i(C.attributes)),D=E.next();!D.done;D=E.next()){var O=r(D.value,2),P=O[0],R=O[1];if("xmlns"===P)_=R;else{var N=r(l.namespace_extractQName(P),2),M=N[0],L=N[1];"xmlns"===M&&(L===S&&(_=R),I[L]=R)}}}catch(e){t={error:e}}finally{try{D&&!D.done&&(n=E.return)&&n.call(E)}finally{if(t)throw t.error}}var F=null!==_?f.createElementNS(_,C.name):f.createElement(C.name);h.appendChild(F);var B=new c.LocalNameSet;try{for(var V=(u=void 0,i(C.attributes)),k=V.next();!k.done;k=V.next()){var U=r(k.value,2),G=(P=U[0],R=U[1],r(l.namespace_extractQName(P),2)),z=(M=G[0],L=G[1],null);if("xmlns"===M||null===M&&"xmlns"===L?z=s.namespace.XMLNS:null!==(z=F.lookupNamespaceURI(M))&&F.isDefaultNamespace(z)?z=null:null===z&&null!==M&&(z=I[M]||null),B.has(z,L))throw new Error("Element contains duplicate attributes.");if(B.set(z,L),z===s.namespace.XMLNS&&R===s.namespace.XMLNS)throw new Error("XMLNS namespace is reserved.");if(-1!==L.indexOf(":")||!l.xml_isName(L))throw new Error("Attribute local name contains invalid characters.");if("xmlns"===M&&""===R)throw new Error("Empty XML namespace is not allowed.");null!==z?F.setAttributeNS(z,P,this._decodeAttributeValue(R)):F.setAttribute(P,this._decodeAttributeValue(R))}}catch(e){u={error:e}}finally{try{k&&!k.done&&(d=V.return)&&d.call(V)}finally{if(u)throw u.error}}C.selfClosing||(h=F);break;case a.TokenType.ClosingTag:if(m.name!==h.nodeName)throw new Error("Closing tag name does not match opening tag name.");h._parent&&(h=h._parent)}m=p.nextToken()}return f},e.prototype._decodeText=function(e){return null==e?e:e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},e.prototype._decodeAttributeValue=function(e){return null==e?e:e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},e}();t.XMLParserImpl=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(275);t.XMLSerializer=r.XMLSerializerImpl},function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n(69),a=n(95),s=n(9),l=n(7),c=n(0),u=function(){function e(){}return e.prototype.serializeToString=function(e){return this._xmlSerialization(e,!1)},e.prototype._xmlSerialization=function(e,t){if(void 0===e._nodeDocument||e._nodeDocument._hasNamespaces){var n=new a.NamespacePrefixMap;n.set("xml",l.namespace.XML);try{return this._serializeNodeNS(e,null,n,{value:1},t)}catch(e){throw new s.InvalidStateError}}else try{return this._serializeNode(e,t)}catch(e){throw new s.InvalidStateError}},e.prototype._serializeNodeNS=function(e,t,n,r,o){switch(e.nodeType){case i.NodeType.Element:return this._serializeElementNS(e,t,n,r,o);case i.NodeType.Document:return this._serializeDocumentNS(e,t,n,r,o);case i.NodeType.Comment:return this._serializeComment(e,o);case i.NodeType.Text:return this._serializeText(e,o);case i.NodeType.DocumentFragment:return this._serializeDocumentFragmentNS(e,t,n,r,o);case i.NodeType.DocumentType:return this._serializeDocumentType(e,o);case i.NodeType.ProcessingInstruction:return this._serializeProcessingInstruction(e,o);case i.NodeType.CData:return this._serializeCData(e,o);default:throw new Error("Unknown node type: "+e.nodeType)}},e.prototype._serializeNode=function(e,t){switch(e.nodeType){case i.NodeType.Element:return this._serializeElement(e,t);case i.NodeType.Document:return this._serializeDocument(e,t);case i.NodeType.Comment:return this._serializeComment(e,t);case i.NodeType.Text:return this._serializeText(e,t);case i.NodeType.DocumentFragment:return this._serializeDocumentFragment(e,t);case i.NodeType.DocumentType:return this._serializeDocumentType(e,t);case i.NodeType.ProcessingInstruction:return this._serializeProcessingInstruction(e,t);case i.NodeType.CData:return this._serializeCData(e,t);default:throw new Error("Unknown node type: "+e.nodeType)}},e.prototype._serializeElementNS=function(t,n,i,o,a){var s,u;if(a&&(-1!==t.localName.indexOf(":")||!c.xml_isName(t.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var d="<",p="",f=!1,h=!1,m=i.copy(),g={},v=this._recordNamespaceInformation(t,m,g),y=n,b=t.namespaceURI;if(y===b)null!==v&&(h=!0),d+=p=b===l.namespace.XML?"xml:"+t.localName:t.localName;else{var x=t.prefix,A=null;if(null===x&&b===v||(A=m.get(x,b)),"xmlns"===x){if(a)throw new Error("An element cannot have the 'xmlns' prefix (well-formed required).");A=x}null!==A?(p=A+":"+t.localName,null!==v&&v!==l.namespace.XML&&(y=v||null),d+=p):null!==x?(x in g&&(x=this._generatePrefix(b,m,o)),m.set(x,b),d+=p+=x+":"+t.localName,d+=" xmlns:"+x+'="'+this._serializeAttributeValue(b,a)+'"',null!==v&&(y=v||null)):null===v||null!==v&&v!==b?(h=!0,y=b,d+=p+=t.localName,d+=' xmlns="'+this._serializeAttributeValue(b,a)+'"'):(y=b,d+=p+=t.localName)}d+=this._serializeAttributesNS(t,m,o,g,h,a);var C=b===l.namespace.HTML;if(C&&0===t.childNodes.length&&e._VoidElementNames.has(t.localName)?(d+=" /",f=!0):C||0!==t.childNodes.length||(d+="/",f=!0),d+=">",f)return d;if(C&&"template"===t.localName);else try{for(var T=r(t._children||t.childNodes),S=T.next();!S.done;S=T.next()){var w=S.value;d+=this._serializeNodeNS(w,y,m,o,a)}}catch(e){s={error:e}}finally{try{S&&!S.done&&(u=T.return)&&u.call(T)}finally{if(s)throw s.error}}return d+"</"+p+">"},e.prototype._serializeDocumentNS=function(e,t,n,i,o){var a,s;if(o&&null===e.documentElement)throw new Error("Missing document element (well-formed required).");var l="";try{for(var c=r(e._children||e.childNodes),u=c.next();!u.done;u=c.next()){var d=u.value;l+=this._serializeNodeNS(d,t,n,i,o)}}catch(e){a={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return l},e.prototype._serializeComment=function(e,t){if(t&&(!c.xml_isLegalChar(e.data)||-1!==e.data.indexOf("--")||e.data.endsWith("-")))throw new Error("Comment data contains invalid characters (well-formed required).");return"\x3c!--"+e.data+"--\x3e"},e.prototype._serializeText=function(e,t){if(t&&!c.xml_isLegalChar(e.data))throw new Error("Text data contains invalid characters (well-formed required).");for(var n="",r=0;r<e.data.length;r++){var i=e.data[r];n+="&"===i?"&amp;":"<"===i?"&lt;":">"===i?"&gt;":i}return n},e.prototype._serializeDocumentFragmentNS=function(e,t,n,i,o){var a,s,l="";try{for(var c=r(e._children||e.childNodes),u=c.next();!u.done;u=c.next()){var d=u.value;l+=this._serializeNodeNS(d,t,n,i,o)}}catch(e){a={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}return l},e.prototype._serializeDocumentType=function(e,t){if(t&&!c.xml_isPubidChar(e.publicId))throw new Error("DocType public identifier does not match PubidChar construct (well-formed required).");if(t&&(!c.xml_isLegalChar(e.systemId)||-1!==e.systemId.indexOf('"')&&-1!==e.systemId.indexOf("'")))throw new Error("DocType system identifier contains invalid characters (well-formed required).");return e.publicId&&e.systemId?"<!DOCTYPE "+e.name+' PUBLIC "'+e.publicId+'" "'+e.systemId+'">':e.publicId?"<!DOCTYPE "+e.name+' PUBLIC "'+e.publicId+'">':e.systemId?"<!DOCTYPE "+e.name+' SYSTEM "'+e.systemId+'">':"<!DOCTYPE "+e.name+">"},e.prototype._serializeProcessingInstruction=function(e,t){if(t&&(-1!==e.target.indexOf(":")||/^xml$/i.test(e.target)))throw new Error("Processing instruction target contains invalid characters (well-formed required).");if(t&&(!c.xml_isLegalChar(e.data)||-1!==e.data.indexOf("?>")))throw new Error("Processing instruction data contains invalid characters (well-formed required).");return"<?"+(""===e.data?e.target:e.target+" "+e.data)+"?>"},e.prototype._serializeCData=function(e,t){if(t&&-1!==e.data.indexOf("]]>"))throw new Error("CDATA contains invalid characters (well-formed required).");return"<![CDATA["+e.data+"]]>"},e.prototype._serializeAttributesNS=function(e,t,n,i,a,s){var u,d,p="",f=s?new o.LocalNameSet:void 0;try{for(var h=r(e.attributes),m=h.next();!m.done;m=h.next()){var g=m.value;if(a||s||null!==g.namespaceURI){if(s&&f&&f.has(g.namespaceURI,g.localName))throw new Error("Element contains duplicate attributes (well-formed required).");s&&f&&f.set(g.namespaceURI,g.localName);var v=g.namespaceURI,y=null;if(null!==v)if(y=t.get(g.prefix,v),v===l.namespace.XMLNS){if(g.value===l.namespace.XML||null===g.prefix&&a||null!==g.prefix&&(!(g.localName in i)||i[g.localName]!==g.value)&&t.has(g.localName,g.value))continue;if(s&&g.value===l.namespace.XMLNS)throw new Error("XMLNS namespace is reserved (well-formed required).");if(s&&""===g.value)throw new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required).");"xmlns"===g.prefix&&(y="xmlns")}else null===y&&(p+=" xmlns:"+(y=null===g.prefix||t.hasPrefix(g.prefix)&&!t.has(g.prefix,v)?this._generatePrefix(v,t,n):g.prefix)+'="'+this._serializeAttributeValue(v,s)+'"');if(p+=" ",null!==y&&(p+=y+":"),s&&(-1!==g.localName.indexOf(":")||!c.xml_isName(g.localName)||"xmlns"===g.localName&&null===v))throw new Error("Attribute local name contains invalid characters (well-formed required).");p+=g.localName+'="'+this._serializeAttributeValue(g.value,s)+'"'}else p+=" "+g.localName+'="'+this._serializeAttributeValue(g.value,s)+'"'}}catch(e){u={error:e}}finally{try{m&&!m.done&&(d=h.return)&&d.call(h)}finally{if(u)throw u.error}}return p},e.prototype._recordNamespaceInformation=function(e,t,n){var i,o,a=null;try{for(var s=r(e.attributes),c=s.next();!c.done;c=s.next()){var u=c.value,d=u.namespaceURI,p=u.prefix;if(d===l.namespace.XMLNS){if(null===p){a=u.value;continue}var f=u.localName,h=u.value;if(h===l.namespace.XML)continue;if(""===h&&(h=null),t.has(f,h))continue;t.set(f,h),n[f]=h||""}}}catch(e){i={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}return a},e.prototype._generatePrefix=function(e,t,n){var r="ns"+n.value;return n.value++,t.set(r,e),r},e.prototype._serializeAttributeValue=function(e,t){if(t&&null!==e&&!c.xml_isLegalChar(e))throw new Error("Invalid characters in attribute value.");if(null===e)return"";for(var n="",r=0;r<e.length;r++){var i=e[r];n+='"'===i?"&quot;":"&"===i?"&amp;":"<"===i?"&lt;":">"===i?"&gt;":i}return n},e.prototype._serializeElement=function(e,t){var n,i;if(t&&(-1!==e.localName.indexOf(":")||!c.xml_isName(e.localName)))throw new Error("Node local name contains invalid characters (well-formed required).");var o=!1,a=e.localName,s="<"+a;if(s+=this._serializeAttributes(e,t),0===e._children.size&&(s+="/",o=!0),s+=">",o)return s;try{for(var l=r(e._children),u=l.next();!u.done;u=l.next()){var d=u.value;s+=this._serializeNode(d,t)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return s+"</"+a+">"},e.prototype._serializeDocument=function(e,t){var n,i;if(t&&null===e.documentElement)throw new Error("Missing document element (well-formed required).");var o="";try{for(var a=r(e._children),s=a.next();!s.done;s=a.next()){var l=s.value;o+=this._serializeNode(l,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return o},e.prototype._serializeDocumentFragment=function(e,t){var n,i,o="";try{for(var a=r(e._children),s=a.next();!s.done;s=a.next()){var l=s.value;o+=this._serializeNode(l,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return o},e.prototype._serializeAttributes=function(e,t){var n,i,o="",a=t?{}:void 0;try{for(var s=r(e.attributes),l=s.next();!l.done;l=s.next()){var u=l.value;if(t&&a&&u.localName in a)throw new Error("Element contains duplicate attributes (well-formed required).");if(t&&a&&(a[u.localName]=!0),t&&(-1!==u.localName.indexOf(":")||!c.xml_isName(u.localName)))throw new Error("Attribute local name contains invalid characters (well-formed required).");o+=" "+u.localName+'="'+this._serializeAttributeValue(u.value,t)+'"'}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o},e._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),e}();t.XMLSerializerImpl=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(277);t.XMLReader=r.XMLReader;var i=n(112);t.ObjectReader=i.ObjectReader;var o=n(280);t.JSONReader=o.JSONReader;var a=n(281);t.YAMLReader=a.YAMLReader},function(e,t,n){"use strict";n(31),n(32),n(33),n(19),n(65),n(20),n(22),n(23);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0});var s=n(180),l=n(111),c=n(7),u=n(0),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._parse=function(e,t){for(var n,r,i,d,p=new s.XMLStringLexer(t,{skipWhitespaceOnlyText:!0}),f=e,h=e,m=p.nextToken();m.type!==l.TokenType.EOF;){switch(m.type){case l.TokenType.Declaration:var g=m,v=this.sanitize(g.version);if("1.0"!==v)throw new Error("Invalid xml version: "+v);var y={version:v};g.encoding&&(y.encoding=this.sanitize(g.encoding)),g.standalone&&(y.standalone="yes"===this.sanitize(g.standalone)),h.set(y);break;case l.TokenType.DocType:var b=m;h=this.docType(h,this.sanitize(b.name),this.sanitize(b.pubId),this.sanitize(b.sysId))||h;break;case l.TokenType.CDATA:var x=m;h=this.cdata(h,this.sanitize(x.data))||h;break;case l.TokenType.Comment:var A=m;h=this.comment(h,this.sanitize(A.data))||h;break;case l.TokenType.PI:var C=m;h=this.instruction(h,this.sanitize(C.target),this.sanitize(C.data))||h;break;case l.TokenType.Text:var T=m;h=this.text(h,this._decodeText(this.sanitize(T.data)))||h;break;case l.TokenType.Element:var S=m,w=this.sanitize(S.name),_=o(u.namespace_extractQName(w),1)[0],I=h.node.lookupNamespaceURI(_),E={};try{for(var D=(n=void 0,a(S.attributes)),O=D.next();!O.done;O=D.next()){var P=o(O.value,2),R=P[0],N=P[1];if(R=this.sanitize(R),N=this.sanitize(N),"xmlns"===R)I=N;else{var M=o(u.namespace_extractQName(R),2),L=M[0],F=M[1];"xmlns"===L&&(F===_&&(I=N),E[F]=N)}}}catch(e){n={error:e}}finally{try{O&&!O.done&&(r=D.return)&&r.call(D)}finally{if(n)throw n.error}}var B=null!==I?this.element(h,I,w):this.element(h,void 0,w);if(void 0===B)break;h.node===e.node&&(f=B);try{for(var V=(i=void 0,a(S.attributes)),k=V.next();!k.done;k=V.next()){var U=o(k.value,2);R=U[0],N=U[1],R=this.sanitize(R),N=this.sanitize(N);var G=o(u.namespace_extractQName(R),2),z=(L=G[0],F=G[1],null);"xmlns"===L||null===L&&"xmlns"===F?z=c.namespace.XMLNS:null!==(z=B.node.lookupNamespaceURI(L))&&B.node.isDefaultNamespace(z)?z=null:null===z&&null!==L&&(z=E[L]||null),null!==z?this.attribute(B,z,R,this._decodeAttributeValue(N)):this.attribute(B,void 0,R,this._decodeAttributeValue(N))}}catch(e){i={error:e}}finally{try{k&&!k.done&&(d=V.return)&&d.call(V)}finally{if(i)throw i.error}}S.selfClosing||(h=B);break;case l.TokenType.ClosingTag:h.node.parentNode&&(h=h.up())}m=p.nextToken()}return f},t}(n(75).BaseReader);t.XMLReader=d},function(e,t,n){var r=n(4),i=n(279);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(e,t,n){"use strict";var r=n(16),i=n(8),o=n(61),a=n(85),s=n(79),l=n(27),c=n(41),u=Object.assign,d=Object.defineProperty;e.exports=!u||i((function(){if(r&&1!==u({b:1},u(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||"abcdefghijklmnopqrst"!=o(u({},t)).join("")}))?function(e,t){for(var n=l(e),i=arguments.length,u=1,d=a.f,p=s.f;i>u;)for(var f,h=c(arguments[u++]),m=d?o(h).concat(d(h)):o(h),g=m.length,v=0;g>v;)f=m[v++],r&&!p.call(h,f)||(n[f]=h[f]);return n}:u},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(112),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._parse=function(e,t){return new o.ObjectReader(this._builderOptions).parse(e,JSON.parse(t))},t}(n(75).BaseReader);t.JSONReader=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(112),a=n(75),s=n(282),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._parse=function(e,t){var n=s.safeLoad(t);if(void 0===n)throw new Error("Unable to parse YAML document.");return new o.ObjectReader(this._builderOptions).parse(e,n)},t}(a.BaseReader);t.YAMLReader=l},function(e,t,n){"use strict";var r=n(283);e.exports=r},function(e,t,n){"use strict";var r=n(284),i=n(303);function o(e){return function(){throw new Error("Function "+e+" is deprecated and cannot be used.")}}e.exports.Type=n(10),e.exports.Schema=n(39),e.exports.FAILSAFE_SCHEMA=n(113),e.exports.JSON_SCHEMA=n(182),e.exports.CORE_SCHEMA=n(181),e.exports.DEFAULT_SAFE_SCHEMA=n(54),e.exports.DEFAULT_FULL_SCHEMA=n(76),e.exports.load=r.load,e.exports.loadAll=r.loadAll,e.exports.safeLoad=r.safeLoad,e.exports.safeLoadAll=r.safeLoadAll,e.exports.dump=i.dump,e.exports.safeDump=i.safeDump,e.exports.YAMLException=n(53),e.exports.MINIMAL_SCHEMA=n(113),e.exports.SAFE_SCHEMA=n(54),e.exports.DEFAULT_SCHEMA=n(76),e.exports.scan=o("scan"),e.exports.parse=o("parse"),e.exports.compose=o("compose"),e.exports.addConstructor=o("addConstructor")},function(e,t,n){"use strict";var r=n(38),i=n(53),o=n(285),a=n(54),s=n(76),l=Object.prototype.hasOwnProperty,c=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,u=/[\x85\u2028\u2029]/,d=/[,\[\]\{\}]/,p=/^(?:!|!!|![a-z\-]+!)$/i,f=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function h(e){return Object.prototype.toString.call(e)}function m(e){return 10===e||13===e}function g(e){return 9===e||32===e}function v(e){return 9===e||32===e||10===e||13===e}function y(e){return 44===e||91===e||93===e||123===e||125===e}function b(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function x(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function A(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var C=new Array(256),T=new Array(256),S=0;S<256;S++)C[S]=x(S)?1:0,T[S]=x(S);function w(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||s,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function _(e,t){return new i(t,new o(e.filename,e.input,e.position,e.line,e.position-e.lineStart))}function I(e,t){throw _(e,t)}function E(e,t){e.onWarning&&e.onWarning.call(null,_(e,t))}var D={YAML:function(e,t,n){var r,i,o;null!==e.version&&I(e,"duplication of %YAML directive"),1!==n.length&&I(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&I(e,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),o=parseInt(r[2],10),1!==i&&I(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=o<2,1!==o&&2!==o&&E(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,i;2!==n.length&&I(e,"TAG directive accepts exactly two arguments"),r=n[0],i=n[1],p.test(r)||I(e,"ill-formed tag handle (first argument) of the TAG directive"),l.call(e.tagMap,r)&&I(e,'there is a previously declared suffix for "'+r+'" tag handle'),f.test(i)||I(e,"ill-formed tag prefix (second argument) of the TAG directive"),e.tagMap[r]=i}};function O(e,t,n,r){var i,o,a,s;if(t<n){if(s=e.input.slice(t,n),r)for(i=0,o=s.length;i<o;i+=1)9===(a=s.charCodeAt(i))||32<=a&&a<=1114111||I(e,"expected valid JSON character");else c.test(s)&&I(e,"the stream contains non-printable characters");e.result+=s}}function P(e,t,n,i){var o,a,s,c;for(r.isObject(n)||I(e,"cannot merge mappings; the provided source object is unacceptable"),s=0,c=(o=Object.keys(n)).length;s<c;s+=1)a=o[s],l.call(t,a)||(t[a]=n[a],i[a]=!0)}function R(e,t,n,r,i,o,a,s){var c,u;if(Array.isArray(i))for(c=0,u=(i=Array.prototype.slice.call(i)).length;c<u;c+=1)Array.isArray(i[c])&&I(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===h(i[c])&&(i[c]="[object Object]");if("object"==typeof i&&"[object Object]"===h(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)P(e,t,o[c],n);else P(e,t,o,n);else e.json||l.call(n,i)||!l.call(t,i)||(e.line=a||e.line,e.position=s||e.position,I(e,"duplicated mapping key")),t[i]=o,delete n[i];return t}function N(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):I(e,"a line break is expected"),e.line+=1,e.lineStart=e.position}function M(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);0!==i;){for(;g(i);)i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!m(i))break;for(N(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&E(e,"deficient indentation"),r}function L(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!v(t)))}function F(e,t){1===t?e.result+=" ":t>1&&(e.result+=r.repeat("\n",t-1))}function B(e,t){var n,r,i=e.tag,o=e.anchor,a=[],s=!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),r=e.input.charCodeAt(e.position);0!==r&&45===r&&v(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,M(e,!0,-1)&&e.lineIndent<=t)a.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,U(e,t,3,!1,!0),a.push(e.result),M(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)I(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=i,e.anchor=o,e.kind="sequence",e.result=a,!0)}function V(e){var t,n,r,i,o=!1,a=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&I(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(o=!0,i=e.input.charCodeAt(++e.position)):33===i?(a=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,o){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(r=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):I(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!v(i);)33===i&&(a?I(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),p.test(n)||I(e,"named tag handle cannot contain such characters"),a=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),d.test(r)&&I(e,"tag suffix cannot contain flow indicator characters")}return r&&!f.test(r)&&I(e,"tag name cannot contain such characters: "+r),o?e.tag=r:l.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:I(e,'undeclared tag handle "'+n+'"'),!0}function k(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&I(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!v(n)&&!y(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&I(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function U(e,t,n,i,o){var a,s,c,u,d,p,f,h,x=1,S=!1,w=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=s=c=4===n||3===n,i&&M(e,!0,-1)&&(S=!0,e.lineIndent>t?x=1:e.lineIndent===t?x=0:e.lineIndent<t&&(x=-1)),1===x)for(;V(e)||k(e);)M(e,!0,-1)?(S=!0,c=a,e.lineIndent>t?x=1:e.lineIndent===t?x=0:e.lineIndent<t&&(x=-1)):c=!1;if(c&&(c=S||o),1!==x&&4!==n||(f=1===n||2===n?t:t+1,h=e.position-e.lineStart,1===x?c&&(B(e,h)||function(e,t,n){var r,i,o,a,s,l=e.tag,c=e.anchor,u={},d={},p=null,f=null,h=null,m=!1,y=!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=u),s=e.input.charCodeAt(e.position);0!==s;){if(r=e.input.charCodeAt(e.position+1),o=e.line,a=e.position,63!==s&&58!==s||!v(r)){if(!U(e,n,2,!1,!0))break;if(e.line===o){for(s=e.input.charCodeAt(e.position);g(s);)s=e.input.charCodeAt(++e.position);if(58===s)v(s=e.input.charCodeAt(++e.position))||I(e,"a whitespace character is expected after the key-value separator within a block mapping"),m&&(R(e,u,d,p,f,null),p=f=h=null),y=!0,m=!1,i=!1,p=e.tag,f=e.result;else{if(!y)return e.tag=l,e.anchor=c,!0;I(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return e.tag=l,e.anchor=c,!0;I(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===s?(m&&(R(e,u,d,p,f,null),p=f=h=null),y=!0,m=!0,i=!0):m?(m=!1,i=!0):I(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,s=r;if((e.line===o||e.lineIndent>t)&&(U(e,t,4,!0,i)&&(m?f=e.result:h=e.result),m||(R(e,u,d,p,f,h,o,a),p=f=h=null),M(e,!0,-1),s=e.input.charCodeAt(e.position)),e.lineIndent>t&&0!==s)I(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return m&&R(e,u,d,p,f,null),y&&(e.tag=l,e.anchor=c,e.kind="mapping",e.result=u),y}(e,h,f))||function(e,t){var n,r,i,o,a,s,l,c,u,d,p=!0,f=e.tag,h=e.anchor,m={};if(91===(d=e.input.charCodeAt(e.position)))i=93,s=!1,r=[];else{if(123!==d)return!1;i=125,s=!0,r={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=r),d=e.input.charCodeAt(++e.position);0!==d;){if(M(e,!0,t),(d=e.input.charCodeAt(e.position))===i)return e.position++,e.tag=f,e.anchor=h,e.kind=s?"mapping":"sequence",e.result=r,!0;p||I(e,"missed comma between flow collection entries"),u=null,o=a=!1,63===d&&v(e.input.charCodeAt(e.position+1))&&(o=a=!0,e.position++,M(e,!0,t)),n=e.line,U(e,t,1,!1,!0),c=e.tag,l=e.result,M(e,!0,t),d=e.input.charCodeAt(e.position),!a&&e.line!==n||58!==d||(o=!0,d=e.input.charCodeAt(++e.position),M(e,!0,t),U(e,t,1,!1,!0),u=e.result),s?R(e,r,m,c,l,u):o?r.push(R(e,null,m,c,l,u)):r.push(l),M(e,!0,t),44===(d=e.input.charCodeAt(e.position))?(p=!0,d=e.input.charCodeAt(++e.position)):p=!1}I(e,"unexpected end of the stream within a flow collection")}(e,f)?w=!0:(s&&function(e,t){var n,i,o,a,s,l=1,c=!1,u=!1,d=t,p=0,f=!1;if(124===(a=e.input.charCodeAt(e.position)))i=!1;else{if(62!==a)return!1;i=!0}for(e.kind="scalar",e.result="";0!==a;)if(43===(a=e.input.charCodeAt(++e.position))||45===a)1===l?l=43===a?3:2:I(e,"repeat of a chomping mode identifier");else{if(!((o=48<=(s=a)&&s<=57?s-48:-1)>=0))break;0===o?I(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):u?I(e,"repeat of an indentation width identifier"):(d=t+o-1,u=!0)}if(g(a)){do{a=e.input.charCodeAt(++e.position)}while(g(a));if(35===a)do{a=e.input.charCodeAt(++e.position)}while(!m(a)&&0!==a)}for(;0!==a;){for(N(e),e.lineIndent=0,a=e.input.charCodeAt(e.position);(!u||e.lineIndent<d)&&32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position);if(!u&&e.lineIndent>d&&(d=e.lineIndent),m(a))p++;else{if(e.lineIndent<d){3===l?e.result+=r.repeat("\n",c?1+p:p):1===l&&c&&(e.result+="\n");break}for(i?g(a)?(f=!0,e.result+=r.repeat("\n",c?1+p:p)):f?(f=!1,e.result+=r.repeat("\n",p+1)):0===p?c&&(e.result+=" "):e.result+=r.repeat("\n",p):e.result+=r.repeat("\n",c?1+p:p),c=!0,u=!0,p=0,n=e.position;!m(a)&&0!==a;)a=e.input.charCodeAt(++e.position);O(e,n,e.position,!1)}}return!0}(e,f)||function(e,t){var n,r,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(O(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,i=e.position}else m(n)?(O(e,r,i,!0),F(e,M(e,!1,t)),r=i=e.position):e.position===e.lineStart&&L(e)?I(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);I(e,"unexpected end of the stream within a single quoted scalar")}(e,f)||function(e,t){var n,r,i,o,a,s,l;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(s=e.input.charCodeAt(e.position));){if(34===s)return O(e,n,e.position,!0),e.position++,!0;if(92===s){if(O(e,n,e.position,!0),m(s=e.input.charCodeAt(++e.position)))M(e,!1,t);else if(s<256&&C[s])e.result+=T[s],e.position++;else if((a=120===(l=s)?2:117===l?4:85===l?8:0)>0){for(i=a,o=0;i>0;i--)(a=b(s=e.input.charCodeAt(++e.position)))>=0?o=(o<<4)+a:I(e,"expected hexadecimal character");e.result+=A(o),e.position++}else I(e,"unknown escape sequence");n=r=e.position}else m(s)?(O(e,n,r,!0),F(e,M(e,!1,t)),n=r=e.position):e.position===e.lineStart&&L(e)?I(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}I(e,"unexpected end of the stream within a double quoted scalar")}(e,f)?w=!0:function(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!v(r)&&!y(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&I(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),e.anchorMap.hasOwnProperty(n)||I(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],M(e,!0,-1),!0}(e)?(w=!0,null===e.tag&&null===e.anchor||I(e,"alias node should not have any properties")):function(e,t,n){var r,i,o,a,s,l,c,u,d=e.kind,p=e.result;if(v(u=e.input.charCodeAt(e.position))||y(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u)return!1;if((63===u||45===u)&&(v(r=e.input.charCodeAt(e.position+1))||n&&y(r)))return!1;for(e.kind="scalar",e.result="",i=o=e.position,a=!1;0!==u;){if(58===u){if(v(r=e.input.charCodeAt(e.position+1))||n&&y(r))break}else if(35===u){if(v(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&L(e)||n&&y(u))break;if(m(u)){if(s=e.line,l=e.lineStart,c=e.lineIndent,M(e,!1,-1),e.lineIndent>=t){a=!0,u=e.input.charCodeAt(e.position);continue}e.position=o,e.line=s,e.lineStart=l,e.lineIndent=c;break}}a&&(O(e,i,o,!1),F(e,e.line-s),i=o=e.position,a=!1),g(u)||(o=e.position+1),u=e.input.charCodeAt(++e.position)}return O(e,i,o,!1),!!e.result||(e.kind=d,e.result=p,!1)}(e,f,1===n)&&(w=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===x&&(w=c&&B(e,h))),null!==e.tag&&"!"!==e.tag)if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&I(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),u=0,d=e.implicitTypes.length;u<d;u+=1)if((p=e.implicitTypes[u]).resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else l.call(e.typeMap[e.kind||"fallback"],e.tag)?(p=e.typeMap[e.kind||"fallback"][e.tag],null!==e.result&&p.kind!==e.kind&&I(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result)?(e.result=p.construct(e.result),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):I(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")):I(e,"unknown tag !<"+e.tag+">");return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||w}function G(e){var t,n,r,i,o=e.position,a=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap={},e.anchorMap={};0!==(i=e.input.charCodeAt(e.position))&&(M(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(a=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!v(i);)i=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&I(e,"directive name must not be less than one character in length");0!==i;){for(;g(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!m(i));break}if(m(i))break;for(t=e.position;0!==i&&!v(i);)i=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==i&&N(e),l.call(D,n)?D[n](e,n,r):E(e,'unknown document directive "'+n+'"')}M(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,M(e,!0,-1)):a&&I(e,"directives end mark is expected"),U(e,e.lineIndent-1,4,!1,!0),M(e,!0,-1),e.checkLineBreaks&&u.test(e.input.slice(o,e.position))&&E(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&L(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,M(e,!0,-1)):e.position<e.length-1&&I(e,"end of the stream or a document separator is expected")}function z(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new w(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,I(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)G(n);return n.documents}function W(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=z(e,n);if("function"!=typeof t)return r;for(var i=0,o=r.length;i<o;i+=1)t(r[i])}function j(e,t){var n=z(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new i("expected a single document in the stream, but found more")}}e.exports.loadAll=W,e.exports.load=j,e.exports.safeLoadAll=function(e,t,n){return"object"==typeof t&&null!==t&&void 0===n&&(n=t,t=null),W(e,t,r.extend({schema:a},n))},e.exports.safeLoad=function(e,t){return j(e,r.extend({schema:a},t))}},function(e,t,n){"use strict";var r=n(38);function i(e,t,n,r,i){this.name=e,this.buffer=t,this.position=n,this.line=r,this.column=i}i.prototype.getSnippet=function(e,t){var n,i,o,a,s;if(!this.buffer)return null;for(e=e||4,t=t||75,n="",i=this.position;i>0&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(i-1));)if(i-=1,this.position-i>t/2-1){n=" ... ",i+=5;break}for(o="",a=this.position;a<this.buffer.length&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(a));)if((a+=1)-this.position>t/2-1){o=" ... ",a-=5;break}return s=this.buffer.slice(i,a),r.repeat(" ",e)+n+s+o+"\n"+r.repeat(" ",e+this.position-i+n.length)+"^"},i.prototype.toString=function(e){var t,n="";return this.name&&(n+='in "'+this.name+'" '),n+="at line "+(this.line+1)+", column "+(this.column+1),e||(t=this.getSnippet())&&(n+=":\n"+t),n},e.exports=i},function(e,t,n){"use strict";var r=n(10);e.exports=new r("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}})},function(e,t,n){"use strict";var r=n(10);e.exports=new r("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}})},function(e,t,n){"use strict";var r=n(10);e.exports=new r("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})},function(e,t,n){"use strict";var r=n(10);e.exports=new r("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"})},function(e,t,n){"use strict";var r=n(10);e.exports=new r("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"})},function(e,t,n){"use strict";var r=n(38),i=n(10);function o(e){return 48<=e&&e<=55}function a(e){return 48<=e&&e<=57}e.exports=new i("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=e.length,i=0,s=!1;if(!r)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===r)return!0;if("b"===(t=e[++i])){for(i++;i<r;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;s=!0}return s&&"_"!==t}if("x"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!(48<=(n=e.charCodeAt(i))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;s=!0}return s&&"_"!==t}for(;i<r;i++)if("_"!==(t=e[i])){if(!o(e.charCodeAt(i)))return!1;s=!0}return s&&"_"!==t}if("_"===t)return!1;for(;i<r;i++)if("_"!==(t=e[i])){if(":"===t)break;if(!a(e.charCodeAt(i)))return!1;s=!0}return!(!s||"_"===t)&&(":"!==t||/^(:[0-5]?[0-9])+$/.test(e.slice(i)))},construct:function(e){var t,n,r=e,i=1,o=[];return-1!==r.indexOf("_")&&(r=r.replace(/_/g,"")),"-"!==(t=r[0])&&"+"!==t||("-"===t&&(i=-1),t=(r=r.slice(1))[0]),"0"===r?0:"0"===t?"b"===r[1]?i*parseInt(r.slice(2),2):"x"===r[1]?i*parseInt(r,16):i*parseInt(r,8):-1!==r.indexOf(":")?(r.split(":").forEach((function(e){o.unshift(parseInt(e,10))})),r=0,n=1,o.forEach((function(e){r+=e*n,n*=60})),i*r):i*parseInt(r,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!r.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0"+e.toString(8):"-0"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},function(e,t,n){"use strict";var r=n(38),i=n(10),o=new RegExp("^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),a=/^[-+]?[0-9]+e/;e.exports=new i("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!o.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n,r,i;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,i=[],"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:t.indexOf(":")>=0?(t.split(":").forEach((function(e){i.unshift(parseFloat(e,10))})),t=0,r=1,i.forEach((function(e){t+=e*r,r*=60})),n*t):n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||r.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(r.isNegativeZero(e))return"-0.0";return n=e.toString(10),a.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"})},function(e,t,n){"use strict";var r=n(10),i=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),o=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");e.exports=new r("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==i.exec(e)||null!==o.exec(e))},construct:function(e){var t,n,r,a,s,l,c,u,d=0,p=null;if(null===(t=i.exec(e))&&(t=o.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(n,r,a));if(s=+t[4],l=+t[5],c=+t[6],t[7]){for(d=t[7].slice(0,3);d.length<3;)d+="0";d=+d}return t[9]&&(p=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(p=-p)),u=new Date(Date.UTC(n,r,a,s,l,c,d)),p&&u.setTime(u.getTime()-p),u},instanceOf:Date,represent:function(e){return e.toISOString()}})},function(e,t,n){"use strict";var r=n(10);e.exports=new r("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}})},function(e,t,n){"use strict";var r;try{r=n(145).Buffer}catch(e){}var i=n(10),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";e.exports=new i("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=0,i=e.length,a=o;for(n=0;n<i;n++)if(!((t=a.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0},construct:function(e){var t,n,i=e.replace(/[\r\n=]/g,""),a=i.length,s=o,l=0,c=[];for(t=0;t<a;t++)t%4==0&&t&&(c.push(l>>16&255),c.push(l>>8&255),c.push(255&l)),l=l<<6|s.indexOf(i.charAt(t));return 0==(n=a%4*6)?(c.push(l>>16&255),c.push(l>>8&255),c.push(255&l)):18===n?(c.push(l>>10&255),c.push(l>>2&255)):12===n&&c.push(l>>4&255),r?r.from?r.from(c):new r(c):c},predicate:function(e){return r&&r.isBuffer(e)},represent:function(e){var t,n,r="",i=0,a=e.length,s=o;for(t=0;t<a;t++)t%3==0&&t&&(r+=s[i>>18&63],r+=s[i>>12&63],r+=s[i>>6&63],r+=s[63&i]),i=(i<<8)+e[t];return 0==(n=a%3)?(r+=s[i>>18&63],r+=s[i>>12&63],r+=s[i>>6&63],r+=s[63&i]):2===n?(r+=s[i>>10&63],r+=s[i>>4&63],r+=s[i<<2&63],r+=s[64]):1===n&&(r+=s[i>>2&63],r+=s[i<<4&63],r+=s[64],r+=s[64]),r}})},function(e,t,n){"use strict";var r=n(10),i=Object.prototype.hasOwnProperty,o=Object.prototype.toString;e.exports=new r("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,a,s,l=[],c=e;for(t=0,n=c.length;t<n;t+=1){if(r=c[t],s=!1,"[object Object]"!==o.call(r))return!1;for(a in r)if(i.call(r,a)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==l.indexOf(a))return!1;l.push(a)}return!0},construct:function(e){return null!==e?e:[]}})},function(e,t,n){"use strict";var r=n(10),i=Object.prototype.toString;e.exports=new r("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,o,a,s=e;for(a=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(r=s[t],"[object Object]"!==i.call(r))return!1;if(1!==(o=Object.keys(r)).length)return!1;a[t]=[o[0],r[o[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,r,i,o,a=e;for(o=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],i=Object.keys(r),o[t]=[i[0],r[i[0]]];return o}})},function(e,t,n){"use strict";var r=n(10),i=Object.prototype.hasOwnProperty;e.exports=new r("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(i.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}})},function(e,t,n){"use strict";var r=n(10);e.exports=new r("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(e){return void 0===e},represent:function(){return""}})},function(e,t,n){"use strict";var r=n(10);e.exports=new r("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(e){if(null===e)return!1;if(0===e.length)return!1;var t=e,n=/\/([gim]*)$/.exec(e),r="";if("/"===t[0]){if(n&&(r=n[1]),r.length>3)return!1;if("/"!==t[t.length-r.length-1])return!1}return!0},construct:function(e){var t=e,n=/\/([gim]*)$/.exec(e),r="";return"/"===t[0]&&(n&&(r=n[1]),t=t.slice(1,t.length-r.length-1)),new RegExp(t,r)},predicate:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},represent:function(e){var t="/"+e.source+"/";return e.global&&(t+="g"),e.multiline&&(t+="m"),e.ignoreCase&&(t+="i"),t}})},function(e,t,n){"use strict";var r;try{r=n(302)}catch(e){"undefined"!=typeof window&&(r=window.esprima)}var i=n(10);e.exports=new i("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(e){if(null===e)return!1;try{var t="("+e+")",n=r.parse(t,{range:!0});return"Program"===n.type&&1===n.body.length&&"ExpressionStatement"===n.body[0].type&&("ArrowFunctionExpression"===n.body[0].expression.type||"FunctionExpression"===n.body[0].expression.type)}catch(e){return!1}},construct:function(e){var t,n="("+e+")",i=r.parse(n,{range:!0}),o=[];if("Program"!==i.type||1!==i.body.length||"ExpressionStatement"!==i.body[0].type||"ArrowFunctionExpression"!==i.body[0].expression.type&&"FunctionExpression"!==i.body[0].expression.type)throw new Error("Failed to resolve function");return i.body[0].expression.params.forEach((function(e){o.push(e.name)})),t=i.body[0].expression.body.range,"BlockStatement"===i.body[0].expression.body.type?new Function(o,n.slice(t[0]+1,t[1]-1)):new Function(o,"return "+n.slice(t[0],t[1]))},predicate:function(e){return"[object Function]"===Object.prototype.toString.call(e)},represent:function(e){return e.toString()}})},function(e,t,n){var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(3),o=n(8),a=n(15);function s(e,t,n){var a=null,s=function(e,t){n&&n(e,t),a&&a.visit(e,t)},l="function"==typeof n?s:null,c=!1;if(t){c="boolean"==typeof t.comment&&t.comment;var u="boolean"==typeof t.attachComment&&t.attachComment;(c||u)&&((a=new r.CommentHandler).attach=u,t.comment=!0,l=s)}var d,p=!1;t&&"string"==typeof t.sourceType&&(p="module"===t.sourceType),d=t&&"boolean"==typeof t.jsx&&t.jsx?new i.JSXParser(e,t,l):new o.Parser(e,t,l);var f=p?d.parseModule():d.parseScript();return c&&a&&(f.comments=a.comments),d.config.tokens&&(f.tokens=d.tokens),d.config.tolerant&&(f.errors=d.errorHandler.errors),f}t.parse=s,t.parseModule=function(e,t,n){var r=t||{};return r.sourceType="module",s(e,r,n)},t.parseScript=function(e,t,n){var r=t||{};return r.sourceType="script",s(e,r,n)},t.tokenize=function(e,t,n){var r,i=new a.Tokenizer(e,t);r=[];try{for(;;){var o=i.getNextToken();if(!o)break;n&&(o=n(o)),r.push(o)}}catch(e){i.errorHandler.tolerate(e)}return i.errorHandler.tolerant&&(r.errors=i.errors()),r};var l=n(2);t.Syntax=l.Syntax,t.version="4.0.1"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(){function e(){this.attach=!1,this.comments=[],this.stack=[],this.leading=[],this.trailing=[]}return e.prototype.insertInnerComments=function(e,t){if(e.type===r.Syntax.BlockStatement&&0===e.body.length){for(var n=[],i=this.leading.length-1;i>=0;--i){var o=this.leading[i];t.end.offset>=o.start&&(n.unshift(o.comment),this.leading.splice(i,1),this.trailing.splice(i,1))}n.length&&(e.innerComments=n)}},e.prototype.findTrailingComments=function(e){var t=[];if(this.trailing.length>0){for(var n=this.trailing.length-1;n>=0;--n){var r=this.trailing[n];r.start>=e.end.offset&&t.unshift(r.comment)}return this.trailing.length=0,t}var i=this.stack[this.stack.length-1];if(i&&i.node.trailingComments){var o=i.node.trailingComments[0];o&&o.range[0]>=e.end.offset&&(t=i.node.trailingComments,delete i.node.trailingComments)}return t},e.prototype.findLeadingComments=function(e){for(var t,n=[];this.stack.length>0&&(o=this.stack[this.stack.length-1])&&o.start>=e.start.offset;)t=o.node,this.stack.pop();if(t){for(var r=(t.leadingComments?t.leadingComments.length:0)-1;r>=0;--r){var i=t.leadingComments[r];i.range[1]<=e.start.offset&&(n.unshift(i),t.leadingComments.splice(r,1))}return t.leadingComments&&0===t.leadingComments.length&&delete t.leadingComments,n}for(r=this.leading.length-1;r>=0;--r){var o;(o=this.leading[r]).start<=e.start.offset&&(n.unshift(o.comment),this.leading.splice(r,1))}return n},e.prototype.visitNode=function(e,t){if(!(e.type===r.Syntax.Program&&e.body.length>0)){this.insertInnerComments(e,t);var n=this.findTrailingComments(t),i=this.findLeadingComments(t);i.length>0&&(e.leadingComments=i),n.length>0&&(e.trailingComments=n),this.stack.push({node:e,start:t.start.offset})}},e.prototype.visitComment=function(e,t){var n="L"===e.type[0]?"Line":"Block",r={type:n,value:e.value};if(e.range&&(r.range=e.range),e.loc&&(r.loc=e.loc),this.comments.push(r),this.attach){var i={comment:{type:n,value:e.value,range:[t.start.offset,t.end.offset]},start:t.start.offset};e.loc&&(i.comment.loc=e.loc),e.type=n,this.leading.push(i),this.trailing.push(i)}},e.prototype.visit=function(e,t){"LineComment"===e.type||"BlockComment"===e.type?this.visitComment(e,t):this.attach&&this.visitNode(e,t)},e}();t.CommentHandler=i},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Syntax={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=n(5),s=n(6),l=n(7),c=n(8),u=n(13),d=n(14);function p(e){var t;switch(e.type){case s.JSXSyntax.JSXIdentifier:t=e.name;break;case s.JSXSyntax.JSXNamespacedName:var n=e;t=p(n.namespace)+":"+p(n.name);break;case s.JSXSyntax.JSXMemberExpression:var r=e;t=p(r.object)+"."+p(r.property)}return t}u.TokenName[100]="JSXIdentifier",u.TokenName[101]="JSXText";var f=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return i(t,e),t.prototype.parsePrimaryExpression=function(){return this.match("<")?this.parseJSXRoot():e.prototype.parsePrimaryExpression.call(this)},t.prototype.startJSX=function(){this.scanner.index=this.startMarker.index,this.scanner.lineNumber=this.startMarker.line,this.scanner.lineStart=this.startMarker.index-this.startMarker.column},t.prototype.finishJSX=function(){this.nextToken()},t.prototype.reenterJSX=function(){this.startJSX(),this.expectJSX("}"),this.config.tokens&&this.tokens.pop()},t.prototype.createJSXNode=function(){return this.collectComments(),{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},t.prototype.createJSXChildNode=function(){return{index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}},t.prototype.scanXHTMLEntity=function(e){for(var t="&",n=!0,r=!1,i=!1,a=!1;!this.scanner.eof()&&n&&!r;){var s=this.scanner.source[this.scanner.index];if(s===e)break;if(r=";"===s,t+=s,++this.scanner.index,!r)switch(t.length){case 2:i="#"===s;break;case 3:i&&(n=(a="x"===s)||o.Character.isDecimalDigit(s.charCodeAt(0)),i=i&&!a);break;default:n=(n=n&&!(i&&!o.Character.isDecimalDigit(s.charCodeAt(0))))&&!(a&&!o.Character.isHexDigit(s.charCodeAt(0)))}}if(n&&r&&t.length>2){var l=t.substr(1,t.length-2);i&&l.length>1?t=String.fromCharCode(parseInt(l.substr(1),10)):a&&l.length>2?t=String.fromCharCode(parseInt("0"+l.substr(1),16)):i||a||!d.XHTMLEntities[l]||(t=d.XHTMLEntities[l])}return t},t.prototype.lexJSX=function(){var e=this.scanner.source.charCodeAt(this.scanner.index);if(60===e||62===e||47===e||58===e||61===e||123===e||125===e)return{type:7,value:s=this.scanner.source[this.scanner.index++],lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index-1,end:this.scanner.index};if(34===e||39===e){for(var t=this.scanner.index,n=this.scanner.source[this.scanner.index++],r="";!this.scanner.eof()&&(l=this.scanner.source[this.scanner.index++])!==n;)r+="&"===l?this.scanXHTMLEntity(n):l;return{type:8,value:r,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}if(46===e){var i=this.scanner.source.charCodeAt(this.scanner.index+1),a=this.scanner.source.charCodeAt(this.scanner.index+2),s=46===i&&46===a?"...":".";return t=this.scanner.index,this.scanner.index+=s.length,{type:7,value:s,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}if(96===e)return{type:10,value:"",lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:this.scanner.index,end:this.scanner.index};if(o.Character.isIdentifierStart(e)&&92!==e){for(t=this.scanner.index,++this.scanner.index;!this.scanner.eof();){var l=this.scanner.source.charCodeAt(this.scanner.index);if(o.Character.isIdentifierPart(l)&&92!==l)++this.scanner.index;else{if(45!==l)break;++this.scanner.index}}return{type:100,value:this.scanner.source.slice(t,this.scanner.index),lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:t,end:this.scanner.index}}return this.scanner.lex()},t.prototype.nextJSXToken=function(){this.collectComments(),this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;var e=this.lexJSX();return this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.config.tokens&&this.tokens.push(this.convertToken(e)),e},t.prototype.nextJSXText=function(){this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart;for(var e=this.scanner.index,t="";!this.scanner.eof();){var n=this.scanner.source[this.scanner.index];if("{"===n||"<"===n)break;++this.scanner.index,t+=n,o.Character.isLineTerminator(n.charCodeAt(0))&&(++this.scanner.lineNumber,"\r"===n&&"\n"===this.scanner.source[this.scanner.index]&&++this.scanner.index,this.scanner.lineStart=this.scanner.index)}this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart;var r={type:101,value:t,lineNumber:this.scanner.lineNumber,lineStart:this.scanner.lineStart,start:e,end:this.scanner.index};return t.length>0&&this.config.tokens&&this.tokens.push(this.convertToken(r)),r},t.prototype.peekJSXToken=function(){var e=this.scanner.saveState();this.scanner.scanComments();var t=this.lexJSX();return this.scanner.restoreState(e),t},t.prototype.expectJSX=function(e){var t=this.nextJSXToken();7===t.type&&t.value===e||this.throwUnexpectedToken(t)},t.prototype.matchJSX=function(e){var t=this.peekJSXToken();return 7===t.type&&t.value===e},t.prototype.parseJSXIdentifier=function(){var e=this.createJSXNode(),t=this.nextJSXToken();return 100!==t.type&&this.throwUnexpectedToken(t),this.finalize(e,new a.JSXIdentifier(t.value))},t.prototype.parseJSXElementName=function(){var e=this.createJSXNode(),t=this.parseJSXIdentifier();if(this.matchJSX(":")){var n=t;this.expectJSX(":");var r=this.parseJSXIdentifier();t=this.finalize(e,new a.JSXNamespacedName(n,r))}else if(this.matchJSX("."))for(;this.matchJSX(".");){var i=t;this.expectJSX(".");var o=this.parseJSXIdentifier();t=this.finalize(e,new a.JSXMemberExpression(i,o))}return t},t.prototype.parseJSXAttributeName=function(){var e,t=this.createJSXNode(),n=this.parseJSXIdentifier();if(this.matchJSX(":")){var r=n;this.expectJSX(":");var i=this.parseJSXIdentifier();e=this.finalize(t,new a.JSXNamespacedName(r,i))}else e=n;return e},t.prototype.parseJSXStringLiteralAttribute=function(){var e=this.createJSXNode(),t=this.nextJSXToken();8!==t.type&&this.throwUnexpectedToken(t);var n=this.getTokenRaw(t);return this.finalize(e,new l.Literal(t.value,n))},t.prototype.parseJSXExpressionAttribute=function(){var e=this.createJSXNode();this.expectJSX("{"),this.finishJSX(),this.match("}")&&this.tolerateError("JSX attributes must only be assigned a non-empty expression");var t=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(e,new a.JSXExpressionContainer(t))},t.prototype.parseJSXAttributeValue=function(){return this.matchJSX("{")?this.parseJSXExpressionAttribute():this.matchJSX("<")?this.parseJSXElement():this.parseJSXStringLiteralAttribute()},t.prototype.parseJSXNameValueAttribute=function(){var e=this.createJSXNode(),t=this.parseJSXAttributeName(),n=null;return this.matchJSX("=")&&(this.expectJSX("="),n=this.parseJSXAttributeValue()),this.finalize(e,new a.JSXAttribute(t,n))},t.prototype.parseJSXSpreadAttribute=function(){var e=this.createJSXNode();this.expectJSX("{"),this.expectJSX("..."),this.finishJSX();var t=this.parseAssignmentExpression();return this.reenterJSX(),this.finalize(e,new a.JSXSpreadAttribute(t))},t.prototype.parseJSXAttributes=function(){for(var e=[];!this.matchJSX("/")&&!this.matchJSX(">");){var t=this.matchJSX("{")?this.parseJSXSpreadAttribute():this.parseJSXNameValueAttribute();e.push(t)}return e},t.prototype.parseJSXOpeningElement=function(){var e=this.createJSXNode();this.expectJSX("<");var t=this.parseJSXElementName(),n=this.parseJSXAttributes(),r=this.matchJSX("/");return r&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(e,new a.JSXOpeningElement(t,r,n))},t.prototype.parseJSXBoundaryElement=function(){var e=this.createJSXNode();if(this.expectJSX("<"),this.matchJSX("/")){this.expectJSX("/");var t=this.parseJSXElementName();return this.expectJSX(">"),this.finalize(e,new a.JSXClosingElement(t))}var n=this.parseJSXElementName(),r=this.parseJSXAttributes(),i=this.matchJSX("/");return i&&this.expectJSX("/"),this.expectJSX(">"),this.finalize(e,new a.JSXOpeningElement(n,i,r))},t.prototype.parseJSXEmptyExpression=function(){var e=this.createJSXChildNode();return this.collectComments(),this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.finalize(e,new a.JSXEmptyExpression)},t.prototype.parseJSXExpressionContainer=function(){var e,t=this.createJSXNode();return this.expectJSX("{"),this.matchJSX("}")?(e=this.parseJSXEmptyExpression(),this.expectJSX("}")):(this.finishJSX(),e=this.parseAssignmentExpression(),this.reenterJSX()),this.finalize(t,new a.JSXExpressionContainer(e))},t.prototype.parseJSXChildren=function(){for(var e=[];!this.scanner.eof();){var t=this.createJSXChildNode(),n=this.nextJSXText();if(n.start<n.end){var r=this.getTokenRaw(n),i=this.finalize(t,new a.JSXText(n.value,r));e.push(i)}if("{"!==this.scanner.source[this.scanner.index])break;var o=this.parseJSXExpressionContainer();e.push(o)}return e},t.prototype.parseComplexJSXElement=function(e){for(var t=[];!this.scanner.eof();){e.children=e.children.concat(this.parseJSXChildren());var n=this.createJSXChildNode(),r=this.parseJSXBoundaryElement();if(r.type===s.JSXSyntax.JSXOpeningElement){var i=r;if(i.selfClosing){var o=this.finalize(n,new a.JSXElement(i,[],null));e.children.push(o)}else t.push(e),e={node:n,opening:i,closing:null,children:[]}}if(r.type===s.JSXSyntax.JSXClosingElement){e.closing=r;var l=p(e.opening.name);if(l!==p(e.closing.name)&&this.tolerateError("Expected corresponding JSX closing tag for %0",l),!(t.length>0))break;o=this.finalize(e.node,new a.JSXElement(e.opening,e.children,e.closing)),(e=t[t.length-1]).children.push(o),t.pop()}}return e},t.prototype.parseJSXElement=function(){var e=this.createJSXNode(),t=this.parseJSXOpeningElement(),n=[],r=null;if(!t.selfClosing){var i=this.parseComplexJSXElement({node:e,opening:t,closing:r,children:n});n=i.children,r=i.closing}return this.finalize(e,new a.JSXElement(t,n,r))},t.prototype.parseJSXRoot=function(){this.config.tokens&&this.tokens.pop(),this.startJSX();var e=this.parseJSXElement();return this.finishJSX(),e},t.prototype.isStartOfExpression=function(){return e.prototype.isStartOfExpression.call(this)||this.match("<")},t}(c.Parser);t.JSXParser=f},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};t.Character={fromCodePoint:function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10))+String.fromCharCode(56320+(e-65536&1023))},isWhiteSpace:function(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0},isLineTerminator:function(e){return 10===e||13===e||8232===e||8233===e},isIdentifierStart:function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&n.NonAsciiIdentifierStart.test(t.Character.fromCodePoint(e))},isIdentifierPart:function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&n.NonAsciiIdentifierPart.test(t.Character.fromCodePoint(e))},isDecimalDigit:function(e){return e>=48&&e<=57},isHexDigit:function(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102},isOctalDigit:function(e){return e>=48&&e<=55}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=function(e){this.type=r.JSXSyntax.JSXClosingElement,this.name=e};t.JSXClosingElement=i;var o=function(e,t,n){this.type=r.JSXSyntax.JSXElement,this.openingElement=e,this.children=t,this.closingElement=n};t.JSXElement=o;var a=function(){this.type=r.JSXSyntax.JSXEmptyExpression};t.JSXEmptyExpression=a;var s=function(e){this.type=r.JSXSyntax.JSXExpressionContainer,this.expression=e};t.JSXExpressionContainer=s;var l=function(e){this.type=r.JSXSyntax.JSXIdentifier,this.name=e};t.JSXIdentifier=l;var c=function(e,t){this.type=r.JSXSyntax.JSXMemberExpression,this.object=e,this.property=t};t.JSXMemberExpression=c;var u=function(e,t){this.type=r.JSXSyntax.JSXAttribute,this.name=e,this.value=t};t.JSXAttribute=u;var d=function(e,t){this.type=r.JSXSyntax.JSXNamespacedName,this.namespace=e,this.name=t};t.JSXNamespacedName=d;var p=function(e,t,n){this.type=r.JSXSyntax.JSXOpeningElement,this.name=e,this.selfClosing=t,this.attributes=n};t.JSXOpeningElement=p;var f=function(e){this.type=r.JSXSyntax.JSXSpreadAttribute,this.argument=e};t.JSXSpreadAttribute=f;var h=function(e,t){this.type=r.JSXSyntax.JSXText,this.value=e,this.raw=t};t.JSXText=h},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSXSyntax={JSXAttribute:"JSXAttribute",JSXClosingElement:"JSXClosingElement",JSXElement:"JSXElement",JSXEmptyExpression:"JSXEmptyExpression",JSXExpressionContainer:"JSXExpressionContainer",JSXIdentifier:"JSXIdentifier",JSXMemberExpression:"JSXMemberExpression",JSXNamespacedName:"JSXNamespacedName",JSXOpeningElement:"JSXOpeningElement",JSXSpreadAttribute:"JSXSpreadAttribute",JSXText:"JSXText"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(e){this.type=r.Syntax.ArrayExpression,this.elements=e};t.ArrayExpression=i;var o=function(e){this.type=r.Syntax.ArrayPattern,this.elements=e};t.ArrayPattern=o;var a=function(e,t,n){this.type=r.Syntax.ArrowFunctionExpression,this.id=null,this.params=e,this.body=t,this.generator=!1,this.expression=n,this.async=!1};t.ArrowFunctionExpression=a;var s=function(e,t,n){this.type=r.Syntax.AssignmentExpression,this.operator=e,this.left=t,this.right=n};t.AssignmentExpression=s;var l=function(e,t){this.type=r.Syntax.AssignmentPattern,this.left=e,this.right=t};t.AssignmentPattern=l;var c=function(e,t,n){this.type=r.Syntax.ArrowFunctionExpression,this.id=null,this.params=e,this.body=t,this.generator=!1,this.expression=n,this.async=!0};t.AsyncArrowFunctionExpression=c;var u=function(e,t,n){this.type=r.Syntax.FunctionDeclaration,this.id=e,this.params=t,this.body=n,this.generator=!1,this.expression=!1,this.async=!0};t.AsyncFunctionDeclaration=u;var d=function(e,t,n){this.type=r.Syntax.FunctionExpression,this.id=e,this.params=t,this.body=n,this.generator=!1,this.expression=!1,this.async=!0};t.AsyncFunctionExpression=d;var p=function(e){this.type=r.Syntax.AwaitExpression,this.argument=e};t.AwaitExpression=p;var f=function(e,t,n){var i="||"===e||"&&"===e;this.type=i?r.Syntax.LogicalExpression:r.Syntax.BinaryExpression,this.operator=e,this.left=t,this.right=n};t.BinaryExpression=f;var h=function(e){this.type=r.Syntax.BlockStatement,this.body=e};t.BlockStatement=h;var m=function(e){this.type=r.Syntax.BreakStatement,this.label=e};t.BreakStatement=m;var g=function(e,t){this.type=r.Syntax.CallExpression,this.callee=e,this.arguments=t};t.CallExpression=g;var v=function(e,t){this.type=r.Syntax.CatchClause,this.param=e,this.body=t};t.CatchClause=v;var y=function(e){this.type=r.Syntax.ClassBody,this.body=e};t.ClassBody=y;var b=function(e,t,n){this.type=r.Syntax.ClassDeclaration,this.id=e,this.superClass=t,this.body=n};t.ClassDeclaration=b;var x=function(e,t,n){this.type=r.Syntax.ClassExpression,this.id=e,this.superClass=t,this.body=n};t.ClassExpression=x;var A=function(e,t){this.type=r.Syntax.MemberExpression,this.computed=!0,this.object=e,this.property=t};t.ComputedMemberExpression=A;var C=function(e,t,n){this.type=r.Syntax.ConditionalExpression,this.test=e,this.consequent=t,this.alternate=n};t.ConditionalExpression=C;var T=function(e){this.type=r.Syntax.ContinueStatement,this.label=e};t.ContinueStatement=T;var S=function(){this.type=r.Syntax.DebuggerStatement};t.DebuggerStatement=S;var w=function(e,t){this.type=r.Syntax.ExpressionStatement,this.expression=e,this.directive=t};t.Directive=w;var _=function(e,t){this.type=r.Syntax.DoWhileStatement,this.body=e,this.test=t};t.DoWhileStatement=_;var I=function(){this.type=r.Syntax.EmptyStatement};t.EmptyStatement=I;var E=function(e){this.type=r.Syntax.ExportAllDeclaration,this.source=e};t.ExportAllDeclaration=E;var D=function(e){this.type=r.Syntax.ExportDefaultDeclaration,this.declaration=e};t.ExportDefaultDeclaration=D;var O=function(e,t,n){this.type=r.Syntax.ExportNamedDeclaration,this.declaration=e,this.specifiers=t,this.source=n};t.ExportNamedDeclaration=O;var P=function(e,t){this.type=r.Syntax.ExportSpecifier,this.exported=t,this.local=e};t.ExportSpecifier=P;var R=function(e){this.type=r.Syntax.ExpressionStatement,this.expression=e};t.ExpressionStatement=R;var N=function(e,t,n){this.type=r.Syntax.ForInStatement,this.left=e,this.right=t,this.body=n,this.each=!1};t.ForInStatement=N;var M=function(e,t,n){this.type=r.Syntax.ForOfStatement,this.left=e,this.right=t,this.body=n};t.ForOfStatement=M;var L=function(e,t,n,i){this.type=r.Syntax.ForStatement,this.init=e,this.test=t,this.update=n,this.body=i};t.ForStatement=L;var F=function(e,t,n,i){this.type=r.Syntax.FunctionDeclaration,this.id=e,this.params=t,this.body=n,this.generator=i,this.expression=!1,this.async=!1};t.FunctionDeclaration=F;var B=function(e,t,n,i){this.type=r.Syntax.FunctionExpression,this.id=e,this.params=t,this.body=n,this.generator=i,this.expression=!1,this.async=!1};t.FunctionExpression=B;var V=function(e){this.type=r.Syntax.Identifier,this.name=e};t.Identifier=V;var k=function(e,t,n){this.type=r.Syntax.IfStatement,this.test=e,this.consequent=t,this.alternate=n};t.IfStatement=k;var U=function(e,t){this.type=r.Syntax.ImportDeclaration,this.specifiers=e,this.source=t};t.ImportDeclaration=U;var G=function(e){this.type=r.Syntax.ImportDefaultSpecifier,this.local=e};t.ImportDefaultSpecifier=G;var z=function(e){this.type=r.Syntax.ImportNamespaceSpecifier,this.local=e};t.ImportNamespaceSpecifier=z;var W=function(e,t){this.type=r.Syntax.ImportSpecifier,this.local=e,this.imported=t};t.ImportSpecifier=W;var j=function(e,t){this.type=r.Syntax.LabeledStatement,this.label=e,this.body=t};t.LabeledStatement=j;var H=function(e,t){this.type=r.Syntax.Literal,this.value=e,this.raw=t};t.Literal=H;var K=function(e,t){this.type=r.Syntax.MetaProperty,this.meta=e,this.property=t};t.MetaProperty=K;var q=function(e,t,n,i,o){this.type=r.Syntax.MethodDefinition,this.key=e,this.computed=t,this.value=n,this.kind=i,this.static=o};t.MethodDefinition=q;var $=function(e){this.type=r.Syntax.Program,this.body=e,this.sourceType="module"};t.Module=$;var X=function(e,t){this.type=r.Syntax.NewExpression,this.callee=e,this.arguments=t};t.NewExpression=X;var Y=function(e){this.type=r.Syntax.ObjectExpression,this.properties=e};t.ObjectExpression=Y;var J=function(e){this.type=r.Syntax.ObjectPattern,this.properties=e};t.ObjectPattern=J;var Z=function(e,t,n,i,o,a){this.type=r.Syntax.Property,this.key=t,this.computed=n,this.value=i,this.kind=e,this.method=o,this.shorthand=a};t.Property=Z;var Q=function(e,t,n,i){this.type=r.Syntax.Literal,this.value=e,this.raw=t,this.regex={pattern:n,flags:i}};t.RegexLiteral=Q;var ee=function(e){this.type=r.Syntax.RestElement,this.argument=e};t.RestElement=ee;var te=function(e){this.type=r.Syntax.ReturnStatement,this.argument=e};t.ReturnStatement=te;var ne=function(e){this.type=r.Syntax.Program,this.body=e,this.sourceType="script"};t.Script=ne;var re=function(e){this.type=r.Syntax.SequenceExpression,this.expressions=e};t.SequenceExpression=re;var ie=function(e){this.type=r.Syntax.SpreadElement,this.argument=e};t.SpreadElement=ie;var oe=function(e,t){this.type=r.Syntax.MemberExpression,this.computed=!1,this.object=e,this.property=t};t.StaticMemberExpression=oe;var ae=function(){this.type=r.Syntax.Super};t.Super=ae;var se=function(e,t){this.type=r.Syntax.SwitchCase,this.test=e,this.consequent=t};t.SwitchCase=se;var le=function(e,t){this.type=r.Syntax.SwitchStatement,this.discriminant=e,this.cases=t};t.SwitchStatement=le;var ce=function(e,t){this.type=r.Syntax.TaggedTemplateExpression,this.tag=e,this.quasi=t};t.TaggedTemplateExpression=ce;var ue=function(e,t){this.type=r.Syntax.TemplateElement,this.value=e,this.tail=t};t.TemplateElement=ue;var de=function(e,t){this.type=r.Syntax.TemplateLiteral,this.quasis=e,this.expressions=t};t.TemplateLiteral=de;var pe=function(){this.type=r.Syntax.ThisExpression};t.ThisExpression=pe;var fe=function(e){this.type=r.Syntax.ThrowStatement,this.argument=e};t.ThrowStatement=fe;var he=function(e,t,n){this.type=r.Syntax.TryStatement,this.block=e,this.handler=t,this.finalizer=n};t.TryStatement=he;var me=function(e,t){this.type=r.Syntax.UnaryExpression,this.operator=e,this.argument=t,this.prefix=!0};t.UnaryExpression=me;var ge=function(e,t,n){this.type=r.Syntax.UpdateExpression,this.operator=e,this.argument=t,this.prefix=n};t.UpdateExpression=ge;var ve=function(e,t){this.type=r.Syntax.VariableDeclaration,this.declarations=e,this.kind=t};t.VariableDeclaration=ve;var ye=function(e,t){this.type=r.Syntax.VariableDeclarator,this.id=e,this.init=t};t.VariableDeclarator=ye;var be=function(e,t){this.type=r.Syntax.WhileStatement,this.test=e,this.body=t};t.WhileStatement=be;var xe=function(e,t){this.type=r.Syntax.WithStatement,this.object=e,this.body=t};t.WithStatement=xe;var Ae=function(e,t){this.type=r.Syntax.YieldExpression,this.argument=e,this.delegate=t};t.YieldExpression=Ae},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=n(10),o=n(11),a=n(7),s=n(12),l=n(2),c=n(13),u=function(){function e(e,t,n){void 0===t&&(t={}),this.config={range:"boolean"==typeof t.range&&t.range,loc:"boolean"==typeof t.loc&&t.loc,source:null,tokens:"boolean"==typeof t.tokens&&t.tokens,comment:"boolean"==typeof t.comment&&t.comment,tolerant:"boolean"==typeof t.tolerant&&t.tolerant},this.config.loc&&t.source&&null!==t.source&&(this.config.source=String(t.source)),this.delegate=n,this.errorHandler=new i.ErrorHandler,this.errorHandler.tolerant=this.config.tolerant,this.scanner=new s.Scanner(e,this.errorHandler),this.scanner.trackComment=this.config.comment,this.operatorPrecedence={")":0,";":0,",":0,"=":0,"]":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.lookahead={type:2,value:"",lineNumber:this.scanner.lineNumber,lineStart:0,start:0,end:0},this.hasLineTerminator=!1,this.context={isModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,firstCoverInitializedNameError:null,isAssignmentTarget:!1,isBindingElement:!1,inFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},strict:!1},this.tokens=[],this.startMarker={index:0,line:this.scanner.lineNumber,column:0},this.lastMarker={index:0,line:this.scanner.lineNumber,column:0},this.nextToken(),this.lastMarker={index:this.scanner.index,line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}return e.prototype.throwError=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=Array.prototype.slice.call(arguments,1),o=e.replace(/%(\d)/g,(function(e,t){return r.assert(t<i.length,"Message reference must be in range"),i[t]})),a=this.lastMarker.index,s=this.lastMarker.line,l=this.lastMarker.column+1;throw this.errorHandler.createError(a,s,l,o)},e.prototype.tolerateError=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=Array.prototype.slice.call(arguments,1),o=e.replace(/%(\d)/g,(function(e,t){return r.assert(t<i.length,"Message reference must be in range"),i[t]})),a=this.lastMarker.index,s=this.scanner.lineNumber,l=this.lastMarker.column+1;this.errorHandler.tolerateError(a,s,l,o)},e.prototype.unexpectedTokenError=function(e,t){var n,r=t||o.Messages.UnexpectedToken;if(e?(t||(r=2===e.type?o.Messages.UnexpectedEOS:3===e.type?o.Messages.UnexpectedIdentifier:6===e.type?o.Messages.UnexpectedNumber:8===e.type?o.Messages.UnexpectedString:10===e.type?o.Messages.UnexpectedTemplate:o.Messages.UnexpectedToken,4===e.type&&(this.scanner.isFutureReservedWord(e.value)?r=o.Messages.UnexpectedReserved:this.context.strict&&this.scanner.isStrictModeReservedWord(e.value)&&(r=o.Messages.StrictReservedWord))),n=e.value):n="ILLEGAL",r=r.replace("%0",n),e&&"number"==typeof e.lineNumber){var i=e.start,a=e.lineNumber,s=this.lastMarker.index-this.lastMarker.column,l=e.start-s+1;return this.errorHandler.createError(i,a,l,r)}return i=this.lastMarker.index,a=this.lastMarker.line,l=this.lastMarker.column+1,this.errorHandler.createError(i,a,l,r)},e.prototype.throwUnexpectedToken=function(e,t){throw this.unexpectedTokenError(e,t)},e.prototype.tolerateUnexpectedToken=function(e,t){this.errorHandler.tolerate(this.unexpectedTokenError(e,t))},e.prototype.collectComments=function(){if(this.config.comment){var e=this.scanner.scanComments();if(e.length>0&&this.delegate)for(var t=0;t<e.length;++t){var n=e[t],r=void 0;r={type:n.multiLine?"BlockComment":"LineComment",value:this.scanner.source.slice(n.slice[0],n.slice[1])},this.config.range&&(r.range=n.range),this.config.loc&&(r.loc=n.loc);var i={start:{line:n.loc.start.line,column:n.loc.start.column,offset:n.range[0]},end:{line:n.loc.end.line,column:n.loc.end.column,offset:n.range[1]}};this.delegate(r,i)}}else this.scanner.scanComments()},e.prototype.getTokenRaw=function(e){return this.scanner.source.slice(e.start,e.end)},e.prototype.convertToken=function(e){var t={type:c.TokenName[e.type],value:this.getTokenRaw(e)};if(this.config.range&&(t.range=[e.start,e.end]),this.config.loc&&(t.loc={start:{line:this.startMarker.line,column:this.startMarker.column},end:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart}}),9===e.type){var n=e.pattern,r=e.flags;t.regex={pattern:n,flags:r}}return t},e.prototype.nextToken=function(){var e=this.lookahead;this.lastMarker.index=this.scanner.index,this.lastMarker.line=this.scanner.lineNumber,this.lastMarker.column=this.scanner.index-this.scanner.lineStart,this.collectComments(),this.scanner.index!==this.startMarker.index&&(this.startMarker.index=this.scanner.index,this.startMarker.line=this.scanner.lineNumber,this.startMarker.column=this.scanner.index-this.scanner.lineStart);var t=this.scanner.lex();return this.hasLineTerminator=e.lineNumber!==t.lineNumber,t&&this.context.strict&&3===t.type&&this.scanner.isStrictModeReservedWord(t.value)&&(t.type=4),this.lookahead=t,this.config.tokens&&2!==t.type&&this.tokens.push(this.convertToken(t)),e},e.prototype.nextRegexToken=function(){this.collectComments();var e=this.scanner.scanRegExp();return this.config.tokens&&(this.tokens.pop(),this.tokens.push(this.convertToken(e))),this.lookahead=e,this.nextToken(),e},e.prototype.createNode=function(){return{index:this.startMarker.index,line:this.startMarker.line,column:this.startMarker.column}},e.prototype.startNode=function(e,t){void 0===t&&(t=0);var n=e.start-e.lineStart,r=e.lineNumber;return n<0&&(n+=t,r--),{index:e.start,line:r,column:n}},e.prototype.finalize=function(e,t){if(this.config.range&&(t.range=[e.index,this.lastMarker.index]),this.config.loc&&(t.loc={start:{line:e.line,column:e.column},end:{line:this.lastMarker.line,column:this.lastMarker.column}},this.config.source&&(t.loc.source=this.config.source)),this.delegate){var n={start:{line:e.line,column:e.column,offset:e.index},end:{line:this.lastMarker.line,column:this.lastMarker.column,offset:this.lastMarker.index}};this.delegate(t,n)}return t},e.prototype.expect=function(e){var t=this.nextToken();7===t.type&&t.value===e||this.throwUnexpectedToken(t)},e.prototype.expectCommaSeparator=function(){if(this.config.tolerant){var e=this.lookahead;7===e.type&&","===e.value?this.nextToken():7===e.type&&";"===e.value?(this.nextToken(),this.tolerateUnexpectedToken(e)):this.tolerateUnexpectedToken(e,o.Messages.UnexpectedToken)}else this.expect(",")},e.prototype.expectKeyword=function(e){var t=this.nextToken();4===t.type&&t.value===e||this.throwUnexpectedToken(t)},e.prototype.match=function(e){return 7===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchKeyword=function(e){return 4===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchContextualKeyword=function(e){return 3===this.lookahead.type&&this.lookahead.value===e},e.prototype.matchAssign=function(){if(7!==this.lookahead.type)return!1;var e=this.lookahead.value;return"="===e||"*="===e||"**="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e},e.prototype.isolateCoverGrammar=function(e){var t=this.context.isBindingElement,n=this.context.isAssignmentTarget,r=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var i=e.call(this);return null!==this.context.firstCoverInitializedNameError&&this.throwUnexpectedToken(this.context.firstCoverInitializedNameError),this.context.isBindingElement=t,this.context.isAssignmentTarget=n,this.context.firstCoverInitializedNameError=r,i},e.prototype.inheritCoverGrammar=function(e){var t=this.context.isBindingElement,n=this.context.isAssignmentTarget,r=this.context.firstCoverInitializedNameError;this.context.isBindingElement=!0,this.context.isAssignmentTarget=!0,this.context.firstCoverInitializedNameError=null;var i=e.call(this);return this.context.isBindingElement=this.context.isBindingElement&&t,this.context.isAssignmentTarget=this.context.isAssignmentTarget&&n,this.context.firstCoverInitializedNameError=r||this.context.firstCoverInitializedNameError,i},e.prototype.consumeSemicolon=function(){this.match(";")?this.nextToken():this.hasLineTerminator||(2===this.lookahead.type||this.match("}")||this.throwUnexpectedToken(this.lookahead),this.lastMarker.index=this.startMarker.index,this.lastMarker.line=this.startMarker.line,this.lastMarker.column=this.startMarker.column)},e.prototype.parsePrimaryExpression=function(){var e,t,n,r=this.createNode();switch(this.lookahead.type){case 3:(this.context.isModule||this.context.await)&&"await"===this.lookahead.value&&this.tolerateUnexpectedToken(this.lookahead),e=this.matchAsyncFunction()?this.parseFunctionExpression():this.finalize(r,new a.Identifier(this.nextToken().value));break;case 6:case 8:this.context.strict&&this.lookahead.octal&&this.tolerateUnexpectedToken(this.lookahead,o.Messages.StrictOctalLiteral),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),n=this.getTokenRaw(t),e=this.finalize(r,new a.Literal(t.value,n));break;case 1:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),n=this.getTokenRaw(t),e=this.finalize(r,new a.Literal("true"===t.value,n));break;case 5:this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,t=this.nextToken(),n=this.getTokenRaw(t),e=this.finalize(r,new a.Literal(null,n));break;case 10:e=this.parseTemplateLiteral();break;case 7:switch(this.lookahead.value){case"(":this.context.isBindingElement=!1,e=this.inheritCoverGrammar(this.parseGroupExpression);break;case"[":e=this.inheritCoverGrammar(this.parseArrayInitializer);break;case"{":e=this.inheritCoverGrammar(this.parseObjectInitializer);break;case"/":case"/=":this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.scanner.index=this.startMarker.index,t=this.nextRegexToken(),n=this.getTokenRaw(t),e=this.finalize(r,new a.RegexLiteral(t.regex,n,t.pattern,t.flags));break;default:e=this.throwUnexpectedToken(this.nextToken())}break;case 4:!this.context.strict&&this.context.allowYield&&this.matchKeyword("yield")?e=this.parseIdentifierName():!this.context.strict&&this.matchKeyword("let")?e=this.finalize(r,new a.Identifier(this.nextToken().value)):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.matchKeyword("function")?e=this.parseFunctionExpression():this.matchKeyword("this")?(this.nextToken(),e=this.finalize(r,new a.ThisExpression)):e=this.matchKeyword("class")?this.parseClassExpression():this.throwUnexpectedToken(this.nextToken()));break;default:e=this.throwUnexpectedToken(this.nextToken())}return e},e.prototype.parseSpreadElement=function(){var e=this.createNode();this.expect("...");var t=this.inheritCoverGrammar(this.parseAssignmentExpression);return this.finalize(e,new a.SpreadElement(t))},e.prototype.parseArrayInitializer=function(){var e=this.createNode(),t=[];for(this.expect("[");!this.match("]");)if(this.match(","))this.nextToken(),t.push(null);else if(this.match("...")){var n=this.parseSpreadElement();this.match("]")||(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1,this.expect(",")),t.push(n)}else t.push(this.inheritCoverGrammar(this.parseAssignmentExpression)),this.match("]")||this.expect(",");return this.expect("]"),this.finalize(e,new a.ArrayExpression(t))},e.prototype.parsePropertyMethod=function(e){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var t=this.context.strict,n=this.context.allowStrictDirective;this.context.allowStrictDirective=e.simple;var r=this.isolateCoverGrammar(this.parseFunctionSourceElements);return this.context.strict&&e.firstRestricted&&this.tolerateUnexpectedToken(e.firstRestricted,e.message),this.context.strict&&e.stricted&&this.tolerateUnexpectedToken(e.stricted,e.message),this.context.strict=t,this.context.allowStrictDirective=n,r},e.prototype.parsePropertyMethodFunction=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var n=this.parseFormalParameters(),r=this.parsePropertyMethod(n);return this.context.allowYield=t,this.finalize(e,new a.FunctionExpression(null,n.params,r,!1))},e.prototype.parsePropertyMethodAsyncFunction=function(){var e=this.createNode(),t=this.context.allowYield,n=this.context.await;this.context.allowYield=!1,this.context.await=!0;var r=this.parseFormalParameters(),i=this.parsePropertyMethod(r);return this.context.allowYield=t,this.context.await=n,this.finalize(e,new a.AsyncFunctionExpression(null,r.params,i))},e.prototype.parseObjectPropertyKey=function(){var e,t=this.createNode(),n=this.nextToken();switch(n.type){case 8:case 6:this.context.strict&&n.octal&&this.tolerateUnexpectedToken(n,o.Messages.StrictOctalLiteral);var r=this.getTokenRaw(n);e=this.finalize(t,new a.Literal(n.value,r));break;case 3:case 1:case 5:case 4:e=this.finalize(t,new a.Identifier(n.value));break;case 7:"["===n.value?(e=this.isolateCoverGrammar(this.parseAssignmentExpression),this.expect("]")):e=this.throwUnexpectedToken(n);break;default:e=this.throwUnexpectedToken(n)}return e},e.prototype.isPropertyKey=function(e,t){return e.type===l.Syntax.Identifier&&e.name===t||e.type===l.Syntax.Literal&&e.value===t},e.prototype.parseObjectProperty=function(e){var t,n=this.createNode(),r=this.lookahead,i=null,s=null,l=!1,c=!1,u=!1,d=!1;if(3===r.type){var p=r.value;this.nextToken(),l=this.match("["),i=(d=!(this.hasLineTerminator||"async"!==p||this.match(":")||this.match("(")||this.match("*")||this.match(",")))?this.parseObjectPropertyKey():this.finalize(n,new a.Identifier(p))}else this.match("*")?this.nextToken():(l=this.match("["),i=this.parseObjectPropertyKey());var f=this.qualifiedPropertyName(this.lookahead);if(3===r.type&&!d&&"get"===r.value&&f)t="get",l=this.match("["),i=this.parseObjectPropertyKey(),this.context.allowYield=!1,s=this.parseGetterMethod();else if(3===r.type&&!d&&"set"===r.value&&f)t="set",l=this.match("["),i=this.parseObjectPropertyKey(),s=this.parseSetterMethod();else if(7===r.type&&"*"===r.value&&f)t="init",l=this.match("["),i=this.parseObjectPropertyKey(),s=this.parseGeneratorMethod(),c=!0;else if(i||this.throwUnexpectedToken(this.lookahead),t="init",this.match(":")&&!d)!l&&this.isPropertyKey(i,"__proto__")&&(e.value&&this.tolerateError(o.Messages.DuplicateProtoProperty),e.value=!0),this.nextToken(),s=this.inheritCoverGrammar(this.parseAssignmentExpression);else if(this.match("("))s=d?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),c=!0;else if(3===r.type)if(p=this.finalize(n,new a.Identifier(r.value)),this.match("=")){this.context.firstCoverInitializedNameError=this.lookahead,this.nextToken(),u=!0;var h=this.isolateCoverGrammar(this.parseAssignmentExpression);s=this.finalize(n,new a.AssignmentPattern(p,h))}else u=!0,s=p;else this.throwUnexpectedToken(this.nextToken());return this.finalize(n,new a.Property(t,i,l,s,c,u))},e.prototype.parseObjectInitializer=function(){var e=this.createNode();this.expect("{");for(var t=[],n={value:!1};!this.match("}");)t.push(this.parseObjectProperty(n)),this.match("}")||this.expectCommaSeparator();return this.expect("}"),this.finalize(e,new a.ObjectExpression(t))},e.prototype.parseTemplateHead=function(){r.assert(this.lookahead.head,"Template literal must start with a template head");var e=this.createNode(),t=this.nextToken(),n=t.value,i=t.cooked;return this.finalize(e,new a.TemplateElement({raw:n,cooked:i},t.tail))},e.prototype.parseTemplateElement=function(){10!==this.lookahead.type&&this.throwUnexpectedToken();var e=this.createNode(),t=this.nextToken(),n=t.value,r=t.cooked;return this.finalize(e,new a.TemplateElement({raw:n,cooked:r},t.tail))},e.prototype.parseTemplateLiteral=function(){var e=this.createNode(),t=[],n=[],r=this.parseTemplateHead();for(n.push(r);!r.tail;)t.push(this.parseExpression()),r=this.parseTemplateElement(),n.push(r);return this.finalize(e,new a.TemplateLiteral(n,t))},e.prototype.reinterpretExpressionAsPattern=function(e){switch(e.type){case l.Syntax.Identifier:case l.Syntax.MemberExpression:case l.Syntax.RestElement:case l.Syntax.AssignmentPattern:break;case l.Syntax.SpreadElement:e.type=l.Syntax.RestElement,this.reinterpretExpressionAsPattern(e.argument);break;case l.Syntax.ArrayExpression:e.type=l.Syntax.ArrayPattern;for(var t=0;t<e.elements.length;t++)null!==e.elements[t]&&this.reinterpretExpressionAsPattern(e.elements[t]);break;case l.Syntax.ObjectExpression:for(e.type=l.Syntax.ObjectPattern,t=0;t<e.properties.length;t++)this.reinterpretExpressionAsPattern(e.properties[t].value);break;case l.Syntax.AssignmentExpression:e.type=l.Syntax.AssignmentPattern,delete e.operator,this.reinterpretExpressionAsPattern(e.left)}},e.prototype.parseGroupExpression=function(){var e;if(this.expect("("),this.match(")"))this.nextToken(),this.match("=>")||this.expect("=>"),e={type:"ArrowParameterPlaceHolder",params:[],async:!1};else{var t=this.lookahead,n=[];if(this.match("..."))e=this.parseRestElement(n),this.expect(")"),this.match("=>")||this.expect("=>"),e={type:"ArrowParameterPlaceHolder",params:[e],async:!1};else{var r=!1;if(this.context.isBindingElement=!0,e=this.inheritCoverGrammar(this.parseAssignmentExpression),this.match(",")){var i=[];for(this.context.isAssignmentTarget=!1,i.push(e);2!==this.lookahead.type&&this.match(",");){if(this.nextToken(),this.match(")")){this.nextToken();for(var o=0;o<i.length;o++)this.reinterpretExpressionAsPattern(i[o]);r=!0,e={type:"ArrowParameterPlaceHolder",params:i,async:!1}}else if(this.match("...")){for(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),i.push(this.parseRestElement(n)),this.expect(")"),this.match("=>")||this.expect("=>"),this.context.isBindingElement=!1,o=0;o<i.length;o++)this.reinterpretExpressionAsPattern(i[o]);r=!0,e={type:"ArrowParameterPlaceHolder",params:i,async:!1}}else i.push(this.inheritCoverGrammar(this.parseAssignmentExpression));if(r)break}r||(e=this.finalize(this.startNode(t),new a.SequenceExpression(i)))}if(!r){if(this.expect(")"),this.match("=>")&&(e.type===l.Syntax.Identifier&&"yield"===e.name&&(r=!0,e={type:"ArrowParameterPlaceHolder",params:[e],async:!1}),!r)){if(this.context.isBindingElement||this.throwUnexpectedToken(this.lookahead),e.type===l.Syntax.SequenceExpression)for(o=0;o<e.expressions.length;o++)this.reinterpretExpressionAsPattern(e.expressions[o]);else this.reinterpretExpressionAsPattern(e);e={type:"ArrowParameterPlaceHolder",params:e.type===l.Syntax.SequenceExpression?e.expressions:[e],async:!1}}this.context.isBindingElement=!1}}}return e},e.prototype.parseArguments=function(){this.expect("(");var e=[];if(!this.match(")"))for(;;){var t=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAssignmentExpression);if(e.push(t),this.match(")"))break;if(this.expectCommaSeparator(),this.match(")"))break}return this.expect(")"),e},e.prototype.isIdentifierName=function(e){return 3===e.type||4===e.type||1===e.type||5===e.type},e.prototype.parseIdentifierName=function(){var e=this.createNode(),t=this.nextToken();return this.isIdentifierName(t)||this.throwUnexpectedToken(t),this.finalize(e,new a.Identifier(t.value))},e.prototype.parseNewExpression=function(){var e,t=this.createNode(),n=this.parseIdentifierName();if(r.assert("new"===n.name,"New expression must start with `new`"),this.match("."))if(this.nextToken(),3===this.lookahead.type&&this.context.inFunctionBody&&"target"===this.lookahead.value){var i=this.parseIdentifierName();e=new a.MetaProperty(n,i)}else this.throwUnexpectedToken(this.lookahead);else{var o=this.isolateCoverGrammar(this.parseLeftHandSideExpression),s=this.match("(")?this.parseArguments():[];e=new a.NewExpression(o,s),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return this.finalize(t,e)},e.prototype.parseAsyncArgument=function(){var e=this.parseAssignmentExpression();return this.context.firstCoverInitializedNameError=null,e},e.prototype.parseAsyncArguments=function(){this.expect("(");var e=[];if(!this.match(")"))for(;;){var t=this.match("...")?this.parseSpreadElement():this.isolateCoverGrammar(this.parseAsyncArgument);if(e.push(t),this.match(")"))break;if(this.expectCommaSeparator(),this.match(")"))break}return this.expect(")"),e},e.prototype.parseLeftHandSideExpressionAllowCall=function(){var e,t=this.lookahead,n=this.matchContextualKeyword("async"),r=this.context.allowIn;for(this.context.allowIn=!0,this.matchKeyword("super")&&this.context.inFunctionBody?(e=this.createNode(),this.nextToken(),e=this.finalize(e,new a.Super),this.match("(")||this.match(".")||this.match("[")||this.throwUnexpectedToken(this.lookahead)):e=this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match(".")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect(".");var i=this.parseIdentifierName();e=this.finalize(this.startNode(t),new a.StaticMemberExpression(e,i))}else if(this.match("(")){var o=n&&t.lineNumber===this.lookahead.lineNumber;this.context.isBindingElement=!1,this.context.isAssignmentTarget=!1;var s=o?this.parseAsyncArguments():this.parseArguments();if(e=this.finalize(this.startNode(t),new a.CallExpression(e,s)),o&&this.match("=>")){for(var l=0;l<s.length;++l)this.reinterpretExpressionAsPattern(s[l]);e={type:"ArrowParameterPlaceHolder",params:s,async:!0}}}else if(this.match("["))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("["),i=this.isolateCoverGrammar(this.parseExpression),this.expect("]"),e=this.finalize(this.startNode(t),new a.ComputedMemberExpression(e,i));else{if(10!==this.lookahead.type||!this.lookahead.head)break;var c=this.parseTemplateLiteral();e=this.finalize(this.startNode(t),new a.TaggedTemplateExpression(e,c))}return this.context.allowIn=r,e},e.prototype.parseSuper=function(){var e=this.createNode();return this.expectKeyword("super"),this.match("[")||this.match(".")||this.throwUnexpectedToken(this.lookahead),this.finalize(e,new a.Super)},e.prototype.parseLeftHandSideExpression=function(){r.assert(this.context.allowIn,"callee of new expression always allow in keyword.");for(var e=this.startNode(this.lookahead),t=this.matchKeyword("super")&&this.context.inFunctionBody?this.parseSuper():this.inheritCoverGrammar(this.matchKeyword("new")?this.parseNewExpression:this.parsePrimaryExpression);;)if(this.match("[")){this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("[");var n=this.isolateCoverGrammar(this.parseExpression);this.expect("]"),t=this.finalize(e,new a.ComputedMemberExpression(t,n))}else if(this.match("."))this.context.isBindingElement=!1,this.context.isAssignmentTarget=!0,this.expect("."),n=this.parseIdentifierName(),t=this.finalize(e,new a.StaticMemberExpression(t,n));else{if(10!==this.lookahead.type||!this.lookahead.head)break;var i=this.parseTemplateLiteral();t=this.finalize(e,new a.TaggedTemplateExpression(t,i))}return t},e.prototype.parseUpdateExpression=function(){var e,t=this.lookahead;if(this.match("++")||this.match("--")){var n=this.startNode(t),r=this.nextToken();e=this.inheritCoverGrammar(this.parseUnaryExpression),this.context.strict&&e.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(e.name)&&this.tolerateError(o.Messages.StrictLHSPrefix),this.context.isAssignmentTarget||this.tolerateError(o.Messages.InvalidLHSInAssignment);var i=!0;e=this.finalize(n,new a.UpdateExpression(r.value,e,i)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else if(e=this.inheritCoverGrammar(this.parseLeftHandSideExpressionAllowCall),!this.hasLineTerminator&&7===this.lookahead.type&&(this.match("++")||this.match("--"))){this.context.strict&&e.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(e.name)&&this.tolerateError(o.Messages.StrictLHSPostfix),this.context.isAssignmentTarget||this.tolerateError(o.Messages.InvalidLHSInAssignment),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var s=this.nextToken().value;i=!1,e=this.finalize(this.startNode(t),new a.UpdateExpression(s,e,i))}return e},e.prototype.parseAwaitExpression=function(){var e=this.createNode();this.nextToken();var t=this.parseUnaryExpression();return this.finalize(e,new a.AwaitExpression(t))},e.prototype.parseUnaryExpression=function(){var e;if(this.match("+")||this.match("-")||this.match("~")||this.match("!")||this.matchKeyword("delete")||this.matchKeyword("void")||this.matchKeyword("typeof")){var t=this.startNode(this.lookahead),n=this.nextToken();e=this.inheritCoverGrammar(this.parseUnaryExpression),e=this.finalize(t,new a.UnaryExpression(n.value,e)),this.context.strict&&"delete"===e.operator&&e.argument.type===l.Syntax.Identifier&&this.tolerateError(o.Messages.StrictDelete),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}else e=this.context.await&&this.matchContextualKeyword("await")?this.parseAwaitExpression():this.parseUpdateExpression();return e},e.prototype.parseExponentiationExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseUnaryExpression);if(t.type!==l.Syntax.UnaryExpression&&this.match("**")){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var n=t,r=this.isolateCoverGrammar(this.parseExponentiationExpression);t=this.finalize(this.startNode(e),new a.BinaryExpression("**",n,r))}return t},e.prototype.binaryPrecedence=function(e){var t=e.value;return 7===e.type?this.operatorPrecedence[t]||0:4===e.type&&("instanceof"===t||this.context.allowIn&&"in"===t)?7:0},e.prototype.parseBinaryExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseExponentiationExpression),n=this.lookahead,r=this.binaryPrecedence(n);if(r>0){this.nextToken(),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;for(var i=[e,this.lookahead],o=t,s=this.isolateCoverGrammar(this.parseExponentiationExpression),l=[o,n.value,s],c=[r];!((r=this.binaryPrecedence(this.lookahead))<=0);){for(;l.length>2&&r<=c[c.length-1];){s=l.pop();var u=l.pop();c.pop(),o=l.pop(),i.pop();var d=this.startNode(i[i.length-1]);l.push(this.finalize(d,new a.BinaryExpression(u,o,s)))}l.push(this.nextToken().value),c.push(r),i.push(this.lookahead),l.push(this.isolateCoverGrammar(this.parseExponentiationExpression))}var p=l.length-1;t=l[p];for(var f=i.pop();p>1;){var h=i.pop(),m=f&&f.lineStart;d=this.startNode(h,m),u=l[p-1],t=this.finalize(d,new a.BinaryExpression(u,l[p-2],t)),p-=2,f=h}}return t},e.prototype.parseConditionalExpression=function(){var e=this.lookahead,t=this.inheritCoverGrammar(this.parseBinaryExpression);if(this.match("?")){this.nextToken();var n=this.context.allowIn;this.context.allowIn=!0;var r=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowIn=n,this.expect(":");var i=this.isolateCoverGrammar(this.parseAssignmentExpression);t=this.finalize(this.startNode(e),new a.ConditionalExpression(t,r,i)),this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1}return t},e.prototype.checkPatternParam=function(e,t){switch(t.type){case l.Syntax.Identifier:this.validateParam(e,t,t.name);break;case l.Syntax.RestElement:this.checkPatternParam(e,t.argument);break;case l.Syntax.AssignmentPattern:this.checkPatternParam(e,t.left);break;case l.Syntax.ArrayPattern:for(var n=0;n<t.elements.length;n++)null!==t.elements[n]&&this.checkPatternParam(e,t.elements[n]);break;case l.Syntax.ObjectPattern:for(n=0;n<t.properties.length;n++)this.checkPatternParam(e,t.properties[n].value)}e.simple=e.simple&&t instanceof a.Identifier},e.prototype.reinterpretAsCoverFormalsList=function(e){var t,n=[e],r=!1;switch(e.type){case l.Syntax.Identifier:break;case"ArrowParameterPlaceHolder":n=e.params,r=e.async;break;default:return null}t={simple:!0,paramSet:{}};for(var i=0;i<n.length;++i)(a=n[i]).type===l.Syntax.AssignmentPattern?a.right.type===l.Syntax.YieldExpression&&(a.right.argument&&this.throwUnexpectedToken(this.lookahead),a.right.type=l.Syntax.Identifier,a.right.name="yield",delete a.right.argument,delete a.right.delegate):r&&a.type===l.Syntax.Identifier&&"await"===a.name&&this.throwUnexpectedToken(this.lookahead),this.checkPatternParam(t,a),n[i]=a;if(this.context.strict||!this.context.allowYield)for(i=0;i<n.length;++i){var a;(a=n[i]).type===l.Syntax.YieldExpression&&this.throwUnexpectedToken(this.lookahead)}if(t.message===o.Messages.StrictParamDupe){var s=this.context.strict?t.stricted:t.firstRestricted;this.throwUnexpectedToken(s,t.message)}return{simple:t.simple,params:n,stricted:t.stricted,firstRestricted:t.firstRestricted,message:t.message}},e.prototype.parseAssignmentExpression=function(){var e;if(!this.context.allowYield&&this.matchKeyword("yield"))e=this.parseYieldExpression();else{var t=this.lookahead,n=t;if(e=this.parseConditionalExpression(),3===n.type&&n.lineNumber===this.lookahead.lineNumber&&"async"===n.value&&(3===this.lookahead.type||this.matchKeyword("yield"))){var r=this.parsePrimaryExpression();this.reinterpretExpressionAsPattern(r),e={type:"ArrowParameterPlaceHolder",params:[r],async:!0}}if("ArrowParameterPlaceHolder"===e.type||this.match("=>")){this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1;var i=e.async,s=this.reinterpretAsCoverFormalsList(e);if(s){this.hasLineTerminator&&this.tolerateUnexpectedToken(this.lookahead),this.context.firstCoverInitializedNameError=null;var c=this.context.strict,u=this.context.allowStrictDirective;this.context.allowStrictDirective=s.simple;var d=this.context.allowYield,p=this.context.await;this.context.allowYield=!0,this.context.await=i;var f=this.startNode(t);this.expect("=>");var h=void 0;if(this.match("{")){var m=this.context.allowIn;this.context.allowIn=!0,h=this.parseFunctionSourceElements(),this.context.allowIn=m}else h=this.isolateCoverGrammar(this.parseAssignmentExpression);var g=h.type!==l.Syntax.BlockStatement;this.context.strict&&s.firstRestricted&&this.throwUnexpectedToken(s.firstRestricted,s.message),this.context.strict&&s.stricted&&this.tolerateUnexpectedToken(s.stricted,s.message),e=i?this.finalize(f,new a.AsyncArrowFunctionExpression(s.params,h,g)):this.finalize(f,new a.ArrowFunctionExpression(s.params,h,g)),this.context.strict=c,this.context.allowStrictDirective=u,this.context.allowYield=d,this.context.await=p}}else if(this.matchAssign()){if(this.context.isAssignmentTarget||this.tolerateError(o.Messages.InvalidLHSInAssignment),this.context.strict&&e.type===l.Syntax.Identifier){var v=e;this.scanner.isRestrictedWord(v.name)&&this.tolerateUnexpectedToken(n,o.Messages.StrictLHSAssignment),this.scanner.isStrictModeReservedWord(v.name)&&this.tolerateUnexpectedToken(n,o.Messages.StrictReservedWord)}this.match("=")?this.reinterpretExpressionAsPattern(e):(this.context.isAssignmentTarget=!1,this.context.isBindingElement=!1);var y=(n=this.nextToken()).value,b=this.isolateCoverGrammar(this.parseAssignmentExpression);e=this.finalize(this.startNode(t),new a.AssignmentExpression(y,e,b)),this.context.firstCoverInitializedNameError=null}}return e},e.prototype.parseExpression=function(){var e=this.lookahead,t=this.isolateCoverGrammar(this.parseAssignmentExpression);if(this.match(",")){var n=[];for(n.push(t);2!==this.lookahead.type&&this.match(",");)this.nextToken(),n.push(this.isolateCoverGrammar(this.parseAssignmentExpression));t=this.finalize(this.startNode(e),new a.SequenceExpression(n))}return t},e.prototype.parseStatementListItem=function(){var e;if(this.context.isAssignmentTarget=!0,this.context.isBindingElement=!0,4===this.lookahead.type)switch(this.lookahead.value){case"export":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,o.Messages.IllegalExportDeclaration),e=this.parseExportDeclaration();break;case"import":this.context.isModule||this.tolerateUnexpectedToken(this.lookahead,o.Messages.IllegalImportDeclaration),e=this.parseImportDeclaration();break;case"const":e=this.parseLexicalDeclaration({inFor:!1});break;case"function":e=this.parseFunctionDeclaration();break;case"class":e=this.parseClassDeclaration();break;case"let":e=this.isLexicalDeclaration()?this.parseLexicalDeclaration({inFor:!1}):this.parseStatement();break;default:e=this.parseStatement()}else e=this.parseStatement();return e},e.prototype.parseBlock=function(){var e=this.createNode();this.expect("{");for(var t=[];!this.match("}");)t.push(this.parseStatementListItem());return this.expect("}"),this.finalize(e,new a.BlockStatement(t))},e.prototype.parseLexicalBinding=function(e,t){var n=this.createNode(),r=this.parsePattern([],e);this.context.strict&&r.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(r.name)&&this.tolerateError(o.Messages.StrictVarName);var i=null;return"const"===e?this.matchKeyword("in")||this.matchContextualKeyword("of")||(this.match("=")?(this.nextToken(),i=this.isolateCoverGrammar(this.parseAssignmentExpression)):this.throwError(o.Messages.DeclarationMissingInitializer,"const")):(!t.inFor&&r.type!==l.Syntax.Identifier||this.match("="))&&(this.expect("="),i=this.isolateCoverGrammar(this.parseAssignmentExpression)),this.finalize(n,new a.VariableDeclarator(r,i))},e.prototype.parseBindingList=function(e,t){for(var n=[this.parseLexicalBinding(e,t)];this.match(",");)this.nextToken(),n.push(this.parseLexicalBinding(e,t));return n},e.prototype.isLexicalDeclaration=function(){var e=this.scanner.saveState();this.scanner.scanComments();var t=this.scanner.lex();return this.scanner.restoreState(e),3===t.type||7===t.type&&"["===t.value||7===t.type&&"{"===t.value||4===t.type&&"let"===t.value||4===t.type&&"yield"===t.value},e.prototype.parseLexicalDeclaration=function(e){var t=this.createNode(),n=this.nextToken().value;r.assert("let"===n||"const"===n,"Lexical declaration must be either let or const");var i=this.parseBindingList(n,e);return this.consumeSemicolon(),this.finalize(t,new a.VariableDeclaration(i,n))},e.prototype.parseBindingRestElement=function(e,t){var n=this.createNode();this.expect("...");var r=this.parsePattern(e,t);return this.finalize(n,new a.RestElement(r))},e.prototype.parseArrayPattern=function(e,t){var n=this.createNode();this.expect("[");for(var r=[];!this.match("]");)if(this.match(","))this.nextToken(),r.push(null);else{if(this.match("...")){r.push(this.parseBindingRestElement(e,t));break}r.push(this.parsePatternWithDefault(e,t)),this.match("]")||this.expect(",")}return this.expect("]"),this.finalize(n,new a.ArrayPattern(r))},e.prototype.parsePropertyPattern=function(e,t){var n,r,i=this.createNode(),o=!1,s=!1;if(3===this.lookahead.type){var l=this.lookahead;n=this.parseVariableIdentifier();var c=this.finalize(i,new a.Identifier(l.value));if(this.match("=")){e.push(l),s=!0,this.nextToken();var u=this.parseAssignmentExpression();r=this.finalize(this.startNode(l),new a.AssignmentPattern(c,u))}else this.match(":")?(this.expect(":"),r=this.parsePatternWithDefault(e,t)):(e.push(l),s=!0,r=c)}else o=this.match("["),n=this.parseObjectPropertyKey(),this.expect(":"),r=this.parsePatternWithDefault(e,t);return this.finalize(i,new a.Property("init",n,o,r,!1,s))},e.prototype.parseObjectPattern=function(e,t){var n=this.createNode(),r=[];for(this.expect("{");!this.match("}");)r.push(this.parsePropertyPattern(e,t)),this.match("}")||this.expect(",");return this.expect("}"),this.finalize(n,new a.ObjectPattern(r))},e.prototype.parsePattern=function(e,t){var n;return this.match("[")?n=this.parseArrayPattern(e,t):this.match("{")?n=this.parseObjectPattern(e,t):(!this.matchKeyword("let")||"const"!==t&&"let"!==t||this.tolerateUnexpectedToken(this.lookahead,o.Messages.LetInLexicalBinding),e.push(this.lookahead),n=this.parseVariableIdentifier(t)),n},e.prototype.parsePatternWithDefault=function(e,t){var n=this.lookahead,r=this.parsePattern(e,t);if(this.match("=")){this.nextToken();var i=this.context.allowYield;this.context.allowYield=!0;var o=this.isolateCoverGrammar(this.parseAssignmentExpression);this.context.allowYield=i,r=this.finalize(this.startNode(n),new a.AssignmentPattern(r,o))}return r},e.prototype.parseVariableIdentifier=function(e){var t=this.createNode(),n=this.nextToken();return 4===n.type&&"yield"===n.value?this.context.strict?this.tolerateUnexpectedToken(n,o.Messages.StrictReservedWord):this.context.allowYield||this.throwUnexpectedToken(n):3!==n.type?this.context.strict&&4===n.type&&this.scanner.isStrictModeReservedWord(n.value)?this.tolerateUnexpectedToken(n,o.Messages.StrictReservedWord):(this.context.strict||"let"!==n.value||"var"!==e)&&this.throwUnexpectedToken(n):(this.context.isModule||this.context.await)&&3===n.type&&"await"===n.value&&this.tolerateUnexpectedToken(n),this.finalize(t,new a.Identifier(n.value))},e.prototype.parseVariableDeclaration=function(e){var t=this.createNode(),n=this.parsePattern([],"var");this.context.strict&&n.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(n.name)&&this.tolerateError(o.Messages.StrictVarName);var r=null;return this.match("=")?(this.nextToken(),r=this.isolateCoverGrammar(this.parseAssignmentExpression)):n.type===l.Syntax.Identifier||e.inFor||this.expect("="),this.finalize(t,new a.VariableDeclarator(n,r))},e.prototype.parseVariableDeclarationList=function(e){var t={inFor:e.inFor},n=[];for(n.push(this.parseVariableDeclaration(t));this.match(",");)this.nextToken(),n.push(this.parseVariableDeclaration(t));return n},e.prototype.parseVariableStatement=function(){var e=this.createNode();this.expectKeyword("var");var t=this.parseVariableDeclarationList({inFor:!1});return this.consumeSemicolon(),this.finalize(e,new a.VariableDeclaration(t,"var"))},e.prototype.parseEmptyStatement=function(){var e=this.createNode();return this.expect(";"),this.finalize(e,new a.EmptyStatement)},e.prototype.parseExpressionStatement=function(){var e=this.createNode(),t=this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new a.ExpressionStatement(t))},e.prototype.parseIfClause=function(){return this.context.strict&&this.matchKeyword("function")&&this.tolerateError(o.Messages.StrictFunction),this.parseStatement()},e.prototype.parseIfStatement=function(){var e,t=this.createNode(),n=null;this.expectKeyword("if"),this.expect("(");var r=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new a.EmptyStatement)):(this.expect(")"),e=this.parseIfClause(),this.matchKeyword("else")&&(this.nextToken(),n=this.parseIfClause())),this.finalize(t,new a.IfStatement(r,e,n))},e.prototype.parseDoWhileStatement=function(){var e=this.createNode();this.expectKeyword("do");var t=this.context.inIteration;this.context.inIteration=!0;var n=this.parseStatement();this.context.inIteration=t,this.expectKeyword("while"),this.expect("(");var r=this.parseExpression();return!this.match(")")&&this.config.tolerant?this.tolerateUnexpectedToken(this.nextToken()):(this.expect(")"),this.match(";")&&this.nextToken()),this.finalize(e,new a.DoWhileStatement(n,r))},e.prototype.parseWhileStatement=function(){var e,t=this.createNode();this.expectKeyword("while"),this.expect("(");var n=this.parseExpression();if(!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new a.EmptyStatement);else{this.expect(")");var r=this.context.inIteration;this.context.inIteration=!0,e=this.parseStatement(),this.context.inIteration=r}return this.finalize(t,new a.WhileStatement(n,e))},e.prototype.parseForStatement=function(){var e,t,n,r=null,i=null,s=null,c=!0,u=this.createNode();if(this.expectKeyword("for"),this.expect("("),this.match(";"))this.nextToken();else if(this.matchKeyword("var")){r=this.createNode(),this.nextToken();var d=this.context.allowIn;this.context.allowIn=!1;var p=this.parseVariableDeclarationList({inFor:!0});if(this.context.allowIn=d,1===p.length&&this.matchKeyword("in")){var f=p[0];f.init&&(f.id.type===l.Syntax.ArrayPattern||f.id.type===l.Syntax.ObjectPattern||this.context.strict)&&this.tolerateError(o.Messages.ForInOfLoopInitializer,"for-in"),r=this.finalize(r,new a.VariableDeclaration(p,"var")),this.nextToken(),e=r,t=this.parseExpression(),r=null}else 1===p.length&&null===p[0].init&&this.matchContextualKeyword("of")?(r=this.finalize(r,new a.VariableDeclaration(p,"var")),this.nextToken(),e=r,t=this.parseAssignmentExpression(),r=null,c=!1):(r=this.finalize(r,new a.VariableDeclaration(p,"var")),this.expect(";"))}else if(this.matchKeyword("const")||this.matchKeyword("let")){r=this.createNode();var h=this.nextToken().value;this.context.strict||"in"!==this.lookahead.value?(d=this.context.allowIn,this.context.allowIn=!1,p=this.parseBindingList(h,{inFor:!0}),this.context.allowIn=d,1===p.length&&null===p[0].init&&this.matchKeyword("in")?(r=this.finalize(r,new a.VariableDeclaration(p,h)),this.nextToken(),e=r,t=this.parseExpression(),r=null):1===p.length&&null===p[0].init&&this.matchContextualKeyword("of")?(r=this.finalize(r,new a.VariableDeclaration(p,h)),this.nextToken(),e=r,t=this.parseAssignmentExpression(),r=null,c=!1):(this.consumeSemicolon(),r=this.finalize(r,new a.VariableDeclaration(p,h)))):(r=this.finalize(r,new a.Identifier(h)),this.nextToken(),e=r,t=this.parseExpression(),r=null)}else{var m=this.lookahead;if(d=this.context.allowIn,this.context.allowIn=!1,r=this.inheritCoverGrammar(this.parseAssignmentExpression),this.context.allowIn=d,this.matchKeyword("in"))this.context.isAssignmentTarget&&r.type!==l.Syntax.AssignmentExpression||this.tolerateError(o.Messages.InvalidLHSInForIn),this.nextToken(),this.reinterpretExpressionAsPattern(r),e=r,t=this.parseExpression(),r=null;else if(this.matchContextualKeyword("of"))this.context.isAssignmentTarget&&r.type!==l.Syntax.AssignmentExpression||this.tolerateError(o.Messages.InvalidLHSInForLoop),this.nextToken(),this.reinterpretExpressionAsPattern(r),e=r,t=this.parseAssignmentExpression(),r=null,c=!1;else{if(this.match(",")){for(var g=[r];this.match(",");)this.nextToken(),g.push(this.isolateCoverGrammar(this.parseAssignmentExpression));r=this.finalize(this.startNode(m),new a.SequenceExpression(g))}this.expect(";")}}if(void 0===e&&(this.match(";")||(i=this.parseExpression()),this.expect(";"),this.match(")")||(s=this.parseExpression())),!this.match(")")&&this.config.tolerant)this.tolerateUnexpectedToken(this.nextToken()),n=this.finalize(this.createNode(),new a.EmptyStatement);else{this.expect(")");var v=this.context.inIteration;this.context.inIteration=!0,n=this.isolateCoverGrammar(this.parseStatement),this.context.inIteration=v}return void 0===e?this.finalize(u,new a.ForStatement(r,i,s,n)):c?this.finalize(u,new a.ForInStatement(e,t,n)):this.finalize(u,new a.ForOfStatement(e,t,n))},e.prototype.parseContinueStatement=function(){var e=this.createNode();this.expectKeyword("continue");var t=null;if(3===this.lookahead.type&&!this.hasLineTerminator){var n=this.parseVariableIdentifier();t=n;var r="$"+n.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,r)||this.throwError(o.Messages.UnknownLabel,n.name)}return this.consumeSemicolon(),null!==t||this.context.inIteration||this.throwError(o.Messages.IllegalContinue),this.finalize(e,new a.ContinueStatement(t))},e.prototype.parseBreakStatement=function(){var e=this.createNode();this.expectKeyword("break");var t=null;if(3===this.lookahead.type&&!this.hasLineTerminator){var n=this.parseVariableIdentifier(),r="$"+n.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,r)||this.throwError(o.Messages.UnknownLabel,n.name),t=n}return this.consumeSemicolon(),null!==t||this.context.inIteration||this.context.inSwitch||this.throwError(o.Messages.IllegalBreak),this.finalize(e,new a.BreakStatement(t))},e.prototype.parseReturnStatement=function(){this.context.inFunctionBody||this.tolerateError(o.Messages.IllegalReturn);var e=this.createNode();this.expectKeyword("return");var t=(this.match(";")||this.match("}")||this.hasLineTerminator||2===this.lookahead.type)&&8!==this.lookahead.type&&10!==this.lookahead.type?null:this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new a.ReturnStatement(t))},e.prototype.parseWithStatement=function(){this.context.strict&&this.tolerateError(o.Messages.StrictModeWith);var e,t=this.createNode();this.expectKeyword("with"),this.expect("(");var n=this.parseExpression();return!this.match(")")&&this.config.tolerant?(this.tolerateUnexpectedToken(this.nextToken()),e=this.finalize(this.createNode(),new a.EmptyStatement)):(this.expect(")"),e=this.parseStatement()),this.finalize(t,new a.WithStatement(n,e))},e.prototype.parseSwitchCase=function(){var e,t=this.createNode();this.matchKeyword("default")?(this.nextToken(),e=null):(this.expectKeyword("case"),e=this.parseExpression()),this.expect(":");for(var n=[];!(this.match("}")||this.matchKeyword("default")||this.matchKeyword("case"));)n.push(this.parseStatementListItem());return this.finalize(t,new a.SwitchCase(e,n))},e.prototype.parseSwitchStatement=function(){var e=this.createNode();this.expectKeyword("switch"),this.expect("(");var t=this.parseExpression();this.expect(")");var n=this.context.inSwitch;this.context.inSwitch=!0;var r=[],i=!1;for(this.expect("{");!this.match("}");){var s=this.parseSwitchCase();null===s.test&&(i&&this.throwError(o.Messages.MultipleDefaultsInSwitch),i=!0),r.push(s)}return this.expect("}"),this.context.inSwitch=n,this.finalize(e,new a.SwitchStatement(t,r))},e.prototype.parseLabelledStatement=function(){var e,t=this.createNode(),n=this.parseExpression();if(n.type===l.Syntax.Identifier&&this.match(":")){this.nextToken();var r=n,i="$"+r.name;Object.prototype.hasOwnProperty.call(this.context.labelSet,i)&&this.throwError(o.Messages.Redeclaration,"Label",r.name),this.context.labelSet[i]=!0;var s=void 0;if(this.matchKeyword("class"))this.tolerateUnexpectedToken(this.lookahead),s=this.parseClassDeclaration();else if(this.matchKeyword("function")){var c=this.lookahead,u=this.parseFunctionDeclaration();this.context.strict?this.tolerateUnexpectedToken(c,o.Messages.StrictFunction):u.generator&&this.tolerateUnexpectedToken(c,o.Messages.GeneratorInLegacyContext),s=u}else s=this.parseStatement();delete this.context.labelSet[i],e=new a.LabeledStatement(r,s)}else this.consumeSemicolon(),e=new a.ExpressionStatement(n);return this.finalize(t,e)},e.prototype.parseThrowStatement=function(){var e=this.createNode();this.expectKeyword("throw"),this.hasLineTerminator&&this.throwError(o.Messages.NewlineAfterThrow);var t=this.parseExpression();return this.consumeSemicolon(),this.finalize(e,new a.ThrowStatement(t))},e.prototype.parseCatchClause=function(){var e=this.createNode();this.expectKeyword("catch"),this.expect("("),this.match(")")&&this.throwUnexpectedToken(this.lookahead);for(var t=[],n=this.parsePattern(t),r={},i=0;i<t.length;i++){var s="$"+t[i].value;Object.prototype.hasOwnProperty.call(r,s)&&this.tolerateError(o.Messages.DuplicateBinding,t[i].value),r[s]=!0}this.context.strict&&n.type===l.Syntax.Identifier&&this.scanner.isRestrictedWord(n.name)&&this.tolerateError(o.Messages.StrictCatchVariable),this.expect(")");var c=this.parseBlock();return this.finalize(e,new a.CatchClause(n,c))},e.prototype.parseFinallyClause=function(){return this.expectKeyword("finally"),this.parseBlock()},e.prototype.parseTryStatement=function(){var e=this.createNode();this.expectKeyword("try");var t=this.parseBlock(),n=this.matchKeyword("catch")?this.parseCatchClause():null,r=this.matchKeyword("finally")?this.parseFinallyClause():null;return n||r||this.throwError(o.Messages.NoCatchOrFinally),this.finalize(e,new a.TryStatement(t,n,r))},e.prototype.parseDebuggerStatement=function(){var e=this.createNode();return this.expectKeyword("debugger"),this.consumeSemicolon(),this.finalize(e,new a.DebuggerStatement)},e.prototype.parseStatement=function(){var e;switch(this.lookahead.type){case 1:case 5:case 6:case 8:case 10:case 9:e=this.parseExpressionStatement();break;case 7:var t=this.lookahead.value;e="{"===t?this.parseBlock():"("===t?this.parseExpressionStatement():";"===t?this.parseEmptyStatement():this.parseExpressionStatement();break;case 3:e=this.matchAsyncFunction()?this.parseFunctionDeclaration():this.parseLabelledStatement();break;case 4:switch(this.lookahead.value){case"break":e=this.parseBreakStatement();break;case"continue":e=this.parseContinueStatement();break;case"debugger":e=this.parseDebuggerStatement();break;case"do":e=this.parseDoWhileStatement();break;case"for":e=this.parseForStatement();break;case"function":e=this.parseFunctionDeclaration();break;case"if":e=this.parseIfStatement();break;case"return":e=this.parseReturnStatement();break;case"switch":e=this.parseSwitchStatement();break;case"throw":e=this.parseThrowStatement();break;case"try":e=this.parseTryStatement();break;case"var":e=this.parseVariableStatement();break;case"while":e=this.parseWhileStatement();break;case"with":e=this.parseWithStatement();break;default:e=this.parseExpressionStatement()}break;default:e=this.throwUnexpectedToken(this.lookahead)}return e},e.prototype.parseFunctionSourceElements=function(){var e=this.createNode();this.expect("{");var t=this.parseDirectivePrologues(),n=this.context.labelSet,r=this.context.inIteration,i=this.context.inSwitch,o=this.context.inFunctionBody;for(this.context.labelSet={},this.context.inIteration=!1,this.context.inSwitch=!1,this.context.inFunctionBody=!0;2!==this.lookahead.type&&!this.match("}");)t.push(this.parseStatementListItem());return this.expect("}"),this.context.labelSet=n,this.context.inIteration=r,this.context.inSwitch=i,this.context.inFunctionBody=o,this.finalize(e,new a.BlockStatement(t))},e.prototype.validateParam=function(e,t,n){var r="$"+n;this.context.strict?(this.scanner.isRestrictedWord(n)&&(e.stricted=t,e.message=o.Messages.StrictParamName),Object.prototype.hasOwnProperty.call(e.paramSet,r)&&(e.stricted=t,e.message=o.Messages.StrictParamDupe)):e.firstRestricted||(this.scanner.isRestrictedWord(n)?(e.firstRestricted=t,e.message=o.Messages.StrictParamName):this.scanner.isStrictModeReservedWord(n)?(e.firstRestricted=t,e.message=o.Messages.StrictReservedWord):Object.prototype.hasOwnProperty.call(e.paramSet,r)&&(e.stricted=t,e.message=o.Messages.StrictParamDupe)),"function"==typeof Object.defineProperty?Object.defineProperty(e.paramSet,r,{value:!0,enumerable:!0,writable:!0,configurable:!0}):e.paramSet[r]=!0},e.prototype.parseRestElement=function(e){var t=this.createNode();this.expect("...");var n=this.parsePattern(e);return this.match("=")&&this.throwError(o.Messages.DefaultRestParameter),this.match(")")||this.throwError(o.Messages.ParameterAfterRestParameter),this.finalize(t,new a.RestElement(n))},e.prototype.parseFormalParameter=function(e){for(var t=[],n=this.match("...")?this.parseRestElement(t):this.parsePatternWithDefault(t),r=0;r<t.length;r++)this.validateParam(e,t[r],t[r].value);e.simple=e.simple&&n instanceof a.Identifier,e.params.push(n)},e.prototype.parseFormalParameters=function(e){var t;if(t={simple:!0,params:[],firstRestricted:e},this.expect("("),!this.match(")"))for(t.paramSet={};2!==this.lookahead.type&&(this.parseFormalParameter(t),!this.match(")"))&&(this.expect(","),!this.match(")")););return this.expect(")"),{simple:t.simple,params:t.params,stricted:t.stricted,firstRestricted:t.firstRestricted,message:t.message}},e.prototype.matchAsyncFunction=function(){var e=this.matchContextualKeyword("async");if(e){var t=this.scanner.saveState();this.scanner.scanComments();var n=this.scanner.lex();this.scanner.restoreState(t),e=t.lineNumber===n.lineNumber&&4===n.type&&"function"===n.value}return e},e.prototype.parseFunctionDeclaration=function(e){var t=this.createNode(),n=this.matchContextualKeyword("async");n&&this.nextToken(),this.expectKeyword("function");var r,i=!n&&this.match("*");i&&this.nextToken();var s=null,l=null;if(!e||!this.match("(")){var c=this.lookahead;s=this.parseVariableIdentifier(),this.context.strict?this.scanner.isRestrictedWord(c.value)&&this.tolerateUnexpectedToken(c,o.Messages.StrictFunctionName):this.scanner.isRestrictedWord(c.value)?(l=c,r=o.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(c.value)&&(l=c,r=o.Messages.StrictReservedWord)}var u=this.context.await,d=this.context.allowYield;this.context.await=n,this.context.allowYield=!i;var p=this.parseFormalParameters(l),f=p.params,h=p.stricted;l=p.firstRestricted,p.message&&(r=p.message);var m=this.context.strict,g=this.context.allowStrictDirective;this.context.allowStrictDirective=p.simple;var v=this.parseFunctionSourceElements();return this.context.strict&&l&&this.throwUnexpectedToken(l,r),this.context.strict&&h&&this.tolerateUnexpectedToken(h,r),this.context.strict=m,this.context.allowStrictDirective=g,this.context.await=u,this.context.allowYield=d,n?this.finalize(t,new a.AsyncFunctionDeclaration(s,f,v)):this.finalize(t,new a.FunctionDeclaration(s,f,v,i))},e.prototype.parseFunctionExpression=function(){var e=this.createNode(),t=this.matchContextualKeyword("async");t&&this.nextToken(),this.expectKeyword("function");var n,r=!t&&this.match("*");r&&this.nextToken();var i,s=null,l=this.context.await,c=this.context.allowYield;if(this.context.await=t,this.context.allowYield=!r,!this.match("(")){var u=this.lookahead;s=this.context.strict||r||!this.matchKeyword("yield")?this.parseVariableIdentifier():this.parseIdentifierName(),this.context.strict?this.scanner.isRestrictedWord(u.value)&&this.tolerateUnexpectedToken(u,o.Messages.StrictFunctionName):this.scanner.isRestrictedWord(u.value)?(i=u,n=o.Messages.StrictFunctionName):this.scanner.isStrictModeReservedWord(u.value)&&(i=u,n=o.Messages.StrictReservedWord)}var d=this.parseFormalParameters(i),p=d.params,f=d.stricted;i=d.firstRestricted,d.message&&(n=d.message);var h=this.context.strict,m=this.context.allowStrictDirective;this.context.allowStrictDirective=d.simple;var g=this.parseFunctionSourceElements();return this.context.strict&&i&&this.throwUnexpectedToken(i,n),this.context.strict&&f&&this.tolerateUnexpectedToken(f,n),this.context.strict=h,this.context.allowStrictDirective=m,this.context.await=l,this.context.allowYield=c,t?this.finalize(e,new a.AsyncFunctionExpression(s,p,g)):this.finalize(e,new a.FunctionExpression(s,p,g,r))},e.prototype.parseDirective=function(){var e=this.lookahead,t=this.createNode(),n=this.parseExpression(),r=n.type===l.Syntax.Literal?this.getTokenRaw(e).slice(1,-1):null;return this.consumeSemicolon(),this.finalize(t,r?new a.Directive(n,r):new a.ExpressionStatement(n))},e.prototype.parseDirectivePrologues=function(){for(var e=null,t=[];;){var n=this.lookahead;if(8!==n.type)break;var r=this.parseDirective();t.push(r);var i=r.directive;if("string"!=typeof i)break;"use strict"===i?(this.context.strict=!0,e&&this.tolerateUnexpectedToken(e,o.Messages.StrictOctalLiteral),this.context.allowStrictDirective||this.tolerateUnexpectedToken(n,o.Messages.IllegalLanguageModeDirective)):!e&&n.octal&&(e=n)}return t},e.prototype.qualifiedPropertyName=function(e){switch(e.type){case 3:case 8:case 1:case 5:case 6:case 4:return!0;case 7:return"["===e.value}return!1},e.prototype.parseGetterMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var n=this.parseFormalParameters();n.params.length>0&&this.tolerateError(o.Messages.BadGetterArity);var r=this.parsePropertyMethod(n);return this.context.allowYield=t,this.finalize(e,new a.FunctionExpression(null,n.params,r,!1))},e.prototype.parseSetterMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var n=this.parseFormalParameters();1!==n.params.length?this.tolerateError(o.Messages.BadSetterArity):n.params[0]instanceof a.RestElement&&this.tolerateError(o.Messages.BadSetterRestParameter);var r=this.parsePropertyMethod(n);return this.context.allowYield=t,this.finalize(e,new a.FunctionExpression(null,n.params,r,!1))},e.prototype.parseGeneratorMethod=function(){var e=this.createNode(),t=this.context.allowYield;this.context.allowYield=!0;var n=this.parseFormalParameters();this.context.allowYield=!1;var r=this.parsePropertyMethod(n);return this.context.allowYield=t,this.finalize(e,new a.FunctionExpression(null,n.params,r,!0))},e.prototype.isStartOfExpression=function(){var e=!0,t=this.lookahead.value;switch(this.lookahead.type){case 7:e="["===t||"("===t||"{"===t||"+"===t||"-"===t||"!"===t||"~"===t||"++"===t||"--"===t||"/"===t||"/="===t;break;case 4:e="class"===t||"delete"===t||"function"===t||"let"===t||"new"===t||"super"===t||"this"===t||"typeof"===t||"void"===t||"yield"===t}return e},e.prototype.parseYieldExpression=function(){var e=this.createNode();this.expectKeyword("yield");var t=null,n=!1;if(!this.hasLineTerminator){var r=this.context.allowYield;this.context.allowYield=!1,(n=this.match("*"))?(this.nextToken(),t=this.parseAssignmentExpression()):this.isStartOfExpression()&&(t=this.parseAssignmentExpression()),this.context.allowYield=r}return this.finalize(e,new a.YieldExpression(t,n))},e.prototype.parseClassElement=function(e){var t=this.lookahead,n=this.createNode(),r="",i=null,s=null,l=!1,c=!1,u=!1,d=!1;if(this.match("*"))this.nextToken();else if(l=this.match("["),"static"===(i=this.parseObjectPropertyKey()).name&&(this.qualifiedPropertyName(this.lookahead)||this.match("*"))&&(t=this.lookahead,u=!0,l=this.match("["),this.match("*")?this.nextToken():i=this.parseObjectPropertyKey()),3===t.type&&!this.hasLineTerminator&&"async"===t.value){var p=this.lookahead.value;":"!==p&&"("!==p&&"*"!==p&&(d=!0,t=this.lookahead,i=this.parseObjectPropertyKey(),3===t.type&&"constructor"===t.value&&this.tolerateUnexpectedToken(t,o.Messages.ConstructorIsAsync))}var f=this.qualifiedPropertyName(this.lookahead);return 3===t.type?"get"===t.value&&f?(r="get",l=this.match("["),i=this.parseObjectPropertyKey(),this.context.allowYield=!1,s=this.parseGetterMethod()):"set"===t.value&&f&&(r="set",l=this.match("["),i=this.parseObjectPropertyKey(),s=this.parseSetterMethod()):7===t.type&&"*"===t.value&&f&&(r="init",l=this.match("["),i=this.parseObjectPropertyKey(),s=this.parseGeneratorMethod(),c=!0),!r&&i&&this.match("(")&&(r="init",s=d?this.parsePropertyMethodAsyncFunction():this.parsePropertyMethodFunction(),c=!0),r||this.throwUnexpectedToken(this.lookahead),"init"===r&&(r="method"),l||(u&&this.isPropertyKey(i,"prototype")&&this.throwUnexpectedToken(t,o.Messages.StaticPrototype),!u&&this.isPropertyKey(i,"constructor")&&(("method"!==r||!c||s&&s.generator)&&this.throwUnexpectedToken(t,o.Messages.ConstructorSpecialMethod),e.value?this.throwUnexpectedToken(t,o.Messages.DuplicateConstructor):e.value=!0,r="constructor")),this.finalize(n,new a.MethodDefinition(i,l,s,r,u))},e.prototype.parseClassElementList=function(){var e=[],t={value:!1};for(this.expect("{");!this.match("}");)this.match(";")?this.nextToken():e.push(this.parseClassElement(t));return this.expect("}"),e},e.prototype.parseClassBody=function(){var e=this.createNode(),t=this.parseClassElementList();return this.finalize(e,new a.ClassBody(t))},e.prototype.parseClassDeclaration=function(e){var t=this.createNode(),n=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var r=e&&3!==this.lookahead.type?null:this.parseVariableIdentifier(),i=null;this.matchKeyword("extends")&&(this.nextToken(),i=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var o=this.parseClassBody();return this.context.strict=n,this.finalize(t,new a.ClassDeclaration(r,i,o))},e.prototype.parseClassExpression=function(){var e=this.createNode(),t=this.context.strict;this.context.strict=!0,this.expectKeyword("class");var n=3===this.lookahead.type?this.parseVariableIdentifier():null,r=null;this.matchKeyword("extends")&&(this.nextToken(),r=this.isolateCoverGrammar(this.parseLeftHandSideExpressionAllowCall));var i=this.parseClassBody();return this.context.strict=t,this.finalize(e,new a.ClassExpression(n,r,i))},e.prototype.parseModule=function(){this.context.strict=!0,this.context.isModule=!0,this.scanner.isModule=!0;for(var e=this.createNode(),t=this.parseDirectivePrologues();2!==this.lookahead.type;)t.push(this.parseStatementListItem());return this.finalize(e,new a.Module(t))},e.prototype.parseScript=function(){for(var e=this.createNode(),t=this.parseDirectivePrologues();2!==this.lookahead.type;)t.push(this.parseStatementListItem());return this.finalize(e,new a.Script(t))},e.prototype.parseModuleSpecifier=function(){var e=this.createNode();8!==this.lookahead.type&&this.throwError(o.Messages.InvalidModuleSpecifier);var t=this.nextToken(),n=this.getTokenRaw(t);return this.finalize(e,new a.Literal(t.value,n))},e.prototype.parseImportSpecifier=function(){var e,t,n=this.createNode();return 3===this.lookahead.type?(t=e=this.parseVariableIdentifier(),this.matchContextualKeyword("as")&&(this.nextToken(),t=this.parseVariableIdentifier())):(t=e=this.parseIdentifierName(),this.matchContextualKeyword("as")?(this.nextToken(),t=this.parseVariableIdentifier()):this.throwUnexpectedToken(this.nextToken())),this.finalize(n,new a.ImportSpecifier(t,e))},e.prototype.parseNamedImports=function(){this.expect("{");for(var e=[];!this.match("}");)e.push(this.parseImportSpecifier()),this.match("}")||this.expect(",");return this.expect("}"),e},e.prototype.parseImportDefaultSpecifier=function(){var e=this.createNode(),t=this.parseIdentifierName();return this.finalize(e,new a.ImportDefaultSpecifier(t))},e.prototype.parseImportNamespaceSpecifier=function(){var e=this.createNode();this.expect("*"),this.matchContextualKeyword("as")||this.throwError(o.Messages.NoAsAfterImportNamespace),this.nextToken();var t=this.parseIdentifierName();return this.finalize(e,new a.ImportNamespaceSpecifier(t))},e.prototype.parseImportDeclaration=function(){this.context.inFunctionBody&&this.throwError(o.Messages.IllegalImportDeclaration);var e,t=this.createNode();this.expectKeyword("import");var n=[];if(8===this.lookahead.type)e=this.parseModuleSpecifier();else{if(this.match("{")?n=n.concat(this.parseNamedImports()):this.match("*")?n.push(this.parseImportNamespaceSpecifier()):this.isIdentifierName(this.lookahead)&&!this.matchKeyword("default")?(n.push(this.parseImportDefaultSpecifier()),this.match(",")&&(this.nextToken(),this.match("*")?n.push(this.parseImportNamespaceSpecifier()):this.match("{")?n=n.concat(this.parseNamedImports()):this.throwUnexpectedToken(this.lookahead))):this.throwUnexpectedToken(this.nextToken()),!this.matchContextualKeyword("from")){var r=this.lookahead.value?o.Messages.UnexpectedToken:o.Messages.MissingFromClause;this.throwError(r,this.lookahead.value)}this.nextToken(),e=this.parseModuleSpecifier()}return this.consumeSemicolon(),this.finalize(t,new a.ImportDeclaration(n,e))},e.prototype.parseExportSpecifier=function(){var e=this.createNode(),t=this.parseIdentifierName(),n=t;return this.matchContextualKeyword("as")&&(this.nextToken(),n=this.parseIdentifierName()),this.finalize(e,new a.ExportSpecifier(t,n))},e.prototype.parseExportDeclaration=function(){this.context.inFunctionBody&&this.throwError(o.Messages.IllegalExportDeclaration);var e,t=this.createNode();if(this.expectKeyword("export"),this.matchKeyword("default"))if(this.nextToken(),this.matchKeyword("function")){var n=this.parseFunctionDeclaration(!0);e=this.finalize(t,new a.ExportDefaultDeclaration(n))}else this.matchKeyword("class")?(n=this.parseClassDeclaration(!0),e=this.finalize(t,new a.ExportDefaultDeclaration(n))):this.matchContextualKeyword("async")?(n=this.matchAsyncFunction()?this.parseFunctionDeclaration(!0):this.parseAssignmentExpression(),e=this.finalize(t,new a.ExportDefaultDeclaration(n))):(this.matchContextualKeyword("from")&&this.throwError(o.Messages.UnexpectedToken,this.lookahead.value),n=this.match("{")?this.parseObjectInitializer():this.match("[")?this.parseArrayInitializer():this.parseAssignmentExpression(),this.consumeSemicolon(),e=this.finalize(t,new a.ExportDefaultDeclaration(n)));else if(this.match("*")){if(this.nextToken(),!this.matchContextualKeyword("from")){var r=this.lookahead.value?o.Messages.UnexpectedToken:o.Messages.MissingFromClause;this.throwError(r,this.lookahead.value)}this.nextToken();var i=this.parseModuleSpecifier();this.consumeSemicolon(),e=this.finalize(t,new a.ExportAllDeclaration(i))}else if(4===this.lookahead.type){switch(n=void 0,this.lookahead.value){case"let":case"const":n=this.parseLexicalDeclaration({inFor:!1});break;case"var":case"class":case"function":n=this.parseStatementListItem();break;default:this.throwUnexpectedToken(this.lookahead)}e=this.finalize(t,new a.ExportNamedDeclaration(n,[],null))}else if(this.matchAsyncFunction())n=this.parseFunctionDeclaration(),e=this.finalize(t,new a.ExportNamedDeclaration(n,[],null));else{var s=[],l=null,c=!1;for(this.expect("{");!this.match("}");)c=c||this.matchKeyword("default"),s.push(this.parseExportSpecifier()),this.match("}")||this.expect(",");this.expect("}"),this.matchContextualKeyword("from")?(this.nextToken(),l=this.parseModuleSpecifier(),this.consumeSemicolon()):c?(r=this.lookahead.value?o.Messages.UnexpectedToken:o.Messages.MissingFromClause,this.throwError(r,this.lookahead.value)):this.consumeSemicolon(),e=this.finalize(t,new a.ExportNamedDeclaration(null,s,l))}return e},e}();t.Parser=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assert=function(e,t){if(!e)throw new Error("ASSERT: "+t)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.errors=[],this.tolerant=!1}return e.prototype.recordError=function(e){this.errors.push(e)},e.prototype.tolerate=function(e){if(!this.tolerant)throw e;this.recordError(e)},e.prototype.constructError=function(e,t){var n=new Error(e);try{throw n}catch(e){Object.create&&Object.defineProperty&&(n=Object.create(e),Object.defineProperty(n,"column",{value:t}))}return n},e.prototype.createError=function(e,t,n,r){var i="Line "+t+": "+r,o=this.constructError(i,n);return o.index=e,o.lineNumber=t,o.description=r,o},e.prototype.throwError=function(e,t,n,r){throw this.createError(e,t,n,r)},e.prototype.tolerateError=function(e,t,n,r){var i=this.createError(e,t,n,r);if(!this.tolerant)throw i;this.recordError(i)},e}();t.ErrorHandler=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Messages={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=n(4),o=n(11);function a(e){return"0123456789abcdef".indexOf(e.toLowerCase())}function s(e){return"01234567".indexOf(e)}var l=function(){function e(e,t){this.source=e,this.errorHandler=t,this.trackComment=!1,this.isModule=!1,this.length=e.length,this.index=0,this.lineNumber=e.length>0?1:0,this.lineStart=0,this.curlyStack=[]}return e.prototype.saveState=function(){return{index:this.index,lineNumber:this.lineNumber,lineStart:this.lineStart}},e.prototype.restoreState=function(e){this.index=e.index,this.lineNumber=e.lineNumber,this.lineStart=e.lineStart},e.prototype.eof=function(){return this.index>=this.length},e.prototype.throwUnexpectedToken=function(e){return void 0===e&&(e=o.Messages.UnexpectedTokenIllegal),this.errorHandler.throwError(this.index,this.lineNumber,this.index-this.lineStart+1,e)},e.prototype.tolerateUnexpectedToken=function(e){void 0===e&&(e=o.Messages.UnexpectedTokenIllegal),this.errorHandler.tolerateError(this.index,this.lineNumber,this.index-this.lineStart+1,e)},e.prototype.skipSingleLineComment=function(e){var t,n,r=[];for(this.trackComment&&(r=[],t=this.index-e,n={start:{line:this.lineNumber,column:this.index-this.lineStart-e},end:{}});!this.eof();){var o=this.source.charCodeAt(this.index);if(++this.index,i.Character.isLineTerminator(o)){if(this.trackComment){n.end={line:this.lineNumber,column:this.index-this.lineStart-1};var a={multiLine:!1,slice:[t+e,this.index-1],range:[t,this.index-1],loc:n};r.push(a)}return 13===o&&10===this.source.charCodeAt(this.index)&&++this.index,++this.lineNumber,this.lineStart=this.index,r}}return this.trackComment&&(n.end={line:this.lineNumber,column:this.index-this.lineStart},a={multiLine:!1,slice:[t+e,this.index],range:[t,this.index],loc:n},r.push(a)),r},e.prototype.skipMultiLineComment=function(){var e,t,n=[];for(this.trackComment&&(n=[],e=this.index-2,t={start:{line:this.lineNumber,column:this.index-this.lineStart-2},end:{}});!this.eof();){var r=this.source.charCodeAt(this.index);if(i.Character.isLineTerminator(r))13===r&&10===this.source.charCodeAt(this.index+1)&&++this.index,++this.lineNumber,++this.index,this.lineStart=this.index;else if(42===r){if(47===this.source.charCodeAt(this.index+1)){if(this.index+=2,this.trackComment){t.end={line:this.lineNumber,column:this.index-this.lineStart};var o={multiLine:!0,slice:[e+2,this.index-2],range:[e,this.index],loc:t};n.push(o)}return n}++this.index}else++this.index}return this.trackComment&&(t.end={line:this.lineNumber,column:this.index-this.lineStart},o={multiLine:!0,slice:[e+2,this.index],range:[e,this.index],loc:t},n.push(o)),this.tolerateUnexpectedToken(),n},e.prototype.scanComments=function(){var e;this.trackComment&&(e=[]);for(var t=0===this.index;!this.eof();){var n=this.source.charCodeAt(this.index);if(i.Character.isWhiteSpace(n))++this.index;else if(i.Character.isLineTerminator(n))++this.index,13===n&&10===this.source.charCodeAt(this.index)&&++this.index,++this.lineNumber,this.lineStart=this.index,t=!0;else if(47===n)if(47===(n=this.source.charCodeAt(this.index+1))){this.index+=2;var r=this.skipSingleLineComment(2);this.trackComment&&(e=e.concat(r)),t=!0}else{if(42!==n)break;this.index+=2,r=this.skipMultiLineComment(),this.trackComment&&(e=e.concat(r))}else if(t&&45===n){if(45!==this.source.charCodeAt(this.index+1)||62!==this.source.charCodeAt(this.index+2))break;this.index+=3,r=this.skipSingleLineComment(3),this.trackComment&&(e=e.concat(r))}else{if(60!==n||this.isModule)break;if("!--"!==this.source.slice(this.index+1,this.index+4))break;this.index+=4,r=this.skipSingleLineComment(4),this.trackComment&&(e=e.concat(r))}}return e},e.prototype.isFutureReservedWord=function(e){switch(e){case"enum":case"export":case"import":case"super":return!0;default:return!1}},e.prototype.isStrictModeReservedWord=function(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}},e.prototype.isRestrictedWord=function(e){return"eval"===e||"arguments"===e},e.prototype.isKeyword=function(e){switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}},e.prototype.codePointAt=function(e){var t=this.source.charCodeAt(e);if(t>=55296&&t<=56319){var n=this.source.charCodeAt(e+1);n>=56320&&n<=57343&&(t=1024*(t-55296)+n-56320+65536)}return t},e.prototype.scanHexEscape=function(e){for(var t="u"===e?4:2,n=0,r=0;r<t;++r){if(this.eof()||!i.Character.isHexDigit(this.source.charCodeAt(this.index)))return null;n=16*n+a(this.source[this.index++])}return String.fromCharCode(n)},e.prototype.scanUnicodeCodePointEscape=function(){var e=this.source[this.index],t=0;for("}"===e&&this.throwUnexpectedToken();!this.eof()&&(e=this.source[this.index++],i.Character.isHexDigit(e.charCodeAt(0)));)t=16*t+a(e);return(t>1114111||"}"!==e)&&this.throwUnexpectedToken(),i.Character.fromCodePoint(t)},e.prototype.getIdentifier=function(){for(var e=this.index++;!this.eof();){var t=this.source.charCodeAt(this.index);if(92===t)return this.index=e,this.getComplexIdentifier();if(t>=55296&&t<57343)return this.index=e,this.getComplexIdentifier();if(!i.Character.isIdentifierPart(t))break;++this.index}return this.source.slice(e,this.index)},e.prototype.getComplexIdentifier=function(){var e,t=this.codePointAt(this.index),n=i.Character.fromCodePoint(t);for(this.index+=n.length,92===t&&(117!==this.source.charCodeAt(this.index)&&this.throwUnexpectedToken(),++this.index,"{"===this.source[this.index]?(++this.index,e=this.scanUnicodeCodePointEscape()):null!==(e=this.scanHexEscape("u"))&&"\\"!==e&&i.Character.isIdentifierStart(e.charCodeAt(0))||this.throwUnexpectedToken(),n=e);!this.eof()&&(t=this.codePointAt(this.index),i.Character.isIdentifierPart(t));)n+=e=i.Character.fromCodePoint(t),this.index+=e.length,92===t&&(n=n.substr(0,n.length-1),117!==this.source.charCodeAt(this.index)&&this.throwUnexpectedToken(),++this.index,"{"===this.source[this.index]?(++this.index,e=this.scanUnicodeCodePointEscape()):null!==(e=this.scanHexEscape("u"))&&"\\"!==e&&i.Character.isIdentifierPart(e.charCodeAt(0))||this.throwUnexpectedToken(),n+=e);return n},e.prototype.octalToDecimal=function(e){var t="0"!==e,n=s(e);return!this.eof()&&i.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(t=!0,n=8*n+s(this.source[this.index++]),"0123".indexOf(e)>=0&&!this.eof()&&i.Character.isOctalDigit(this.source.charCodeAt(this.index))&&(n=8*n+s(this.source[this.index++]))),{code:n,octal:t}},e.prototype.scanIdentifier=function(){var e,t=this.index,n=92===this.source.charCodeAt(t)?this.getComplexIdentifier():this.getIdentifier();if(3!=(e=1===n.length?3:this.isKeyword(n)?4:"null"===n?5:"true"===n||"false"===n?1:3)&&t+n.length!==this.index){var r=this.index;this.index=t,this.tolerateUnexpectedToken(o.Messages.InvalidEscapedReservedWord),this.index=r}return{type:e,value:n,lineNumber:this.lineNumber,lineStart:this.lineStart,start:t,end:this.index}},e.prototype.scanPunctuator=function(){var e=this.index,t=this.source[this.index];switch(t){case"(":case"{":"{"===t&&this.curlyStack.push("{"),++this.index;break;case".":++this.index,"."===this.source[this.index]&&"."===this.source[this.index+1]&&(this.index+=2,t="...");break;case"}":++this.index,this.curlyStack.pop();break;case")":case";":case",":case"[":case"]":case":":case"?":case"~":++this.index;break;default:">>>="===(t=this.source.substr(this.index,4))?this.index+=4:"==="===(t=t.substr(0,3))||"!=="===t||">>>"===t||"<<="===t||">>="===t||"**="===t?this.index+=3:"&&"===(t=t.substr(0,2))||"||"===t||"=="===t||"!="===t||"+="===t||"-="===t||"*="===t||"/="===t||"++"===t||"--"===t||"<<"===t||">>"===t||"&="===t||"|="===t||"^="===t||"%="===t||"<="===t||">="===t||"=>"===t||"**"===t?this.index+=2:(t=this.source[this.index],"<>=!+-*%&|^/".indexOf(t)>=0&&++this.index)}return this.index===e&&this.throwUnexpectedToken(),{type:7,value:t,lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanHexLiteral=function(e){for(var t="";!this.eof()&&i.Character.isHexDigit(this.source.charCodeAt(this.index));)t+=this.source[this.index++];return 0===t.length&&this.throwUnexpectedToken(),i.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseInt("0x"+t,16),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanBinaryLiteral=function(e){for(var t,n="";!this.eof()&&("0"===(t=this.source[this.index])||"1"===t);)n+=this.source[this.index++];return 0===n.length&&this.throwUnexpectedToken(),this.eof()||(t=this.source.charCodeAt(this.index),(i.Character.isIdentifierStart(t)||i.Character.isDecimalDigit(t))&&this.throwUnexpectedToken()),{type:6,value:parseInt(n,2),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanOctalLiteral=function(e,t){var n="",r=!1;for(i.Character.isOctalDigit(e.charCodeAt(0))?(r=!0,n="0"+this.source[this.index++]):++this.index;!this.eof()&&i.Character.isOctalDigit(this.source.charCodeAt(this.index));)n+=this.source[this.index++];return r||0!==n.length||this.throwUnexpectedToken(),(i.Character.isIdentifierStart(this.source.charCodeAt(this.index))||i.Character.isDecimalDigit(this.source.charCodeAt(this.index)))&&this.throwUnexpectedToken(),{type:6,value:parseInt(n,8),octal:r,lineNumber:this.lineNumber,lineStart:this.lineStart,start:t,end:this.index}},e.prototype.isImplicitOctalLiteral=function(){for(var e=this.index+1;e<this.length;++e){var t=this.source[e];if("8"===t||"9"===t)return!1;if(!i.Character.isOctalDigit(t.charCodeAt(0)))return!0}return!0},e.prototype.scanNumericLiteral=function(){var e=this.index,t=this.source[e];r.assert(i.Character.isDecimalDigit(t.charCodeAt(0))||"."===t,"Numeric literal must start with a decimal digit or a decimal point");var n="";if("."!==t){if(n=this.source[this.index++],t=this.source[this.index],"0"===n){if("x"===t||"X"===t)return++this.index,this.scanHexLiteral(e);if("b"===t||"B"===t)return++this.index,this.scanBinaryLiteral(e);if("o"===t||"O"===t)return this.scanOctalLiteral(t,e);if(t&&i.Character.isOctalDigit(t.charCodeAt(0))&&this.isImplicitOctalLiteral())return this.scanOctalLiteral(t,e)}for(;i.Character.isDecimalDigit(this.source.charCodeAt(this.index));)n+=this.source[this.index++];t=this.source[this.index]}if("."===t){for(n+=this.source[this.index++];i.Character.isDecimalDigit(this.source.charCodeAt(this.index));)n+=this.source[this.index++];t=this.source[this.index]}if("e"===t||"E"===t)if(n+=this.source[this.index++],"+"!==(t=this.source[this.index])&&"-"!==t||(n+=this.source[this.index++]),i.Character.isDecimalDigit(this.source.charCodeAt(this.index)))for(;i.Character.isDecimalDigit(this.source.charCodeAt(this.index));)n+=this.source[this.index++];else this.throwUnexpectedToken();return i.Character.isIdentifierStart(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(),{type:6,value:parseFloat(n),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanStringLiteral=function(){var e=this.index,t=this.source[e];r.assert("'"===t||'"'===t,"String literal must starts with a quote"),++this.index;for(var n=!1,a="";!this.eof();){var s=this.source[this.index++];if(s===t){t="";break}if("\\"===s)if((s=this.source[this.index++])&&i.Character.isLineTerminator(s.charCodeAt(0)))++this.lineNumber,"\r"===s&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index;else switch(s){case"u":if("{"===this.source[this.index])++this.index,a+=this.scanUnicodeCodePointEscape();else{var l=this.scanHexEscape(s);null===l&&this.throwUnexpectedToken(),a+=l}break;case"x":var c=this.scanHexEscape(s);null===c&&this.throwUnexpectedToken(o.Messages.InvalidHexEscapeSequence),a+=c;break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;case"8":case"9":a+=s,this.tolerateUnexpectedToken();break;default:if(s&&i.Character.isOctalDigit(s.charCodeAt(0))){var u=this.octalToDecimal(s);n=u.octal||n,a+=String.fromCharCode(u.code)}else a+=s}else{if(i.Character.isLineTerminator(s.charCodeAt(0)))break;a+=s}}return""!==t&&(this.index=e,this.throwUnexpectedToken()),{type:8,value:a,octal:n,lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.scanTemplate=function(){var e="",t=!1,n=this.index,r="`"===this.source[n],a=!1,s=2;for(++this.index;!this.eof();){var l=this.source[this.index++];if("`"===l){s=1,a=!0,t=!0;break}if("$"===l){if("{"===this.source[this.index]){this.curlyStack.push("${"),++this.index,t=!0;break}e+=l}else if("\\"===l)if(l=this.source[this.index++],i.Character.isLineTerminator(l.charCodeAt(0)))++this.lineNumber,"\r"===l&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index;else switch(l){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"u":if("{"===this.source[this.index])++this.index,e+=this.scanUnicodeCodePointEscape();else{var c=this.index,u=this.scanHexEscape(l);null!==u?e+=u:(this.index=c,e+=l)}break;case"x":var d=this.scanHexEscape(l);null===d&&this.throwUnexpectedToken(o.Messages.InvalidHexEscapeSequence),e+=d;break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:"0"===l?(i.Character.isDecimalDigit(this.source.charCodeAt(this.index))&&this.throwUnexpectedToken(o.Messages.TemplateOctalLiteral),e+="\0"):i.Character.isOctalDigit(l.charCodeAt(0))?this.throwUnexpectedToken(o.Messages.TemplateOctalLiteral):e+=l}else i.Character.isLineTerminator(l.charCodeAt(0))?(++this.lineNumber,"\r"===l&&"\n"===this.source[this.index]&&++this.index,this.lineStart=this.index,e+="\n"):e+=l}return t||this.throwUnexpectedToken(),r||this.curlyStack.pop(),{type:10,value:this.source.slice(n+1,this.index-s),cooked:e,head:r,tail:a,lineNumber:this.lineNumber,lineStart:this.lineStart,start:n,end:this.index}},e.prototype.testRegExp=function(e,t){var n=e,r=this;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}|\\u([a-fA-F0-9]{4})/g,(function(e,t,n){var i=parseInt(t||n,16);return i>1114111&&r.throwUnexpectedToken(o.Messages.InvalidRegExp),i<=65535?String.fromCharCode(i):"￿"})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"￿"));try{RegExp(n)}catch(e){this.throwUnexpectedToken(o.Messages.InvalidRegExp)}try{return new RegExp(e,t)}catch(e){return null}},e.prototype.scanRegExpBody=function(){var e=this.source[this.index];r.assert("/"===e,"Regular expression literal must start with a slash");for(var t=this.source[this.index++],n=!1,a=!1;!this.eof();)if(t+=e=this.source[this.index++],"\\"===e)e=this.source[this.index++],i.Character.isLineTerminator(e.charCodeAt(0))&&this.throwUnexpectedToken(o.Messages.UnterminatedRegExp),t+=e;else if(i.Character.isLineTerminator(e.charCodeAt(0)))this.throwUnexpectedToken(o.Messages.UnterminatedRegExp);else if(n)"]"===e&&(n=!1);else{if("/"===e){a=!0;break}"["===e&&(n=!0)}return a||this.throwUnexpectedToken(o.Messages.UnterminatedRegExp),t.substr(1,t.length-2)},e.prototype.scanRegExpFlags=function(){for(var e="";!this.eof();){var t=this.source[this.index];if(!i.Character.isIdentifierPart(t.charCodeAt(0)))break;if(++this.index,"\\"!==t||this.eof())e+=t;else if("u"===(t=this.source[this.index])){++this.index;var n=this.index,r=this.scanHexEscape("u");if(null!==r)for(e+=r;n<this.index;++n)this.source[n];else this.index=n,e+="u";this.tolerateUnexpectedToken()}else this.tolerateUnexpectedToken()}return e},e.prototype.scanRegExp=function(){var e=this.index,t=this.scanRegExpBody(),n=this.scanRegExpFlags();return{type:9,value:"",pattern:t,flags:n,regex:this.testRegExp(t,n),lineNumber:this.lineNumber,lineStart:this.lineStart,start:e,end:this.index}},e.prototype.lex=function(){if(this.eof())return{type:2,value:"",lineNumber:this.lineNumber,lineStart:this.lineStart,start:this.index,end:this.index};var e=this.source.charCodeAt(this.index);return i.Character.isIdentifierStart(e)?this.scanIdentifier():40===e||41===e||59===e?this.scanPunctuator():39===e||34===e?this.scanStringLiteral():46===e?i.Character.isDecimalDigit(this.source.charCodeAt(this.index+1))?this.scanNumericLiteral():this.scanPunctuator():i.Character.isDecimalDigit(e)?this.scanNumericLiteral():96===e||125===e&&"${"===this.curlyStack[this.curlyStack.length-1]?this.scanTemplate():e>=55296&&e<57343&&i.Character.isIdentifierStart(this.codePointAt(this.index))?this.scanIdentifier():this.scanPunctuator()},e}();t.Scanner=l},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenName={},t.TokenName[1]="Boolean",t.TokenName[2]="<end>",t.TokenName[3]="Identifier",t.TokenName[4]="Keyword",t.TokenName[5]="Null",t.TokenName[6]="Numeric",t.TokenName[7]="Punctuator",t.TokenName[8]="String",t.TokenName[9]="RegularExpression",t.TokenName[10]="Template"},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XHTMLEntities={quot:'"',amp:"&",apos:"'",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦",lang:"⟨",rang:"⟩"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=n(12),o=n(13),a=function(){function e(){this.values=[],this.curly=this.paren=-1}return e.prototype.beforeFunctionExpression=function(e){return["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","**=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","**","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="].indexOf(e)>=0},e.prototype.isRegexStart=function(){var e=this.values[this.values.length-1],t=null!==e;switch(e){case"this":case"]":t=!1;break;case")":var n=this.values[this.paren-1];t="if"===n||"while"===n||"for"===n||"with"===n;break;case"}":if(t=!1,"function"===this.values[this.curly-3])t=!!(r=this.values[this.curly-4])&&!this.beforeFunctionExpression(r);else if("function"===this.values[this.curly-4]){var r;t=!(r=this.values[this.curly-5])||!this.beforeFunctionExpression(r)}}return t},e.prototype.push=function(e){7===e.type||4===e.type?("{"===e.value?this.curly=this.values.length:"("===e.value&&(this.paren=this.values.length),this.values.push(e.value)):this.values.push(null)},e}(),s=function(){function e(e,t){this.errorHandler=new r.ErrorHandler,this.errorHandler.tolerant=!!t&&"boolean"==typeof t.tolerant&&t.tolerant,this.scanner=new i.Scanner(e,this.errorHandler),this.scanner.trackComment=!!t&&"boolean"==typeof t.comment&&t.comment,this.trackRange=!!t&&"boolean"==typeof t.range&&t.range,this.trackLoc=!!t&&"boolean"==typeof t.loc&&t.loc,this.buffer=[],this.reader=new a}return e.prototype.errors=function(){return this.errorHandler.errors},e.prototype.getNextToken=function(){if(0===this.buffer.length){var e=this.scanner.scanComments();if(this.scanner.trackComment)for(var t=0;t<e.length;++t){var n=e[t],r=this.scanner.source.slice(n.slice[0],n.slice[1]),i={type:n.multiLine?"BlockComment":"LineComment",value:r};this.trackRange&&(i.range=n.range),this.trackLoc&&(i.loc=n.loc),this.buffer.push(i)}if(!this.scanner.eof()){var a=void 0;this.trackLoc&&(a={start:{line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},end:{}});var s="/"===this.scanner.source[this.scanner.index]&&this.reader.isRegexStart()?this.scanner.scanRegExp():this.scanner.lex();this.reader.push(s);var l={type:o.TokenName[s.type],value:this.scanner.source.slice(s.start,s.end)};if(this.trackRange&&(l.range=[s.start,s.end]),this.trackLoc&&(a.end={line:this.scanner.lineNumber,column:this.scanner.index-this.scanner.lineStart},l.loc=a),9===s.type){var c=s.pattern,u=s.flags;l.regex={pattern:c,flags:u}}this.buffer.push(l)}}return this.buffer.shift()},e}();t.Tokenizer=s}])},e.exports=r()},function(e,t,n){"use strict";var r=n(38),i=n(53),o=n(76),a=n(54),s=Object.prototype.toString,l=Object.prototype.hasOwnProperty,c={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},u=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function d(e){var t,n,o;if(t=e.toString(16).toUpperCase(),e<=255)n="x",o=2;else if(e<=65535)n="u",o=4;else{if(!(e<=4294967295))throw new i("code point within a string may not be greater than 0xFFFFFFFF");n="U",o=8}return"\\"+n+r.repeat("0",o-t.length)+t}function p(e){this.schema=e.schema||o,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=r.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,r,i,o,a,s,c;if(null===t)return{};for(n={},i=0,o=(r=Object.keys(t)).length;i<o;i+=1)a=r[i],s=String(t[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(c=e.compiledTypeMap.fallback[a])&&l.call(c.styleAliases,s)&&(s=c.styleAliases[s]),n[a]=s;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function f(e,t){for(var n,i=r.repeat(" ",t),o=0,a=-1,s="",l=e.length;o<l;)-1===(a=e.indexOf("\n",o))?(n=e.slice(o),o=l):(n=e.slice(o,a+1),o=a+1),n.length&&"\n"!==n&&(s+=i),s+=n;return s}function h(e,t){return"\n"+r.repeat(" ",e.indent*t)}function m(e){return 32===e||9===e}function g(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&65279!==e||65536<=e&&e<=1114111}function v(e,t){return g(e)&&65279!==e&&44!==e&&91!==e&&93!==e&&123!==e&&125!==e&&58!==e&&(35!==e||t&&function(e){return g(e)&&!m(e)&&65279!==e&&13!==e&&10!==e}(t))}function y(e){return/^\n* /.test(e)}function b(e,t,n,r,i){var o,a,s,l,c=!1,u=!1,d=-1!==r,p=-1,f=g(l=e.charCodeAt(0))&&65279!==l&&!m(l)&&45!==l&&63!==l&&58!==l&&44!==l&&91!==l&&93!==l&&123!==l&&125!==l&&35!==l&&38!==l&&42!==l&&33!==l&&124!==l&&61!==l&&62!==l&&39!==l&&34!==l&&37!==l&&64!==l&&96!==l&&!m(e.charCodeAt(e.length-1));if(t)for(o=0;o<e.length;o++){if(!g(a=e.charCodeAt(o)))return 5;s=o>0?e.charCodeAt(o-1):null,f=f&&v(a,s)}else{for(o=0;o<e.length;o++){if(10===(a=e.charCodeAt(o)))c=!0,d&&(u=u||o-p-1>r&&" "!==e[p+1],p=o);else if(!g(a))return 5;s=o>0?e.charCodeAt(o-1):null,f=f&&v(a,s)}u=u||d&&o-p-1>r&&" "!==e[p+1]}return c||u?n>9&&y(e)?5:u?4:3:f&&!i(e)?1:2}function x(e,t,n,r){e.dump=function(){if(0===t.length)return"''";if(!e.noCompatMode&&-1!==u.indexOf(t))return"'"+t+"'";var o=e.indent*Math.max(1,n),a=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),s=r||e.flowLevel>-1&&n>=e.flowLevel;switch(b(t,s,e.indent,a,(function(t){return function(e,t){var n,r;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}))){case 1:return t;case 2:return"'"+t.replace(/'/g,"''")+"'";case 3:return"|"+A(t,e.indent)+C(f(t,o));case 4:return">"+A(t,e.indent)+C(f(function(e,t){for(var n,r,i,o=/(\n+)([^\n]*)/g,a=(i=-1!==(i=e.indexOf("\n"))?i:e.length,o.lastIndex=i,T(e.slice(0,i),t)),s="\n"===e[0]||" "===e[0];r=o.exec(e);){var l=r[1],c=r[2];n=" "===c[0],a+=l+(s||n||""===c?"":"\n")+T(c,t),s=n}return a}(t,a),o));case 5:return'"'+function(e){for(var t,n,r,i="",o=0;o<e.length;o++)(t=e.charCodeAt(o))>=55296&&t<=56319&&(n=e.charCodeAt(o+1))>=56320&&n<=57343?(i+=d(1024*(t-55296)+n-56320+65536),o++):i+=!(r=c[t])&&g(t)?e[o]:r||d(t);return i}(t)+'"';default:throw new i("impossible error: invalid scalar style")}}()}function A(e,t){var n=y(e)?String(t):"",r="\n"===e[e.length-1];return n+(!r||"\n"!==e[e.length-2]&&"\n"!==e?r?"":"-":"+")+"\n"}function C(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function T(e,t){if(""===e||" "===e[0])return e;for(var n,r,i=/ [^ ]/g,o=0,a=0,s=0,l="";n=i.exec(e);)(s=n.index)-o>t&&(r=a>o?a:s,l+="\n"+e.slice(o,r),o=r+1),a=s;return l+="\n",e.length-o>t&&a>o?l+=e.slice(o,a)+"\n"+e.slice(a+1):l+=e.slice(o),l.slice(1)}function S(e,t,n){var r,o,a,c,u,d;for(a=0,c=(o=n?e.explicitTypes:e.implicitTypes).length;a<c;a+=1)if(((u=o[a]).instanceOf||u.predicate)&&(!u.instanceOf||"object"==typeof t&&t instanceof u.instanceOf)&&(!u.predicate||u.predicate(t))){if(e.tag=n?u.tag:"?",u.represent){if(d=e.styleMap[u.tag]||u.defaultStyle,"[object Function]"===s.call(u.represent))r=u.represent(t,d);else{if(!l.call(u.represent,d))throw new i("!<"+u.tag+'> tag resolver accepts not "'+d+'" style');r=u.represent[d](t,d)}e.dump=r}return!0}return!1}function w(e,t,n,r,o,a){e.tag=null,e.dump=n,S(e,n,!1)||S(e,n,!0);var l=s.call(e.dump);r&&(r=e.flowLevel<0||e.flowLevel>t);var c,u,d="[object Object]"===l||"[object Array]"===l;if(d&&(u=-1!==(c=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||u||2!==e.indent&&t>0)&&(o=!1),u&&e.usedDuplicates[c])e.dump="*ref_"+c;else{if(d&&u&&!e.usedDuplicates[c]&&(e.usedDuplicates[c]=!0),"[object Object]"===l)r&&0!==Object.keys(e.dump).length?(function(e,t,n,r){var o,a,s,l,c,u,d="",p=e.tag,f=Object.keys(n);if(!0===e.sortKeys)f.sort();else if("function"==typeof e.sortKeys)f.sort(e.sortKeys);else if(e.sortKeys)throw new i("sortKeys must be a boolean or a function");for(o=0,a=f.length;o<a;o+=1)u="",r&&0===o||(u+=h(e,t)),l=n[s=f[o]],w(e,t+1,s,!0,!0,!0)&&((c=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&10===e.dump.charCodeAt(0)?u+="?":u+="? "),u+=e.dump,c&&(u+=h(e,t)),w(e,t+1,l,!0,c)&&(e.dump&&10===e.dump.charCodeAt(0)?u+=":":u+=": ",d+=u+=e.dump));e.tag=p,e.dump=d||"{}"}(e,t,e.dump,o),u&&(e.dump="&ref_"+c+e.dump)):(function(e,t,n){var r,i,o,a,s,l="",c=e.tag,u=Object.keys(n);for(r=0,i=u.length;r<i;r+=1)s="",0!==r&&(s+=", "),e.condenseFlow&&(s+='"'),a=n[o=u[r]],w(e,t,o,!1,!1)&&(e.dump.length>1024&&(s+="? "),s+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),w(e,t,a,!1,!1)&&(l+=s+=e.dump));e.tag=c,e.dump="{"+l+"}"}(e,t,e.dump),u&&(e.dump="&ref_"+c+" "+e.dump));else if("[object Array]"===l){var p=e.noArrayIndent&&t>0?t-1:t;r&&0!==e.dump.length?(function(e,t,n,r){var i,o,a="",s=e.tag;for(i=0,o=n.length;i<o;i+=1)w(e,t+1,n[i],!0,!0)&&(r&&0===i||(a+=h(e,t)),e.dump&&10===e.dump.charCodeAt(0)?a+="-":a+="- ",a+=e.dump);e.tag=s,e.dump=a||"[]"}(e,p,e.dump,o),u&&(e.dump="&ref_"+c+e.dump)):(function(e,t,n){var r,i,o="",a=e.tag;for(r=0,i=n.length;r<i;r+=1)w(e,t,n[r],!1,!1)&&(0!==r&&(o+=","+(e.condenseFlow?"":" ")),o+=e.dump);e.tag=a,e.dump="["+o+"]"}(e,p,e.dump),u&&(e.dump="&ref_"+c+" "+e.dump))}else{if("[object String]"!==l){if(e.skipInvalid)return!1;throw new i("unacceptable kind of an object to dump "+l)}"?"!==e.tag&&x(e,e.dump,t,a)}null!==e.tag&&"?"!==e.tag&&(e.dump="!<"+e.tag+"> "+e.dump)}return!0}function _(e,t){var n,r,i=[],o=[];for(function e(t,n,r){var i,o,a;if(null!==t&&"object"==typeof t)if(-1!==(o=n.indexOf(t)))-1===r.indexOf(o)&&r.push(o);else if(n.push(t),Array.isArray(t))for(o=0,a=t.length;o<a;o+=1)e(t[o],n,r);else for(o=0,a=(i=Object.keys(t)).length;o<a;o+=1)e(t[i[o]],n,r)}(e,i,o),n=0,r=o.length;n<r;n+=1)t.duplicates.push(i[o[n]]);t.usedDuplicates=new Array(r)}function I(e,t){var n=new p(t=t||{});return n.noRefs||_(e,n),w(n,0,e,!0,!0)?n.dump+"\n":""}e.exports.dump=I,e.exports.safeDump=function(e,t){return I(e,r.extend({schema:a},t))}},function(e,t,n){"use strict";n(31),n(32),n(33),n(64),n(19),n(65),n(20),n(68),n(92),n(144),n(22),n(94),n(23);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(91),l=n(1),c=n(183),u=n(0),d=n(7),p=n(95),f=n(69),h=n(3),m=n(305),g=n(306),v=n(307),y=function(e){function t(t,n){void 0===n&&(n=!1);var r=e.call(this)||this;return r._hasDeclaration=!1,r._docTypeName="",r._hasDocumentElement=!1,r._currentElementSerialized=!1,r._openTags=[],r._ended=!1,r._fragment=n,r._options=l.applyDefaults(t||{},s.DefaultXMLBuilderCBOptions),r._builderOptions={defaultNamespace:r._options.defaultNamespace,namespaceAlias:r._options.namespaceAlias},"json"===r._options.format?r._writer=new g.JSONCBWriter(r._options):"yaml"===r._options.format?r._writer=new v.YAMLCBWriter(r._options):r._writer=new m.XMLCBWriter(r._options),void 0!==r._options.data&&r.on("data",r._options.data),void 0!==r._options.end&&r.on("end",r._options.end),void 0!==r._options.error&&r.on("error",r._options.error),r._prefixMap=new p.NamespacePrefixMap,r._prefixMap.set("xml",d.namespace.XML),r._prefixIndex={value:1},r._push(r._writer.frontMatter()),r}return i(t,e),t.prototype.ele=function(e,t,n){var r,i;if(l.isObject(e)||l.isString(e)&&(/^\s*</.test(e)||/^\s*[\{\[]/.test(e)||/^(\s*|(#.*)|(%.*))*---/.test(e))){var a=c.fragment().set(this._options);try{a.ele(e)}catch(e){return this.emit("error",e),this}try{for(var s=o(a.node.childNodes),u=s.next();!u.done;u=s.next()){var d=u.value;this._fromNode(d)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return this}if(this._serializeOpenTag(!0),!this._fragment&&this._hasDocumentElement&&0===this._writer.level)return this.emit("error",new Error("Document cannot have multiple document element nodes.")),this;try{this._currentElement=c.fragment(this._builderOptions).ele(e,t,n)}catch(e){return this.emit("error",e),this}return this._fragment||this._hasDocumentElement||""===this._docTypeName||this._currentElement.node._qualifiedName===this._docTypeName?(this._currentElementSerialized=!1,this._fragment||(this._hasDocumentElement=!0),this):(this.emit("error",new Error("Document element name does not match DocType declaration name.")),this)},t.prototype.att=function(e,t,n){if(void 0===this._currentElement)return this.emit("error",new Error("Cannot insert an attribute node as child of a document node.")),this;try{this._currentElement.att(e,t,n)}catch(e){return this.emit("error",e),this}return this},t.prototype.com=function(e){var t;this._serializeOpenTag(!0);try{t=c.fragment(this._builderOptions).com(e).first().node}catch(e){return this.emit("error",e),this}return!this._options.wellFormed||u.xml_isLegalChar(t.data)&&-1===t.data.indexOf("--")&&!t.data.endsWith("-")?(this._push(this._writer.comment(t.data)),this):(this.emit("error",new Error("Comment data contains invalid characters (well-formed required).")),this)},t.prototype.txt=function(e){if(!this._fragment&&void 0===this._currentElement)return this.emit("error",new Error("Cannot insert a text node as child of a document node.")),this;var t;this._serializeOpenTag(!0);try{t=c.fragment(this._builderOptions).txt(e).first().node}catch(e){return this.emit("error",e),this}if(this._options.wellFormed&&!u.xml_isLegalChar(t.data))return this.emit("error",new Error("Text data contains invalid characters (well-formed required).")),this;var n=t.data.replace(/(?!&(lt|gt|amp|apos|quot);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return this._push(this._writer.text(n)),this},t.prototype.ins=function(e,t){var n;void 0===t&&(t=""),this._serializeOpenTag(!0);try{n=c.fragment(this._builderOptions).ins(e,t).first().node}catch(e){return this.emit("error",e),this}return this._options.wellFormed&&(-1!==n.target.indexOf(":")||/^xml$/i.test(n.target))?(this.emit("error",new Error("Processing instruction target contains invalid characters (well-formed required).")),this):this._options.wellFormed&&!u.xml_isLegalChar(n.data)?(this.emit("error",Error("Processing instruction data contains invalid characters (well-formed required).")),this):(this._push(this._writer.instruction(n.target,n.data)),this)},t.prototype.dat=function(e){var t;this._serializeOpenTag(!0);try{t=c.fragment(this._builderOptions).dat(e).first().node}catch(e){return this.emit("error",e),this}return this._push(this._writer.cdata(t.data)),this},t.prototype.dec=function(e){return void 0===e&&(e={version:"1.0"}),this._fragment?(this.emit("error",Error("Cannot insert an XML declaration into a document fragment.")),this):this._hasDeclaration?(this.emit("error",Error("XML declaration is already inserted.")),this):(this._push(this._writer.declaration(e.version||"1.0",e.encoding,e.standalone)),this._hasDeclaration=!0,this)},t.prototype.dtd=function(e){if(this._fragment)return this.emit("error",Error("Cannot insert a DocType declaration into a document fragment.")),this;if(""!==this._docTypeName)return this.emit("error",new Error("DocType declaration is already inserted.")),this;if(this._hasDocumentElement)return this.emit("error",new Error("Cannot insert DocType declaration after document element.")),this;var t;try{t=c.create().dtd(e).first().node}catch(e){return this.emit("error",e),this}return this._options.wellFormed&&!u.xml_isPubidChar(t.publicId)?(this.emit("error",new Error("DocType public identifier does not match PubidChar construct (well-formed required).")),this):this._options.wellFormed&&(!u.xml_isLegalChar(t.systemId)||-1!==t.systemId.indexOf('"')&&-1!==t.systemId.indexOf("'"))?(this.emit("error",new Error("DocType system identifier contains invalid characters (well-formed required).")),this):(this._docTypeName=e.name,this._push(this._writer.docType(e.name,t.publicId,t.systemId)),this)},t.prototype.import=function(e){var t,n,r=c.fragment().set(this._options);try{r.import(e)}catch(e){return this.emit("error",e),this}try{for(var i=o(r.node.childNodes),a=i.next();!a.done;a=i.next()){var s=a.value;this._fromNode(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return this},t.prototype.up=function(){return this._serializeOpenTag(!1),this._serializeCloseTag(),this},t.prototype.end=function(){for(this._serializeOpenTag(!1);this._openTags.length>0;)this._serializeCloseTag();return this._push(null),this},t.prototype._serializeOpenTag=function(e){if(!this._currentElementSerialized&&void 0!==this._currentElement){var n=this._currentElement.node;if(!this._options.wellFormed||-1===n.localName.indexOf(":")&&u.xml_isName(n.localName)){var r="",i=!1,o=this._prefixMap.copy(),a={},s=this._recordNamespaceInformation(n,o,a),l=0===this._openTags.length?null:this._openTags[this._openTags.length-1][1],c=n.namespaceURI;if(null===c&&(c=l),l===c)null!==s&&(i=!0),r=c===d.namespace.XML?"xml:"+n.localName:n.localName,this._writer.beginElement(r),this._push(this._writer.openTagBegin(r));else{var p=n.prefix,f=null;if(null===p&&c===s||(f=o.get(p,c)),"xmlns"===p){if(this._options.wellFormed)return void this.emit("error",new Error("An element cannot have the 'xmlns' prefix (well-formed required)."));f=p}null!==f?(r=f+":"+n.localName,null!==s&&s!==d.namespace.XML&&(l=s||null),this._writer.beginElement(r),this._push(this._writer.openTagBegin(r))):null!==p?(p in a&&(p=this._generatePrefix(c,o,this._prefixIndex)),o.set(p,c),r+=p+":"+n.localName,this._writer.beginElement(r),this._push(this._writer.openTagBegin(r)),this._push(this._writer.attribute("xmlns:"+p,this._serializeAttributeValue(c,this._options.wellFormed))),null!==s&&(l=s||null)):null===s||null!==s&&s!==c?(i=!0,r+=n.localName,l=c,this._writer.beginElement(r),this._push(this._writer.openTagBegin(r)),this._push(this._writer.attribute("xmlns",this._serializeAttributeValue(c,this._options.wellFormed)))):(r+=n.localName,l=c,this._writer.beginElement(r),this._push(this._writer.openTagBegin(r)))}this._serializeAttributes(n,o,this._prefixIndex,a,i,this._options.wellFormed);var h=c===d.namespace.HTML;h&&!e&&t._VoidElementNames.has(n.localName)?(this._push(this._writer.openTagEnd(r,!0,!0)),this._writer.endElement(r)):h||e?this._push(this._writer.openTagEnd(r,!1,!1)):(this._push(this._writer.openTagEnd(r,!0,!1)),this._writer.endElement(r)),this._currentElementSerialized=!0,this._openTags.push([r,l,this._prefixMap,e]),this._isPrefixMapModified(this._prefixMap,o)&&(this._prefixMap=o),this._writer.level++}else this.emit("error",new Error("Node local name contains invalid characters (well-formed required)."))}},t.prototype._serializeCloseTag=function(){this._writer.level--;var e=this._openTags.pop();if(void 0!==e){var t=a(e,4),n=t[0],r=(t[1],t[2]),i=t[3];this._prefixMap=r,i&&(this._push(this._writer.closeTag(n)),this._writer.endElement(n))}else this.emit("error",new Error("Last element is undefined."))},t.prototype._push=function(e){null===e?(this._ended=!0,this.emit("end")):this._ended?this.emit("error",new Error("Cannot push to ended stream.")):0!==e.length&&(this._writer.hasData=!0,this.emit("data",e,this._writer.level))},t.prototype._fromNode=function(e){var t,n,r,i;if(h.Guard.isElementNode(e)){var a=e.prefix?e.prefix+":"+e.localName:e.localName;null!==e.namespaceURI?this.ele(e.namespaceURI,a):this.ele(a);try{for(var s=o(e.attributes),l=s.next();!l.done;l=s.next()){var c=l.value,u=c.prefix?c.prefix+":"+c.localName:c.localName;null!==c.namespaceURI?this.att(c.namespaceURI,u,c.value):this.att(u,c.value)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}try{for(var d=o(e.childNodes),p=d.next();!p.done;p=d.next()){var f=p.value;this._fromNode(f)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}this.up()}else h.Guard.isExclusiveTextNode(e)&&e.data?this.txt(e.data):h.Guard.isCommentNode(e)?this.com(e.data):h.Guard.isCDATASectionNode(e)?this.dat(e.data):h.Guard.isProcessingInstructionNode(e)&&this.ins(e.target,e.data)},t.prototype._serializeAttributes=function(e,t,n,r,i,a){var s,l,c=a?new f.LocalNameSet:void 0;try{for(var p=o(e.attributes),h=p.next();!h.done;h=p.next()){var m=h.value;if(a||i||null!==m.namespaceURI){if(a&&c&&c.has(m.namespaceURI,m.localName))return void this.emit("error",new Error("Element contains duplicate attributes (well-formed required)."));a&&c&&c.set(m.namespaceURI,m.localName);var g=m.namespaceURI,v=null;if(null!==g)if(v=t.get(m.prefix,g),g===d.namespace.XMLNS){if(m.value===d.namespace.XML||null===m.prefix&&i||null!==m.prefix&&(!(m.localName in r)||r[m.localName]!==m.value)&&t.has(m.localName,m.value))continue;if(a&&m.value===d.namespace.XMLNS)return void this.emit("error",new Error("XMLNS namespace is reserved (well-formed required)."));if(a&&""===m.value)return void this.emit("error",new Error("Namespace prefix declarations cannot be used to undeclare a namespace (well-formed required)."));"xmlns"===m.prefix&&(v="xmlns")}else null===v&&(v=null===m.prefix||t.hasPrefix(m.prefix)&&!t.has(m.prefix,g)?this._generatePrefix(g,t,n):m.prefix,this._push(this._writer.attribute("xmlns:"+v,this._serializeAttributeValue(g,this._options.wellFormed))));if(a&&(-1!==m.localName.indexOf(":")||!u.xml_isName(m.localName)||"xmlns"===m.localName&&null===g))return void this.emit("error",new Error("Attribute local name contains invalid characters (well-formed required)."));this._push(this._writer.attribute((null!==v?v+":":"")+m.localName,this._serializeAttributeValue(m.value,this._options.wellFormed)))}else this._push(this._writer.attribute(m.localName,this._serializeAttributeValue(m.value,this._options.wellFormed)))}}catch(e){s={error:e}}finally{try{h&&!h.done&&(l=p.return)&&l.call(p)}finally{if(s)throw s.error}}},t.prototype._serializeAttributeValue=function(e,t){return t&&null!==e&&!u.xml_isLegalChar(e)?(this.emit("error",new Error("Invalid characters in attribute value.")),""):null===e?"":e.replace(/(?!&(lt|gt|amp|apos|quot);)&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},t.prototype._recordNamespaceInformation=function(e,t,n){var r,i,a=null;try{for(var s=o(e.attributes),l=s.next();!l.done;l=s.next()){var c=l.value,u=c.namespaceURI,p=c.prefix;if(u===d.namespace.XMLNS){if(null===p){a=c.value;continue}var f=c.localName,h=c.value;if(h===d.namespace.XML)continue;if(""===h&&(h=null),t.has(f,h))continue;t.set(f,h),n[f]=h||""}}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a},t.prototype._generatePrefix=function(e,t,n){var r="ns"+n.value;return n.value++,t.set(r,e),r},t.prototype._isPrefixMapModified=function(e,t){var n=e._items,r=t._items,i=e._nullItems,o=t._nullItems;for(var a in r){var s=n[a];if(void 0===s)return!0;var l=r[a];if(s.length!==l.length)return!0;for(var c=0;c<s.length;c++)if(s[c]!==l[c])return!0}if(i.length!==o.length)return!0;for(c=0;c<i.length;c++)if(i[c]!==o[c])return!0;return!1},t._VoidElementNames=new Set(["area","base","basefont","bgsound","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"]),t}(n(308).EventEmitter);t.XMLBuilderCBImpl=y},function(e,t,n){"use strict";n(74);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this,t)||this;return n._lineLength=0,n}return i(t,e),t.prototype.frontMatter=function(){return""},t.prototype.declaration=function(e,t,n){var r=this._beginLine()+"<?xml";return r+=' version="'+e+'"',void 0!==t&&(r+=' encoding="'+t+'"'),void 0!==n&&(r+=' standalone="'+(n?"yes":"no")+'"'),r+"?>"},t.prototype.docType=function(e,t,n){return this._beginLine()+(t&&n?"<!DOCTYPE "+e+' PUBLIC "'+t+'" "'+n+'">':t?"<!DOCTYPE "+e+' PUBLIC "'+t+'">':n?"<!DOCTYPE "+e+' SYSTEM "'+n+'">':"<!DOCTYPE "+e+">")},t.prototype.comment=function(e){return this._beginLine()+"\x3c!--"+e+"--\x3e"},t.prototype.text=function(e){return this._beginLine()+e},t.prototype.instruction=function(e,t){return t?this._beginLine()+"<?"+e+" "+t+"?>":this._beginLine()+"<?"+e+"?>"},t.prototype.cdata=function(e){return this._beginLine()+"<![CDATA["+e+"]]>"},t.prototype.openTagBegin=function(e){return this._lineLength+=1+e.length,this._beginLine()+"<"+e},t.prototype.openTagEnd=function(e,t,n){return n?" />":t?this._writerOptions.allowEmptyTags?"></"+e+">":this._writerOptions.spaceBeforeSlash?" />":"/>":">"},t.prototype.closeTag=function(e){return this._beginLine()+"</"+e+">"},t.prototype.attribute=function(e,t){var n=e+'="'+t+'"';return this._writerOptions.prettyPrint&&this._writerOptions.width>0&&this._lineLength+1+n.length>this._writerOptions.width?(n=this._beginLine()+this._indent(1)+n,this._lineLength=n.length,n):(this._lineLength+=1+n.length," "+n)},t.prototype.beginElement=function(e){},t.prototype.endElement=function(e){},t.prototype._beginLine=function(){if(this._writerOptions.prettyPrint){var e=(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level);return this._lineLength=e.length,e}return""},t.prototype._indent=function(e){return e<=0?"":this._writerOptions.indent.repeat(e)},t}(n(114).BaseCBWriter);t.XMLCBWriter=o},function(e,t,n){"use strict";n(74);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this,t)||this;return n._hasChildren=[],n._additionalLevel=0,n}return i(t,e),t.prototype.frontMatter=function(){return""},t.prototype.declaration=function(e,t,n){return""},t.prototype.docType=function(e,t,n){return""},t.prototype.comment=function(e){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.comment)+this._sep()+this._val(e)+this._sep()+"}"},t.prototype.text=function(e){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.text)+this._sep()+this._val(e)+this._sep()+"}"},t.prototype.instruction=function(e,t){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.ins)+this._sep()+this._val(t?e+" "+t:e)+this._sep()+"}"},t.prototype.cdata=function(e){return this._comma()+this._beginLine()+"{"+this._sep()+this._key(this._builderOptions.convert.cdata)+this._sep()+this._val(e)+this._sep()+"}"},t.prototype.attribute=function(e,t){return this._comma()+this._beginLine(1)+"{"+this._sep()+this._key(this._builderOptions.convert.att+e)+this._sep()+this._val(t)+this._sep()+"}"},t.prototype.openTagBegin=function(e){var t=this._comma()+this._beginLine()+"{"+this._sep()+this._key(e)+this._sep()+"{";return this._additionalLevel++,this.hasData=!0,t+=this._beginLine()+this._key(this._builderOptions.convert.text)+this._sep()+"[",this._hasChildren.push(!1),t},t.prototype.openTagEnd=function(e,t,n){if(t){var r=this._sep()+"]";return this._additionalLevel--,r+(this._beginLine()+"}")+this._sep()+"}"}return""},t.prototype.closeTag=function(e){var t=this._beginLine()+"]";return this._additionalLevel--,t+(this._beginLine()+"}")+this._sep()+"}"},t.prototype.beginElement=function(e){},t.prototype.endElement=function(e){this._hasChildren.pop()},t.prototype._beginLine=function(e){return void 0===e&&(e=0),this._writerOptions.prettyPrint?(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level+e):""},t.prototype._indent=function(e){return e+this._additionalLevel<=0?"":this._writerOptions.indent.repeat(e+this._additionalLevel)},t.prototype._comma=function(){var e=this._hasChildren[this._hasChildren.length-1]?",":"";return this._hasChildren.length>0&&(this._hasChildren[this._hasChildren.length-1]=!0),e},t.prototype._sep=function(){return this._writerOptions.prettyPrint?" ":""},t.prototype._key=function(e){return'"'+e+'":'},t.prototype._val=function(e){return JSON.stringify(e)},t}(n(114).BaseCBWriter);t.JSONCBWriter=o},function(e,t,n){"use strict";n(74);var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this,t)||this;if(n._rootWritten=!1,n._additionalLevel=0,t.indent.length<2)throw new Error("YAML indententation string must be at least two characters long.");if(t.offset<0)throw new Error("YAML offset should be zero or a positive number.");return n}return i(t,e),t.prototype.frontMatter=function(){return this._beginLine()+"---"},t.prototype.declaration=function(e,t,n){return""},t.prototype.docType=function(e,t,n){return""},t.prototype.comment=function(e){return this._beginLine()+this._key(this._builderOptions.convert.comment)+" "+this._val(e)},t.prototype.text=function(e){return this._beginLine()+this._key(this._builderOptions.convert.text)+" "+this._val(e)},t.prototype.instruction=function(e,t){return this._beginLine()+this._key(this._builderOptions.convert.ins)+" "+this._val(t?e+" "+t:e)},t.prototype.cdata=function(e){return this._beginLine()+this._key(this._builderOptions.convert.cdata)+" "+this._val(e)},t.prototype.attribute=function(e,t){this._additionalLevel++;var n=this._beginLine()+this._key(this._builderOptions.convert.att+e)+" "+this._val(t);return this._additionalLevel--,n},t.prototype.openTagBegin=function(e){var t=this._beginLine()+this._key(e);return this._rootWritten||(this._rootWritten=!0),this.hasData=!0,this._additionalLevel++,t+(this._beginLine(!0)+this._key(this._builderOptions.convert.text))},t.prototype.openTagEnd=function(e,t,n){return t?" "+this._val(""):""},t.prototype.closeTag=function(e){return this._additionalLevel--,""},t.prototype.beginElement=function(e){},t.prototype.endElement=function(e){},t.prototype._beginLine=function(e){return void 0===e&&(e=!1),(this.hasData?this._writerOptions.newline:"")+this._indent(this._writerOptions.offset+this.level,e)},t.prototype._indent=function(e,t){if(e+this._additionalLevel<=0)return"";var n=this._writerOptions.indent.repeat(e+this._additionalLevel);return!t&&this._rootWritten?n.substr(0,n.length-2)+"-"+n.substr(-1,1):n},t.prototype._key=function(e){return'"'+e+'":'},t.prototype._val=function(e){return JSON.stringify(e)},t}(n(114).BaseCBWriter);t.YAMLCBWriter=o},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,o,a,s;if(c(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=u(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,s=l,console&&console.warn&&console.warn(s)}return e}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=p.bind(r);return i.listener=n,r.wrapFn=i,i}function h(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):g(i,i.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,u=g(l,c);for(n=0;n<c;++n)o(u[n],this,t)}return!0},s.prototype.addListener=function(e,t){return d(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return d(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,f(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,o,a;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77);t.createCB=function(e){return new r.XMLBuilderCBImpl(e)},t.fragmentCB=function(e){return new r.XMLBuilderCBImpl(e,!0)}}])},99178:(e,t,n)=>{"use strict";n.d(t,{A2:()=>o,BX:()=>x,LV:()=>p,p:()=>u});const r=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.finalizer"),s=Symbol("Comlink.thrown"),l=e=>"object"==typeof e&&null!==e||"function"==typeof e,c=new Map([["proxy",{canHandle:e=>l(e)&&e[r],serialize(e){const{port1:t,port2:n}=new MessageChannel;return u(e,t),[n,[n]]},deserialize:e=>(e.start(),p(e))}],["throw",{canHandle:e=>l(e)&&s in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function u(e,t=globalThis,n=["*"]){t.addEventListener("message",(function r(i){if(!i||!i.data)return;if(!function(e,t){for(const n of e){if(t===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}return!1}(n,i.origin))return void console.warn(`Invalid origin '${i.origin}' for comlink proxy`);const{id:o,type:l,path:c}=Object.assign({path:[]},i.data),p=(i.data.argumentList||[]).map(C);let f;try{const t=c.slice(0,-1).reduce(((e,t)=>e[t]),e),n=c.reduce(((e,t)=>e[t]),e);switch(l){case"GET":f=n;break;case"SET":t[c.slice(-1)[0]]=C(i.data.value),f=!0;break;case"APPLY":f=n.apply(t,p);break;case"CONSTRUCT":f=x(new n(...p));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;u(e,n),f=function(e,t){return b.set(e,t),e}(t,[t])}break;case"RELEASE":f=void 0;break;default:return}}catch(e){f={value:e,[s]:0}}Promise.resolve(f).catch((e=>({value:e,[s]:0}))).then((n=>{const[i,s]=A(n);t.postMessage(Object.assign(Object.assign({},i),{id:o}),s),"RELEASE"===l&&(t.removeEventListener("message",r),d(t),a in e&&"function"==typeof e[a]&&e[a]())})).catch((e=>{const[n,r]=A({value:new TypeError("Unserializable return value"),[s]:0});t.postMessage(Object.assign(Object.assign({},n),{id:o}),r)}))})),t.start&&t.start()}function d(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function p(e,t){return v(e,[],t)}function f(e){if(e)throw new Error("Proxy has been released and is not useable")}function h(e){return T(e,{type:"RELEASE"}).then((()=>{d(e)}))}const m=new WeakMap,g="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(m.get(e)||0)-1;m.set(e,t),0===t&&h(e)}));function v(e,t=[],n=function(){}){let r=!1;const a=new Proxy(n,{get(n,i){if(f(r),i===o)return()=>{!function(e){g&&g.unregister(e)}(a),h(e),r=!0};if("then"===i){if(0===t.length)return{then:()=>a};const n=T(e,{type:"GET",path:t.map((e=>e.toString()))}).then(C);return n.then.bind(n)}return v(e,[...t,i])},set(n,i,o){f(r);const[a,s]=A(o);return T(e,{type:"SET",path:[...t,i].map((e=>e.toString())),value:a},s).then(C)},apply(n,o,a){f(r);const s=t[t.length-1];if(s===i)return T(e,{type:"ENDPOINT"}).then(C);if("bind"===s)return v(e,t.slice(0,-1));const[l,c]=y(a);return T(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:l},c).then(C)},construct(n,i){f(r);const[o,a]=y(i);return T(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:o},a).then(C)}});return function(e,t){const n=(m.get(t)||0)+1;m.set(t,n),g&&g.register(e,t,e)}(a,e),a}function y(e){const t=e.map(A);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const b=new WeakMap;function x(e){return Object.assign(e,{[r]:!0})}function A(e){for(const[t,n]of c)if(n.canHandle(e)){const[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:e},b.get(e)||[]]}function C(e){switch(e.type){case"HANDLER":return c.get(e.name).deserialize(e.value);case"RAW":return e.value}}function T(e,t,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}},20071:(e,t,n)=>{"use strict";function r(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function i(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function o(e){let t,n,o;function s(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=r,n=(t,n)=>r(e(t),n),o=(t,n)=>e(t)-n):(t=e===r||e===i?e:a,n=e,o=e),{left:s,center:function(e,t,n=0,r=e.length){const i=s(e,t,n,r-1);return i>n&&o(e[i-1],t)>-o(e[i],t)?i-1:i},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function a(){return 0}n.d(t,{h1:()=>c,yl:()=>o,lq:()=>x,sG:()=>A,Zc:()=>b,yU:()=>T.A});const s=o(r),l=s.right,c=(s.left,o((function(e){return null===e?NaN:+e})).center,l);u(f),u((function(e){const t=f(e);return(e,n,r,i,o)=>{t(e,n,(r<<=2)+0,(i<<=2)+0,o<<=2),t(e,n,r+1,i+1,o),t(e,n,r+2,i+2,o),t(e,n,r+3,i+3,o)}}));function u(e){return function(t,n,r=n){if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((r=+r)>=0))throw new RangeError("invalid ry");let{data:i,width:o,height:a}=t;if(!((o=Math.floor(o))>=0))throw new RangeError("invalid width");if(!((a=Math.floor(void 0!==a?a:i.length/o))>=0))throw new RangeError("invalid height");if(!o||!a||!n&&!r)return t;const s=n&&e(n),l=r&&e(r),c=i.slice();return s&&l?(d(s,c,i,o,a),d(s,i,c,o,a),d(s,c,i,o,a),p(l,i,c,o,a),p(l,c,i,o,a),p(l,i,c,o,a)):s?(d(s,i,c,o,a),d(s,c,i,o,a),d(s,i,c,o,a)):l&&(p(l,i,c,o,a),p(l,c,i,o,a),p(l,i,c,o,a)),t}}function d(e,t,n,r,i){for(let o=0,a=r*i;o<a;)e(t,n,o,o+=r,1)}function p(e,t,n,r,i){for(let o=0,a=r*i;o<r;++o)e(t,n,o,o+a,r)}function f(e){const t=Math.floor(e);if(t===e)return function(e){const t=2*e+1;return(n,r,i,o,a)=>{if(!((o-=a)>=i))return;let s=e*r[i];const l=a*e;for(let e=i,t=i+l;e<t;e+=a)s+=r[Math.min(o,e)];for(let e=i,c=o;e<=c;e+=a)s+=r[Math.min(o,e+l)],n[e]=s/t,s-=r[Math.max(i,e-l)]}}(e);const n=e-t,r=2*e+1;return(e,i,o,a,s)=>{if(!((a-=s)>=o))return;let l=t*i[o];const c=s*t,u=c+s;for(let e=o,t=o+c;e<t;e+=s)l+=i[Math.min(a,e)];for(let t=o,d=a;t<=d;t+=s)l+=i[Math.min(a,t+c)],e[t]=(l+n*(i[Math.max(o,t-u)]+i[Math.min(a,t+u)]))/r,l-=i[Math.max(o,t-c)]}}Map;Set;var h=Array.prototype;h.slice,h.map;const m=Math.sqrt(50),g=Math.sqrt(10),v=Math.sqrt(2);function y(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=m?10:o>=g?5:o>=v?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/a,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*a,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=n&&n<2?y(e,t,2*n):[s,l,c]}function b(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,o,a]=r?y(t,e,n):y(e,t,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let e=0;e<s;++e)l[e]=(o-e)/-a;else for(let e=0;e<s;++e)l[e]=(o-e)*a;else if(a<0)for(let e=0;e<s;++e)l[e]=(i+e)/-a;else for(let e=0;e<s;++e)l[e]=(i+e)*a;return l}function x(e,t,n){return y(e=+e,t=+t,n=+n)[2]}function A(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?x(t,e,n):x(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}n(80004);C=Math.random;var C;n(43183);var T=n(44779)},80004:(e,t,n)=>{"use strict";function r(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}n.d(t,{A:()=>r})},43183:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(80004);function i(e){if(!(a=e.length))return[];for(var t=-1,n=(0,r.A)(e,o),i=new Array(n);++t<n;)for(var a,s=-1,l=i[t]=new Array(a);++s<a;)l[s]=e[s][t];return i}function o(e){return e.length}},54603:(e,t,n)=>{"use strict";function r(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function i(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function o(){}n.d(t,{yW:()=>A,UB:()=>pe,aq:()=>te,KI:()=>M,Qh:()=>w});var a=.7,s=1/a,l="\\s*([+-]?\\d+)\\s*",c="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",d=/^#([0-9a-f]{3,8})$/,p=new RegExp(`^rgb\\(${l},${l},${l}\\)$`),f=new RegExp(`^rgb\\(${u},${u},${u}\\)$`),h=new RegExp(`^rgba\\(${l},${l},${l},${c}\\)$`),m=new RegExp(`^rgba\\(${u},${u},${u},${c}\\)$`),g=new RegExp(`^hsl\\(${c},${u},${u}\\)$`),v=new RegExp(`^hsla\\(${c},${u},${u},${c}\\)$`),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function b(){return this.rgb().formatHex()}function x(){return this.rgb().formatRgb()}function A(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=d.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?C(t):3===n?new _(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?T(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?T(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=p.exec(e))?new _(t[1],t[2],t[3],1):(t=f.exec(e))?new _(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=h.exec(e))?T(t[1],t[2],t[3],t[4]):(t=m.exec(e))?T(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=g.exec(e))?R(t[1],t[2]/100,t[3]/100,1):(t=v.exec(e))?R(t[1],t[2]/100,t[3]/100,t[4]):y.hasOwnProperty(e)?C(y[e]):"transparent"===e?new _(NaN,NaN,NaN,0):null}function C(e){return new _(e>>16&255,e>>8&255,255&e,1)}function T(e,t,n,r){return r<=0&&(e=t=n=NaN),new _(e,t,n,r)}function S(e){return e instanceof o||(e=A(e)),e?new _((e=e.rgb()).r,e.g,e.b,e.opacity):new _}function w(e,t,n,r){return 1===arguments.length?S(e):new _(e,t,n,null==r?1:r)}function _(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function I(){return`#${P(this.r)}${P(this.g)}${P(this.b)}`}function E(){const e=D(this.opacity);return`${1===e?"rgb(":"rgba("}${O(this.r)}, ${O(this.g)}, ${O(this.b)}${1===e?")":`, ${e})`}`}function D(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function O(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function P(e){return((e=O(e))<16?"0":"")+e.toString(16)}function R(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new L(e,t,n,r)}function N(e){if(e instanceof L)return new L(e.h,e.s,e.l,e.opacity);if(e instanceof o||(e=A(e)),!e)return new L;if(e instanceof L)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),s=NaN,l=a-i,c=(a+i)/2;return l?(s=t===a?(n-r)/l+6*(n<r):n===a?(r-t)/l+2:(t-n)/l+4,l/=c<.5?a+i:2-a-i,s*=60):l=c>0&&c<1?0:s,new L(s,l,c,e.opacity)}function M(e,t,n,r){return 1===arguments.length?N(e):new L(e,t,n,null==r?1:r)}function L(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function F(e){return(e=(e||0)%360)<0?e+360:e}function B(e){return Math.max(0,Math.min(1,e||0))}function V(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}r(o,A,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:b,formatHex:b,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return N(this).formatHsl()},formatRgb:x,toString:x}),r(_,w,i(o,{brighter(e){return e=null==e?s:Math.pow(s,e),new _(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new _(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _(O(this.r),O(this.g),O(this.b),D(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:I,formatHex:I,formatHex8:function(){return`#${P(this.r)}${P(this.g)}${P(this.b)}${P(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:E,toString:E})),r(L,M,i(o,{brighter(e){return e=null==e?s:Math.pow(s,e),new L(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new L(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new _(V(e>=240?e-240:e+120,i,r),V(e,i,r),V(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new L(F(this.h),B(this.s),B(this.l),D(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=D(this.opacity);return`${1===e?"hsl(":"hsla("}${F(this.h)}, ${100*B(this.s)}%, ${100*B(this.l)}%${1===e?")":`, ${e})`}`}}));const k=Math.PI/180,U=180/Math.PI,G=.96422,z=1,W=.82521,j=4/29,H=6/29,K=3*H*H,q=H*H*H;function $(e){if(e instanceof X)return new X(e.l,e.a,e.b,e.opacity);if(e instanceof ne)return re(e);e instanceof _||(e=S(e));var t,n,r=Q(e.r),i=Q(e.g),o=Q(e.b),a=Y((.2225045*r+.7168786*i+.0606169*o)/z);return r===i&&i===o?t=n=a:(t=Y((.4360747*r+.3850649*i+.1430804*o)/G),n=Y((.0139322*r+.0971045*i+.7141733*o)/W)),new X(116*a-16,500*(t-a),200*(a-n),e.opacity)}function X(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Y(e){return e>q?Math.pow(e,1/3):e/K+j}function J(e){return e>H?e*e*e:K*(e-j)}function Z(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Q(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ee(e){if(e instanceof ne)return new ne(e.h,e.c,e.l,e.opacity);if(e instanceof X||(e=$(e)),0===e.a&&0===e.b)return new ne(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*U;return new ne(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function te(e,t,n,r){return 1===arguments.length?ee(e):new ne(e,t,n,null==r?1:r)}function ne(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function re(e){if(isNaN(e.h))return new X(e.l,0,0,e.opacity);var t=e.h*k;return new X(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}r(X,(function(e,t,n,r){return 1===arguments.length?$(e):new X(e,t,n,null==r?1:r)}),i(o,{brighter(e){return new X(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new X(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new _(Z(3.1338561*(t=G*J(t))-1.6168667*(e=z*J(e))-.4906146*(n=W*J(n))),Z(-.9787684*t+1.9161415*e+.033454*n),Z(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),r(ne,te,i(o,{brighter(e){return new ne(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new ne(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return re(this).rgb()}}));var ie=-.14861,oe=1.78277,ae=-.29227,se=-.90649,le=1.97294,ce=le*se,ue=le*oe,de=oe*ae-se*ie;function pe(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof fe)return new fe(e.h,e.s,e.l,e.opacity);e instanceof _||(e=S(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(de*r+ce*t-ue*n)/(de+ce-ue),o=r-i,a=(le*(n-i)-ae*o)/se,s=Math.sqrt(a*a+o*o)/(le*i*(1-i)),l=s?Math.atan2(a,o)*U-120:NaN;return new fe(l<0?l+360:l,s,i,e.opacity)}(e):new fe(e,t,n,null==r?1:r)}function fe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}r(fe,pe,i(o,{brighter(e){return e=null==e?s:Math.pow(s,e),new fe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?a:Math.pow(a,e),new fe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*k,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new _(255*(t+n*(ie*r+oe*i)),255*(t+n*(ae*r+se*i)),255*(t+n*(le*r)),this.opacity)}}))},56399:(e,t,n)=>{"use strict";n.d(t,{GW:()=>A,Qm:()=>o,Dj:()=>g,sH:()=>C,yd:()=>R.A});var r=n(54603);function i(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function o(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[r],a=e[r+1],s=r>0?e[r-1]:2*o-a,l=r<t-1?e[r+2]:2*a-o;return i((n-r/t)*t,s,o,a,l)}}const a=e=>()=>e;function s(e,t){return function(n){return e+n*t}}function l(e,t){var n=t-e;return n?s(e,n>180||n<-180?n-360*Math.round(n/360):n):a(isNaN(e)?t:e)}function c(e){return 1==(e=+e)?u:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):a(isNaN(t)?n:t)}}function u(e,t){var n=t-e;return n?s(e,n):a(isNaN(e)?t:e)}const d=function e(t){var n=c(t);function i(e,t){var i=n((e=(0,r.Qh)(e)).r,(t=(0,r.Qh)(t)).r),o=n(e.g,t.g),a=n(e.b,t.b),s=u(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=o(t),e.b=a(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function p(e){return function(t){var n,i,o=t.length,a=new Array(o),s=new Array(o),l=new Array(o);for(n=0;n<o;++n)i=(0,r.Qh)(t[n]),a[n]=i.r||0,s[n]=i.g||0,l[n]=i.b||0;return a=e(a),s=e(s),l=e(l),i.opacity=1,function(e){return i.r=a(e),i.g=s(e),i.b=l(e),i+""}}}p(o),p((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),o=e[(r+t-1)%t],a=e[r%t],s=e[(r+1)%t],l=e[(r+2)%t];return i((n-r/t)*t,o,a,s,l)}}));function f(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function h(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=A(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}function m(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function g(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function v(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=A(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var y=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b=new RegExp(y.source,"g");function x(e,t){var n,r,i,o=y.lastIndex=b.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=y.exec(e))&&(r=b.exec(t));)(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:g(n,r)})),o=b.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function A(e,t){var n,i,o=typeof t;return null==t||"boolean"===o?a(t):("number"===o?g:"string"===o?(n=(0,r.yW)(t))?(t=n,d):x:t instanceof r.yW?d:t instanceof Date?m:(i=t,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(t)?h:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?v:g:f))(e,t)}function C(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var T,S=180/Math.PI,w={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*S,skewX:Math.atan(l)*S,scaleX:a,scaleY:s}}function I(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,a){var s=[],l=[];return o=e(o),a=e(a),function(e,r,i,o,a,s){if(e!==i||r!==o){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:g(e,i)},{i:l-2,x:g(r,o)})}else(i||o)&&a.push("translate("+i+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:g(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,a.rotate,s,l),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:g(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,a.skewX,s,l),function(e,t,n,r,o,a){if(e!==n||t!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:g(e,n)},{i:s-2,x:g(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}I((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?w:_(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),I((function(e){return null==e?w:(T||(T=document.createElementNS("http://www.w3.org/2000/svg","g")),T.setAttribute("transform",e),(e=T.transform.baseVal.consolidate())?_((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):w)}),", ",")",")");function E(e){return((e=Math.exp(e))+1/e)/2}(function e(t,n,r){function i(e,i){var o,a,s=e[0],l=e[1],c=e[2],u=i[0],d=i[1],p=i[2],f=u-s,h=d-l,m=f*f+h*h;if(m<1e-12)a=Math.log(p/c)/t,o=function(e){return[s+e*f,l+e*h,c*Math.exp(t*e*a)]};else{var g=Math.sqrt(m),v=(p*p-c*c+r*m)/(2*c*n*g),y=(p*p-c*c-r*m)/(2*p*n*g),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(y*y+1)-y);a=(x-b)/t,o=function(e){var r,i=e*a,o=E(b),u=c/(n*g)*(o*(r=t*i+b,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[s+u*f,l+u*h,c*o/E(t*i+b)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i})(Math.SQRT2,2,4);function D(e){return function(t,n){var i=e((t=(0,r.KI)(t)).h,(n=(0,r.KI)(n)).h),o=u(t.s,n.s),a=u(t.l,n.l),s=u(t.opacity,n.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=a(e),t.opacity=s(e),t+""}}}D(l);D(u);function O(e){return function(t,n){var i=e((t=(0,r.aq)(t)).h,(n=(0,r.aq)(n)).h),o=u(t.c,n.c),a=u(t.l,n.l),s=u(t.opacity,n.opacity);return function(e){return t.h=i(e),t.c=o(e),t.l=a(e),t.opacity=s(e),t+""}}}O(l);O(u);function P(e){return function t(n){function i(t,i){var o=e((t=(0,r.UB)(t)).h,(i=(0,r.UB)(i)).h),a=u(t.s,i.s),s=u(t.l,i.l),l=u(t.opacity,i.opacity);return function(e){return t.h=o(e),t.s=a(e),t.l=s(Math.pow(e,n)),t.opacity=l(e),t+""}}return n=+n,i.gamma=t,i}(1)}P(l);P(u);var R=n(20919)},95583:(e,t,n)=>{"use strict";n.d(t,{m4:()=>D});var r=n(20071);function i(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}Symbol("implicit");var o=n(56399);function a(e){return+e}var s=[0,1];function l(e){return e}function c(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function u(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=c(i,r),o=n(a,o)):(r=c(r,i),o=n(o,a)),function(e){return o(r(e))}}function d(e,t,n){var i=Math.min(e.length,t.length)-1,o=new Array(i),a=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)o[s]=c(e[s],e[s+1]),a[s]=n(t[s],t[s+1]);return function(t){var n=(0,r.h1)(e,t,1,i)-1;return a[n](o[n](t))}}function p(){var e,t,n,r,i,c,p=s,f=s,h=o.GW,m=l;function g(){var e,t,n,o=Math.min(p.length,f.length);return m!==l&&(e=p[0],t=p[o-1],e>t&&(n=e,e=t,t=n),m=function(n){return Math.max(e,Math.min(t,n))}),r=o>2?d:u,i=c=null,v}function v(t){return null==t||isNaN(t=+t)?n:(i||(i=r(p.map(e),f,h)))(e(m(t)))}return v.invert=function(n){return m(t((c||(c=r(f,p.map(e),o.Dj)))(n)))},v.domain=function(e){return arguments.length?(p=Array.from(e,a),g()):p.slice()},v.range=function(e){return arguments.length?(f=Array.from(e),g()):f.slice()},v.rangeRound=function(e){return f=Array.from(e),h=o.sH,g()},v.clamp=function(e){return arguments.length?(m=!!e||l,g()):m!==l},v.interpolate=function(e){return arguments.length?(h=e,g()):h},v.unknown=function(e){return arguments.length?(n=e,v):n},function(n,r){return e=n,t=r,g()}}function f(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function h(e){return(e=f(Math.abs(e)))?e[1]:NaN}var m,g=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function v(e){if(!(t=g.exec(e)))throw new Error("invalid format: "+e);var t;return new y({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function y(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function b(e,t){var n=f(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}v.prototype=y.prototype,y.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const x={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>b(100*e,t),r:b,s:function(e,t){var n=f(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(m=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+f(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function A(e){return e}var C,T,S,w=Array.prototype.map,_=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function I(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?A:(t=w.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",a=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?A:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(w.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"−":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=v(e)).fill,n=e.align,d=e.sign,p=e.symbol,f=e.zero,h=e.width,g=e.comma,y=e.precision,b=e.trim,A=e.type;"n"===A?(g=!0,A="g"):x[A]||(void 0===y&&(y=12),b=!0,A="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var C="$"===p?i:"#"===p&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",T="$"===p?o:/[%p]/.test(A)?l:"",S=x[A],w=/[defgprs%]/.test(A);function I(e){var i,o,l,p=C,v=T;if("c"===A)v=S(e)+v,e="";else{var x=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:S(Math.abs(e),y),b&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),x&&0==+e&&"+"!==d&&(x=!1),p=(x?"("===d?d:c:"-"===d||"("===d?"":d)+p,v=("s"===A?_[8+m/3]:"")+v+(x&&"("===d?")":""),w)for(i=-1,o=e.length;++i<o;)if(48>(l=e.charCodeAt(i))||l>57){v=(46===l?a+e.slice(i+1):e.slice(i))+v,e=e.slice(0,i);break}}g&&!f&&(e=r(e,1/0));var I=p.length+e.length+v.length,E=I<h?new Array(h-I+1).join(t):"";switch(g&&f&&(e=r(E+e,E.length?h-v.length:1/0),E=""),n){case"<":e=p+e+v+E;break;case"=":e=p+E+e+v;break;case"^":e=E.slice(0,I=E.length>>1)+p+e+v+E.slice(I);break;default:e=E+p+e+v}return s(e)}return y=void 0===y?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),I.toString=function(){return e+""},I}return{format:d,formatPrefix:function(e,t){var n=d(((e=v(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(h(t)/3))),i=Math.pow(10,-r),o=_[8+r/3];return function(e){return n(i*e)+o}}}}function E(e,t,n,i){var o,a=(0,r.sG)(e,t,n);switch((i=v(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=i.precision||isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(h(t)/3)))-h(Math.abs(e)))}(a,s))||(i.precision=o),S(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,h(t)-h(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(i.precision=o-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(o=function(e){return Math.max(0,-h(Math.abs(e)))}(a))||(i.precision=o-2*("%"===i.type))}return T(i)}function D(){var e=p()(l,l);return e.copy=function(){return t=e,D().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},i.apply(e,arguments),function(e){var t=e.domain;return e.ticks=function(e){var n=t();return(0,r.Zc)(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return E(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var i,o,a=t(),s=0,l=a.length-1,c=a[s],u=a[l],d=10;for(u<c&&(o=c,c=u,u=o,o=s,s=l,l=o);d-- >0;){if((o=(0,r.lq)(c,u,n))===i)return a[s]=c,a[l]=u,t(a);if(o>0)c=Math.floor(c/o)*o,u=Math.ceil(u/o)*o;else{if(!(o<0))break;c=Math.ceil(c*o)/o,u=Math.floor(u*o)/o}i=o}return e},e}(e)}C=I({thousands:",",grouping:[3],currency:["$",""]}),T=C.format,S=C.formatPrefix;const O=new Date,P=new Date;function R(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,o)=>{const a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;let s;do{a.push(s=new Date(+n)),t(n,o),e(n)}while(s<n&&n<r);return a},i.filter=n=>R((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(O.setTime(+t),P.setTime(+r),e(O),e(P),Math.floor(n(O,P))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const N=R((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e));N.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?R((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):N:null);N.range;const M=1e3,L=6e4,F=36e5,B=864e5,V=6048e5,k=2592e6,U=31536e6,G=R((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*M)}),((e,t)=>(t-e)/M),(e=>e.getUTCSeconds())),z=(G.range,R((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*M)}),((e,t)=>{e.setTime(+e+t*L)}),((e,t)=>(t-e)/L),(e=>e.getMinutes()))),W=(z.range,R((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*L)}),((e,t)=>(t-e)/L),(e=>e.getUTCMinutes()))),j=(W.range,R((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*M-e.getMinutes()*L)}),((e,t)=>{e.setTime(+e+t*F)}),((e,t)=>(t-e)/F),(e=>e.getHours()))),H=(j.range,R((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*F)}),((e,t)=>(t-e)/F),(e=>e.getUTCHours()))),K=(H.range,R((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*L)/B),(e=>e.getDate()-1))),q=(K.range,R((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/B),(e=>e.getUTCDate()-1))),$=(q.range,R((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/B),(e=>Math.floor(e/B))));$.range;function X(e){return R((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*L)/V))}const Y=X(0),J=X(1),Z=X(2),Q=X(3),ee=X(4),te=X(5),ne=X(6);Y.range,J.range,Z.range,Q.range,ee.range,te.range,ne.range;function re(e){return R((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/V))}const ie=re(0),oe=re(1),ae=re(2),se=re(3),le=re(4),ce=re(5),ue=re(6),de=(ie.range,oe.range,ae.range,se.range,le.range,ce.range,ue.range,R((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth()))),pe=(de.range,R((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth()))),fe=(pe.range,R((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear())));fe.every=e=>isFinite(e=Math.floor(e))&&e>0?R((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null;fe.range;const he=R((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));he.every=e=>isFinite(e=Math.floor(e))&&e>0?R((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null;he.range;function me(e,t,n,i,o,a){const s=[[G,1,M],[G,5,5e3],[G,15,15e3],[G,30,3e4],[a,1,L],[a,5,3e5],[a,15,9e5],[a,30,18e5],[o,1,F],[o,3,108e5],[o,6,216e5],[o,12,432e5],[i,1,B],[i,2,1728e5],[n,1,V],[t,1,k],[t,3,7776e6],[e,1,U]];function l(t,n,i){const o=Math.abs(n-t)/i,a=(0,r.yl)((([,,e])=>e)).right(s,o);if(a===s.length)return e.every((0,r.sG)(t/U,n/U,i));if(0===a)return N.every(Math.max((0,r.sG)(t,n,i),1));const[l,c]=s[o/s[a-1][2]<s[a][2]/o?a-1:a];return l.every(c)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:l(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},l]}const[ge,ve]=me(he,pe,ie,$,H,W),[ye,be]=me(fe,de,Y,K,j,z);function xe(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ae(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ce(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var Te,Se,we,_e={"-":"",_:" ",0:"0"},Ie=/^\s*\d+/,Ee=/^%/,De=/[\\^$*+?|[\]().{}]/g;function Oe(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function Pe(e){return e.replace(De,"\\$&")}function Re(e){return new RegExp("^(?:"+e.map(Pe).join("|")+")","i")}function Ne(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function Me(e,t,n){var r=Ie.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Le(e,t,n){var r=Ie.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Fe(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Be(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Ve(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function ke(e,t,n){var r=Ie.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Ue(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ge(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ze(e,t,n){var r=Ie.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function We(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function je(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function He(e,t,n){var r=Ie.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ke(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function qe(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function $e(e,t,n){var r=Ie.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Xe(e,t,n){var r=Ie.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Ye(e,t,n){var r=Ie.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Je(e,t,n){var r=Ee.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Ze(e,t,n){var r=Ie.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Qe(e,t,n){var r=Ie.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function et(e,t){return Oe(e.getDate(),t,2)}function tt(e,t){return Oe(e.getHours(),t,2)}function nt(e,t){return Oe(e.getHours()%12||12,t,2)}function rt(e,t){return Oe(1+K.count(fe(e),e),t,3)}function it(e,t){return Oe(e.getMilliseconds(),t,3)}function ot(e,t){return it(e,t)+"000"}function at(e,t){return Oe(e.getMonth()+1,t,2)}function st(e,t){return Oe(e.getMinutes(),t,2)}function lt(e,t){return Oe(e.getSeconds(),t,2)}function ct(e){var t=e.getDay();return 0===t?7:t}function ut(e,t){return Oe(Y.count(fe(e)-1,e),t,2)}function dt(e){var t=e.getDay();return t>=4||0===t?ee(e):ee.ceil(e)}function pt(e,t){return e=dt(e),Oe(ee.count(fe(e),e)+(4===fe(e).getDay()),t,2)}function ft(e){return e.getDay()}function ht(e,t){return Oe(J.count(fe(e)-1,e),t,2)}function mt(e,t){return Oe(e.getFullYear()%100,t,2)}function gt(e,t){return Oe((e=dt(e)).getFullYear()%100,t,2)}function vt(e,t){return Oe(e.getFullYear()%1e4,t,4)}function yt(e,t){var n=e.getDay();return Oe((e=n>=4||0===n?ee(e):ee.ceil(e)).getFullYear()%1e4,t,4)}function bt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Oe(t/60|0,"0",2)+Oe(t%60,"0",2)}function xt(e,t){return Oe(e.getUTCDate(),t,2)}function At(e,t){return Oe(e.getUTCHours(),t,2)}function Ct(e,t){return Oe(e.getUTCHours()%12||12,t,2)}function Tt(e,t){return Oe(1+q.count(he(e),e),t,3)}function St(e,t){return Oe(e.getUTCMilliseconds(),t,3)}function wt(e,t){return St(e,t)+"000"}function _t(e,t){return Oe(e.getUTCMonth()+1,t,2)}function It(e,t){return Oe(e.getUTCMinutes(),t,2)}function Et(e,t){return Oe(e.getUTCSeconds(),t,2)}function Dt(e){var t=e.getUTCDay();return 0===t?7:t}function Ot(e,t){return Oe(ie.count(he(e)-1,e),t,2)}function Pt(e){var t=e.getUTCDay();return t>=4||0===t?le(e):le.ceil(e)}function Rt(e,t){return e=Pt(e),Oe(le.count(he(e),e)+(4===he(e).getUTCDay()),t,2)}function Nt(e){return e.getUTCDay()}function Mt(e,t){return Oe(oe.count(he(e)-1,e),t,2)}function Lt(e,t){return Oe(e.getUTCFullYear()%100,t,2)}function Ft(e,t){return Oe((e=Pt(e)).getUTCFullYear()%100,t,2)}function Bt(e,t){return Oe(e.getUTCFullYear()%1e4,t,4)}function Vt(e,t){var n=e.getUTCDay();return Oe((e=n>=4||0===n?le(e):le.ceil(e)).getUTCFullYear()%1e4,t,4)}function kt(){return"+0000"}function Ut(){return"%"}function Gt(e){return+e}function zt(e){return Math.floor(+e/1e3)}!function(e){Te=function(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,c=Re(i),u=Ne(i),d=Re(o),p=Ne(o),f=Re(a),h=Ne(a),m=Re(s),g=Ne(s),v=Re(l),y=Ne(l),b={a:function(e){return a[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:et,e:et,f:ot,g:gt,G:yt,H:tt,I:nt,j:rt,L:it,m:at,M:st,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Gt,s:zt,S:lt,u:ct,U:ut,V:pt,w:ft,W:ht,x:null,X:null,y:mt,Y:vt,Z:bt,"%":Ut},x={a:function(e){return a[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:xt,e:xt,f:wt,g:Ft,G:Vt,H:At,I:Ct,j:Tt,L:St,m:_t,M:It,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Gt,s:zt,S:Et,u:Dt,U:Ot,V:Rt,w:Nt,W:Mt,x:null,X:null,y:Lt,Y:Bt,Z:kt,"%":Ut},A={a:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return S(e,t,n,r)},d:je,e:je,f:Ye,g:Ue,G:ke,H:Ke,I:Ke,j:He,L:Xe,m:We,M:qe,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:ze,Q:Ze,s:Qe,S:$e,u:Le,U:Fe,V:Be,w:Me,W:Ve,x:function(e,t,r){return S(e,n,t,r)},X:function(e,t,n){return S(e,r,t,n)},y:Ue,Y:ke,Z:Ge,"%":Je};function C(e,t){return function(n){var r,i,o,a=[],s=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),null!=(i=_e[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),l=s+1);return a.push(e.slice(l,s)),a.join("")}}function T(e,t){return function(n){var r,i,o=Ce(1900,void 0,1);if(S(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Ae(Ce(o.y,0,1))).getUTCDay(),r=i>4||0===i?oe.ceil(r):oe(r),r=q.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=xe(Ce(o.y,0,1))).getDay(),r=i>4||0===i?J.ceil(r):J(r),r=K.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Ae(Ce(o.y,0,1)).getUTCDay():xe(Ce(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Ae(o)):xe(o)}}function S(e,t,n,r){for(var i,o,a=0,s=t.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=A[i in _e?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=C(n,b),b.X=C(r,b),b.c=C(t,b),x.x=C(n,x),x.X=C(r,x),x.c=C(t,x),{format:function(e){var t=C(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=T(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=C(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=T(e+="",!0);return t.toString=function(){return e},t}}}(e),Te.format,Te.parse,Se=Te.utcFormat,we=Te.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Wt="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString||Se(Wt);+new Date("2000-01-01T00:00:00.000Z")||we(Wt)}}]);
//# sourceMappingURL=3396.bundle.262e766abc29886e362f.js.map