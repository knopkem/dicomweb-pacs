/*! For license information please see ort.wasm-core.min.js.LICENSE.txt */
"use strict";var Ue,fe,ye,Le,Dt,Lt,ce,D,Mt,Ft,Qe,Nt,Wt,Ht,zt,Ae,Fe,jt,Gt,qt,Vt,Y,z,et,Jt,ne,oe,Ne,Zt,en,We,rr,Ke=Object.defineProperty,Xr=Object.getOwnPropertyDescriptor,Jr=Object.getOwnPropertyNames,Kr=Object.prototype.hasOwnProperty,P=(e,t)=>()=>(e&&(t=e(e=0)),t),Zr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Se=(e,t)=>{for(var r in t)Ke(e,r,{get:t[r],enumerable:!0})},Qr=(e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let a of Jr(t))!Kr.call(e,a)&&a!==r&&Ke(e,a,{get:()=>t[a],enumerable:!(n=Xr(t,a))||n.enumerable});return e},De=e=>Qr(Ke({},"__esModule",{value:!0}),e),Re=P((()=>{Ue=new Map,fe=[],ye=(e,t,r)=>{if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{let n=Ue.get(e);if(void 0===n)Ue.set(e,{backend:t,priority:r});else{if(n.priority>r)return;if(n.priority===r&&n.backend!==t)throw new Error(`cannot register backend "${e}" using priority ${r}`)}if(r>=0){let t=fe.indexOf(e);-1!==t&&fe.splice(t,1);for(let t=0;t<fe.length;t++)if(Ue.get(fe[t]).priority<=r)return void fe.splice(t,0,e);fe.push(e)}}},Le=async e=>{let t=0===e.length?fe:e,r=[];for(let e of t){let t=Ue.get(e);if(t){if(t.initialized)return t.backend;if(t.aborted)continue;let n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(a){n||r.push({name:e,err:a}),t.aborted=!0}finally{delete t.initPromise}}}throw new Error(`no available backend found. ERR: ${r.map((e=>`[${e.name}] ${e.err}`)).join(", ")}`)}})),Ct=P((()=>{Re()})),Ut=P((()=>{Dt="1.17.1"})),Ze=P((()=>{Ut(),Lt="warning",ce={wasm:{},webgl:{},webgpu:{},versions:{common:Dt},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error(`Unsupported logging level: ${e}`);Lt=e}},get logLevel(){return Lt}},Object.defineProperty(ce,"logLevel",{enumerable:!0})})),Rt=P((()=>{Ze(),D=ce})),kt=P((()=>{Mt=(e,t)=>{let r=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);r.width=e.dims[3],r.height=e.dims[2];let n=r.getContext("2d");if(null!=n){let a,o;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(a=e.dims[2],o=e.dims[3]):(a=e.dims[3],o=e.dims[2]);let i,s,u=void 0!==t?.format?t.format:"RGB",l=t?.norm;void 0===l||void 0===l.mean?i=[255,255,255,255]:"number"==typeof l.mean?i=[l.mean,l.mean,l.mean,l.mean]:(i=[l.mean[0],l.mean[1],l.mean[2],0],void 0!==l.mean[3]&&(i[3]=l.mean[3])),void 0===l||void 0===l.bias?s=[0,0,0,0]:"number"==typeof l.bias?s=[l.bias,l.bias,l.bias,l.bias]:(s=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(s[3]=l.bias[3]));let f=o*a,d=0,c=f,p=2*f,h=-1;"RGBA"===u?(d=0,c=f,p=2*f,h=3*f):"RGB"===u?(d=0,c=f,p=2*f):"RBG"===u&&(d=0,p=f,c=2*f);for(let t=0;t<o;t++)for(let r=0;r<a;r++){let a=(e.data[d++]-s[0])*i[0],o=(e.data[c++]-s[1])*i[1],u=(e.data[p++]-s[2])*i[2],l=-1===h?255:(e.data[h++]-s[3])*i[3];n.fillStyle="rgba("+a+","+o+","+u+","+l+")",n.fillRect(r,t,1,1)}if("toDataURL"in r)return r.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")},Ft=(e,t)=>{let r,n=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==n)throw new Error("Can not access image data");{let a,o,i;void 0!==t?.tensorLayout&&"NHWC"===t.tensorLayout?(a=e.dims[2],o=e.dims[1],i=e.dims[3]):(a=e.dims[3],o=e.dims[2],i=e.dims[1]);let s,u,l=void 0!==t&&void 0!==t.format?t.format:"RGB",f=t?.norm;void 0===f||void 0===f.mean?s=[255,255,255,255]:"number"==typeof f.mean?s=[f.mean,f.mean,f.mean,f.mean]:(s=[f.mean[0],f.mean[1],f.mean[2],255],void 0!==f.mean[3]&&(s[3]=f.mean[3])),void 0===f||void 0===f.bias?u=[0,0,0,0]:"number"==typeof f.bias?u=[f.bias,f.bias,f.bias,f.bias]:(u=[f.bias[0],f.bias[1],f.bias[2],0],void 0!==f.bias[3]&&(u[3]=f.bias[3]));let d=o*a;if(void 0!==t&&(void 0!==t.format&&4===i&&"RGBA"!==t.format||3===i&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");let c=4,p=0,h=1,y=2,g=3,w=0,m=d,b=2*d,v=-1;"RGBA"===l?(w=0,m=d,b=2*d,v=3*d):"RGB"===l?(w=0,m=d,b=2*d):"RBG"===l&&(w=0,b=d,m=2*d),r=n.createImageData(a,o);for(let t=0;t<o*a;p+=c,h+=c,y+=c,g+=c,t++)r.data[p]=(e.data[w++]-u[0])*s[0],r.data[h]=(e.data[m++]-u[1])*s[1],r.data[y]=(e.data[b++]-u[2])*s[2],r.data[g]=-1===v?255:(e.data[v++]-u[3])*s[3]}return r}})),$t=P((()=>{Me(),Qe=(e,t)=>{if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");let r,n,{height:a,width:o}=t,i=t.norm??{mean:255,bias:0};r="number"==typeof i.mean?[i.mean,i.mean,i.mean,i.mean]:[i.mean[0],i.mean[1],i.mean[2],i.mean[3]??255],n="number"==typeof i.bias?[i.bias,i.bias,i.bias,i.bias]:[i.bias[0],i.bias[1],i.bias[2],i.bias[3]??0];let s=void 0!==t.format?t.format:"RGBA",u=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",l=a*o,f="RGBA"===u?new Float32Array(4*l):new Float32Array(3*l),d=4,c=0,p=1,h=2,y=3,g=0,w=l,m=2*l,b=-1;"RGB"===s&&(d=3,c=0,p=1,h=2,y=-1),"RGBA"===u?b=3*l:"RBG"===u?(g=0,m=l,w=2*l):"BGR"===u&&(m=0,w=l,g=2*l);for(let t=0;t<l;t++,c+=d,h+=d,p+=d,y+=d)f[g++]=(e[c]+n[0])/r[0],f[w++]=(e[p]+n[1])/r[1],f[m++]=(e[h]+n[2])/r[2],-1!==b&&-1!==y&&(f[b++]=(e[y]+n[3])/r[3]);return new Y("float32",f,"RGBA"===u?[1,4,a,o]:[1,3,a,o])},Nt=async(e,t)=>{let r,n=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,a=typeof ImageData<"u"&&e instanceof ImageData,o=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,i="string"==typeof e,s=t??{},u=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},l=e=>e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(n){let n=u();n.width=e.width,n.height=e.height;let a=l(n);if(null==a)throw new Error("Can not access image data");{let n=e.height,o=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(n=t.resizedHeight,o=t.resizedWidth),void 0!==t){if(s=t,void 0!==t.tensorFormat)throw new Error("Image input config format must be RGBA for HTMLImageElement");s.tensorFormat="RGBA",s.height=n,s.width=o}else s.tensorFormat="RGBA",s.height=n,s.width=o;a.drawImage(e,0,0),r=a.getImageData(0,0,o,n).data}}else{if(!a){if(o){if(void 0===t)throw new Error("Please provide image config with format for Imagebitmap");let n=u();n.width=e.width,n.height=e.height;let a=l(n);if(null!=a){let t=e.height,n=e.width;return a.drawImage(e,0,0,n,t),r=a.getImageData(0,0,n,t).data,s.height=t,s.width=n,Qe(r,s)}throw new Error("Can not access image data")}if(i)return new Promise(((t,r)=>{let n=u(),a=l(n);if(!e||!a)return r();let o=new Image;o.crossOrigin="Anonymous",o.src=e,o.onload=()=>{n.width=o.width,n.height=o.height,a.drawImage(o,0,0,n.width,n.height);let e=a.getImageData(0,0,n.width,n.height);s.height=n.height,s.width=n.width,t(Qe(e.data,s))}}));throw new Error("Input data provided is not supported - aborted tensor creation")}{let n,a;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(n=t.resizedHeight,a=t.resizedWidth):(n=e.height,a=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=n,s.width=a,void 0!==t){let t=u();t.width=a,t.height=n;let o=l(t);if(null==o)throw new Error("Can not access image data");o.putImageData(e,0,0),r=o.getImageData(0,0,a,n).data}else r=e.data}}if(void 0!==r)return Qe(r,s);throw new Error("Input data provided is not supported - aborted tensor creation")},Wt=(e,t)=>{let{width:r,height:n,download:a,dispose:o}=t;return new Y({location:"texture",type:"float32",texture:e,dims:[1,n,r,4],download:a,dispose:o})},Ht=(e,t)=>{let{dataType:r,dims:n,download:a,dispose:o}=t;return new Y({location:"gpu-buffer",type:r??"float32",gpuBuffer:e,dims:n,download:a,dispose:o})},zt=(e,t,r)=>new Y({location:"cpu-pinned",type:e,data:t,dims:r??[t.length]})})),Yt=P((()=>{Ae=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["float16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Fe=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),jt=!1,Gt=()=>{if(!jt){jt=!0;let e=typeof BigInt64Array<"u"&&"function"==typeof BigInt64Array.from,t=typeof BigUint64Array<"u"&&"function"==typeof BigUint64Array.from;e&&(Ae.set("int64",BigInt64Array),Fe.set(BigInt64Array,"int64")),t&&(Ae.set("uint64",BigUint64Array),Fe.set(BigUint64Array,"uint64"))}}})),Xt=P((()=>{Me(),qt=e=>{let t=1;for(let r=0;r<e.length;r++){let n=e[r];if("number"!=typeof n||!Number.isSafeInteger(n))throw new TypeError(`dims[${r}] must be an integer, got: ${n}`);if(n<0)throw new RangeError(`dims[${r}] must be a non-negative integer, got: ${n}`);t*=n}return t},Vt=(e,t)=>{switch(e.location){case"cpu":return new Y(e.type,e.data,t);case"cpu-pinned":return new Y({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new Y({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new Y({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}})),Me=P((()=>{kt(),$t(),Yt(),Xt(),Y=class{constructor(e,t,r){let n,a;if(Gt(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,n=e.type,a=e.dims,e.location){case"cpu-pinned":{let t=Ae.get(n);if(!t)throw new TypeError(`unsupported type "${n}" to create tensor from pinned buffer`);if(!(e.data instanceof t))throw new TypeError(`buffer should be of type ${t.name}`);this.cpuData=e.data;break}case"texture":if("float32"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==n&&"float16"!==n&&"int32"!==n&&"int64"!==n&&"uint32"!==n&&"bool"!==n)throw new TypeError(`unsupported type "${n}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let o,i;if("string"==typeof e)if(n=e,i=r,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");o=t}else{let r=Ae.get(e);if(void 0===r)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(t)){if("float16"===e)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");o="uint64"===e||"int64"===e?r.from(t,BigInt):r.from(t)}else{if(!(t instanceof r))throw new TypeError(`A ${n} tensor's data must be type of ${r}`);o=t}}else if(i=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)n="string",o=e;else{if("boolean"!==t)throw new TypeError(`Invalid element type of data array: ${t}.`);n="bool",o=Uint8Array.from(e)}}else{let t=Fe.get(e.constructor);if(void 0===t)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);n=t,o=e}if(void 0===i)i=[o.length];else if(!Array.isArray(i))throw new TypeError("A tensor's dims must be a number array");a=i,this.cpuData=o,this.dataLocation="cpu"}let o=qt(a);if(this.cpuData&&o!==this.cpuData.length)throw new Error(`Tensor's size(${o}) does not match data length(${this.cpuData.length}).`);this.type=n,this.dims=a,this.size=o}static async fromImage(e,t){return Nt(e,t)}static fromTexture(e,t){return Wt(e,t)}static fromGpuBuffer(e,t){return Ht(e,t)}static fromPinnedBuffer(e,t,r){return zt(e,t,r)}toDataURL(e){return Mt(this,e)}toImageData(e){return Ft(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return Vt(this,e)}}})),ke=P((()=>{Me(),z=Y})),tt=P((()=>{Ze(),et=(e,t)=>{ce.wasm.trace&&console.timeStamp(`${e}::ORT::${t}`)},Jt=(e,t)=>{let r=(new Error).stack?.split(/\r\n|\r|\n/g)||[],n=!1;for(let a=0;a<r.length;a++){if(n&&!r[a].includes("TRACE_FUNC")){let n=`FUNC_${e}::${r[a].trim().split(" ")[1]}`;return t&&(n+=`::${t}`),void et("CPU",n)}r[a].includes("TRACE_FUNC")&&(n=!0)}},ne=e=>{ce.wasm.trace&&Jt("BEGIN",e)},oe=e=>{ce.wasm.trace&&Jt("END",e)}})),Kt=P((()=>{Re(),ke(),tt(),Ne=class e{constructor(e){this.handler=e}async run(e,t,r){ne();let n={},a={};if("object"!=typeof e||null===e||e instanceof z||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let o=!0;if("object"==typeof t){if(null===t)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof z)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw new TypeError("'fetches' cannot be an empty array.");o=!1;for(let e of t){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);n[e]=null}if("object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,i=Object.getOwnPropertyNames(t);for(let r of this.outputNames)if(-1!==i.indexOf(r)){let a=t[r];(null===a||a instanceof z)&&(e=!0,o=!1,n[r]=a)}if(e){if("object"==typeof r&&null!==r)a=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else a=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of this.inputNames)if(typeof e[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(o)for(let e of this.outputNames)n[e]=null;let i=await this.handler.run(e,n,a),s={};for(let e in i)if(Object.hasOwnProperty.call(i,e)){let t=i[e];s[e]=t instanceof z?t:new z(t.type,t.data,t.dims)}return oe(),s}async release(){return this.handler.dispose()}static async create(t,r,n,a){ne();let o,i={};if("string"==typeof t){if(o=t,"object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(o=t,"object"==typeof r&&null!==r)i=r;else if(typeof r<"u")throw new TypeError("'options' must be an object.")}else{if(!(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{let e=t,s=0,u=t.byteLength;if("object"==typeof r&&null!==r)i=r;else if("number"==typeof r){if(s=r,!Number.isSafeInteger(s))throw new RangeError("'byteOffset' must be an integer.");if(s<0||s>=e.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${e.byteLength}).`);if(u=t.byteLength-s,"number"==typeof n){if(u=n,!Number.isSafeInteger(u))throw new RangeError("'byteLength' must be an integer.");if(u<=0||s+u>e.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${e.byteLength-s}].`);if("object"==typeof a&&null!==a)i=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(typeof n<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof r<"u")throw new TypeError("'options' must be an object.");o=new Uint8Array(e,s,u)}}let s=(i.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),u=await(await Le(s)).createInferenceSessionHandler(o,i);return oe(),new e(u)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}})),Qt=P((()=>{Kt(),Zt=Ne})),er=P((()=>{})),tr=P((()=>{Re(),ke(),en="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",We=class e{constructor(e,t,r){this.handler=e,this.hasOptimizerModel=t,this.hasEvalModel=r}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(t,r){let n=t.evalModel||"",a=t.optimizerModel||"",o=r||{},i=(o.executionProviders||[]).map((e=>"string"==typeof e?e:e.name)),s=await Le(i);if(s.createTrainingSessionHandler){let r=await s.createTrainingSessionHandler(t.checkpointState,t.trainModel,n,a,o);return new e(r,!!t.optimizerModel,!!t.evalModel)}throw new Error(en)}typeNarrowingForRunStep(e,t,r,n,a){let o={},i={};if("object"!=typeof r||null===r||r instanceof z||Array.isArray(r))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let s=!0;if("object"==typeof n){if(null===n)throw new TypeError("Unexpected argument[1]: cannot be null.");if(n instanceof z)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(n)){if(0===n.length)throw new TypeError("'fetches' cannot be an empty array.");s=!1;for(let e of n){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===t.indexOf(e))throw new RangeError(`'fetches' contains invalid output name: ${e}.`);o[e]=null}if("object"==typeof a&&null!==a)i=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,r=Object.getOwnPropertyNames(n);for(let a of t)if(-1!==r.indexOf(a)){let t=n[a];(null===t||t instanceof z)&&(e=!0,s=!1,o[a]=t)}if(e){if("object"==typeof a&&null!==a)i=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else i=n}}else if(typeof n<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let t of e)if(typeof r[t]>"u")throw new Error(`input '${t}' is missing in 'feeds'.`);if(s)for(let e of t)o[e]=null;return[o,i]}convertHandlerReturnTypeToMapOfTensors(e){let t={};for(let r in e)if(Object.hasOwnProperty.call(e,r)){let n=e[r];t[r]=n instanceof z?n:new z(n.type,n.data,n.dims)}return t}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(e,t,r){let[n,a]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,e,t,r),o=await this.handler.runTrainStep(e,n,a);return this.convertHandlerReturnTypeToMapOfTensors(o)}async runOptimizerStep(e){if(!this.hasOptimizerModel)throw new Error("This TrainingSession has no OptimizerModel loaded.");await this.handler.runOptimizerStep(e||{})}async runEvalStep(e,t,r){if(this.hasEvalModel){let[n,a]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,e,t,r),o=await this.handler.runEvalStep(e,n,a);return this.convertHandlerReturnTypeToMapOfTensors(o)}throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(e=!0){return this.handler.getParametersSize(e)}async loadParametersBuffer(e,t=!0){let r=await this.getParametersSize(t);if(e.length!==4*r)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(e,t)}async getContiguousParameters(e=!0){return this.handler.getContiguousParameters(e)}async release(){return this.handler.dispose()}}})),nr=P((()=>{tr(),rr=We})),rt={};Se(rt,{InferenceSession:()=>Zt,TRACE:()=>et,TRACE_FUNC_BEGIN:()=>ne,TRACE_FUNC_END:()=>oe,Tensor:()=>z,TrainingSession:()=>rr,env:()=>D,registerBackend:()=>ye});var le=P((()=>{Ct(),Rt(),Qt(),ke(),tt(),er(),nr()})),ir={};Se(ir,{createReadStream:()=>sr,readFile:()=>tn,readFileSync:()=>rn});var tn,rn,sr,ar=P((()=>{tn=void 0,rn=void 0,sr=void 0})),ur={};Se(ur,{join:()=>nn});var nn,it,on,ot,st,He,pr,sn,an,un,mr,R,M,xe,L,hr,fn,cn,ln,dn,wr,at,br,ut,Er,Tr,$e,Or,Ie,pn,Sr,Ar,Be,mn,lt,xr,Ir,vr,Br,Pr,dt,Cr,Dr,Uo,Ur,Lr,Rr,Mr,Fr,kr,Nr,Wr,yn,je,wn,Ge,fr=P((()=>{nn=void 0})),dr=Zr(((e,t)=>{var r,n=(r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(r=r||__filename),function(e={}){var t,n,a=e;a.ready=new Promise(((e,r)=>{t=e,n=r}));var o,i,s,u=Object.assign({},a),l="./this.program",f="object"==typeof window,d="function"==typeof importScripts,c="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,p="";if(c){var h=(ar(),De(ir)),y=(fr(),De(ur));p=d?y.dirname(p)+"/":__dirname+"/",o=(e,t)=>(e=x(e)?new URL(e):y.normalize(e),h.readFileSync(e,t?void 0:"utf8")),s=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),i=(e,t,r,n=!0)=>{e=x(e)?new URL(e):y.normalize(e),h.readFile(e,n?void 0:"utf8",((e,a)=>{e?r(e):t(n?a.buffer:a)}))},!a.thisProgram&&1<process.argv.length&&(l=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),a.inspect=()=>"[Emscripten Module object]"}else(f||d)&&(d?p=self.location.href:typeof document<"u"&&document.currentScript&&(p=document.currentScript.src),r&&(p=r),p=0!==p.indexOf("blob:")?p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},d&&(s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),i=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)});var g=console.log.bind(console),w=console.error.bind(console);Object.assign(a,u),u=null,"object"!=typeof WebAssembly&&M("no native wasm support detected");var m,b,v,E,O,A,T=!1;function R(){var e=m.buffer;a.HEAP8=b=new Int8Array(e),a.HEAP16=new Int16Array(e),a.HEAPU8=v=new Uint8Array(e),a.HEAPU16=new Uint16Array(e),a.HEAP32=E=new Int32Array(e),a.HEAPU32=O=new Uint32Array(e),a.HEAPF32=new Float32Array(e),a.HEAPF64=A=new Float64Array(e)}var P=[],_=[],C=[],D=0,S=null,U=null;function M(e){throw w(e="Aborted("+e+")"),T=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),n(e),e}var L,B=e=>e.startsWith("data:application/octet-stream;base64,"),x=e=>e.startsWith("file://");if(!B(L="ort-wasm.wasm")){var I=L;L=a.locateFile?a.locateFile(I,p):p+I}function F(e){if(s)return s(e);throw"both async and sync fetching of the wasm failed"}function $(e,t,r){return function(e){if(f||d){if("function"==typeof fetch&&!x(e))return fetch(e,{credentials:"same-origin"}).then((t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((()=>F(e)));if(i)return new Promise(((t,r)=>{i(e,(e=>t(new Uint8Array(e))),r)}))}return Promise.resolve().then((()=>F(e)))}(e).then((e=>WebAssembly.instantiate(e,t))).then((e=>e)).then(r,(e=>{w(`failed to asynchronously prepare wasm: ${e}`),M(e)}))}var N,H={919888:(e,t,r,n)=>{if(typeof a>"u"||!a.za)return 1;if((e=W(e>>>0)).startsWith("./")&&(e=e.substring(2)),!(e=a.za.get(e)))return 2;if((t>>>=0)+(r>>>=0)>e.byteLength)return 3;try{return v.set(e.subarray(t,t+r),n>>>0>>>0),0}catch{return 4}}};function z(e){this.xa=e-24,this.Ha=function(e){O[this.xa+4>>>2>>>0]=e},this.Ga=function(e){O[this.xa+8>>>2>>>0]=e},this.Aa=function(e,t){this.Fa(),this.Ha(e),this.Ga(t)},this.Fa=function(){O[this.xa+16>>>2>>>0]=0}}var j,G=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,k=(e,t,r)=>{var n=(t>>>=0)+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&G)return G.decode(e.subarray(t,r));for(n="";t<r;){var a=e[t++];if(128&a){var o=63&e[t++];if(192==(224&a))n+=String.fromCharCode((31&a)<<6|o);else{var i=63&e[t++];65536>(a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&e[t++])?n+=String.fromCharCode(a):(a-=65536,n+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else n+=String.fromCharCode(a)}return n},W=(e,t)=>(e>>>=0)?k(v,e,t):"",Y=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},V=(e,t,r,n)=>{if(!(0<n))return 0;var a=r>>>=0;n=r+n-1;for(var o=0;o<e.length;++o){var i=e.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),127>=i){if(r>=n)break;t[r++>>>0]=i}else{if(2047>=i){if(r+1>=n)break;t[r++>>>0]=192|i>>6}else{if(65535>=i){if(r+2>=n)break;t[r++>>>0]=224|i>>12}else{if(r+3>=n)break;t[r++>>>0]=240|i>>18,t[r++>>>0]=128|i>>12&63}t[r++>>>0]=128|i>>6&63}t[r++>>>0]=128|63&i}}return t[r>>>0]=0,r-a},q=e=>e%4==0&&(e%100!=0||e%400==0),Z=[0,31,60,91,121,152,182,213,244,274,305,335],J=[0,31,59,90,120,151,181,212,243,273,304,334],Q=e=>{var t=Y(e)+1,r=ue(t);return r&&V(e,v,r,t),r},X=[],K={},ee=()=>{if(!j){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(e in K)void 0===K[e]?delete t[e]:t[e]=K[e];var r=[];for(e in t)r.push(`${e}=${t[e]}`);j=r}return j},te=[null,[],[]],re=[31,29,31,30,31,30,31,31,30,31,30,31],ne=[31,28,31,30,31,30,31,31,30,31,30,31];function ae(e,t,r,n){function a(e,t,r){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=r[0]+e;return e}function o(e,t){return a(e,t,"0")}function i(e,t){function r(e){return 0>e?-1:0<e?1:0}var n;return 0===(n=r(e.getFullYear()-t.getFullYear()))&&0===(n=r(e.getMonth()-t.getMonth()))&&(n=r(e.getDate()-t.getDate())),n}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.ta;for(e=new Date(new Date(e.ua+1900,0,1).getTime());0<t;){var r=e.getMonth(),n=(q(e.getFullYear())?re:ne)[r];if(!(t>n-e.getDate())){e.setDate(e.getDate()+t);break}t-=n-e.getDate()+1,e.setDate(1),11>r?e.setMonth(r+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return r=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),r=s(r),0>=i(t,e)?0>=i(r,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}e>>>=0,t>>>=0,r>>>=0;var l=O[40+(n>>>=0)>>>2>>>0];for(var f in n={Da:E[n>>>2>>>0],Ca:E[n+4>>>2>>>0],va:E[n+8>>>2>>>0],ya:E[n+12>>>2>>>0],wa:E[n+16>>>2>>>0],ua:E[n+20>>>2>>>0],oa:E[n+24>>>2>>>0],ta:E[n+28>>>2>>>0],Ia:E[n+32>>>2>>>0],Ba:E[n+36>>>2>>>0],Ea:l?W(l):""},r=W(r),l={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(f,"g"),l[f]);var d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),c="January February March April May June July August September October November December".split(" ");for(f in l={"%a":e=>d[e.oa].substring(0,3),"%A":e=>d[e.oa],"%b":e=>c[e.wa].substring(0,3),"%B":e=>c[e.wa],"%C":e=>o((e.ua+1900)/100|0,2),"%d":e=>o(e.ya,2),"%e":e=>a(e.ya,2," "),"%g":e=>u(e).toString().substring(2),"%G":e=>u(e),"%H":e=>o(e.va,2),"%I":e=>(0==(e=e.va)?e=12:12<e&&(e-=12),o(e,2)),"%j":e=>{for(var t=0,r=0;r<=e.wa-1;t+=(q(e.ua+1900)?re:ne)[r++]);return o(e.ya+t,3)},"%m":e=>o(e.wa+1,2),"%M":e=>o(e.Ca,2),"%n":()=>"\n","%p":e=>0<=e.va&&12>e.va?"AM":"PM","%S":e=>o(e.Da,2),"%t":()=>"\t","%u":e=>e.oa||7,"%U":e=>o(Math.floor((e.ta+7-e.oa)/7),2),"%V":e=>{var t=Math.floor((e.ta+7-(e.oa+6)%7)/7);if(2>=(e.oa+371-e.ta-2)%7&&t++,t)53==t&&(4==(r=(e.oa+371-e.ta)%7)||3==r&&q(e.ua)||(t=1));else{t=52;var r=(e.oa+7-e.ta-1)%7;(4==r||5==r&&q(e.ua%400-1))&&t++}return o(t,2)},"%w":e=>e.oa,"%W":e=>o(Math.floor((e.ta+7-(e.oa+6)%7)/7),2),"%y":e=>(e.ua+1900).toString().substring(2),"%Y":e=>e.ua+1900,"%z":e=>(0<=(e=e.Ba)?"+":"-")+("0000"+((e=Math.abs(e)/60)/60*100+e%60)).slice(-4),"%Z":e=>e.Ea,"%%":()=>"%"},r=r.replace(/%%/g,"\0\0"),l)r.includes(f)&&(r=r.replace(new RegExp(f,"g"),l[f](n)));return f=function(e){var t=Array(Y(e)+1);return V(e,t,0,t.length),t}(r=r.replace(/\0\0/g,"%")),f.length>t?0:(b.set(f,e>>>0),f.length-1)}var oe={a:function(e,t,r){throw new z(e>>>=0).Aa(t>>>0,r>>>0),e},e:function(){return 0},H:function(){},x:function(){},z:function(){},J:function(){return 0},F:function(){},A:function(){},E:function(){},g:function(){},y:function(){},v:function(){},G:function(){},w:function(){},k:()=>1,n:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),E[r>>>2>>>0]=e.getUTCSeconds(),E[r+4>>>2>>>0]=e.getUTCMinutes(),E[r+8>>>2>>>0]=e.getUTCHours(),E[r+12>>>2>>>0]=e.getUTCDate(),E[r+16>>>2>>>0]=e.getUTCMonth(),E[r+20>>>2>>>0]=e.getUTCFullYear()-1900,E[r+24>>>2>>>0]=e.getUTCDay(),E[r+28>>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},o:function(e,t,r){e=t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,r>>>=0,e=new Date(1e3*e),E[r>>>2>>>0]=e.getSeconds(),E[r+4>>>2>>>0]=e.getMinutes(),E[r+8>>>2>>>0]=e.getHours(),E[r+12>>>2>>>0]=e.getDate(),E[r+16>>>2>>>0]=e.getMonth(),E[r+20>>>2>>>0]=e.getFullYear()-1900,E[r+24>>>2>>>0]=e.getDay(),E[r+28>>>2>>>0]=(q(e.getFullYear())?Z:J)[e.getMonth()]+e.getDate()-1|0,E[r+36>>>2>>>0]=-60*e.getTimezoneOffset(),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();E[r+32>>>2>>>0]=0|(t!=n&&e.getTimezoneOffset()==Math.min(n,t))},p:function(e){e>>>=0;var t=new Date(E[e+20>>>2>>>0]+1900,E[e+16>>>2>>>0],E[e+12>>>2>>>0],E[e+8>>>2>>>0],E[e+4>>>2>>>0],E[e>>>2>>>0],0),r=E[e+32>>>2>>>0],n=t.getTimezoneOffset(),a=new Date(t.getFullYear(),6,1).getTimezoneOffset(),o=new Date(t.getFullYear(),0,1).getTimezoneOffset(),i=Math.min(o,a);return 0>r?E[e+32>>>2>>>0]=+(a!=o&&i==n):0<r!=(i==n)&&(a=Math.max(o,a),t.setTime(t.getTime()+6e4*((0<r?i:a)-n))),E[e+24>>>2>>>0]=t.getDay(),E[e+28>>>2>>>0]=(q(t.getFullYear())?Z:J)[t.getMonth()]+t.getDate()-1|0,E[e>>>2>>>0]=t.getSeconds(),E[e+4>>>2>>>0]=t.getMinutes(),E[e+8>>>2>>>0]=t.getHours(),E[e+12>>>2>>>0]=t.getDate(),E[e+16>>>2>>>0]=t.getMonth(),E[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),isNaN(e)?(E[se()>>>2>>>0]=61,e=-1):e/=1e3,fe((N=e,1<=+Math.abs(N)?0<N?+Math.floor(N/4294967296)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)),e>>>0},l:function(){return-52},m:function(){},t:function(e,t,r){function n(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}r>>>=0;var a=(new Date).getFullYear(),o=new Date(a,0,1),i=new Date(a,6,1);a=o.getTimezoneOffset();var s=i.getTimezoneOffset();O[e>>>0>>>2>>>0]=60*Math.max(a,s),E[t>>>0>>>2>>>0]=+(a!=s),e=n(o),t=n(i),e=Q(e),t=Q(t),s<a?(O[r>>>2>>>0]=e,O[r+4>>>2>>>0]=t):(O[r>>>2>>>0]=t,O[r+4>>>2>>>0]=e)},d:()=>{M("")},B:function(e,t,r){e>>>=0,t>>>=0,r>>>=0,X.length=0;for(var n;n=v[t++>>>0];){var a=105!=n;r+=(a&=112!=n)&&r%8?4:0,X.push(112==n?O[r>>>2>>>0]:105==n?E[r>>>2>>>0]:A[r>>>3>>>0]),r+=a?8:4}return H[e].apply(null,X)},h:()=>Date.now(),u:function(){return 4294901760},b:()=>performance.now(),I:function(e,t,r){return t>>>=0,v.copyWithin(e>>>0>>>0,t>>>0,t+(r>>>0)>>>0)},s:function(e){e>>>=0;var t=v.length;if(4294901760<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var a=Math;n=Math.max(e,n);e:{a=(a.min.call(a,4294901760,n+(65536-n%65536)%65536)-m.buffer.byteLength+65535)/65536;try{m.grow(a),R();var o=1;break e}catch{}o=void 0}if(o)return!0}return!1},C:function(e,t){e>>>=0,t>>>=0;var r=0;return ee().forEach(((n,a)=>{var o=t+r;for(a=O[e+4*a>>>2>>>0]=o,o=0;o<n.length;++o)b[a++>>>0>>>0]=n.charCodeAt(o);b[a>>>0>>>0]=0,r+=n.length+1})),0},D:function(e,t){e>>>=0,t>>>=0;var r=ee();O[e>>>2>>>0]=r.length;var n=0;return r.forEach((e=>n+=e.length+1)),O[t>>>2>>>0]=n,0},f:()=>52,j:function(){return 52},q:function(){return 70},i:function(e,t,r,n){t>>>=0,r>>>=0,n>>>=0;for(var a=0,o=0;o<r;o++){var i=O[t>>>2>>>0],s=O[t+4>>>2>>>0];t+=8;for(var u=0;u<s;u++){var l=v[i+u>>>0],f=te[e];0===l||10===l?((1===e?g:w)(k(f,0)),f.length=0):f.push(l)}a+=s}return O[n>>>2>>>0]=a,0},r:ae,c:function(e,t,r,n){return ae(e>>>0,t>>>0,r>>>0,n>>>0)}},ie=function(){function e(e){return ie=e.exports,ie=function(){var e=ie;e=Object.assign({},e);var t=e=>()=>e()>>>0,r=e=>t=>e(t)>>>0;return e.la=t(e.la),e.ma=r(e.ma),e.qa=t(e.qa),e.sa=r(e.sa),e}(),m=ie.K,R(),_.unshift(ie.L),0==--D&&(null!==S&&(clearInterval(S),S=null),U&&(e=U,U=null,e())),ie}var t={a:oe};if(D++,a.instantiateWasm)try{return a.instantiateWasm(t,e)}catch(e){w(`Module.instantiateWasm callback failed with error: ${e}`),n(e)}return function(e,t){var r=L;return"function"!=typeof WebAssembly.instantiateStreaming||B(r)||x(r)||c||"function"!=typeof fetch?$(r,e,t):fetch(r,{credentials:"same-origin"}).then((n=>WebAssembly.instantiateStreaming(n,e).then(t,(function(n){return w(`wasm streaming compile failed: ${n}`),w("falling back to ArrayBuffer instantiation"),$(r,e,t)}))))}(t,(function(t){e(t.instance)})).catch(n),{}}();a._OrtInit=(e,t)=>(a._OrtInit=ie.M)(e,t),a._OrtGetLastError=(e,t)=>(a._OrtGetLastError=ie.N)(e,t),a._OrtCreateSessionOptions=(e,t,r,n,o,i,s,u,l,f)=>(a._OrtCreateSessionOptions=ie.O)(e,t,r,n,o,i,s,u,l,f),a._OrtAppendExecutionProvider=(e,t)=>(a._OrtAppendExecutionProvider=ie.P)(e,t),a._OrtAddFreeDimensionOverride=(e,t,r)=>(a._OrtAddFreeDimensionOverride=ie.Q)(e,t,r),a._OrtAddSessionConfigEntry=(e,t,r)=>(a._OrtAddSessionConfigEntry=ie.R)(e,t,r),a._OrtReleaseSessionOptions=e=>(a._OrtReleaseSessionOptions=ie.S)(e),a._OrtCreateSession=(e,t,r)=>(a._OrtCreateSession=ie.T)(e,t,r),a._OrtReleaseSession=e=>(a._OrtReleaseSession=ie.U)(e),a._OrtGetInputOutputCount=(e,t,r)=>(a._OrtGetInputOutputCount=ie.V)(e,t,r),a._OrtGetInputName=(e,t)=>(a._OrtGetInputName=ie.W)(e,t),a._OrtGetOutputName=(e,t)=>(a._OrtGetOutputName=ie.X)(e,t),a._OrtFree=e=>(a._OrtFree=ie.Y)(e),a._OrtCreateTensor=(e,t,r,n,o,i)=>(a._OrtCreateTensor=ie.Z)(e,t,r,n,o,i),a._OrtGetTensorData=(e,t,r,n,o)=>(a._OrtGetTensorData=ie._)(e,t,r,n,o),a._OrtReleaseTensor=e=>(a._OrtReleaseTensor=ie.$)(e),a._OrtCreateRunOptions=(e,t,r,n)=>(a._OrtCreateRunOptions=ie.aa)(e,t,r,n),a._OrtAddRunConfigEntry=(e,t,r)=>(a._OrtAddRunConfigEntry=ie.ba)(e,t,r),a._OrtReleaseRunOptions=e=>(a._OrtReleaseRunOptions=ie.ca)(e),a._OrtCreateBinding=e=>(a._OrtCreateBinding=ie.da)(e),a._OrtBindInput=(e,t,r)=>(a._OrtBindInput=ie.ea)(e,t,r),a._OrtBindOutput=(e,t,r,n)=>(a._OrtBindOutput=ie.fa)(e,t,r,n),a._OrtClearBoundOutputs=e=>(a._OrtClearBoundOutputs=ie.ga)(e),a._OrtReleaseBinding=e=>(a._OrtReleaseBinding=ie.ha)(e),a._OrtRunWithBinding=(e,t,r,n,o)=>(a._OrtRunWithBinding=ie.ia)(e,t,r,n,o),a._OrtRun=(e,t,r,n,o,i,s,u)=>(a._OrtRun=ie.ja)(e,t,r,n,o,i,s,u),a._OrtEndProfiling=e=>(a._OrtEndProfiling=ie.ka)(e);var se=()=>(se=ie.la)(),ue=a._malloc=e=>(ue=a._malloc=ie.ma)(e);a._free=e=>(a._free=ie.na)(e);var le,fe=e=>(fe=ie.pa)(e),de=()=>(de=ie.qa)(),ce=e=>(ce=ie.ra)(e),pe=e=>(pe=ie.sa)(e);function he(){if(!(0<D)){if(a.preRun)for("function"==typeof a.preRun&&(a.preRun=[a.preRun]);a.preRun.length;){var e=a.preRun.shift();P.unshift(e)}for(;0<P.length;)P.shift()(a);if(!(0<D||le||(le=!0,a.calledRun=!0,T))){for(;0<_.length;)_.shift()(a);for(t(a);0<C.length;)C.shift()(a)}}}return a.stackAlloc=pe,a.stackSave=de,a.stackRestore=ce,a.UTF8ToString=W,a.stringToUTF8=(e,t,r)=>V(e,v,t,r),a.lengthBytesUTF8=Y,U=function e(){le||he(),le||(U=e)},he(),e.ready});"object"==typeof e&&"object"==typeof t?t.exports=n:"function"==typeof define&&define.amd&&define([],(()=>n))})),we=P((()=>{it=dr(),on=it,st=!1,He=!1,pr=!1,sn=e=>{if(1===e)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},an=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},un=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",mr=async e=>{if(st)return Promise.resolve();if(He)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(pr)throw new Error("previous call to 'initializeWebAssembly()' failed.");He=!0;let t=e.initTimeout,r=e.numThreads,n=e.simd,a=sn(r),o=n&&an(),i=e.wasmPaths,s="string"==typeof i?i:void 0,u=un(o,a),l="object"==typeof i?i[u]:void 0,f=!1,d=[];if(t>0&&d.push(new Promise((e=>{setTimeout((()=>{f=!0,e()}),t)}))),d.push(new Promise(((e,t)=>{(a?on:it)({locateFile:(e,t)=>e.endsWith(".wasm")?l||(s??t)+u:t+e}).then((t=>{He=!1,st=!0,ot=t,e()}),(e=>{He=!1,pr=!0,t(e)}))}))),await Promise.race(d),f)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},R=()=>{if(st&&ot)return ot;throw new Error("WebAssembly is not initialized yet.")}})),ze=P((()=>{we(),M=(e,t)=>{let r=R(),n=r.lengthBytesUTF8(e)+1,a=r._malloc(n);return r.stringToUTF8(e,a,n),t.push(a),a},xe=(e,t,r,n)=>{if("object"==typeof e&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach((([e,a])=>{let o=t?t+e:e;if("object"==typeof a)xe(a,o+".",r,n);else if("string"==typeof a||"number"==typeof a)n(o,a.toString());else{if("boolean"!=typeof a)throw new Error("Can't handle extra config type: "+typeof a);n(o,a?"1":"0")}}))},L=e=>{let t=R(),r=t.stackSave();try{let r=t.stackAlloc(8);t._OrtGetLastError(r,r+4);let n=t.HEAP32[r/4],a=t.HEAPU32[r/4+1],o=a?t.UTF8ToString(a):"";throw new Error(`${e} ERROR_CODE: ${n}, ERROR_MESSAGE: ${o}`)}finally{t.stackRestore(r)}}})),yr=P((()=>{we(),ze(),hr=e=>{let t=R(),r=0,n=[],a=e||{};try{if(void 0===e?.logSeverityLevel)a.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===e?.logVerbosityLevel)a.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===e?.terminate&&(a.terminate=!1);let o=0;return void 0!==e?.tag&&(o=M(e.tag,n)),r=t._OrtCreateRunOptions(a.logSeverityLevel,a.logVerbosityLevel,!!a.terminate,o),0===r&&L("Can't create run options."),void 0!==e?.extra&&xe(e.extra,"",new WeakSet,((e,a)=>{let o=M(e,n),i=M(a,n);0!==t._OrtAddRunConfigEntry(r,o,i)&&L(`Can't set a run config entry: ${e} - ${a}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),n.forEach((e=>t._free(e))),e}}})),gr=P((()=>{we(),ze(),fn=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},cn=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},ln=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)},dn=(e,t,r)=>{for(let n of t){let t="string"==typeof n?n:n.name;switch(t){case"webnn":if(t="WEBNN","string"!=typeof n){let t=n;if(t?.deviceType){let n=M("deviceType",r),a=M(t.deviceType,r);0!==R()._OrtAddSessionConfigEntry(e,n,a)&&L(`Can't set a session config entry: 'deviceType' - ${t.deviceType}.`)}if(t?.numThreads){let n=t.numThreads;("number"!=typeof n||!Number.isInteger(n)||n<0)&&(n=0);let a=M("numThreads",r),o=M(n.toString(),r);0!==R()._OrtAddSessionConfigEntry(e,a,o)&&L(`Can't set a session config entry: 'numThreads' - ${t.numThreads}.`)}if(t?.powerPreference){let n=M("powerPreference",r),a=M(t.powerPreference,r);0!==R()._OrtAddSessionConfigEntry(e,n,a)&&L(`Can't set a session config entry: 'powerPreference' - ${t.powerPreference}.`)}}break;case"webgpu":if(t="JS","string"!=typeof n){let t=n;if(t?.preferredLayout){if("NCHW"!==t.preferredLayout&&"NHWC"!==t.preferredLayout)throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${t.preferredLayout}`);let n=M("preferredLayout",r),a=M(t.preferredLayout,r);0!==R()._OrtAddSessionConfigEntry(e,n,a)&&L(`Can't set a session config entry: 'preferredLayout' - ${t.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${t}`)}let a=M(t,r);0!==R()._OrtAppendExecutionProvider(e,a)&&L(`Can't append execution provider: ${t}.`)}},wr=e=>{let t=R(),r=0,n=[],a=e||{};ln(a);try{let e=fn(a.graphOptimizationLevel??"all"),o=cn(a.executionMode??"sequential"),i="string"==typeof a.logId?M(a.logId,n):0,s=a.logSeverityLevel??2;if(!Number.isInteger(s)||s<0||s>4)throw new Error(`log serverity level is not valid: ${s}`);let u=a.logVerbosityLevel??0;if(!Number.isInteger(u)||u<0||u>4)throw new Error(`log verbosity level is not valid: ${u}`);let l="string"==typeof a.optimizedModelFilePath?M(a.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(e,!!a.enableCpuMemArena,!!a.enableMemPattern,o,!!a.enableProfiling,0,i,s,u,l),0===r&&L("Can't create session options."),a.executionProviders&&dn(r,a.executionProviders,n),a.freeDimensionOverrides)for(let[e,o]of Object.entries(a.freeDimensionOverrides)){if("string"!=typeof e)throw new Error(`free dimension override name must be a string: ${e}`);if("number"!=typeof o||!Number.isInteger(o)||o<0)throw new Error(`free dimension override value must be a non-negative integer: ${o}`);let a=M(e,n);0!==t._OrtAddFreeDimensionOverride(r,a,o)&&L(`Can't set a free dimension override: ${e} - ${o}.`)}return void 0!==a.extra&&xe(a.extra,"",new WeakSet,((e,a)=>{let o=M(e,n),i=M(a,n);0!==t._OrtAddSessionConfigEntry(r,o,i)&&L(`Can't set a session config entry: ${e} - ${a}.`)})),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseSessionOptions(r),n.forEach((e=>t._free(e))),e}}})),ft=P((()=>{at=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},br=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},ut=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Er=e=>{switch(e){case"float16":case"uint16":return Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Tr=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},$e=e=>"float32"===e||"int32"===e||"int64"===e||"bool"===e||"float16"===e||"uint32"===e,Or=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}})),ct=P((()=>{Ie=async e=>{if("string"!=typeof e)return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e);if(!(typeof process<"u"&&process.versions&&process.versions.node)){let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let r,a=t.body.getReader();try{r=new ArrayBuffer(n)}catch(e){if(!(e instanceof RangeError))throw e;{let e=Math.ceil(n/65536);r=new WebAssembly.Memory({initial:e,maximum:e}).buffer}}let o=0;for(;;){let{done:e,value:t}=await a.read();if(e)break;let n=t.byteLength;new Uint8Array(r,o,n).set(t),o+=n}return new Uint8Array(r,0,n)}}try{return new Uint8Array(await(void 0)(e))}catch(t){if("ERR_FS_FILE_TOO_LARGE"===t.code){let t=(void 0)(e),r=[];for await(let e of t)r.push(e);return new Uint8Array(Buffer.concat(r))}throw t}}})),_r=P((()=>{yr(),gr(),ft(),we(),ze(),ct(),pn=(e,t)=>{0!==R()._OrtInit(e,t)&&L("Can't initialize onnxruntime.")},Sr=async e=>{pn(e.wasm.numThreads,Tr(e.logLevel))},Ar=async(e,t)=>{},Be=new Map,mn=e=>{let t=R(),r=t.stackSave();try{let r=t.stackAlloc(8);return 0!==t._OrtGetInputOutputCount(e,r,r+4)&&L("Can't get session input/output count."),[t.HEAP32[r/4],t.HEAP32[r/4+1]]}finally{t.stackRestore(r)}},lt=e=>{let t=R(),r=t._malloc(e.byteLength);if(0===r)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},xr=async(e,t)=>{let r,n,a=R();Array.isArray(e)?[r,n]=e:e.buffer===a.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=lt(e);let o=0,i=0,s=[],u=[],l=[];try{if([i,s]=wr(t),t?.externalData&&a.mountExternalData){let e=[];for(let r of t.externalData){let t="string"==typeof r?r:r.path;e.push(Ie("string"==typeof r?r:r.data).then((e=>{a.mountExternalData(t,e)})))}await Promise.all(e)}o=a._OrtCreateSession(r,n,i),0===o&&L("Can't create a session.");let[e,f]=mn(o),d=[],c=[];for(let t=0;t<e;t++){let e=a._OrtGetInputName(o,t);0===e&&L("Can't get an input name."),u.push(e),d.push(a.UTF8ToString(e))}for(let e=0;e<f;e++){let t=a._OrtGetOutputName(o,e);0===t&&L("Can't get an output name."),l.push(t);let r=a.UTF8ToString(t);c.push(r)}let p=null;return Be.set(o,[o,u,l,p]),[o,d,c]}catch(e){throw u.forEach((e=>a._OrtFree(e))),l.forEach((e=>a._OrtFree(e))),0!==o&&a._OrtReleaseSession(o),e}finally{a._free(r),0!==i&&a._OrtReleaseSessionOptions(i),s.forEach((e=>a._free(e))),a.unmountExternalData?.()}},Ir=e=>{let t=R(),r=Be.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[n,a,o,i]=r;i&&t._OrtReleaseBinding(i.handle),t.jsepUnregisterBuffers?.(e),a.forEach((e=>t._OrtFree(e))),o.forEach((e=>t._OrtFree(e))),t._OrtReleaseSession(n),Be.delete(e)},vr=(e,t,r,n,a)=>{if(!e)return void t.push(0);let o,i,s=R(),u=e[0],l=e[1],f=e[3];if("string"===u&&"gpu-buffer"===f)throw new Error("String tensor is not supported on GPU.");if("gpu-buffer"===f){let t=e[2].gpuBuffer,r=ut(at(u));i=l.reduce(((e,t)=>e*t),1)*r,o=s.jsepRegisterBuffer(n,a,t,i)}else{let t=e[2];if(Array.isArray(t)){i=4*t.length,o=s._malloc(i),r.push(o);let e=o/4;for(let n=0;n<t.length;n++){if("string"!=typeof t[n])throw new TypeError(`tensor data at index ${n} is not a string`);s.HEAPU32[e++]=M(t[n],r)}}else i=t.byteLength,o=s._malloc(i),r.push(o),s.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,i),o)}let d=s.stackSave(),c=s.stackAlloc(4*l.length);try{let e=c/4;l.forEach((t=>s.HEAP32[e++]=t));let r=s._OrtCreateTensor(at(u),o,i,c,l.length,Or(f));0===r&&L(`Can't create tensor for input/output. session=${n}, index=${a}.`),t.push(r)}finally{s.stackRestore(d)}},Br=async(e,t,r,n,a,o)=>{let i=R(),s=Be.get(e);if(!s)throw new Error(`cannot run inference. invalid session id: ${e}`);let[u,l,f,d]=s,c=t.length,p=n.length,h=0,y=[],g=[],w=[],m=[],b=i.stackSave(),v=i.stackAlloc(4*c),E=i.stackAlloc(4*c),O=i.stackAlloc(4*p),A=i.stackAlloc(4*p);try{[h,y]=hr(o);for(let n=0;n<c;n++)vr(r[n],g,m,e,t[n]);for(let t=0;t<p;t++)vr(a[t],w,m,e,c+n[t]);let s,b=v/4,T=E/4,R=O/4,P=A/4;for(let e=0;e<c;e++)i.HEAPU32[b++]=g[e],i.HEAPU32[T++]=l[t[e]];for(let e=0;e<p;e++)i.HEAPU32[R++]=w[e],i.HEAPU32[P++]=f[n[e]];s=await i._OrtRun(u,E,v,c,A,p,O,h),0!==s&&L("failed to call OrtRun().");let _=[];for(let e=0;e<p;e++){let t=i.HEAPU32[O/4+e];if(t===w[e]){_.push(a[e]);continue}let r,o=i.stackSave(),s=i.stackAlloc(16),u=!1,l=0;try{0!==i._OrtGetTensorData(t,s,s+4,s+8,s+12)&&L(`Can't access output tensor data on index ${e}.`);let a=s/4,o=i.HEAPU32[a++];l=i.HEAPU32[a++];let f=i.HEAPU32[a++],c=i.HEAPU32[a++],p=[];for(let e=0;e<c;e++)p.push(i.HEAPU32[f/4+e]);i._OrtFree(f);let h=p.reduce(((e,t)=>e*t),1);r=br(o);let y=d?.outputPreferredLocations[n[e]];if("string"===r){if("gpu-buffer"===y)throw new Error("String tensor is not supported on GPU.");let e=[],t=l/4;for(let r=0;r<h;r++){let n=i.HEAPU32[t++],a=r===h-1?void 0:i.HEAPU32[t]-n;e.push(i.UTF8ToString(n,a))}_.push([r,p,e,"cpu"])}else if("gpu-buffer"===y&&h>0){let e=i.jsepGetBuffer(l),n=ut(o);if(void 0===n||!$e(r))throw new Error(`Unsupported data type: ${r}`);u=!0,_.push([r,p,{gpuBuffer:e,download:i.jsepCreateDownloader(e,h*n,r),dispose:()=>{i._OrtReleaseTensor(t)}},"gpu-buffer"])}else{let e=new(Er(r))(h);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(i.HEAPU8.subarray(l,l+e.byteLength)),_.push([r,p,e,"cpu"])}}finally{i.stackRestore(o),"string"===r&&l&&i._free(l),u||i._OrtReleaseTensor(t)}}return d&&i._OrtClearBoundOutputs(d.handle),_}finally{i.stackRestore(b),g.forEach((e=>i._OrtReleaseTensor(e))),w.forEach((e=>i._OrtReleaseTensor(e))),m.forEach((e=>i._free(e))),0!==h&&i._OrtReleaseRunOptions(h),y.forEach((e=>i._free(e)))}},Pr=e=>{let t=R(),r=Be.get(e);if(!r)throw new Error("invalid session id");let n=r[0],a=t._OrtEndProfiling(n);0===a&&L("Can't get an profile file name."),t._OrtFree(a)}})),pt=P((()=>{le(),_r(),we(),dt=!1,Cr=!1,Dr=!1,Uo=typeof document<"u"?document?.currentScript?.src:void 0,Ur=async()=>{if(!Cr){if(dt)throw new Error("multiple calls to 'initWasm()' detected.");if(Dr)throw new Error("previous call to 'initWasm()' failed.");dt=!0;try{await mr(D.wasm),await Sr(D),Cr=!0}catch(e){throw Dr=!0,e}finally{dt=!1}}},Lr=async e=>{await Ar(D,e)},Rr=async e=>lt(e),Mr=async(e,t)=>xr(e,t),Fr=async e=>{Ir(e)},kr=async(e,t,r,n,a,o)=>Br(e,t,r,n,a,o),Nr=async e=>{Pr(e)}})),Hr=P((()=>{le(),pt(),ft(),ct(),Wr=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${e.location} for ${t()}`)}},yn=e=>{switch(e[3]){case"cpu":return new z(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!$e(t))throw new Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:a}=e[2];return z.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:a})}default:throw new Error(`invalid data location: ${e[3]}`)}},je=class{async fetchModelAndCopyToWasmMemory(e){return Rr(await Ie(e))}async loadModel(e,t){let r;ne(),r="string"==typeof e?typeof process<"u"&&process.versions&&process.versions.node?await Ie(e):await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames]=await Mr(r,t),oe()}async dispose(){return Fr(this.sessionId)}async run(e,t,r){ne();let n=[],a=[];Object.entries(e).forEach((e=>{let t=e[0],r=e[1],o=this.inputNames.indexOf(t);if(-1===o)throw new Error(`invalid input '${t}'`);n.push(r),a.push(o)}));let o=[],i=[];Object.entries(t).forEach((e=>{let t=e[0],r=e[1],n=this.outputNames.indexOf(t);if(-1===n)throw new Error(`invalid output '${t}'`);o.push(r),i.push(n)}));let s=n.map(((e,t)=>Wr(e,(()=>`input "${this.inputNames[a[t]]}"`)))),u=o.map(((e,t)=>e?Wr(e,(()=>`output "${this.outputNames[i[t]]}"`)):null)),l=await kr(this.sessionId,a,s,i,u,r),f={};for(let e=0;e<l.length;e++)f[this.outputNames[i[e]]]=o[e]??yn(l[e]);return oe(),f}startProfiling(){}endProfiling(){Nr(this.sessionId)}}})),zr=P((()=>{le(),pt(),Hr(),wn=()=>{if(("number"!=typeof D.wasm.initTimeout||D.wasm.initTimeout<0)&&(D.wasm.initTimeout=0),"boolean"!=typeof D.wasm.simd&&(D.wasm.simd=!0),"boolean"!=typeof D.wasm.proxy&&(D.wasm.proxy=!1),"boolean"!=typeof D.wasm.trace&&(D.wasm.trace=!1),"number"!=typeof D.wasm.numThreads||!Number.isInteger(D.wasm.numThreads)||D.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(D.wasm.numThreads=1);let e=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;D.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},Ge=class{async init(e){wn(),await Ur(),await Lr(e)}async createInferenceSessionHandler(e,t){let r=new je;return await r.loadModel(e,t),Promise.resolve(r)}}})),$r={};Se($r,{wasmBackend:()=>gn});var gn,jr=P((()=>{zr(),gn=new Ge})),En={};Se(En,{InferenceSession:()=>Zt,TRACE:()=>et,TRACE_FUNC_BEGIN:()=>ne,TRACE_FUNC_END:()=>oe,Tensor:()=>z,TrainingSession:()=>rr,default:()=>bn,env:()=>D,registerBackend:()=>ye}),module.exports=De(En),le(),le(),le();var or="1.17.1",bn=rt;{let e=(jr(),De($r)).wasmBackend;ye("cpu",e,10),ye("wasm",e,10)}Object.defineProperty(D.versions,"web",{value:or,enumerable:!0});